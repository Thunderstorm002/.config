window.PolyfilledStorage=function(e){var t={};function n(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(s,r,function(t){return e[t]}.bind(null,r));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";const s=new WeakMap,r=new WeakMap,o=Promise.resolve();function a(e){if("string"!=typeof e)throw new TypeError("eventName must be a string")}function i(e){if("function"!=typeof e)throw new TypeError("listener must be a function")}function c(e,t){const n=r.get(e);return n.has(t)||n.set(t,new Set),n.get(t)}class l{constructor(){s.set(this,new Set),r.set(this,new Map)}on(e,t){return a(e),i(t),c(this,e).add(t),this.off.bind(this,e,t)}off(e,t){a(e),i(t),c(this,e).delete(t)}once(e){return new Promise(t=>{a(e);const n=this.on(e,e=>{n(),t(e)})})}async emit(e,t){a(e);const n=c(this,e),r=s.get(this),i=[...n],l=[...r];return await o,Promise.all([...i.map(async e=>{if(n.has(e))return e(t)}),...l.map(async n=>{if(r.has(n))return n(e,t)})])}async emitSerial(e,t){a(e);const n=c(this,e),r=s.get(this),i=[...n],l=[...r];await o;for(const e of i)n.has(e)&&await e(t);for(const n of l)r.has(n)&&await n(e,t)}onAny(e){return i(e),s.get(this).add(e),this.offAny.bind(this,e)}offAny(e){i(e),s.get(this).delete(e)}clearListeners(e){if("string"==typeof e)c(this,e).clear();else{s.get(this).clear();for(const e of r.get(this).values())e.clear()}}listenerCount(e){if("string"==typeof e)return s.get(this).size+c(this,e).size;void 0!==e&&a(e);let t=s.get(this).size;for(const e of r.get(this).values())t+=e.size;return t}}l.Typed=class extends l{},Object.defineProperty(l.Typed,"Typed",{enumerable:!1,value:void 0}),e.exports=l},function(e,t,n){"use strict";n.r(t);var s=n(0),r=n.n(s);let o;(()=>{const e=window.chrome||window.browser;class t{constructor(t,n="__polyfill-storage-update__"){this.name=t,this.storageArea=e.storage[t],this.onChanged=this.storageArea.onChanged,this.onChangedEventKey=n,this.emittery=new r.a,this.callbackMap=new Map,e.runtime.onMessage.addListener(e=>{if(!e.action||e.action!==this.onChangedEventKey||e.storageArea!==t)return;const{changes:n,namespace:s}=e;this.emittery.emit(this.onChangedEventKey,{changes:n,namespace:s})}),this.onChanged={addListener:e=>{const t=({changes:t,namespace:n})=>e(t,n);this.emittery.on(this.onChangedEventKey,t),this.callbackMap.set(e,t)},removeListener:e=>{const t=this.callbackMap.get(e);t&&(this.emittery.off(this.onChangedEventKey,t),this.callbackMap.delete(e))},hasListener:e=>!!this.callbackMap.get(e)}}commonHandle(e,...t){return new Promise((n,s)=>{e.call(this.storageArea,...t,n)})}get(...e){return this.commonHandle(this.storageArea.get,...e)}set(t,...n){const s=this.commonHandle(this.storageArea.set,t,...n);return s.then(()=>{const n={};for(const[e,s]of Object.entries(t))n[e]={newValue:s};e.runtime.sendMessage({action:this.onChangedEventKey,storageArea:this.name,changes:n})}),s}getBytesInUse(){return this.commonHandle(this.storageArea.getBytesInUse)}remove(...e){return this.commonHandle(this.storageArea.remove,...e)}clear(){return this.commonHandle(this.storageArea.clear)}}o={sync:new t("sync"),local:new t("local"),managed:new t("managed")}})(),t.default=o}]).default;