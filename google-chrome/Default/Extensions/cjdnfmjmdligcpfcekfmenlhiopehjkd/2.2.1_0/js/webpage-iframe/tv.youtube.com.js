(()=>{if(window.top===window)return;const e="watch-iframe[tv.youtube.com]",t=new WebpageIframeModule({name:e,hrefURLRegex:new RegExp("https://tv\\.youtube\\.com/.*"),earlyInitialize(){const e=browser.runtime.connect({name:name});this.port=e,window.addEventListener("found-media",async function(e){this.mediaEntry=await window.twoseven.processConfig(window.location.href,e.detail.data)}.bind(this)),window.addEventListener("controller-event",function(e){const{detail:{data:t}}=e,{action:n}=t;switch(n){case"play":this.video.play();break;case"pause":this.video.pause();break;case"seek":this.video.seek(1e3*t.position);break;case"fullscreen":window.twoseven.fullscreenHandlers.toggleFullscreen()}}.bind(this))},fullscreenCallback:()=>!0,useActionsAsControls:!0,getActions:()=>window.twoseven.initializeGenericIframeActions(),getVideo(){return this.video},onVideo(e){this.video=e,this.url=window.location.href;const{video:t}=e,n=this;t.addEventListener("loadeddata",()=>{let e;async function i(e,n=!0){const{detail:i={}}=e,{data:o={}}=i,{fromJS:r=!1}=o;let{paused:a}=t;if(n&&(a=!a),!r)return e.stopImmediatePropagation(),e.preventDefault(),triggerEvent(window,"controller-event",{action:a?"play":"pause"})}(e=[document.querySelector("#id-rewind-button"),document.querySelector("#id-forward-button")]).forEach(e=>e.addEventListener("click",async e=>{const{detail:n={}}=e,{data:i={}}=n,{fromJS:o=!1}=i;if(!o)return e.stopImmediatePropagation(),e.preventDefault(),triggerEvent(window,"controller-event",{action:"seek",position:t.currentTime})})),(e=document.querySelector("#id-play-pause-button")).addEventListener("click",i),(e=document.querySelector("#id-ytu-ss-interface.ytu-scrub-slider")).addEventListener("click",async e=>{const{detail:n={}}=e,{data:i={}}=n,{fromJS:o=!1}=i;if(!o)return e.stopImmediatePropagation(),e.preventDefault(),triggerEvent(window,"controller-event",{action:"seek",position:t.currentTime})}),(e=document.querySelector(".aux-controls-top.ytu-player-section .fullscreen-icon > iron-icon")).addEventListener("click",async e=>(e.stopImmediatePropagation(),e.preventDefault(),triggerEvent(window,"controller-event",{action:"fullscreen"})));const o=document.querySelector("#id-player-overlay");o.addEventListener("click",e=>{if(e.target===o)return i(e,!1)}),o.addEventListener("dblclick",e=>{if(e.target===o)return triggerEvent(window,"controller-event",{action:"fullscreen"})}),(e=document.querySelector(".ytu-ss-live-button")).addEventListener("click",e=>{const{detail:n={}}=e,{data:i={}}=n,{fromJS:o=!1}=i;if(!o)return e.stopImmediatePropagation(),e.preventDefault(),triggerEvent(window,"controller-event",{action:"seek",position:t.currentTime})}),n.on("same-url",()=>n.emit("controller-initialized")),n.emit("controller-ready",n.mediaEntry)})},isValidVideoElement:()=>!0});registerWebpageIframeModule(t)})();