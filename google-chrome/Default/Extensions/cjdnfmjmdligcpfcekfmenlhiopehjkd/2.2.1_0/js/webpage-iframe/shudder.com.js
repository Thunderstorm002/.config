(()=>{if(window.top===window)return;const e="watch-iframe[shudder]",n=new WebpageIframeModule({name:e,hrefURLRegex:new RegExp("https://.*.shudder.com/.*"),earlyInitialize(){const e=browser.runtime.connect({name:name});this.port=e,setupScriptModifier(name,e=>e.src.includes("jwplayer.core"),new ScriptModifierMap([{key:new XRegExp(":et.playVideo\\((?<var>.)\\)"),value:new ScriptModifierEntry({replace:": n === \"autostart\" ? new Promise(async resolve => {\n              await et.playVideo(${var});\n              const video = et.getVideo()\n              await et.getVideo().pause()\n              const { play, pause, seek, getCurrentTime } = video\n              Object.assign(video, {\n                play (fromJS) {\n                  triggerEvent(window, 'controller-event', { action: 'play' })\n                },\n                pause (fromJS) {\n                  triggerEvent(window, 'controller-event', { action: 'pause' })\n                },\n                seek (position) {\n                  triggerEvent(window, 'controller-event', { action: 'seek', position })\n                },\n                currentTime () {\n                  return getCurrentTime()\n                }\n              })\n              window.twoseven.shudderController = video;\n              resolve()\n            }) : et.playVideo(${var})"})}],"shudder:jwplayer.core"),"body"),window.addEventListener("controller-event",function(e){const{detail:{data:n}}=e,{action:t}=n;switch(t){case"play":this.video.play();break;case"pause":this.video.pause();break;case"seek":this.video.seek(1e3*n.position)}}.bind(this))},fullscreenCallback:()=>!0,useActionsAsControls:!0,getActions:()=>window.twoseven.initializeGenericIframeActions(),getVideo(){return this.video},onVideo(e){this.video=e,this.url=window.location.href,this.emit("controller-ready");const n=this,t=document.querySelector("#video-player"),i=new MutationObserver(e=>{for(const t of e)if("childList"===t.type){if(Array.from(t.addedNodes).length>0){const e=document.querySelector(".jw-icon-fullscreen");e&&(i.disconnect(),e.addEventListener("click",window.twoseven.fullscreenHandlers.toggleFullscreen),n.emit("controller-initialized"))}}});i.observe(t,{childList:!0,subtree:!0})},isValidVideoElement:()=>!0});registerWebpageIframeModule(n)})();