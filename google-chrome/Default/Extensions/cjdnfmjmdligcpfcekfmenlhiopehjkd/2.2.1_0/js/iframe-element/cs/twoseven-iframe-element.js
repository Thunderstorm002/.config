(()=>{if(!isOnTwoSeven(window.location.href))return;if(window.top===window)return;const e="twoseven-iframe-element",a=`${window.name}:${e}`,o=browser.runtime.connect({name:e}),n=new ProxyObject({roomOwner:void 0,roomType:void 0,roomController:void 0},`${a}-roomInfo`);window.twoseven.roomInfo=n,n.on("change",e=>{const a={action:"room-updated",data:sanitizeObject(n)};window.postMessage(a)}),o.onMessage.addListener(e=>{window.name.includes("hbo");const a=e.action;switch(a){case"room-updated":Object.keys(e.data).forEach(a=>{n[a]=e.data[a]});break;default:console.warn(`Received unexpected message: ${a}`)}});const r=[{iframeNames:["_nflx","netflix-iframe"],vueComponentName:"netflix"},{iframeNames:["browse-iframe"],vueComponentName:"browse"},{iframeNames:["amazon-iframe"],vueComponentName:"amazon",wildcardCors:!1},{iframeNames:["hbo-iframe"],vueComponentName:"hbo"},{iframeNames:["twoseven-strategy-iframe"],wildcardCors:!0},{iframeNames:["webpage-iframe","webpage-iframe:inner"],vueComponentName:"webpage",wildcardCors:!1},{iframeNames:["hulu-iframe"],vueComponentName:"hulu",wildcardCors:!1},{iframeNames:["disneyplus-iframe"],vueComponentName:"disneyplus",wildcardCors:!1},{iframeNames:["headspace-iframe"],vueComponentName:"headspace",wildcardCors:!1}];window.addEventListener("message",({source:e,data:a={}})=>{const{name:n}=a,i=r.find(e=>e.iframeNames.includes(n));if(!i)return;const{vueComponentName:s}=i,{action:m}=a;switch(m){case"register-iframe":o.onMessage.addListener(function e(a){const{action:r}=a;"registered-iframe"===r&&(o.onMessage.removeListener(e),postTo(window.top,{action:"twoseven-iframe-ready",name:n,vueComponentName:s}))}),o.postMessage({action:m,...i,...a});break;case"url-changed":{const{url:e}=a;if(s)return injectScript(`\n          window['${s}'].$refs.element.inputUrl = '${e}'\n          `,!0);o.postMessage({action:"url-changed"});break}}})})();