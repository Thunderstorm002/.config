const genericIframes={};browser.runtime.onConnect.addListener(async e=>{const n=getTabIdFromPort(e);if(-1===n)return;const{frameId:r}=e.sender,s=await getTabByTabId(n);if(!isOnTwoSeven(s.url))return;genericIframes[n]||(genericIframes[n]={});const t=genericIframes[n];t[r]||(t[r]=[]);const o=t[r];o.push(e),e.onDisconnect.addListener(()=>{const n=o.indexOf(e);n>=0&&o.splice(n,1)}),e.onMessage.addListener(n=>{if(!n||!n.action)return;const r=getTabIdFromPort(e);switch(n.action){case"room-updated":{if(0!==e.sender.frameId)return;const s=Object.values(genericIframes[r]);for(const r of s)for(const s of r)if(s!==e)try{s.postMessage(n)}catch(e){}break}}})});