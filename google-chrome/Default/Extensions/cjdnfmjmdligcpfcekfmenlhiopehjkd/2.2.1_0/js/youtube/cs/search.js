(async()=>{const e=new RegExp('INNERTUBE_API_KEY":"(.*?)"');window.twoseven.doSearch=(async t=>{const r=[],o=await function(){const t=(document.html||document.head).innerHTML.match(e);if(!t)throw new Error("Unable to get API key");return t[1]}();try{const e=await axios.post(`https://www.youtube.com/youtubei/v1/search?key=${o}`,{context:{client:{isInternal:!0,clientName:"WEB",clientVersion:"2.20201220.08.00",newVisitorCookie:!0},user:{lockedSafetyMode:!1}},query:t}),{data:{contents:{twoColumnSearchResultsRenderer:{primaryContents:{sectionListRenderer:{contents:n}}}}}}=e,{itemSectionRenderer:s}=n[0],{contents:c}=s;for(const e of c)try{const{videoRenderer:{videoId:o,thumbnail:{thumbnails:[{url:n}]},title:{runs:[{text:s}]},ownerText:{runs:[{text:c}]}}}=e;r.push({videoSelector:"youtube",videoURL:o,videoData:{title:s,poster:n,publisher:c}})}catch(e){reportError("youtube:search:formatting",e,{query:t})}}catch(e){reportError("youtube:search:request",e,{query:t})}return r}),window.addEventListener("message",async e=>{try{const{data:t}=e,{action:r}=t;if("ts-youtube-search"!==r)return;const o={};try{const e=await window.twoseven.doSearch(t.json.query);o.data=e}catch(e){reportError("youtube:search",e,{query:t.json.query}),o.error="Failed to perform search"}postResponse(e,o)}catch(e){}})})();