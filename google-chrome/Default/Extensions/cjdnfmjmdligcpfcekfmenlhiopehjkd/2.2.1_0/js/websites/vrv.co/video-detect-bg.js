(()=>{const{twoseven:{vrv:{processConfig:e}}}=window;browser.webRequest.onBeforeRequest.addListener(async s=>{const{tabId:t,frameId:r}=s;if(s.url.includes("twoseven-bypass=true"))return;let a=await fetch(`${s.url}&twoseven-bypass=true`),n=await a.text();const o=JSON.parse(n),{__links__:{resource:{href:i}}}=o,w=new URI(`${new URL(s.url).origin}${i}`);w.addQuery(new URI(s.url).query(!0)),a=await fetch(w.toString()),n=await a.text();const c=JSON.parse(n),u=e({watch:{mediaResource:{json:c,streams:{json:o}}}});browser.tabs.executeScript(t,{allFrames:!1,frameId:r,code:`triggerEvent(window, 'found-media', ${JSON.stringify(u)})`})},{urls:["https://api.vrv.co/cms/v2/*/*/*/videos/*/streams**"]})})();