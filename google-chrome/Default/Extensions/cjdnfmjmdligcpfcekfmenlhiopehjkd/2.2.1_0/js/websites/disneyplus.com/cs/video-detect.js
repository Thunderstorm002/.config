(async()=>{if(window!==window.top)return;const e=new RegExp("https://(.*\\.)?disneyplus\\.com/(.*/)?video/.*"),t="[disney+:media-detector]",o=t,a=browser.runtime.connect({name:t});let n;async function i(t=window.location.href){n&&(n.cancel(),n=void 0),twosevenExtLog(o,`Moving to ${t}`),a.postMessage({action:"clear-tab-media"}),e.test(t)||twosevenExtLog(o,`Does not match videoRegex pattern: ${t}`);const i=await waitForDOMNode({type:"tag",value:"body"});n=waitForDOMNode({type:"selector",value:"video"},i);try{await n}catch(e){return}const s=await window.twoseven.getMediaEntry(a,t);a.postMessage({action:"add-tab-media",from:"websites/disneyplus.com/cs/video-detect",to:"bg/tag-media",data:s})}window.twoseven.getMediaEntry=((e,t,o=0)=>new Promise((a,n)=>{let i;0!==o&&(i=setTimeout(n,o)),e.onMessage.addListener(function t(o){const{action:n}=o;switch(n){case"get-media-entry":e.onMessage.removeListener(t),i&&clearTimeout(i),a(o.data)}}),e.postMessage({action:"get-media-entry",url:t})})),window.addEventListener("pushstate",e=>i(`${window.location.origin}${e.detail.data.uri}`)),i()})();