(()=>{const e="[watch-iframe]->hulu";window.twoseven.HULU_PLAYER_BUILD_URL="https://player.hulu.com/site/dash/load_player_build.js",window.twoseven.HULU_INDEX_WEBREQUEST_PATTERN="https://www.hulu.com/static-assets/h3o-browse/_next/static/*/pages/index.js",window.twoseven.HULU_INDEX_REGEX="https://www\\.hulu\\.com/static-assets/h3o-browse/_next/static/.*/pages/index.js",window.twoseven.HULU_PAGES_APP_WEBREQUEST_PATTERN="https://www.hulu.com/static-assets/*/pages/_app.js",window.twoseven.HULU_PAGES_APP_REGEX="https://www\\.hulu\\.com/static-assets/h3o-browse/_next/static/.*/pages/_app.js",window.twoseven.HULU_APP_WEBREQUEST_PATTERN="https://player.hulu.com/site/dash/*-site-curiosity/js/app.js",window.twoseven.HULU_APP_REGEX="https://player\\.hulu\\.com/site/dash/.*-site-curiosity/js/app.js",window.twoseven.HULU_NEXT_PAGES_APP_WEBREQUEST_PATTERN="https://www.hulu.com/_next/static/*/pages/_app.js",window.twoseven.HULU_NEXT_PAGES_APP_REGEX="https://www\\.hulu\\.com/_next/static/.*/pages/_app.js",window.twoseven.HULU_NEXT_INDEX_WEBREQUEST_PATTERN="https://www.hulu.com/_next/static/*/pages/index.js",window.twoseven.HULU_NEXT_INDEX_REGEX="https://www\\.hulu\\.com/_next/static/.*/pages/index.js",window.twoseven.huluPagesAppModifierMap=new ScriptModifierMap([{key:new XRegExp("(?<type>(var|const|let) )?(?<var>\\var)=(?<uid>Object\\([a-zA-Z0-9.]+\\)\\([a-zA-Z0-9.]+HULU_UID\\))"),value:new ScriptModifierEntry({replace:"let _${var} = ${uid}; ${type} ${var} = _${var} > !!_${var} && _${var} > -1 ? _${var} : '' + Date.now()"})}],"hulu:pagesAppModifier"),window.twoseven.huluPlayerBuildModifierMap=new ScriptModifierMap([{key:new XRegExp('r\\(e\\+t\\+"-site-curiosity/js/app.js"\\)'),value:new ScriptModifierEntry({replace:`\n        new Promise((resolve, reject) => {\n          const appURL = e + t + "-site-curiosity/js/app.js"\n          window.addEventListener('twoseven-hulu-app-script-added', function once () {\n            window.removeEventListener('twoseven-hulu-app-script-added', once)\n            resolve()\n            twosevenExtLog('${e}', 'Added hulu app script')\n          })\n          triggerEvent(window, 'twoseven-hulu-app-script-url', { url: appURL })\n        })\n      `})}],"hulu:playerBuildModifierMap"),window.twoseven.huluIndexModifierMap=new ScriptModifierMap([{key:new XRegExp("(?<fnstart>_loadPlayer\\((\\var,?)+\\).*?)(?<var>\\var)\\.(?<onload>onload=(?<onloadPromise>.),\\var\\.onerror=.,\\var\\.onabort=.)"),value:new ScriptModifierEntry({replace:`\n          \${fnstart}\n          void(0); const obj = {}\n          twosevenExtLog('${e}', 'Replacing index.js')\n          const promise = new Promise((resolve, reject) => {\n            obj.resolve = resolve\n            obj.reject = reject\n          })\n          promise.resolve = obj.resolve\n          promise.reject = obj.reject\n\n          let __evt__\n          window.addEventListener('tsModifyBuildScriptResponse', (evt) => {\n            const { detail: text } = evt\n            const script = document.createElement('script')\n            script.text = text\n            document.head.appendChild(script)\n            \${onloadPromise}(__evt__)\n          })\n          triggerEvent(window, 'tsModifyBuildScript', \${var}.src)\n          \${var}.src = undefined\n          \${var}.onload = __event__ => {\n            __evt__ = __event__\n          },\n          \${var}.onerror = () => { twosevenExtLog('${e}', 'triggered load_player_build.js onerror') },\n          \${var}.onabort = () => { twosevenExtLog('${e}', 'triggered load_player_build.js onabort') }\n        `})}],"hulu:indexModifierMap"),window.twoseven.huluAppModifierMap=new ScriptModifierMap([{key:new XRegExp("(?<fnstart>_proto[0-9]+.load=function load\\(\\){this.broadcast\\([a-zA-Z0-9_]+\\.WILL_LOAD_START\\);var (?<var>.)=[a-zA-Z0-9]+.playlist;)"),value:new ScriptModifierEntry({replace:"${fnstart}; window.twoseven.huluController = this.player;\n        if (${var}.initialPosition === 0) {\n          ${var}._initialPosition = 1\n        }\n        triggerEvent(window, 'controller-event', { action: 'controller-changed', position: ${var}.initialPosition * 1e3, hasIntro: !!window.__twoseven_huluHasIntro });\n        twosevenExtLog(\"changing video controller\");"})},{key:new XRegExp("(?<fnstart>_proto[0-9]+._?play=function _?play\\(\\){var [a-zA-Z0-9_]+=[a-zA-Z0-9_]+.mediaType.*?;)"),value:new ScriptModifierEntry({replace:'${fnstart}triggerEvent(window, "controller-event", { action: "play" }); return;'})},{key:new XRegExp("(?<fnstart>_proto[0-9]+._?pause=function _?pause\\(\\){var [a-zA-Z0-9_]+=[a-zA-Z0-9_]+.mediaType.*?;)"),value:new ScriptModifierEntry({replace:'${fnstart}triggerEvent(window, "controller-event", { action: "pause" }); return;'})},{key:new XRegExp("(?<fnstart>_proto[0-9]+._seek=function _seek\\((?<var>[a-zA-Z0-9_]+)\\){)(?<fncontent>.*?[a-zA-Z0-9_]+.isSeeking=!0,this.player.seek\\((?<var2>[a-zA-Z0-9_]+).appToPlayer\\(e\\)\\))"),value:new ScriptModifierEntry({replace:'${fnstart};\n        ;{\n          const positionData = ${var2}.appToPlayer(${var});\n          const position = Number.isFinite(positionData) ? positionData : positionData.position;\n          triggerEvent(window, "controller-event", { action: "seek", position }); return;\n        }\n        ${fncontent}'})},{key:new XRegExp("(?<fnstart>_proto[0-9]+.broadcast=function broadcast\\((?<var>.)\\){)(?<fncontent>for\\(var [a-zA-Z0-9_]+=arguments.length,)"),value:new ScriptModifierEntry({replace:'${fnstart}\n        // console.log(\'[hulu]: Removed bumper? event=\' + ${var})\n        if (${var} === "IntroController.startIntro") {\n          window.__twoseven_huluHasIntro = true\n        }\n        if (${var} === "VPAIDController.playAdUnit" ) { ${var} = "AdStopped"; };\n        ${fncontent}'})},{key:new XRegExp("(?<fnstart>requestFullscreen:function requestFullscreen\\(e\\){)(?<fncontent>var t=e.requestFullscreen)"),value:new ScriptModifierEntry({replace:'${fnstart}triggerEvent(window, "controller-event", { action: "fullscreen" }); return;${fncontent}'})},{key:new XRegExp("parent.defaultKID"),value:new ScriptModifierEntry({replace:"window.defaultKID"})}],"hulu:appModifierMap")})();