window.twoseven.huluLastKnownIndexScriptURL="",(async()=>{const t="[hulu:index-script-detector]";let e,n;async function o(){const o=await fetch("https://www.hulu.com"),s=await o.text(),a=(new DOMParser).parseFromString(s,"text/html"),i=a.createElement("base");i.setAttribute("href","https://www.hulu.com"),a.head.append(i);const w=[...a.querySelectorAll("link[as=script]")],c=[...a.querySelectorAll("script")],r=[...w.map(t=>t.href),...c.map(t=>t.src)].filter(t=>!!t),h=md5(JSON.stringify(r));if(e===h&&window.twoseven.huluLastKnownIndexScriptURL)try{const e=await fetch(window.twoseven.huluLastKnownIndexScriptURL),o=await e.text();if(md5(o)===n)return void twosevenExtLog(t,"no hash change.. skipping check");twosevenExtLog(t,"content hash changed")}catch(t){}let d;twosevenExtLog(t,"hash changed","warning"),e=h;for(const e of r){const o=await fetch(e),s=await o.text();if(s.includes("_loadPlayer")){twosevenExtLog(t,`Updated last known index script url: ${e}`),d=e,n=md5(s),is.chrome()&&setupCacheBuster([e],t);break}}d?d!==window.twoseven.huluLastKnownIndexScriptURL&&(window.twoseven.huluLastKnownIndexScriptURL=d):twosevenExtLog(t,"Did not find index script URL","warning")}o(),setInterval(o,18e5)})();