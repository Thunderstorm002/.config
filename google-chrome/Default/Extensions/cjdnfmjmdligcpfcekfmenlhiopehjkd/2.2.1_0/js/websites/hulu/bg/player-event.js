const huluPorts={};browser.runtime.onConnect.addListener(e=>{if("watch-iframe[hulu]"!==e.name&&"[hulu:media-detector]"!==e.name)return;const t=getTabIdFromPort(e),{sender:{frameId:r}}=e;e.onMessage.addListener(t=>{switch(t.action){case"get-index-script-url":e.postMessage({action:"get-index-script-url",data:window.twoseven.huluLastKnownIndexScriptURL})}}),e.onDisconnect.addListener(()=>{const s=huluPorts[t];try{const t=s[r];t.indexOf(e)>=0&&t.splice(t.indexOf(e),1)}catch(e){}}),huluPorts[t]||(huluPorts[t]={});const s=huluPorts[t];s[r]||(s[r]=[]),s[r].push(e)}),browser.webRequest.onBeforeRequest.addListener(e=>{const{tabId:t,frameId:r}=e;try{const s=String.fromCharCode.apply(null,new Uint8Array(e.requestBody.raw[0].bytes)),n=JSON.parse(s);huluPorts[t][r].forEach(e=>{try{e.postMessage({action:"player-event",data:n})}catch(e){}})}catch(e){}},{urls:["https://vortex.hulu.com/api/v3/event"]},["requestBody"]);