var WebPlayerSDK=function(){'use strict';var V='undefined'!=typeof globalThis?globalThis:'undefined'!=typeof window?window:'undefined'!=typeof global?global:'undefined'!=typeof self?self:{};function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,'default')?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var S=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function i(e,t,n,r){(((this.is=this).a=this).an=this).baseName=e,this.target=t,this.targetName=n,(this.negated=r)||(this.not=new i(e,t,n,!0))}return i.of=function(n){return function(e,t){return new i(n,e,t)}},i.check=function(e,t){return new i(null,e,t)},i.prototype.function=function(){return this.checkType("Function")},i.prototype.object=function(){return this.checkType("Object")},i.prototype.number=function(){return this.checkType("Number")},i.prototype.string=function(){return this.checkType("String")},i.prototype.array=function(){return this.checkType("Array")},i.prototype.null=function(){return this.verify(null===this.target,"null")},i.prototype.undefined=function(){return this.verify(void 0===this.target,"undefined")},i.prototype.empty=function(){return this.verify(null===this.target||void 0===this.target||""===this.target||this.isType("Array")&&0===this.target.length||this.isType("Object")&&!this.hasProperties(),"empty")},i.prototype.exists=function(){return this.verify(void 0!==this.target&&null!==this.target,"defined and non-null")},i.prototype.true=function(){return this.verify(!0===this.target,"true")},i.prototype.false=function(){return this.verify(!1===this.target,"false")},i.prototype.checkType=function(e){return this.verify(this.isType(e),"a "+e)},i.prototype.isType=function(e){return Object.prototype.toString.call(this.target)==="[object "+e+"]"},i.prototype.hasProperties=function(){for(var e in this.target)if(this.target.hasOwnProperty(e))return!0;return!1},i.prototype.verify=function(e,t){if(this.negated?e:!e){var n=this.baseName?"["+this.baseName+"] ":"",r=this.targetName?this.targetName+" ("+this.target+")":""+this.target;throw new Error(n+"Check failed: "+r+" was "+(this.negated?"":"not ")+t)}return this.target},i}(),r=n.of,i=n.check;t.of=r,t.check=i});e(S);S.of,S.check;var n,r,M=t(function(c){!function(e){var n,s={};s.VERSION="1.4.1";var r={},t=function(e,t){return function(){return t.apply(e,arguments)}},i=function(){var e,t,n=arguments,r=n[0];for(t=1;t<n.length;t++)for(e in n[t])e in r||!n[t].hasOwnProperty(e)||(r[e]=n[t][e]);return r},o=function(e,t){return{value:e,name:t}};s.DEBUG=o(1,'DEBUG'),s.INFO=o(2,'INFO'),s.TIME=o(3,'TIME'),s.WARN=o(4,'WARN'),s.ERROR=o(8,'ERROR'),s.OFF=o(99,'OFF');var a=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};a.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},debug:function(){this.invoke(s.DEBUG,arguments)},info:function(){this.invoke(s.INFO,arguments)},warn:function(){this.invoke(s.WARN,arguments)},error:function(){this.invoke(s.ERROR,arguments)},time:function(e){'string'==typeof e&&0<e.length&&this.invoke(s.TIME,[e,'start'])},timeEnd:function(e){'string'==typeof e&&0<e.length&&this.invoke(s.TIME,[e,'end'])},invoke:function(e,t){n&&this.enabledFor(e)&&n(t,i({level:e},this.context))}};var l,u=new a({filterLevel:s.OFF});(l=s).enabledFor=t(u,u.enabledFor),l.debug=t(u,u.debug),l.time=t(u,u.time),l.timeEnd=t(u,u.timeEnd),l.info=t(u,u.info),l.warn=t(u,u.warn),l.error=t(u,u.error),l.log=l.info,s.setHandler=function(e){n=e},s.setLevel=function(e){for(var t in u.setLevel(e),r)r.hasOwnProperty(t)&&r[t].setLevel(e)},s.getLevel=function(){return u.getLevel()},s.get=function(e){return r[e]||(r[e]=new a(i({name:e},u.context)))},s.createDefaultHandler=function(i){(i=i||{}).formatter=i.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var o={},a=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(e,t){e=Array.prototype.slice.call(e);var n,r=console.log;t.level===s.TIME?(n=(t.name?'['+t.name+'] ':'')+e[0],'start'===e[1]?console.time?console.time(n):o[n]=(new Date).getTime():console.timeEnd?console.timeEnd(n):a(r,[n+': '+((new Date).getTime()-o[n])+'ms'])):(t.level===s.WARN&&console.warn?r=console.warn:t.level===s.ERROR&&console.error?r=console.error:t.level===s.INFO&&console.info?r=console.info:t.level===s.DEBUG&&console.debug&&(r=console.debug),i.formatter(e,t),a(r,e))}},s.useDefaults=function(e){s.setLevel(e&&e.defaultLevel||s.DEBUG),s.setHandler(s.createDefaultHandler(e))},c.exports?c.exports=s:(s._prevLogger=e.Logger,s.noConflict=function(){return e.Logger=s._prevLogger,s},e.Logger=s)}(V)}),F=t(function(X,z){(function(){var e=this,t=e._,r=Array.prototype,a=Object.prototype,n=Function.prototype,i=r.push,l=r.slice,d=a.toString,o=a.hasOwnProperty,s=Array.isArray,u=Object.keys,c=n.bind,p=Object.create,f=function(){},h=function(e){return e instanceof h?e:this instanceof h?void(this._wrapped=e):new h(e)};X.exports&&(z=X.exports=h),(z._=h).VERSION='1.8.3';var m=function(i,o,e){if(void 0===o)return i;switch(null==e?3:e){case 1:return function(e){return i.call(o,e)};case 2:return function(e,t){return i.call(o,e,t)};case 3:return function(e,t,n){return i.call(o,e,t,n)};case 4:return function(e,t,n,r){return i.call(o,e,t,n,r)}}return function(){return i.apply(o,arguments)}},y=function(e,t,n){return null==e?h.identity:h.isFunction(e)?m(e,t,n):h.isObject(e)?h.matcher(e):h.property(e)};h.iteratee=function(e,t){return y(e,t,1/0)};var g=function(l,u){return function(e){var t=arguments.length;if(t<2||null==e)return e;for(var n=1;n<t;n++)for(var r=arguments[n],i=l(r),o=i.length,a=0;a<o;a++){var s=i[a];u&&void 0!==e[s]||(e[s]=r[s])}return e}},v=function(e){if(!h.isObject(e))return{};if(p)return p(e);f.prototype=e;var t=new f;return f.prototype=null,t},S=function(t){return function(e){return null==e?void 0:e[t]}},b=Math.pow(2,53)-1,T=S('length'),P=function(e){var t=T(e);return'number'==typeof t&&0<=t&&t<=b};function w(s){return function(e,t,n,r){t=m(t,r,4);var i=!P(e)&&h.keys(e),o=(i||e).length,a=0<s?0:o-1;return arguments.length<3&&(n=e[i?i[a]:a],a+=s),function(e,t,n,r,i,o){for(;0<=i&&i<o;i+=s){var a=r?r[i]:i;n=t(n,e[a],a,e)}return n}(e,t,n,i,a,o)}}h.each=h.forEach=function(e,t,n){var r,i;if(t=m(t,n),P(e))for(r=0,i=e.length;r<i;r++)t(e[r],r,e);else{var o=h.keys(e);for(r=0,i=o.length;r<i;r++)t(e[o[r]],o[r],e)}return e},h.map=h.collect=function(e,t,n){t=y(t,n);for(var r=!P(e)&&h.keys(e),i=(r||e).length,o=Array(i),a=0;a<i;a++){var s=r?r[a]:a;o[a]=t(e[s],s,e)}return o},h.reduce=h.foldl=h.inject=w(1),h.reduceRight=h.foldr=w(-1),h.find=h.detect=function(e,t,n){var r;if(void 0!==(r=P(e)?h.findIndex(e,t,n):h.findKey(e,t,n))&&-1!==r)return e[r]},h.filter=h.select=function(e,r,t){var i=[];return r=y(r,t),h.each(e,function(e,t,n){r(e,t,n)&&i.push(e)}),i},h.reject=function(e,t,n){return h.filter(e,h.negate(y(t)),n)},h.every=h.all=function(e,t,n){t=y(t,n);for(var r=!P(e)&&h.keys(e),i=(r||e).length,o=0;o<i;o++){var a=r?r[o]:o;if(!t(e[a],a,e))return!1}return!0},h.some=h.any=function(e,t,n){t=y(t,n);for(var r=!P(e)&&h.keys(e),i=(r||e).length,o=0;o<i;o++){var a=r?r[o]:o;if(t(e[a],a,e))return!0}return!1},h.contains=h.includes=h.include=function(e,t,n,r){return P(e)||(e=h.values(e)),('number'!=typeof n||r)&&(n=0),0<=h.indexOf(e,t,n)},h.invoke=function(e,n){var r=l.call(arguments,2),i=h.isFunction(n);return h.map(e,function(e){var t=i?n:e[n];return null==t?t:t.apply(e,r)})},h.pluck=function(e,t){return h.map(e,h.property(t))},h.where=function(e,t){return h.filter(e,h.matcher(t))},h.findWhere=function(e,t){return h.find(e,h.matcher(t))},h.max=function(e,r,t){var n,i,o=-1/0,a=-1/0;if(null==r&&null!=e)for(var s=0,l=(e=P(e)?e:h.values(e)).length;s<l;s++)n=e[s],o<n&&(o=n);else r=y(r,t),h.each(e,function(e,t,n){i=r(e,t,n),(a<i||i===-1/0&&o===-1/0)&&(o=e,a=i)});return o},h.min=function(e,r,t){var n,i,o=1/0,a=1/0;if(null==r&&null!=e)for(var s=0,l=(e=P(e)?e:h.values(e)).length;s<l;s++)(n=e[s])<o&&(o=n);else r=y(r,t),h.each(e,function(e,t,n){((i=r(e,t,n))<a||i===1/0&&o===1/0)&&(o=e,a=i)});return o},h.shuffle=function(e){for(var t,n=P(e)?e:h.values(e),r=n.length,i=Array(r),o=0;o<r;o++)(t=h.random(0,o))!==o&&(i[o]=i[t]),i[t]=n[o];return i},h.sample=function(e,t,n){return null==t||n?(P(e)||(e=h.values(e)),e[h.random(e.length-1)]):h.shuffle(e).slice(0,Math.max(0,t))},h.sortBy=function(e,r,t){return r=y(r,t),h.pluck(h.map(e,function(e,t,n){return{value:e,index:t,criteria:r(e,t,n)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index-t.index}),'value')};var C=function(a){return function(r,i,e){var o={};return i=y(i,e),h.each(r,function(e,t){var n=i(e,t,r);a(o,e,n)}),o}};h.groupBy=C(function(e,t,n){h.has(e,n)?e[n].push(t):e[n]=[t]}),h.indexBy=C(function(e,t,n){e[n]=t}),h.countBy=C(function(e,t,n){h.has(e,n)?e[n]++:e[n]=1}),h.toArray=function(e){return e?h.isArray(e)?l.call(e):P(e)?h.map(e,h.identity):h.values(e):[]},h.size=function(e){return null==e?0:P(e)?e.length:h.keys(e).length},h.partition=function(e,r,t){r=y(r,t);var i=[],o=[];return h.each(e,function(e,t,n){(r(e,t,n)?i:o).push(e)}),[i,o]},h.first=h.head=h.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:h.initial(e,e.length-t)},h.initial=function(e,t,n){return l.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},h.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:h.rest(e,Math.max(0,e.length-t))},h.rest=h.tail=h.drop=function(e,t,n){return l.call(e,null==t||n?1:t)},h.compact=function(e){return h.filter(e,h.identity)};var M=function(e,t,n,r){for(var i=[],o=0,a=r||0,s=T(e);a<s;a++){var l=e[a];if(P(l)&&(h.isArray(l)||h.isArguments(l))){t||(l=M(l,t,n));var u=0,c=l.length;for(i.length+=c;u<c;)i[o++]=l[u++]}else n||(i[o++]=l)}return i};function I(o){return function(e,t,n){t=y(t,n);for(var r=T(e),i=0<o?0:r-1;0<=i&&i<r;i+=o)if(t(e[i],i,e))return i;return-1}}function E(o,a,s){return function(e,t,n){var r=0,i=T(e);if('number'==typeof n)0<o?r=0<=n?n:Math.max(n+i,r):i=0<=n?Math.min(n+1,i):n+i+1;else if(s&&n&&i)return e[n=s(e,t)]===t?n:-1;if(t!=t)return 0<=(n=a(l.call(e,r,i),h.isNaN))?n+r:-1;for(n=0<o?r:i-1;0<=n&&n<i;n+=o)if(e[n]===t)return n;return-1}}h.flatten=function(e,t){return M(e,t,!1)},h.without=function(e){return h.difference(e,l.call(arguments,1))},h.uniq=h.unique=function(e,t,n,r){h.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=y(n,r));for(var i=[],o=[],a=0,s=T(e);a<s;a++){var l=e[a],u=n?n(l,a,e):l;t?(a&&o===u||i.push(l),o=u):n?h.contains(o,u)||(o.push(u),i.push(l)):h.contains(i,l)||i.push(l)}return i},h.union=function(){return h.uniq(M(arguments,!0,!0))},h.intersection=function(e){for(var t=[],n=arguments.length,r=0,i=T(e);r<i;r++){var o=e[r];if(!h.contains(t,o)){for(var a=1;a<n&&h.contains(arguments[a],o);a++);a===n&&t.push(o)}}return t},h.difference=function(e){var t=M(arguments,!0,!0,1);return h.filter(e,function(e){return!h.contains(t,e)})},h.zip=function(){return h.unzip(arguments)},h.unzip=function(e){for(var t=e&&h.max(e,T).length||0,n=Array(t),r=0;r<t;r++)n[r]=h.pluck(e,r);return n},h.object=function(e,t){for(var n={},r=0,i=T(e);r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},h.findIndex=I(1),h.findLastIndex=I(-1),h.sortedIndex=function(e,t,n,r){for(var i=(n=y(n,r,1))(t),o=0,a=T(e);o<a;){var s=Math.floor((o+a)/2);n(e[s])<i?o=s+1:a=s}return o},h.indexOf=E(1,h.findIndex,h.sortedIndex),h.lastIndexOf=E(-1,h.findLastIndex),h.range=function(e,t,n){null==t&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=Array(r),o=0;o<r;o++,e+=n)i[o]=e;return i};var _=function(e,t,n,r,i){if(!(r instanceof t))return e.apply(n,i);var o=v(e.prototype),a=e.apply(o,i);return h.isObject(a)?a:o};h.bind=function(e,t){if(c&&e.bind===c)return c.apply(e,l.call(arguments,1));if(!h.isFunction(e))throw new TypeError('Bind must be called on a function');var n=l.call(arguments,2),r=function(){return _(e,r,t,this,n.concat(l.call(arguments)))};return r},h.partial=function(i){var o=l.call(arguments,1),a=function(){for(var e=0,t=o.length,n=Array(t),r=0;r<t;r++)n[r]=o[r]===h?arguments[e++]:o[r];for(;e<arguments.length;)n.push(arguments[e++]);return _(i,a,this,this,n)};return a},h.bindAll=function(e){var t,n,r=arguments.length;if(r<=1)throw new Error('bindAll must be passed function names');for(t=1;t<r;t++)e[n=arguments[t]]=h.bind(e[n],e);return e},h.memoize=function(r,i){var o=function(e){var t=o.cache,n=''+(i?i.apply(this,arguments):e);return h.has(t,n)||(t[n]=r.apply(this,arguments)),t[n]};return o.cache={},o},h.delay=function(e,t){var n=l.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},h.defer=h.partial(h.delay,h,1),h.throttle=function(n,r,i){var o,a,s,l=null,u=0;i||(i={});var c=function(){u=!1===i.leading?0:h.now(),l=null,s=n.apply(o,a),l||(o=a=null)};return function(){var e=h.now();u||!1!==i.leading||(u=e);var t=r-(e-u);return o=this,a=arguments,t<=0||r<t?(l&&(clearTimeout(l),l=null),u=e,s=n.apply(o,a),l||(o=a=null)):l||!1===i.trailing||(l=setTimeout(c,t)),s}},h.debounce=function(t,n,r){var i,o,a,s,l,u=function(){var e=h.now()-s;e<n&&0<=e?i=setTimeout(u,n-e):(i=null,r||(l=t.apply(a,o),i||(a=o=null)))};return function(){a=this,o=arguments,s=h.now();var e=r&&!i;return i||(i=setTimeout(u,n)),e&&(l=t.apply(a,o),a=o=null),l}},h.wrap=function(e,t){return h.partial(t,e)},h.negate=function(e){return function(){return!e.apply(this,arguments)}},h.compose=function(){var n=arguments,r=n.length-1;return function(){for(var e=r,t=n[r].apply(this,arguments);e--;)t=n[e].call(this,t);return t}},h.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},h.before=function(e,t){var n;return function(){return 0<--e&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}},h.once=h.partial(h.before,2);var x=!{toString:null}.propertyIsEnumerable('toString'),k=['valueOf','isPrototypeOf','toString','propertyIsEnumerable','hasOwnProperty','toLocaleString'];function R(e,t){var n=k.length,r=e.constructor,i=h.isFunction(r)&&r.prototype||a,o='constructor';for(h.has(e,o)&&!h.contains(t,o)&&t.push(o);n--;)(o=k[n])in e&&e[o]!==i[o]&&!h.contains(t,o)&&t.push(o)}h.keys=function(e){if(!h.isObject(e))return[];if(u)return u(e);var t=[];for(var n in e)h.has(e,n)&&t.push(n);return x&&R(e,t),t},h.allKeys=function(e){if(!h.isObject(e))return[];var t=[];for(var n in e)t.push(n);return x&&R(e,t),t},h.values=function(e){for(var t=h.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=e[t[i]];return r},h.mapObject=function(e,t,n){t=y(t,n);for(var r,i=h.keys(e),o=i.length,a={},s=0;s<o;s++)a[r=i[s]]=t(e[r],r,e);return a},h.pairs=function(e){for(var t=h.keys(e),n=t.length,r=Array(n),i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},h.invert=function(e){for(var t={},n=h.keys(e),r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},h.functions=h.methods=function(e){var t=[];for(var n in e)h.isFunction(e[n])&&t.push(n);return t.sort()},h.extend=g(h.allKeys),h.extendOwn=h.assign=g(h.keys),h.findKey=function(e,t,n){t=y(t,n);for(var r,i=h.keys(e),o=0,a=i.length;o<a;o++)if(t(e[r=i[o]],r,e))return r},h.pick=function(e,t,n){var r,i,o={},a=e;if(null==a)return o;h.isFunction(t)?(i=h.allKeys(a),r=m(t,n)):(i=M(arguments,!1,!1,1),r=function(e,t,n){return t in n},a=Object(a));for(var s=0,l=i.length;s<l;s++){var u=i[s],c=a[u];r(c,u,a)&&(o[u]=c)}return o},h.omit=function(e,t,n){if(h.isFunction(t))t=h.negate(t);else{var r=h.map(M(arguments,!1,!1,1),String);t=function(e,t){return!h.contains(r,t)}}return h.pick(e,t,n)},h.defaults=g(h.allKeys,!0),h.create=function(e,t){var n=v(e);return t&&h.extendOwn(n,t),n},h.clone=function(e){return h.isObject(e)?h.isArray(e)?e.slice():h.extend({},e):e},h.tap=function(e,t){return t(e),e},h.isMatch=function(e,t){var n=h.keys(t),r=n.length;if(null==e)return!r;for(var i=Object(e),o=0;o<r;o++){var a=n[o];if(t[a]!==i[a]||!(a in i))return!1}return!0};var A=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof h&&(e=e._wrapped),t instanceof h&&(t=t._wrapped);var i=d.call(e);if(i!==d.call(t))return!1;switch(i){case'[object RegExp]':case'[object String]':return''+e==''+t;case'[object Number]':return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case'[object Date]':case'[object Boolean]':return+e==+t}var o='[object Array]'===i;if(!o){if('object'!=typeof e||'object'!=typeof t)return!1;var a=e.constructor,s=t.constructor;if(a!==s&&!(h.isFunction(a)&&a instanceof a&&h.isFunction(s)&&s instanceof s)&&'constructor'in e&&'constructor'in t)return!1}r=r||[];for(var l=(n=n||[]).length;l--;)if(n[l]===e)return r[l]===t;if(n.push(e),r.push(t),o){if((l=e.length)!==t.length)return!1;for(;l--;)if(!A(e[l],t[l],n,r))return!1}else{var u,c=h.keys(e);if(l=c.length,h.keys(t).length!==l)return!1;for(;l--;)if(u=c[l],!h.has(t,u)||!A(e[u],t[u],n,r))return!1}return n.pop(),r.pop(),!0};h.isEqual=function(e,t){return A(e,t)},h.isEmpty=function(e){return null==e||(P(e)&&(h.isArray(e)||h.isString(e)||h.isArguments(e))?0===e.length:0===h.keys(e).length)},h.isElement=function(e){return!(!e||1!==e.nodeType)},h.isArray=s||function(e){return'[object Array]'===d.call(e)},h.isObject=function(e){var t=typeof e;return'function'===t||'object'===t&&!!e},h.each(['Arguments','Function','String','Number','Date','RegExp','Error'],function(t){h['is'+t]=function(e){return d.call(e)==='[object '+t+']'}}),h.isArguments(arguments)||(h.isArguments=function(e){return h.has(e,'callee')}),'function'!=typeof/./&&'object'!=typeof Int8Array&&(h.isFunction=function(e){return'function'==typeof e||!1}),h.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},h.isNaN=function(e){return h.isNumber(e)&&e!==+e},h.isBoolean=function(e){return!0===e||!1===e||'[object Boolean]'===d.call(e)},h.isNull=function(e){return null===e},h.isUndefined=function(e){return void 0===e},h.has=function(e,t){return null!=e&&o.call(e,t)},h.noConflict=function(){return e._=t,this},h.identity=function(e){return e},h.constant=function(e){return function(){return e}},h.noop=function(){},h.property=S,h.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},h.matcher=h.matches=function(t){return t=h.extendOwn({},t),function(e){return h.isMatch(e,t)}},h.times=function(e,t,n){var r=Array(Math.max(0,e));t=m(t,n,1);for(var i=0;i<e;i++)r[i]=t(i);return r},h.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},h.now=Date.now||function(){return(new Date).getTime()};var O={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#x27;','`':'&#x60;'},L=h.invert(O),F=function(t){var n=function(e){return t[e]},e='(?:'+h.keys(t).join('|')+')',r=RegExp(e),i=RegExp(e,'g');return function(e){return e=null==e?'':''+e,r.test(e)?e.replace(i,n):e}};h.escape=F(O),h.unescape=F(L),h.result=function(e,t,n){var r=null==e?void 0:e[t];return void 0===r&&(r=n),h.isFunction(r)?r.call(e):r};var D=0;h.uniqueId=function(e){var t=++D+'';return e?e+t:t},h.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,U={"'":"'",'\\':'\\','\r':'r','\n':'n','\u2028':'u2028','\u2029':'u2029'},B=/\\|'|\r|\n|\u2028|\u2029/g,V=function(e){return'\\'+U[e]};h.template=function(o,e,t){!e&&t&&(e=t),e=h.defaults({},e,h.templateSettings);var n=RegExp([(e.escape||N).source,(e.interpolate||N).source,(e.evaluate||N).source].join('|')+'|$','g'),a=0,s="__p+='";o.replace(n,function(e,t,n,r,i){return s+=o.slice(a,i).replace(B,V),a=i+e.length,t?s+="'+\n((__t=("+t+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":r&&(s+="';\n"+r+"\n__p+='"),e}),s+="';\n",e.variable||(s='with(obj||{}){\n'+s+'}\n'),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+'return __p;\n';try{var r=new Function(e.variable||'obj','_',s)}catch(e){throw e.source=s,e}var i=function(e){return r.call(this,e,h)},l=e.variable||'obj';return i.source='function('+l+'){\n'+s+'}',i},h.chain=function(e){var t=h(e);return t._chain=!0,t};var j=function(e,t){return e._chain?h(t).chain():t};h.mixin=function(n){h.each(h.functions(n),function(e){var t=h[e]=n[e];h.prototype[e]=function(){var e=[this._wrapped];return i.apply(e,arguments),j(this,t.apply(h,e))}})},h.mixin(h),h.each(['pop','push','reverse','shift','sort','splice','unshift'],function(t){var n=r[t];h.prototype[t]=function(){var e=this._wrapped;return n.apply(e,arguments),'shift'!==t&&'splice'!==t||0!==e.length||delete e[0],j(this,e)}}),h.each(['concat','join','slice'],function(e){var t=r[e];h.prototype[e]=function(){return j(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},h.prototype.valueOf=h.prototype.toJSON=h.prototype.value,h.prototype.toString=function(){return''+this._wrapped}}).call(V)}),i=(F._,function(){function t(){}return t.isClassic=function(e){switch(e){case t.DE:case t.JP:case t.UK:case t.US:return!0}return!1},t.ROE_EU="A3K6Y4MI8GDYMT",t.ROW_EU="A2MFUE2XK8ZSSY",t.ROW_FE="A15PK738MTQHSO",t.ROW_NA="ART4WZ8MWBX2Y",t.DE="A1PA6795UKMFR9",t.JP="A1VC38T7YXB528",t.UK="A1F83G8C2ARO7P",t.US="ATVPDKIKX0DER",t}()),a=function(){function n(){}return n.isAmazon=function(e,t){return void 0===t&&(t=window),e=null==e?t.location.hostname:e,n.AMAZON_REGEX.test(e)},n.fromMarketplaceId=function(e){switch(e){case i.DE:return n.DE;case i.JP:return n.JP;case i.UK:return n.UK;case i.ROE_EU:case i.ROW_EU:case i.ROW_FE:case i.ROW_NA:return n.PRIME_VIDEO;case i.US:return n.US;default:throw new Error("Can't get AmazonFQDN for unknown MarketplaceId! Received: "+e)}},n.AMAZON_REGEX=/((.*\.|^)amazon\..*|(.*\.|^)primevideo\..*)/,n.DE="www.amazon.de",n.JP="www.amazon.co.jp",n.UK="www.amazon.co.uk",n.US="www.amazon.com",n.PRIME_VIDEO="www.primevideo.com",n}(),o=function(){function e(){}return e.SILVERLIGHT_PC="A63V4FRV3YUP9",e.SILVERLIGHT_MAC="A2G17C9GWLWFKO",e.HTML5="AOAGZA014O5RE",e}(),s={aar:"aa",abk:"ab",afr:"af",aka:"ak",amh:"am",ara:"ar",arg:"an",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",cat:"ca",ces:"cs",cha:"ch",che:"ce",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",dan:"da",deu:"de",div:"dv",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fry:"fy",ful:"ff",gla:"gd",gle:"ga",glg:"gl",glv:"gv",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mah:"mh",mal:"ml",mar:"mr",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"},l=function(){function e(){}return e.BACKSPACE=8,e.DELETE=46,e.ESC=27,e.SHIFT=16,e.SPACE=32,e.TAB=9,e.A=65,e.C=67,e.F=70,e.M=77,e.LEFT_ARROW=37,e.UP_ARROW=38,e.RIGHT_ARROW=39,e.DOWN_ARROW=40,e.START_OF_NUMBER=48,e.END_OF_NUMBER=57,e.START_OF_NUMPAD=96,e.END_OF_NUMPAD=105,e}(),u=function(){function r(){}return r.fromMarketplaceId=function(e){var t,n=r.getDomainFromMarketplaceId(e);switch(e){case i.ROW_NA:case i.US:t=r.US_REGION;break;case i.ROE_EU:case i.ROW_EU:case i.UK:case i.DE:t=r.EU_REGION;break;case i.ROW_FE:case i.JP:t=r.JP_REGION;break;default:throw new Error("Can't get PartnerServiceEndpoint for unknown MarketplaceId! Received: "+e)}return r.PROTOCOL+t+n},r.getDomainFromMarketplaceId=function(e){switch(e){case i.ROW_NA:case i.ROE_EU:case i.ROW_EU:case i.ROW_FE:return".primevideo.com";case i.DE:return".amazon.de";case i.JP:return".amazon.co.jp";case i.UK:return".amazon.co.uk";default:return".amazon.com"}},r.EU_REGION="atv-ps-eu",r.JP_REGION="atv-ps-fe",r.US_REGION="atv-ps",r.DOMAIN_REGEX=/.*(\.(amazon|primevideo)\..*)/,r.DEFAULT_DOMAIN=".amazon.com",r.PROTOCOL="https://",r}(),c=function(){function e(){}return e.DiagnosticsEndpointKey="diagnostics_url",e}(),d=function(){function e(){}return e.EXTRA_SMALL_SCREEN_MAX_WIDTH=479,e.SMALL_SCREEN_MIN_WIDTH=480,e.MEDIUM_SCREEN_MIN_WIDTH=640,e.LARGE_SCREEN_MIN_WIDTH=1200,e.EXTRA_LARGE_SCREEN_MIN_WIDTH=1921,e.SCALE_FACTOR_EXTRA_SMALL=1,e.SCALE_FACTOR_SMALL=100/e.SMALL_SCREEN_MIN_WIDTH,e.SCALE_FACTOR_MEDIUM=100/e.MEDIUM_SCREEN_MIN_WIDTH,e.SCALE_FACTOR_LARGE=100/e.LARGE_SCREEN_MIN_WIDTH,e.SCALE_FACTOR_EXTRA_LARGE=100/e.EXTRA_LARGE_SCREEN_MIN_WIDTH,e.SCREEN_EXTRA_SMALL_MEDIA_QUERY="(max-width: "+e.EXTRA_SMALL_SCREEN_MAX_WIDTH+"px)",e.SCREEN_SMALL_MEDIA_QUERY="(min-width: "+e.SMALL_SCREEN_MIN_WIDTH+"px)",e.SCREEN_MEDIUM_MEDIA_QUERY="(min-width: "+e.MEDIUM_SCREEN_MIN_WIDTH+"px)",e.SCREEN_LARGE_MEDIA_QUERY="(min-width: "+e.LARGE_SCREEN_MIN_WIDTH+"px)",e.SCREEN_EXTRA_LARGE_MEDIA_QUERY="(min-width: "+e.EXTRA_LARGE_SCREEN_MIN_WIDTH+"px)",e}(),p=function(){function e(){}return e.getActiveWeblabs=function(){return[e.ATV_WEB_PLAYER_OAUTH,e.HTML5_HEVC,e.DISABLE_SILVERLIGHT,e.HTML5_SAX_MANIFEST_PARSER,e.HTML5_SAFARI_CVBR,e.HTML5_SAFARI_LIVE,e.HTML5_NETWORK_SEED,e.HTML5_NETWORK_STATUS_TOAST,e.HTML5_REMOVE_BUFFER_SIZE_RATIO,e.HTML5_USE_PLAYBACK_URLS,e.HTML5_MAX_DRIFT_MITIGATION_THRESHOLD,e.HTML5_TNF_BASELINE_SKIP,e.HTML5_CAROUSEL,e.HTML5_HASTUR_MATURITY_RATING_OVERLAY,e.LIVE_LOW_LATENCY_CHROME,e.LIVE_LOW_LATENCY_CHROMIUM,e.LIVE_LOW_LATENCY_FIREFOX,e.LIVE_LOW_LATENCY_FIREFOX64,e.LIVE_LOW_LATENCY_OPERA]},e.ATV_WEB_PLAYER_OAUTH="ATV_WEB_PLAYER_OAUTH_74228",e.HTML5_HEVC="AIV_HTML5_HEVC_79711",e.DISABLE_SILVERLIGHT="AIV_WEB_PLAYER_DISABLE_SILVERLIGHT_91138",e.HTML5_SAX_MANIFEST_PARSER="AIV_HTML5_SAX_MANIFEST_PARSER_89833",e.HTML5_SAFARI_CVBR="AIV_HTML5_SAFARI_CVBR_93874",e.HTML5_SAFARI_LIVE="AIV_HTML5_SAFARI_LIVE_107851",e.HTML5_NETWORK_SEED="AIV_HTML5_NETWORK_SEED_95840",e.HTML5_NETWORK_STATUS_TOAST="AIV_HTML5_NETWORK_STATUS_TOAST_98636",e.HTML5_REMOVE_BUFFER_SIZE_RATIO="AIV_HTML5_REMOVE_BUFFER_SIZE_RATIO_99314",e.HTML5_USE_PLAYBACK_URLS="AIV_HTML5_USE_PLAYBACK_URLS_107655",e.HTML5_MAX_DRIFT_MITIGATION_THRESHOLD="AIV_HTML5_MAX_DRIFT_MITIGATION_THRESHOLD_121641",e.HTML5_TNF_BASELINE_SKIP="AIV_HTML5_TNF_BASELINE_SKIP_125764",e.HTML5_CAROUSEL="AIV_HTML5_MIRO_CAROUSEL_196734",e.HTML5_HASTUR_MATURITY_RATING_OVERLAY="AIV_HTML5_HASTUR_MATURITY_RATING_OVERLAY_272841",e.LIVE_LOW_LATENCY_CHROME="AIV_HTML5_LIVE_LOW_LATENCY_CHROME_242583",e.LIVE_LOW_LATENCY_CHROMIUM="AIV_HTML5_LIVE_LOW_LATENCY_CHROMIUM_242584",e.LIVE_LOW_LATENCY_FIREFOX="AIV_HTML5_LIVE_LOW_LATENCY_FIREFOX_242581",e.LIVE_LOW_LATENCY_FIREFOX64="AIV_HTML5_LIVE_LOW_LATENCY_FIREFOX64_242582",e.LIVE_LOW_LATENCY_OPERA="AIV_HTML5_LIVE_LOW_LATENCY_OPERA_242580",e}();(r=n||(n={}))[r.C=0]="C",r[r.T1=1]="T1",r[r.T2=2]="T2",r[r.T3=3]="T3",r[r.T4=4]="T4",r[r.T5=5]="T5",r[r.T6=6]="T6",r[r.T7=7]="T7",r[r.T8=8]="T8",r[r.T9=9]="T9",r[r.T10=10]="T10",r[r.T11=11]="T11",r[r.T12=12]="T12",r[r.T13=13]="T13",r[r.T14=14]="T14",r[r.T15=15]="T15",r[r.T16=16]="T16",r[r.T17=17]="T17",r[r.T18=18]="T18",r[r.T19=19]="T19",r[r.T20=20]="T20";var Y={AmazonFQDN:a,DeviceTypeId:o,IsoLanguageCodeMap:s,KeyCode:l,MarketplaceID:i,PartnerServiceEndpoint:u,StorageKeys:c,Styling:d,Weblabs:p,WeblabTreatment:n},f=S.of("AmazonUrlCreator"),h=function(){function o(e,t,n){void 0===n&&(n=window),this.marketplaceId=f(e,"marketplaceId").exists(),this.csUrlPathMap=f(t,"csUrlPathMap").exists(),this.windowRef=f(n,"windowRef").exists()}return o.prototype.createCSUrl=function(e){f(this.csUrlPathMap[e],"csUrlPathMap[csUrlPathKey]").exists();var t=this.windowRef.location.hostname,n=t,r=this.csUrlPathMap[e][n];(F.isNull(r)||F.isUndefined(r))&&(t=a.fromMarketplaceId(this.marketplaceId),n=this.marketplaceId);var i=this.csUrlPathMap[e][n];return(F.isNull(i)||F.isUndefined(i))&&(n=o.DEFAULT_ID),t+this.csUrlPathMap[e][n]},o.prototype.createDetailPageUrl=function(e){var t=this.windowRef.location.hostname;return a.isAmazon(t,this.windowRef)||(t=a.fromMarketplaceId(this.marketplaceId)),t+o.DETAIL_PAGE_BASE+e},o.DEFAULT_ID="*",o.DETAIL_PAGE_BASE="/dp/",o}(),m=M.get("CookieStorage"),y=function(){function e(e){void 0===e&&(e=document),this.document=e}return e.prototype.get=function(t){try{if(null==this.document.cookie)return m.warn("Cookie is unavailable."),null;var e=F.map(this.document.cookie.split(";"),function(e){return e.split("=")}),n=F.find(e,function(e){return e[0].trim()===t});return null==n?(m.warn("Cannot find key "+t+" in storage"),null):(n.shift(),decodeURIComponent(n.join("=")))}catch(e){return m.warn("Failed to retrieve key "+t+" from storage",e),null}},e}(),g=function(){function e(){}return e.getPlayerSize=function(e,t,n){return void 0===n&&(n=1),{width:e*n,height:t*n}},e}(),v=S.of("DOMUtils"),b=function(){function e(){}return e.getAttributeOrThrow=function(e,t){v(e,"element").exists(),v(t,"attribute").exists();var n=e.getAttribute(t);if(null===n)throw new Error("Unable to get attribute '"+t+"'");return n},e.querySelectOrThrow=function(e,t){v(e,"element").exists(),v(t,"query").exists();var n=e.querySelector(t);if(null===n)throw new Error("Unable to querySelect '"+t+"'");return n},e.querySelectAllOrThrow=function(e,t){v(e,"element").exists(),v(t,"query").exists();var n=e.querySelectorAll(t);if(null===n||0===n.length)throw new Error("Unable to querySelectAll '"+t+"'");return n},e.getAttributesInNamespace=function(e,t){var n=[];if(t+=":",e.hasAttributes())for(var r=0;r<e.attributes.length;r++)e.attributes[r].name.substr(0,t.length)===t&&n.push(e.attributes[r].name);return n},e.getAttributeWithoutNamespace=function(e){var t=e.match(/.*:(.*)/);return null===t||t.length<2?e:t[1]},e}(),T=M.get("EnumUtils"),P=function(){function e(){}return e.getEnumValue=function(t,e){if(null==t)return null;if(!F.isString(t))return T.warn("Value must be a string but was "+t),null;if(F.isEmpty(t))return T.warn("Value cannot be an empty string"),null;var n=[];for(var r in e)F.isNumber(e[r])&&n.push(r);var i=F.find(n,function(e){return e.toLowerCase()===t.toLowerCase()});return null==i?(T.warn("Value must be one of ["+n.join(",")+"], but was "+t),null):e[i]},e}(),w=function(){function e(e){this.ephemeralIds=[],this.logger=M.get(e)}return e.prototype.log=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.logger).log.apply(e,[this.getId()].concat(t))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.info=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.logger).info.apply(e,[this.getId()].concat(t))},e.prototype.warn=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.logger).warn.apply(e,[this.getId()].concat(t))},e.prototype.error=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.logger).error.apply(e,[this.getId()].concat(t))},e.prototype.setId=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ephemeralIds=e},e.prototype.getId=function(){return F.map(this.ephemeralIds,function(e){return"["+e+"]"}).join(" ")},e}(),C=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){void 0===e&&(e=window),this.windowRef=e}return e.prototype.setImmediate=function(e){return this.windowRef.setImmediate(e)},e.prototype.clearImmediate=function(e){this.windowRef.clearImmediate(e)},e.isSupported=function(e){return void 0===e&&(e=window),null!=e&&F.isFunction(e.setImmediate)&&F.isFunction(e.clearImmediate)},e}();t.ImmediateComponentDirect=n});e(C);C.ImmediateComponentDirect;var I=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function o(e,t){void 0===e&&(e=window),void 0===t&&(t="setImmediate-"+Math.random());var r=this;this.pendingHandlers={},this.nextId=1,this.onPostMessage=function(e){if(F.isString(e.data)&&0===e.data.indexOf(r.messageIdentifier)){var t=parseInt(e.data.substr(r.messageIdentifier.length)),n=r.pendingHandlers[t];null!=n&&(r.clearImmediate(t),n())}},this.windowRef=e,this.messageIdentifier=t;var n=e.location,i=n.port?":"+n.port:"";this.origin=this.isOriginValid(n.origin)?n.origin:n.protocol+"//"+n.hostname+i,e.addEventListener(o.MESSAGE_EVENT,this.onPostMessage)}return o.prototype.setImmediate=function(e){return F.isFunction(e)&&(this.pendingHandlers[this.nextId]=e,this.windowRef.postMessage(this.messageIdentifier+this.nextId,this.origin)),this.nextId++},o.prototype.clearImmediate=function(e){delete this.pendingHandlers[e]},o.isSupported=function(e){return void 0===e&&(e=window),null!=e&&F.isFunction(e.postMessage)&&F.isFunction(e.addEventListener)},o.prototype.isOriginValid=function(e){return null!=e&&-1!==e.indexOf("://")},o.MESSAGE_EVENT="message",o}();t.ImmediateComponentPostMessage=n});e(I);I.ImmediateComponentPostMessage;var E=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){void 0===e&&(e=window),this.windowRef=e}return e.prototype.setImmediate=function(e){return this.windowRef.setTimeout(e,0)},e.prototype.clearImmediate=function(e){this.windowRef.clearTimeout(e)},e.isSupported=function(e){return void 0===e&&(e=window),null!=e&&F.isFunction(e.setTimeout)&&F.isFunction(e.clearTimeout)},e}();t.ImmediateComponentTimeout=n});e(E);E.ImmediateComponentTimeout;var _=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("ImmediateComponentPromise"),n=function(){function e(e){void 0===e&&(e=window);var i=this;this.lastId=0,this.pendingIdMap={},this.pendingImmediate=!1,this.onNextMicrotask=function(){var e=i.pendingIdMap;i.pendingIdMap={},i.pendingImmediate=!1;for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];try{e[r]()}catch(e){o.warn("Unhandled handler exception",e,e.stack)}}},this.promiseRef=e.Promise}return e.prototype.setImmediate=function(e){var t=this.lastId++;return this.pendingIdMap[t]=e,this.pendingImmediate||(this.pendingImmediate=!0,this.promiseRef.resolve().then(this.onNextMicrotask)),t},e.prototype.clearImmediate=function(e){delete this.pendingIdMap[e]},e.isSupported=function(e){return null!=e&&null!=e.Promise},e}();t.ImmediateComponentPromise=n});e(_);_.ImmediateComponentPromise;var x=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e=[_.ImmediateComponentPromise,C.ImmediateComponentDirect,I.ImmediateComponentPostMessage,E.ImmediateComponentTimeout]),void 0===t&&(t=window),this.windowRef=t;var n=F.find(e,function(e){return e.isSupported(t)});if(null==n)throw Error("No supported immediate component type");this.immediateComponent=new n}return e.prototype.setTimeout=function(e,t){return this.windowRef.setTimeout(e,t)},e.prototype.clearTimeout=function(e){this.windowRef.clearTimeout(e)},e.prototype.setInterval=function(e,t){return this.windowRef.setInterval(e,t)},e.prototype.clearInterval=function(e){this.windowRef.clearInterval(e)},e.prototype.setImmediate=function(e){return this.immediateComponent.setImmediate(e)},e.prototype.clearImmediate=function(e){this.immediateComponent.clearImmediate(e)},e}();t.Timer=n});e(x);x.Timer;var A=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new x.Timer;t.timer=n});e(A);A.timer;var k,R,O,L=function(){function e(){this.timer=A.timer}return e.prototype.throttle=function(n,r){var i=null,o=null,a=null,s=0,l=function(){s=F.now(),i=null,n.apply(o,a),null==i&&(a=o=null)},u=this;return function(){var e=F.now(),t=r-(e-s);o=u,a=arguments,t<=0||r<t?(i&&(u.timer.clearTimeout(i),i=null),s=e,n.apply(o,a),null==i&&(a=o=null)):null==i&&(i=u.timer.setTimeout(l,t))}},e}(),D=S.of("HTMLElementUtils"),N=function(){function t(){}return t.addClass=function(e,t){if(void 0!==e.className){var n=e.className.split(" ");void 0===F.find(n,function(e){return e===t})&&(e.className+=" "+t)}},t.removeClass=function(e,t){if(void 0!==e.className){var n=e.className.split(" ");void 0!==F.find(n,function(e){return e===t})&&(n=F.filter(n,function(e){return e!==t}),e.className=n.join(" "))}},t.getElementsByClassName=function(e,t){return F.isUndefined(e.getElementsByClassName)?e.querySelectorAll("."+t):e.getElementsByClassName(t)},t.clickedInElement=function(e,t){D(e,"element").exists(),D(t,"event").exists();var n=e.getBoundingClientRect();return n.left<t.clientX&&n.left+e.offsetWidth>t.clientX&&n.top<t.clientY&&n.top+e.offsetHeight>t.clientY},t.isScrollable=function(e){return e.scrollHeight>e.offsetHeight+t.SCROLLABLE_MARGIN_OF_ERROR_PX},t.SCROLLABLE_MARGIN_OF_ERROR_PX=1,t}(),U="(\\d|[1-9]\\d|1\\d\\d|2([0-4]\\d|5[0-5]))",B=new RegExp("^"+U+"\\."+U+"\\."+U+"\\."+U+"$"),j=function(){function e(){}return e.isValidIPv4Address=function(e){return B.test(e)},e}(),X=M.get("WebStorage"),z=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this.storage=e,this.namespace=t}return e.prototype.set=function(e,t){if(null!==this.storage){var n=this.getNamespacedKey(e);try{this.storage.setItem(n,t)}catch(e){X.warn("Failed to save key "+n+" to storage",e)}}else X.warn("Storage is unavailable.")},e.prototype.get=function(e){if(null===this.storage)return X.warn("Storage is unavailable."),null;var t=this.getNamespacedKey(e);try{var n=this.storage.getItem(t);return null!=n||null!=this.namespace&&null!=(n=this.storage.getItem(e))&&this.set(e,n),n}catch(e){return X.warn("Failed to retrieve key "+t+" from storage",e),null}},e.prototype.remove=function(e){if(null!==this.storage){var t=this.getNamespacedKey(e);try{this.storage.removeItem(t),null!=this.namespace&&this.storage.removeItem(e)}catch(e){X.warn("Failed to remove key "+t+" from storage",e)}}else X.warn("Storage is unavailable.")},e.prototype.removeAll=function(){if(null!==this.storage)try{this.storage.clear()}catch(e){X.warn("Failed to clear storage",e)}else X.warn("Storage is unavailable.")},e.prototype.getNamespacedKey=function(e){return null!=this.namespace?""+this.namespace+e:e},e}(),q=V&&V.__extends||(k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),W=function(t){function e(e){return void 0===e&&(e=window),t.call(this,void 0===e.localStorage?null:e.localStorage,"atvwebplayersdk_")||this}return q(e,t),e}(z),H=M.get("MimeTypeParser");(O=R||(R={}))[O.ParsingType=0]="ParsingType",O[O.ParsingSubtype=1]="ParsingSubtype",O[O.ParsingParameterName=2]="ParsingParameterName",O[O.StartParsingParameterValue=3]="StartParsingParameterValue",O[O.ParsingUnquotedParameterValue=4]="ParsingUnquotedParameterValue",O[O.ParsingQuotedParameterValue=5]="ParsingQuotedParameterValue",O[O.CompleteParsingParameterValue=6]="CompleteParsingParameterValue",O[O.FinishParsingNoPendingParameter=7]="FinishParsingNoPendingParameter";var G,K,Q=function(){function e(){}return e.prototype.parse=function(e){var t={text:e,index:0,parameterName:"",parameterValue:"",mimeTypeObject:{type:"",subtype:"",parameters:{}}};return this.parseMimeType(t)},e.prototype.parseMimeType=function(e){for(var t=R.ParsingType;e.index<e.text.length;)switch(t){case R.ParsingType:t=this.parseType(e);break;case R.ParsingSubtype:t=this.parseSubtype(e);break;case R.ParsingParameterName:t=this.parseParameterName(e);break;case R.StartParsingParameterValue:t=this.handleStartParsingParameterValue(e);break;case R.CompleteParsingParameterValue:t=this.handleCompleteParsingParameterValue(e)}return this.handleEndParsing(e,t),e.mimeTypeObject},e.prototype.parseType=function(e){var t=e.text.indexOf("/");if(0<t)return e.mimeTypeObject.type=e.text.substring(e.index,t).trim(),e.index=t+1,R.ParsingSubtype;throw new Error("Encountered malformed top type while parsing \""+e.text.substring(e.index)+"\".")},e.prototype.parseSubtype=function(e){var t=e.text.indexOf(";",e.index);return 0<t?(e.mimeTypeObject.subtype=this.extractSubtype(e,t),e.index=t+1,R.ParsingParameterName):(e.mimeTypeObject.subtype=this.extractSubtype(e),e.index=e.text.length,R.FinishParsingNoPendingParameter)},e.prototype.extractSubtype=function(e,t){var n=e.text.substring(e.index,t).trim();if(0===n.length)throw new Error("Encountered empty subtype while parsing \""+e.text.substring(e.index)+"\".");return n},e.prototype.parseParameterName=function(e){var t=e.text.indexOf("=",e.index);return t>e.index?(e.parameterName=this.extractParameterName(e,t),0===e.parameterName.length?(e.index=e.text.length,R.FinishParsingNoPendingParameter):(e.index=t+1,R.StartParsingParameterValue)):(H.warn("Encountered malformed parameter name while parsing \""+e.text.substring(e.index)+"\"."),e.index=e.text.length,R.FinishParsingNoPendingParameter)},e.prototype.extractParameterName=function(e,t){var n=e.text.substring(e.index,t).trim();return 0===n.length?(H.warn("Encountered empty parameter name while parsing \""+e.text.substring(e.index)+"\"."),n):-1!==n.indexOf(";")?(H.warn("Encountered malformed parameter name while parsing \""+e.text.substring(e.index)+"\"."),""):n},e.prototype.handleStartParsingParameterValue=function(e){if("\""===e.text[e.index]){e.index++;var t=e.text.indexOf("\"",e.index);return t>=e.index?(e.parameterValue=e.text.substring(e.index,t),e.index=t+1,R.CompleteParsingParameterValue):(H.warn("Encountered unbalanced quotation when parsing \""+e.text.substring(e.index)+"\"."),R.StartParsingParameterValue)}var n=e.text.indexOf(";",e.index);return n<0&&(n=e.text.length),e.parameterValue=this.extractUnquotedParameterValue(e,n),e.index=n,R.CompleteParsingParameterValue},e.prototype.extractUnquotedParameterValue=function(e,t){var n=e.text.substring(e.index,t).trim();return 0===n.length&&(H.warn("Encountered empty parameter value while parsing \""+e.text.substring(e.index)+"\"."),n=""),n},e.prototype.handleCompleteParsingParameterValue=function(e){var t=e.text.indexOf(";",e.index);if(t===e.index)return this.commitNameValuePair(e),e.index++,R.ParsingParameterName;if(t<0&&0===e.text.substring(e.index).trim().length)return this.commitNameValuePair(e),e.index=e.text.length,R.FinishParsingNoPendingParameter;throw new Error("Expected character: \";\", but encountered: \""+e.text[e.index]+"\", when completing parsing of a parameter value of text \""+e.text+"\".")},e.prototype.handleEndParsing=function(e,t){switch(t){case R.CompleteParsingParameterValue:this.commitNameValuePair(e);break;case R.StartParsingParameterValue:e.parameterValue="",this.commitNameValuePair(e);break;case R.FinishParsingNoPendingParameter:case R.ParsingParameterName:break;default:throw new Error("Ended in an invalid state: "+R[t]+", when parsing MIME type \""+e.text+"\".")}},e.prototype.commitNameValuePair=function(e){e.mimeTypeObject.parameters[e.parameterName]=e.parameterValue},e}(),J=function(){function e(e,t){void 0===e&&(e=Number.MIN_VALUE),void 0===t&&(t=Number.MAX_VALUE),this.minValue=e,this.maxValue=t}return e.prototype.constrain=function(e){return this.minValue>this.maxValue?e:e>this.maxValue?this.maxValue:e<this.minValue?this.minValue:e},e}(),$=function(){function e(e){this.EXTENSION_REGEX=/(?:\.([^.]+))?$/,this.timeoutMillis=12e4,e&&0<e&&(this.timeoutMillis=e)}return e.prototype.acquire=function(e,t){var n=this.getFileExtension(e);if("js"===n)this.acquireJavaScript(e,t);else{if("css"!==n)throw new Error("Unable to acquire non-JavaScript or CSS resource: "+e);this.acquireCSS(e,t)}},e.prototype.getFileExtension=function(e){var t=this.EXTENSION_REGEX.exec(e);return t?t[1]:""},e.prototype.acquireJavaScript=function(t,n){var r,e=this,i=document.createElement("script"),o=function(e){clearTimeout(r),i&&(delete i.onload,delete i.onerror),"function"==typeof n&&n(e)};r=setTimeout(function(){o(new Error("Timed out acquiring resource after "+e.timeoutMillis+"ms: "+t))},this.timeoutMillis),i.src=t,i.onload=function(){o()},i.onerror=function(e){o(new Error("Error acquiring resource (probably doesn't exist): "+t))},document.getElementsByTagName("head")[0].appendChild(i)},e.prototype.acquireCSS=function(e,t){var n=document.createElement("link");n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href",e),document.getElementsByTagName("head")[0].appendChild(n),"function"==typeof t&&t()},e}(),Z=V&&V.__extends||(G=function(e,t){return(G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}G(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ee=function(t){function e(e){return void 0===e&&(e=window),t.call(this,"undefined"==typeof sessionStorage?null:e.sessionStorage)||this}return Z(e,t),e}(z),te=S.of("Strings"),ne=function(){function e(){}return e.repeat=function(e,t){return t=Math.floor(t),te(0<=t,"count ["+t+"] >= 0").is.true(),F.isEmpty(e)?"":0===t?"":1===t?e:new Array(t+1).join(e)},e}(),re=function(){function e(e,t){this.maxLength=null!=t?t:e}return e.prototype.constrain=function(e){return e.substring(0,this.maxLength)},e}(),ie=S.of("ThrottledEventListener"),oe=function(){function e(){var e=this;this.attachedListener=null,this.executeThrottledEvent=function(){null!==e.attachedListener&&(e.attachedListener.eventTarget.removeEventListener(e.attachedListener.listenerType,e.executeThrottledEvent),setTimeout(function(){null!==e.attachedListener&&(e.attachedListener.callback(),e.attachedListener.eventTarget.addEventListener(e.attachedListener.listenerType,e.executeThrottledEvent))},e.attachedListener.pollingInterval))}}return e.prototype.attachThrottledListener=function(e,t,n,r){ie(e,"eventTarget").exists(),ie(t,"listenerType").exists(),this.attachedListener={eventTarget:e,listenerType:t,pollingInterval:n,callback:r},e.addEventListener(t,this.executeThrottledEvent)},e.prototype.removeThrottledListener=function(){null!==this.attachedListener&&(this.attachedListener.eventTarget.removeEventListener(this.attachedListener.listenerType,this.executeThrottledEvent),this.attachedListener=null)},e}(),ae=!1;try{var se=new URL("b","http://a");se.pathname="c%20d",ae="http://a/c%20d"===se.href}catch(e){}if(ae)K=URL;else{var le=void 0,ue=/[a-zA-Z]/,ce=/[a-zA-Z0-9\+\-\.]/,de={ftp:21,file:0,gopher:70,http:80,https:443,ws:80,wss:443},pe={"%2e":".",".%2e":"..","%2e.":"..","%2e%2e":".."};if(K=function(){function r(e,t){this._isInvalid=!1,this._isRelative=!1,void 0===t||t instanceof r||(t=new r(String(t))),this._url=e,this.clear();var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");this.parse(n,null,t)}return r.prototype.isRelativeScheme=function(e){return void 0!==de[e]},r.prototype.invalid=function(){this.clear(),this._isInvalid=!0},r.prototype.IDNAToASCII=function(e){return""==e&&this.invalid(),e.toLowerCase()},r.prototype.percentEscape=function(e){var t=e.charCodeAt(0);return 32<t&&t<127&&-1==[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)},r.prototype.percentEscapeQuery=function(e){var t=e.charCodeAt(0);return 32<t&&t<127&&-1==[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)},r.prototype.parse=function(e,t,n){var r=t||"scheme start",i=0,o="",a=!1,s=!1;e:for(;(e[i-1]!=le||0==i)&&!this._isInvalid;){var l=e[i];switch(r){case"scheme start":if(!l||!ue.test(l)){if(t)break e;o="",r="no scheme";continue}o+=l.toLowerCase(),r="scheme";break;case"scheme":if(l&&ce.test(l))o+=l.toLowerCase();else{if(':'!=l){if(t){if(le==l)break e;break e}o='',i=0,r='no scheme';continue}if(this._scheme=o,o='',t)break e;this.isRelativeScheme(this._scheme)&&(this._isRelative=!0),r='file'==this._scheme?'relative':this._isRelative&&n&&n._scheme==this._scheme?'relative or authority':this._isRelative?'authority first slash':'scheme data'}break;case'scheme data':'?'==l?(this._query='?',r='query'):'#'==l?(this._fragment='#',r='fragment'):le!=l&&'\t'!=l&&'\n'!=l&&'\r'!=l&&(this._schemeData+=this.percentEscape(l));break;case'no scheme':if(n&&this.isRelativeScheme(n._scheme)){r='relative';continue}this.invalid();break;case'relative or authority':if('/'!=l||'/'!=e[i+1]){r='relative';continue}r='authority ignore slashes';break;case'relative':if(this._isRelative=!0,'file'!=this._scheme&&(this._scheme=n._scheme),le==l){this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._username=n._username,this._password=n._password;break e}if('/'==l||'\\'==l)r='relative slash';else if('?'==l)this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query='?',this._username=n._username,this._password=n._password,r='query';else{if('#'!=l){var u=e[i+1],c=e[i+2];('file'!=this._scheme||!ue.test(l)||':'!=u&&'|'!=u||le!=c&&'/'!=c&&'\\'!=c&&'?'!=c&&'#'!=c)&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password,this._path=n._path.slice(),this._path.pop()),r='relative path';continue}this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._fragment='#',this._username=n._username,this._password=n._password,r='fragment'}break;case'relative slash':if('/'!=l&&'\\'!=l){'file'!=this._scheme&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password),r='relative path';continue}r='file'==this._scheme?'file host':'authority ignore slashes';break;case'authority first slash':if('/'!=l){r='authority ignore slashes';continue}r='authority second slash';break;case'authority second slash':if(r='authority ignore slashes','/'!=l)continue;break;case'authority ignore slashes':if('/'!=l&&'\\'!=l){r='authority';continue}break;case'authority':if('@'==l){a&&(o+='%40'),a=!0;for(var d=0;d<o.length;d++){var p=o[d];if('\t'!=p&&'\n'!=p&&'\r'!=p)if(':'!=p||null!==this._password){var f=this.percentEscape(p);null!==this._password?this._password+=f:this._username+=f}else this._password=''}o=''}else{if(le==l||'/'==l||'\\'==l||'?'==l||'#'==l){i-=o.length,o='',r='host';continue}o+=l}break;case'file host':if(le==l||'/'==l||'\\'==l||'?'==l||'#'==l){2!=o.length||!ue.test(o[0])||':'!=o[1]&&'|'!=o[1]?(0==o.length||(this._host=this.IDNAToASCII(o),o=''),r='relative path start'):r='relative path';continue}'\t'==l||'\n'==l||'\r'==l||(o+=l);break;case'host':case'hostname':if(':'!=l||s){if(le==l||'/'==l||'\\'==l||'?'==l||'#'==l){if(this._host=this.IDNAToASCII(o),o='',r='relative path start',t)break e;continue}'\t'!=l&&'\n'!=l&&'\r'!=l&&('['==l?s=!0:']'==l&&(s=!1),o+=l)}else if(this._host=this.IDNAToASCII(o),o='',r='port','hostname'==t)break e;break;case'port':if(/[0-9]/.test(l))o+=l;else{if(le==l||'/'==l||'\\'==l||'?'==l||'#'==l||t){if(''!=o){var h=parseInt(o,10);h!=de[this._scheme]&&(this._port=h+''),o=''}if(t)break e;r='relative path start';continue}'\t'==l||'\n'==l||'\r'==l||this.invalid()}break;case'relative path start':if(r='relative path','/'!=l&&'\\'!=l)continue;break;case'relative path':var m;if(le!=l&&'/'!=l&&'\\'!=l&&(t||'?'!=l&&'#'!=l))'\t'!=l&&'\n'!=l&&'\r'!=l&&(o+=this.percentEscape(l));else(m=pe[o.toLowerCase()])&&(o=m),'..'==o?(this._path.pop(),'/'!=l&&'\\'!=l&&this._path.push('')):'.'==o&&'/'!=l&&'\\'!=l?this._path.push(''):'.'!=o&&('file'==this._scheme&&0==this._path.length&&2==o.length&&ue.test(o[0])&&'|'==o[1]&&(o=o[0]+':'),this._path.push(o)),o='','?'==l?(this._query='?',r='query'):'#'==l&&(this._fragment='#',r='fragment');break;case'query':t||'#'!=l?le!=l&&'\t'!=l&&'\n'!=l&&'\r'!=l&&(this._query+=this.percentEscapeQuery(l)):(this._fragment='#',r='fragment');break;case'fragment':le!=l&&'\t'!=l&&'\n'!=l&&'\r'!=l&&(this._fragment+=l)}i++}},r.prototype.clear=function(){this._scheme="",this._schemeData="",this._username="",this._password="",this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1},r.prototype.toString=function(){return this.href},r.prototype.toJSON=function(){return this.href},Object.defineProperty(r.prototype,"href",{get:function(){if(this._isInvalid)return this._url;var e="";return""==this._username&&""==this._password||(e=this._username+(""!=this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set:function(e){this.clear(),this.parse(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"protocol",{get:function(){return this._scheme+":"},set:function(e){this._isInvalid||this.parse(e+":","scheme start")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"host",{get:function(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set:function(e){!this._isInvalid&&this._isRelative&&this.parse(e,"host")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hostname",{get:function(){return this._host},set:function(e){!this._isInvalid&&this._isRelative&&this.parse(e,"hostname")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"port",{get:function(){return this._port},set:function(e){!this._isInvalid&&this._isRelative&&this.parse(e,"port")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pathname",{get:function(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set:function(e){!this._isInvalid&&this._isRelative&&(this._path=[],this.parse(e,"relative path start"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"search",{get:function(){return this._isInvalid||!this._query||"?"==this._query?"":this._query},set:function(e){!this._isInvalid&&this._isRelative&&((this._query="?")==e[0]&&(e=e.slice(1)),this.parse(e,"query"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hash",{get:function(){return this._isInvalid||!this._fragment||"#"==this._fragment?"":this._fragment},set:function(e){this._isInvalid||((this._fragment="#")==e[0]&&(e=e.slice(1)),this.parse(e,"fragment"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"username",{get:function(){return this._username},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"password",{get:function(){return this._password},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"origin",{get:function(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return(e=this.host)?this._scheme+"://"+e:""},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"searchParams",{get:function(){return null},enumerable:!0,configurable:!0}),r.createObjectURL=function(e){return""},r.revokeObjectURL=function(e){},r}(),"undefined"!=typeof URL){var fe=URL;fe&&(K.createObjectURL=function(e){return fe.createObjectURL.apply(fe,arguments)},K.revokeObjectURL=function(e){fe.revokeObjectURL(e)})}}var he=K,me=function(){function e(){}return e.wwwFormUrlEncode=function(e){return F.pairs(e).map(function(e){return e.map(function(e){return encodeURIComponent(e).replace(/%20/g,"+")}).join("=")}).join("&")},e.appendQueryParams=function(e,t){var n=e.search,r=F.pairs(t).reduce(function(e,t){return e+(""===e?"?":"&")+t[0]+"="+t[1]},n);e.search=r},e.removeQueryParams=function(e,t){var n=e.search;"?"===n[0]&&(n=n.slice(1));for(var r=n.split("&"),i=0;i<r.length;i++){var o=t[r[i].split("=")[0]];null!=o&&(r.splice(i,1),i--)}e.search=r.join("&")},e}(),ye=function(){function e(){}return e.prototype.decode=function(e){for(var t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=[],r=0;r<t.length;){var i=0,o=0,a=t[r++];if(240==(248&a))i=3,o=7&a;else if(224==(240&a))i=2,o=15&a;else if(192==(224&a))i=1,o=31&a;else{if(0!=(128&a))throw new TypeError("Failed to decode value: "+a.toString(16));i=0,o=127&a}for(;0<i&&r<t.length;)o<<=6,o|=63&t[r++],i--;if(0<i)throw new TypeError("Failed to decode value");if(65536<=o){var s=56320|1023&(o-=65536),l=55296|o>>10&1023;n.push(String.fromCharCode(l,s))}else n.push(String.fromCharCode(o))}return n.join("")},e}(),ge="undefined"!=typeof TextDecoder?function(){return new TextDecoder("utf-8")}:ye,ve=function(){function e(){}return e.prototype.getRandom=function(){if(null!=window.crypto){var e=new Uint32Array(2);return window.crypto.getRandomValues(e),(e[0]*Math.pow(2,20)+(e[1]>>>12))*Math.pow(2,-52)}return Math.random()},e.prototype.getRandomValues=function(e){for(var t=0;t<e.length;t++)e[t]=this.getRandom()},e}(),Se={RandomEngine:ve,randomEngine:new ve},be=function(){function e(){}return e.v4=function(){for(var e=Se.randomEngine,t=new Uint8Array(16),n=0;n<16;n++)t[n]=256*e.getRandom();return t[6]=15&t[6]|64,t[8]=63&t[8]|128,this.bytesToUuid(t)},e.bytesToUuid=function(e){for(var t=[],n=0;n<256;n++)t[n]=(n+256).toString(16).substr(1);var r=0;return[t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]]].join("")},e}(),Te=function(){function e(){}return e.validate=function(e,t){if(null!=e&&null!=t)for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];e.hasOwnProperty(i)&&null!=e[i]&&("object"==typeof e[i]?this.validate(e[i],t[i]):"string"!=typeof e[i]&&"number"!=typeof e[i]||null==t[i]||(e[i]=t[i].constrain(e[i])))}},e}(),Pe=S.of("Version"),we="unknown",Ce={AmazonUrlCreator:h,CookieStorage:y,Display:g,DOMUtils:b,EnumUtils:P,EphemeralJSLogger:w,FunctionThrottler:L,HTMLElementUtils:N,IPAddress:j,LocalStorage:W,MimeTypeParser:Q,NumberValidator:J,ResourceAcquirer:$,SessionStorage:ee,Strings:ne,StringValidator:re,ThrottledEventListener:oe,URL:he,URLUtils:me,Utf8TextDecoder:ge,UUIDGenerator:be,ValidationUtils:Te,Version:function(){function t(e,t){Pe(e,"segments").exists(),Pe(0<e.length,"length > 0").is.true(),Pe(t,"str").exists(),this.segments=e,this.str=t}return t.fromNumber=function(e){return Pe(e,"version").exists(),new t([e],e.toString())},t.fromString=function(e){return Pe(e,"version").exists(),new t(t.split(e),e)},t.createUnknownVersion=function(){return t.fromString(we)},t.prototype.isUnknownVersion=function(){return this.str===we},t.prototype.toString=function(){return this.str},t.prototype.equals=function(e){return 0===this.compareTo(e)},t.prototype.compareTo=function(e){if(this===e)return 0;if(null==e)return 1;if(this.str===we&&e.str===we)return 0;for(var t=Math.min(this.segments.length,e.segments.length),n=0;n<t;n++){if(this.segments[n]<e.segments[n])return-1;if(this.segments[n]>e.segments[n])return 1}return this.isGreaterThanZero(e.segments.slice(this.segments.length))?-1:this.isGreaterThanZero(this.segments.slice(e.segments.length))?1:0},t.prototype.isGreaterThanZero=function(e){for(var t=0;t<e.length;t++)if(F.isString(e[t])&&0<e[t].length||F.isNumber(e[t])&&0<e[t])return!0;return!1},t.split=function(e){var t=e.toLowerCase().match(/\d+|[a-z]+/g);return null!==t?F.map(t,function(e){return/^\d+$/.test(e)?parseInt(e):e}):[]},t}()},Me=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.newError=function(e,t,n){var r=new Error(t);return r.name=e,null!=n&&(r.cause=n),r},e}();t.Errors=n});e(Me);Me.Errors;var Ie=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(){var e=this.constructor,t=n.call(this,"The operation was cancelled")||this;return t.name="CancelError",Object.setPrototypeOf(t,e.prototype),t}return i(e,n),e}(Error);t.CancelError=n});e(Ie);Ie.CancelError;var Ee=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(){}return t.setTaskQueue=function(e){t.taskQueue=e},t.enqueue=function(e){t.taskQueue.enqueue(e)},t}();t.TaskQueueManager=n});e(Ee);Ee.TaskQueueManager;var _e=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Pending=0]="Pending",r[r.Fulfilled=1]="Fulfilled",r[r.Rejected=2]="Rejected";var i=M.get("Promise"),o=function(){function l(e){var t=this;if(this.state=n.Pending,this.value=void 0,this.error=void 0,this.handlers=[],this.handled=!1,this.resolve=function(n){if(t!==n)try{var r=l.getThen(n);null!=r?t.doResolve(function(e,t){return r.call(n,e,t)},t.resolve,t.reject):t.fulfill(n)}catch(e){t.reject(e)}else t.reject(new TypeError("Resolving promise with itself not allowed"))},this.fulfill=function(e){t.state=n.Fulfilled,t.value=e,t.handlers.forEach(function(e){t.handle(e)}),t.handlers=[]},this.reject=function(e){t.state=n.Rejected,t.error=e,0===t.handlers.length?Ee.TaskQueueManager.enqueue(function(){0!==t.handlers.length||t.handled||i.warn("Unhandled promise rejection",e)}):(t.handlers.forEach(function(e){t.handle(e)}),t.handlers=[])},null==e||"function"!=typeof e)throw new Error("Promise resolved "+e+" is not a function");this.doResolve(e,this.resolve,this.reject)}return l.resolve=function(t){return new l(function(e){e(t)})},l.reject=function(n){return new l(function(e,t){t(n)})},l.all=function(s){return Array.isArray(s)?new l(function(n,r){var i=[],o=s.length,a=0;if(0!==o)for(var e=function(t){var e=s[t];(e instanceof l?e:l.resolve(e)).then(function(e){i[t]=e,++a===o&&n(i)},r)},t=0;t<o;t++)e(t);else n([])}):l.reject(new TypeError("Not an array of promises"))},l.race=function(o){return Array.isArray(o)?new l(function(e,t){for(var n=0,r=o;n<r.length;n++){var i=r[n];(i instanceof l?i:l.resolve(i)).then(e,t)}}):l.reject(new TypeError("Not an array of promises"))},l.prototype.then=function(r,i){var e=this;return new l(function(t,n){e.done(function(e){try{t("function"==typeof r?r(e):e)}catch(e){n(e)}},function(e){try{"function"==typeof i?t(i(e)):n(e)}catch(e){n(e)}})})},l.prototype.catch=function(e){return this.then(null,e)},l.prototype.done=function(e,t){this.handle({onFulfilled:e,onRejected:t})},l.getThen=function(e){var t=typeof e;if(("object"===t||"function"===t)&&null!==e){var n=e.then;if("function"==typeof n)return n}return null},l.prototype.doResolve=function(e,t,n){var r=!1;try{e(function(e){r||(r=!0,t(e))},function(e){r||(r=!0,n(e))})}catch(e){if(r)return;r=!0,n(e)}},l.prototype.handle=function(e){var t=this;this.state===n.Pending?this.handlers.push(e):(this.state===n.Fulfilled?Ee.TaskQueueManager.enqueue(function(){e.onFulfilled(t.value)}):Ee.TaskQueueManager.enqueue(function(){e.onRejected(t.error)}),this.handled=!0)},l}();t.Promise=o});e(_e);_e.Promise;var xe=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.PromisePolyfill=n,"undefined"!=typeof Promise?t.PromisePolyfill=n=Promise:t.PromisePolyfill=n=_e.Promise});e(xe);xe.PromisePolyfill;var ke=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function n(e,t){void 0===t&&(t=xe.PromisePolyfill);var n=this;this.wasRequested=!1,this.cancel=function(){n.wasRequested||(n.wasRequested=!0,n.resolvePromise(new Ie.CancelError))},this.backingPromise=new t(function(e,t){n.resolvePromise=e}),e(this.cancel)}return n.prototype.throwIfRequested=function(){if(this.wasRequested)throw new Ie.CancelError},Object.defineProperty(n.prototype,"requested",{get:function(){return this.wasRequested},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"promise",{get:function(){return this.backingPromise},enumerable:!0,configurable:!0}),n.source=function(e){var t;return void 0===e&&(e=xe.PromisePolyfill),{token:new n(function(e){t=e},e),cancel:t}},n}();t.CancelToken=n});e(ke);ke.CancelToken;var Re=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var n=this;this.backingPromise=new xe.PromisePolyfill(function(e,t){n.resolvePromise=e,n.rejectPromise=t})}return e.prototype.resolve=function(e){this.resolvePromise(e)},e.prototype.reject=function(e){this.rejectPromise(e)},Object.defineProperty(e.prototype,"promise",{get:function(){return this.backingPromise},enumerable:!0,configurable:!0}),e}();t.Deferred=n});e(Re);Re.Deferred;var Ae=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FINALLY=function(t){return[function(e){return xe.PromisePolyfill.resolve(t()).then(function(){return e})},function(e){return xe.PromisePolyfill.resolve(t()).then(function(){throw e})}]}});e(Ae);Ae.FINALLY;var Oe=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.queue=[]}return e.prototype.enqueue=function(e){this.queue.push(e)},e.prototype.tick=function(){0!==this.queue.length&&this.queue.shift()()},e.prototype.runUntilEmpty=function(){for(;0<this.queue.length;)this.tick()},e.prototype.reset=function(){this.queue=[]},e}();t.SyncTaskQueue=n});e(Oe);Oe.SyncTaskQueue;var Le=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("TimeoutTaskQueue"),r=function(){function e(e){void 0===e&&(e=A.timer);var t=this;this.executor=function(){for(;0<t.tasks.length;){var e=t.tasks.shift();try{e()}catch(e){n.error("Unhandled exception thrown by a task: ",e,e.stack)}}t.immediate=null},this.timer=e,this.tasks=[],this.immediate=null}return e.prototype.enqueue=function(e){this.tasks.push(e),null===this.immediate&&(this.immediate=this.timer.setImmediate(this.executor))},e}();t.TimeoutTaskQueue=r});e(Le);Le.TimeoutTaskQueue;var Fe=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CancelError=Ie.CancelError,t.CancelToken=ke.CancelToken,t.Deferred=Re.Deferred,t.FINALLY=Ae.FINALLY,t.PromiseImpl=_e.Promise,t.Promise=xe.PromisePolyfill,t.SyncTaskQueue=Oe.SyncTaskQueue,t.TaskQueueManager=Ee.TaskQueueManager,t.TimeoutTaskQueue=Le.TimeoutTaskQueue,null!=A.timer&&Ee.TaskQueueManager.setTaskQueue(new Le.TimeoutTaskQueue(A.timer))});e(Fe);Fe.CancelError,Fe.CancelToken,Fe.Deferred,Fe.FINALLY,Fe.PromiseImpl,Fe.Promise,Fe.SyncTaskQueue,Fe.TaskQueueManager,Fe.TimeoutTaskQueue;var De=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function n(e,t,n,r,i){void 0===r&&(r=!1),this.code=e,this.internalName=t,this.message=null!=n?n:e,this.isFatal=r,this.cause=i;var o=new Error;if(o.stack)this.stack=o.stack;else try{throw o}catch(e){e.stack&&(this.stack=e.stack)}}return Object.defineProperty(n.prototype,"name",{get:function(){return null!=this.internalName?this.internalName:this.code},enumerable:!0,configurable:!0}),n.prototype.prependErrorCode=function(e){this.code=e+"."+this.code},n.prototype.toString=function(){var e=this.name+": "+this.message;return null!=this.cause&&(e+=" | caused by "+this.cause),e},n.generatePrefixedError=function(e,t){return e instanceof Fe.CancelError?e:e instanceof n?(0!==e.code.indexOf(t+".")&&e.prependErrorCode(t),e):new n(t+"."+e.name,void 0,e.message,!0,e)},n}();t.XpError=n});e(De);De.XpError;var Ne=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Errors=Me.Errors,t.XpError=De.XpError});e(Ne);Ne.Errors,Ne.XpError;var Ue=function(){function o(e,t,n,r,i,o){var a=this;if(this.sizeBytes=0,this.status=e,this.headers={},Object.keys(t).forEach(function(e){a.headers[e.toLowerCase()]=t[e]}),this.arrayBuffer=n,this.text=r,this.latencyMs=i.latencyMs,this.downloadMs=i.downloadMs,this.totalMs=i.totalMs,this.responseUrl=o,null!=this.arrayBuffer)this.sizeBytes=this.arrayBuffer.byteLength;else{var s=parseInt(this.getHeader("Content-Length"));F.isNaN(s)?this.sizeBytes=i.loadedBytes:this.sizeBytes=s}}return o.createFromXMLHttpRequest=function(e,t,n){var r=o.parseHeaders(e.getAllResponseHeaders()),i=null!=e.responseURL?e.responseURL:n;switch((null!=e.responseType?e.responseType:"").toLowerCase()){case"arraybuffer":return new o(e.status,r,e.response,null,t,i);default:return new o(e.status,r,null,e.responseText,t,i)}},o.prototype.getStatus=function(){return this.status},o.prototype.getHeader=function(e){var t=this.headers[e.toLowerCase()];return null!=t?t:null},o.prototype.getHeaders=function(){return F.clone(this.headers)},o.prototype.getArrayBuffer=function(){return this.arrayBuffer},o.prototype.getText=function(){return this.text},o.prototype.getLatencyMs=function(){return this.latencyMs},o.prototype.getDownloadMs=function(){return this.downloadMs},o.prototype.getTotalMs=function(){return this.totalMs},o.prototype.getResponseUrl=function(){return this.responseUrl},o.prototype.getMetrics=function(){return Object.freeze({requestStarted:!0,responseReceived:!0,loadedBytes:this.sizeBytes,totalBytes:this.sizeBytes,latencyMs:this.latencyMs,downloadMs:this.downloadMs,totalMs:this.totalMs})},o.parseHeaders=function(e){var n={};return e.split(/\r?\n/).forEach(function(e){var t=o.HEADER_REGEX.exec(e);t&&(n[t[1]]=t[2])}),n},o.HEADER_REGEX=/^\s*(.+?)\s*:\s*(.+?)\s*$/,o}(),Be=function(){function e(e,t){this.key=e,this.value=t}return e.toUriEncodedString=function(e){return F.map(e,function(e){return e.toUriEncodedString()}).join("&")},e.toWwwFormUrlEncodedString=function(e){return F.map(e,function(e){return e.toWwwFormUrlEncodedString()}).join("&")},e.prototype.toUriEncodedString=function(){return encodeURIComponent(this.key)+"="+encodeURIComponent(this.value)},e.prototype.toWwwFormUrlEncodedString=function(){return this.encodeWwwFormUrlComponent(this.key)+"="+this.encodeWwwFormUrlComponent(this.value)},e.prototype.encodeWwwFormUrlComponent=function(e){return encodeURIComponent(e).replace(/%20/g,"+")},e}(),Ve=Ne.Errors,je=S.of("HttpRequest"),Xe=M.get("HttpRequest"),ze={HttpRequest:function(){function t(e,t,n,r,i){void 0===n&&(n=window.performance),void 0===i&&(i=A.timer),this.queryString=null,this.xhrData=null,this.xhrFields=[],this.xhrRequestHeaders={},this.xhrResponseType=null,this.xhrTimeout=0,this.xhrWithCredentials=!1,this.latencyTimeoutId=null,this.latencyTimeoutMs=0,this.startTime=null,this.delayMs=0,this.delayTimeoutId=null,this.sent=!1,this.isAborted=!1,this.abortXhr=null,this.loadCallbacks=[],this.errorCallbacks=[],this.timeoutCallbacks=[],this.abortCallbacks=[],this.progressCallbacks=[],this.eventListeners=[],this.method=je(e,"method").exists(),this.url=je(t,"url").exists(),this.performance=n,this.xhrType=F.isUndefined(r)&&"undefined"!=typeof XMLHttpRequest?XMLHttpRequest:r,this.timer=i}return t.isSupported=function(e){if(F.isUndefined(e)&&"undefined"!=typeof XMLHttpRequest&&(e=XMLHttpRequest),"undefined"==typeof JSON||void 0===e||F.isUndefined(Array.prototype.forEach))return!1;var t=new e;return!(F.isUndefined(t.abort)||F.isUndefined(t.addEventListener)||F.isUndefined(t.getAllResponseHeaders)||F.isUndefined(t.open)||F.isUndefined(t.readyState)||F.isUndefined(t.removeEventListener)||F.isUndefined(t.response)||F.isUndefined(t.responseText)||F.isUndefined(t.responseType)||F.isUndefined(t.send)||F.isUndefined(t.setRequestHeader)||F.isUndefined(t.status)||F.isUndefined(t.timeout)||F.isUndefined(t.withCredentials))},t.get=function(e){return je(e,"url").exists(),new t("GET",e)},t.post=function(e){return je(e,"url").exists(),new t("POST",e)},t.prototype.headers=function(e){return je(e,"headers").exists(),je(this.sent,"this.sent").is.false(),F.extend(this.xhrRequestHeaders,e),this},t.prototype.responseType=function(e){return je(e,"type").exists(),je(this.sent,"this.sent").is.false(),this.xhrResponseType=e,this},t.prototype.delay=function(e){return je(e,"delayMs").exists(),je(this.sent,"this.sent").is.false(),this.delayMs=e,this},t.prototype.timeout=function(e,t){return je(e,"timeoutMs").exists(),je(this.sent,"this.sent").is.false(),"LATENCY"===t?this.latencyTimeoutMs=e:this.xhrTimeout=e,this},t.prototype.withCredentials=function(){return je(this.sent,"this.sent").is.false(),this.xhrWithCredentials=!0,this},t.prototype.query=function(e){return je(e,"parameters").exists(),je(this.sent,"this.sent").is.false(),this.queryString=Be.toUriEncodedString(F.map(e,function(e,t){return new Be(t,e)})),this},t.prototype.body=function(e){return je(e,"data").exists(),je(this.sent,"this.sent").is.false(),je(this.xhrFields,"this.xhrFields").is.empty(),this.xhrData=e,this},t.prototype.fields=function(e){var n=this;return je(e,"fields").exists(),je(this.sent,"this.sent").is.false(),je(this.xhrData,"this.xhrData").is.null(),F.each(e,function(e,t){n.xhrFields.push(new Be(t,e))}),this},t.prototype.onLoad=function(e){return je(e,"callback").exists(),je(this.sent,"this.sent").is.false(),this.loadCallbacks=F.union(this.loadCallbacks,[this.wrapCallback("Load",e)]),this},t.prototype.onProgress=function(e){return je(e,"callback").exists(),je(this.sent,"this.sent").is.false(),this.progressCallbacks=F.union(this.progressCallbacks,[this.wrapCallback("Progress",e)]),this},t.prototype.onError=function(e){return je(e,"callback").exists(),je(this.sent,"this.sent").is.false(),this.errorCallbacks=F.union(this.errorCallbacks,[this.wrapCallback("Error",e)]),this},t.prototype.onTimeout=function(e){return je(e,"callback").exists(),je(this.sent,"this.sent").is.false(),this.timeoutCallbacks=F.union(this.timeoutCallbacks,[this.wrapCallback("Timeout",e)]),this},t.prototype.onAbort=function(e){return je(e,"callback").exists(),je(this.sent,"this.sent").is.false(),this.abortCallbacks=F.union(this.abortCallbacks,[this.wrapCallback("Abort",e)]),this},t.prototype.abort=function(){this.isAborted=!0,null!==this.delayTimeoutId&&(this.timer.clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null,this.handleAbort(Object.freeze({requestStarted:!1,responseReceived:!1,loadedBytes:0,totalBytes:0,latencyMs:0,downloadMs:0,totalMs:0}))),null!==this.abortXhr&&(this.abortXhr(),this.abortXhr=null)},t.prototype.send=function(){var e=this;return 0<this.delayMs?this.delayTimeoutId=this.timer.setTimeout(function(){e.delayTimeoutId=null,e.sendRequest()},this.delayMs):this.sendRequest(),this},t.prototype.sendRequest=function(){var e=this;this.sent=!0;var t=this.method,n=F.isEmpty(this.queryString)?this.url:this.url+"?"+this.queryString,r=new this.xhrType;(0<this.loadCallbacks.length||0<this.progressCallbacks.length||0<this.errorCallbacks.length||0<this.timeoutCallbacks.length||0<this.abortCallbacks.length)&&this.addEventListeners(r),r.open(t,n,!0),F.each(this.xhrRequestHeaders,function(e,t){r.setRequestHeader(t,e)}),null!==this.xhrResponseType&&(r.responseType=this.xhrResponseType),0<this.xhrTimeout&&(r.timeout=this.xhrTimeout),0<this.latencyTimeoutMs&&(this.latencyTimeoutMs<this.xhrTimeout||0===this.xhrTimeout)&&(this.latencyTimeoutId=this.timer.setTimeout(function(){e.removeAllListeners(r),null!==e.abortXhr&&e.abortXhr(),e.abortXhr=null,e.handleTimeout(e.createTimeoutEvent(e.latencyTimeoutMs,e.startTime,null,"LATENCY"))},this.latencyTimeoutMs)),this.xhrWithCredentials&&(r.withCredentials=!0),this.abortXhr=function(){r.abort()},null!==this.xhrData?(r.send(this.xhrData),this.xhrData=null):F.isEmpty(this.xhrFields)?r.send():(r.send(Be.toWwwFormUrlEncodedString(this.xhrFields)),this.xhrFields.length=0)},t.prototype.addEventListeners=function(n){var r=this,i=null;this.addEventListener(n,"loadstart",function(e){r.startTime=r.correctXHREventTimeStamp(e.timeStamp)});var t=function(e){n.readyState===r.xhrType.HEADERS_RECEIVED&&(i=r.correctXHREventTimeStamp(e.timeStamp),n.removeEventListener("readystatechange",t),r.timer.clearTimeout(r.latencyTimeoutId))};this.addEventListener(n,"readystatechange",t),(0<this.loadCallbacks.length||0<this.errorCallbacks.length)&&this.addEventListener(n,"load",function(e){if(r.abortXhr=null,r.removeAllListeners(n),r.isAborted)r.handleAbort(r.createAbortEvent(r.startTime,i,e));else{var t=r.createLoadEvent(r.startTime,i,e);r.handleLoad(Ue.createFromXMLHttpRequest(n,t,r.url))}}),0<this.progressCallbacks.length&&this.addEventListener(n,"progress",function(e){r.isAborted||r.handleProgress(r.createProgressEvent(r.startTime,i,e))}),0<this.errorCallbacks.length&&this.addEventListener(n,"error",function(e){r.abortXhr=null,r.removeAllListeners(n),r.isAborted?r.handleAbort(r.createAbortEvent(r.startTime,i,e)):r.handleError()}),(0<this.timeoutCallbacks.length||0<this.errorCallbacks.length)&&this.addEventListener(n,"timeout",function(e){r.abortXhr=null,r.removeAllListeners(n),r.isAborted?r.handleAbort(r.createAbortEvent(r.startTime,i,e)):r.handleTimeout(r.createTimeoutEvent(n.timeout,r.startTime,i,"DEFAULT",e))}),0<this.abortCallbacks.length&&this.addEventListener(n,"abort",function(e){r.abortXhr=null,r.removeAllListeners(n),r.handleAbort(r.createAbortEvent(r.startTime,i,e))})},t.prototype.addEventListener=function(e,t,n){this.eventListeners.push({type:t,listener:n}),e.addEventListener(t,n)},t.prototype.removeAllListeners=function(t){this.eventListeners.forEach(function(e){t.removeEventListener(e.type,e.listener)}),this.eventListeners.length=0},t.prototype.handleLoad=function(t){if(200<=t.getStatus()&&t.getStatus()<400)this.loadCallbacks.forEach(function(e){e(t)});else{var n=new Error("Request to "+this.url+" resulted in HTTP status code "+t.getStatus());this.errorCallbacks.forEach(function(e){e(n,t)})}this.clearCallbacks()},t.prototype.handleProgress=function(t){this.progressCallbacks.forEach(function(e){e(t)})},t.prototype.handleError=function(){var t=Ve.newError("unknown_network_error","URL: "+this.url+", query string: "+this.queryString);this.errorCallbacks.forEach(function(e){e(t)}),this.timer.clearTimeout(this.latencyTimeoutId),this.clearCallbacks()},t.prototype.handleTimeout=function(t){if(0<this.timeoutCallbacks.length)this.timeoutCallbacks.forEach(function(e){e(t)});else{var n=new Error("Request to "+this.url+" timed out after "+t.timeoutMs+" ms");this.errorCallbacks.forEach(function(e){e(n)})}this.clearCallbacks()},t.prototype.handleAbort=function(t){this.abortCallbacks.forEach(function(e){e(t)}),this.timer.clearTimeout(this.latencyTimeoutId),this.clearCallbacks()},t.prototype.createProgressEvent=function(e,t,n){return Object.freeze(F.extend({lengthComputable:n.lengthComputable},this.createHttpEvent(e,t,n)))},t.prototype.createAbortEvent=function(e,t,n){return Object.freeze(F.extend({requestStarted:!0},this.createHttpEvent(e,t,n)))},t.prototype.createTimeoutEvent=function(e,t,n,r,i){return Object.freeze(F.extend({timeoutMs:e,timeoutType:r},this.createHttpEvent(t,n,i)))},t.prototype.createLoadEvent=function(e,t,n){return Object.freeze(F.extend({},this.createHttpEvent(e,t,n),{lengthComputable:!0,loadedBytes:n.loaded,totalBytes:n.loaded}))},t.prototype.createHttpEvent=function(e,t,n){var r=null!=n&&n.lengthComputable;return Object.freeze({responseReceived:null!==t,loadedBytes:r?n.loaded:0,totalBytes:r?n.total:0,latencyMs:null!==t?t-e:0,downloadMs:null!=n&&null!==t?this.correctXHREventTimeStamp(n.timeStamp)-t:0,totalMs:null!=n&&null!==e?this.correctXHREventTimeStamp(n.timeStamp)-e:0})},t.prototype.clearCallbacks=function(){this.loadCallbacks.length=0,this.errorCallbacks.length=0,this.timeoutCallbacks.length=0,this.abortCallbacks.length=0,this.progressCallbacks.length=0},t.prototype.correctXHREventTimeStamp=function(e){return null==this.performance?e:e-this.performance.now()<=1e3?e:this.performance.now()},t.prototype.wrapCallback=function(n,r){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];try{r.apply(void 0,e)}catch(e){Xe.error("A "+n+" callback threw an error:",e)}}},t}(),HttpResponse:Ue},qe=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i){this.authContext=null,this.clickstreamSessionId=t,this.marketplaceId=n,this.deviceId=r,this.deviceTypeId=i,this.url=e.replace(/\/$/,"")+"/cdp/usage/Clickstream"}return e.isSupported=function(e){return void 0===e&&(e=ze.HttpRequest),e.isSupported()},e.prototype.report=function(e,t,n){var r={gascEnabled:!Y.MarketplaceID.isClassic(this.marketplaceId),deviceID:this.deviceId,deviceTypeID:this.deviceTypeId,firmware:"1"},i={EntryList:[e]},o={"x-atv-session-id":this.clickstreamSessionId,"x-retry-count":"0","x-request-priority":"NOTIFICATION","Content-Type":"application/json"},a=ze.HttpRequest.post(this.url).withCredentials().headers(o).timeout(4e3).body(JSON.stringify(i));null!=t&&a.onLoad(function(e){t(e.getLatencyMs())}),null!=n&&a.onError(function(e,t){null!=t?n(e,t.getLatencyMs()):n(e)}),null!=this.authContext&&a.headers(this.authContext.headers),a.query(r).send()},e.prototype.setAuthContext=function(e){this.authContext=e},e}();t.ClickstreamClient=n});e(qe);var We,He;qe.ClickstreamClient;(He=We||(We={})).ContentStateChange="ContentStateChange",He.PlaybackStateChange="PlaybackStateChange",He.TimeDataChange="TimeDataChange",He.TimelineChange="TimelineChange",He.TimelineEnded="TimelineEnded",He.Error="Error",He.ContentError="ContentError",He.FullscreenChange="FullscreenChange",He.Seek="Seek",He.Close="Close";var Ge,Ke,Qe=We;(Ke=Ge||(Ge={})).AdReporting="AdReporting",Ke.MetricsReporting="MetricsReporting",Ke.PictureInPicture="PictureInPicture",Ke.Stream="Stream",Ke.Volume="Volume",Ke.GCast="GCast",Ke.UIDisplayStatus="UIDisplayStatus",Ke.UserActivity="UserActivity";var Ye,Je,$e=Ge;(Je=Ye||(Ye={})).Connected="Connected",Je.Disconnected="Disconnected";var Ze,et=Ye,tt={bandwidthCap:1/0};(Ze||(Ze={})).LoadError="LoadError";var nt,rt,it=Ze;(rt=nt||(nt={})).AmazonVideoPlayer="AmazonVideoPlayer",rt.ChromelessPlayer="ChromelessPlayer",rt.GCastPlayer="GCastPlayer",rt.LocalContentManager="LocalContentManager",rt.Player="Player";var ot,at,st=nt,lt=function(){function e(){}return e.getActiveWeblabs=function(){return[e.HTML5_ENABLE_CHROMIUM,e.LIVE_LOW_LATENCY_CHROME,e.LIVE_LOW_LATENCY_CHROMIUM,e.LIVE_LOW_LATENCY_EDGENEXT,e.LIVE_LOW_LATENCY_FIREFOX,e.LIVE_LOW_LATENCY_FIREFOX64,e.LIVE_LOW_LATENCY_OPERA,e.HASTUR_IE,e.HASTUR_SAFARI,e.HTML5_PICTUREINPICTURE]},e.HTML5_ENABLE_CHROMIUM="AIV_HTML5_ENABLE_CHROMIUM_251485",e.LIVE_LOW_LATENCY_CHROME="AIV_HTML5_LIVE_LOW_LATENCY_CHROME_242583",e.LIVE_LOW_LATENCY_CHROMIUM="AIV_HTML5_LIVE_LOW_LATENCY_CHROMIUM_242584",e.LIVE_LOW_LATENCY_EDGENEXT="AIV_HTML5_LIVE_LOW_LATENCY_EDGENEXT_306349",e.LIVE_LOW_LATENCY_FIREFOX="AIV_HTML5_LIVE_LOW_LATENCY_FIREFOX_242581",e.LIVE_LOW_LATENCY_FIREFOX64="AIV_HTML5_LIVE_LOW_LATENCY_FIREFOX64_242582",e.LIVE_LOW_LATENCY_OPERA="AIV_HTML5_LIVE_LOW_LATENCY_OPERA_242580",e.HASTUR_IE="AIV_HTML5_HASTUR_LAUNCH_IE_227137",e.HASTUR_SAFARI="AIV_HTML5_HASTUR_LAUNCH_SAFARI_227138",e.HTML5_PICTUREINPICTURE="AIV_HTML5_PICTUREINPICTURE_LAUNCH_309146",e}();(at=ot||(ot={}))[at.C=0]="C",at[at.T1=1]="T1",at[at.T2=2]="T2",at[at.T3=3]="T3",at[at.T4=4]="T4",at[at.T5=5]="T5",at[at.T6=6]="T6",at[at.T7=7]="T7",at[at.T8=8]="T8",at[at.T9=9]="T9",at[at.T10=10]="T10",at[at.T11=11]="T11",at[at.T12=12]="T12",at[at.T13=13]="T13",at[at.T14=14]="T14",at[at.T15=15]="T15",at[at.T16=16]="T16",at[at.T17=17]="T17",at[at.T18=18]="T18",at[at.T19=19]="T19",at[at.T20=20]="T20";var ut=ot,ct=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WebPlayerEvent=Qe,t.WebPlayerFeatures=$e,t.CastState=et,t.DataUsageDefault=tt,t.WebPlayerSDKEvent=it,t.WebPlayerSDKFeatures=st,t.Weblabs=lt,t.WeblabTreatment=ut});e(ct);ct.WebPlayerEvent,ct.WebPlayerFeatures,ct.CastState,ct.DataUsageDefault,ct.WebPlayerSDKEvent,ct.WebPlayerSDKFeatures,ct.Weblabs,ct.WeblabTreatment;var dt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("ClickstreamEventBuilder"),r=function(){function e(){this.event={}}return e.prototype.withAction=function(e){return this.event.action=e.toString(),this},e.prototype.withHitType=function(e){return this.event.hitType=e.toString(),this},e.prototype.withPageType=function(e){return this.event.pageType=e.toString(),this},e.prototype.withPageTypeId=function(e){return this.event.pageTypeId=e,this},e.prototype.withPageTypeIdSource=function(e){return this.event.pageTypeIdSource=e.toString(),this},e.prototype.withRefMarker=function(e){return this.event.refMarker=e,this},e.prototype.withSubPageType=function(e){return this.event.subPageType=e.toString(),this},e.prototype.withWeblabs=function(t){return this.event.weblabs=F.chain(t).keys().map(function(e){return{weblabName:e,treatmentName:ct.WeblabTreatment[t[e]]}}).value(),F.isEmpty(this.event.weblabs)&&delete this.event.weblabs,this},e.prototype.withEvent=function(e){return this.event=e,this},e.prototype.build=function(){return null==this.event.refMarker||null==this.event.pageType||null==this.event.pageTypeId||null==this.event.pageTypeIdSource||null==this.event.subPageType?(n.error("Attempted to build clickstream event without all required properties"),null):this.event},e}();t.ClickstreamEventBuilder=r});e(dt);dt.ClickstreamEventBuilder;var pt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.name=e}return e.prototype.toString=function(){return this.name},e}();t.ClickstreamParameter=n});e(pt);pt.ClickstreamParameter;var ft=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.PlayStream=new t("PlayStream"),t.PlayTrailer=new t("PlayTrailer"),t}(pt.ClickstreamParameter);t.Action=i});e(ft);ft.Action;var ht=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.PageHit=new t("PageHit"),t.PageTouch=new t("PageTouch"),t}(pt.ClickstreamParameter);t.HitType=i});e(ht);ht.HitType;var mt=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.Player=new t("Player"),t}(pt.ClickstreamParameter);t.PageType=i});e(mt);mt.PageType;var yt=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.ASIN=new t("ASIN"),t}(pt.ClickstreamParameter);t.PageTypeIdSource=i});e(yt);yt.PageTypeIdSource;var gt=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.plr_hd_on=0]="plr_hd_on",r[r.plr_hd_off=1]="plr_hd_off",r[r.plr_nxt_ep=2]="plr_nxt_ep",r[r.plr_pin_ok=3]="plr_pin_ok",r[r.plr_b_fscrn_on=4]="plr_b_fscrn_on",r[r.plr_b_fscrn_off=5]="plr_b_fscrn_off",t.RefMarker=n});e(gt);gt.RefMarker;var vt=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.Pin=new t("Pin"),t.PinError=new t("PinError"),t.Player=new t("Player"),t}(pt.ClickstreamParameter);t.SubPageType=i});e(vt);vt.SubPageType;var St=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Action=ft.Action,t.ClickstreamParameter=pt.ClickstreamParameter,t.HitType=ht.HitType,t.PageType=mt.PageType,t.PageTypeIdSource=yt.PageTypeIdSource,t.RefMarker=gt.RefMarker,t.SubPageType=vt.SubPageType});e(St);St.Action,St.ClickstreamParameter,St.HitType,St.PageType,St.PageTypeIdSource,St.RefMarker,St.SubPageType;var bt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("Timer"),r=function(){function e(e,t){this.now=void 0!==Date.now?Date.now:function(){return(new Date).getTime()},this.metrics=e,this.metricName=t,this.startTime=this.now(),this.elapsedTime=null}return e.prototype.end=function(){if(null===this.elapsedTime){this.elapsedTime=this.now()-this.startTime;try{this.metrics.putMetric(this.metricName,this.elapsedTime,"ms")}catch(e){n.error("An error occurred while stopping the timer for metric "+this.metricName+": "+e.name+": "+e.message,e)}n.info(this.metricName+" was "+this.elapsedTime+" ms")}return this.elapsedTime},e}();t.Timer=r});e(bt);bt.Timer;var Tt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("Metrics"),n=function(){function e(){this.handler=function(){},this.flusher=function(){}}return e.prototype.setHandler=function(e){this.handler=e},e.prototype.setFlusher=function(e){this.flush(),this.flusher=e},e.prototype.putMetric=function(t,e,n){try{this.handler(t,e,n)}catch(e){r.error("An error occurred while publishing metric "+t+": "+e.name+": "+e.message,e)}},e.prototype.flush=function(){try{this.flusher()}catch(e){r.error("An error occurred while flushing metrics",e)}},e.prototype.startTimer=function(e){return new bt.Timer(this,e)},e}();t.Metrics=n});e(Tt);Tt.Metrics;var Pt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new Tt.Metrics;t.metrics=n});e(Pt);Pt.metrics;var wt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("ClickstreamReporter"),n="ClickstreamTime",l=St.PageTypeIdSource.ASIN,r=function(){function e(e,t,n,r,i){this.isContentLoading=!1,this.clickstreamClient=new qe.ClickstreamClient(e,r,t,n,Y.DeviceTypeId.HTML5),this.weblabs=i}return e.prototype.setRefMarker=function(e){this.refMarker=e},e.prototype.setAuthContext=function(e){this.clickstreamClient.setAuthContext(e)},e.prototype.setContent=function(e,t){this.asin=e,this.isTrailer=t,this.isContentLoading=!0},e.prototype.pinDialogDisplayed=function(){this.isPinDialogDisplayed?s.error("pinDialogDisplayed called when PIN dialog is already displayed"):(this.isPinDialogDisplayed=!0,this.buildAndReportClickstream(St.SubPageType.Pin))},e.prototype.pinSubmitted=function(){this.isPinDialogDisplayed?this.refMarker=St.RefMarker[St.RefMarker.plr_pin_ok]:s.error("pinSubmitted called when PIN dialog is not displayed")},e.prototype.pinAccepted=function(){this.isPinDialogDisplayed?this.isPinDialogDisplayed=!1:s.error("pinAccepted called when PIN dialog is not displayed")},e.prototype.pinDeclined=function(){this.isPinDialogDisplayed?this.buildAndReportClickstream(St.SubPageType.PinError):s.error("pinDeclined called when PIN dialog is not displayed")},e.prototype.hdToggled=function(e){var t=e?St.RefMarker[St.RefMarker.plr_hd_on]:St.RefMarker[St.RefMarker.plr_hd_off];this.buildAndReportClickstream(St.SubPageType.Player,void 0,t)},e.prototype.fullScreenToggled=function(e){var t=e?St.RefMarker[St.RefMarker.plr_b_fscrn_on]:St.RefMarker[St.RefMarker.plr_b_fscrn_off];this.buildAndReportClickstream(St.SubPageType.Player,void 0,t,St.HitType.PageTouch)},e.prototype.clickstreamPlaybackPlaying=function(){if(this.isContentLoading){this.isContentLoading=!1;var e=this.isTrailer?St.Action.PlayTrailer:St.Action.PlayStream;this.buildAndReportClickstream(St.SubPageType.Player,e)}},e.prototype.reportClickstream=function(e){try{this.clickstreamClient.report(e,function(e){Pt.metrics.putMetric(n,e)},function(e,t){s.error("Unable to send Clickstream event: "+e,e),Pt.metrics.putMetric("ClickstreamError"),null!=t&&Pt.metrics.putMetric(n,t)})}catch(e){s.error("Failed to send ClickStream event: "+e,e)}},e.prototype.buildAndReportClickstream=function(e,t,n,r){if(null!=this.asin)if(null!=n||null!=this.refMarker){var i=null!=n?n:this.refMarker,o=(new dt.ClickstreamEventBuilder).withPageType(St.PageType.Player).withSubPageType(e).withRefMarker(i).withPageTypeId(this.asin).withPageTypeIdSource(l).withWeblabs(this.weblabs);null!=t&&o.withAction(t),null!=r&&o.withHitType(r),this.refMarker=null;var a=o.build();null!=a&&this.reportClickstream(a)}else s.error("Attempted to build a clickstream event without a refMarker");else s.error("Attempted to build a clickstream event with a null pageTypeId")},e}();t.ClickstreamReporter=r});e(wt);wt.ClickstreamReporter;var Ct=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ClickstreamClient=qe.ClickstreamClient,t.ClickstreamEventBuilder=dt.ClickstreamEventBuilder,t.ClickstreamReporter=wt.ClickstreamReporter});e(Ct);Ct.ClickstreamClient,Ct.ClickstreamEventBuilder,Ct.ClickstreamReporter;var Mt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function n(){}return n.hasEndpoint=function(e){return null!=n.getEndpointForMarketplace(e)},n.getEmptyResponseBaseUrl=function(e,t){return n.getBaseUrl(e,t)+"OE"},n.getImageResponseBaseUrl=function(e,t){return n.getBaseUrl(e,t)+"OP"},n.getBaseUrl=function(e,t){return"https://"+n.getEndpointForMarketplace(e)+"/1/"+t+"/1/"},n.getEndpointForMarketplace=function(e){for(var t in n.ENDPOINTS)if(F.contains(n.ENDPOINTS[t],e))return t;return null},n.ENDPOINTS={"fls-eu.amazon.com":[Y.MarketplaceID.DE,Y.MarketplaceID.ROE_EU,Y.MarketplaceID.ROW_EU,Y.MarketplaceID.UK],"fls-fe.amazon.com":[Y.MarketplaceID.JP,Y.MarketplaceID.ROW_FE],"fls-na.amazon.com":[Y.MarketplaceID.ROW_NA,Y.MarketplaceID.US]},n}();t.Endpoints=n});e(Mt);Mt.Endpoints;var It=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={})[Y.MarketplaceID.DE]="de",n[Y.MarketplaceID.JP]="jp",n[Y.MarketplaceID.ROE_EU]="roe_eu",n[Y.MarketplaceID.ROW_EU]="row_eu",n[Y.MarketplaceID.ROW_FE]="row_fe",n[Y.MarketplaceID.ROW_NA]="row_na",n[Y.MarketplaceID.UK]="uk",n[Y.MarketplaceID.US]="us",n),i=function(){function l(e,t,n,r,i,o,a,s){if(void 0===i&&(i=0),void 0===o&&(o=l.FLUSH_TIMEOUT_MS),void 0===a&&(a=ze.HttpRequest),void 0===s&&(s=Image),this.batchedMetrics=[],!Mt.Endpoints.hasEndpoint(e))throw new Error("No endpoint for marketplaceId="+e);this.marketplaceId=e,this.sessionId=t,this.client=r,this.clientId=n,this.batchSize=i,this.flushTimeoutMs=o,a.isSupported()?(this.baseUrl=Mt.Endpoints.getEmptyResponseBaseUrl(e,l.CHANNEL)+"/aiv-web-player/action/",this.handler=this.putMetricXhr):(this.baseUrl=Mt.Endpoints.getImageResponseBaseUrl(e,l.CHANNEL)+"/aiv-web-player/action/",this.handler=this.putMetricImg),this.httpRequest=a,this.imageType=s}return l.prototype.updateSessionId=function(e){this.sessionId=e},l.prototype.putMetric=function(e,t,n,r){var i=this;void 0===n&&(n=1);var o=e+":"+t+"@v="+n;null!=r&&(o=o+":u="+r),this.batchedMetrics.push(o),this.batchedMetrics.length>=this.batchSize?this.flush():(clearTimeout(this.flushTimeoutId),this.flushTimeoutId=A.timer.setTimeout(function(){i.flush()},this.flushTimeoutMs))},l.prototype.flush=function(){if(!(this.batchedMetrics.length<1)){clearTimeout(this.flushTimeoutId);var e=this.baseUrl+this.batchedMetrics.join("/");this.handler(e,!0),this.handler(e,!1),this.batchedMetrics=[]}},l.prototype.putMetricImg=function(e,t){var n=this.createMetricParameters(t),r=F.map(n,function(e,t){return t+"="+e});(new this.imageType).src=e+"?"+r.join("&")},l.prototype.putMetricXhr=function(e,t){this.httpRequest.get(e).query(this.createMetricParameters(t)).send()},l.prototype.createMetricParameters=function(e){var t={instance:this.clientId,marketplace:r[this.marketplaceId],marketplaceId:this.marketplaceId,requestId:1,service:l.SERVICE_NAME,session:this.sessionId};return e&&(t.client=this.client),t},l.CHANNEL="action-impressions",l.SERVICE_NAME="AIVWebPlayer",l.FLUSH_TIMEOUT_MS=3e4,l}();t.MetricsPublisher=i});e(It);It.MetricsPublisher;var Et=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsPublisher=It.MetricsPublisher});e(Et);Et.MetricsPublisher;var _t=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function i(){}return i.getIso639_1LanguageCode=function(e){for(var t=0,n=i.LANGUAGE_MAP;t<n.length;t++){var r=n[t];if(r["iso639-2t"]===e)return r["iso639-1"]}return null},i.getIso639_2tLanguageCode=function(e){for(var t=0,n=i.LANGUAGE_MAP;t<n.length;t++){var r=n[t];if(r["iso639-1"]===e)return r["iso639-2t"]}return null},i.getLanguageCodeFromLocale=function(e){return(e=e.replace("_","-")).split("-")[0]},i.LANGUAGE_MAP=[{"iso639-1":"ab","iso639-2t":"abk"},{"iso639-1":"aa","iso639-2t":"aar"},{"iso639-1":"af","iso639-2t":"afr"},{"iso639-1":"ak","iso639-2t":"aka"},{"iso639-1":"sq","iso639-2t":"sqi"},{"iso639-1":"am","iso639-2t":"amh"},{"iso639-1":"ar","iso639-2t":"ara"},{"iso639-1":"an","iso639-2t":"arg"},{"iso639-1":"hy","iso639-2t":"hye"},{"iso639-1":"as","iso639-2t":"asm"},{"iso639-1":"av","iso639-2t":"ava"},{"iso639-1":"ae","iso639-2t":"ave"},{"iso639-1":"ay","iso639-2t":"aym"},{"iso639-1":"az","iso639-2t":"aze"},{"iso639-1":"bm","iso639-2t":"bam"},{"iso639-1":"ba","iso639-2t":"bak"},{"iso639-1":"eu","iso639-2t":"eus"},{"iso639-1":"be","iso639-2t":"bel"},{"iso639-1":"bn","iso639-2t":"ben"},{"iso639-1":"bh","iso639-2t":"bih"},{"iso639-1":"bi","iso639-2t":"bis"},{"iso639-1":"bs","iso639-2t":"bos"},{"iso639-1":"br","iso639-2t":"bre"},{"iso639-1":"bg","iso639-2t":"bul"},{"iso639-1":"my","iso639-2t":"mya"},{"iso639-1":"ca","iso639-2t":"cat"},{"iso639-1":"ch","iso639-2t":"cha"},{"iso639-1":"ce","iso639-2t":"che"},{"iso639-1":"ny","iso639-2t":"nya"},{"iso639-1":"zh","iso639-2t":"zho"},{"iso639-1":"cv","iso639-2t":"chv"},{"iso639-1":"kw","iso639-2t":"cor"},{"iso639-1":"co","iso639-2t":"cos"},{"iso639-1":"cr","iso639-2t":"cre"},{"iso639-1":"hr","iso639-2t":"hrv"},{"iso639-1":"cs","iso639-2t":"ces"},{"iso639-1":"da","iso639-2t":"dan"},{"iso639-1":"dv","iso639-2t":"div"},{"iso639-1":"nl","iso639-2t":"nld"},{"iso639-1":"dz","iso639-2t":"dzo"},{"iso639-1":"en","iso639-2t":"eng"},{"iso639-1":"eo","iso639-2t":"epo"},{"iso639-1":"et","iso639-2t":"est"},{"iso639-1":"ee","iso639-2t":"ewe"},{"iso639-1":"fo","iso639-2t":"fao"},{"iso639-1":"fj","iso639-2t":"fij"},{"iso639-1":"fi","iso639-2t":"fin"},{"iso639-1":"fr","iso639-2t":"fra"},{"iso639-1":"ff","iso639-2t":"ful"},{"iso639-1":"gl","iso639-2t":"glg"},{"iso639-1":"ka","iso639-2t":"kat"},{"iso639-1":"de","iso639-2t":"deu"},{"iso639-1":"el","iso639-2t":"ell"},{"iso639-1":"gn","iso639-2t":"grn"},{"iso639-1":"gu","iso639-2t":"guj"},{"iso639-1":"ht","iso639-2t":"hat"},{"iso639-1":"ha","iso639-2t":"hau"},{"iso639-1":"he","iso639-2t":"heb"},{"iso639-1":"hz","iso639-2t":"her"},{"iso639-1":"hi","iso639-2t":"hin"},{"iso639-1":"ho","iso639-2t":"hmo"},{"iso639-1":"hu","iso639-2t":"hun"},{"iso639-1":"ia","iso639-2t":"ina"},{"iso639-1":"id","iso639-2t":"ind"},{"iso639-1":"ie","iso639-2t":"ile"},{"iso639-1":"ga","iso639-2t":"gle"},{"iso639-1":"ig","iso639-2t":"ibo"},{"iso639-1":"ik","iso639-2t":"ipk"},{"iso639-1":"io","iso639-2t":"ido"},{"iso639-1":"is","iso639-2t":"isl"},{"iso639-1":"it","iso639-2t":"ita"},{"iso639-1":"iu","iso639-2t":"iku"},{"iso639-1":"ja","iso639-2t":"jpn"},{"iso639-1":"jv","iso639-2t":"jav"},{"iso639-1":"kl","iso639-2t":"kal"},{"iso639-1":"kn","iso639-2t":"kan"},{"iso639-1":"kr","iso639-2t":"kau"},{"iso639-1":"ks","iso639-2t":"kas"},{"iso639-1":"kk","iso639-2t":"kaz"},{"iso639-1":"km","iso639-2t":"khm"},{"iso639-1":"ki","iso639-2t":"kik"},{"iso639-1":"rw","iso639-2t":"kin"},{"iso639-1":"ky","iso639-2t":"kir"},{"iso639-1":"kv","iso639-2t":"kom"},{"iso639-1":"kg","iso639-2t":"kon"},{"iso639-1":"ko","iso639-2t":"kor"},{"iso639-1":"ku","iso639-2t":"kur"},{"iso639-1":"kj","iso639-2t":"kua"},{"iso639-1":"la","iso639-2t":"lat"},{"iso639-1":"lb","iso639-2t":"ltz"},{"iso639-1":"lg","iso639-2t":"lug"},{"iso639-1":"li","iso639-2t":"lim"},{"iso639-1":"ln","iso639-2t":"lin"},{"iso639-1":"lo","iso639-2t":"lao"},{"iso639-1":"lt","iso639-2t":"lit"},{"iso639-1":"lu","iso639-2t":"lub"},{"iso639-1":"lv","iso639-2t":"lav"},{"iso639-1":"gv","iso639-2t":"glv"},{"iso639-1":"mk","iso639-2t":"mkd"},{"iso639-1":"mg","iso639-2t":"mlg"},{"iso639-1":"ms","iso639-2t":"msa"},{"iso639-1":"ml","iso639-2t":"mal"},{"iso639-1":"mt","iso639-2t":"mlt"},{"iso639-1":"mi","iso639-2t":"mri"},{"iso639-1":"mr","iso639-2t":"mar"},{"iso639-1":"mh","iso639-2t":"mah"},{"iso639-1":"mn","iso639-2t":"mon"},{"iso639-1":"na","iso639-2t":"nau"},{"iso639-1":"nv","iso639-2t":"nav"},{"iso639-1":"nd","iso639-2t":"nde"},{"iso639-1":"ne","iso639-2t":"nep"},{"iso639-1":"ng","iso639-2t":"ndo"},{"iso639-1":"nb","iso639-2t":"nob"},{"iso639-1":"nn","iso639-2t":"nno"},{"iso639-1":"no","iso639-2t":"nor"},{"iso639-1":"ii","iso639-2t":"iii"},{"iso639-1":"nr","iso639-2t":"nbl"},{"iso639-1":"oc","iso639-2t":"oci"},{"iso639-1":"oj","iso639-2t":"oji"},{"iso639-1":"cu","iso639-2t":"chu"},{"iso639-1":"om","iso639-2t":"orm"},{"iso639-1":"or","iso639-2t":"ori"},{"iso639-1":"os","iso639-2t":"oss"},{"iso639-1":"pa","iso639-2t":"pan"},{"iso639-1":"pi","iso639-2t":"pli"},{"iso639-1":"fa","iso639-2t":"fas"},{"iso639-1":"pl","iso639-2t":"pol"},{"iso639-1":"ps","iso639-2t":"pus"},{"iso639-1":"pt","iso639-2t":"por"},{"iso639-1":"qu","iso639-2t":"que"},{"iso639-1":"rm","iso639-2t":"roh"},{"iso639-1":"rn","iso639-2t":"run"},{"iso639-1":"ro","iso639-2t":"ron"},{"iso639-1":"ru","iso639-2t":"rus"},{"iso639-1":"sa","iso639-2t":"san"},{"iso639-1":"sc","iso639-2t":"srd"},{"iso639-1":"sd","iso639-2t":"snd"},{"iso639-1":"se","iso639-2t":"sme"},{"iso639-1":"sm","iso639-2t":"smo"},{"iso639-1":"sg","iso639-2t":"sag"},{"iso639-1":"sr","iso639-2t":"srp"},{"iso639-1":"gd","iso639-2t":"gla"},{"iso639-1":"sn","iso639-2t":"sna"},{"iso639-1":"si","iso639-2t":"sin"},{"iso639-1":"sk","iso639-2t":"slk"},{"iso639-1":"sl","iso639-2t":"slv"},{"iso639-1":"so","iso639-2t":"som"},{"iso639-1":"st","iso639-2t":"sot"},{"iso639-1":"es","iso639-2t":"spa"},{"iso639-1":"su","iso639-2t":"sun"},{"iso639-1":"sw","iso639-2t":"swa"},{"iso639-1":"ss","iso639-2t":"ssw"},{"iso639-1":"sv","iso639-2t":"swe"},{"iso639-1":"ta","iso639-2t":"tam"},{"iso639-1":"te","iso639-2t":"tel"},{"iso639-1":"tg","iso639-2t":"tgk"},{"iso639-1":"th","iso639-2t":"tha"},{"iso639-1":"ti","iso639-2t":"tir"},{"iso639-1":"bo","iso639-2t":"bod"},{"iso639-1":"tk","iso639-2t":"tuk"},{"iso639-1":"tl","iso639-2t":"tgl"},{"iso639-1":"tn","iso639-2t":"tsn"},{"iso639-1":"to","iso639-2t":"ton"},{"iso639-1":"tr","iso639-2t":"tur"},{"iso639-1":"ts","iso639-2t":"tso"},{"iso639-1":"tt","iso639-2t":"tat"},{"iso639-1":"tw","iso639-2t":"twi"},{"iso639-1":"ty","iso639-2t":"tah"},{"iso639-1":"ug","iso639-2t":"uig"},{"iso639-1":"uk","iso639-2t":"ukr"},{"iso639-1":"ur","iso639-2t":"urd"},{"iso639-1":"uz","iso639-2t":"uzb"},{"iso639-1":"ve","iso639-2t":"ven"},{"iso639-1":"vi","iso639-2t":"vie"},{"iso639-1":"vo","iso639-2t":"vol"},{"iso639-1":"wa","iso639-2t":"wln"},{"iso639-1":"cy","iso639-2t":"cym"},{"iso639-1":"wo","iso639-2t":"wol"},{"iso639-1":"fy","iso639-2t":"fry"},{"iso639-1":"xh","iso639-2t":"xho"},{"iso639-1":"yi","iso639-2t":"yid"},{"iso639-1":"yo","iso639-2t":"yor"},{"iso639-1":"za","iso639-2t":"zha"},{"iso639-1":"zu","iso639-2t":"zul"}],i}();t.LanguageCodes=n});e(_t);_t.LanguageCodes;var xt=function(){function l(){}return l.withDefault=function(e,t){return null!=e?e:t},l.exists=function(e){return null!=e},l.isNullOrUndefined=function(e){return null==e},l.isUndefined=function(e){return void 0===e},l.isPropertyNullOrUndefined=function(e,t){return null==e||null==e[t]},l.nestedValue=function(e,t,n){var r;if(void 0===n&&(n=null),0===(r="string"==typeof t?t.split("."):t).length)return n;var i=F.reduce(r,function(e,t){return null==e?null:e[t]},e);return null==i?n:i},l.deepTraverse=function(e,t){var n=e;for(var r in n)e.hasOwnProperty(r)&&(t(e,r,n[r]),null!=n[r]&&"object"==typeof n[r]&&l.deepTraverse(n[r],t))},l.sanitize=function(e,n){void 0===n&&(n=!1),l.deepTraverse(e,function(e,t){(l.isUndefined(e[t])||n&&null===e[t])&&delete e[t]})},l.isObject=function(e){return F.isObject(e)},l.deepExtend=function(e,t){if(null==t)return l.withDefault(F.clone(e),null);if(null==e)return F.clone(t);for(var n={},r=0,i=F.union(Object.keys(e),Object.keys(t));r<i.length;r++){var o=i[r],a=e[o],s=t[o];l.isUndefined(a)?n[o]=F.clone(s):l.isObject(a)&&l.isObject(s)&&!F.isArray(a)&&!F.isArray(s)?n[o]=this.deepExtend(a,s):n[o]=l.withDefault(t[o],e[o])}return n},l}(),kt=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function l(){}return l.getStandardizedLocale=function(e){if(!xt.exists(e))return null;var t=l[e.replace("-","_").toUpperCase()];return xt.withDefault(t,null)},l.getLocaleFromMarketplaceId=function(e){var t=l.MarketplaceLocaleMap[e];return xt.withDefault(t,null)},l.equal=function(e,t){return 0===l.compare(e,t)},l.getClosestLocale=function(e,t){void 0===t&&(t=l.AvailableLocales);for(var n=_t.LanguageCodes.getLanguageCodeFromLocale(e),r=null,i=0,o=t;i<o.length;i++){var a=o[i];if(l.equal(e,a))return a;var s=_t.LanguageCodes.getLanguageCodeFromLocale(a);null===r&&n===s&&(r=a)}return r},l.makeLocaleComparator=function(e,i,t){var o=null;return null!==t&&(o=l.getClosestLocale(t,e.map(i).sort(l.compare))),function(e,t){var n=i(e),r=i(t);return null===o?l.compare(n,r):l.equal(n,r)?0:l.equal(n,o)?-1:l.equal(r,o)?1:l.compare(n,r)}},l.AR_AE="ar-AE",l.CS_CZ="cs-CZ",l.DA_DK="da-DK",l.DE_DE="de-DE",l.EN_GB="en-GB",l.EN_US="en-US",l.ES_ES="es-ES",l.ES_MX="es-MX",l.AvailableLocales=[l.AR_AE,l.CS_CZ,l.DA_DK,l.DE_DE,l.EN_GB,l.EN_US,l.ES_ES,l.ES_US="es-US",l.FI_FI="fi-FI",l.FIL_PH="fil-PH",l.FR_FR="fr-FR",l.HE_IL="he-IL",l.HI_IN="hi-IN",l.ID_ID="id-ID",l.IT_IT="it-IT",l.JA_JP="ja-JP",l.KO_KR="ko-KR",l.MS_MY="ms-MY",l.NB_NO="nb-NO",l.NL_NL="nl-NL",l.PL_PL="pl-PL",l.PT_BR="pt-BR",l.PT_PT="pt-PT",l.RU_RU="ru-RU",l.SV_SE="sv-SE",l.TA_IN="ta-IN",l.TE_IN="te-IN",l.TH_TH="th-TH",l.TR_TR="tr-TR",l.ZH_CN="zh-CN",l.ZH_TW="zh-TW"],l.MarketplaceLocaleMap=((n={})[Y.MarketplaceID.US]=l.EN_US,n[Y.MarketplaceID.UK]=l.EN_GB,n[Y.MarketplaceID.DE]=l.DE_DE,n[Y.MarketplaceID.JP]=l.JA_JP,n),l.compare=new Intl.Collator(void 0,{sensitivity:"base"}).compare,l}();t.Locales=r});e(kt);kt.Locales;var Rt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.makeLocalizationInput=function(e){return e}});e(Rt);Rt.makeLocalizationInput;var At=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("EventEmitter"),n=function(){function u(){this.timer=A.timer,this.onCallbacks={},this.onceCallbacks={},this.idempotentEvents={},this.maxListeners=10}return u.onUnhandledEventListener=function(e){u.unhandledEventListenerCallback=e},u.prototype.emitSync=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=this.onCallbacks[t],i=this.onceCallbacks[t],o=[];r&&(o=o.concat(r)),i&&(o=o.concat(i),delete this.onceCallbacks[t]);for(var a=0,s=o;a<s.length;a++){var l=s[a];try{l.apply(void 0,e)}catch(e){c.error("UnhandledEventListenerError for '"+t+"' event:",e,"Stack:",e.stack),null!=u.unhandledEventListenerCallback&&u.unhandledEventListenerCallback(e,t.toString())}}},u.prototype.emit=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];this.timer.setImmediate(function(){return t.emitSync.apply(t,[e].concat(n))})},u.prototype.emitIdempotent=function(e){var t=this;null==this.idempotentEvents[e]&&(this.idempotentEvents[e]=!0,this.timer.setImmediate(function(){delete t.idempotentEvents[e],t.emitSync(e)}))},u.prototype.off=function(e,t){var n=this.onCallbacks[e],r=this.onceCallbacks[e],i=!1;if(n){var o=n.length;this.inPlaceFilter(n,t),o!==n.length&&(i=!0),0===n.length&&delete this.onCallbacks[e]}r&&!i&&(this.inPlaceFilter(r,t),0===r.length&&delete this.onceCallbacks[e])},u.prototype.on=function(e,t){var n=this.onCallbacks[e];n?(n.push(t),0<this.maxListeners&&n.length===this.maxListeners+1&&c.warn("MaxListenersExceededWarning for event \""+e+"\"",(new Error).stack)):this.onCallbacks[e]=[t]},u.prototype.once=function(e,t){var n=this.onceCallbacks[e];n?n.push(t):this.onceCallbacks[e]=[t]},u.prototype.removeAllListeners=function(e){void 0===e&&(e=null),null===e?(this.onCallbacks={},this.onceCallbacks={}):(delete this.onCallbacks[e],delete this.onceCallbacks[e])},u.prototype.setMaxListeners=function(e){this.maxListeners=e},u.prototype.listeners=function(e){var t=this.onCallbacks[e],n=this.onceCallbacks[e],r=[];return t&&(r=r.concat(t)),n&&(r=r.concat(n)),r},u.prototype.inPlaceFilter=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t){e.splice(n,1);break}},u}();t.EventEmitter=n});e(At);At.EventEmitter;var Ot=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.events={},this.eventSource=e}return e.prototype.on=function(e,t){if(null!=this.events[e])throw new Error("this.events[\""+e+"\"] already exists");this.events[e]=t,this.eventSource.on(e,t)},e.prototype.off=function(e,t){delete this.events[e],this.eventSource.off(e,t)},e.prototype.removeAllListeners=function(){for(var e in this.events)this.events.hasOwnProperty(e)&&this.off(e,this.events[e])},e}();t.EventTracker=n});e(Ot);Ot.EventTracker;var Lt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("MulticastCallback"),n=function(){function i(){this.timer=A.timer,this.callbacks=[]}return i.onUnhandledEventListener=function(e){i.unhandledEventListenerCallback=e},i.prototype.add=function(e){this.callbacks.push(e)},i.prototype.remove=function(e){this.callbacks=F.without(this.callbacks,e)},i.prototype.removeAll=function(){this.callbacks=[]},i.prototype.getAllCallbacks=function(){return this.callbacks},i.prototype.invoke=function(e){var t=this;this.timer.setImmediate(function(){return t.invokeSync(e)})},i.prototype.invokeSync=function(e){for(var t=0,n=this.callbacks;t<n.length;t++){var r=n[t];try{r(e)}catch(e){o.error("UnhandledEventListenerError: "+e+". Stack: "+e.stack),null!=i.unhandledEventListenerCallback&&i.unhandledEventListenerCallback(e)}}},i}();t.MulticastCallback=n});e(Lt);Lt.MulticastCallback;var Ft=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("MultiplexedEventSource");var n=function(){function e(e){void 0===e&&(e=!1),this.sources=[],this.allListeners=[],this.active=null,this.bufferedCallbacks=[],this.bufferInactiveEvents=e}return e.prototype.selectSource=function(t){var e=F.find(this.sources,function(e){return e.id===t});if(null==e)throw new Error("Entry with id "+t+" doesn't exist");this.active=e.source,this.reEmitEventsForSourceId(t)},e.prototype.addSource=function(t,n){var r=this;if(null!=F.find(this.sources,function(e){return e.id===t}))throw new Error("Source with id "+t+" already exist");this.sources.push({id:t,source:n}),F.each(this.allListeners,function(e){r.listenDownstream(t,n,e)})},e.prototype.removeSource=function(t){var n=this,e=F.partition(this.sources,function(e){return e.id===t});if(0===e[0].length)throw new Error("No source with id "+t+" exists");this.sources=e[1];var r=e[0][0];F.each(this.allListeners,function(e){n.unlistenDownstream(t,r.source,e)}),this.active===r.source&&(this.active=null)},e.prototype.on=function(e,t){this.internalOn(e,t)},e.prototype.off=function(t,n){var e=F.findIndex(this.allListeners,function(e){return e.event===t&&(e.callback===n||e.onceOriginCallback===n)});if(-1!==e){var r=this.allListeners[e];this.allListeners.splice(e,1),F.each(r.downstreamListeners,function(e){e.source.off(r.event,e.callback)})}},e.prototype.once=function(n,r){var i=this,o=!1,a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.off(n,a),o||(r.apply(i,e),o=!0)};this.internalOn(n,a,r)},e.prototype.internalOn=function(e,t,n){void 0===n&&(n=null);var r={event:e,callback:t,onceOriginCallback:n,downstreamListeners:[]};this.allListeners.push(r),this.listenAllDownstreams(r)},e.prototype.listenAllDownstreams=function(t){var n=this;F.each(this.sources,function(e){n.listenDownstream(e.id,e.source,t)})},e.prototype.listenDownstream=function(r,i,o){var a=this,e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(){return o.callback.apply(a,e)};a.active===i?(o.onceOriginCallback&&a.off(o.event,o.callback),n()):a.bufferInactiveEvents&&a.bufferCallbackForId(r,n)};o.downstreamListeners.push({source:i,callback:e}),i.on(o.event,e)},e.prototype.unlistenDownstream=function(e,t,n){n.downstreamListeners=F.reject(n.downstreamListeners,function(e){return e.source===t&&(t.off(n.event,e.callback),!0)});var r=this.getBufferedCallbacksForId(e);null!=r&&(r.callbacks=[])},e.prototype.bufferCallbackForId=function(e,t){var n=this.getBufferedCallbacksForId(e);null==n&&(n={id:e,callbacks:[]},this.bufferedCallbacks.push(n)),n.callbacks.push(t)},e.prototype.reEmitEventsForSourceId=function(e){if(this.bufferInactiveEvents){var t=this.getBufferedCallbacksForId(e);if(null!=t&&!F.isEmpty(t.callbacks)){for(var n=0,r=t.callbacks;n<r.length;n++){(0,r[n])()}t.callbacks=[]}}},e.prototype.getBufferedCallbacksForId=function(t){return F.find(this.bufferedCallbacks,function(e){return e.id===t})},e}();t.MultiplexedEventSource=n});e(Ft);Ft.MultiplexedEventSource;var Dt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=At.EventEmitter,t.EventTracker=Ot.EventTracker,t.MulticastCallback=Lt.MulticastCallback,t.MultiplexedEventSource=Ft.MultiplexedEventSource});e(Dt);Dt.EventEmitter,Dt.EventTracker,Dt.MulticastCallback,Dt.MultiplexedEventSource;var Nt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function n(e,t){void 0===t&&(t=window);var r=this;this.VERSION=1,this.dbOpenRequest=null,this.pendingDbOperations=[],this.database=null,this.tryInitialize=function(e){r.database||!n.isSupported(r.windowRef)?e():(r.pendingDbOperations.push(e),r.dbOpenRequest||r.initialize(function(){for(var e=0,t=r.pendingDbOperations;e<t.length;e++){var n=t[e];"function"==typeof n&&n()}r.dbOpenRequest=null,r.pendingDbOperations=[]}))},this.initialize=function(t){try{var e=r.windowRef.indexedDB.open(r.dbName,r.VERSION);e.onsuccess=function(e){try{r.database=e.target.result}catch(e){}t()},e.onupgradeneeded=function(e){e.oldVersion<1&&(r.database=e.target.result,r.database.createObjectStore(r.dbName))},e.onerror=function(e){e.preventDefault(),t()}}catch(e){t()}},this.dbName=e,this.windowRef=t}return n.prototype.get=function(t,r){var i=this;this.tryInitialize(function(){try{if(!i.database)return r();var n=(new Date).getTime(),e=i.database.transaction([i.dbName],"readonly").objectStore(i.dbName).get(t);e.onsuccess=function(e){try{var t=e.target.result;r(t,(new Date).getTime()-n)}catch(e){r()}},e.onerror=function(){r()}}catch(e){r()}})},n.prototype.set=function(e,t){var n=this;this.tryInitialize(function(){try{n.database&&n.database.transaction([n.dbName],"readwrite").objectStore(n.dbName).put(t,e)}catch(e){}})},n.prototype.clear=function(){var e=this;this.tryInitialize(function(){try{e.database&&e.database.transaction([e.dbName],"readwrite").objectStore(e.dbName).clear()}catch(e){}})},n.isSupported=function(e){return void 0===e&&(e=window),void 0!==e.indexedDB},n}();t.IndexedDBStorage=n});e(Nt);Nt.IndexedDBStorage;var Ut=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDBStorage=Nt.IndexedDBStorage});e(Ut);Ut.IndexedDBStorage;var Bt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){void 0===e&&(e=12e4),void 0===t&&(t=2),void 0===n&&(n=document);var r=this;this.scriptErrorCount=0,this.scriptLoaded=!1,this.onScriptError=function(e,t,n){e&&(e.onload=e.onerror=e.onreadystatechange=null),clearTimeout(r.scriptTimerId),r.objectExists(r.scriptInfo.name)||(++r.scriptErrorCount<r.maxAttempts?(r.onNonFatal(t),r.setScript(n)):r.onFatal(t))},this.scriptTimeoutMs=e,this.maxAttempts=t,this.documentInstance=n}return e.prototype.get=function(e,t,n,r,i){void 0===i&&(i=!1),this.scriptInfo=e,this.onLoad=t,this.onNonFatal=n,this.onFatal=r,this.scriptErrorCount=0,this.scriptLoaded=!1,this.bustCache=i,clearTimeout(this.scriptTimerId),this.setScript(this.scriptInfo.url)},e.prototype.setScript=function(t){var n=this,r=this.documentInstance.createElement("script");this.scriptTimerId=setTimeout(function(){n.onScriptError(r,new Error("Script load timed out. "+n.scriptInfo.name+" for "+t),t)},this.scriptTimeoutMs);var i=(new Date).getTime();r.setAttribute("crossorigin","anonymous"),r.onload=r.onreadystatechange=function(){if(!n.scriptLoaded&&(void 0===r.readyState||"loaded"===r.readyState||"complete"===r.readyState))if(n.objectExists(n.scriptInfo.name)){clearTimeout(n.scriptTimerId),n.scriptLoaded=!0;var e=(new Date).getTime()-i;r.onload=r.onerror=r.onreadystatechange=null,n.onLoad({cached:!1,downloadMs:e,totalMs:e})}else n.onScriptError(r,new Error("Script loaded but missing result object. Expected "+n.scriptInfo.name+" for "+t),t)},r.onerror=function(){n.onScriptError(r,new Error("Script onerror fired: "+n.scriptInfo.name+" for "+t),t)};var e=this.bustCache?"?t="+(new Date).getTime():"";r.src=t+e,this.documentInstance.getElementsByTagName("head")[0].appendChild(r)},e.prototype.objectExists=function(e){return void 0!==window[e]},e}();t.JavaScriptLoader=n});e(Bt);Bt.JavaScriptLoader;var Vt=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.JavaScript=0]="JavaScript",r[r.JSON=1]="JSON",t.ScriptType=n});e(Vt);Vt.ScriptType;var jt=t(function(e,t){var n;n=function(e){e.version='0.4.0';var a=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return'undefined'!=typeof Int32Array?new Int32Array(t):t}(),i='undefined'!=typeof Buffer;function o(e){for(var t=-1,n=0,r=e.length-7;n<r;)t=(t=(t=(t=(t=(t=(t=(t=t>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])];for(;n<r+7;)t=t>>>8^a[255&(t^e[n++])];return-1^t}e.table=a,e.bstr=function(e){if(32768<e.length&&i)return o(new Buffer(e));for(var t=-1,n=e.length-1,r=0;r<n;)t=a[255&(t^e.charCodeAt(r++))]^t>>>8,t=a[255&(t^e.charCodeAt(r++))]^t>>>8;return r===n&&(t=t>>>8^a[255&(t^e.charCodeAt(r))]),-1^t},e.buf=function(e){if(1e4<e.length)return o(e);for(var t=-1,n=0,r=e.length-3;n<r;)t=(t=(t=(t=t>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])])>>>8^a[255&(t^e[n++])];for(;n<r+3;)t=t>>>8^a[255&(t^e[n++])];return-1^t},e.str=function(e){for(var t,n,r=-1,i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))<128?r=r>>>8^a[255&(r^t)]:t<2048?r=(r=r>>>8^a[255&(r^(192|t>>6&31))])>>>8^a[255&(r^(128|63&t))]:55296<=t&&t<57344?(t=64+(1023&t),n=1023&e.charCodeAt(i++),r=(r=(r=(r=r>>>8^a[255&(r^(240|t>>8&7))])>>>8^a[255&(r^(128|t>>2&63))])>>>8^a[255&(r^(128|n>>6&15|(3&t)<<4))])>>>8^a[255&(r^(128|63&n))]):r=(r=(r=r>>>8^a[255&(r^(224|t>>12&15))])>>>8^a[255&(r^(128|t>>6&63))])>>>8^a[255&(r^(128|63&t))];return-1^r}},'undefined'==typeof DO_NOT_EXPORT_CRC?n(t):n({})}),Xt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var g="X-Server-IP",n=function(){function e(e,t){void 0===e&&(e=XMLHttpRequest),void 0===t&&(t=jt.str);var y=this;this.makeXHRRequest=function(r,l,i,o,u,a,s,c){void 0===c&&(c=0);var d=new y.XHR,p="",f=function(e){e||(e={type:"unknown error"});var t=new Error("XHR "+e.type+" for "+r+". Status: "+d.status+", readyState: "+d.readyState),n={attempt:c,cloudfrontRequestID:d.getResponseHeader("x-amz-cf-id"),contentHash:e.contentHash,contentLength:e.contentLength,contentLengthHeader:-1!==p.indexOf("Content-Length")?d.getResponseHeader("Content-Length"):null,serverIP:-1!==p.indexOf(g)?d.getResponseHeader(g):null};0<o?(a(t,n),y.makeXHRRequest(r,l,i,--o,u,a,s,c+1)):s(t,n)},h=y.now(),m=h;d.addEventListener("readystatechange",function(){2===d.readyState&&(m=y.now())}),d.addEventListener("load",function(){if(p=d.getAllResponseHeaders(),200===d.status){var e=d.responseText,t=y.now(),n=!0,r=null,i="(not checked)";if(l){var o=y.now();n=(i=""+y.toCRC32(e))===l,r=y.now()-o}if(n)u(e,{cached:!1,latencyMs:m-h,downloadMs:t-m,verifyMs:r,serverIP:-1!==p.indexOf(g)?d.getResponseHeader(g):null});else{var a=e?e.length:0,s=0<a?"["+e.substr(0,15)+"]":"(empty)";f({type:"verify failed "+s,contentLength:a,contentHash:i})}}else f({type:"bad response"})}),d.addEventListener("error",f),d.addEventListener("timeout",f);var e=0===c?"":"?t="+y.now();d.open("GET",r+e),d.timeout=i,d.send()},this.XHR=e,this.toCRC32=t}return e.prototype.isSupported=function(){return"withCredentials"in new this.XHR},e.prototype.get=function(e,t,n,r,i,o,a){this.makeXHRRequest(e,t,n,r,i,o,a)},e.prototype.now=function(){return(new Date).getTime()},e}();t.SimpleURLAcquirer=n});e(Xt);Xt.SimpleURLAcquirer;var zt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){void 0===e&&(e=new Bt.JavaScriptLoader),void 0===t&&(t=new Xt.SimpleURLAcquirer),void 0===n&&(n=new Ut.IndexedDBStorage("ScriptStore"));var o=this;this.SCRIPT_TYPES_XHR_REQUIRED=[Vt.ScriptType.JSON],this.XHR_TIMEOUT_MS=12e4,this.XHR_RETRIES=2,this.loadJsonFromString=function(t,e,n){try{var r=(new Date).getTime();n.payload=JSON.parse(e),n.parseMs=(new Date).getTime()-r,n.totalMs=o.calculateTotalLoadMs(n),t.onLoad(n)}catch(e){o.onError(t,e)}},this.loadJavaScriptFromString=function(t,e,n){try{var r=new Blob([e],{type:"application/javascript"}),i={url:o.createObjectURL(r),name:t.scriptInfo.name,type:t.scriptInfo.type,version:t.scriptInfo.version};o.javaScriptLoader.get(i,function(e){n.parseMs=e.downloadMs,n.totalMs=o.calculateTotalLoadMs(n),t.onLoad(n)},t.onNonFatal,function(e){return o.onError(t,e)})}catch(e){o.onError(t,e)}},this.loadJavaScriptFromOrigin=function(e){o.javaScriptLoader.get(e.scriptInfo,e.onLoad,e.onNonFatal,e.onFatal,!0)},this.loadJsonFromOrigin=function(n){o.urlAcquirer.get(n.scriptInfo.url,n.scriptInfo.crc32,o.XHR_TIMEOUT_MS,o.XHR_RETRIES,function(e,t){o.loadFromString(n,e,t)},function(e){n.onNonFatal(e)},function(e){n.onFatal(e)})},this.javaScriptLoader=e,this.urlAcquirer=t,this.offlineStorage=n,this.loadFromStringFunctions={},this.loadFromStringFunctions[Vt.ScriptType.JavaScript]=this.loadJavaScriptFromString,this.loadFromStringFunctions[Vt.ScriptType.JSON]=this.loadJsonFromString,this.loadFromOriginFunctions={},this.loadFromOriginFunctions[Vt.ScriptType.JavaScript]=this.loadJavaScriptFromOrigin,this.loadFromOriginFunctions[Vt.ScriptType.JSON]=this.loadJsonFromOrigin,!this.isDefined(r)&&this.isDefined(window.URL)?this.createObjectURL=URL.createObjectURL:this.createObjectURL=r}return e.prototype.getContent=function(e,t){var n=this.requiresUrlAcquirer(e.scriptInfo.type);n&&!this.urlAcquirer.isSupported()?e.onFatal(new Error("URLAcquirer not supported but "+Vt.ScriptType[e.scriptInfo.type]+" requires it.")):!n&&this.onlySupportsOrigin()?this.loadFromOrigin(e):this.offlineStorage.get(e.scriptInfo.name,t)},e.prototype.loadFromString=function(e,t,n){var r=this.loadFromStringFunctions[e.scriptInfo.type];this.isDefined(r)?r(e,t,n):e.onFatal(new Error("No loadFromString function found for "+Vt.ScriptType[e.scriptInfo.type]))},e.prototype.loadFromOrigin=function(e){var t=this.loadFromOriginFunctions[e.scriptInfo.type];this.isDefined(t)?t(e):e.onFatal(new Error("No loadFromOrigin function found for "+Vt.ScriptType[e.scriptInfo.type]))},e.prototype.acquireNewAsset=function(n,r,i){var o=this;void 0===i&&(i=!0),this.urlAcquirer.get(n.scriptInfo.url,n.scriptInfo.crc32,this.XHR_TIMEOUT_MS,this.XHR_RETRIES,function(e,t){i&&o.offlineStorage.set(n.scriptInfo.name,{version:n.scriptInfo.version,data:e}),r&&o.loadFromString(n,e,t)},function(e,t){n.onNonFatal(e,t)},function(e,t){r&&o.onError(n,e,t)})},e.prototype.onError=function(e,t,n){e.onNonFatal(t,n),this.loadFromOrigin(e)},e.prototype.requiresUrlAcquirer=function(e){return-1!==this.SCRIPT_TYPES_XHR_REQUIRED.indexOf(e)},e.prototype.onlySupportsOrigin=function(){return!(this.isDefined(window.Blob)&&this.urlAcquirer.isSupported())},e.prototype.isDefined=function(e){return void 0!==e},e.prototype.nonNumberToZero=function(e){return"number"==typeof e?e:0},e.prototype.calculateTotalLoadMs=function(e){return this.nonNumberToZero(e.cacheLoadMs)+this.nonNumberToZero(e.latencyMs)+this.nonNumberToZero(e.downloadMs)+this.nonNumberToZero(e.verifyMs)+this.nonNumberToZero(e.parseMs)},e}();t.BaseCachingScriptLoader=n});e(zt);zt.BaseCachingScriptLoader;var qt=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e,t,n,r){return i.call(this,e,t,n,r)||this}return n(e,i),e.prototype.get=function(n,e,t,r){var i=this,o={scriptInfo:n,onLoad:e,onNonFatal:t,onFatal:r};this.getContent(o,function(e,t){e?(i.loadFromString(o,e.data,{cached:!0,cacheLoadMs:t}),e.version!==n.version&&i.acquireNewAsset(o,!1)):i.acquireNewAsset(o,!0)})},e}(zt.BaseCachingScriptLoader);t.LazyCachingScriptLoader=i});e(qt);qt.LazyCachingScriptLoader;var Wt=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e,t,n,r){return i.call(this,e,t,n,r)||this}return n(e,i),e.prototype.get=function(n,e,t,r,i){var o=this;void 0===i&&(i=!0);var a={scriptInfo:n,onLoad:e,onNonFatal:t,onFatal:r};i?this.getContent(a,function(e,t){e&&e.version===n.version?o.loadFromString(a,e.data,{cached:!0,cacheLoadMs:t}):o.acquireNewAsset(a,!0)}):this.onlySupportsOrigin()?this.loadFromOrigin(a):this.acquireNewAsset(a,!0,!1)},e}(zt.BaseCachingScriptLoader);t.TransparentCachingScriptLoader=i});e(Wt);Wt.TransparentCachingScriptLoader;var Ht=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LazyCachingScriptLoader=qt.LazyCachingScriptLoader,t.TransparentCachingScriptLoader=Wt.TransparentCachingScriptLoader,t.JavaScriptLoader=Bt.JavaScriptLoader,t.ScriptType=Vt.ScriptType});e(Ht);Ht.LazyCachingScriptLoader,Ht.TransparentCachingScriptLoader,Ht.JavaScriptLoader,Ht.ScriptType;var Gt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("LocalizationAcquirer"),n=function(){function a(e){void 0===e&&(e=new Ht.TransparentCachingScriptLoader),this.cacheEnabled=!1,this.loader=e,this.name="",this.sources=null,this.version=""}return a.prototype.initialize=function(e,t,n,r){void 0===r&&(r=!0),this.version=e,this.name=t,this.sources=n,this.cacheEnabled=r,this.cacheEnabled||s.info("Localization caching disabled for "+this.name+".")},a.prototype.acquire=function(t,i,o){if(null==this.sources||F.isEmpty(this.sources))o(new Error(a.NO_SOURCES_ERROR));else if(null!=this.version){var n=this.sources[t];if(null!=n){var e={url:n,name:this.name+"-"+t,type:Ht.ScriptType.JSON,version:this.version};this.loader.get(e,function(e){var t=e.payload,n=null!=e.totalMs?e.totalMs:0,r=null!=e.cached&&e.cached;F.isEmpty(t)?o(new Error(a.EMPTY_LOCALIZATION_ERROR)):i(t,n,r)},function(e){s.warn("A non-fatal error occurred while trying to download "+t+" at "+n,e)},o,this.cacheEnabled)}else o(new Error("URL not found for "+t))}else o(new Error(a.NO_VERSION_ERROR))},a.EMPTY_LOCALIZATION_ERROR="Acquired localization object is empty.",a.NO_SOURCES_ERROR="No sources are defined. LocalizationAcquirer may not have been initialized.",a.NO_VERSION_ERROR="No version is defined. LocalizationAcquirer may not have been initialized.",a}();t.LocalizationAcquirer=n});e(Gt);Gt.LocalizationAcquirer;var Kt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("LocalizationStore"),n=function(){function e(e,t,n,r,i,o,a,s){void 0===i&&(i=!0),void 0===o&&(o=!0),void 0===a&&(a=new Gt.LocalizationAcquirer),void 0===s&&(s=new Dt.EventEmitter);var l=this;this.loadedLanguages={},this.cancelPreviousSetLanguage=function(){},this.localizationAcquirer=a,this.enableAmazonBranding=o,this.eventEmitter=s;var u={};F.chain(n).keys().forEach(function(e){F.isString(n[e])?u[e]=n[e]:l.loadedLanguages[e]=l.fixStringBranding(n[e])}),this.localizationAcquirer.initialize(e,t,u,i),c.info("Pre-loaded languages: "+F.keys(this.loadedLanguages).join(", ")),c.info("Not loaded languages: "+F.keys(u).join(", ")),null!=r&&0<r.length&&(F.contains(F.keys(this.loadedLanguages),r)?(this.defaultLanguageCode=r,c.info("Default language code set to "+this.defaultLanguageCode+".")):c.warn("Default language code set to "+r+" but will be ignored because its localization object was not provided."))}return e.prototype.setLanguage=function(r,i,o){var a=this;if(this.cancelPreviousSetLanguage(),null==this.loadedLanguages[r]){var e=Fe.CancelToken.source(),t=e.cancel,s=e.token;this.cancelPreviousSetLanguage=t,this.localizationAcquirer.acquire(r,function(e,t,n){a.loadedLanguages[r]=a.fixStringBranding(e);try{s.throwIfRequested(),a.onAcquireSuccess(r,e,t,n,i)}catch(e){null!=o&&o(e)}},function(e){try{s.throwIfRequested(),a.onAcquireError(r,e,i,o)}catch(e){null!=o&&o(e)}})}else this.onAcquireSuccess(r,this.loadedLanguages[r],0,!0,i)},e.prototype.getLocalization=function(){if(null!=this.currentLanguageCode)return this.loadedLanguages[this.currentLanguageCode]},e.prototype.getCurrentLanguage=function(){return this.currentLanguageCode},e.prototype.onLanguageChanged=function(e){this.eventEmitter.on("LanguageChange",e)},e.prototype.offLanguageChanged=function(e){this.eventEmitter.off("LanguageChange",e)},e.prototype.mapReplace=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];e=e.replace(new RegExp("{{"+i+"}}","g"),t[i])}return e},e.prototype.onAcquireSuccess=function(e,t,n,r,i){c.info("Acquired localization for "+e+" in "+n+"ms"+(r?" from cache":"")+"."),this.currentLanguageCode=e,this.eventEmitter.emit("LanguageChange",this.currentLanguageCode),null!=i&&i(this.loadedLanguages[this.currentLanguageCode],n,r)},e.prototype.onAcquireError=function(e,t,n,r){c.error("An error occurred while trying to acquire "+e+".",t),null!=r&&r(t),null==this.currentLanguageCode&&null!=this.defaultLanguageCode&&0<this.defaultLanguageCode.length&&(c.info("Falling back to "+this.defaultLanguageCode+"."),this.setLanguage(this.defaultLanguageCode,n,r))},e.prototype.fixStringBranding=function(e){var t=JSON.parse(JSON.stringify(e));return this.unbrandInPlace(t)},e.prototype.unbrandInPlace=function(r){var i=this;return F.chain(r).keys().forEach(function(e){if(null!=r[e])if("string"==typeof r[e]){var t=e+"Unbranded",n=r[t];i.enableAmazonBranding||null==n||(r[e]=n),delete r[t]}else r[e]=i.unbrandInPlace(r[e])}),r},e}();t.LocalizationStore=n});e(Kt);Kt.LocalizationStore;var Qt=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageCodes=_t.LanguageCodes,t.Locales=kt.Locales,t.makeLocalizationInput=Rt.makeLocalizationInput,t.LocalizationStore=Kt.LocalizationStore});e(Qt);Qt.LanguageCodes,Qt.Locales,Qt.makeLocalizationInput,Qt.LocalizationStore;var Yt=Object.getOwnPropertySymbols,Jt=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable;var Zt=function(){try{if(!Object.assign)return!1;var e=new String('abc');if(e[5]='de','5'===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t['_'+String.fromCharCode(n)]=n;if('0123456789'!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(''))return!1;var r={};return'abcdefghijklmnopqrst'.split('').forEach(function(e){r[e]=e}),'abcdefghijklmnopqrst'===Object.keys(Object.assign({},r)).join('')}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,i=function(e){if(null==e)throw new TypeError('Object.assign cannot be called with null or undefined');return Object(e)}(e),o=1;o<arguments.length;o++){for(var a in n=Object(arguments[o]))Jt.call(n,a)&&(i[a]=n[a]);if(Yt){r=Yt(n);for(var s=0;s<r.length;s++)$t.call(n,r[s])&&(i[r[s]]=n[r[s]])}}return i},en="function"==typeof Symbol&&Symbol.for,tn=en?Symbol.for("react.element"):60103,nn=en?Symbol.for("react.portal"):60106,rn=en?Symbol.for("react.fragment"):60107,on=en?Symbol.for("react.strict_mode"):60108,an=en?Symbol.for("react.profiler"):60114,sn=en?Symbol.for("react.provider"):60109,ln=en?Symbol.for("react.context"):60110,un=en?Symbol.for("react.concurrent_mode"):60111,cn=en?Symbol.for("react.forward_ref"):60112,dn=en?Symbol.for("react.suspense"):60113,pn=en?Symbol.for("react.memo"):60115,fn=en?Symbol.for("react.lazy"):60116,hn="function"==typeof Symbol&&Symbol.iterator;function mn(e){for(var t=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);!function(e,t,n,r,i,o,a,s){if(!e){if((e=void 0)===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,i,o,a,s],u=0;(e=Error(t.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw e.framesToPop=1,e}}(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}var yn={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gn={};function vn(e,t,n){this.props=e,this.context=t,this.refs=gn,this.updater=n||yn}function Sn(){}function bn(e,t,n){this.props=e,this.context=t,this.refs=gn,this.updater=n||yn}vn.prototype.isReactComponent={},vn.prototype.setState=function(e,t){"object"!=typeof e&&"function"!=typeof e&&null!=e&&mn("85"),this.updater.enqueueSetState(this,e,t,"setState")},vn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},Sn.prototype=vn.prototype;var Tn=bn.prototype=new Sn;Tn.constructor=bn,Zt(Tn,vn.prototype),Tn.isPureReactComponent=!0;var Pn={current:null},wn={current:null},Cn=Object.prototype.hasOwnProperty,Mn={key:!0,ref:!0,__self:!0,__source:!0};function In(e,t,n){var r=void 0,i={},o=null,a=null;if(null!=t)for(r in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)Cn.call(t,r)&&!Mn.hasOwnProperty(r)&&(i[r]=t[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===i[r]&&(i[r]=s[r]);return{$$typeof:tn,type:e,key:o,ref:a,props:i,_owner:wn.current}}function En(e){return"object"==typeof e&&null!==e&&e.$$typeof===tn}var _n=/\/+/g,xn=[];function kn(e,t,n,r){if(xn.length){var i=xn.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function Rn(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,xn.length<10&&xn.push(e)}function An(e,t,n){return null==e?0:function e(t,n,r,i){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var a=!1;if(null===t)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case tn:case nn:a=!0}}if(a)return r(i,t,""===n?"."+On(t,0):n),1;if(a=0,n=""===n?".":n+":",Array.isArray(t))for(var s=0;s<t.length;s++){var l=n+On(o=t[s],s);a+=e(o,l,r,i)}else if(l=null===t||"object"!=typeof t?null:"function"==typeof(l=hn&&t[hn]||t["@@iterator"])?l:null,"function"==typeof l)for(t=l.call(t),s=0;!(o=t.next()).done;)a+=e(o=o.value,l=n+On(o,s++),r,i);else"object"===o&&mn("31","[object Object]"==(r=""+t)?"object with keys {"+Object.keys(t).join(", ")+"}":r,"");return a}(e,"",t,n)}function On(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(n=e.key,r={"=":"=0",":":"=2"},"$"+(""+n).replace(/[=:]/g,function(e){return r[e]})):t.toString(36);var n,r}function Ln(e,t){e.func.call(e.context,t,e.count++)}function Fn(e,t,n){var r,i,o=e.result,a=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?Dn(e,o,n,function(e){return e}):null!=e&&(En(e)&&(i=a+(!(r=e).key||t&&t.key===e.key?"":(""+e.key).replace(_n,"$&/")+"/")+n,e={$$typeof:tn,type:r.type,key:i,ref:r.ref,props:r.props,_owner:r._owner}),o.push(e))}function Dn(e,t,n,r,i){var o="";null!=n&&(o=(""+n).replace(_n,"$&/")+"/"),An(e,Fn,t=kn(t,o,r,i)),Rn(t)}function Nn(){var e=Pn.current;return null===e&&mn("321"),e}var Un={Children:{map:function(e,t,n){if(null==e)return e;var r=[];return Dn(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;An(e,Ln,t=kn(null,null,t,n)),Rn(t)},count:function(e){return An(e,function(){return null},null)},toArray:function(e){var t=[];return Dn(e,t,null,function(e){return e}),t},only:function(e){return En(e)||mn("143"),e}},createRef:function(){return{current:null}},Component:vn,PureComponent:bn,createContext:function(e,t){return void 0===t&&(t=null),(e={$$typeof:ln,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:sn,_context:e},e.Consumer=e},forwardRef:function(e){return{$$typeof:cn,render:e}},lazy:function(e){return{$$typeof:fn,_ctor:e,_status:-1,_result:null}},memo:function(e,t){return{$$typeof:pn,type:e,compare:void 0===t?null:t}},useCallback:function(e,t){return Nn().useCallback(e,t)},useContext:function(e,t){return Nn().useContext(e,t)},useEffect:function(e,t){return Nn().useEffect(e,t)},useImperativeHandle:function(e,t,n){return Nn().useImperativeHandle(e,t,n)},useDebugValue:function(){},useLayoutEffect:function(e,t){return Nn().useLayoutEffect(e,t)},useMemo:function(e,t){return Nn().useMemo(e,t)},useReducer:function(e,t,n){return Nn().useReducer(e,t,n)},useRef:function(e){return Nn().useRef(e)},useState:function(e){return Nn().useState(e)},Fragment:rn,StrictMode:on,Suspense:dn,createElement:In,cloneElement:function(e,t,n){null==e&&mn("267",e);var r=void 0,i=Zt({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){void 0!==t.ref&&(a=t.ref,s=wn.current),void 0!==t.key&&(o=""+t.key);var l=void 0;for(r in e.type&&e.type.defaultProps&&(l=e.type.defaultProps),t)Cn.call(t,r)&&!Mn.hasOwnProperty(r)&&(i[r]=void 0===t[r]&&void 0!==l?l[r]:t[r])}if(1===(r=arguments.length-2))i.children=n;else if(1<r){l=Array(r);for(var u=0;u<r;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:tn,type:e.type,key:o,ref:a,props:i,_owner:s}},createFactory:function(e){var t=In.bind(null,e);return t.type=e,t},isValidElement:En,version:"16.8.6",unstable_ConcurrentMode:un,unstable_Profiler:an,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentDispatcher:Pn,ReactCurrentOwner:wn,assign:Zt}},Bn=Un.default||Un,Vn=(t(function(e){}),t(function(e){e.exports=Bn})),jn=t(function(e,i){Object.defineProperty(i,"__esModule",{value:!0});var a=null,r=!1,s=3,o=-1,l=-1,u=!1,c=!1;function d(){if(!u){var e=a.expirationTime;c?w():c=!0,P(t,e)}}function p(){var e=a,t=a.next;if(a===t)a=null;else{var n=a.previous;a=n.next=t,t.previous=n}e.next=e.previous=null,n=e.callback,t=e.expirationTime,e=e.priorityLevel;var r=s,i=l;s=e,l=t;try{var o=n()}finally{s=r,l=i}if("function"==typeof o)if(o={callback:o,priorityLevel:e,expirationTime:t,next:null,previous:null},null===a)a=o.next=o.previous=o;else{n=null,e=a;do{if(e.expirationTime>=t){n=e;break}e=e.next}while(e!==a);null===n?n=a:n===a&&(a=o,d()),(t=n.previous).next=n.previous=o,o.next=n,o.previous=t}}function f(){if(-1===o&&null!==a&&1===a.priorityLevel){u=!0;try{for(;p(),null!==a&&1===a.priorityLevel;);}finally{u=!1,null!==a?d():c=!1}}}function t(e){u=!0;var t=r;r=e;try{if(e)for(;null!==a;){var n=i.unstable_now();if(!(a.expirationTime<=n))break;for(;p(),null!==a&&a.expirationTime<=n;);}else if(null!==a)for(;p(),null!==a&&!C(););}finally{u=!1,r=t,null!==a?d():c=!1,f()}}var n,h,m=Date,y="function"==typeof setTimeout?setTimeout:void 0,g="function"==typeof clearTimeout?clearTimeout:void 0,v="function"==typeof requestAnimationFrame?requestAnimationFrame:void 0,S="function"==typeof cancelAnimationFrame?cancelAnimationFrame:void 0;function b(t){n=v(function(e){g(h),t(e)}),h=y(function(){S(n),t(i.unstable_now())},100)}if("object"==typeof performance&&"function"==typeof performance.now){var T=performance;i.unstable_now=function(){return T.now()}}else i.unstable_now=function(){return m.now()};var P,w,C,M=null;if("undefined"!=typeof window?M=window:void 0!==V&&(M=V),M&&M._schedMock){var I=M._schedMock;P=I[0],w=I[1],C=I[2],i.unstable_now=I[3]}else if("undefined"==typeof window||"function"!=typeof MessageChannel){var E=null,_=function(e){if(null!==E)try{E(e)}finally{E=null}};P=function(e){null!==E?setTimeout(P,0,e):(E=e,setTimeout(_,0,!1))},w=function(){E=null},C=function(){return!1}}else{"undefined"!=typeof console&&("function"!=typeof v&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!=typeof S&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"));var x=null,k=!1,R=-1,A=!1,O=!1,L=0,F=33,D=33;C=function(){return L<=i.unstable_now()};var N=new MessageChannel,U=N.port2;N.port1.onmessage=function(){k=!1;var e=x,t=R;x=null,R=-1;var n=i.unstable_now(),r=!1;if(L-n<=0){if(!(-1!==t&&t<=n))return A||(A=!0,b(B)),x=e,void(R=t);r=!0}if(null!==e){O=!0;try{e(r)}finally{O=!1}}};var B=function(e){if(null!==x){b(B);var t=e-L+D;t<D&&F<D?(t<8&&(t=8),D=t<F?F:t):F=t,L=e+D,k||(k=!0,U.postMessage(void 0))}else A=!1};P=function(e,t){x=e,R=t,O||t<0?U.postMessage(void 0):A||(A=!0,b(B))},w=function(){x=null,k=!1,R=-1}}i.unstable_ImmediatePriority=1,i.unstable_UserBlockingPriority=2,i.unstable_NormalPriority=3,i.unstable_IdlePriority=5,i.unstable_LowPriority=4,i.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=s,r=o;s=e,o=i.unstable_now();try{return t()}finally{s=n,o=r,f()}},i.unstable_next=function(e){switch(s){case 1:case 2:case 3:var t=3;break;default:t=s}var n=s,r=o;s=t,o=i.unstable_now();try{return e()}finally{s=n,o=r,f()}},i.unstable_scheduleCallback=function(e,t){var n=-1!==o?o:i.unstable_now();if("object"==typeof t&&null!==t&&"number"==typeof t.timeout)t=n+t.timeout;else switch(s){case 1:t=n+-1;break;case 2:t=n+250;break;case 5:t=n+1073741823;break;case 4:t=n+1e4;break;default:t=n+5e3}if(e={callback:e,priorityLevel:s,expirationTime:t,next:null,previous:null},null===a)a=e.next=e.previous=e,d();else{n=null;var r=a;do{if(r.expirationTime>t){n=r;break}r=r.next}while(r!==a);null===n?n=a:n===a&&(a=e,d()),(t=n.previous).next=n.previous=e,e.next=n,e.previous=t}return e},i.unstable_cancelCallback=function(e){var t=e.next;if(null!==t){if(t===e)a=null;else{e===a&&(a=t);var n=e.previous;(n.next=t).previous=n}e.next=e.previous=null}},i.unstable_wrapCallback=function(n){var r=s;return function(){var e=s,t=o;s=r,o=i.unstable_now();try{return n.apply(this,arguments)}finally{s=e,o=t,f()}}},i.unstable_getCurrentPriorityLevel=function(){return s},i.unstable_shouldYield=function(){return!r&&(null!==a&&a.expirationTime<l||C())},i.unstable_continueExecution=function(){null!==a&&d()},i.unstable_pauseExecution=function(){},i.unstable_getFirstCallbackNode=function(){return a}});e(jn);jn.unstable_now,jn.unstable_ImmediatePriority,jn.unstable_UserBlockingPriority,jn.unstable_NormalPriority,jn.unstable_IdlePriority,jn.unstable_LowPriority,jn.unstable_runWithPriority,jn.unstable_next,jn.unstable_scheduleCallback,jn.unstable_cancelCallback,jn.unstable_wrapCallback,jn.unstable_getCurrentPriorityLevel,jn.unstable_shouldYield,jn.unstable_continueExecution,jn.unstable_pauseExecution,jn.unstable_getFirstCallbackNode;var Xn=t(function(e,t){});e(Xn);Xn.unstable_now,Xn.unstable_ImmediatePriority,Xn.unstable_UserBlockingPriority,Xn.unstable_NormalPriority,Xn.unstable_IdlePriority,Xn.unstable_LowPriority,Xn.unstable_runWithPriority,Xn.unstable_next,Xn.unstable_scheduleCallback,Xn.unstable_cancelCallback,Xn.unstable_wrapCallback,Xn.unstable_getCurrentPriorityLevel,Xn.unstable_shouldYield,Xn.unstable_continueExecution,Xn.unstable_pauseExecution,Xn.unstable_getFirstCallbackNode;var zn=t(function(e){e.exports=jn});function qn(e){for(var t=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=0;r<t;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);!function(e,t,n,r,i,o,a,s){if(!e){if((e=void 0)===t)e=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,i,o,a,s],u=0;(e=Error(t.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw e.framesToPop=1,e}}(!1,"Minified React error #"+e+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}Vn||qn("227");var Wn=!1,Hn=null,Gn=!1,Kn=null,Qn={onError:function(e){Wn=!0,Hn=e}};function Yn(e,t,n,r,i,o,a,s,l){Wn=!1,Hn=null,function(e,t,n,r,i,o,a,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(e){this.onError(e)}}.apply(Qn,arguments)}var Jn=null,$n={};function Zn(){if(Jn)for(var e in $n){var t=$n[e],n=Jn.indexOf(e);if(-1<n||qn("96",e),!tr[n])for(var r in t.extractEvents||qn("97",e),n=(tr[n]=t).eventTypes){var i=void 0,o=n[r],a=t,s=r;nr.hasOwnProperty(s)&&qn("99",s);var l=(nr[s]=o).phasedRegistrationNames;if(l){for(i in l)l.hasOwnProperty(i)&&er(l[i],a,s);i=!0}else o.registrationName?(er(o.registrationName,a,s),i=!0):i=!1;i||qn("98",r,e)}}}function er(e,t,n){rr[e]&&qn("100",e),rr[e]=t,ir[e]=t.eventTypes[n].dependencies}var tr=[],nr={},rr={},ir={},or=null,ar=null,sr=null;function lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=sr(n),function(e,t,n,r,i,o,a,s,l){if(Yn.apply(this,arguments),Wn){if(Wn){var u=Hn;Wn=!1,Hn=null}else qn("198"),u=void 0;Gn||(Gn=!0,Kn=u)}}(r,t,void 0,e),e.currentTarget=null}function ur(e,t){return null==t&&qn("30"),null==e?t:Array.isArray(e)?(Array.isArray(t)?e.push.apply(e,t):e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function cr(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var dr=null;function pr(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)lr(e,t[r],n[r]);else t&&lr(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}var fr={injectEventPluginOrder:function(e){Jn&&qn("101"),Jn=Array.prototype.slice.call(e),Zn()},injectEventPluginsByName:function(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];$n.hasOwnProperty(t)&&$n[t]===r||($n[t]&&qn("102",t),$n[t]=r,n=!0)}n&&Zn()}};function hr(e,t){var n=e.stateNode;if(!n)return null;var r=or(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}return e?null:(n&&"function"!=typeof n&&qn("231",t,typeof n),n)}function mr(e){if(null!==e&&(dr=ur(dr,e)),e=dr,dr=null,e&&(cr(e,pr),dr&&qn("95"),Gn))throw e=Kn,Gn=!1,Kn=null,e}var yr=Math.random().toString(36).slice(2),gr="__reactInternalInstance$"+yr,vr="__reactEventHandlers$"+yr;function Sr(e){if(e[gr])return e[gr];for(;!e[gr];){if(!e.parentNode)return null;e=e.parentNode}return 5===(e=e[gr]).tag||6===e.tag?e:null}function br(e){return!(e=e[gr])||5!==e.tag&&6!==e.tag?null:e}function Tr(e){if(5===e.tag||6===e.tag)return e.stateNode;qn("33")}function Pr(e){return e[vr]||null}function wr(e){for(;(e=e.return)&&5!==e.tag;);return e||null}function Cr(e,t,n){(t=hr(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=ur(n._dispatchListeners,t),n._dispatchInstances=ur(n._dispatchInstances,e))}function Mr(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=wr(t);for(t=n.length;0<t--;)Cr(n[t],"captured",e);for(t=0;t<n.length;t++)Cr(n[t],"bubbled",e)}}function Ir(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=hr(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=ur(n._dispatchListeners,t),n._dispatchInstances=ur(n._dispatchInstances,e))}function Er(e){e&&e.dispatchConfig.registrationName&&Ir(e._targetInst,null,e)}function _r(e){cr(e,Mr)}var xr=!("undefined"==typeof window||!window.document||!window.document.createElement);function kr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Rr={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},Ar={},Or={};function Lr(e){if(Ar[e])return Ar[e];if(!Rr[e])return e;var t,n=Rr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Or)return Ar[e]=n[t];return e}xr&&(Or=document.createElement("div").style,"AnimationEvent"in window||(delete Rr.animationend.animation,delete Rr.animationiteration.animation,delete Rr.animationstart.animation),"TransitionEvent"in window||delete Rr.transitionend.transition);var Fr=Lr("animationend"),Dr=Lr("animationiteration"),Nr=Lr("animationstart"),Ur=Lr("transitionend"),Br="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vr=null,jr=null,Xr=null;function zr(){if(Xr)return Xr;var e,t,n=jr,r=n.length,i="value"in Vr?Vr.value:Vr.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Xr=i.slice(e,1<t?1-t:void 0)}function qr(){return!0}function Wr(){return!1}function Hr(e,t,n,r){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?qr:Wr,this.isPropagationStopped=Wr,this}function Gr(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function Kr(e){e instanceof this||qn("279"),e.destructor(),this.eventPool.length<10&&this.eventPool.push(e)}function Qr(e){e.eventPool=[],e.getPooled=Gr,e.release=Kr}Zt(Hr.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=qr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=qr)},persist:function(){this.isPersistent=qr},isPersistent:Wr,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Wr,this._dispatchInstances=this._dispatchListeners=null}}),Hr.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},Hr.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var i=new t;return Zt(i,n.prototype),((n.prototype=i).constructor=n).Interface=Zt({},r.Interface,e),n.extend=r.extend,Qr(n),n},Qr(Hr);var Yr=Hr.extend({data:null}),Jr=Hr.extend({data:null}),$r=[9,13,27,32],Zr=xr&&"CompositionEvent"in window,ei=null;xr&&"documentMode"in document&&(ei=document.documentMode);var ti=xr&&"TextEvent"in window&&!ei,ni=xr&&(!Zr||ei&&8<ei&&ei<=11),ri=String.fromCharCode(32),ii={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},oi=!1;function ai(e,t){switch(e){case"keyup":return-1!==$r.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function si(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var li=!1;var ui={eventTypes:ii,extractEvents:function(e,t,n,r){var i=void 0,o=void 0;if(Zr)e:{switch(e){case"compositionstart":i=ii.compositionStart;break e;case"compositionend":i=ii.compositionEnd;break e;case"compositionupdate":i=ii.compositionUpdate;break e}i=void 0}else li?ai(e,n)&&(i=ii.compositionEnd):"keydown"===e&&229===n.keyCode&&(i=ii.compositionStart);return i?(ni&&"ko"!==n.locale&&(li||i!==ii.compositionStart?i===ii.compositionEnd&&li&&(o=zr()):(jr="value"in(Vr=r)?Vr.value:Vr.textContent,li=!0)),i=Yr.getPooled(i,t,n,r),o?i.data=o:null!==(o=si(n))&&(i.data=o),_r(i),o=i):o=null,(e=ti?function(e,t){switch(e){case"compositionend":return si(t);case"keypress":return 32!==t.which?null:(oi=!0,ri);case"textInput":return(e=t.data)===ri&&oi?null:e;default:return null}}(e,n):function(e,t){if(li)return"compositionend"===e||!Zr&&ai(e,t)?(e=zr(),Xr=jr=Vr=null,li=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return ni&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))?((t=Jr.getPooled(ii.beforeInput,t,n,r)).data=e,_r(t)):t=null,null===o?t:null===t?o:[o,t]}},ci=null,di=null,pi=null;function fi(e){if(e=ar(e)){"function"!=typeof ci&&qn("280");var t=or(e.stateNode);ci(e.stateNode,e.type,t)}}function hi(e){di?pi?pi.push(e):pi=[e]:di=e}function mi(){if(di){var e=di,t=pi;if(pi=di=null,fi(e),t)for(e=0;e<t.length;e++)fi(t[e])}}function yi(e,t){return e(t)}function gi(e,t,n){return e(t,n)}function vi(){}var Si=!1;function bi(e,t){if(Si)return e(t);Si=!0;try{return yi(e,t)}finally{Si=!1,(null!==di||null!==pi)&&(vi(),mi())}}var Ti={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ti[e.type]:"textarea"===t}function wi(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function Ci(e){if(!xr)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"==typeof t[e]),t}function Mi(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Ii(e){e._valueTracker||(e._valueTracker=function(e){var t=Mi(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Ei(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Mi(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}var _i=Vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;_i.hasOwnProperty("ReactCurrentDispatcher")||(_i.ReactCurrentDispatcher={current:null});var xi=/^(.*)[\\\/]/,ki="function"==typeof Symbol&&Symbol.for,Ri=ki?Symbol.for("react.element"):60103,Ai=ki?Symbol.for("react.portal"):60106,Oi=ki?Symbol.for("react.fragment"):60107,Li=ki?Symbol.for("react.strict_mode"):60108,Fi=ki?Symbol.for("react.profiler"):60114,Di=ki?Symbol.for("react.provider"):60109,Ni=ki?Symbol.for("react.context"):60110,Ui=ki?Symbol.for("react.concurrent_mode"):60111,Bi=ki?Symbol.for("react.forward_ref"):60112,Vi=ki?Symbol.for("react.suspense"):60113,ji=ki?Symbol.for("react.memo"):60115,Xi=ki?Symbol.for("react.lazy"):60116,zi="function"==typeof Symbol&&Symbol.iterator;function qi(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=zi&&e[zi]||e["@@iterator"])?e:null}function Wi(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case Ui:return"ConcurrentMode";case Oi:return"Fragment";case Ai:return"Portal";case Fi:return"Profiler";case Li:return"StrictMode";case Vi:return"Suspense"}if("object"==typeof e)switch(e.$$typeof){case Ni:return"Context.Consumer";case Di:return"Context.Provider";case Bi:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case ji:return Wi(e.type);case Xi:if(e=1===e._status?e._result:null)return Wi(e)}return null}function Hi(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,i=e._debugSource,o=Wi(e.type);n=null,r&&(n=Wi(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(xi,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}t+=n,e=e.return}while(e);return t}var Gi=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ki=Object.prototype.hasOwnProperty,Qi={},Yi={};function Ji(e,t,n,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t}var $i={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){$i[e]=new Ji(e,0,!1,e,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];$i[t]=new Ji(t,1,!1,e[1],null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){$i[e]=new Ji(e,2,!1,e.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){$i[e]=new Ji(e,2,!1,e,null)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){$i[e]=new Ji(e,3,!1,e.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(e){$i[e]=new Ji(e,3,!0,e,null)}),["capture","download"].forEach(function(e){$i[e]=new Ji(e,4,!1,e,null)}),["cols","rows","size","span"].forEach(function(e){$i[e]=new Ji(e,6,!1,e,null)}),["rowSpan","start"].forEach(function(e){$i[e]=new Ji(e,5,!1,e.toLowerCase(),null)});var Zi=/[\-:]([a-z])/g;function eo(e){return e[1].toUpperCase()}function to(e,t,n,r){var i,o=$i.hasOwnProperty(t)?$i[t]:null;(null!==o?0===o.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null==t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||t<1}return!1}(t,n,o,r)&&(n=null),r||null===o?(i=t,(Ki.call(Yi,i)||!Ki.call(Qi,i)&&(Gi.test(i)?Yi[i]=!0:!(Qi[i]=!0)))&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n))):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}function no(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function ro(e,t){var n=t.checked;return Zt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function io(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=no(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function oo(e,t){null!=(t=t.checked)&&to(e,"checked",t,!1)}function ao(e,t){oo(e,t);var n=no(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?lo(e,t.type,n):t.hasOwnProperty("defaultValue")&&lo(e,t.type,no(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function so(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function lo(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Zi,eo);$i[t]=new Ji(t,1,!1,e,null)}),"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Zi,eo);$i[t]=new Ji(t,1,!1,e,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Zi,eo);$i[t]=new Ji(t,1,!1,e,"http://www.w3.org/XML/1998/namespace")}),["tabIndex","crossOrigin"].forEach(function(e){$i[e]=new Ji(e,1,!1,e.toLowerCase(),null)});var uo={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function co(e,t,n){return(e=Hr.getPooled(uo.change,e,t,n)).type="change",hi(n),_r(e),e}var po=null,fo=null;function ho(e){mr(e)}function mo(e){if(Ei(Tr(e)))return e}function yo(e,t){if("change"===e)return t}var go=!1;function vo(){po&&(po.detachEvent("onpropertychange",So),fo=po=null)}function So(e){"value"===e.propertyName&&mo(fo)&&bi(ho,e=co(fo,e,wi(e)))}function bo(e,t,n){"focus"===e?(vo(),fo=n,(po=t).attachEvent("onpropertychange",So)):"blur"===e&&vo()}function To(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return mo(fo)}function Po(e,t){if("click"===e)return mo(t)}function wo(e,t){if("input"===e||"change"===e)return mo(t)}xr&&(go=Ci("input")&&(!document.documentMode||9<document.documentMode));var Co={eventTypes:uo,_isInputEventSupported:go,extractEvents:function(e,t,n,r){var i=t?Tr(t):window,o=void 0,a=void 0,s=i.nodeName&&i.nodeName.toLowerCase();if("select"===s||"input"===s&&"file"===i.type?o=yo:Pi(i)?go?o=wo:(o=To,a=bo):(s=i.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=Po),o&&(o=o(e,t)))return co(o,n,r);a&&a(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&lo(i,"number",i.value)}},Mo=Hr.extend({view:null,detail:null}),Io={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Eo(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Io[e])&&!!t[e]}function _o(){return Eo}var xo=0,ko=0,Ro=!1,Ao=!1,Oo=Mo.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:_o,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=xo;return xo=e.screenX,Ro?"mousemove"===e.type?e.screenX-t:0:(Ro=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=ko;return ko=e.screenY,Ao?"mousemove"===e.type?e.screenY-t:0:(Ao=!0,0)}}),Lo=Oo.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Fo={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Do={eventTypes:Fo,extractEvents:function(e,t,n,r){var i="mouseover"===e||"pointerover"===e,o="mouseout"===e||"pointerout"===e;if(i&&(n.relatedTarget||n.fromElement)||!o&&!i)return null;if(i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=t,t=(t=n.relatedTarget||n.toElement)?Sr(t):null):o=null,o===t)return null;var a=void 0,s=void 0,l=void 0,u=void 0;"mouseout"===e||"mouseover"===e?(a=Oo,s=Fo.mouseLeave,l=Fo.mouseEnter,u="mouse"):"pointerout"!==e&&"pointerover"!==e||(a=Lo,s=Fo.pointerLeave,l=Fo.pointerEnter,u="pointer");var c=null==o?i:Tr(o);if(i=null==t?i:Tr(t),(e=a.getPooled(s,o,n,r)).type=u+"leave",e.target=c,e.relatedTarget=i,(n=a.getPooled(l,t,n,r)).type=u+"enter",n.target=i,n.relatedTarget=c,r=t,o&&r)e:{for(i=r,u=0,a=t=o;a;a=wr(a))u++;for(a=0,l=i;l;l=wr(l))a++;for(;0<u-a;)t=wr(t),u--;for(;0<a-u;)i=wr(i),a--;for(;u--;){if(t===i||t===i.alternate)break e;t=wr(t),i=wr(i)}t=null}else t=null;for(i=t,t=[];o&&o!==i&&(null===(u=o.alternate)||u!==i);)t.push(o),o=wr(o);for(o=[];r&&r!==i&&(null===(u=r.alternate)||u!==i);)o.push(r),r=wr(r);for(r=0;r<t.length;r++)Ir(t[r],"bubbled",e);for(r=o.length;0<r--;)Ir(o[r],"captured",n);return[e,n]}};function No(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t}var Uo=Object.prototype.hasOwnProperty;function Bo(e,t){if(No(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Uo.call(t,n[r])||!No(e[n[r]],t[n[r]]))return!1;return!0}function Vo(e){var t=e;if(e.alternate)for(;t.return;)t=t.return;else{if(0!=(2&t.effectTag))return 1;for(;t.return;)if(0!=(2&(t=t.return).effectTag))return 1}return 3===t.tag?2:3}function jo(e){2!==Vo(e)&&qn("188")}function Xo(e){if(!(e=function(e){var t=e.alternate;if(!t)return 3===(t=Vo(e))&&qn("188"),1===t?null:e;for(var n=e,r=t;;){var i=n.return,o=i?i.alternate:null;if(!i||!o)break;if(i.child===o.child){for(var a=i.child;a;){if(a===n)return jo(i),e;if(a===r)return jo(i),t;a=a.sibling}qn("188")}if(n.return!==r.return)n=i,r=o;else{a=!1;for(var s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}a||qn("189")}}n.alternate!==r&&qn("190")}return 3!==n.tag&&qn("188"),n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t=(t.child.return=t).child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}var zo=Hr.extend({animationName:null,elapsedTime:null,pseudoElement:null}),qo=Hr.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Wo=Mo.extend({relatedTarget:null});function Ho(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var Go={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ko={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qo=Mo.extend({key:function(e){if(e.key){var t=Go[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Ho(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Ko[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:_o,charCode:function(e){return"keypress"===e.type?Ho(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Ho(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Yo=Oo.extend({dataTransfer:null}),Jo=Mo.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:_o}),$o=Hr.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),Zo=Oo.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),ea=[["abort","abort"],[Fr,"animationEnd"],[Dr,"animationIteration"],[Nr,"animationStart"],["canplay","canPlay"],["canplaythrough","canPlayThrough"],["drag","drag"],["dragenter","dragEnter"],["dragexit","dragExit"],["dragleave","dragLeave"],["dragover","dragOver"],["durationchange","durationChange"],["emptied","emptied"],["encrypted","encrypted"],["ended","ended"],["error","error"],["gotpointercapture","gotPointerCapture"],["load","load"],["loadeddata","loadedData"],["loadedmetadata","loadedMetadata"],["loadstart","loadStart"],["lostpointercapture","lostPointerCapture"],["mousemove","mouseMove"],["mouseout","mouseOut"],["mouseover","mouseOver"],["playing","playing"],["pointermove","pointerMove"],["pointerout","pointerOut"],["pointerover","pointerOver"],["progress","progress"],["scroll","scroll"],["seeking","seeking"],["stalled","stalled"],["suspend","suspend"],["timeupdate","timeUpdate"],["toggle","toggle"],["touchmove","touchMove"],[Ur,"transitionEnd"],["waiting","waiting"],["wheel","wheel"]],ta={},na={};function ra(e,t){var n=e[0],r="on"+((e=e[1])[0].toUpperCase()+e.slice(1));t={phasedRegistrationNames:{bubbled:r,captured:r+"Capture"},dependencies:[n],isInteractive:t},ta[e]=t,na[n]=t}[["blur","blur"],["cancel","cancel"],["click","click"],["close","close"],["contextmenu","contextMenu"],["copy","copy"],["cut","cut"],["auxclick","auxClick"],["dblclick","doubleClick"],["dragend","dragEnd"],["dragstart","dragStart"],["drop","drop"],["focus","focus"],["input","input"],["invalid","invalid"],["keydown","keyDown"],["keypress","keyPress"],["keyup","keyUp"],["mousedown","mouseDown"],["mouseup","mouseUp"],["paste","paste"],["pause","pause"],["play","play"],["pointercancel","pointerCancel"],["pointerdown","pointerDown"],["pointerup","pointerUp"],["ratechange","rateChange"],["reset","reset"],["seeked","seeked"],["submit","submit"],["touchcancel","touchCancel"],["touchend","touchEnd"],["touchstart","touchStart"],["volumechange","volumeChange"]].forEach(function(e){ra(e,!0)}),ea.forEach(function(e){ra(e,!1)});var ia={eventTypes:ta,isInteractiveTopLevelEventType:function(e){return void 0!==(e=na[e])&&!0===e.isInteractive},extractEvents:function(e,t,n,r){var i=na[e];if(!i)return null;switch(e){case"keypress":if(0===Ho(n))return null;case"keydown":case"keyup":e=Qo;break;case"blur":case"focus":e=Wo;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=Oo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=Yo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=Jo;break;case Fr:case Dr:case Nr:e=zo;break;case Ur:e=$o;break;case"scroll":e=Mo;break;case"wheel":e=Zo;break;case"copy":case"cut":case"paste":e=qo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Lo;break;default:e=Hr}return _r(t=e.getPooled(i,t,n,r)),t}},oa=ia.isInteractiveTopLevelEventType,aa=[];function sa(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r;for(r=n;r.return;)r=r.return;if(!(r=3!==r.tag?null:r.stateNode.containerInfo))break;e.ancestors.push(n),n=Sr(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=wi(e.nativeEvent);r=e.topLevelType;for(var o=e.nativeEvent,a=null,s=0;s<tr.length;s++){var l=tr[s];l&&(l=l.extractEvents(r,t,o,i))&&(a=ur(a,l))}mr(a)}}var la=!0;function ua(e,t){if(!t)return null;var n=(oa(e)?da:pa).bind(null,e);t.addEventListener(e,n,!1)}function ca(e,t){if(!t)return null;var n=(oa(e)?da:pa).bind(null,e);t.addEventListener(e,n,!0)}function da(e,t){gi(pa,e,t)}function pa(e,t){if(la){var n=wi(t);if(null===(n=Sr(n))||"number"!=typeof n.tag||2===Vo(n)||(n=null),aa.length){var r=aa.pop();r.topLevelType=e,r.nativeEvent=t,r.targetInst=n,e=r}else e={topLevelType:e,nativeEvent:t,targetInst:n,ancestors:[]};try{bi(sa,e)}finally{e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,aa.length<10&&aa.push(e)}}}var fa={},ha=0,ma="_reactListenersID"+(""+Math.random()).slice(2);function ya(e){return Object.prototype.hasOwnProperty.call(e,ma)||(e[ma]=ha++,fa[e[ma]]={}),fa[e[ma]]}function ga(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function va(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Sa(e,t){var n,r=va(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&t<=n)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=va(r)}}function ba(){for(var e=window,t=ga();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(e){n=!1}if(!n)break;t=ga((e=t.contentWindow).document)}return t}function Ta(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function Pa(e){var t=ba(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&function e(t,n){return!(!t||!n)&&(t===n||(!t||3!==t.nodeType)&&(n&&3===n.nodeType?e(t,n.parentNode):"contains"in t?t.contains(n):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(n))))}(n.ownerDocument.documentElement,n)){if(null!==r&&Ta(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=void 0===r.end?o:Math.min(r.end,i),!e.extend&&r<o&&(i=r,r=o,o=i),i=Sa(n,o);var a=Sa(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),r<o?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var wa=xr&&"documentMode"in document&&document.documentMode<=11,Ca={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Ma=null,Ia=null,Ea=null,_a=!1;function xa(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return _a||null==Ma||Ma!==ga(n)?null:("selectionStart"in(n=Ma)&&Ta(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Ea&&Bo(Ea,n)?null:(Ea=n,(e=Hr.getPooled(Ca.select,Ia,e,t)).type="select",e.target=Ma,_r(e),e))}var ka={eventTypes:Ca,extractEvents:function(e,t,n,r){var i,o=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;if(!(i=!o)){e:{o=ya(o),i=ir.onSelect;for(var a=0;a<i.length;a++){var s=i[a];if(!o.hasOwnProperty(s)||!o[s]){o=!1;break e}}o=!0}i=!o}if(i)return null;switch(o=t?Tr(t):window,e){case"focus":(Pi(o)||"true"===o.contentEditable)&&(Ma=o,Ia=t,Ea=null);break;case"blur":Ea=Ia=Ma=null;break;case"mousedown":_a=!0;break;case"contextmenu":case"mouseup":case"dragend":return _a=!1,xa(n,r);case"selectionchange":if(wa)break;case"keydown":case"keyup":return xa(n,r)}return null}};function Ra(e,t){var n,r;return e=Zt({children:void 0},t),n=t.children,r="",Vn.Children.forEach(n,function(e){null!=e&&(r+=e)}),(t=r)&&(e.children=t),e}function Aa(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+no(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function Oa(e,t){return null!=t.dangerouslySetInnerHTML&&qn("91"),Zt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function La(e,t){var n=t.value;null==n&&(n=t.defaultValue,null!=(t=t.children)&&(null!=n&&qn("92"),Array.isArray(t)&&(t.length<=1||qn("93"),t=t[0]),n=t),null==n&&(n="")),e._wrapperState={initialValue:no(n)}}function Fa(e,t){var n=no(t.value),r=no(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function Da(e){var t=e.textContent;t===e._wrapperState.initialValue&&(e.value=t)}fr.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),or=Pr,ar=br,sr=Tr,fr.injectEventPluginsByName({SimpleEventPlugin:ia,EnterLeaveEventPlugin:Do,ChangeEventPlugin:Co,SelectEventPlugin:ka,BeforeInputEventPlugin:ui});var Na={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function Ua(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ba(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Ua(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var Va,ja=void 0,Xa=(Va=function(e,t){if(e.namespaceURI!==Na.svg||"innerHTML"in e)e.innerHTML=t;else{for((ja=ja||document.createElement("div")).innerHTML="<svg>"+t+"</svg>",t=ja.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return Va(e,t)})}:Va);function za(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var qa={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Wa=["Webkit","ms","Moz","O"];function Ha(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||qa.hasOwnProperty(e)&&qa[e]?(""+t).trim():t+"px"}function Ga(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=Ha(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(qa).forEach(function(t){Wa.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),qa[e]=qa[t]})});var Ka=Zt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qa(e,t){t&&(Ka[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML)&&qn("137",e,""),null!=t.dangerouslySetInnerHTML&&(null!=t.children&&qn("60"),"object"==typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML||qn("61")),null!=t.style&&"object"!=typeof t.style&&qn("62",""))}function Ya(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ja(e,t){var n=ya(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=ir[t];for(var r=0;r<t.length;r++){var i=t[r];if(!n.hasOwnProperty(i)||!n[i]){switch(i){case"scroll":ca("scroll",e);break;case"focus":case"blur":ca("focus",e),ca("blur",e),n.blur=!0,n.focus=!0;break;case"cancel":case"close":Ci(i)&&ca(i,e);break;case"invalid":case"submit":case"reset":break;default:-1===Br.indexOf(i)&&ua(i,e)}n[i]=!0}}}function $a(){}var Za=null,es=null;function ts(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function ns(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rs="function"==typeof setTimeout?setTimeout:void 0,is="function"==typeof clearTimeout?clearTimeout:void 0,os=zn.unstable_scheduleCallback,as=zn.unstable_cancelCallback;function ss(e){for(e=e.nextSibling;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e}function ls(e){for(e=e.firstChild;e&&1!==e.nodeType&&3!==e.nodeType;)e=e.nextSibling;return e}var us=[],cs=-1;function ds(e){cs<0||(e.current=us[cs],us[cs]=null,cs--)}function ps(e,t){us[++cs]=e.current,e.current=t}var fs={},hs={current:fs},ms={current:!1},ys=fs;function gs(e,t){var n=e.type.contextTypes;if(!n)return fs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function vs(e){return null!=(e=e.childContextTypes)}function Ss(e){ds(ms),ds(hs)}function bs(e){ds(ms),ds(hs)}function Ts(e,t,n){hs.current!==fs&&qn("168"),ps(hs,t),ps(ms,n)}function Ps(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!=typeof r.getChildContext)return n;for(var i in r=r.getChildContext())i in e||qn("108",Wi(t)||"Unknown",i);return Zt({},n,r)}function ws(e){var t=e.stateNode;return t=t&&t.__reactInternalMemoizedMergedChildContext||fs,ys=hs.current,ps(hs,t),ps(ms,ms.current),!0}function Cs(e,t,n){var r=e.stateNode;r||qn("169"),n?(t=Ps(e,t,ys),r.__reactInternalMemoizedMergedChildContext=t,ds(ms),ds(hs),ps(hs,t)):ds(ms),ps(ms,n)}var Ms=null,Is=null;function Es(t){return function(e){try{return t(e)}catch(e){}}}function _s(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.contextDependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function xs(e,t,n,r){return new _s(e,t,n,r)}function ks(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rs(e,t){var n=e.alternate;return null===n?((n=xs(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,(n.alternate=e).alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,n.contextDependencies=e.contextDependencies,n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function As(e,t,n,r,i,o){var a=2;if("function"==typeof(r=e))ks(e)&&(a=1);else if("string"==typeof e)a=5;else e:switch(e){case Oi:return Os(n.children,i,o,t);case Ui:return Ls(n,3|i,o,t);case Li:return Ls(n,2|i,o,t);case Fi:return(e=xs(12,n,t,4|i)).elementType=Fi,e.type=Fi,e.expirationTime=o,e;case Vi:return(e=xs(13,n,t,i)).elementType=Vi,e.type=Vi,e.expirationTime=o,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case Di:a=10;break e;case Ni:a=9;break e;case Bi:a=11;break e;case ji:a=14;break e;case Xi:a=16,r=null;break e}qn("130",null==e?e:typeof e,"")}return(t=xs(a,n,t,i)).elementType=e,t.type=r,t.expirationTime=o,t}function Os(e,t,n,r){return(e=xs(7,e,r,t)).expirationTime=n,e}function Ls(e,t,n,r){return e=xs(8,e,r,t),t=0==(1&t)?Li:Ui,e.elementType=t,e.type=t,e.expirationTime=n,e}function Fs(e,t,n){return(e=xs(6,e,null,t)).expirationTime=n,e}function Ds(e,t,n){return(t=xs(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ns(e,t){e.didError=!1;var n=e.earliestPendingTime;0===n?e.earliestPendingTime=e.latestPendingTime=t:n<t?e.earliestPendingTime=t:e.latestPendingTime>t&&(e.latestPendingTime=t),Vs(t,e)}function Us(e,t){e.didError=!1,e.latestPingedTime>=t&&(e.latestPingedTime=0);var n=e.earliestPendingTime,r=e.latestPendingTime;n===t?e.earliestPendingTime=r===t?e.latestPendingTime=0:r:r===t&&(e.latestPendingTime=n),n=e.earliestSuspendedTime,r=e.latestSuspendedTime,0===n?e.earliestSuspendedTime=e.latestSuspendedTime=t:n<t?e.earliestSuspendedTime=t:t<r&&(e.latestSuspendedTime=t),Vs(t,e)}function Bs(e,t){var n=e.earliestPendingTime;return t<n&&(t=n),t<(e=e.earliestSuspendedTime)&&(t=e),t}function Vs(e,t){var n=t.earliestSuspendedTime,r=t.latestSuspendedTime,i=t.earliestPendingTime,o=t.latestPingedTime;0===(i=0!==i?i:o)&&(0===e||r<e)&&(i=r),0!==(e=i)&&e<n&&(e=n),t.nextExpirationTimeToWorkOn=i,t.expirationTime=e}function js(e,t){if(e&&e.defaultProps)for(var n in t=Zt({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}var Xs=(new Vn.Component).refs;function zs(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:Zt({},t,n),e.memoizedState=n,null!==(r=e.updateQueue)&&0===e.expirationTime&&(r.baseState=n)}var qs={isMounted:function(e){return!!(e=e._reactInternalFiber)&&2===Vo(e)},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=od(),i=Ou(r=Ac(r,e));i.payload=t,null!=n&&(i.callback=n),Ic(),Fu(e,i),Fc(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=od(),i=Ou(r=Ac(r,e));i.tag=Eu,i.payload=t,null!=n&&(i.callback=n),Ic(),Fu(e,i),Fc(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=od(),r=Ou(n=Ac(n,e));r.tag=_u,null!=t&&(r.callback=t),Ic(),Fu(e,r),Fc(e,n)}};function Ws(e,t,n,r,i,o,a){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!Bo(n,r)||!Bo(i,o))}function Hs(e,t,n){var r=!1,i=fs,o=t.contextType;return"object"==typeof o&&null!==o?o=Mu(o):(i=vs(t)?ys:hs.current,o=(r=null!=(r=t.contextTypes))?gs(e,i):fs),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=qs,(e.stateNode=t)._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Gs(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&qs.enqueueReplaceState(t,t.state,null)}function Ks(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Xs;var o=t.contextType;"object"==typeof o&&null!==o?i.context=Mu(o):(o=vs(t)?ys:hs.current,i.context=gs(e,o)),null!==(o=e.updateQueue)&&(Bu(e,o,n,i,r),i.state=e.memoizedState),"function"==typeof(o=t.getDerivedStateFromProps)&&(zs(e,t,o,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&qs.enqueueReplaceState(i,i.state,null),null!==(o=e.updateQueue)&&(Bu(e,o,n,i,r),i.state=e.memoizedState)),"function"==typeof i.componentDidMount&&(e.effectTag|=4)}var Qs=Array.isArray;function Ys(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){n=n._owner;var r=void 0;n&&(1!==n.tag&&qn("309"),r=n.stateNode),r||qn("147",e);var i=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===Xs&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}"string"!=typeof e&&qn("284"),n._owner||qn("290",e)}return e}function Js(e,t){"textarea"!==e.type&&qn("31","[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,"")}function $s(d){function p(e,t){if(d){var n=e.lastEffect;null!==n?(n.nextEffect=t,e.lastEffect=t):e.firstEffect=e.lastEffect=t,t.nextEffect=null,t.effectTag=8}}function f(e,t){if(!d)return null;for(;null!==t;)p(e,t),t=t.sibling;return null}function h(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t,n){return(e=Rs(e,t)).index=0,e.sibling=null,e}function m(e,t,n){return e.index=n,d?null!==(n=e.alternate)?(n=n.index)<t?(e.effectTag=2,t):n:(e.effectTag=2,t):t}function s(e){return d&&null===e.alternate&&(e.effectTag=2),e}function o(e,t,n,r){return null===t||6!==t.tag?(t=Fs(n,e.mode,r)).return=e:(t=a(t,n)).return=e,t}function l(e,t,n,r){return null!==t&&t.elementType===n.type?(r=a(t,n.props)).ref=Ys(e,t,n):(r=As(n.type,n.key,n.props,null,e.mode,r)).ref=Ys(e,t,n),r.return=e,r}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?(t=Ds(n,e.mode,r)).return=e:(t=a(t,n.children||[])).return=e,t}function c(e,t,n,r,i){return null===t||7!==t.tag?(t=Os(n,e.mode,r,i)).return=e:(t=a(t,n)).return=e,t}function y(e,t,n){if("string"==typeof t||"number"==typeof t)return(t=Fs(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Ri:return(n=As(t.type,t.key,t.props,null,e.mode,n)).ref=Ys(e,null,t),n.return=e,n;case Ai:return(t=Ds(t,e.mode,n)).return=e,t}if(Qs(t)||qi(t))return(t=Os(t,e.mode,n,null)).return=e,t;Js(e,t)}return null}function g(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n||"number"==typeof n)return null!==i?null:o(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Ri:return n.key===i?n.type===Oi?c(e,t,n.props.children,r,i):l(e,t,n,r):null;case Ai:return n.key===i?u(e,t,n,r):null}if(Qs(n)||qi(n))return null!==i?null:c(e,t,n,r,null);Js(e,n)}return null}function v(e,t,n,r,i){if("string"==typeof r||"number"==typeof r)return o(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case Ri:return e=e.get(null===r.key?n:r.key)||null,r.type===Oi?c(t,e,r.props.children,i,r.key):l(t,e,r,i);case Ai:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(Qs(r)||qi(r))return c(t,e=e.get(n)||null,r,i,null);Js(t,r)}return null}return function(e,t,n,r){var i="object"==typeof n&&null!==n&&n.type===Oi&&null===n.key;i&&(n=n.props.children);var o="object"==typeof n&&null!==n;if(o)switch(n.$$typeof){case Ri:e:{for(o=n.key,i=t;null!==i;){if(i.key===o){if(7===i.tag?n.type===Oi:i.elementType===n.type){f(e,i.sibling),(t=a(i,n.type===Oi?n.props.children:n.props)).ref=Ys(e,i,n),t.return=e,e=t;break e}f(e,i);break}p(e,i),i=i.sibling}n.type===Oi?((t=Os(n.props.children,e.mode,r,n.key)).return=e,e=t):((r=As(n.type,n.key,n.props,null,e.mode,r)).ref=Ys(e,t,n),r.return=e,e=r)}return s(e);case Ai:e:{for(i=n.key;null!==t;){if(t.key===i){if(4===t.tag&&t.stateNode.containerInfo===n.containerInfo&&t.stateNode.implementation===n.implementation){f(e,t.sibling),(t=a(t,n.children||[])).return=e,e=t;break e}f(e,t);break}p(e,t),t=t.sibling}(t=Ds(n,e.mode,r)).return=e,e=t}return s(e)}if("string"==typeof n||"number"==typeof n)return n=""+n,null!==t&&6===t.tag?(f(e,t.sibling),t=a(t,n)):(f(e,t),t=Fs(n,e.mode,r)),t.return=e,s(e=t);if(Qs(n))return function(t,e,n,r){for(var i=null,o=null,a=e,s=e=0,l=null;null!==a&&s<n.length;s++){a.index>s?(l=a,a=null):l=a.sibling;var u=g(t,a,n[s],r);if(null===u){null===a&&(a=l);break}d&&a&&null===u.alternate&&p(t,a),e=m(u,e,s),null===o?i=u:o.sibling=u,o=u,a=l}if(s===n.length)return f(t,a),i;if(null===a){for(;s<n.length;s++)(a=y(t,n[s],r))&&(e=m(a,e,s),null===o?i=a:o.sibling=a,o=a);return i}for(a=h(t,a);s<n.length;s++)(l=v(a,t,s,n[s],r))&&(d&&null!==l.alternate&&a.delete(null===l.key?s:l.key),e=m(l,e,s),null===o?i=l:o.sibling=l,o=l);return d&&a.forEach(function(e){return p(t,e)}),i}(e,t,n,r);if(qi(n))return function(t,e,n,r){var i=qi(n);"function"!=typeof i&&qn("150"),null==(n=i.call(n))&&qn("151");for(var o=i=null,a=e,s=e=0,l=null,u=n.next();null!==a&&!u.done;s++,u=n.next()){a.index>s?(l=a,a=null):l=a.sibling;var c=g(t,a,u.value,r);if(null===c){a||(a=l);break}d&&a&&null===c.alternate&&p(t,a),e=m(c,e,s),null===o?i=c:o.sibling=c,o=c,a=l}if(u.done)return f(t,a),i;if(null===a){for(;!u.done;s++,u=n.next())null!==(u=y(t,u.value,r))&&(e=m(u,e,s),null===o?i=u:o.sibling=u,o=u);return i}for(a=h(t,a);!u.done;s++,u=n.next())null!==(u=v(a,t,s,u.value,r))&&(d&&null!==u.alternate&&a.delete(null===u.key?s:u.key),e=m(u,e,s),null===o?i=u:o.sibling=u,o=u);return d&&a.forEach(function(e){return p(t,e)}),i}(e,t,n,r);if(o&&Js(e,n),void 0===n&&!i)switch(e.tag){case 1:case 0:qn("152",(r=e.type).displayName||r.name||"Component")}return f(e,t)}}var Zs=$s(!0),el=$s(!1),tl={},nl={current:tl},rl={current:tl},il={current:tl};function ol(e){return e===tl&&qn("174"),e}function al(e,t){ps(il,t),ps(rl,e),ps(nl,tl);var n=t.nodeType;switch(n){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ba(null,"");break;default:t=Ba(t=(n=8===n?t.parentNode:t).namespaceURI||null,n=n.tagName)}ds(nl),ps(nl,t)}function sl(e){ds(nl),ds(rl),ds(il)}function ll(e){ol(il.current);var t=ol(nl.current),n=Ba(t,e.type);t!==n&&(ps(rl,e),ps(nl,n))}function ul(e){rl.current===e&&(ds(nl),ds(rl))}var cl=0,dl=2,pl=4,fl=8,hl=16,ml=32,yl=64,gl=128,vl=_i.ReactCurrentDispatcher,Sl=0,bl=null,Tl=null,Pl=null,wl=null,Cl=null,Ml=null,Il=0,El=null,_l=0,xl=!1,kl=null,Rl=0;function Al(){qn("321")}function Ol(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!No(e[n],t[n]))return!1;return!0}function Ll(e,t,n,r,i,o){if(Sl=o,bl=t,Pl=null!==e?e.memoizedState:null,vl.current=null===Pl?Gl:Kl,t=n(r,i),xl){for(;xl=!1,Rl+=1,Pl=null!==e?e.memoizedState:null,Ml=wl,El=Cl=Tl=null,vl.current=Kl,t=n(r,i),xl;);kl=null,Rl=0}return vl.current=Hl,(e=bl).memoizedState=wl,e.expirationTime=Il,e.updateQueue=El,e.effectTag|=_l,e=null!==Tl&&null!==Tl.next,Ml=Cl=wl=Pl=Tl=bl=null,El=null,_l=Il=Sl=0,e&&qn("300"),t}function Fl(){vl.current=Hl,Ml=Cl=wl=Pl=Tl=bl=null,xl=!1,kl=El=null,Rl=_l=Il=Sl=0}function Dl(){var e={memoizedState:null,baseState:null,queue:null,baseUpdate:null,next:null};return null===Cl?wl=Cl=e:Cl=Cl.next=e,Cl}function Nl(){if(null!==Ml)Ml=(Cl=Ml).next,Pl=null!==(Tl=Pl)?Tl.next:null;else{null===Pl&&qn("310");var e={memoizedState:(Tl=Pl).memoizedState,baseState:Tl.baseState,queue:Tl.queue,baseUpdate:Tl.baseUpdate,next:null};Cl=null===Cl?wl=e:Cl.next=e,Pl=Tl.next}return Cl}function Ul(e,t){return"function"==typeof t?t(e):t}function Bl(e){var t=Nl(),n=t.queue;if(null===n&&qn("311"),n.lastRenderedReducer=e,0<Rl){var r=n.dispatch;if(null!==kl){var i=kl.get(n);if(void 0!==i){kl.delete(n);for(var o=t.memoizedState;o=e(o,i.action),null!==(i=i.next););return No(o,t.memoizedState)||(ou=!0),t.memoizedState=o,t.baseUpdate===n.last&&(t.baseState=o),[n.lastRenderedState=o,r]}}return[t.memoizedState,r]}r=n.last;var a=t.baseUpdate;if(o=t.baseState,null!==a?(null!==r&&(r.next=null),r=a.next):r=null!==r?r.next:null,null!==r){var s=i=null,l=r,u=!1;do{var c=l.expirationTime;c<Sl?(u||(u=!0,s=a,i=o),Il<c&&(Il=c)):o=l.eagerReducer===e?l.eagerState:e(o,l.action),l=(a=l).next}while(null!==l&&l!==r);u||(s=a,i=o),No(o,t.memoizedState)||(ou=!0),t.memoizedState=o,t.baseUpdate=s,t.baseState=i,n.lastRenderedState=o}return[t.memoizedState,n.dispatch]}function Vl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===El?(El={lastEffect:null}).lastEffect=e.next=e:null===(t=El.lastEffect)?El.lastEffect=e.next=e:(n=t.next,(t.next=e).next=n,El.lastEffect=e),e}function jl(e,t,n,r){var i=Dl();_l|=e,i.memoizedState=Vl(t,n,void 0,void 0===r?null:r)}function Xl(e,t,n,r){var i=Nl();r=void 0===r?null:r;var o=void 0;if(null!==Tl){var a=Tl.memoizedState;if(o=a.destroy,null!==r&&Ol(r,a.deps))return void Vl(cl,n,o,r)}_l|=e,i.memoizedState=Vl(t,n,o,r)}function zl(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ql(){}function Wl(e,t,n){Rl<25||qn("301");var r=e.alternate;if(e===bl||null!==r&&r===bl)if(xl=!0,e={expirationTime:Sl,action:n,eagerReducer:null,eagerState:null,next:null},null===kl&&(kl=new Map),void 0===(n=kl.get(t)))kl.set(t,e);else{for(t=n;null!==t.next;)t=t.next;t.next=e}else{Ic();var i=od(),o={expirationTime:i=Ac(i,e),action:n,eagerReducer:null,eagerState:null,next:null},a=t.last;if(null===a)o.next=o;else{var s=a.next;null!==s&&(o.next=s),a.next=o}if(t.last=o,0===e.expirationTime&&(null===r||0===r.expirationTime)&&null!==(r=t.lastRenderedReducer))try{var l=t.lastRenderedState,u=r(l,n);if(o.eagerReducer=r,No(o.eagerState=u,l))return}catch(e){}Fc(e,i)}}var Hl={readContext:Mu,useCallback:Al,useContext:Al,useEffect:Al,useImperativeHandle:Al,useLayoutEffect:Al,useMemo:Al,useReducer:Al,useRef:Al,useState:Al,useDebugValue:Al},Gl={readContext:Mu,useCallback:function(e,t){return Dl().memoizedState=[e,void 0===t?null:t],e},useContext:Mu,useEffect:function(e,t){return jl(516,gl|yl,e,t)},useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,jl(4,pl|ml,zl.bind(null,t,e),n)},useLayoutEffect:function(e,t){return jl(4,pl|ml,e,t)},useMemo:function(e,t){var n=Dl();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Dl();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={last:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Wl.bind(null,bl,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Dl().memoizedState=e},useState:function(e){var t=Dl();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={last:null,dispatch:null,lastRenderedReducer:Ul,lastRenderedState:e}).dispatch=Wl.bind(null,bl,e),[t.memoizedState,e]},useDebugValue:ql},Kl={readContext:Mu,useCallback:function(e,t){var n=Nl();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ol(t,r[1])?r[0]:(n.memoizedState=[e,t],e)},useContext:Mu,useEffect:function(e,t){return Xl(516,gl|yl,e,t)},useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Xl(4,pl|ml,zl.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Xl(4,pl|ml,e,t)},useMemo:function(e,t){var n=Nl();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Ol(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)},useReducer:Bl,useRef:function(){return Nl().memoizedState},useState:function(e){return Bl(Ul)},useDebugValue:ql},Ql=null,Yl=null,Jl=!1;function $l(e,t){var n=xs(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Zl(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function eu(e){if(Jl){var t=Yl;if(t){var n=t;if(!Zl(e,t)){if(!(t=ss(n))||!Zl(e,t))return e.effectTag|=2,Jl=!1,void(Ql=e);$l(Ql,n)}Ql=e,Yl=ls(t)}else e.effectTag|=2,Jl=!1,Ql=e}}function tu(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&18!==e.tag;)e=e.return;Ql=e}function nu(e){if(e!==Ql)return!1;if(!Jl)return tu(e),!(Jl=!0);var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!ns(t,e.memoizedProps))for(t=Yl;t;)$l(e,t),t=ss(t);return tu(e),Yl=Ql?ss(e.stateNode):null,!0}function ru(){Yl=Ql=null,Jl=!1}var iu=_i.ReactCurrentOwner,ou=!1;function au(e,t,n,r){t.child=null===e?el(t,null,n,r):Zs(t,e.child,n,r)}function su(e,t,n,r,i){n=n.render;var o=t.ref;return Cu(t,i),r=Ll(e,t,n,r,o,i),null===e||ou?(t.effectTag|=1,au(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),yu(e,t,i))}function lu(e,t,n,r,i,o){if(null===e){var a=n.type;return"function"!=typeof a||ks(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=As(n.type,null,r,null,t.mode,o)).ref=t.ref,(e.return=t).child=e):(t.tag=15,t.type=a,uu(e,t,a,r,i,o))}return a=e.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:Bo)(i,r)&&e.ref===t.ref)?yu(e,t,o):(t.effectTag|=1,(e=Rs(a,r)).ref=t.ref,(e.return=t).child=e)}function uu(e,t,n,r,i,o){return null!==e&&Bo(e.memoizedProps,r)&&e.ref===t.ref&&(ou=!1,i<o)?yu(e,t,o):du(e,t,n,r,o)}function cu(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function du(e,t,n,r,i){var o=vs(n)?ys:hs.current;return o=gs(t,o),Cu(t,i),n=Ll(e,t,n,r,o,i),null===e||ou?(t.effectTag|=1,au(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),yu(e,t,i))}function pu(e,t,n,r,i){if(vs(n)){var o=!0;ws(t)}else o=!1;if(Cu(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),Hs(t,n,r),Ks(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,u=n.contextType;"object"==typeof u&&null!==u?u=Mu(u):u=gs(t,u=vs(n)?ys:hs.current);var c=n.getDerivedStateFromProps,d="function"==typeof c||"function"==typeof a.getSnapshotBeforeUpdate;d||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==u)&&Gs(t,a,r,u),ku=!1;var p=t.memoizedState;l=a.state=p;var f=t.updateQueue;null!==f&&(Bu(t,f,r,a,i),l=t.memoizedState),s!==r||p!==l||ms.current||ku?("function"==typeof c&&(zs(t,n,c,r),l=t.memoizedState),(s=ku||Ws(t,n,s,r,p,l,u))?(d||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||("function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"==typeof a.componentDidMount&&(t.effectTag|=4)):("function"==typeof a.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=s):("function"==typeof a.componentDidMount&&(t.effectTag|=4),r=!1)}else a=t.stateNode,s=t.memoizedProps,a.props=t.type===t.elementType?s:js(t.type,s),l=a.context,"object"==typeof(u=n.contextType)&&null!==u?u=Mu(u):u=gs(t,u=vs(n)?ys:hs.current),(d="function"==typeof(c=n.getDerivedStateFromProps)||"function"==typeof a.getSnapshotBeforeUpdate)||"function"!=typeof a.UNSAFE_componentWillReceiveProps&&"function"!=typeof a.componentWillReceiveProps||(s!==r||l!==u)&&Gs(t,a,r,u),ku=!1,l=t.memoizedState,p=a.state=l,null!==(f=t.updateQueue)&&(Bu(t,f,r,a,i),p=t.memoizedState),s!==r||l!==p||ms.current||ku?("function"==typeof c&&(zs(t,n,c,r),p=t.memoizedState),(c=ku||Ws(t,n,s,r,l,p,u))?(d||"function"!=typeof a.UNSAFE_componentWillUpdate&&"function"!=typeof a.componentWillUpdate||("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,u),"function"==typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,u)),"function"==typeof a.componentDidUpdate&&(t.effectTag|=4),"function"==typeof a.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=u,r=c):("function"!=typeof a.componentDidUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=4),"function"!=typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&l===e.memoizedState||(t.effectTag|=256),r=!1);return fu(e,t,n,r,o,i)}function fu(e,t,n,r,i,o){cu(e,t);var a=0!=(64&t.effectTag);if(!r&&!a)return i&&Cs(t,n,!1),yu(e,t,o);r=t.stateNode,iu.current=t;var s=a&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&a?(t.child=Zs(t,e.child,null,o),t.child=Zs(t,null,s,o)):au(e,t,s,o),t.memoizedState=r.state,i&&Cs(t,n,!0),t.child}function hu(e){var t=e.stateNode;t.pendingContext?Ts(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ts(0,t.context,!1),al(e,t.containerInfo)}function mu(e,t,n){var r=t.mode,i=t.pendingProps,o=t.memoizedState;if(0==(64&t.effectTag)){o=null;var a=!1}else o={timedOutAt:null!==o?o.timedOutAt:0},a=!0,t.effectTag&=-65;if(null===e)if(a){var s=i.fallback;e=Os(null,r,0,null),0==(1&t.mode)&&(e.child=null!==t.memoizedState?t.child.child:t.child),r=Os(s,r,n,null),e.sibling=r,(n=e).return=r.return=t}else n=r=el(t,null,i.children,n);else null!==e.memoizedState?(s=(r=e.child).sibling,a?(n=i.fallback,i=Rs(r,r.pendingProps),0==(1&t.mode)&&((a=null!==t.memoizedState?t.child.child:t.child)!==r.child&&(i.child=a)),r=i.sibling=Rs(s,n,s.expirationTime),(n=i).childExpirationTime=0,n.return=r.return=t):n=r=Zs(t,r.child,i.children,n)):(s=e.child,a?(a=i.fallback,(i=Os(null,r,0,null)).child=s,0==(1&t.mode)&&(i.child=null!==t.memoizedState?t.child.child:t.child),(r=i.sibling=Os(a,r,n,null)).effectTag|=2,(n=i).childExpirationTime=0,n.return=r.return=t):r=n=Zs(t,s,i.children,n)),t.stateNode=e.stateNode;return t.memoizedState=o,t.child=n,r}function yu(e,t,n){if(null!==e&&(t.contextDependencies=e.contextDependencies),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child&&qn("153"),null!==t.child){for(n=Rs(e=t.child,e.pendingProps,e.expirationTime),(t.child=n).return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rs(e,e.pendingProps,e.expirationTime)).return=t;n.sibling=null}return t.child}function gu(e,t,n){var r=t.expirationTime;if(null!==e){if(e.memoizedProps!==t.pendingProps||ms.current)ou=!0;else if(r<n){switch(ou=!1,t.tag){case 3:hu(t),ru();break;case 5:ll(t);break;case 1:vs(t.type)&&ws(t);break;case 4:al(t,t.stateNode.containerInfo);break;case 10:Pu(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&n<=r?mu(e,t,n):null!==(t=yu(e,t,n))?t.sibling:null}return yu(e,t,n)}}else ou=!1;switch(t.expirationTime=0,t.tag){case 2:r=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps;var i=gs(t,hs.current);if(Cu(t,n),i=Ll(null,t,r,e,i,n),t.effectTag|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render&&void 0===i.$$typeof){if(t.tag=1,Fl(),vs(r)){var o=!0;ws(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null;var a=r.getDerivedStateFromProps;"function"==typeof a&&zs(t,r,a,e),i.updater=qs,Ks((t.stateNode=i)._reactInternalFiber=t,r,e,n),t=fu(null,t,r,!0,o,n)}else t.tag=0,au(null,t,i,n),t=t.child;return t;case 16:switch(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),o=t.pendingProps,e=function(t){var e=t._result;switch(t._status){case 1:return e;case 2:case 0:throw e;default:switch(t._status=0,(e=(e=t._ctor)()).then(function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)},function(e){0===t._status&&(t._status=2,t._result=e)}),t._status){case 1:return t._result;case 2:throw t._result}throw t._result=e}}(i),t.type=e,i=t.tag=function(e){if("function"==typeof e)return ks(e)?1:0;if(null!=e){if((e=e.$$typeof)===Bi)return 11;if(e===ji)return 14}return 2}(e),o=js(e,o),a=void 0,i){case 0:a=du(null,t,e,o,n);break;case 1:a=pu(null,t,e,o,n);break;case 11:a=su(null,t,e,o,n);break;case 14:a=lu(null,t,e,js(e.type,o),r,n);break;default:qn("306",e,"")}return a;case 0:return r=t.type,i=t.pendingProps,du(e,t,r,i=t.elementType===r?i:js(r,i),n);case 1:return r=t.type,i=t.pendingProps,pu(e,t,r,i=t.elementType===r?i:js(r,i),n);case 3:return hu(t),null===(r=t.updateQueue)&&qn("282"),i=null!==(i=t.memoizedState)?i.element:null,Bu(t,r,t.pendingProps,null,n),(r=t.memoizedState.element)===i?(ru(),t=yu(e,t,n)):(i=t.stateNode,(i=(null===e||null===e.child)&&i.hydrate)&&(Yl=ls(t.stateNode.containerInfo),Ql=t,i=Jl=!0),i?(t.effectTag|=2,t.child=el(t,null,r,n)):(au(e,t,r,n),ru()),t=t.child),t;case 5:return ll(t),null===e&&eu(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ns(r,i)?a=null:null!==o&&ns(r,o)&&(t.effectTag|=16),cu(e,t),1!==n&&1&t.mode&&i.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(au(e,t,a,n),t=t.child),t;case 6:return null===e&&eu(t),null;case 13:return mu(e,t,n);case 4:return al(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Zs(t,null,r,n):au(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,su(e,t,r,i=t.elementType===r?i:js(r,i),n);case 7:return au(e,t,t.pendingProps,n),t.child;case 8:case 12:return au(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,Pu(t,o=i.value),null!==a){var s=a.value;if(0===(o=No(s,o)?0:0|("function"==typeof r._calculateChangedBits?r._calculateChangedBits(s,o):1073741823))){if(a.children===i.children&&!ms.current){t=yu(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.contextDependencies;if(null!==l){a=s.child;for(var u=l.first;null!==u;){if(u.context===r&&0!=(u.observedBits&o)){1===s.tag&&((u=Ou(n)).tag=_u,Fu(s,u)),s.expirationTime<n&&(s.expirationTime=n),null!==(u=s.alternate)&&u.expirationTime<n&&(u.expirationTime=n),u=n;for(var c=s.return;null!==c;){var d=c.alternate;if(c.childExpirationTime<u)c.childExpirationTime=u,null!==d&&d.childExpirationTime<u&&(d.childExpirationTime=u);else{if(!(null!==d&&d.childExpirationTime<u))break;d.childExpirationTime=u}c=c.return}l.expirationTime<n&&(l.expirationTime=n);break}u=u.next}}else a=10===s.tag&&s.type===t.type?null:s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}}au(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,Cu(t,n),r=r(i=Mu(i,o.unstable_observedBits)),t.effectTag|=1,au(e,t,r,n),t.child;case 14:return o=js(i=t.type,t.pendingProps),lu(e,t,i,o=js(i.type,o),r,n);case 15:return uu(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:js(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,vs(r)?(e=!0,ws(t)):e=!1,Cu(t,n),Hs(t,r,i),Ks(t,r,i,n),fu(null,t,r,!0,e,n)}qn("156")}var vu={current:null},Su=null,bu=null,Tu=null;function Pu(e,t){var n=e.type._context;ps(vu,n._currentValue),n._currentValue=t}function wu(e){var t=vu.current;ds(vu),e.type._context._currentValue=t}function Cu(e,t){Tu=bu=null;var n=(Su=e).contextDependencies;null!==n&&n.expirationTime>=t&&(ou=!0),e.contextDependencies=null}function Mu(e,t){return Tu!==e&&!1!==t&&0!==t&&("number"==typeof t&&1073741823!==t||(Tu=e,t=1073741823),t={context:e,observedBits:t,next:null},null===bu?(null===Su&&qn("308"),bu=t,Su.contextDependencies={first:t,expirationTime:0}):bu=bu.next=t),e._currentValue}var Iu=0,Eu=1,_u=2,xu=3,ku=!1;function Ru(e){return{baseState:e,firstUpdate:null,lastUpdate:null,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Au(e){return{baseState:e.baseState,firstUpdate:e.firstUpdate,lastUpdate:e.lastUpdate,firstCapturedUpdate:null,lastCapturedUpdate:null,firstEffect:null,lastEffect:null,firstCapturedEffect:null,lastCapturedEffect:null}}function Ou(e){return{expirationTime:e,tag:Iu,payload:null,callback:null,next:null,nextEffect:null}}function Lu(e,t){null===e.lastUpdate?e.firstUpdate=e.lastUpdate=t:(e.lastUpdate.next=t,e.lastUpdate=t)}function Fu(e,t){var n=e.alternate;if(null===n){var r=e.updateQueue,i=null;null===r&&(r=e.updateQueue=Ru(e.memoizedState))}else r=e.updateQueue,i=n.updateQueue,null===r?null===i?(r=e.updateQueue=Ru(e.memoizedState),i=n.updateQueue=Ru(n.memoizedState)):r=e.updateQueue=Au(i):null===i&&(i=n.updateQueue=Au(r));null===i||r===i?Lu(r,t):null===r.lastUpdate||null===i.lastUpdate?(Lu(r,t),Lu(i,t)):(Lu(r,t),i.lastUpdate=t)}function Du(e,t){var n=e.updateQueue;null===(n=null===n?e.updateQueue=Ru(e.memoizedState):Nu(e,n)).lastCapturedUpdate?n.firstCapturedUpdate=n.lastCapturedUpdate=t:(n.lastCapturedUpdate.next=t,n.lastCapturedUpdate=t)}function Nu(e,t){var n=e.alternate;return null!==n&&t===n.updateQueue&&(t=e.updateQueue=Au(t)),t}function Uu(e,t,n,r,i,o){switch(n.tag){case Eu:return"function"==typeof(e=n.payload)?e.call(o,r,i):e;case xu:e.effectTag=-2049&e.effectTag|64;case Iu:if(null==(i="function"==typeof(e=n.payload)?e.call(o,r,i):e))break;return Zt({},r,i);case _u:ku=!0}return r}function Bu(e,t,n,r,i){ku=!1;for(var o=(t=Nu(e,t)).baseState,a=null,s=0,l=t.firstUpdate,u=o;null!==l;){var c=l.expirationTime;c<i?(null===a&&(a=l,o=u),s<c&&(s=c)):(u=Uu(e,0,l,u,n,r),null!==l.callback&&(e.effectTag|=32,(l.nextEffect=null)===t.lastEffect?t.firstEffect=t.lastEffect=l:(t.lastEffect.nextEffect=l,t.lastEffect=l))),l=l.next}for(c=null,l=t.firstCapturedUpdate;null!==l;){var d=l.expirationTime;d<i?(null===c&&(c=l,null===a&&(o=u)),s<d&&(s=d)):(u=Uu(e,0,l,u,n,r),null!==l.callback&&(e.effectTag|=32,(l.nextEffect=null)===t.lastCapturedEffect?t.firstCapturedEffect=t.lastCapturedEffect=l:(t.lastCapturedEffect.nextEffect=l,t.lastCapturedEffect=l))),l=l.next}null===a&&(t.lastUpdate=null),null===c?t.lastCapturedUpdate=null:e.effectTag|=32,null===a&&null===c&&(o=u),t.baseState=o,t.firstUpdate=a,t.firstCapturedUpdate=c,e.expirationTime=s,e.memoizedState=u}function Vu(e,t,n){null!==t.firstCapturedUpdate&&(null!==t.lastUpdate&&(t.lastUpdate.next=t.firstCapturedUpdate,t.lastUpdate=t.lastCapturedUpdate),t.firstCapturedUpdate=t.lastCapturedUpdate=null),ju(t.firstEffect,n),t.firstEffect=t.lastEffect=null,ju(t.firstCapturedEffect,n),t.firstCapturedEffect=t.lastCapturedEffect=null}function ju(e,t){for(;null!==e;){var n=e.callback;if(null!==n){e.callback=null;var r=t;"function"!=typeof n&&qn("191",n),n.call(r)}e=e.nextEffect}}function Xu(e,t){return{value:e,source:t,stack:Hi(t)}}function zu(e){e.effectTag|=4}var qu=void 0,Wu=void 0,Hu=void 0,Gu=void 0;qu=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n=(n.child.return=n).child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Wu=function(){},Hu=function(e,t,n,r,i){var o=e.memoizedProps;if(o!==r){var a=t.stateNode;switch(ol(nl.current),e=null,n){case"input":o=ro(a,o),r=ro(a,r),e=[];break;case"option":o=Ra(a,o),r=Ra(a,r),e=[];break;case"select":o=Zt({},o,{value:void 0}),r=Zt({},r,{value:void 0}),e=[];break;case"textarea":o=Oa(a,o),r=Oa(a,r),e=[];break;default:"function"!=typeof o.onClick&&"function"==typeof r.onClick&&(a.onclick=$a)}Qa(n,r),a=n=void 0;var s=null;for(n in o)if(!r.hasOwnProperty(n)&&o.hasOwnProperty(n)&&null!=o[n])if("style"===n){var l=o[n];for(a in l)l.hasOwnProperty(a)&&(s||(s={}),s[a]="")}else"dangerouslySetInnerHTML"!==n&&"children"!==n&&"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&"autoFocus"!==n&&(rr.hasOwnProperty(n)?e||(e=[]):(e=e||[]).push(n,null));for(n in r){var u=r[n];if(l=null!=o?o[n]:void 0,r.hasOwnProperty(n)&&u!==l&&(null!=u||null!=l))if("style"===n)if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(s||(s={}),s[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(s||(s={}),s[a]=u[a])}else s||(e||(e=[]),e.push(n,s)),s=u;else"dangerouslySetInnerHTML"===n?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(e=e||[]).push(n,""+u)):"children"===n?l===u||"string"!=typeof u&&"number"!=typeof u||(e=e||[]).push(n,""+u):"suppressContentEditableWarning"!==n&&"suppressHydrationWarning"!==n&&(rr.hasOwnProperty(n)?(null!=u&&Ja(i,n),e||l===u||(e=[])):(e=e||[]).push(n,u))}s&&(e=e||[]).push("style",s),i=e,(t.updateQueue=i)&&zu(t)}},Gu=function(e,t,n,r){n!==r&&zu(t)};var Ku="function"==typeof WeakSet?WeakSet:Set;function Qu(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=Hi(n)),null!==n&&Wi(n.type),t=t.value,null!==e&&1===e.tag&&Wi(e.type);try{console.error(t)}catch(e){setTimeout(function(){throw e})}}function Yu(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){Rc(t,e)}else e.current=null}function Ju(e,t,n){if(null!==(n=null!==(n=n.updateQueue)?n.lastEffect:null)){var r=n=n.next;do{if((r.tag&e)!==cl){var i=r.destroy;(r.destroy=void 0)!==i&&i()}(r.tag&t)!==cl&&(i=r.create,r.destroy=i()),r=r.next}while(r!==n)}}function $u(t){switch("function"==typeof Is&&Is(t),t.tag){case 0:case 11:case 14:case 15:var e=t.updateQueue;if(null!==e&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n.destroy;if(void 0!==r){var i=t;try{r()}catch(e){Rc(i,e)}}n=n.next}while(n!==e)}break;case 1:if(Yu(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){Rc(t,e)}break;case 5:Yu(t);break;case 4:tc(t)}}function Zu(e){return 5===e.tag||3===e.tag||4===e.tag}function ec(e){e:{for(var t=e.return;null!==t;){if(Zu(t)){var n=t;break e}t=t.return}qn("160"),n=void 0}var r=t=void 0;switch(n.tag){case 5:t=n.stateNode,r=!1;break;case 3:case 4:t=n.stateNode.containerInfo,r=!0;break;default:qn("161")}16&n.effectTag&&(za(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Zu(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n=(n.child.return=n).child}if(!(2&n.effectTag)){n=n.stateNode;break e}}for(var i=e;;){if(5===i.tag||6===i.tag)if(n)if(r){var o=t,a=i.stateNode,s=n;8===o.nodeType?o.parentNode.insertBefore(a,s):o.insertBefore(a,s)}else t.insertBefore(i.stateNode,n);else r?(a=t,s=i.stateNode,8===a.nodeType?(o=a.parentNode).insertBefore(s,a):(o=a).appendChild(s),null!=(a=a._reactRootContainer)||null!==o.onclick||(o.onclick=$a)):t.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i=(i.child.return=i).child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function tc(e){for(var t=e,n=!1,r=void 0,i=void 0;;){if(!n){n=t.return;e:for(;;){switch(null===n&&qn("160"),n.tag){case 5:r=n.stateNode,i=!1;break e;case 3:case 4:r=n.stateNode.containerInfo,i=!0;break e}n=n.return}n=!0}if(5===t.tag||6===t.tag){e:for(var o=t,a=o;;)if($u(a),null!==a.child&&4!==a.tag)a.child.return=a,a=a.child;else{if(a===o)break;for(;null===a.sibling;){if(null===a.return||a.return===o)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}i?(o=r,a=t.stateNode,8===o.nodeType?o.parentNode.removeChild(a):o.removeChild(a)):r.removeChild(t.stateNode)}else if(4===t.tag){if(null!==t.child){r=t.stateNode.containerInfo,i=!0,t=(t.child.return=t).child;continue}}else if($u(t),null!==t.child){t=(t.child.return=t).child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return;4===(t=t.return).tag&&(n=!1)}t.sibling.return=t.return,t=t.sibling}}function nc(e,n){switch(n.tag){case 0:case 11:case 14:case 15:Ju(pl,fl,n);break;case 1:break;case 5:var t=n.stateNode;if(null!=t){var r=n.memoizedProps;e=null!==e?e.memoizedProps:r;var i=n.type,o=n.updateQueue;(n.updateQueue=null)!==o&&function(e,t,n,r,i){e[vr]=i,"input"===n&&"radio"===i.type&&null!=i.name&&oo(e,i),Ya(n,r),r=Ya(n,i);for(var o=0;o<t.length;o+=2){var a=t[o],s=t[o+1];"style"===a?Ga(e,s):"dangerouslySetInnerHTML"===a?Xa(e,s):"children"===a?za(e,s):to(e,a,s,r)}switch(n){case"input":ao(e,i);break;case"textarea":Fa(e,i);break;case"select":t=e._wrapperState.wasMultiple,e._wrapperState.wasMultiple=!!i.multiple,null!=(n=i.value)?Aa(e,!!i.multiple,n,!1):t!==!!i.multiple&&(null!=i.defaultValue?Aa(e,!!i.multiple,i.defaultValue,!0):Aa(e,!!i.multiple,i.multiple?[]:"",!1))}}(t,o,i,e,r)}break;case 6:null===n.stateNode&&qn("162"),n.stateNode.nodeValue=n.memoizedProps;break;case 3:case 12:break;case 13:if(t=n.memoizedState,r=void 0,e=n,null===t?r=!1:(r=!0,e=n.child,0===t.timedOutAt&&(t.timedOutAt=od())),null!==e&&function(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)r.style.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=null!=i&&i.hasOwnProperty("display")?i.display:null,r.style.display=Ha("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else{if(13===n.tag&&null!==n.memoizedState){(r=n.child.sibling).return=n,n=r;continue}if(null!==n.child){n=(n.child.return=n).child;continue}}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}(e,r),null!==(t=n.updateQueue)){n.updateQueue=null;var a=n.stateNode;null===a&&(a=n.stateNode=new Ku),t.forEach(function(e){var t=function(e,t){var n=e.stateNode;null!==n&&n.delete(t),t=Ac(t=od(),e),null!==(e=Lc(e,t))&&(Ns(e,t),0!==(t=e.expirationTime)&&ad(e,t))}.bind(null,n,e);a.has(e)||(a.add(e),e.then(t,t))})}break;case 17:break;default:qn("163")}}var rc="function"==typeof WeakMap?WeakMap:Map;function ic(e,t,n){(n=Ou(n)).tag=xu,n.payload={element:null};var r=t.value;return n.callback=function(){md(r),Qu(e,t)},n}function oc(n,r,e){(e=Ou(e)).tag=xu;var i=n.type.getDerivedStateFromError;if("function"==typeof i){var t=r.value;e.payload=function(){return i(t)}}var o=n.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(e.callback=function(){"function"!=typeof i&&(null===Tc?Tc=new Set([this]):Tc.add(this));var e=r.value,t=r.stack;Qu(n,r),this.componentDidCatch(e,{componentStack:null!==t?t:""})}),e}function ac(e){switch(e.tag){case 1:vs(e.type)&&Ss();var t=e.effectTag;return 2048&t?(e.effectTag=-2049&t|64,e):null;case 3:return sl(),bs(),0!=(64&(t=e.effectTag))&&qn("285"),e.effectTag=-2049&t|64,e;case 5:return ul(e),null;case 13:return 2048&(t=e.effectTag)?(e.effectTag=-2049&t|64,e):null;case 18:return null;case 4:return sl(),null;case 10:return wu(e),null;default:return null}}var sc=_i.ReactCurrentDispatcher,lc=_i.ReactCurrentOwner,uc=1073741822,cc=!1,dc=null,pc=null,fc=0,hc=-1,mc=!1,yc=null,gc=!1,vc=null,Sc=null,bc=null,Tc=null;function Pc(){if(null!==dc)for(var e=dc.return;null!==e;){var t=e;switch(t.tag){case 1:var n=t.type.childContextTypes;null!=n&&Ss();break;case 3:sl(),bs();break;case 5:ul(t);break;case 4:sl();break;case 10:wu(t)}e=e.return}fc=0,mc=!(hc=-1),dc=pc=null}function wc(){for(;null!==yc;){var e=yc.effectTag;if(16&e&&za(yc.stateNode,""),128&e){var t=yc.alternate;null!==t&&(null!==(t=t.ref)&&("function"==typeof t?t(null):t.current=null))}switch(14&e){case 2:ec(yc),yc.effectTag&=-3;break;case 6:ec(yc),yc.effectTag&=-3,nc(yc.alternate,yc);break;case 4:nc(yc.alternate,yc);break;case 8:tc(e=yc),e.return=null,e.child=null,e.memoizedState=null,(e.updateQueue=null)!==(e=e.alternate)&&(e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null)}yc=yc.nextEffect}}function Cc(){for(;null!==yc;){if(256&yc.effectTag)e:{var e=yc.alternate,t=yc;switch(t.tag){case 0:case 11:case 15:Ju(dl,cl,t);break e;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:js(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}break e;case 3:case 5:case 6:case 4:case 17:break e;default:qn("163")}}yc=yc.nextEffect}}function Mc(e,t){for(;null!==yc;){var n=yc.effectTag;if(36&n){var r=yc.alternate,i=yc,o=t;switch(i.tag){case 0:case 11:case 15:Ju(hl,ml,i);break;case 1:var a=i.stateNode;if(4&i.effectTag)if(null===r)a.componentDidMount();else{var s=i.elementType===i.type?r.memoizedProps:js(i.type,r.memoizedProps);a.componentDidUpdate(s,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}null!==(r=i.updateQueue)&&Vu(0,r,a);break;case 3:if(null!==(r=i.updateQueue)){if((a=null)!==i.child)switch(i.child.tag){case 5:a=i.child.stateNode;break;case 1:a=i.child.stateNode}Vu(0,r,a)}break;case 5:o=i.stateNode,null===r&&4&i.effectTag&&ts(i.type,i.memoizedProps)&&o.focus();break;case 6:case 4:case 12:case 13:case 17:break;default:qn("163")}}128&n&&(null!==(i=yc.ref)&&(o=yc.stateNode,"function"==typeof i?i(o):i.current=o)),512&n&&(vc=e),yc=yc.nextEffect}}function Ic(){null!==Sc&&as(Sc),null!==bc&&bc()}function Ec(e,t){gc=cc=!0,e.current===t&&qn("177");var n=e.pendingCommitExpirationTime;0===n&&qn("261"),e.pendingCommitExpirationTime=0;var r,i,o=t.expirationTime,a=t.childExpirationTime;for(function(e,t){if(e.didError=!1,0===t)e.earliestPendingTime=0,e.latestPendingTime=0,e.earliestSuspendedTime=0,e.latestSuspendedTime=0,e.latestPingedTime=0;else{t<e.latestPingedTime&&(e.latestPingedTime=0);var n=e.latestPendingTime;0!==n&&(t<n?e.earliestPendingTime=e.latestPendingTime=0:e.earliestPendingTime>t&&(e.earliestPendingTime=e.latestPendingTime)),0===(n=e.earliestSuspendedTime)?Ns(e,t):t<e.latestSuspendedTime?(e.earliestSuspendedTime=0,e.latestSuspendedTime=0,e.latestPingedTime=0,Ns(e,t)):n<t&&Ns(e,t)}Vs(0,e)}(e,o<a?a:o),lc.current=null,o=void 0,1<t.effectTag?null!==t.lastEffect?o=(t.lastEffect.nextEffect=t).firstEffect:o=t:o=t.firstEffect,Za=la,es=function(){var e=ba();if(Ta(e)){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(t=(t=e.ownerDocument)&&t.defaultView||window).getSelection&&t.getSelection();if(n&&0!==n.rangeCount){t=n.anchorNode;var r=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{t.nodeType,i.nodeType}catch(e){t=null;break e}var o=0,a=-1,s=-1,l=0,u=0,c=e,d=null;t:for(;;){for(var p;c!==t||0!==r&&3!==c.nodeType||(a=o+r),c!==i||0!==n&&3!==c.nodeType||(s=o+n),3===c.nodeType&&(o+=c.nodeValue.length),null!==(p=c.firstChild);)d=c,c=p;for(;;){if(c===e)break t;if(d===t&&++l===r&&(a=o),d===i&&++u===n&&(s=o),null!==(p=c.nextSibling))break;d=(c=d).parentNode}c=p}t=-1===a||-1===s?null:{start:a,end:s}}else t=null}t=t||{start:0,end:0}}else t=null;return{focusedElem:e,selectionRange:t}}(),la=!1,yc=o;null!==yc;){a=!1;var s=void 0;try{Cc()}catch(e){a=!0,s=e}a&&(null===yc&&qn("178"),Rc(yc,s),null!==yc&&(yc=yc.nextEffect))}for(yc=o;null!==yc;){a=!1,s=void 0;try{wc()}catch(e){a=!0,s=e}a&&(null===yc&&qn("178"),Rc(yc,s),null!==yc&&(yc=yc.nextEffect))}for(Pa(es),la=!!Za,Za=es=null,e.current=t,yc=o;null!==yc;){a=!1,s=void 0;try{Mc(e,n)}catch(e){a=!0,s=e}a&&(null===yc&&qn("178"),Rc(yc,s),null!==yc&&(yc=yc.nextEffect))}if(null!==o&&null!==vc){var l=function(e,t){bc=Sc=vc=null;var n=jc;jc=!0;do{if(512&t.effectTag){var r=!1,i=void 0;try{var o=t;Ju(gl,cl,o),Ju(cl,yl,o)}catch(e){r=!0,i=e}r&&Rc(t,i)}t=t.nextEffect}while(null!==t);jc=n,0!==(n=e.expirationTime)&&ad(e,n),Gc||jc||dd(1073741823,!1)}.bind(null,e,o);Sc=zn.unstable_runWithPriority(zn.unstable_NormalPriority,function(){return os(l)}),bc=l}cc=gc=!1,"function"==typeof Ms&&Ms(t.stateNode),0===(t=(n=t.expirationTime)<(t=t.childExpirationTime)?t:n)&&(Tc=null),i=t,(r=e).expirationTime=i,r.finishedWork=null}function _c(e){for(;;){var t=e.alternate,n=e.return,r=e.sibling;if(0==(1024&e.effectTag)){e:{var i=t,o=fc,a=(t=dc=e).pendingProps;switch(t.tag){case 2:case 16:break;case 15:case 0:break;case 1:vs(t.type)&&Ss();break;case 3:sl(),bs(),(a=t.stateNode).pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==i&&null!==i.child||(nu(t),t.effectTag&=-3),Wu(t);break;case 5:ul(t);var s=ol(il.current);if(o=t.type,null!==i&&null!=t.stateNode)Hu(i,t,o,a,s),i.ref!==t.ref&&(t.effectTag|=128);else if(a){var l=ol(nl.current);if(nu(t)){i=(a=t).stateNode;var u=a.type,c=a.memoizedProps,d=s;switch(i[gr]=a,i[vr]=c,o=void 0,s=u){case"iframe":case"object":ua("load",i);break;case"video":case"audio":for(u=0;u<Br.length;u++)ua(Br[u],i);break;case"source":ua("error",i);break;case"img":case"image":case"link":ua("error",i),ua("load",i);break;case"form":ua("reset",i),ua("submit",i);break;case"details":ua("toggle",i);break;case"input":io(i,c),ua("invalid",i),Ja(d,"onChange");break;case"select":i._wrapperState={wasMultiple:!!c.multiple},ua("invalid",i),Ja(d,"onChange");break;case"textarea":La(i,c),ua("invalid",i),Ja(d,"onChange")}for(o in Qa(s,c),u=null,c)c.hasOwnProperty(o)&&(l=c[o],"children"===o?"string"==typeof l?i.textContent!==l&&(u=["children",l]):"number"==typeof l&&i.textContent!==""+l&&(u=["children",""+l]):rr.hasOwnProperty(o)&&null!=l&&Ja(d,o));switch(s){case"input":Ii(i),so(i,c,!0);break;case"textarea":Ii(i),Da(i);break;case"select":case"option":break;default:"function"==typeof c.onClick&&(i.onclick=$a)}o=u,a.updateQueue=o,(a=null!==o)&&zu(t)}else{c=t,d=o,i=a,u=9===s.nodeType?s:s.ownerDocument,l===Na.html&&(l=Ua(d)),l===Na.html?"script"===d?((i=u.createElement("div")).innerHTML="<script><\/script>",u=i.removeChild(i.firstChild)):"string"==typeof i.is?u=u.createElement(d,{is:i.is}):(u=u.createElement(d),"select"===d&&(d=u,i.multiple?d.multiple=!0:i.size&&(d.size=i.size))):u=u.createElementNS(l,d),(i=u)[gr]=c,i[vr]=a,qu(i,t,!1,!1),d=i;var p=s,f=Ya(u=o,c=a);switch(u){case"iframe":case"object":ua("load",d),s=c;break;case"video":case"audio":for(s=0;s<Br.length;s++)ua(Br[s],d);s=c;break;case"source":ua("error",d),s=c;break;case"img":case"image":case"link":ua("error",d),ua("load",d),s=c;break;case"form":ua("reset",d),ua("submit",d),s=c;break;case"details":ua("toggle",d),s=c;break;case"input":io(d,c),s=ro(d,c),ua("invalid",d),Ja(p,"onChange");break;case"option":s=Ra(d,c);break;case"select":d._wrapperState={wasMultiple:!!c.multiple},s=Zt({},c,{value:void 0}),ua("invalid",d),Ja(p,"onChange");break;case"textarea":La(d,c),s=Oa(d,c),ua("invalid",d),Ja(p,"onChange");break;default:s=c}Qa(u,s),l=void 0;var h=u,m=d,y=s;for(l in y)if(y.hasOwnProperty(l)){var g=y[l];"style"===l?Ga(m,g):"dangerouslySetInnerHTML"===l?null!=(g=g?g.__html:void 0)&&Xa(m,g):"children"===l?"string"==typeof g?("textarea"!==h||""!==g)&&za(m,g):"number"==typeof g&&za(m,""+g):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(rr.hasOwnProperty(l)?null!=g&&Ja(p,l):null!=g&&to(m,l,g,f))}switch(u){case"input":Ii(d),so(d,c,!1);break;case"textarea":Ii(d),Da(d);break;case"option":null!=c.value&&d.setAttribute("value",""+no(c.value));break;case"select":(s=d).multiple=!!c.multiple,null!=(d=c.value)?Aa(s,!!c.multiple,d,!1):null!=c.defaultValue&&Aa(s,!!c.multiple,c.defaultValue,!0);break;default:"function"==typeof s.onClick&&(d.onclick=$a)}(a=ts(o,a))&&zu(t),t.stateNode=i}null!==t.ref&&(t.effectTag|=128)}else null===t.stateNode&&qn("166");break;case 6:i&&null!=t.stateNode?Gu(i,t,i.memoizedProps,a):("string"!=typeof a&&(null===t.stateNode&&qn("166")),i=ol(il.current),ol(nl.current),nu(t)?(o=(a=t).stateNode,i=a.memoizedProps,o[gr]=a,(a=o.nodeValue!==i)&&zu(t)):(o=t,(a=(9===i.nodeType?i:i.ownerDocument).createTextNode(a))[gr]=t,o.stateNode=a));break;case 11:break;case 13:if(a=t.memoizedState,0!=(64&t.effectTag)){t.expirationTime=o,dc=t;break e}a=null!==a,o=null!==i&&null!==i.memoizedState,null!==i&&!a&&o&&(null!==(i=i.child.sibling)&&(null!==(s=t.firstEffect)?(t.firstEffect=i).nextEffect=s:(t.firstEffect=t.lastEffect=i,i.nextEffect=null),i.effectTag=8)),(a||o)&&(t.effectTag|=4);break;case 7:case 8:case 12:break;case 4:sl(),Wu(t);break;case 10:wu(t);break;case 9:case 14:break;case 17:vs(t.type)&&Ss();break;case 18:break;default:qn("156")}dc=null}if(t=e,1===fc||1!==t.childExpirationTime){for(a=0,o=t.child;null!==o;)a<(i=o.expirationTime)&&(a=i),a<(s=o.childExpirationTime)&&(a=s),o=o.sibling;t.childExpirationTime=a}if(null!==dc)return dc;null!==n&&0==(1024&n.effectTag)&&(null===n.firstEffect&&(n.firstEffect=e.firstEffect),null!==e.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=e.firstEffect),n.lastEffect=e.lastEffect),1<e.effectTag&&(null!==n.lastEffect?n.lastEffect.nextEffect=e:n.firstEffect=e,n.lastEffect=e))}else{if(null!==(e=ac(e)))return e.effectTag&=1023,e;null!==n&&(n.firstEffect=n.lastEffect=null,n.effectTag|=1024)}if(null!==r)return r;if(null===n)break;e=n}return null}function xc(e){var t=gu(e.alternate,e,fc);return e.memoizedProps=e.pendingProps,null===t&&(t=_c(e)),lc.current=null,t}function kc(t,e){cc&&qn("243"),Ic(),cc=!0;var n=sc.current;sc.current=Hl;var r=t.nextExpirationTimeToWorkOn;r===fc&&t===pc&&null!==dc||(Pc(),fc=r,dc=Rs((pc=t).current,null),t.pendingCommitExpirationTime=0);for(var i=!1;;){try{if(e)for(;null!==dc&&!ud();)dc=xc(dc);else for(;null!==dc;)dc=xc(dc)}catch(e){if(Tu=bu=Su=null,Fl(),null===dc)i=!0,md(e);else{null===dc&&qn("271");var o=dc,a=o.return;if(null!==a){e:{var s=t,l=a,u=o,c=e;if(a=fc,u.effectTag|=1024,u.firstEffect=u.lastEffect=null,null!==c&&"object"==typeof c&&"function"==typeof c.then){var d=c;c=l;var p=-1,f=-1;do{if(13===c.tag){var h=c.alternate;if(null!==h&&null!==(h=h.memoizedState)){f=10*(1073741822-h.timedOutAt);break}"number"==typeof(h=c.pendingProps.maxDuration)&&(h<=0?p=0:(-1===p||h<p)&&(p=h))}c=c.return}while(null!==c);c=l;do{if((h=13===c.tag)&&(h=void 0!==c.memoizedProps.fallback&&null===c.memoizedState),h){if(null===(l=c.updateQueue)?((l=new Set).add(d),c.updateQueue=l):l.add(d),0==(1&c.mode)){c.effectTag|=64,u.effectTag&=-1957,1===u.tag&&(null===u.alternate?u.tag=17:((a=Ou(1073741823)).tag=_u,Fu(u,a))),u.expirationTime=1073741823;break e}l=a;var m=(u=s).pingCache;null===m?(m=u.pingCache=new rc,h=new Set,m.set(d,h)):void 0===(h=m.get(d))&&(h=new Set,m.set(d,h)),h.has(l)||(h.add(l),u=Oc.bind(null,u,d,l),d.then(u,u)),-1===p?s=1073741823:(-1===f&&(f=10*(1073741822-Bs(s,a))-5e3),s=f+p),0<=s&&hc<s&&(hc=s),c.effectTag|=2048,c.expirationTime=a;break e}c=c.return}while(null!==c);c=Error((Wi(u.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+Hi(u))}mc=!0,c=Xu(c,u),s=l;do{switch(s.tag){case 3:s.effectTag|=2048,s.expirationTime=a,Du(s,a=ic(s,c,a));break e;case 1:if(p=c,f=s.type,u=s.stateNode,0==(64&s.effectTag)&&("function"==typeof f.getDerivedStateFromError||null!==u&&"function"==typeof u.componentDidCatch&&(null===Tc||!Tc.has(u)))){s.effectTag|=2048,s.expirationTime=a,Du(s,a=oc(s,p,a));break e}}s=s.return}while(null!==s)}dc=_c(o);continue}i=!0,md(e)}}break}if(cc=!1,sc.current=n,Tu=bu=Su=null,Fl(),i)pc=null,t.finishedWork=null;else if(null!==dc)t.finishedWork=null;else{if(null===(n=t.current.alternate)&&qn("281"),pc=null,mc){if(i=t.latestPendingTime,o=t.latestSuspendedTime,a=t.latestPingedTime,0!==i&&i<r||0!==o&&o<r||0!==a&&a<r)return Us(t,r),void id(t,n,r,t.expirationTime,-1);if(!t.didError&&e)return t.didError=!0,void id(t,n,r=t.nextExpirationTimeToWorkOn=r,e=t.expirationTime=1073741823,-1)}e&&-1!==hc?(Us(t,r),(e=10*(1073741822-Bs(t,r)))<hc&&(hc=e),e=10*(1073741822-od()),e=hc-e,id(t,n,r,t.expirationTime,e<0?0:e)):(t.pendingCommitExpirationTime=r,t.finishedWork=n)}}function Rc(e,t){for(var n=e.return;null!==n;){switch(n.tag){case 1:var r=n.stateNode;if("function"==typeof n.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Tc||!Tc.has(r)))return Fu(n,e=oc(n,e=Xu(t,e),1073741823)),void Fc(n,1073741823);break;case 3:return Fu(n,e=ic(n,e=Xu(t,e),1073741823)),void Fc(n,1073741823)}n=n.return}3===e.tag&&(Fu(e,n=ic(e,n=Xu(t,e),1073741823)),Fc(e,1073741823))}function Ac(e,t){var n=zn.unstable_getCurrentPriorityLevel(),r=void 0;if(0==(1&t.mode))r=1073741823;else if(cc&&!gc)r=fc;else{switch(n){case zn.unstable_ImmediatePriority:r=1073741823;break;case zn.unstable_UserBlockingPriority:r=1073741822-10*(1+((1073741822-e+15)/10|0));break;case zn.unstable_NormalPriority:r=1073741822-25*(1+((1073741822-e+500)/25|0));break;case zn.unstable_LowPriority:case zn.unstable_IdlePriority:r=1;break;default:qn("313")}null!==pc&&r===fc&&--r}return n===zn.unstable_UserBlockingPriority&&(0===qc||r<qc)&&(qc=r),r}function Oc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),null!==pc&&fc===n?pc=null:(t=e.earliestSuspendedTime,r=e.latestSuspendedTime,0!==t&&n<=t&&r<=n&&(e.didError=!1,(0===(t=e.latestPingedTime)||n<t)&&(e.latestPingedTime=n),Vs(n,e),0!==(n=e.expirationTime)&&ad(e,n)))}function Lc(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return i}function Fc(e,t){null!==(e=Lc(e,t))&&(!cc&&0!==fc&&fc<t&&Pc(),Ns(e,t),cc&&!gc&&pc===e||ad(e,e.expirationTime),Zc<ed&&(ed=0,qn("185")))}function Dc(e,t,n,r,i){return zn.unstable_runWithPriority(zn.unstable_ImmediatePriority,function(){return e(t,n,r,i)})}var Nc=null,Uc=null,Bc=0,Vc=void 0,jc=!1,Xc=null,zc=0,qc=0,Wc=!1,Hc=null,Gc=!1,Kc=!1,Qc=null,Yc=zn.unstable_now(),Jc=1073741822-(Yc/10|0),$c=Jc,Zc=50,ed=0,td=null;function nd(){Jc=1073741822-((zn.unstable_now()-Yc)/10|0)}function rd(e,t){if(0!==Bc){if(t<Bc)return;null!==Vc&&zn.unstable_cancelCallback(Vc)}Bc=t,e=zn.unstable_now()-Yc,Vc=zn.unstable_scheduleCallback(cd,{timeout:10*(1073741822-t)-e})}function id(e,t,n,r,i){e.expirationTime=r,0!==i||ud()?0<i&&(e.timeoutHandle=rs(function(e,t,n){e.pendingCommitExpirationTime=n,e.finishedWork=t,nd(),$c=Jc,pd(e,n)}.bind(null,e,t,n),i)):(e.pendingCommitExpirationTime=n,e.finishedWork=t)}function od(){return jc||(sd(),0!==zc&&1!==zc||(nd(),$c=Jc)),$c}function ad(e,t){null===e.nextScheduledRoot?(e.expirationTime=t,null===Uc?(Nc=Uc=e,e.nextScheduledRoot=e):(Uc=Uc.nextScheduledRoot=e).nextScheduledRoot=Nc):t>e.expirationTime&&(e.expirationTime=t),jc||(Gc?Kc&&fd(Xc=e,zc=1073741823,!1):1073741823===t?dd(1073741823,!1):rd(e,t))}function sd(){var e=0,t=null;if(null!==Uc)for(var n=Uc,r=Nc;null!==r;){var i=r.expirationTime;if(0===i){if((null===n||null===Uc)&&qn("244"),r===r.nextScheduledRoot){Nc=Uc=r.nextScheduledRoot=null;break}if(r===Nc)Nc=i=r.nextScheduledRoot,Uc.nextScheduledRoot=i,r.nextScheduledRoot=null;else{if(r===Uc){(Uc=n).nextScheduledRoot=Nc,r.nextScheduledRoot=null;break}n.nextScheduledRoot=r.nextScheduledRoot,r.nextScheduledRoot=null}r=n.nextScheduledRoot}else{if(e<i&&(e=i,t=r),r===Uc)break;if(1073741823===e)break;r=(n=r).nextScheduledRoot}}Xc=t,zc=e}var ld=!1;function ud(){return!!ld||!!zn.unstable_shouldYield()&&(ld=!0)}function cd(){try{if(!ud()&&null!==Nc){nd();var e=Nc;do{var t=e.expirationTime;0!==t&&Jc<=t&&(e.nextExpirationTimeToWorkOn=Jc),e=e.nextScheduledRoot}while(e!==Nc)}dd(0,!0)}finally{ld=!1}}function dd(e,t){if(sd(),t)for(nd(),$c=Jc;null!==Xc&&0!==zc&&e<=zc&&!(ld&&zc<Jc);)fd(Xc,zc,zc<Jc),sd(),nd(),$c=Jc;else for(;null!==Xc&&0!==zc&&e<=zc;)fd(Xc,zc,!1),sd();if(t&&(Bc=0,Vc=null),0!==zc&&rd(Xc,zc),ed=0,(td=null)!==Qc)for(e=Qc,Qc=null,t=0;t<e.length;t++){var n=e[t];try{n._onComplete()}catch(e){Wc||(Wc=!0,Hc=e)}}if(Wc)throw e=Hc,Hc=null,Wc=!1,e}function pd(e,t){jc&&qn("253"),fd(Xc=e,zc=t,!1),dd(1073741823,!1)}function fd(e,t,n){if(jc&&qn("245"),jc=!0,n){var r=e.finishedWork;null!==r?hd(e,r,t):(e.finishedWork=null,-1!==(r=e.timeoutHandle)&&(e.timeoutHandle=-1,is(r)),kc(e,n),null!==(r=e.finishedWork)&&(ud()?e.finishedWork=r:hd(e,r,t)))}else null!==(r=e.finishedWork)?hd(e,r,t):(e.finishedWork=null,-1!==(r=e.timeoutHandle)&&(e.timeoutHandle=-1,is(r)),kc(e,n),null!==(r=e.finishedWork)&&hd(e,r,t));jc=!1}function hd(e,t,n){var r=e.firstBatch;if(null!==r&&r._expirationTime>=n&&(null===Qc?Qc=[r]:Qc.push(r),r._defer))return e.finishedWork=t,void(e.expirationTime=0);e.finishedWork=null,e===td?ed++:(td=e,ed=0),zn.unstable_runWithPriority(zn.unstable_ImmediatePriority,function(){Ec(e,t)})}function md(e){null===Xc&&qn("246"),Xc.expirationTime=0,Wc||(Wc=!0,Hc=e)}function yd(e,t){var n=Gc;Gc=!0;try{return e(t)}finally{(Gc=n)||jc||dd(1073741823,!1)}}function gd(e,t){if(Gc&&!Kc){Kc=!0;try{return e(t)}finally{Kc=!1}}return e(t)}function vd(e,t,n){Gc||jc||0===qc||(dd(qc,!1),qc=0);var r=Gc;Gc=!0;try{return zn.unstable_runWithPriority(zn.unstable_UserBlockingPriority,function(){return e(t,n)})}finally{(Gc=r)||jc||dd(1073741823,!1)}}function Sd(e,t,n,r,i){var o=t.current;e:if(n){t:{2===Vo(n=n._reactInternalFiber)&&1===n.tag||qn("170");var a=n;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(vs(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}a=a.return}while(null!==a);qn("171"),a=void 0}if(1===n.tag){var s=n.type;if(vs(s)){n=Ps(n,s,a);break e}}n=a}else n=fs;return null===t.context?t.context=n:t.pendingContext=n,t=i,(i=Ou(r)).payload={element:e},null!==(t=void 0===t?null:t)&&(i.callback=t),Ic(),Fu(o,i),Fc(o,r),r}function bd(e,t,n,r){var i=t.current;return Sd(e,t,n,i=Ac(od(),i),r)}function Td(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Pd(e){var t=1073741822-25*(1+((1073741822-od()+500)/25|0));uc<=t&&(t=uc-1),this._expirationTime=uc=t,this._root=e,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function wd(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function Cd(e,t,n){e={current:t=xs(3,null,null,t?3:0),containerInfo:e,pendingChildren:null,pingCache:null,earliestPendingTime:0,latestPendingTime:0,earliestSuspendedTime:0,latestSuspendedTime:0,latestPingedTime:0,didError:!1,pendingCommitExpirationTime:0,finishedWork:null,timeoutHandle:-1,context:null,pendingContext:null,hydrate:n,nextExpirationTimeToWorkOn:0,expirationTime:0,firstBatch:null,nextScheduledRoot:null},this._internalRoot=t.stateNode=e}function Md(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Id(e,t,n,r,i){var o=n._reactRootContainer;if(o){if("function"==typeof i){var a=i;i=function(){var e=Td(o._internalRoot);a.call(e)}}null!=e?o.legacy_renderSubtreeIntoContainer(e,t,i):o.render(t,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Cd(e,!1,t)}(n,r),"function"==typeof i){var s=i;i=function(){var e=Td(o._internalRoot);s.call(e)}}gd(function(){null!=e?o.legacy_renderSubtreeIntoContainer(e,t,i):o.render(t,i)})}return Td(o._internalRoot)}function Ed(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return Md(t)||qn("200"),function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Ai,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)}ci=function(e,t,n){switch(t){case"input":if(ao(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Pr(r);i||qn("90"),Ei(r),ao(r,i)}}}break;case"textarea":Fa(e,n);break;case"select":null!=(t=n.value)&&Aa(e,!!n.multiple,t,!1)}},Pd.prototype.render=function(e){this._defer||qn("250"),this._hasChildren=!0,this._children=e;var t=this._root._internalRoot,n=this._expirationTime,r=new wd;return Sd(e,t,null,n,r._onCommit),r},Pd.prototype.then=function(e){if(this._didComplete)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},Pd.prototype.commit=function(){var e=this._root._internalRoot,t=e.firstBatch;if(this._defer&&null!==t||qn("251"),this._hasChildren){var n=this._expirationTime;if(t!==this){this._hasChildren&&(n=this._expirationTime=t._expirationTime,this.render(this._children));for(var r=null,i=t;i!==this;)i=(r=i)._next;null===r&&qn("251"),r._next=i._next,this._next=t,e.firstBatch=this}this._defer=!1,pd(e,n),t=this._next,(this._next=null)!==(t=e.firstBatch=t)&&t._hasChildren&&t.render(t._children)}else this._next=null,this._defer=!1},Pd.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++)(0,e[t])()}},wd.prototype.then=function(e){if(this._didCommit)e();else{var t=this._callbacks;null===t&&(t=this._callbacks=[]),t.push(e)}},wd.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var e=this._callbacks;if(null!==e)for(var t=0;t<e.length;t++){var n=e[t];"function"!=typeof n&&qn("191",n),n()}}},Cd.prototype.render=function(e,t){var n=this._internalRoot,r=new wd;return null!==(t=void 0===t?null:t)&&r.then(t),bd(e,n,null,r._onCommit),r},Cd.prototype.unmount=function(e){var t=this._internalRoot,n=new wd;return null!==(e=void 0===e?null:e)&&n.then(e),bd(null,t,null,n._onCommit),n},Cd.prototype.legacy_renderSubtreeIntoContainer=function(e,t,n){var r=this._internalRoot,i=new wd;return null!==(n=void 0===n?null:n)&&i.then(n),bd(t,r,e,i._onCommit),i},Cd.prototype.createBatch=function(){var e=new Pd(this),t=e._expirationTime,n=this._internalRoot,r=n.firstBatch;if(null===r)(n.firstBatch=e)._next=null;else{for(n=null;null!==r&&r._expirationTime>=t;)r=(n=r)._next;e._next=r,null!==n&&(n._next=e)}return e},vi=function(){jc||0===qc||(dd(qc,!1),qc=0)};var _d,xd,kd={createPortal:Ed,findDOMNode:function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;return void 0===t&&("function"==typeof e.render?qn("188"):qn("268",Object.keys(e))),e=null===(e=Xo(t))?null:e.stateNode},hydrate:function(e,t,n){return Md(t)||qn("200"),Id(null,e,t,!0,n)},render:function(e,t,n){return Md(t)||qn("200"),Id(null,e,t,!1,n)},unstable_renderSubtreeIntoContainer:function(e,t,n,r){return Md(n)||qn("200"),(null==e||void 0===e._reactInternalFiber)&&qn("38"),Id(e,t,n,!1,r)},unmountComponentAtNode:function(e){return Md(e)||qn("40"),!!e._reactRootContainer&&(gd(function(){Id(null,null,e,!1,function(){e._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return Ed.apply(void 0,arguments)},unstable_batchedUpdates:yi=yd,unstable_interactiveUpdates:gi=vd,flushSync:function(e,t){jc&&qn("187");var n=Gc;Gc=!0;try{return Dc(e,t)}finally{Gc=n,dd(1073741823,!1)}},unstable_createRoot:function(e,t){return Md(e)||qn("299","unstable_createRoot"),new Cd(e,!0,null!=t&&!0===t.hydrate)},unstable_flushControlled:function(e){var t=Gc;Gc=!0;try{Dc(e)}finally{(Gc=t)||jc||dd(1073741823,!1)}},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{Events:[br,Tr,Pr,fr.injectEventPluginsByName,nr,_r,function(e){cr(e,Er)},hi,mi,pa,mr]}};xd=(_d={findFiberByHostInstance:Sr,bundleType:0,version:"16.8.6",rendererPackageName:"react-dom"}).findFiberByHostInstance,function(e){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return;try{var n=t.inject(e);Ms=Es(function(e){return t.onCommitFiberRoot(n,e)}),Is=Es(function(e){return t.onCommitFiberUnmount(n,e)})}catch(e){}}(Zt({},_d,{overrideProps:null,currentDispatcherRef:_i.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Xo(e))?null:e.stateNode},findFiberByHostInstance:function(e){return xd?xd(e):null}}));var Rd=kd.default||kd,Ad=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=0;t.__interactionsRef=null,t.__subscriberRef=null,t.unstable_clear=function(e){return e()},t.unstable_getCurrent=function(){return null},t.unstable_getThreadID=function(){return++n},t.unstable_trace=function(e,t,n){return n()},t.unstable_wrap=function(e){return e},t.unstable_subscribe=function(){},t.unstable_unsubscribe=function(){}});e(Ad);Ad.__interactionsRef,Ad.__subscriberRef,Ad.unstable_clear,Ad.unstable_getCurrent,Ad.unstable_getThreadID,Ad.unstable_trace,Ad.unstable_wrap,Ad.unstable_subscribe,Ad.unstable_unsubscribe;var Od=t(function(e,t){});e(Od);Od.__interactionsRef,Od.__subscriberRef,Od.unstable_clear,Od.unstable_getCurrent,Od.unstable_getThreadID,Od.unstable_trace,Od.unstable_wrap,Od.unstable_subscribe,Od.unstable_unsubscribe,t(function(e){e.exports=Ad}),t(function(e){});var Ld=t(function(e){!function e(){if('undefined'!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&'function'==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}(),e.exports=Rd}),Fd=t(function(e,y){var r,t=V&&V.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(y,"__esModule",{value:!0});var T=0;y.IS_UNIQUE='__DO_NOT_DEDUPE_STYLE__';for(var n=/[A-Z]/g,i=/^ms-/,o=/&/g,a=/[ !#$%&()*+,./;<=>?@[\]^`{|}~"'\\]/g,s=function(e){return"-"+e.toLowerCase()},l=['animation-iteration-count','box-flex','box-flex-group','column-count','counter-increment','counter-reset','flex','flex-grow','flex-positive','flex-shrink','flex-negative','font-weight','line-clamp','line-height','opacity','order','orphans','tab-size','widows','z-index','zoom','fill-opacity','stroke-dashoffset','stroke-opacity','stroke-width'],u=Object.create(null),c=0,d=['-webkit-','-ms-','-moz-','-o-',''];c<d.length;c++)for(var p=d[c],f=0,h=l;f<h.length;f++){u[p+h[f]]=!0}function m(e){return e.replace(n,s).replace(i,'-ms-')}function g(e){for(var t=5381,n=e.length;n--;)t=33*t^e.charCodeAt(n);return(t>>>0).toString(36)}function v(e,t){return'number'!=typeof t||0===t||u[e]?e+":"+t:e+":"+t+"px"}function S(e){return e.sort(function(e,t){return e[0]>t[0]?1:-1})}function P(e,t){for(var n,r=[],i=[],o=!1,a=0,s=Object.keys(e);a<s.length;a++){var l=s[a],u=e[l];null!=u&&(l===y.IS_UNIQUE?o=!0:'object'!=typeof u||Array.isArray(u)?r.push([m(l.trim()),u]):i.push([l.trim(),u]))}return{styleString:(n=S(r),n.map(function(e){var t=e[0],n=e[1];return Array.isArray(n)?n.map(function(e){return v(t,e)}).join(';'):v(t,n)}).join(';')),nestedStyles:t?i:S(i),isUnique:o}}function w(e,t){return-1<e.indexOf('&')?e.replace(o,t):t+" "+e}function b(e,t,n,r,i){for(var o=new I(e.hash),a=[],s=function e(t,n,r,i,o){var a=P(r,!!n),s=a.styleString,l=a.nestedStyles,u=a.isUnique,c=s;if(64===n.charCodeAt(0)){var d=t.add(new x(n,o?void 0:s,t.hash));if(s&&o){var p=d.add(new _(s,d.hash,u?"u"+(++T).toString(36):void 0));i.push([o,p])}for(var f=0,h=l;f<h.length;f++){var m=h[f];c+=(S=m[0])+e(d,S,m[1],i,o)}}else{var y=o?w(n,o):n;s&&(p=t.add(new _(s,t.hash,u?"u"+(++T).toString(36):void 0)),i.push([y,p]));for(var g=0,v=l;g<v.length;g++){var S,b=v[g];c+=(S=b[0])+e(t,S,b[1],i,y)}}return c}(o,t,n,a),l="f"+o.hash(s),u=i?i+"_"+l:l,c=0,d=a;c<d.length;c++){var p=d[c],f=p[0],h=p[1],m=r?w(f,"."+y.escape(u)):f;h.add(new E(m,h.hash,void 0,s))}return{cache:o,pid:s,id:u}}function C(e){for(var t='',n=0;n<e.length;n++)t+=e[n];return t}y.escape=function(e){return e.replace(a,'\\$&')},y.hyphenate=m,y.stringHash=g;var M={add:function(){},change:function(){},remove:function(){}},I=function(){function s(e,t){void 0===e&&(e=g),void 0===t&&(t=M),this.hash=e,this.changes=t,this.sheet=[],this.changeId=0,this._keys=[],this._children=Object.create(null),this._counters=Object.create(null)}return s.prototype.add=function(e){var t=this._counters[e.id]||0,n=this._children[e.id]||e.clone();if(this._counters[e.id]=t+1,0===t)this._children[n.id]=n,this._keys.push(n.id),this.sheet.push(n.getStyles()),this.changeId++,this.changes.add(n,this._keys.length-1);else{if(n.getIdentifier()!==e.getIdentifier())throw new TypeError("Hash collision: "+e.getStyles()+" === "+n.getStyles());var r=this._keys.indexOf(e.id),i=this._keys.length-1,o=this.changeId;if(r!==i&&(this._keys.splice(r,1),this._keys.push(e.id),this.changeId++),n instanceof s&&e instanceof s){var a=n.changeId;n.merge(e),n.changeId!==a&&this.changeId++}this.changeId!==o&&(r===i?this.sheet.splice(r,1,n.getStyles()):(this.sheet.splice(r,1),this.sheet.splice(i,0,n.getStyles())),this.changes.change(n,r,i))}return n},s.prototype.remove=function(e){var t=this._counters[e.id];if(0<t){this._counters[e.id]=t-1;var n=this._children[e.id],r=this._keys.indexOf(n.id);if(1===t)delete this._counters[e.id],delete this._children[e.id],this._keys.splice(r,1),this.sheet.splice(r,1),this.changeId++,this.changes.remove(n,r);else if(n instanceof s&&e instanceof s){var i=n.changeId;n.unmerge(e),n.changeId!==i&&(this.sheet.splice(r,1,n.getStyles()),this.changeId++,this.changes.change(n,r,r))}}},s.prototype.merge=function(e){for(var t=0,n=e._keys;t<n.length;t++){var r=n[t];this.add(e._children[r])}return this},s.prototype.unmerge=function(e){for(var t=0,n=e._keys;t<n.length;t++){var r=n[t];this.remove(e._children[r])}return this},s.prototype.clone=function(){return new s(this.hash).merge(this)},s}();y.Cache=I;var E=function(){function e(e,t,n,r){void 0===n&&(n="s"+t(e)),void 0===r&&(r=''),this.selector=e,this.hash=t,this.id=n,this.pid=r}return e.prototype.getStyles=function(){return this.selector},e.prototype.getIdentifier=function(){return this.pid+"."+this.selector},e.prototype.clone=function(){return new e(this.selector,this.hash,this.id,this.pid)},e}();y.Selector=E;var _=function(i){function e(e,t,n){void 0===n&&(n="c"+t(e));var r=i.call(this,t)||this;return r.style=e,r.hash=t,r.id=n,r}return t(e,i),e.prototype.getStyles=function(){return this.sheet.join(',')+"{"+this.style+"}"},e.prototype.getIdentifier=function(){return this.style},e.prototype.clone=function(){return new e(this.style,this.hash,this.id).merge(this)},e}(I);y.Style=_;var x=function(a){function e(e,t,n,r,i){void 0===t&&(t=''),void 0===r&&(r="a"+n(e+"."+t)),void 0===i&&(i='');var o=a.call(this,n)||this;return o.rule=e,o.style=t,o.hash=n,o.id=r,o.pid=i,o}return t(e,a),e.prototype.getStyles=function(){return this.rule+"{"+this.style+C(this.sheet)+"}"},e.prototype.getIdentifier=function(){return this.pid+"."+this.rule+"."+this.style},e.prototype.clone=function(){return new e(this.rule,this.style,this.hash,this.id,this.pid).merge(this)},e}(I);y.Rule=x;var k=function(o){function e(e,t,n,r){void 0===e&&(e=g),void 0===t&&(t='undefined'!=typeof process&&'production'!==process.env.NODE_ENV),void 0===n&&(n="f"+(++T).toString(36));var i=o.call(this,e,r)||this;return i.hash=e,i.debug=t,i.id=n,i}return t(e,o),e.prototype.registerStyle=function(e,t){var n=b(this,'&',e,!0,this.debug?t:void 0),r=n.cache,i=n.id;return this.merge(r),i},e.prototype.registerKeyframes=function(e,t){return this.registerHashRule('@keyframes',e,t)},e.prototype.registerHashRule=function(e,t,n){var r=b(this,'',t,!1,this.debug?n:void 0),i=r.cache,o=r.pid,a=r.id,s=new x(e+" "+y.escape(a),void 0,this.hash,void 0,o);return this.add(s.merge(i)),a},e.prototype.registerRule=function(e,t){this.merge(b(this,e,t,!1).cache)},e.prototype.registerCss=function(e){this.merge(b(this,'',e,!1).cache)},e.prototype.getStyles=function(){return C(this.sheet)},e.prototype.getIdentifier=function(){return this.id},e.prototype.clone=function(){return new e(this.hash,this.debug,this.id,this.changes).merge(this)},e}(I);y.FreeStyle=k,y.create=function(e,t,n){return new k(e,t,void 0,n)}});e(Fd);Fd.IS_UNIQUE,Fd.escape,Fd.hyphenate,Fd.stringHash,Fd.Cache,Fd.Selector,Fd.Style,Fd.Rule,Fd.FreeStyle,Fd.create;var Dd=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ensureStringObj=function e(t){var n={},r='';for(var i in t){var o=t[i];if('$unique'===i)n[Fd.IS_UNIQUE]=o;else if('$nest'===i){var a=o;for(var s in a){var l=a[s];n[s]=e(l).result}}else'$debugName'===i?r=o:n[i]=o}return{result:n,debugName:r}},t.explodeKeyframes=function(e){var t={$debugName:void 0,keyframes:{}};for(var n in e){var r=e[n];'$debugName'===n?t.$debugName=r:t.keyframes[n]=r}return t}});e(Dd);Dd.ensureStringObj,Dd.explodeKeyframes;var Nd=t(function(e,t){function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},r=0,i=e;r<i.length;r++){var o=i[r];if(null!=o&&!1!==o)for(var a in o){var s=o[a];(s||0===s)&&('$nest'===a&&s?n[a]=n.$nest?l(n.$nest,s):s:-1!==a.indexOf('&')||0===a.indexOf('@media')?n[a]=n[a]?l(n[a],s):s:n[a]=s)}}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.raf='undefined'==typeof requestAnimationFrame?function(e){return setTimeout(e)}:'undefined'==typeof window?requestAnimationFrame:requestAnimationFrame.bind(window),t.classes=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!!e}).join(' ')},t.extend=l,t.media=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r,i=[];return e.type&&i.push(e.type),e.orientation&&i.push("(orientation: "+e.orientation+")"),e.minWidth&&i.push("(min-width: "+o(e.minWidth)+")"),e.maxWidth&&i.push("(max-width: "+o(e.maxWidth)+")"),e.minHeight&&i.push("(min-height: "+o(e.minHeight)+")"),e.maxHeight&&i.push("(max-height: "+o(e.maxHeight)+")"),{$nest:(r={},r["@media "+i.join(' and ')]=l.apply(void 0,t),r)}};var o=function(e){return'string'==typeof e?e:e+"px"}});e(Nd);Nd.raf,Nd.classes,Nd.extend,Nd.media;var Ud=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return Fd.create(void 0,!0)},n=function(){function e(e){var t=e.autoGenerateTag,a=this;this.cssRaw=function(e){e&&(a._raw+=e||'',a._pendingRawChange=!0,a._styleUpdated())},this.cssRule=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Dd.ensureStringObj(Nd.extend.apply(void 0,t)).result;a._freeStyle.registerRule(e,r),a._styleUpdated()},this.forceRenderStyles=function(){var e=a._getTag();e&&(e.textContent=a.getStyles())},this.fontFace=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=a._freeStyle,r=0,i=e;r<i.length;r++){var o=i[r];n.registerRule('@font-face',o)}a._styleUpdated()},this.getStyles=function(){return(a._raw||'')+a._freeStyle.getStyles()},this.keyframes=function(e){var t=Dd.explodeKeyframes(e),n=t.keyframes,r=t.$debugName,i=a._freeStyle.registerKeyframes(n,r);return a._styleUpdated(),i},this.reinit=function(){var e=r();a._freeStyle=e,a._lastFreeStyleChangeId=e.changeId,a._raw='',a._pendingRawChange=!1;var t=a._getTag();t&&(t.textContent='')},this.setStylesTarget=function(e){a._tag&&(a._tag.textContent=''),a._tag=e,a.forceRenderStyles()},this.stylesheet=function(e){for(var t={},n=0,r=Object.getOwnPropertyNames(e);n<r.length;n++){var i=r[n],o=e[i];o&&(t[o.$debugName=i]=a.style(o))}return t};var n=r();this._autoGenerateTag=t,this._freeStyle=n,this._lastFreeStyleChangeId=n.changeId,this._pending=0,this._pendingRawChange=!1,this._raw='',this._tag=void 0,this.style=this.style.bind(this)}return e.prototype._afterAllSync=function(e){var t=this;this._pending++;var n=this._pending;Nd.raf(function(){n===t._pending&&e()})},e.prototype._getTag=function(){if(this._tag)return this._tag;if(this._autoGenerateTag){var e='undefined'==typeof window?{textContent:''}:document.createElement('style');return'undefined'!=typeof document&&document.head.appendChild(e),this._tag=e}},e.prototype._styleUpdated=function(){var e=this,t=this._freeStyle.changeId,n=this._lastFreeStyleChangeId;(this._pendingRawChange||t!==n)&&(this._lastFreeStyleChangeId=t,this._pendingRawChange=!1,this._afterAllSync(function(){return e.forceRenderStyles()}))},e.prototype.style=function(){var e=this._freeStyle,t=Dd.ensureStringObj(Nd.extend.apply(void 0,arguments)),n=t.result,r=t.debugName,i=r?e.registerStyle(n,r):e.registerStyle(n);return this._styleUpdated(),i},e}();t.TypeStyle=n});e(Ud);Ud.TypeStyle;var Bd=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0})});e(Bd);var Vd=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.TypeStyle=Ud.TypeStyle,t.types=Bd,t.extend=Nd.extend,t.classes=Nd.classes,t.media=Nd.media;var n=new Ud.TypeStyle({autoGenerateTag:!0});t.setStylesTarget=n.setStylesTarget,t.cssRaw=n.cssRaw,t.cssRule=n.cssRule,t.forceRenderStyles=n.forceRenderStyles,t.fontFace=n.fontFace,t.getStyles=n.getStyles,t.keyframes=n.keyframes,t.reinit=n.reinit,t.style=n.style,t.stylesheet=n.stylesheet,t.createTypeStyle=function(e){var t=new Ud.TypeStyle({autoGenerateTag:!1});return e&&t.setStylesTarget(e),t}});e(Vd);Vd.TypeStyle,Vd.types,Vd.extend,Vd.classes,Vd.media,Vd.setStylesTarget,Vd.cssRaw,Vd.cssRule,Vd.forceRenderStyles,Vd.fontFace,Vd.getStyles,Vd.keyframes,Vd.reinit,Vd.style,Vd.stylesheet,Vd.createTypeStyle;var jd=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).LocalContentManager="LocalContentManager",r.MetricsReporting="MetricsReporting",r.Player="Player",r.PlayerCapabilities="PlayerCapabilities",r.RequestManager="RequestManager",t.PlayerSDKFeatures=n});e(jd);jd.PlayerSDKFeatures;var Xd=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).Unloaded="Unloaded",r.Waiting="Waiting",r.Ready="Ready",r.Error="Error",t.ContentState=n});e(Xd);Xd.ContentState;var zd=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).Paused="Paused",r.Playing="Playing",t.PlaybackState=n});e(zd);zd.PlaybackState;var qd=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).ContentStateChange="ContentStateChange",r.PlaybackStateChange="PlaybackStateChange",r.TimeDataChange="TimeDataChange",r.TimelineChange="TimelineChange",r.TimelineEnded="TimelineEnded",r.Error="Error",r.ContentError="ContentError",t.PlayerEvent=n});e(qd);qd.PlayerEvent;var Wd=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).MetricsReporting="MetricsReporting",r.AdReporting="AdReporting",r.PictureInPicture="PictureInPicture",r.Stream="Stream",r.Volume="Volume",t.PlayerFeatures=n});e(Wd);Wd.PlayerFeatures;var Hd=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).EpochMillis="EpochMillis",r.ContentMillis="ContentMillis",t.TimeUnit=n});e(Hd);Hd.TimeUnit;var Gd=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerSDKFeatures=jd.PlayerSDKFeatures,t.ContentState=Xd.ContentState,t.PlaybackState=zd.PlaybackState,t.PlayerEvent=qd.PlayerEvent,t.PlayerFeatures=Wd.PlayerFeatures,t.TimeUnit=Hd.TimeUnit});e(Gd);Gd.PlayerSDKFeatures,Gd.ContentState,Gd.PlaybackState,Gd.PlayerEvent,Gd.PlayerFeatures,Gd.TimeUnit;var Kd=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(){}return t.newError=function(e,t,n){var r=new Error(t);return r.name=e,void 0!==n&&null!=n&&(r.cause=n),r},t.newAuthenticationError=function(e){return t.newError("AuthenticationError",e)},t.newIllegalArgumentError=function(e){return t.newError("IllegalArgumentError",e)},t.newIllegalStateError=function(e){return t.newError("IllegalStateError",e)},t.getAllErrorNames=function(e){for(var t=[e.name];e.cause instanceof Error;)e=e.cause,t.push(e.name);return t},t}();t.Errors=n});e(Kd);Kd.Errors;var Qd=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(s){function e(e,t,n,r,i,o){var a=s.call(this)||this;return a.code=e,a.domain=t,a.description=n,a.internalCode=r,a.message=i,a.name=o,a}return n(e,s),e}(Error);t.WebError=i});e(Qd);Qd.WebError;var Yd=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Errors=Kd.Errors,t.WebError=Qd.WebError});e(Yd);Yd.Errors,Yd.WebError;var Jd=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).ContentConcurrencyLimit="xp.content.concurrency_limit",r.ContentNoRightsAnonymizerIp="xp.content.no_rights.anonymizer_ip",r.ContentNoRightsDownloadLimitExceeded="xp.content.no_rights.download_limit_exceeded",r.ContentNoRightsHdContentNotAllowed="xp.content.no_rights.hd_content_not_allowed",r.ContentNoRightsInvalidGeoIp="xp.content.no_rights.invalid_geo_ip",r.ContentNoRightsNoAvailableStreams="xp.content.no_rights.no_available_streams",r.ContentNoRightsNotAcceptedTermsAndConditions="xp.content.no_rights.not_accepted_terms_and_conditions",r.ContentNoRightsNotOwned="xp.content.no_rights.not_owned",r.ContentNoRightsUnknown="xp.content.no_rights.unknown",r.ContentServiceNullResponse="xp.content.service.null_response",r.ContentServiceParse="xp.content.service.parse",r.ContentServiceUnknown="xp.content.service.unknown",r.NetworkIpv6UnsupportedMarketplace="xp.network.ipv6_unsupported_marketplace",r.SystemDisplayDisconnected="xp.system.display_disconnected",r.SystemHdcpInsufficient="xp.system.hdcp_insufficient",r.Unknown="xp.unknown",t.XpErrorName=n});e(Jd);Jd.XpErrorName;var $d=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.transformError=function(e){switch(e.code){case Jd.XpErrorName.ContentNoRightsNotOwned:return this.createWebError(5002,"Generic/Other","Unable to play video",e.code,"This video is unavailable. Please select another title to watch.",e.name);case Jd.XpErrorName.ContentNoRightsInvalidGeoIp:return this.createWebError(5006,"Generic/Other","Unable to play video",e.code,"This video is unavailable in your area. Please select another title to watch.",e.name);case Jd.XpErrorName.ContentNoRightsAnonymizerIp:return this.createWebError(4006,"System","HTTP proxies and VPN connections not allowed",e.code,"Your device's Internet connection is using an HTTP proxy or a Virtual Private Network (VPN) which prevents playing your video. Please close or disable any proxy programs and try again.",e.name);case Jd.XpErrorName.ContentNoRightsDownloadLimitExceeded:case Jd.XpErrorName.ContentNoRightsHdContentNotAllowed:return this.createWebError(3001,"Content Protection: DRM","Content protection error",e.code,"We've encountered a problem with this video. Please try again. If the problem continues, please contact customer service.",e.name);case Jd.XpErrorName.SystemHdcpInsufficient:return this.createWebError(3003,"Content Protection: DRM","Content protection error",e.code,"This video can’t play on your device as it doesn't meet content protection standards. All of your displays, device output ports, and cables must be HDCP compliant.",e.name);case Jd.XpErrorName.Unknown:case Jd.XpErrorName.ContentConcurrencyLimit:case Jd.XpErrorName.ContentNoRightsNoAvailableStreams:case Jd.XpErrorName.ContentNoRightsNotAcceptedTermsAndConditions:case Jd.XpErrorName.ContentNoRightsUnknown:case Jd.XpErrorName.ContentServiceNullResponse:case Jd.XpErrorName.ContentServiceParse:case Jd.XpErrorName.ContentServiceUnknown:case Jd.XpErrorName.NetworkIpv6UnsupportedMarketplace:case Jd.XpErrorName.SystemDisplayDisconnected:default:return this.createWebError(5001,"Generic/Other","Unable to play video",e.code,"There was an error playing your video. Please try again. If the problem continues, contact customer service.",e.name)}},e.createWebError=function(e,t,n,r,i,o){return new Yd.WebError(e,t,n,r,i,o)},e}();t.ErrorCodeTransformer=n});e($d);$d.ErrorCodeTransformer;var Zd=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){void 0===n&&(n=A.timer),this.locked=!1,this.timeoutID=null,this.onLock=e,this.onUnlock=t,this.timer=n}return e.prototype.lock=function(e){var t=this;this.locked||this.onLock(),this.locked=!0,this.cancelTimeout(),xt.exists(e)&&(this.timeoutID=this.timer.setTimeout(function(){return t.unlock()},e))},e.prototype.unlock=function(){this.locked&&(this.cancelTimeout(),this.locked=!1,this.onUnlock())},e.prototype.cancelTimeout=function(){this.timer.clearTimeout(this.timeoutID),this.timeoutID=null},e}();t.Lock=n});e(Zd);Zd.Lock;var ep=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="lock_status_change",r=function(){function e(e){void 0===e&&(e=new Dt.EventEmitter),this.lockCounter=0,this.locked=!1,this.locks=[],this.eventEmitter=e}return e.prototype.newLock=function(){var e=this,t=new Zd.Lock(function(){return e.onLock()},function(){return e.onUnlock()});return this.locks.push(t),t},e.prototype.deleteLock=function(e){e.unlock(),this.locks.splice(this.locks.indexOf(e),1)},e.prototype.onChange=function(e){this.eventEmitter.on(n,e)},e.prototype.offChange=function(e){this.eventEmitter.off(n,e)},e.prototype.changeStatus=function(e){this.locked=e,this.eventEmitter.emit(n,this.locked)},e.prototype.onLock=function(){this.lockCounter++,0<this.lockCounter&&!this.locked&&this.changeStatus(!this.locked)},e.prototype.onUnlock=function(){this.lockCounter--,0===this.lockCounter&&this.locked&&this.changeStatus(!this.locked)},e}();t.LockStore=r});e(ep);ep.LockStore;var tp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCodeTransformer=$d.ErrorCodeTransformer,t.Lock=Zd.Lock,t.LockStore=ep.LockStore});e(tp);tp.ErrorCodeTransformer,tp.Lock,tp.LockStore;var np=t(function(e,l){var o={};o.hexTable=new Array(256);for(var t=0;t<256;++t)o.hexTable[t]='%'+((t<16?'0':'')+t.toString(16)).toUpperCase();l.arrayToObject=function(e,t){for(var n=t.plainObjects?Object.create(null):{},r=0,i=e.length;r<i;++r)void 0!==e[r]&&(n[r]=e[r]);return n},l.merge=function(e,t,n){if(!t)return e;if('object'!=typeof t)return Array.isArray(e)?e.push(t):'object'==typeof e?e[t]=!0:e=[e,t],e;if('object'!=typeof e)return e=[e].concat(t);Array.isArray(e)&&!Array.isArray(t)&&(e=l.arrayToObject(e,n));for(var r=Object.keys(t),i=0,o=r.length;i<o;++i){var a=r[i],s=t[a];Object.prototype.hasOwnProperty.call(e,a)?e[a]=l.merge(e[a],s,n):e[a]=s}return e},l.decode=function(t){try{return decodeURIComponent(t.replace(/\+/g,' '))}catch(e){return t}},l.encode=function(e){if(0===e.length)return e;'string'!=typeof e&&(e=''+e);for(var t='',n=0,r=e.length;n<r;++n){var i=e.charCodeAt(n);45===i||46===i||95===i||126===i||48<=i&&i<=57||65<=i&&i<=90||97<=i&&i<=122?t+=e[n]:i<128?t+=o.hexTable[i]:i<2048?t+=o.hexTable[192|i>>6]+o.hexTable[128|63&i]:i<55296||57344<=i?t+=o.hexTable[224|i>>12]+o.hexTable[128|i>>6&63]+o.hexTable[128|63&i]:(++n,i=65536+((1023&i)<<10|1023&e.charCodeAt(n)),t+=o.hexTable[240|i>>18]+o.hexTable[128|i>>12&63]+o.hexTable[128|i>>6&63]+o.hexTable[128|63&i])}return t},l.compact=function(e,t){if('object'!=typeof e||null===e)return e;var n=(t=t||[]).indexOf(e);if(-1!==n)return t[n];if(t.push(e),Array.isArray(e)){for(var r=[],i=0,o=e.length;i<o;++i)void 0!==e[i]&&r.push(e[i]);return r}var a=Object.keys(e);for(i=0,o=a.length;i<o;++i){var s=a[i];e[s]=l.compact(e[s],t)}return e},l.isRegExp=function(e){return'[object RegExp]'===Object.prototype.toString.call(e)},l.isBuffer=function(e){return null!=e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}}),rp=(np.arrayToObject,np.merge,np.decode,np.encode,np.compact,np.isRegExp,np.isBuffer,{delimiter:'&',arrayPrefixGenerators:{brackets:function(e,t){return e+'[]'},indices:function(e,t){return e+'['+t+']'},repeat:function(e,t){return e}},strictNullHandling:!1,skipNulls:!1,encode:!0,stringify:function(e,t,n,r,i,o,a,s){if('function'==typeof a)e=a(t,e);else if(np.isBuffer(e))e=e.toString();else if(e instanceof Date)e=e.toISOString();else if(null===e){if(r)return o?np.encode(t):t;e=''}if('string'==typeof e||'number'==typeof e||'boolean'==typeof e)return o?[np.encode(t)+'='+np.encode(e)]:[t+'='+e];var l,u=[];if(void 0===e)return u;if(Array.isArray(a))l=a;else{var c=Object.keys(e);l=s?c.sort(s):c}for(var d=0,p=l.length;d<p;++d){var f=l[d];i&&null===e[f]||(u=Array.isArray(e)?u.concat(rp.stringify(e[f],n(t,f),n,r,i,o,a)):u.concat(rp.stringify(e[f],t+'['+f+']',n,r,i,o,a)))}return u}}),ip={delimiter:'&',depth:5,arrayLimit:20,parameterLimit:1e3,strictNullHandling:!1,plainObjects:!1,allowPrototypes:!1,allowDots:!1,parseValues:function(e,t){for(var n={},r=e.split(t.delimiter,t.parameterLimit===1/0?void 0:t.parameterLimit),i=0,o=r.length;i<o;++i){var a=r[i],s=-1===a.indexOf(']=')?a.indexOf('='):a.indexOf(']=')+1;if(-1===s)n[np.decode(a)]='',t.strictNullHandling&&(n[np.decode(a)]=null);else{var l=np.decode(a.slice(0,s)),u=np.decode(a.slice(s+1));Object.prototype.hasOwnProperty.call(n,l)?n[l]=[].concat(n[l]).concat(u):n[l]=u}}return n},parseObject:function(e,t,n){if(!e.length)return t;var r,i=e.shift();if('[]'===i)r=(r=[]).concat(ip.parseObject(e,t,n));else{r=n.plainObjects?Object.create(null):{};var o='['===i[0]&&']'===i[i.length-1]?i.slice(1,i.length-1):i,a=parseInt(o,10),s=''+a;!isNaN(a)&&i!==o&&s===o&&0<=a&&n.parseArrays&&a<=n.arrayLimit?(r=[])[a]=ip.parseObject(e,t,n):r[o]=ip.parseObject(e,t,n)}return r},parseKeys:function(e,t,n){if(e){n.allowDots&&(e=e.replace(/\.([^\.\[]+)/g,'[$1]'));var r=/(\[[^\[\]]*\])/g,i=/^([^\[\]]*)/.exec(e),o=[];if(i[1]){if(!n.plainObjects&&Object.prototype.hasOwnProperty(i[1])&&!n.allowPrototypes)return;o.push(i[1])}for(var a=0;null!==(i=r.exec(e))&&a<n.depth;)++a,(n.plainObjects||!Object.prototype.hasOwnProperty(i[1].replace(/\[|\]/g,''))||n.allowPrototypes)&&o.push(i[1]);return i&&o.push('['+e.slice(i.index)+']'),ip.parseObject(o,t,n)}}},op=function(e,t){var n,r,i=void 0===(t=t||{}).delimiter?rp.delimiter:t.delimiter,o='boolean'==typeof t.strictNullHandling?t.strictNullHandling:rp.strictNullHandling,a='boolean'==typeof t.skipNulls?t.skipNulls:rp.skipNulls,s='boolean'==typeof t.encode?t.encode:rp.encode,l='function'==typeof t.sort?t.sort:null;'function'==typeof t.filter?e=(r=t.filter)('',e):Array.isArray(t.filter)&&(n=r=t.filter);var u,c=[];if('object'!=typeof e||null===e)return'';u=t.arrayFormat in rp.arrayPrefixGenerators?t.arrayFormat:'indices'in t?t.indices?'indices':'repeat':'indices';var d=rp.arrayPrefixGenerators[u];n||(n=Object.keys(e)),l&&n.sort(l);for(var p=0,f=n.length;p<f;++p){var h=n[p];a&&null===e[h]||(c=c.concat(rp.stringify(e[h],h,d,o,a,s,r,l)))}return c.join(i)},ap=function(e,t){if((t=t||{}).delimiter='string'==typeof t.delimiter||np.isRegExp(t.delimiter)?t.delimiter:ip.delimiter,t.depth='number'==typeof t.depth?t.depth:ip.depth,t.arrayLimit='number'==typeof t.arrayLimit?t.arrayLimit:ip.arrayLimit,t.parseArrays=!1!==t.parseArrays,t.allowDots='boolean'==typeof t.allowDots?t.allowDots:ip.allowDots,t.plainObjects='boolean'==typeof t.plainObjects?t.plainObjects:ip.plainObjects,t.allowPrototypes='boolean'==typeof t.allowPrototypes?t.allowPrototypes:ip.allowPrototypes,t.parameterLimit='number'==typeof t.parameterLimit?t.parameterLimit:ip.parameterLimit,t.strictNullHandling='boolean'==typeof t.strictNullHandling?t.strictNullHandling:ip.strictNullHandling,''===e||null==e)return t.plainObjects?Object.create(null):{};for(var n='string'==typeof e?ip.parseValues(e,t):e,r=t.plainObjects?Object.create(null):{},i=Object.keys(n),o=0,a=i.length;o<a;++o){var s=i[o],l=ip.parseKeys(s,n[s],t);r=np.merge(r,l,t)}return np.compact(r)},sp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("QueryString"),n=function(){function r(){}return r.getParameter=function(e,t){i(e,"name").exists();var n=r.getQueryString(t);return n.hasOwnProperty(e)?n[e]:null},r.getQueryString=function(e){if(null==e){if(void 0===location||void 0===location.search)return{};e=location.search}try{var t=ap(e.replace(/^\?/,""));return r.parseStrings(t)}catch(e){return{}}},r.parseStrings=function(e){if(F.isString(e)){if(/^true$/i.test(e))return!0;if(/^false$/i.test(e))return!1;if(/^null$/i.test(e))return null;if(/^undefined$/i.test(e))return;return/^\d+$/.test(e)?parseInt(e,10):e}if(F.isArray(e)||F.isObject(e)){var t=F.isArray(e)?[]:{};for(var n in e)e.hasOwnProperty(n)&&(t[n]=this.parseStrings(e[n]));return t}return e},r}();t.QueryString=n});e(sp);sp.QueryString;var lp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new(function(){function e(){this.xpConfiguration=null}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this.xpConfiguration},set:function(e){this.xpConfiguration=Object.freeze(e)},enumerable:!0,configurable:!0}),e}());t.configurationStore=n});e(lp);lp.configurationStore;var up=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.configurationStore=lp.configurationStore});e(up);up.configurationStore;var cp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.componentId=e,this.onEvent=t}return e.prototype.report=function(e,t){this.onEvent(this.componentId,e,t)},e}();t.DiagnosticsReporterImpl=n});e(cp);cp.DiagnosticsReporterImpl;var dp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("Diagnostics"),n=function(){function a(){}return a.addSink=function(e){a.sinks.push(e)},a.removeSink=function(e){for(var t=0;t<a.sinks.length;t++)if(a.sinks[t]===e)return void a.sinks.splice(t,1)},a.create=function(e){return new cp.DiagnosticsReporterImpl(e,a.reportEvent)},a.sinks=[],a.reportEvent=function(t,n,e){for(var r=0,i=a.sinks;r<i.length;r++){var o=i[r];try{o.onEvent(t,n,e)}catch(e){s.error("Diagnostics sink threw an error for event "+n+" from component "+t,e)}}},a}();t.Diagnostics=n});e(dp);dp.Diagnostics;var pp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Diagnostics=dp.Diagnostics});e(pp);pp.Diagnostics;var fp=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("HttpRequest"),u=pp.Diagnostics.create("HttpRequest"),i=!1,r=function(){function r(e,t,n){void 0===n&&(n="HttpRequest-"+r.nextId++);var a=this;this.timer=A.timer,this.requestHeaders={},this.requestFields={},this.parameters={},this.timeouts={},this.httpResponseType=null,this.requestWithCredentials=!1,this.bodyData=null,this.loadCallbacks=[],this.errorCallbacks=[],this.timeoutCallbacks=[],this.abortCallbacks=[],this.progressCallbacks=[],this.watchdogTimeoutTriggered=!1,this.watchdogTimeoutId=null,this.httpRequestAdapter=null,this.onLoadCallbackWrapper=function(e){if(a.clearWatchdogTimeout(),!a.watchdogTimeoutTriggered){u.report("network.completed",{id:a.id,statusCode:e.getStatus(),metrics:e.getMetrics(),timestamp:Date.now()});for(var t=0,n=a.loadCallbacks;t<n.length;t++){(0,n[t])(e)}}},this.onErrorCallbackWrapper=function(e,t){if(a.clearWatchdogTimeout(),!a.watchdogTimeoutTriggered){var n;n=null!=t?"http."+t.getStatus():"http."+e.name;var r=new Ne.XpError(n,void 0,e.message);u.report("network.error",{id:a.id,error:r,timestamp:Date.now()});for(var i=0,o=a.errorCallbacks;i<o.length;i++){(0,o[i])(r,t)}}},this.onTimeoutCallbackWrapper=function(e){if(a.clearWatchdogTimeout(),!a.watchdogTimeoutTriggered)if(u.report("network.timeout",{id:a.id,metrics:e,timestamp:Date.now()}),0<a.timeoutCallbacks.length)for(var t=0,n=a.timeoutCallbacks;t<n.length;t++){(0,n[t])(e)}else for(var r=new Ne.XpError("http.request_timeout",void 0,JSON.stringify(e)),i=0,o=a.errorCallbacks;i<o.length;i++){(0,o[i])(r)}},this.onAbortCallbackWrapper=function(e){if(a.clearWatchdogTimeout(),!a.watchdogTimeoutTriggered)if(u.report("network.aborted",{id:a.id,timestamp:Date.now()}),0<a.abortCallbacks.length)for(var t=0,n=a.abortCallbacks;t<n.length;t++){(0,n[t])(e)}else for(var r=new Ne.XpError("http.request_abort",void 0,JSON.stringify(e)),i=0,o=a.errorCallbacks;i<o.length;i++){(0,o[i])(r)}},this.method=e,this.url=t,this.id=n}return r.isSupported=function(){return ze.HttpRequest.isSupported()},r.get=function(e,t){return new r("GET",e)},r.post=function(e,t){return new r("POST",e)},r.prototype.header=function(e,t){return this.requestHeaders[e]=t,this},r.prototype.headers=function(e){return this.requestHeaders=n({},this.requestHeaders,e),this},r.prototype.contentType=function(e){return this.header("Content-Type",e),this},r.prototype.accept=function(e){return this.header("Accept",e),this},r.prototype.bearerToken=function(e){return this.header("Authorization","Bearer "+e),this},r.prototype.getHeaders=function(){return this.requestHeaders},r.prototype.responseType=function(e){return this.httpResponseType=e,this},r.prototype.getResponseType=function(){return this.httpResponseType},r.prototype.timeout=function(e,t){return void 0===t&&(t="DEFAULT"),0!==(this.timeouts[t]=e)&&isFinite(e)&&!isNaN(e)||i||(i=!0,l.error("Received unexpected timeoutMs ("+e+").",(new Error).stack)),this},r.prototype.setTimeouts=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=e[r];null!=i&&(this.timeouts[r]=i)}return this},r.prototype.getTimeout=function(e){return this.timeouts[e]},r.prototype.withCredentials=function(){return this.requestWithCredentials=!0,this},r.prototype.getWithCredentials=function(){return this.requestWithCredentials},r.prototype.query=function(e){return this.parameters=n({},this.parameters,e),this},r.prototype.getQuery=function(){return this.parameters},r.prototype.body=function(e){return this.bodyData=e,this},r.prototype.json=function(e){return this.bodyData=JSON.stringify(e),this.header("Content-Type","application/json"),this},r.prototype.getBody=function(){return this.bodyData},r.prototype.field=function(e,t){return this.requestFields[e]=t,this.header("Content-Type","application/x-www-form-urlencoded"),this},r.prototype.fields=function(e){return this.requestFields=n({},this.requestFields,e),this.header("Content-Type","application/x-www-form-urlencoded"),this},r.prototype.getFields=function(){return this.requestFields},r.prototype.onLoad=function(e){return this.loadCallbacks.push(e),this},r.prototype.onProgress=function(e){return this.progressCallbacks.push(e),this},r.prototype.onError=function(e){return this.errorCallbacks.push(e),this},r.prototype.onTimeout=function(e){return this.timeoutCallbacks.push(e),this},r.prototype.onAbort=function(e){return this.abortCallbacks.push(e),this},r.prototype.abort=function(){null!==this.httpRequestAdapter&&this.httpRequestAdapter.abort()},r.prototype.send=function(){this.httpRequestAdapter=new ze.HttpRequest(this.method,this.url),F.isEmpty(this.parameters)||this.httpRequestAdapter.query(this.parameters),F.isEmpty(this.requestFields)||this.httpRequestAdapter.fields(this.requestFields),F.isEmpty(this.requestHeaders)||this.httpRequestAdapter.headers(this.requestHeaders),null!==this.httpResponseType&&this.httpRequestAdapter.responseType(this.httpResponseType),this.requestWithCredentials&&this.httpRequestAdapter.withCredentials(),null!==this.bodyData&&this.httpRequestAdapter.body(this.bodyData);for(var e=0,t=Object.keys(this.timeouts);e<t.length;e++){var n=t[e];this.httpRequestAdapter.timeout(this.timeouts[n],n)}this.httpRequestAdapter.onLoad(this.onLoadCallbackWrapper),this.httpRequestAdapter.onError(this.onErrorCallbackWrapper),this.httpRequestAdapter.onTimeout(this.onTimeoutCallbackWrapper),this.httpRequestAdapter.onAbort(this.onAbortCallbackWrapper);for(var r=0,i=this.progressCallbacks;r<i.length;r++){var o=i[r];this.httpRequestAdapter.onProgress(o)}var a=this.timeouts.DEFAULT,s=2;return null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.httpRequest&&(s=up.configurationStore.configuration.httpRequest.watchdogTimeoutFactor),null!=a&&0<a&&this.setupWatchdogTimeout(this.httpRequestAdapter,s*a),this.httpRequestAdapter.send(),u.report("network.started",{id:this.id,timestamp:Date.now()}),this},r.prototype.getRequest=function(){return{method:this.method,url:this.url,headers:this.requestHeaders,fields:this.requestFields,parameters:this.parameters,timeouts:this.timeouts,data:this.bodyData,withCredentials:this.requestWithCredentials,responseType:this.httpResponseType}},r.prototype.setupWatchdogTimeout=function(i,o){var a=this,s=Date.now();this.watchdogTimeoutId=this.timer.setTimeout(function(){a.watchdogTimeoutTriggered=!0,i.abort();var e="Native HttpRequest failed to timeout. Watchdog timeout setup as "+o+"ms, triggered in "+(Date.now()-s)+"ms";l.error(e);var t=new Ne.XpError("http.watchdog_timeout",void 0,e);u.report("network.error",{id:a.id,error:t,timestamp:Date.now()});for(var n=0,r=a.errorCallbacks;n<r.length;n++){(0,r[n])(t)}},o)},r.prototype.clearWatchdogTimeout=function(){null!==this.watchdogTimeoutId&&this.timer.clearTimeout(this.watchdogTimeoutId)},r.nextId=0,r}();t.HttpRequest=r});e(fp);fp.HttpRequest;var hp=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function r(e,t,n,r){void 0===r&&(r=fp.HttpRequest),this.parameters={},this.requestFields={},this.requestHeaders={},this.timeouts={},this.httpResponseType=null,this.requestWithCredentials=!1,this.bodyData=null,this.method=e,this.url=t,this.id=n,this.httpRequestType=r}return r.prototype.build=function(){var e=new this.httpRequestType(this.method,this.url,this.id);return F.isEmpty(this.parameters)||e.query(this.parameters),F.isEmpty(this.requestFields)||e.fields(this.requestFields),F.isEmpty(this.requestHeaders)||e.headers(this.requestHeaders),F.isEmpty(this.timeouts)||e.setTimeouts(this.timeouts),null!==this.httpResponseType&&e.responseType(this.httpResponseType),this.requestWithCredentials&&e.withCredentials(),null!==this.bodyData&&e.body(this.bodyData),e},r.get=function(e,t,n){return void 0===n&&(n=fp.HttpRequest),new r("GET",e,t,n)},r.post=function(e,t,n){return void 0===n&&(n=fp.HttpRequest),new r("POST",e,t,n)},r.prototype.header=function(e,t){return this.requestHeaders[e]=t,this},r.prototype.headers=function(e){return this.requestHeaders=n({},this.requestHeaders,e),this},r.prototype.contentType=function(e){return this.header("Content-Type",e),this},r.prototype.accept=function(e){return this.header("Accept",e),this},r.prototype.bearerToken=function(e){return this.header("Authorization","Bearer "+e),this},r.prototype.getHeaders=function(){return this.requestHeaders},r.prototype.responseType=function(e){return this.httpResponseType=e,this},r.prototype.getResponseType=function(){return this.httpResponseType},r.prototype.timeout=function(e,t){return"LATENCY"===t?this.timeouts.LATENCY=e:this.timeouts.DEFAULT=e,this},r.prototype.setTimeouts=function(e){return this.timeouts=n({},this.timeouts,e),this},r.prototype.getTimeout=function(e){return this.timeouts[e]},r.prototype.withCredentials=function(){return this.requestWithCredentials=!0,this},r.prototype.getWithCredentials=function(){return this.requestWithCredentials},r.prototype.query=function(e){return this.parameters=e,this},r.prototype.getQuery=function(){return this.parameters},r.prototype.body=function(e){return this.bodyData=e,this},r.prototype.json=function(e){return this.bodyData=JSON.stringify(e),this.header("Content-Type","application/json"),this},r.prototype.getBody=function(){return this.bodyData},r.prototype.field=function(e,t){return this.requestFields[e]=t,this},r.prototype.fields=function(e){return this.requestFields=n({},this.requestFields,e),this},r.prototype.getFields=function(){return this.requestFields},r.prototype.getRequest=function(){return{method:this.method,url:this.url,headers:this.requestHeaders,fields:this.requestFields,parameters:this.parameters,timeouts:this.timeouts,data:this.bodyData,responseType:this.httpResponseType,withCredentials:this.requestWithCredentials}},r}();t.HttpRequestBuilder=r});e(hp);hp.HttpRequestBuilder;var mp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HttpRequest=fp.HttpRequest,t.HttpRequestBuilder=hp.HttpRequestBuilder});e(mp);mp.HttpRequest,mp.HttpRequestBuilder;var yp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=function(e,t,n){return Math.max(t,Math.min(e,n))}});e(yp);yp.clamp;var gp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function a(){}return a.average=function(e){for(var t=0,n=0,r=e;n<r.length;n++){t+=r[n]}return t/e.length},a.stdDev=function(e){for(var t=a.average(e),n=0,r=0,i=e;r<i.length;r++){var o=i[r];n+=(o-t)*(o-t)}return Math.sqrt(n/e.length)},a.lerp=function(e,t,n){return e+(t-e)*Math.min(Math.max(n,0),1)},a.exponentialInterp=function(e,t,n,r){return a.lerp(t,n,(Math.exp(e*Math.min(Math.max(r,0),1))-1)/(Math.exp(e)-1))},a.sinInterp=function(e,t,n){return e+(t-e)*Math.sin(Math.PI/2*n)},a.isApprxEqual=function(e,t,n){return Math.abs(t-e)<=n},a.stringToNumber=function(e){if(-1!==e.indexOf(".")&&-1!==e.indexOf("/"))return NaN;if(-1!==e.indexOf("."))return parseFloat(e);if(-1!==e.indexOf("/")){var t=e.split("/");return 2!==t.length?NaN:1*parseInt(t[0],10)/parseInt(t[1],10)}return parseInt(e)},a}();t.Operations=n});e(gp);gp.Operations;var vp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=F.unzip(e);this.xCoords=t[0],this.yCoords=t[1]}return e.prototype.evaluate=function(e){if(e>=this.xCoords[this.xCoords.length-1])return this.yCoords[this.xCoords.length-1];for(var t=this.xCoords.length-2;0<=t;--t)if(e>=this.xCoords[t])return gp.Operations.lerp(this.yCoords[t],this.yCoords[t+1],(e-this.xCoords[t])/(this.xCoords[t+1]-this.xCoords[t]));return this.yCoords[0]},e}();t.PiecewiseLinearFunction=n});e(vp);vp.PiecewiseLinearFunction;var Sp=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.evaluate=function(e){return t.prototype.evaluate.call(this,this.getXCoordWithinFunction(e))},e.prototype.getXCoordWithinFunction=function(e){var t=this.xCoords[this.xCoords.length-1]-this.xCoords[0],n=e-this.xCoords[0];if(0<=n&&n<t)return e;var r=n%t;return r<0&&(r+=t),r+this.xCoords[0]},e}(vp.PiecewiseLinearFunction);t.CyclicPiecewiseLinearFunction=i});e(Sp);Sp.CyclicPiecewiseLinearFunction;var bp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=F.unzip(e);this.xCoords=t[0],this.yCoords=t[1]}return e.prototype.evaluate=function(e){for(var t=this.xCoords.length-1;0<=t;t--)if(e>=this.xCoords[t])return this.yCoords[t];return this.yCoords[0]},e}();t.StepFunction=n});e(bp);bp.StepFunction;var Tp=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.evaluate=function(e){return t.prototype.evaluate.call(this,this.getXCoordWithinFunction(e))},e.prototype.getXCoordWithinFunction=function(e){var t=this.xCoords[this.xCoords.length-1]-this.xCoords[0],n=e-this.xCoords[0];if(0<=n&&n<t)return e;var r=n%t;return r<0&&(r+=t),r+this.xCoords[0]},e}(bp.StepFunction);t.CyclicStepFunction=i});e(Tp);Tp.CyclicStepFunction;var Pp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){void 0===e&&(e=Math.random),this.initialValue=0,this.exponentialFactor=1,this.randomizationFactor=0,this.maxValue=-1,this.random=e}return e.prototype.withInitialValue=function(e){return this.initialValue=e,this},e.prototype.withExponentialFactor=function(e){return this.exponentialFactor=e,this},e.prototype.withRandomizationFactor=function(e){return this.randomizationFactor=e,this},e.prototype.withMaxValue=function(e){return this.maxValue=e,this},e.prototype.getValue=function(e){var t=this.initialValue*Math.pow(this.exponentialFactor,e-1)+Math.floor(this.random()*this.randomizationFactor*e);return-1!==this.maxValue&&t>this.maxValue&&(t=this.maxValue),t},e}();t.CappedGeometricSequence=n});e(Pp);Pp.CappedGeometricSequence;var wp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.maxSamples=e,this.samples=[],this.reset()}return e.prototype.addSample=function(e){this.samples.length>=this.maxSamples&&this.samples.shift(),this.samples.push(e)},e.prototype.reset=function(){this.samples=[]},e.prototype.getAverage=function(e){var t=this.getSamplesInWindow(e);return 0===t.length?null:gp.Operations.average(t)},e.prototype.getStdDev=function(e){var t=this.getSamplesInWindow(e);return 0===t.length?null:gp.Operations.stdDev(t)},e.prototype.getSum=function(e){var t=this.getSamplesInWindow(e);return 0===t.length?null:t.reduce(function(e,t){return e+t},0)},e.prototype.getMinimum=function(e){var t=this.getSamplesInWindow(e);return 0===t.length?null:F.min(t)},e.prototype.getSamplesInWindow=function(e){return F.last(this.samples,Math.min(this.maxSamples,e))},e}();t.SampleAggregator=n});e(wp);wp.SampleAggregator;var Cp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.xSampleAggregator=new wp.SampleAggregator(e),this.ySampleAggregator=new wp.SampleAggregator(e)}return e.prototype.addPoint=function(e,t){this.xSampleAggregator.addSample(e),this.ySampleAggregator.addSample(t)},e.prototype.reset=function(){this.xSampleAggregator.reset(),this.ySampleAggregator.reset()},e.prototype.linearRegression=function(e){var t=this.xSampleAggregator.getSamplesInWindow(e),n=this.ySampleAggregator.getSamplesInWindow(e),r=t.length;if(r<2)return{slope:0,yIntercept:0,determinationCoefficient:0};for(var i=this.xSampleAggregator.getAverage(r),o=this.ySampleAggregator.getAverage(r),a=this.xSampleAggregator.getStdDev(r),s=this.ySampleAggregator.getStdDev(r),l=0,u=0,c=0;c<r;++c){var d=t[c]-i;l+=d*(n[c]-o),u+=d*d}if(0===u)return{slope:0,yIntercept:0,determinationCoefficient:0};var p,f=l/u;return{slope:f,yIntercept:o-f*i,determinationCoefficient:(p=Math.abs(s)<1e-6?0:f/(s/a))*p}},e}();t.LinearRegressionCalculator=n});e(Cp);Cp.LinearRegressionCalculator;var Mp=t(function(e,t){function r(e,t){for(var n=0,r=e[0],i=1;i<e.length;++i)t(e[i],r)<0&&(r=e[i],n=i);return n}function n(e,t,n){for(var r,i,o=0,a=e.length-1;o<=a;){if(0===(i=t(e[r=a+o>>1])))return r;i<0?a=r-1:o=r+1}return n?Math.max(a,0):-1}Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearchIndexOf=function(e,t){return n(e,t,!1)},t.binarySearchIndexOfClosestBelow=function(e,t){return n(e,t,!0)},t.indexOfMinimum=r,t.indexOfMaximum=function(e,n){return r(e,function(e,t){return-1*n(e,t)})}});e(Mp);Mp.binarySearchIndexOf,Mp.binarySearchIndexOfClosestBelow,Mp.indexOfMinimum,Mp.indexOfMaximum;var Ip=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("NumberLine"),n=function(){function a(e,t){void 0===e&&(e=Number.MIN_VALUE),void 0===t&&(t=e),this.intervals=[],this.epsilon=e,this.maxCollapsedGapSize=t}return a.prototype.clone=function(){var e=this.intervals.map(function(e){return{start:e.start,end:e.end}}),t=new a(this.epsilon,this.maxCollapsedGapSize);return t.intervals=e,t},a.prototype.add=function(t){var n=this;if(t.start>=t.end)o.warn("Ignoring attempt to add invalid interval ["+t.start+", "+t.end+"]. Stack: ",new Error("Invalid interval").stack);else{var e=Mp.binarySearchIndexOfClosestBelow(this.intervals,function(e){return n.compare(t.start,e.start,n.maxCollapsedGapSize)});for(e<this.intervals.length&&0<this.compare(t.start,this.intervals[e].start,this.maxCollapsedGapSize)&&e++,this.intervals.splice(e,0,{start:t.start,end:t.end}),0<e&&0<=this.compare(this.intervals[e-1].end,this.intervals[e].start,this.maxCollapsedGapSize)&&e--;e+1<this.intervals.length&&this.compare(this.intervals[e+1].start,this.intervals[e].end,this.maxCollapsedGapSize)<=0;)this.intervals[e].end=Math.max(this.intervals[e].end,this.intervals[e+1].end),this.intervals.splice(e+1,1)}},a.prototype.extendTo=function(e){var t=this.intervals[this.intervals.length-1];t.end<e&&(t.end=e)},a.prototype.remove=function(t){var e,n=this;if(t.start>=t.end)o.warn("Ignoring attempt to remove invalid interval ["+t.start+", "+t.end+"]. Stack: ",new Error("Invalid interval").stack);else for(var r=Mp.binarySearchIndexOfClosestBelow(this.intervals,function(e){return n.compare(t.start,e.start,n.epsilon)});r<this.intervals.length&&this.compare(this.intervals[r].start,t.end,this.epsilon)<=0;){var i=this.intervalDifference(this.intervals[r],t);(e=this.intervals).splice.apply(e,[r,1].concat(i)),r+=i.length}},a.prototype.find=function(t,n){var r=this;void 0===n&&(n=this.epsilon);var e=Mp.binarySearchIndexOf(this.intervals,function(e){return r.compare(t,e.start,n)<0?-1:0<r.compare(t,e.end,n)?1:0});return-1===e?null:this.intervals[e]},a.prototype.union=function(e){for(var t=new a(this.epsilon,this.maxCollapsedGapSize),n=0,r=0,i=-1;n<e.intervals.length||r<this.intervals.length;){var o=void 0;o=r>=this.intervals.length||n<e.intervals.length&&e.intervals[n].start<this.intervals[r].start?e.intervals[n++]:this.intervals[r++],-1===i||this.compare(t.intervals[i].end,o.start,this.maxCollapsedGapSize)<0?(t.intervals.push({start:o.start,end:o.end}),i++):t.intervals[i].end=Math.max(t.intervals[i].end,o.end)}return t},a.prototype.intersection=function(e){for(var t=new a(this.epsilon,this.maxCollapsedGapSize),n=0,r=0;n<this.intervals.length&&r<e.intervals.length;){var i=this.intervalIntersection(this.intervals[n],e.intervals[r]);null!==i&&t.intervals.push(i),0<this.compare(this.intervals[n].end,e.intervals[r].end,this.epsilon)?r++:n++}return t},a.prototype.shift=function(e){for(var t=new a(this.epsilon,this.maxCollapsedGapSize),n=0,r=this.intervals;n<r.length;n++){var i=r[n];t.add({start:i.start+e,end:i.end+e})}return t},a.prototype.bounds=function(){return 0===this.intervals.length?null:{start:this.intervals[0].start,end:this.intervals[this.intervals.length-1].end}},a.prototype.getIntervals=function(){return this.intervals},a.prototype.intervalIntersection=function(e,t){return this.compare(e.end,t.start,this.epsilon)<=0?null:0<=this.compare(e.start,t.end,this.epsilon)?null:{start:Math.max(e.start,t.start),end:Math.min(e.end,t.end)}},a.prototype.intervalDifference=function(e,t){return 0<this.compare(e.start,t.end,this.epsilon)||this.compare(e.end,t.start,this.epsilon)<0?[e]:0<=this.compare(e.start,t.start,this.epsilon)&&this.compare(e.end,t.end,this.epsilon)<=0?[]:this.compare(e.start,t.start,this.epsilon)<0&&0<this.compare(e.end,t.end,this.epsilon)?t.end-t.start>this.maxCollapsedGapSize?[{start:e.start,end:t.start},{start:t.end,end:e.end}]:[e]:this.compare(e.start,t.start,this.epsilon)<0?[{start:e.start,end:t.start}]:[{start:t.end,end:e.end}]},a.prototype.compare=function(e,t,n){var r=e-t;return r<-n?-1:n<r?1:0},a}();t.NumberLine=n});e(Ip);Ip.NumberLine;var Ep=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function s(e){this.itemHeap=[],this.comparator=e}return s.prototype.getItems=function(){return this.itemHeap.slice()},s.prototype.push=function(e){this.itemHeap.push(e),this.float(this.itemHeap.length-1)},s.prototype.remove=function(e){var t=this.itemHeap.indexOf(e);return-1!==t&&(t===this.itemHeap.length-1?this.itemHeap.pop():(this.itemHeap[t]=this.itemHeap.pop(),this.comparator(this.itemHeap[t],e)?this.float(t):this.sink(t)),!0)},s.prototype.pop=function(){if(0===this.itemHeap.length)return null;if(1===this.itemHeap.length)return this.itemHeap.pop();var e=this.itemHeap[0];return this.itemHeap[0]=this.itemHeap.pop(),this.sink(0),e},s.prototype.size=function(){return this.itemHeap.length},s.prototype.float=function(e){if(0!==e){var t=s.parent(e),n=this.itemHeap[t];this.comparator(this.itemHeap[e],n)&&(this.itemHeap[t]=this.itemHeap[e],this.itemHeap[e]=n,this.float(t))}},s.prototype.sink=function(e){if(e!==this.itemHeap.length-1){var t=s.leftChild(e),n=s.rightChild(e);if(!(t>=this.itemHeap.length)){var r=this.itemHeap[t],i=this.itemHeap[n],o=t,a=r;n<this.itemHeap.length&&this.comparator(i,r)&&(a=i,o=n),this.comparator(a,this.itemHeap[e])&&(this.itemHeap[o]=this.itemHeap[e],this.itemHeap[e]=a,this.sink(o))}}},s.leftChild=function(e){return 2*e+1},s.rightChild=function(e){return 2*e+2},s.parent=function(e){return e%2==1?(e-1)/2:(e-2)/2},s}();t.PriorityQueue=n});e(Ep);Ep.PriorityQueue;var _p=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.sampleCount=0,this.mean=null,this.M2=0}return e.prototype.addSample=function(e){if(this.sampleCount++,null===this.mean)this.mean=e,this.M2=0;else{var t=this.mean;this.mean+=(e-this.mean)/this.sampleCount,this.M2+=(e-t)*(e-this.mean)}},e.prototype.average=function(){return this.mean},e.prototype.stdDev=function(){return null===this.mean||0===this.sampleCount?null:Math.sqrt(this.M2/this.sampleCount)},e}();t.RunningSampleTracker=n});e(_p);_p.RunningSampleTracker;var xp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===t&&(t=F.now),this.eventTimestamps=[],this.windowLengthMs=e,this.now=t}return e.prototype.recordEvent=function(e){null==e&&(e=this.now()),this.eventTimestamps.push(e)},e.prototype.getEventCountInWindow=function(){return this.purgeRecordsOutsideWindow(),this.eventTimestamps.length},e.prototype.purgeRecordsOutsideWindow=function(){var t=this,n=this.now();this.eventTimestamps=F.filter(this.eventTimestamps,function(e){return n-e<=t.windowLengthMs})},e}();t.SlidingWindowEventTracker=n});e(xp);xp.SlidingWindowEventTracker;var kp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.samples=[],this.maxSamples=e}return e.prototype.addSample=function(e){this.samples.push(e),this.samples.length>this.maxSamples&&this.samples.shift()},e.prototype.getSamples=function(){return this.samples},e.prototype.reset=function(){this.samples=[]},e.prototype.average=function(){return 0===this.samples.length?null:gp.Operations.average(this.samples)},e.prototype.stdDev=function(){return 0===this.samples.length?null:gp.Operations.stdDev(this.samples)},e.prototype.sum=function(){if(0===this.samples.length)return null;for(var e=0,t=0,n=this.samples;t<n.length;t++){e+=n[t]}return e},e.prototype.size=function(){return this.samples.length},e}();t.WindowSampleTracker=n});e(kp);kp.WindowSampleTracker;var Rp={CappedGeometricSequence:Pp.CappedGeometricSequence,CyclicPiecewiseLinearFunction:Sp.CyclicPiecewiseLinearFunction,CyclicStepFunction:Tp.CyclicStepFunction,LinearRegressionCalculator:Cp.LinearRegressionCalculator,NumberLine:Ip.NumberLine,PiecewiseLinearFunction:vp.PiecewiseLinearFunction,PriorityQueue:Ep.PriorityQueue,RunningSampleTracker:_p.RunningSampleTracker,SampleAggregator:wp.SampleAggregator,SlidingWindowEventTracker:xp.SlidingWindowEventTracker,StepFunction:bp.StepFunction,WindowSampleTracker:kp.WindowSampleTracker,average:gp.Operations.average,clamp:yp.clamp,exponentialInterp:gp.Operations.exponentialInterp,isApprxEqual:gp.Operations.isApprxEqual,lerp:gp.Operations.lerp,sinInterp:gp.Operations.sinInterp,stdDev:gp.Operations.stdDev,stringToNumber:gp.Operations.stringToNumber},Ap=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("ExponentialBackoffRetry"),n=function(){function e(e){void 0===e&&(e=new Rp.CappedGeometricSequence);var i=this;this.executeCode=function(){try{i.callable(i.currentAttempt,i.handleRetry,i.handleSuccess,i.handleFail)}catch(e){i.handleFail(e)}},this.handleRetry=function(e,t){if(i.isAborted)o.error("Attempted to retry after aborted");else if(i.currentAttempt++,i.canStillRetry()){var n=i.delaySequence.getValue(i.currentAttempt);0!==n?i.retryTimeoutId=A.timer.setTimeout(i.executeCode,n):i.executeCode()}else null==e&&(e=new Ne.XpError("retry_limit")),i.handleFail(e,t)},this.handleSuccess=function(e){if(i.isAborted)o.error("Attempted to succeed after aborted");else for(var t=0,n=i.successCallbacks;t<n.length;t++){(0,n[t])(e)}},this.handleFail=function(e,t){if(i.isAborted)o.error("Attempted to fail after aborted");else for(var n=0,r=i.errorCallbacks;n<r.length;n++){(0,r[n])(e,t)}},this.maxAttempts=-1,this.maxElapsedTimeMs=-1,this.delaySequence=e,this.started=!1,this.isAborted=!1,this.currentAttempt=0,this.successCallbacks=[],this.errorCallbacks=[]}return e.prototype.withMaxAttempts=function(e){if(e<1)throw new Error("Expected maxAttempts ("+e+") >= 1");return this.maxAttempts=e,this},e.prototype.withMaxElapsedTimeMs=function(e){if(e<=0)throw new Error("Expected maxElapsedTimeMs ("+e+") > 0");return this.maxElapsedTimeMs=e,this},e.prototype.withInitialIntervalMs=function(e){if(e<0)throw new Error("Expected initialIntervalMs ("+e+") >= 0");return this.delaySequence.withInitialValue(e),this},e.prototype.withExponentialFactor=function(e){if(e<=0)throw new Error("Expected exponentialFactor ("+e+") > 0");return this.delaySequence.withExponentialFactor(e),this},e.prototype.withRandomizationFactor=function(e){if(e<0)throw new Error("Expected randomizationFactor ("+e+") >= 0");return this.delaySequence.withRandomizationFactor(e),this},e.prototype.withMaxDelayMs=function(e){if(e<=0)throw new Error("Expected maxDelayMs ("+e+") > 0");return this.delaySequence.withMaxValue(e),this},e.prototype.onSuccess=function(e){return this.successCallbacks.push(e),this},e.prototype.onError=function(e){return this.errorCallbacks.push(e),this},e.prototype.onAttempt=function(e){return this.callable=e,this},e.prototype.execute=function(){if(this.started)throw new Error("Already started");if(null==this.callable)throw new Error("onAttempt not called");return this.started=!0,this.startTime=Date.now(),this.executeCode(),this},e.prototype.abort=function(){this.isAborted=!0,null!=this.retryTimeoutId&&A.timer.clearTimeout(this.retryTimeoutId)},e.prototype.canStillRetry=function(){return!(-1!==this.maxAttempts&&this.currentAttempt>=this.maxAttempts)&&!(-1!==this.maxElapsedTimeMs&&Date.now()-this.startTime>=this.maxElapsedTimeMs)},e}();t.ExponentialBackoffRetry=n});e(Ap);Ap.ExponentialBackoffRetry;var Op=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ExponentialBackoffRetry=Ap.ExponentialBackoffRetry});e(Op);Op.ExponentialBackoffRetry;var Lp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l="BorgRequestError",u=[400,401,403,429],n=function(){function e(e,t,n,r,i,o,a){void 0===o&&(o=mp.HttpRequest),void 0===a&&(a=Op.ExponentialBackoffRetry),this.deviceId=e,this.deviceTypeId=t,this.marketplaceId=n,this.url=r.replace(/\/$/,"")+"/cdp/player/getDataByTransform/v1",this.locale=i,this.requestType=o,this.retryType=a}return e.prototype.invokeBorgTransform=function(n,r,i){var o,a=this,e=(new this.retryType).withMaxAttempts(4).withInitialIntervalMs(500).withExponentialFactor(2).withRandomizationFactor(200).onError(function(e){return a.onFail(i,e)}).onAttempt(function(e,t){o=a.sendRequest(n,e,t,r,i)}).execute();return function(){e.abort(),xt.exists(o)&&o.abort()}},e.prototype.sendRequest=function(e,t,i,n,o){var a=this,r=this.requestType.get(this.url+e.transformPath),s={deviceID:this.deviceId,deviceTypeID:this.deviceTypeId,entityIds:xt.withDefault(e.entityId,e.pageId),marketplaceId:this.marketplaceId,pageId:e.pageId,format:"json",pageType:"player",decorationScheme:xt.withDefault(e.decorationScheme,"none"),featureScheme:xt.withDefault(e.featureScheme,"none"),presentationScheme:xt.withDefault(e.presentationScheme,"none"),version:xt.withDefault(e.version,"default"),gascEnabled:Y.MarketplaceID.isClassic(this.marketplaceId)?"false":"true",uxLocale:this.locale};return r.accept("application/json").withCredentials().header("x-retry-count",""+t).header("x-request-priority","CRITICAL").onLoad(function(e){a.onLoad(e,i,n)}).onError(function(e,t){var n="An error occurred while sending Borg request: "+e,r=Ne.Errors.newError(l,n,e);xt.isNullOrUndefined(t)||!F.contains(u,t.getStatus())?i(r,t):a.onFail(o,r,t)}).query(s).send(),r},e.prototype.onLoad=function(t,n,e){var r=t.getText(),i=t.getLatencyMs();if(null!==r){var o;try{o=JSON.parse(r)}catch(e){var a="An error occurred while parsing the Borg JSON response: "+e;return void n(Ne.Errors.newError(l,a,e),t)}e(xt.nestedValue(o,"resource"),i)}else n(Ne.Errors.newError(l,"Borg response is null."),t)},e.prototype.onFail=function(e,t,n){var r;xt.exists(n)&&(r=n.getLatencyMs()),e(t,r)},e}();t.BorgClient=n});e(Lp);Lp.BorgClient;var Fp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BorgClient=Lp.BorgClient});e(Fp);Fp.BorgClient;var Dp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createCDPResponseProcessor=function(s){return function(e,t,n,r){var i=e.getText();if(null!==i){var o;try{o=JSON.parse(i)}catch(e){return void n(new Ne.XpError("parse",void 0,e.message,!1,e))}if("ERROR"!==xt.nestedValue(o,"message.statusCode"))try{s(o,t,n,r)}catch(e){n(new Ne.XpError("parse",void 0,e.message,!1,e))}else{var a=xt.nestedValue(o,"message.body.code","");r(new Ne.XpError("error_status",void 0,"statusCode='ERROR', code='"+a+"'"))}}else n(new Ne.XpError("null_response"))}}});e(Dp);Dp.createCDPResponseProcessor;var Np=Object.prototype.hasOwnProperty,Up=Object.prototype.toString,Bp=Object.defineProperty,Vp=Object.getOwnPropertyDescriptor,jp=function(e){return'function'==typeof Array.isArray?Array.isArray(e):'[object Array]'===Up.call(e)},Xp=function(e){if(!e||'[object Object]'!==Up.call(e))return!1;var t,n=Np.call(e,'constructor'),r=e.constructor&&e.constructor.prototype&&Np.call(e.constructor.prototype,'isPrototypeOf');if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||Np.call(e,t)},zp=function(e,t){Bp&&'__proto__'===t.name?Bp(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},qp=function(e,t){if('__proto__'===t){if(!Np.call(e,t))return;if(Vp)return Vp(e,t).value}return e[t]},Wp=function e(){var t,n,r,i,o,a,s=arguments[0],l=1,u=arguments.length,c=!1;for('boolean'==typeof s&&(c=s,s=arguments[1]||{},l=2),(null==s||'object'!=typeof s&&'function'!=typeof s)&&(s={});l<u;++l)if(null!=(t=arguments[l]))for(n in t)r=qp(s,n),s!==(i=qp(t,n))&&(c&&i&&(Xp(i)||(o=jp(i)))?(o?(o=!1,a=r&&jp(r)?r:[]):a=r&&Xp(r)?r:{},zp(s,{name:n,newValue:e(c,a,i)})):void 0!==i&&zp(s,{name:n,newValue:i}));return s},Hp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){void 0===r&&(r=[]);var i=this;this.eventEmitter=new Dt.EventEmitter,this.on=function(e,t){i.eventEmitter.on(e,t)},this.off=function(e,t){i.eventEmitter.off(e,t)},this.once=function(e,t){i.eventEmitter.once(e,t)},this.createRetry=e,this.createRequest=t,this.processResponse=n,this.unretriableHttpErrors=r}return e.prototype.send=function(e){var t=this.sendWithRetries(e),n={on:this.on,off:this.off,once:this.once,response:function(){return t}};return Fe.Promise.resolve(n)},e.prototype.sendWithRetries=function(i){var o=this;return new Fe.Promise(function(t,n){var r=o.createRetry().onSuccess(function(e){t(e)}).onError(function(e){n(e)}).onAttempt(function(e,t,n,r){o.emit("attempt",e),o.sendRequest(o.createRequest(e),e,i,t,n,r)}).execute();i.promise.then(function(e){r.abort(),n(e)})})},e.prototype.sendRequest=function(t,n,e,r,i,o){var a=this;t.onLoad(function(e){a.emit("latency",e.getLatencyMs()),a.emit("downloadTime",e.getDownloadMs()),a.emit("success",{url:e.getResponseUrl(),latencyMs:e.getLatencyMs(),downloadTimeMs:e.getDownloadMs(),status:e.getStatus(),totalBytes:null!=e.getMetrics()?e.getMetrics().totalBytes:0,headers:e.getHeaders(),attempt:n});try{a.processResponse(e,i,r,o)}catch(e){o(e)}}).onError(function(e,t){null!=t&&(a.emit("latency",t.getLatencyMs()),a.emit("fail",{error:e,url:t.getResponseUrl(),latencyMs:t.getLatencyMs(),downloadTimeMs:t.getDownloadMs(),status:t.getStatus(),totalBytes:null!=t.getMetrics()?t.getMetrics().totalBytes:0,headers:t.getHeaders()})),null!=t&&F.contains(a.unretriableHttpErrors,t.getStatus())?o(e):r(e)}).send(),e.promise.then(function(e){t.abort(),o(e)})},e.prototype.emit=function(e,t){this.eventEmitter.emit(e,t)},e}();t.RetriableHttpRequest=n});e(Hp);Hp.RetriableHttpRequest;var Gp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a={method:"GET",queryParams:{},headers:{},timeoutMs:4e3},s=[400,401,403],n=function(){function e(e,t,n,r,i){this.createRetry=function(){return(new Op.ExponentialBackoffRetry).withMaxAttempts(4).withInitialIntervalMs(500).withExponentialFactor(2).withRandomizationFactor(200)},this.url=e,this.serviceQueryParameters=t,this.responseProcessor=n,this.authContext=r,this.serviceClientPrefix=i}return e.prototype.send=function(e,t,n,r){var i=this;void 0===r&&(r=!0);var o=Wp(!0,{},a,{queryParams:this.serviceQueryParameters},e);return this.createRetriableRequest(o,n,r).send(t).then(function(e){var t=e.response;return e.response=function(){return t().catch(function(e){throw null!=i.serviceClientPrefix?Ne.XpError.generatePrefixedError(e,i.serviceClientPrefix):e})},e})},e.prototype.createRetriableRequest=function(n,r,i){var o=this;return new Hp.RetriableHttpRequest(this.createRetry,function(e){var t=new mp.HttpRequest(n.method,o.url).headers(n.headers).headers(o.authContext.getHeaders()).withCredentials().query(n.queryParams).timeout(n.timeoutMs);return null!=n.body&&t.body(n.body),(i||0<e)&&(t.header("x-retry-count",""+e),null!=r&&t.header("x-request-priority",r)),t},this.responseProcessor,s)},e}();t.BaseServiceClient=n});e(Gp);Gp.BaseServiceClient;var Kp=t(function(e,t){var o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){void 0===r&&(r=Gp.BaseServiceClient),this.baseServiceUrl=e.replace(/\/$/,""),this.parameters={};for(var i=0,o=Object.keys(t);i<o.length;i++){var a=o[i],s=t[a];null!=s&&(this.parameters[a]=s.toString())}this.authContext=n,this.baseServiceClientType=r}return e.prototype.createBasicServiceClient=function(e,t){return this.createServiceClient(e,t,function(e,t){t(e)})},e.prototype.createServiceClient=function(e,t,n,r){var i=this.baseServiceUrl+e;return new this.baseServiceClientType(i,o({},this.parameters,t),n,this.authContext,r)},e}();t.ServiceClientFactory=n});e(Kp);Kp.ServiceClientFactory;var Qp=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createCDPResponseProcessor=Dp.createCDPResponseProcessor,t.ServiceClientFactory=Kp.ServiceClientFactory,t.BaseServiceClient=Gp.BaseServiceClient,t.RetriableHttpRequest=Hp.RetriableHttpRequest});e(Qp);Qp.createCDPResponseProcessor,Qp.ServiceClientFactory,Qp.BaseServiceClient,Qp.RetriableHttpRequest;var Yp=t(function(e,t){var n,r,i,o,a,s,l,u,c,d;Object.defineProperty(t,"__esModule",{value:!0});var p=Qt.makeLocalizationInput({close:(n={},n[Qt.Locales.EN_US]="Close X-Ray",n[Qt.Locales.DE_DE]="X-Ray schließen",n[Qt.Locales.JA_JP]="X-Rayを閉じる",n[Qt.Locales.IT_IT]="Chiudi X-Ray",n[Qt.Locales.PT_BR]="Fechar X-Ray",n[Qt.Locales.ES_ES]="Cerrar X-Ray",n[Qt.Locales.FR_FR]="Fermer X-Ray",n[Qt.Locales.NL_NL]="X-Ray sluiten",n[Qt.Locales.DA_DK]="Tilbage",n[Qt.Locales.NB_NO]="Tilbake",n[Qt.Locales.PL_PL]="Wróć",n[Qt.Locales.SV_SE]="Stäng X-Ray",n[Qt.Locales.HI_IN]="X-Ray बंद करें",n[Qt.Locales.TA_IN]="X-Ray மூடுக",n[Qt.Locales.TE_IN]="X-Ray మూసివేయండి",n[Qt.Locales.ZH_TW]="關閉 X-Ray",n[Qt.Locales.ZH_CN]="关闭 X-Ray",n[Qt.Locales.ID_ID]="Tutup X-Ray",n[Qt.Locales.FI_FI]="Sulje X-Ray",n[Qt.Locales.TR_TR]="X-Ray özelliğini kapat",n[Qt.Locales.RU_RU]="Закрыть X-Ray",n[Qt.Locales.KO_KR]="엑스레이 닫기",n[Qt.Locales.TH_TH]="ปิด X-Ray",n),exitFullscreen:(r={},r[Qt.Locales.EN_US]="Exit Fullscreen",r[Qt.Locales.DE_DE]="Vollbild schließen",r[Qt.Locales.JA_JP]="全画面表示を終了",r[Qt.Locales.IT_IT]="Esci dalla modalità schermo intero",r[Qt.Locales.PT_BR]="Sair da tela cheia",r[Qt.Locales.ES_ES]="Salir de pantalla completa",r[Qt.Locales.FR_FR]="Quitter le mode plein écran",r[Qt.Locales.NL_NL]="Volledig scherm afsluiten",r[Qt.Locales.DA_DK]="Afslut fuld skærm",r[Qt.Locales.NB_NO]="Avslutt fullskjerm",r[Qt.Locales.PL_PL]="Zamknij pełny ekran",r[Qt.Locales.SV_SE]="Avsluta helskärm",r[Qt.Locales.HI_IN]="फुल स्क्रीन से बाहर निकलें",r[Qt.Locales.TA_IN]="முழுத்திரையில் இருந்து வெளிவருக",r[Qt.Locales.TE_IN]="ఫుల్ స్క్రీన్ నుండి నిష్క్రమించండి",r[Qt.Locales.ZH_TW]="退出全螢幕",r[Qt.Locales.ZH_CN]="退出全屏",r[Qt.Locales.ID_ID]="Keluar dari Layar Penuh",r[Qt.Locales.FI_FI]="Poistu koko näytöstä",r[Qt.Locales.TR_TR]="Tam Ekrandan Çık",r[Qt.Locales.RU_RU]="Покинуть полноэкранный режим",r[Qt.Locales.KO_KR]="전체 화면 종료",r[Qt.Locales.TH_TH]="ออกจากแบบเต็มจอ",r),fullscreen:(i={},i[Qt.Locales.EN_US]="Fullscreen",i[Qt.Locales.DE_DE]="Vollbild",i[Qt.Locales.JA_JP]="全画面表示",i[Qt.Locales.IT_IT]="Schermo intero",i[Qt.Locales.PT_BR]="Tela cheia",i[Qt.Locales.ES_ES]="Pantalla completa",i[Qt.Locales.FR_FR]="Plein écran",i[Qt.Locales.NL_NL]="Volledig scherm",i[Qt.Locales.DA_DK]="Fuld skærm",i[Qt.Locales.NB_NO]="Fullskjerm",i[Qt.Locales.PL_PL]="Pełny ekran",i[Qt.Locales.SV_SE]="Helskärm",i[Qt.Locales.HI_IN]="फुल स्क्रीन",i[Qt.Locales.TA_IN]="முழுத்திரை",i[Qt.Locales.TE_IN]="ఫుల్ స్క్రీన్",i[Qt.Locales.ZH_TW]="全螢幕",i[Qt.Locales.ZH_CN]="全屏",i[Qt.Locales.ID_ID]="Layar Penuh",i[Qt.Locales.FI_FI]="Koko näyttö",i[Qt.Locales.TR_TR]="Tam Ekran",i[Qt.Locales.RU_RU]="Полный экран",i[Qt.Locales.KO_KR]="전체 화면",i[Qt.Locales.TH_TH]="เต็มจอ",i),navbar:{logo:(o={},o[Qt.Locales.EN_US]="X-Ray",o[Qt.Locales.DE_DE]="X-Ray",o[Qt.Locales.JA_JP]="X-Ray",o[Qt.Locales.IT_IT]="X-Ray",o[Qt.Locales.PT_BR]="X-Ray",o[Qt.Locales.ES_ES]="X-Ray",o[Qt.Locales.FR_FR]="X-Ray",o[Qt.Locales.NL_NL]="X-Ray",o[Qt.Locales.DA_DK]="X-Ray",o[Qt.Locales.NB_NO]="X-Ray",o[Qt.Locales.PL_PL]="X-Ray",o[Qt.Locales.SV_SE]="X-Ray",o[Qt.Locales.HI_IN]="X-Ray",o[Qt.Locales.TA_IN]="X-Ray",o[Qt.Locales.TE_IN]="X-Ray",o[Qt.Locales.ZH_TW]="X-Ray",o[Qt.Locales.ZH_CN]="X-Ray",o[Qt.Locales.ID_ID]="X-Ray",o[Qt.Locales.FI_FI]="X-Ray",o[Qt.Locales.TR_TR]="X-Ray",o[Qt.Locales.RU_RU]="X-Ray",o[Qt.Locales.KO_KR]="X-Ray",o[Qt.Locales.TH_TH]="X-Ray",o)},photoGallery:{count:(a={},a[Qt.Locales.EN_US]="{{current}} of {{total}}",a[Qt.Locales.DE_DE]="{{current}} von {{total}}",a[Qt.Locales.JA_JP]="{{current}}/{{total}}",a[Qt.Locales.IT_IT]="{{current}} di {{total}}",a[Qt.Locales.PT_BR]="{{current}} de {{total}}",a[Qt.Locales.ES_ES]="{{current}} de {{total}}",a[Qt.Locales.FR_FR]="{{current}} sur {{total}}",a[Qt.Locales.NL_NL]="{{current}} van {{total}}",a[Qt.Locales.DA_DK]="{{current}} af {{total}}",a[Qt.Locales.NB_NO]="{{current}} av {{total}}",a[Qt.Locales.PL_PL]="{{current}} z {{total}}",a[Qt.Locales.SV_SE]="{{current}} av {{total}}",a[Qt.Locales.HI_IN]="{{total}} में से {{current}}",a[Qt.Locales.TA_IN]="{{current}} / {{total}}",a[Qt.Locales.TE_IN]="{{total}} లో {{current}}",a[Qt.Locales.ZH_TW]="{{current}}/{{total}}",a[Qt.Locales.ZH_CN]="{{current}}/{{total}}",a[Qt.Locales.ID_ID]="{{current}} dari {{total}}",a[Qt.Locales.FI_FI]="{{current}} / {{total}}",a[Qt.Locales.TR_TR]="{{current}} / {{total}}",a[Qt.Locales.RU_RU]="{{current}} из {{total}}",a[Qt.Locales.KO_KR]="{{current}}/{{total}}",a[Qt.Locales.TH_TH]="{{current}} จาก {{total}}",a),exit:(s={},s[Qt.Locales.EN_US]="Exit Gallery",s[Qt.Locales.ES_MX]="Salir de galería",s[Qt.Locales.DE_DE]="Galerie verlassen",s[Qt.Locales.JA_JP]="ギャラリーを閉じる",s[Qt.Locales.IT_IT]="Esci dalla galleria",s[Qt.Locales.PT_BR]="Sair da galeria",s[Qt.Locales.ES_ES]="Salir de la galería",s[Qt.Locales.FR_FR]="Quitter la galerie",s[Qt.Locales.NL_NL]="Galerij afsluiten",s[Qt.Locales.DA_DK]="Afslut galleri",s[Qt.Locales.NB_NO]="Avslutt galleri",s[Qt.Locales.PL_PL]="Zamknij galerię",s[Qt.Locales.SV_SE]="Avsluta galleriet",s[Qt.Locales.HI_IN]="गैलरी से बाहर निकलें",s[Qt.Locales.TA_IN]="கேலரியிலிருந்து வெளியேறு",s[Qt.Locales.TE_IN]="గ్యాలరీని నిష్క్రమించండి",s[Qt.Locales.ZH_TW]="退出相片庫",s[Qt.Locales.ZH_CN]="退出图库",s[Qt.Locales.ID_ID]="Keluar dari Galeri",s[Qt.Locales.FI_FI]="Poistu galleriasta",s[Qt.Locales.TR_TR]="Galeriden Çık",s[Qt.Locales.RU_RU]="Выйти из Галереи",s[Qt.Locales.KO_KR]="갤러리 닫기",s[Qt.Locales.TH_TH]="ออกจากแกลเลอรี",s)},backText:(l={},l[Qt.Locales.EN_US]="Back",l[Qt.Locales.DE_DE]="Zurück",l[Qt.Locales.JA_JP]="戻る",l[Qt.Locales.IT_IT]="Indietro",l[Qt.Locales.PT_BR]="Voltar",l[Qt.Locales.ES_ES]="Volver",l[Qt.Locales.FR_FR]="Retour",l[Qt.Locales.NL_NL]="Terug",l[Qt.Locales.DA_DK]="Tilbage",l[Qt.Locales.NB_NO]="Tilbake",l[Qt.Locales.PL_PL]="Wróć",l[Qt.Locales.SV_SE]="Tillbaka",l[Qt.Locales.HI_IN]="पीछे",l[Qt.Locales.TA_IN]="பின்செல்",l[Qt.Locales.TE_IN]="వెనక్కు",l[Qt.Locales.ZH_TW]="返回",l[Qt.Locales.ZH_CN]="返回",l[Qt.Locales.ID_ID]="Kembali",l[Qt.Locales.FI_FI]="Takaisin",l[Qt.Locales.TR_TR]="Geri",l[Qt.Locales.RU_RU]="Назад",l[Qt.Locales.KO_KR]="뒤로",l[Qt.Locales.TH_TH]="กลับ",l),textViewSeeMore:(u={},u[Qt.Locales.EN_US]="Read More",u[Qt.Locales.ES_MX]="Leer más",u[Qt.Locales.DE_DE]="Mehr",u[Qt.Locales.JA_JP]="もっと見る",u[Qt.Locales.IT_IT]="Più dettagli",u[Qt.Locales.PT_BR]="Ler mais",u[Qt.Locales.ES_ES]="Ver más",u[Qt.Locales.FR_FR]="Afficher plus",u[Qt.Locales.NL_NL]="Meer lezen",u[Qt.Locales.DA_DK]="Læs mere",u[Qt.Locales.NB_NO]="Les mer",u[Qt.Locales.PL_PL]="Przeczytaj więcej",u[Qt.Locales.SV_SE]="Läs mer",u[Qt.Locales.HI_IN]="और पढ़ें",u[Qt.Locales.TA_IN]="கூடுதலாய் படி",u[Qt.Locales.TE_IN]="మరిన్ని చదవండి",u[Qt.Locales.ZH_TW]="閱讀更多",u[Qt.Locales.ZH_CN]="阅读更多",u[Qt.Locales.ID_ID]="Baca Lebih Banyak",u[Qt.Locales.FI_FI]="Lue lisää",u[Qt.Locales.TR_TR]="Daha Fazla Oku",u[Qt.Locales.RU_RU]="Читать больше",u[Qt.Locales.KO_KR]="더보기",u[Qt.Locales.TH_TH]="อ่านเพิ่ม",u),textViewSeeLess:(c={},c[Qt.Locales.EN_US]="Read Less",c[Qt.Locales.ES_MX]="Leer menos",c[Qt.Locales.DE_DE]="Weniger",c[Qt.Locales.JA_JP]="元に戻す",c[Qt.Locales.IT_IT]="Meno dettagli",c[Qt.Locales.PT_BR]="Ler menos",c[Qt.Locales.ES_ES]="Ver menos",c[Qt.Locales.FR_FR]="Afficher moins",c[Qt.Locales.NL_NL]="Minder lezen",c[Qt.Locales.DA_DK]="Læs mindre",c[Qt.Locales.NB_NO]="Les mindre",c[Qt.Locales.PL_PL]="Przeczytaj mniej",c[Qt.Locales.SV_SE]="Läs mindre",c[Qt.Locales.HI_IN]="कम पढ़ें",c[Qt.Locales.TA_IN]="குறைவாய் படி",c[Qt.Locales.TE_IN]="తక్కువ చదవండి",c[Qt.Locales.ZH_TW]="精簡閱讀",c[Qt.Locales.ZH_CN]="阅读更少",c[Qt.Locales.ID_ID]="Baca Lebih Sedikit",c[Qt.Locales.FI_FI]="Lue vähemmän",c[Qt.Locales.TR_TR]="Daha Az Oku",c[Qt.Locales.RU_RU]="Читать меньше",c[Qt.Locales.KO_KR]="적게보기",c[Qt.Locales.TH_TH]="อ่านน้อยลง",c),swiftErrorMessage:(d={},d[Qt.Locales.EN_US]="We're unable to show this content. Please try again later.",d[Qt.Locales.ES_MX]="No podemos mostrar este contenido. Inténtalo de nuevo más tarde.",d[Qt.Locales.DE_DE]="Dieser Inhalt kann leider nicht gezeigt werden. Bitte versuchen Sie es später erneut.",d[Qt.Locales.JA_JP]="このコンテンツは表示できません。後でもう一度お試しください。",d[Qt.Locales.IT_IT]="Impossibile visualizzare il contenuto. Riprova più tardi.",d[Qt.Locales.PT_BR]="Não foi possível mostrar este conteúdo. Tente novamente mais tarde.",d[Qt.Locales.ES_ES]="No podemos mostrar este contenido. Vuelve a intentarlo más tarde.",d[Qt.Locales.FR_FR]="Impossible d'afficher ce contenu. Veuillez réessayer ultérieurement.",d[Qt.Locales.NL_NL]="We kunnen deze content niet tonen. Probeer het later opnieuw.",d[Qt.Locales.DA_DK]="Vi kan ikke vise dette indhold. Prøv igen senere.",d[Qt.Locales.NB_NO]="Vi kan ikke vise dette innholdet. Prøv igjen senere.",d[Qt.Locales.PL_PL]="Nie można wyświetlić tej treści. Spróbuj ponownie później.",d[Qt.Locales.SV_SE]="Innehållet kan inte visas. Försök igen senare.",d[Qt.Locales.HI_IN]="हम यह कंटेंट नहीं दिखा सकते. कृपया बाद में फिर से कोशिश करें.",d[Qt.Locales.TA_IN]="இந்த உள்ளடக்கத்தைக் காட்ட இயலவில்லை. பின்னர் மீண்டும் முயற்சித்திடுக.",d[Qt.Locales.TE_IN]="ఈ కంటెంట్ ని మేము చూపలేకపోతున్నాము దయచేసి తర్వాత మళ్లీ ప్రయత్నించండి.",d[Qt.Locales.ZH_TW]="我們無法顯示此內容。請稍後再試。",d[Qt.Locales.ZH_CN]="我们无法显示此内容。请稍后重试。",d[Qt.Locales.ID_ID]="Kami tidak dapat menampilkan konten ini. Harap coba lagi nanti.",d[Qt.Locales.FI_FI]="Tätä sisältöä ei voida näyttää. Yritä myöhemmin uudestaan.",d[Qt.Locales.TR_TR]="Bu içeriği gösteremiyoruz. Lütfen daha sonra tekrar deneyin.",d[Qt.Locales.RU_RU]="Этот контент недоступен. Попробуйте позже.",d[Qt.Locales.KO_KR]="이 콘텐츠를 표시할 수 없습니다. 나중에 다시 시도하세요.",d[Qt.Locales.TH_TH]="ไม่สามารถแสดงเนื้อหานี้ได้ โปรดลองอีกครั้งในภายหลัง",d)});t.Localization=p});e(Yp);Yp.Localization;var Jp,$p,Zp=function(){function e(){}return e.prototype.validate=function(e){return null},e.INSTANCE=new e,e}(),ef=S.of("ArrayValidator"),tf=M.get("ArrayValidator"),nf=function(){function e(e){this.memberValidator=ef(e,"memberValidator").exists()}return e.prototype.validate=function(e){if(null==e)return null;if(!F.isArray(e))return tf.error("Not an array: "+e),null;for(var t=e,n=[],r=0;r<t.length;r++){var i=this.memberValidator.validate(t[r]);null!==i&&n.push(i)}return n},e}(),rf=M.get("BooleanValidator"),of=function(){function e(){}return e.prototype.validate=function(e){return null==e?null:F.isBoolean(e)?e:(rf.error("Value not a boolean: "+e),null)},e}(),af=M.get("DateValidator"),sf=function(){function e(){}return e.prototype.validate=function(e){if(null==e)return null;if(!F.isString(e)&&!F.isNumber(e))return af.error("Not a string or number: "+e),null;var t=new Date(e);return isNaN(t.getDate())?(af.error("Not parseable into a valid date: "+e),null):t},e}(),lf=M.get("NumberValidator"),uf=function(){function e(){}return e.prototype.validate=function(e){return null==e?null:F.isNumber(e)?e:(lf.error("Not a number: "+e),null)},e}(),cf=M.get("StringValidator"),df=function(){function e(){}return e.prototype.validate=function(e){return null==e?null:F.isString(e)?e:(cf.error("Not a string: "+e),null)},e}(),pf=function(){function e(){}return e.BOOLEAN=new of,e.DATE=new sf,e.NUMBER=new uf,e.STRING=new df,e}(),ff=S.of("EnumValidator"),hf=M.get("EnumValidator"),mf=function(){function e(e){this.enumModule=ff(e,"enumModule").exists()}return e.prototype.validate=function(e){return null==e?null:F.isString(e)?F.chain(this.enumModule).values().contains(e).value()?e:(hf.error("Unknown enum member: "+e),null):(hf.error("Not a string: "+e),null)},e}(),yf=function(){function e(){}return e.parseId=function(e){return null==e?e:e.match(this.DEVICE_PROXY_ID_PATTERN)?e.replace(this.DEVICE_PROXY_ID_PATTERN,"$2#$1"):e},e.DEVICE_PROXY_ID_PATTERN=/(^[^:]+).+\/coral\/([a-zA-Z0-9_\.]+)\//,e}(),gf=S.of("InterfaceValidator"),vf=M.get("InterfaceValidator"),Sf=function(){function e(){this.validationSpecs={}}return e.prototype.validate=function(e){return F.has(e,"__type")?this.validateInternal(e,e.__type):(vf.error("Has no __type member: "+e),null)},e.prototype.forId=function(t){var n=this;return gf(t,"coralId").exists(),{validate:function(e){return F.has(e,"__type")?n.validateInternal(e,e.__type):n.validateInternal(e,t)}}},e.prototype.isA=function(e,t,n){if(null==e)return!1;gf(t,"coralId").exists();var r=null==n?e.__type:n;if(!F.isString(r))return!1;if(r===t)return!0;if(F.has(this.validationSpecs,r)){var i=this.validationSpecs[r];if(null!=i.superType)return this.isA(e,t,i.superType)}return!1},e.prototype.validateInternal=function(e,t){if(null==e)return null;if(!F.isObject(e))return vf.error("Not an object: "+e),null;var n=yf.parseId(t);if(!F.has(this.validationSpecs,n))return vf.error("No spec for model: "+n),null;var r,i=this.validationSpecs[n];if(null==i.superType)r={};else if(null===(r=this.validateInternal(e,i.superType)))return null;for(var o in i.members)if(F.has(i.members,o)){var a=i.members[o];if(r[o]=a.validator.validate(e[o]),!0===a.isRequired&&null===r[o])return vf.error("Model ("+n+") lacks required member: "+o),null}return r.__type=n,r},e}(),bf=S.of("ObjectValidator"),Tf=M.get("ObjectValidator"),Pf={AlwaysNullValidator:Zp,ArrayValidator:nf,BasicValidators:pf,EnumValidator:mf,InterfaceValidator:Sf,ObjectValidator:function(){function e(e){this.memberValidator=bf(e,"memberValidator").exists()}return e.prototype.validate=function(e){if(null==e)return null;if(!F.isObject(e))return Tf.error("Not an object: "+e),null;var t=e,n={};for(var r in t)if(F.has(t,r)){var i=this.memberValidator.validate(t[r]);null!==i&&(n[r]=i)}return n},e}()},wf=V&&V.__extends||(Jp=function(e,t){return(Jp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Jp(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});!function(e){var n,t,r,i,o,a,s,l,u,c,d,p,f,h,m,y,g,v,S,b,T,P,w,C,M,I,E,_,x,k,R,A,O,L,F;t=n=e.com||(e.com={}),r=t.amazon||(t.amazon={}),i=r.atv||(r.atv={}),(o=i.discovery||(i.discovery={})).Action="com.amazon.atv.discovery#Action",(a=o.ActionType||(o.ActionType={})).COLLECTION_REFRESH="collectionItemsRefresh",a.NAVIGATIONAL="navigational",a.PAGINATION="pagination",a.REMOVE="remove",o.Analytics="com.amazon.atv.discovery#Analytics",o.BaseResponse="com.amazon.atv.discovery#BaseResponse",o.Blueprint="com.amazon.atv.discovery#Blueprint",o.BlueprintedItem="com.amazon.atv.discovery#BlueprintedItem",o.BreadCrumbBase="com.amazon.atv.discovery#BreadCrumbBase",o.CacheControlPolicy="com.amazon.atv.discovery#CacheControlPolicy",o.CacheRefreshEvent="com.amazon.atv.discovery#CacheRefreshEvent",(s=o.CollectionActionType||(o.CollectionActionType={})).MORE="more",s.ZOOMIN="zoomIn",s.ZOOMOUT="zoomOut",o.CollectionBase="com.amazon.atv.discovery#CollectionBase",o.CollectionV2="com.amazon.atv.discovery#CollectionV2",(o.ContentTrait||(o.ContentTrait={})).CUSTOMER_LOCATION_DEPENDENT="customerLocationDependent",o.DataWidget="com.amazon.atv.discovery#DataWidget",o.DebugAttribute="com.amazon.atv.discovery#DebugAttribute",o.DebugInfo="com.amazon.atv.discovery#DebugInfo",(l=o.DebugLevel||(o.DebugLevel={})).DEBUG="DEBUG",l.ERROR="ERROR",l.INFO="INFO",l.NONE="NONE",l.WARN="WARN",(u=o.DebugType||(o.DebugType={})).AUTOBOT_TRANSACTION="AUTOBOT_TRANSACTION",u.CHURCHILL_TRANSACTION="CHURCHILL_TRANSACTION",u.COLLECTION="COLLECTION",u.CUSTOMER_INFO="CUSTOMER_INFO",u.LOG="LOG",u.REQUEST_INFO="REQUEST_INFO",u.SCHEDULING_LOGS="SCHEDULING_LOGS",(c=o.EventType||(o.EventType={})).CURRENTTERRITORY="currentTerritory",c.DOWNLOAD="download",c.LISTREMOVE="listRemove",c.MARKETPLACE="marketplace",c.OWNERSHIP="ownership",c.PARENTALCONTROL="parentalControl",c.PLAYBACK="playback",c.PREFERREDLANGUAGECHANGE="preferredLanguageChange",c.RECORDTERRITORY="recordTerritory",c.SUBSCRIPTION="subscription",c.WATCHLIST="watchlist",o.FiltersBase="com.amazon.atv.discovery#FiltersBase",o.GetPageResponse="com.amazon.atv.discovery#GetPageResponse",o.GetWidgetsResponse="com.amazon.atv.discovery#GetWidgetsResponse",o.Image="com.amazon.atv.discovery#Image",o.ImageSize="com.amazon.atv.discovery#ImageSize",(d=o.ImageSizeUnit||(o.ImageSizeUnit={})).PX="px",d.RATIO="ratio",o.ImageTextLink="com.amazon.atv.discovery#ImageTextLink",(p=o.ImageType||(o.ImageType={})).PRIMARY="PRIMARY",p.SECONDARY="SECONDARY",p.TERTIARY="TERTIARY",o.Item="com.amazon.atv.discovery#Item",(f=o.ItemType||(o.ItemType={})).ADS_TITLE_CARD="adsTitleCard",f.BENEFIT_CARD="benefitCard",f.BLUEPRINTED_ITEM="blueprintedItem",f.DETAIL_HEADER="detailHeader",f.HERO_TITLE="heroTitle",f.IMAGE_LINK="imageLink",f.IMAGE_TEXT_LINK="imageTextLink",f.LIVE_CARD="liveCard",f.LIVE_CHANNEL_CARD="liveChannelCard",f.LIVE_LINEAR_CARD="liveLinearCard",f.PERSON="person",f.PLACE_HOLDER="placeHolder",f.RELATED_COLLECTION_BLUEPRINTED_ITEM="relatedCollectionBlueprintedItem",f.ROTATOR_ITEM="rotatorItem",f.SPLASH_IMAGE="splashImage",f.TEXT_LINK="textLink",f.TITLE_CARD="titleCard",f.VIDEO_ROLL="videoRoll",f.XRAY_GRAPHED_ITEM="xrayGraphedItem",f.XRAY_RELATED_COLLECTION_WITH_ICONS_BLUEPRINTED_ITEM="xrayRelatedCollectionWithIconsBlueprintedItem",f.XRAY_SCOREBOARD_ITEM="xrayScoreboardItem",f.XRAY_TRICKPLAY_ITEM="xrayTrickplayItem",o.ItemsBase="com.amazon.atv.discovery#ItemsBase",o.ItemsV2="com.amazon.atv.discovery#ItemsV2",(h=o.LinkActionType||(o.LinkActionType={})).PRIMARY="PRIMARY",h.SECONDARY="SECONDARY",h.TERTIARY="TERTIARY",o.LinkItem="com.amazon.atv.discovery#LinkItem",(m=o.LinkType||(o.LinkType={})).BROWSE="browse",m.CLIENT_SEARCH_INPUT="clientSearchInput",m.DEREGISTRATION="deregistration",m.DETAIL="detail",m.DOWNLOADS="downloads",m.ENTITY="entity",m.EXTERNALAPP="externalApp",m.EXTERNALLINK="externalLink",m.HELP="help",m.HOME="home",m.INAPPLINK="inAppLink",m.INAPPMESSAGE="inAppMessage",m.LANDING="landing",m.NONE="none",m.PLAYER="player",m.PRIMESIGNUP="primeSignup",m.RECENTLYWATCHED="recentlyWatched",m.REGISTRATION="registration",m.SEARCH="search",m.SETTINGS="settings",m.SHOWCASE="showcase",m.SIGNUP="signup",m.WATCHLIST="watchlist",m.XRAY="xray",m.YVL="yvl",m.ZOOM_IN="zoomIn",o.NavigationalAction="com.amazon.atv.discovery#NavigationalAction",o.NavigationalActionBase="com.amazon.atv.discovery#NavigationalActionBase",o.NavigationalActionV2="com.amazon.atv.discovery#NavigationalActionV2",o.NavigationsBase="com.amazon.atv.discovery#NavigationsBase",o.NavigationsV2="com.amazon.atv.discovery#NavigationsV2",o.PageBase="com.amazon.atv.discovery#PageBase",(y=o.PageType||(o.PageType={})).AMAZON_TV="amazontv",y.BACKGROUND_PAGE="background",y.BROWSE_PAGE="browse",y.CUSTOMER_ENGAGEMENT_PAGE="AVCustomerEngagement",y.DETAIL_PAGE="detail",y.ENTITY_PAGE="entity",y.FEATURE_ROTATOR="featurerotator",y.HOME_LANDING_PAGE="home",y.IMDB_TV_APP_BROWSE="IMDbTVAppBrowse",y.IMDB_TV_APP_EPG="IMDbTVAppEPG",y.IMDB_TV_APP_LINEAR_DETAIL="IMDbTVAppLinearDetail",y.IMDB_TV_APP_VOD_DETAIL="IMDbTVAppVODDetail",y.KIDS_PAGE="kids",y.LAUNCHER_PAGE="launcher",y.LEAGUE_PAGE="league",y.MERCH_PAGE="merch",y.MOVIE_LANDING_PAGE="movie",y.OPTIONAL_PAGE="optPage",y.OPT_MERCH_PAGE="optMerch",y.OTHER_PAGE="externalLink",y.PARTICIPANT_PAGE="participant",y.PARTNER_PAGE="partner",y.PERSONALIZED_MERCH_PAGE="personalizedMerch",y.PLAYER_PAGE="player",y.PRIME_LANDING_PAGE="prime",y.PRIME_VALUE_EXPERIENCE_PAGE="primeValueExperience",y.SEARCH_PAGE="search",y.SETTINGS_PAGE="settings",y.SHOP_LANDING_PAGE="shop",y.SHORTS_PAGE="shorts",y.SPORT_PAGE="sport",y.SUBSCRIPTION_PAGE="subscription",y.TOURNAMENT_PAGE="tournament",y.TV_LANDING_PAGE="tv",y.TWITCH_WATCH_PARTIES_PAGE="twitchwp",y.VIDEO_WIZARD_PAGE="videowizard",y.WATCHLIST_PAGE="watchlist",y.XRAY_PAGE="xray",y.YVL_PAGE="yvl",o.PageV2="com.amazon.atv.discovery#PageV2",o.PaginationActionBase="com.amazon.atv.discovery#PaginationActionBase",o.PrefetchPolicy="com.amazon.atv.discovery#PrefetchPolicy",o.RelatedCollectionBlueprintedItem="com.amazon.atv.discovery#RelatedCollectionBlueprintedItem",o.SectionBase="com.amazon.atv.discovery#SectionBase",(g=o.SectionType||(o.SectionType={})).BOTTOM="bottom",g.CENTER="center",g.GLOBAL_NAVIGATION="globalNavigation",g.LEFT="left",g.PAGE_NAVIGATION="pageNavigation",g.RIGHT="right",g.TITLE_CONTENT="titleContent",g.TITLE_HEADER="titleHeader",g.TOP="top",o.SectionV2="com.amazon.atv.discovery#SectionV2",o.SortsBase="com.amazon.atv.discovery#SortsBase",o.SubstitutionParameter="com.amazon.atv.discovery#SubstitutionParameter",(v=o.TextType||(o.TextType={})).PRIMARY="PRIMARY",v.QUATERNARY="QUATERNARY",v.SECONDARY="SECONDARY",v.TERTIARY="TERTIARY",o.TimeToLive="com.amazon.atv.discovery#TimeToLive",(S=o.UpdatePolicyType||(o.UpdatePolicyType={})).NEVER_STALE="neverStale",S.STALE_IF_ERROR="staleIfError",S.STALE_WHILE_REFRESH="staleWhileRefresh",o.Widget="com.amazon.atv.discovery#Widget",o.WidgetGroup="com.amazon.atv.discovery#WidgetGroup",(b=o.WidgetType||(o.WidgetType={})).ADS_CAROUSEL="adsCarousel",b.BANNER_CAROUSEL="bannerCarousel",b.CAROUSEL="carousel",b.COLLECTION="collection",b.DATA_WIDGET="dataWidget",b.FACETED_CAROUSEL="facetedCarousel",b.GRID="grid",b.HERO_CAROUSEL="heroCarousel",b.ITEMS_WIDGETS="itemsWidget",b.NAVIGATIONS="navigations",b.VERTICAL_LIST="verticalList",b.WIDGET_GROUP="widgetGroup",o.Widgets="com.amazon.atv.discovery#Widgets",T=r.avod||(r.avod={}),P=T.xray||(T.xray={}),(w=P.BlueprintIds||(P.BlueprintIds={})).CAROUSEL="Carousel",w.CAROUSEL_CONTAINER="CarouselContainer",w.CAROUSEL_MINI_DETAILS="CarouselMiniDetails",w.COLLAPSIBLE_VERTICAL_LIST="CollapsibleVerticalList",w.DETAIL_TAB="DetailTab",w.EXPANDABLE_TEXT="ExpandableText",w.GRID="Grid",w.HORIZONTAL_LAYOUT="HorizontalLayout",w.LABELLED_COLLECTION="LabelledCollection",w.PARAGRAPH_TEXT="ParagraphText",w.PHOTO_GALLERY_COLLECTION="PhotoGalleryCollection",w.TEXT_BUTTON="TextButton",w.VERTICALLY_SCROLLING="VerticallyScrolling",w.VERTICAL_LAYOUT="VerticalLayout",w.VERTICAL_LIST="VerticalList",w.XRAY_BOLD_TEXT_BUTTON="XrayBoldTextButton",w.XRAY_BRANDING_IMAGE="XrayBrandingImage",w.XRAY_COVER_MOVIE="XrayCoverMovie",w.XRAY_COVER_TV_SHOW="XrayCoverTvShow",w.XRAY_DETAIL_IMAGE_ITEM="XrayDetailImageItem",w.XRAY_DETAIL_INFO_CONTAINER="XrayDetailInfoContainer",w.XRAY_DETAIL_TITLE="XrayDetailTitle",w.XRAY_DETAIL_TITLE_CONTAINER="XrayDetailTitleContainer",w.XRAY_DETAIL_TITLE_LINKABLE_COLLECTION="XrayDetailTitleLinkableCollection",w.XRAY_DETAIL_TITLE_LINKED_ITEM="XrayDetailTitleLinkedItem",w.XRAY_DETAIL_TITLE_SUBHEADER="XrayDetailTitleSubheader",w.XRAY_DETAIL_TITLE_UNLINKABLE_COLLECTION="XrayDetailTitleUnlinkableCollection",w.XRAY_DETAIL_TITLE_UNLINKED_ITEM="XrayDetailTitleUnlinkedItem",w.XRAY_DISMISSABLE_CONTAINER="XrayDismissableContainer",w.XRAY_EMPHASIZED_TEXT="XrayEmphasizedText",w.XRAY_EMPTY_COLLECTION_PLACEHOLDER_ITEM="XrayEmptyCollectionPlaceholderItem",w.XRAY_FACT_QUICKVIEW_ITEM="XrayFactQuickviewItem",w.XRAY_FORMATTED_PLAY_HISTORY_ITEM="XrayFormattedPlayHistoryItem",w.XRAY_GAME_LEADERS_ITEM="XrayGameLeadersItem",w.XRAY_GLOBAL_NAVIGATION="XrayGlobalNavigation",w.XRAY_HEAD_TO_HEAD_NAVBAR="XrayHeadToHeadNavbar",w.XRAY_HEAD_TO_HEAD_NAVBAR_LINK_ITEM="XrayHeadToHeadNavbarLinkItem",w.XRAY_HINTABLE_BUTTON="XrayHintableButton",w.XRAY_HINTABLE_GRADIENT_ITEM="XrayHintableGradientItem",w.XRAY_HORIZONTAL_BAR_GRAPH="XrayHorizontalBarGraph",w.XRAY_IMAGE_GALLERY_ITEM="XrayImageGalleryItem",w.XRAY_IMAGE_GRAPH_PROBABILITY_PERCENTAGE="XrayImageGraphProbabilityPercentage",w.XRAY_IMAGE_TEXT_BUTTON="XrayImageTextButton",w.XRAY_LITE_QUICKVIEW_VIEW_ALL_BUTTON="XrayLiteQuickviewViewAllButton",w.XRAY_LIVE_HINTABLE_BUTTON="XrayLiveHintableButton",w.XRAY_LIVE_QUICKVIEW_VIEW_ALL_BUTTON="XrayLiveQuickviewViewAllButton",w.XRAY_LIVE_STAT_LIST="XrayLiveStatList",w.XRAY_MUSIC_ITEM="XrayMusicItem",w.XRAY_MUSIC_QUICKVIEW_ITEM="XrayMusicQuickviewItem",w.XRAY_NAVBAR_LINK_ITEM="XrayNavbarLinkItem",w.XRAY_NAVBAR_LINK_ITEM_SELECTED="XrayNavbarLinkItemSelected",w.XRAY_NFL_SHOP_BUTTON="XrayNFLShopButton",w.XRAY_ONE_COLUMN_ITEM="XrayOneColumnItem",w.XRAY_ONE_COLUMN_TABLE_ITEM="XrayOneColumnTableItem",w.XRAY_PARAGRAPH_TEXT="XrayParagraphText",w.XRAY_PERSON_ITEM="XrayPersonItem",w.XRAY_PERSON_QUICKVIEW_ITEM="XrayPersonQuickviewItem",w.XRAY_PLAYER_ITEM="XrayPlayerItem",w.XRAY_PLAYER_STATISTIC="XrayPlayerStatistic",w.XRAY_PLAYER_STAT_ITEM="XrayPlayerStatItem",w.XRAY_PLAY_HISTORY_BUTTON_SUB_ITEM="XrayPlayHistoryButtonSubItem",w.XRAY_PLAY_HISTORY_ITEM="XrayPlayHistoryItem",w.XRAY_PLAY_HISTORY_POP_UP_TOGGLE_BUTTON="XrayPlayHistoryPopUpToggleButton",w.XRAY_PLAY_HISTORY_REPLAY_BOOTH_SUB_ITEM="XrayPlayHistoryReplayBoothSubItem",w.XRAY_PLAY_HISTORY_ROUTE_MAP_SUB_ITEM="XrayPlayHistoryRouteMapSubItem",w.XRAY_PRODUCT_ITEM="XrayProductItem",w.XRAY_PRODUCT_QUICKVIEW_ITEM="XrayProductQuickviewItem",w.XRAY_QUICKVIEW_CAROUSEL="XrayQuickviewCarousel",w.XRAY_QUICKVIEW_CONTAINER="XrayQuickviewContainer",w.XRAY_QUICKVIEW_VIEW_ALL_BUTTON="XrayQuickviewViewAllButton",w.XRAY_SCENE_ITEM="XraySceneItem",w.XRAY_SCOREBOARD="XrayScoreboard",w.XRAY_SCOREBOARD_GAME_INFO="XrayScoreboardGameInfo",w.XRAY_SCORECARD_COLUMN_HEADER_ITEM="XrayScorecardColumnHeaderItem",w.XRAY_SCORECARD_COLUMN_ITEM="XrayScorecardColumnItem",w.XRAY_SECTION="XraySection",w.XRAY_SQUARE_DETAIL_IMAGE_ITEM="XraySquareDetailImageItem",w.XRAY_STAT_ITEM_SUB_HEADER="XrayStatItemSubHeader",w.XRAY_TAB_LINK_ITEM="XrayTabLinkItem",w.XRAY_TAB_NAVBAR_LINK_ITEM="XrayTabNavbarLinkItem",w.XRAY_TEAMS_HEADER_ITEM="XrayTeamsHeaderItem",w.XRAY_TEAMS_STAT="XrayTeamStat",w.XRAY_TEAM_ICON="XrayTeamIcon",w.XRAY_TEAM_STAT_CENTERED="XrayTeamStatCentered",w.XRAY_TEAM_STAT_CENTERED_SECONDARY_HIGHLIGHTED="XrayTeamStatCenteredSecondaryHighlighted",w.XRAY_TEAM_STAT_CENTERED_SUBHEADER_ITEM="XrayTeamStatCenteredSubheaderItem",w.XRAY_TEAM_STAT_CENTERED_TERTIARY_HIGHLIGHTED="XrayTeamStatCenteredTertiaryHighlighted",w.XRAY_TEAM_STAT_SECONDARY_HIGHLIGHTED="XrayTeamStatSecondaryHighlighted",w.XRAY_TEAM_STAT_TERTIARY_HIGHLIGHTED="XrayTeamStatTertiaryHighlighted",w.XRAY_TEXT_BUTTON="XrayTextButton",w.XRAY_THREE_COLUMN_ITEM="XrayThreeColumnItem",w.XRAY_THREE_COLUMN_SUB_HEADER="XrayThreeColumnSubHeader",w.XRAY_THREE_COLUMN_TABLE_ITEM="XrayThreeColumnTableItem",w.XRAY_TILE_NAVIGATION="XrayTileNavigation",w.XRAY_TITLED_DESCRIPTION="XrayTitledDescription",w.XRAY_TITLED_IMAGE="XrayTitledImage",w.XRAY_TITLED_PARAGRAPH_TEXT="XrayTitledParagraphText",w.XRAY_TITLES_EMPHASIZED_TEXT="XrayTitledEmphasizedText",w.XRAY_TRIVIA_ITEM="XrayTriviaItem",w.XRAY_TWO_COLUMN_EXPANDABLE_IMAGE_TABLE_ITEM="XrayTwoColumnExpandableImageTableItem",w.XRAY_TWO_COLUMN_ITEM="XrayTwoColumnItem",w.XRAY_TWO_COLUMN_SUBHEADER="XrayTwoColumnSubheader",w.XRAY_TWO_COLUMN_TABLE_ITEM="XrayTwoColumnTableItem",w.XRAY_VIDEO_GALLERY_ITEM="XrayVideoGalleryItem",(C=P.FragmentVersion||(P.FragmentVersion={})).LEGACY="Legacy",C.LIVE_SWIFT="LiveSwift",C.SWIFT="Swift",P.IdBasedItem="com.amazon.avod.xray#IdBasedItem",(M=P.ItemChangeType||(P.ItemChangeType={})).ADD_ITEM="AddItem",M.REMOVE_ITEM="RemoveItem",P.TimeIndexedCollection="com.amazon.avod.xray#TimeIndexedCollection",P.TimeRange="com.amazon.avod.xray#TimeRange",(I=P.TimeType||(P.TimeType={})).ABSOLUTE_PLAYBACK="AbsolutePlayback",I.ABSOLUTE_UTC="AbsoluteUtc",P.TimedItemChange="com.amazon.avod.xray#TimedItemChange",P.TimedItemChanges="com.amazon.avod.xray#TimedItemChanges",P.TimingModel="com.amazon.avod.xray#TimingModel",(E=P.WidgetType||(P.WidgetType={})).TIME_INDEXED_COLLECTION="timeIndexedCollection",E.TIME_INDEXED_WIDGET_GROUP="timeIndexedWidgetGroup",E.XRAY_FLOATABLE_WIDGET="xrayFloatableWidget",E.XRAY_TAB="xrayTab",P.XRayActionTargetBase="com.amazon.avod.xray#XRayActionTargetBase",(_=P.XRayActionTargetType||(P.XRayActionTargetType={})).ITEM="xrayItemTargetType",_.WIDGET="xrayWidgetTargetType",(x=P.XRayActionType||(P.XRayActionType={})).ADD="xrayAddActionType",x.REMOVE="xrayRemoveActionType",x.UPDATE="xrayUpdateActionType",P.XRayActions="com.amazon.avod.xray#XRayActions",P.XRayActionsCollection="com.amazon.avod.xray#XRayActionsCollection",P.XRayAddAction="com.amazon.avod.xray#XRayAddAction",P.XRayBaseAction="com.amazon.avod.xray#XRayBaseAction",(k=P.XRayDeviceClass||(P.XRayDeviceClass={})).COMPACT="compact",k.NORMAL="normal",k.TELEVISION="television",P.XRayFragmentBase="com.amazon.avod.xray#XRayFragmentBase",P.XRayGraphComponent="com.amazon.avod.xray#XRayGraphComponent",P.XRayGraphedItem="com.amazon.avod.xray#XRayGraphedItem",P.XRayItemActionTarget="com.amazon.avod.xray#XRayItemActionTarget",P.XRayLegacyFragment="com.amazon.avod.xray#XRayLegacyFragment",P.XRayLiveSwiftFragment="com.amazon.avod.xray#XRayLiveSwiftFragment",(R=P.XRayParameterMapKey||(P.XRayParameterMapKey={})).CONSUMPTION_TYPE="consumptionType",R.EXECUTION_TYPE="executionType",R.FILTERS="filters",R.IS_XRAY_LITE_TITLE="isXrayLiteTitle",R.LIVE_EVENT_ID="liveEventId",R.PAGE_ID="pageId",R.PAGE_TYPE="pageType",R.REQUEST_OVERRIDE_URL="requestOverrideUrl",R.SERVICE_TOKEN="serviceToken",R.USE_ENCODER_TIMESTAMP="useEncoderTimestamp",(A=P.XRayPlaybackMode||(P.XRayPlaybackMode={})).COMPANION="companion",A.PLAYBACK="playback",P.XRayRemoveAction="com.amazon.avod.xray#XRayRemoveAction",P.XRayScoreboardItem="com.amazon.avod.xray#XRayScoreboardItem",P.XRaySwiftFragment="com.amazon.avod.xray#XRaySwiftFragment",(O=P.XRayToken||(P.XRayToken={})).ELECTRON="ELECTRON",O.INCEPTION_FILMO_V1="INCEPTION_FILMO_V1",O.INCEPTION_LITE_FILMO_ETUE_V1="INCEPTION_LITE_FILMO_ETUE_V1",O.INCEPTION_LITE_FILMO_PLAYER_V2="INCEPTION_LITE_FILMO_PLAYER_V2",O.INCEPTION_LITE_FILMO_V1="INCEPTION_LITE_FILMO_V1",O.INCEPTION_LITE_FILMO_V2="INCEPTION_LITE_FILMO_V2",O.INCEPTION_LITE_V1="INCEPTION_LITE_V1",O.INCEPTION_WIDGETS_API="INCEPTION_WIDGETS_API",O.NEUTRON="NEUTRON",O.PHOTON="PHOTON",O.POSITRON="POSITRON",O.TIMESTONE_LIVE_MLB="TIMESTONE_LIVE_MLB",O.TIMESTONE_LIVE_NBA="TIMESTONE_LIVE_NBA",O.TIMESTONE_LIVE_NFL="TIMESTONE_LIVE_NFL",O.XRAY_3PLR_2019_V1="XRAY_3PLR_2019_V1",O.XRAY_3PLR_2019_V2="XRAY_3PLR_2019_V2",O.XRAY_3PLR_2020_V1="XRAY_3PLR_2020_V1",O.XRAY_ANDROID_MOBILE_2019_V1="XRAY_ANDROID_MOBILE_2019_V1",O.XRAY_ANDROID_MOBILE_2019_V2="XRAY_ANDROID_MOBILE_2019_V2",O.XRAY_ANDROID_MOBILE_2020_V1="XRAY_ANDROID_MOBILE_2020_V1",O.XRAY_ANDROID_MOBILE_2020_V2="XRAY_ANDROID_MOBILE_2020_V2",O.XRAY_ANDROID_MOBILE_2020_V3="XRAY_ANDROID_MOBILE_2020_V3",O.XRAY_ANDROID_MOBILE_2021_V1="XRAY_ANDROID_MOBILE_2021_V1",O.XRAY_ANDROID_TV_2019_V1="XRAY_ANDROID_TV_2019_V1",O.XRAY_ANDROID_TV_2019_V2="XRAY_ANDROID_TV_2019_V2",O.XRAY_ANDROID_TV_2020_V1="XRAY_ANDROID_TV_2020_V1",O.XRAY_ANDROID_TV_2020_V2="XRAY_ANDROID_TV_2020_V2",O.XRAY_ANDROID_TV_2020_V3="XRAY_ANDROID_TV_2020_V3",O.XRAY_ANDROID_TV_2021_V1="XRAY_ANDROID_TV_2021_V1",O.XRAY_EPL_LOAD_GENERATOR="XRAY_EPL_LOAD_GENERATOR",O.XRAY_IOS_MOBILE_2019_V1="XRAY_IOS_MOBILE_2019_V1",O.XRAY_IOS_MOBILE_2019_V2="XRAY_IOS_MOBILE_2019_V2",O.XRAY_IOS_MOBILE_2020_V1="XRAY_IOS_MOBILE_2020_V1",O.XRAY_IOS_MOBILE_2020_V2="XRAY_IOS_MOBILE_2020_V2",O.XRAY_IOS_MOBILE_2020_V3="XRAY_IOS_MOBILE_2020_V3",O.XRAY_IOS_MOBILE_2020_VELOCIOUS="XRAY_IOS_MOBILE_2020_VELOCIOUS",O.XRAY_IOS_MOBILE_2021_V1="XRAY_IOS_MOBILE_2021_V1",O.XRAY_TNF_LOAD_GENERATOR="XRAY_TNF_LOAD_GENERATOR",O.XRAY_WEB_2019_V1="XRAY_WEB_2019_V1",O.XRAY_WEB_2019_V2="XRAY_WEB_2019_V2",O.XRAY_WEB_2020_V1="XRAY_WEB_2020_V1",O.XRAY_WEB_2020_V2="XRAY_WEB_2020_V2",O.XRAY_WEB_2020_V3="XRAY_WEB_2020_V3",P.XRayUpdateAction="com.amazon.avod.xray#XRayUpdateAction",P.XRayWidgetActionTarget="com.amazon.avod.xray#XRayWidgetActionTarget",P.XrayLiveFragmentMapEntry="com.amazon.avod.xray#XrayLiveFragmentMapEntry",(L=P.XrayLiveFragmentMapEntryType||(P.XrayLiveFragmentMapEntryType={})).DASH="DASH",L.ENCODER="Encoder",L.HLS="HLS",L.LOW_LATENCY="LowLatency",L.PACKAGER="Packager",L.SYE="Sye",(F=P.XrayNavigationParameterType||(P.XrayNavigationParameterType={})).APPLICATION_ID="applicationId",F.ASIN="asin",F.COLLECTION_INDEX="collectionIndex",F.DURATION="duration",F.FILTER_KEY="filterKey",F.GTI="gti",F.HEADER="header",F.ID="id",F.ITEM_ID="itemId",F.MINI_XRAY_TAB_ID="miniXrayTabId",F.MINI_XRAY_URL_MAP="miniXrayUrlMap",F.NEXT_UP_IMAGE_URL="nextUpImageUrl",F.PRODUCT_TYPE="productType",F.REQUEST_OVERRIDE_URL="requestOverrideUrl",F.TAB_INDEX="tabIndex",F.TIMECODE="timecode",F.TITLE="title",F.TITLE_ID="titleId",F.URL="url",F.VIDEO_URL_MAP="videoUrlMap",F.WIDGET_ID="widgetId",P.XrayTab="com.amazon.avod.xray#XrayTab",P.XrayTrickplayItem="com.amazon.avod.xray#XrayTrickplayItem";var D=function(t){function e(){var e=t.call(this)||this;return e.validationSpecs={"com.amazon.atv.discovery#NavigationalActionBase":{superType:"com.amazon.atv.discovery#Action",members:{}},"com.amazon.atv.discovery#ImageSize":{members:{unit:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.atv.discovery.ImageSizeUnit)},x:{isRequired:!0,validator:Pf.BasicValidators.NUMBER},y:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#XRayWidgetActionTarget":{superType:"com.amazon.avod.xray#XRayActionTargetBase",members:{widget:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#Widget")}}},"com.amazon.avod.xray#XRayFragmentBase":{members:{version:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.avod.xray.FragmentVersion)}}},"com.amazon.atv.discovery#NavigationsV2":{superType:"com.amazon.atv.discovery#NavigationsBase",members:{navigationList:{isRequired:!0,validator:new Pf.ArrayValidator(e.forId("com.amazon.atv.discovery#Item"))}}},"com.amazon.atv.discovery#LinkItem":{superType:"com.amazon.atv.discovery#Item",members:{link:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#NavigationalAction")},selected:{validator:Pf.BasicValidators.BOOLEAN}}},"com.amazon.atv.discovery#Action":{members:{analytics:{validator:e.forId("com.amazon.atv.discovery#Analytics")},text:{validator:Pf.BasicValidators.STRING},type:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.atv.discovery.ActionType)},version:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#XrayLiveFragmentMapEntry":{members:{documentUrlMap:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},domain:{validator:Pf.BasicValidators.STRING},path:{validator:Pf.BasicValidators.STRING},pollingInterval:{validator:Pf.BasicValidators.NUMBER},url:{validator:Pf.BasicValidators.STRING}}},"com.amazon.atv.discovery#ItemsV2":{superType:"com.amazon.atv.discovery#ItemsBase",members:{maxItems:{isRequired:!0,validator:Pf.BasicValidators.NUMBER},paginationLink:{validator:e.forId("com.amazon.atv.discovery#PaginationActionBase")}}},"com.amazon.atv.discovery#ItemsBase":{members:{itemList:{isRequired:!0,validator:new Pf.ArrayValidator(e.forId("com.amazon.atv.discovery#Item"))},version:{validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#SubstitutionParameter":{members:{paramKey:{isRequired:!0,validator:Pf.BasicValidators.STRING},paramValueType:{isRequired:!0,validator:Pf.BasicValidators.STRING}}},"com.amazon.avod.xray#XRayLiveSwiftFragment":{superType:"com.amazon.avod.xray#XRaySwiftFragment",members:{activePollingIntervalMillis:{validator:Pf.BasicValidators.NUMBER},cdnNamePreferenceList:{validator:new Pf.ArrayValidator(Pf.BasicValidators.STRING)},liveFragmentMap:{validator:new Pf.ObjectValidator(e.forId("com.amazon.avod.xray#XrayLiveFragmentMapEntry"))},passivePollingIntervalMillis:{validator:Pf.BasicValidators.NUMBER},pollingInterval:{validator:Pf.BasicValidators.NUMBER},url:{validator:Pf.BasicValidators.STRING}}},"com.amazon.avod.xray#XRayScoreboardItem":{superType:"com.amazon.atv.discovery#Item",members:{blueprint:{validator:e.forId("com.amazon.atv.discovery#Blueprint")},expandableCollection:{validator:e.forId("com.amazon.atv.discovery#ItemsV2")},gameInfo:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#BlueprintedItem")},id:{validator:Pf.BasicValidators.STRING},leftTeam:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#BlueprintedItem")},leftTeamIcons:{validator:e.forId("com.amazon.atv.discovery#CollectionV2")},rightTeam:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#BlueprintedItem")},rightTeamIcons:{validator:e.forId("com.amazon.atv.discovery#CollectionV2")}}},"com.amazon.atv.discovery#NavigationsBase":{superType:"com.amazon.atv.discovery#Widget",members:{}},"com.amazon.atv.discovery#SectionV2":{superType:"com.amazon.atv.discovery#SectionBase",members:{blueprint:{validator:e.forId("com.amazon.atv.discovery#Blueprint")},pageContentTraits:{validator:new Pf.ArrayValidator(new Pf.EnumValidator(n.amazon.atv.discovery.ContentTrait))},widgets:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#Widgets")}}},"com.amazon.atv.discovery#PrefetchPolicy":{members:{priority:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#DataWidget":{superType:"com.amazon.atv.discovery#Widget",members:{accessibilityMap:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},imageMap:{validator:new Pf.ObjectValidator(e.forId("com.amazon.atv.discovery#Image"))},linkActionMap:{validator:new Pf.ObjectValidator(e.forId("com.amazon.atv.discovery#NavigationalActionBase"))},textMap:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)}}},"com.amazon.avod.xray#XrayTab":{superType:"com.amazon.atv.discovery#WidgetGroup",members:{accessibilityDescription:{isRequired:!0,validator:Pf.BasicValidators.STRING},hideNavigationBar:{isRequired:!0,validator:Pf.BasicValidators.BOOLEAN},tabType:{isRequired:!0,validator:Pf.BasicValidators.STRING}}},"com.amazon.atv.discovery#NavigationalAction":{superType:"com.amazon.atv.discovery#NavigationalActionBase",members:{cacheKey:{validator:Pf.BasicValidators.STRING},linkType:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.atv.discovery.LinkType)},nonSupportedText:{validator:Pf.BasicValidators.STRING},parameters:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},prefetchPolicy:{validator:e.forId("com.amazon.atv.discovery#PrefetchPolicy")}}},"com.amazon.atv.discovery#PageV2":{superType:"com.amazon.atv.discovery#PageBase",members:{breadcrumb:{validator:e.forId("com.amazon.atv.discovery#BreadCrumbBase")},filters:{validator:e.forId("com.amazon.atv.discovery#FiltersBase")},navigations:{validator:e.forId("com.amazon.atv.discovery#NavigationsBase")},sections:{isRequired:!0,validator:new Pf.ObjectValidator(e.forId("com.amazon.atv.discovery#SectionBase"))},sorts:{validator:e.forId("com.amazon.atv.discovery#SortsBase")}}},"com.amazon.avod.xray#XRayRemoveAction":{superType:"com.amazon.avod.xray#XRayBaseAction",members:{}},"com.amazon.avod.xray#TimeRange":{members:{endTime:{isRequired:!0,validator:Pf.BasicValidators.NUMBER},startTime:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#CacheRefreshEvent":{members:{eventType:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.atv.discovery.EventType)},qualifiers:{validator:new Pf.ArrayValidator(Pf.BasicValidators.STRING)},updatePolicy:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.atv.discovery.UpdatePolicyType)}}},"com.amazon.atv.discovery#PaginationActionBase":{superType:"com.amazon.atv.discovery#Action",members:{api:{isRequired:!0,validator:Pf.BasicValidators.STRING},parameters:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},substitutionParameters:{validator:new Pf.ArrayValidator(e.forId("com.amazon.atv.discovery#SubstitutionParameter"))}}},"com.amazon.avod.xray#TimingModel":{members:{referenceTime:{validator:Pf.BasicValidators.DATE},type:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.avod.xray.TimeType)}}},"com.amazon.avod.xray#XRayUpdateAction":{superType:"com.amazon.avod.xray#XRayBaseAction",members:{target:{isRequired:!0,validator:e.forId("com.amazon.avod.xray#XRayActionTargetBase")}}},"com.amazon.atv.discovery#PageBase":{members:{analytics:{validator:e.forId("com.amazon.atv.discovery#Analytics")},cache:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#CacheControlPolicy")},subtext:{validator:Pf.BasicValidators.STRING},text:{validator:Pf.BasicValidators.STRING},version:{validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#XRayActions":{members:{actionList:{isRequired:!0,validator:new Pf.ArrayValidator(e.forId("com.amazon.avod.xray#XRayBaseAction"))},sourceTime:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#XRayAddAction":{superType:"com.amazon.avod.xray#XRayBaseAction",members:{index:{validator:Pf.BasicValidators.NUMBER},maxJitterMillis:{validator:Pf.BasicValidators.NUMBER},priority:{validator:Pf.BasicValidators.NUMBER},target:{isRequired:!0,validator:e.forId("com.amazon.avod.xray#XRayActionTargetBase")},visibilityDurationMillis:{validator:Pf.BasicValidators.NUMBER},visibilityWindowMillis:{validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#Analytics":{members:{cascade:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},local:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)}}},"com.amazon.atv.discovery#GetPageResponse":{superType:"com.amazon.atv.discovery#BaseResponse",members:{page:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#PageBase")}}},"com.amazon.atv.discovery#Widget":{members:{analytics:{validator:e.forId("com.amazon.atv.discovery#Analytics")},blueprint:{validator:e.forId("com.amazon.atv.discovery#Blueprint")},debugAttributes:{validator:Pf.BasicValidators.STRING},id:{validator:Pf.BasicValidators.STRING},type:{isRequired:!0,validator:Pf.BasicValidators.STRING},version:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#BlueprintedItem":{superType:"com.amazon.atv.discovery#Item",members:{accessibilityMap:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},blueprint:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#Blueprint")},id:{isRequired:!0,validator:Pf.BasicValidators.STRING},imageMap:{validator:new Pf.ObjectValidator(e.forId("com.amazon.atv.discovery#Image"))},linkActionMap:{validator:new Pf.ObjectValidator(e.forId("com.amazon.atv.discovery#NavigationalActionBase"))},textMap:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)}}},"com.amazon.atv.discovery#Widgets":{members:{maxWidgets:{isRequired:!0,validator:Pf.BasicValidators.NUMBER},paginationLink:{validator:e.forId("com.amazon.atv.discovery#PaginationActionBase")},version:{isRequired:!0,validator:Pf.BasicValidators.NUMBER},widgetList:{isRequired:!0,validator:new Pf.ArrayValidator(e.forId("com.amazon.atv.discovery#Widget"))}}},"com.amazon.atv.discovery#WidgetGroup":{superType:"com.amazon.atv.discovery#Widget",members:{widgets:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#Widgets")}}},"com.amazon.atv.discovery#CollectionBase":{superType:"com.amazon.atv.discovery#Widget",members:{}},"com.amazon.avod.xray#XRayLegacyFragment":{superType:"com.amazon.avod.xray#XRayFragmentBase",members:{url:{isRequired:!0,validator:Pf.BasicValidators.STRING}}},"com.amazon.avod.xray#XrayTrickplayItem":{superType:"com.amazon.atv.discovery#BlueprintedItem",members:{trickPlayTimeRange:{isRequired:!0,validator:e.forId("com.amazon.avod.xray#TimeRange")},trickplayFramePositionMillis:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#TimeToLive":{members:{maxAgeSeconds:{isRequired:!0,validator:Pf.BasicValidators.NUMBER},updatePolicy:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.atv.discovery.UpdatePolicyType)}}},"com.amazon.atv.discovery#SectionBase":{members:{analytics:{validator:e.forId("com.amazon.atv.discovery#Analytics")},cache:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#CacheControlPolicy")},subtext:{validator:Pf.BasicValidators.STRING},text:{validator:Pf.BasicValidators.STRING},version:{validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#XRayGraphedItem":{superType:"com.amazon.atv.discovery#BlueprintedItem",members:{left:{isRequired:!0,validator:e.forId("com.amazon.avod.xray#XRayGraphComponent")},right:{isRequired:!0,validator:e.forId("com.amazon.avod.xray#XRayGraphComponent")},title:{validator:Pf.BasicValidators.STRING}}},"com.amazon.avod.xray#XRayGraphComponent":{members:{color:{validator:Pf.BasicValidators.STRING},imageMap:{validator:new Pf.ObjectValidator(e.forId("com.amazon.atv.discovery#Image"))},textMap:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},value:{validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#XRayActionsCollection":{members:{actionsList:{isRequired:!0,validator:new Pf.ArrayValidator(e.forId("com.amazon.avod.xray#XRayActions"))},activePollingIntervalMillis:{validator:Pf.BasicValidators.NUMBER},nextDocumentUrlMap:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},nextPath:{validator:Pf.BasicValidators.STRING},nextUrl:{validator:Pf.BasicValidators.STRING},passivePollingIntervalMillis:{validator:Pf.BasicValidators.NUMBER},pollingIntervalMillis:{validator:Pf.BasicValidators.NUMBER},uniqueReferenceId:{validator:Pf.BasicValidators.STRING}}},"com.amazon.atv.discovery#CacheControlPolicy":{members:{refreshEvents:{validator:new Pf.ArrayValidator(e.forId("com.amazon.atv.discovery#CacheRefreshEvent"))},ttl:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#TimeToLive")},type:{isRequired:!0,validator:Pf.BasicValidators.STRING},version:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#XRayItemActionTarget":{superType:"com.amazon.avod.xray#XRayActionTargetBase",members:{item:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#Item")}}},"com.amazon.atv.discovery#DebugInfo":{members:{}},"com.amazon.avod.xray#XRayBaseAction":{members:{parentTargetId:{isRequired:!0,validator:Pf.BasicValidators.STRING},targetId:{isRequired:!0,validator:Pf.BasicValidators.STRING},type:{isRequired:!0,validator:Pf.BasicValidators.STRING},version:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#BreadCrumbBase":{members:{version:{validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#Item":{members:{analytics:{validator:e.forId("com.amazon.atv.discovery#Analytics")},debugAttributes:{validator:Pf.BasicValidators.STRING},metadata:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},type:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.atv.discovery.ItemType)},version:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#SortsBase":{members:{version:{validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#CollectionV2":{superType:"com.amazon.atv.discovery#CollectionBase",members:{collectionActions:{validator:new Pf.ObjectValidator(e.forId("com.amazon.atv.discovery#Action"))},itemTypeToActionMap:{validator:new Pf.ObjectValidator(new Pf.ArrayValidator(e.forId("com.amazon.atv.discovery#Action")))},items:{validator:e.forId("com.amazon.atv.discovery#ItemsBase")},subtext:{validator:Pf.BasicValidators.STRING},text:{validator:Pf.BasicValidators.STRING}}},"com.amazon.atv.discovery#RelatedCollectionBlueprintedItem":{superType:"com.amazon.atv.discovery#BlueprintedItem",members:{relatedCollection:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#ItemsBase")}}},"com.amazon.avod.xray#TimeIndexedCollection":{superType:"com.amazon.atv.discovery#CollectionBase",members:{items:{isRequired:!0,validator:new Pf.ArrayValidator(e.forId("com.amazon.avod.xray#IdBasedItem"))},partitionedChangeList:{isRequired:!0,validator:new Pf.ArrayValidator(e.forId("com.amazon.avod.xray#TimedItemChanges"))},timingModel:{isRequired:!0,validator:e.forId("com.amazon.avod.xray#TimingModel")}}},"com.amazon.atv.discovery#NavigationalActionV2":{superType:"com.amazon.atv.discovery#NavigationalActionBase",members:{api:{validator:Pf.BasicValidators.STRING},cacheKey:{validator:Pf.BasicValidators.STRING},linkType:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.atv.discovery.LinkType)},nonSupportedText:{validator:Pf.BasicValidators.STRING},parameters:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)},prefetchPolicy:{validator:e.forId("com.amazon.atv.discovery#PrefetchPolicy")}}},"com.amazon.atv.discovery#GetWidgetsResponse":{superType:"com.amazon.atv.discovery#BaseResponse",members:{widgets:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#Widgets")}}},"com.amazon.avod.xray#TimedItemChanges":{members:{changesCollection:{isRequired:!0,validator:new Pf.ArrayValidator(e.forId("com.amazon.avod.xray#TimedItemChange"))},initialItemIds:{validator:new Pf.ArrayValidator(Pf.BasicValidators.STRING)},timeRange:{isRequired:!0,validator:e.forId("com.amazon.avod.xray#TimeRange")}}},"com.amazon.atv.discovery#FiltersBase":{members:{version:{validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#TimedItemChange":{members:{changeType:{isRequired:!0,validator:new Pf.EnumValidator(n.amazon.avod.xray.ItemChangeType)},itemId:{isRequired:!0,validator:Pf.BasicValidators.STRING},timePosition:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#ImageTextLink":{superType:"com.amazon.atv.discovery#LinkItem",members:{alternateText:{validator:Pf.BasicValidators.STRING},backgroundImage:{validator:e.forId("com.amazon.atv.discovery#Image")},gradientRequired:{validator:Pf.BasicValidators.BOOLEAN},image:{isRequired:!0,validator:Pf.BasicValidators.STRING},imageSize:{validator:e.forId("com.amazon.atv.discovery#ImageSize")},text:{isRequired:!0,validator:Pf.BasicValidators.STRING}}},"com.amazon.atv.discovery#DebugAttribute":{members:{debugInfo:{validator:e.forId("com.amazon.atv.discovery#DebugInfo")},debugLevel:{validator:new Pf.EnumValidator(n.amazon.atv.discovery.DebugLevel)}}},"com.amazon.avod.xray#XRayActionTargetBase":{members:{type:{isRequired:!0,validator:Pf.BasicValidators.STRING},version:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.atv.discovery#BaseResponse":{members:{debugAttributes:{validator:new Pf.ObjectValidator(new Pf.ArrayValidator(e.forId("com.amazon.atv.discovery#DebugAttribute")))}}},"com.amazon.avod.xray#IdBasedItem":{members:{id:{isRequired:!0,validator:Pf.BasicValidators.STRING},item:{isRequired:!0,validator:e.forId("com.amazon.atv.discovery#Item")}}},"com.amazon.atv.discovery#Blueprint":{members:{id:{isRequired:!0,validator:Pf.BasicValidators.STRING},properties:{validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)}}},"com.amazon.atv.discovery#Image":{members:{alternateText:{validator:Pf.BasicValidators.STRING},gradientRequired:{validator:Pf.BasicValidators.BOOLEAN},size:{validator:e.forId("com.amazon.atv.discovery#ImageSize")},url:{isRequired:!0,validator:Pf.BasicValidators.STRING},version:{isRequired:!0,validator:Pf.BasicValidators.NUMBER}}},"com.amazon.avod.xray#XRaySwiftFragment":{superType:"com.amazon.avod.xray#XRayFragmentBase",members:{parameters:{isRequired:!0,validator:new Pf.ObjectValidator(Pf.BasicValidators.STRING)}}}},e}return wf(e,t),e}(Pf.InterfaceValidator);e.Validator=D}($p||($p={}));var Cf=$p,Mf={com:Cf.com,Validator:Cf.Validator},If=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=S.of("Action"),r=function(){function e(e,t){n(e,"type").exists(),this.type=e,this.value=t}return e.prototype.getType=function(){return this.type},e.prototype.getValue=function(){return this.value},e}();t.Action=r});e(If);If.Action;var Ef=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=S.of("Dispatcher"),n=function(){function e(){this.isDispatching=!1,this.callbacks={},this.inFlightPayload=null,this.dispatchQueue=[],this.numChainedDispatches=0}return e.prototype.register=function(e,t){a(this.isDispatching,"Dispatcher#register: Cannot call while dispatching.").is.false();var n=e.getDispatchRecipientId();a(this.callbacks[n],"Dispatcher#register: ID already registered: "+n).not.exists(),this.callbacks[n]={callback:t,isInvokingCallback:!1,hasInvokedCallback:!1}},e.prototype.deregister=function(e){a(this.isDispatching,"Dispatcher#deregister: Cannot call while dispatching.").is.false();var t=e.getDispatchRecipientId();a(this.callbacks[t],"Dispatcher#deregister: ID does not map to any registered callback: "+t).exists(),delete this.callbacks[t]},e.prototype.dispatch=function(e){if(a(this.numChainedDispatches<64,"Max number of chained dispatches 64 exceeded.").is.true(),this.isDispatching)this.dispatchQueue.push(e);else{this.startDispatching(e);try{for(var t=0,n=F.values(this.callbacks);t<n.length;t++){var r=n[t];r.isInvokingCallback||r.hasInvokedCallback||this.invokeCallback(r)}}finally{this.stopDispatching()}}},e.prototype.waitFor=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];a(this.isDispatching,"Dispatcher#waitFor: Can only call while dispatching.").true();for(var n=0,r=e;n<r.length;n++){var i=r[n].getDispatchRecipientId(),o=this.callbacks[i];a(o,"Dispatcher#waitFor: ID does not map to any registered callback: "+i).exists(),a(o.isInvokingCallback,"Dispatch#waitFor: Circular dependency on callback ID "+i).is.false(),o.hasInvokedCallback||this.invokeCallback(o)}},e.prototype.startDispatching=function(e){this.isDispatching=!0,this.inFlightPayload=e;for(var t=0,n=F.values(this.callbacks);t<n.length;t++){var r=n[t];r.isInvokingCallback=!1,r.hasInvokedCallback=!1}},e.prototype.stopDispatching=function(){if(this.inFlightPayload=null,this.isDispatching=!1,0<this.dispatchQueue.length){this.numChainedDispatches++;var e=this.dispatchQueue.shift();a(e,"payload").exists(),this.dispatch(e)}else this.numChainedDispatches=0},e.prototype.invokeCallback=function(e){e.isInvokingCallback=!0,e.callback(this.inFlightPayload),e.isInvokingCallback=!1,e.hasInvokedCallback=!0},e}();t.Dispatcher=n});e(Ef);Ef.Dispatcher;var _f=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.dispatcher=new Ef.Dispatcher,this.onAction=function(e){e.getType()===n.actionName&&n.respondToAction(e.getValue())},this.actionName=e,this.respondToAction=t}return e.prototype.initialize=function(e){this.dispatcher=e,this.dispatcher.register(this,this.onAction)},e.prototype.destroy=function(){this.dispatcher.deregister(this)},e.prototype.getDispatchRecipientId=function(){return"Responder."+this.actionName},e}();t.ActionResponder=n});e(_f);_f.ActionResponder;var xf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){};t.DispatchRecipient=n});e(xf);xf.DispatchRecipient;var kf=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i="StoreChange",o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.storeChangeEventEmitter=new Dt.EventEmitter,e.dispatcher=new Ef.Dispatcher,e.isEmittingStoreChange=!1,e.storeChangeListenersToRegister=[],e.storeChangeListenersToDeregister=[],e}return n(e,t),e.prototype.initialize=function(e){this.dispatcher=e,this.dispatcher.register(this,this.getActionHandler())},e.prototype.destroy=function(){this.dispatcher.deregister(this)},e.prototype.onChange=function(e){this.storeChangeListenersToRegister.push(e),this.isEmittingStoreChange||this.updateStoreChangeListenerRegistration()},e.prototype.offChange=function(e){this.storeChangeListenersToDeregister.push(e),this.isEmittingStoreChange||this.updateStoreChangeListenerRegistration()},e.prototype.emitChange=function(){this.isEmittingStoreChange=!0,this.storeChangeEventEmitter.emitSync(i),this.isEmittingStoreChange=!1,this.updateStoreChangeListenerRegistration()},e.prototype.updateStoreChangeListenerRegistration=function(){for(var e;0<this.storeChangeListenersToRegister.length;)void 0!==(e=this.storeChangeListenersToRegister.pop())&&this.storeChangeEventEmitter.on(i,e);for(;0<this.storeChangeListenersToDeregister.length;)void 0!==(e=this.storeChangeListenersToDeregister.pop())&&this.storeChangeEventEmitter.off(i,e)},e}(xf.DispatchRecipient);t.Store=o});e(kf);kf.Store;var Rf=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t}(kf.Store);t.ValueStore=i});e(Rf);Rf.ValueStore;var Af=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("ActionStore"),o=function(r){function e(e,t){void 0===t&&(t=null);var n=r.call(this)||this;return i(e,"actionType").exists(),n.actionType=e,n.actionValue=t,n}return n(e,r),e.prototype.getValue=function(){return this.actionValue},e.prototype.getDispatchRecipientId=function(){return this.actionType+"Store"},e.prototype.getActionHandler=function(){var n=this;return function(e){if(null!==e&&e.getType()===n.actionType){var t=e.getValue();F.isEqual(t,n.actionValue)||(n.actionValue=t,n.emitChange())}}},e.prototype.destroy=function(){r.prototype.destroy.call(this),this.actionValue=null},e}(Rf.ValueStore);t.ActionStore=o});e(Af);Af.ActionStore;var Of=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=S.of("ComputedValueStore"),i=function(o){function e(e,t,n,r){void 0===r&&(r=null);var i=o.call(this)||this;return i.value=null,i.dependencyDidChange=!1,i.onDependencyChange=function(){i.dependencyDidChange=!0},a(e,"name").exists(),a(t,"dependencies").exists(),a(n,"valueFunction").exists(),i.name=e,i.valueFunction=n,i.dependencies=t,i.initialValue=r,i}return n(e,o),e.prototype.getValue=function(){return this.value},e.prototype.getDispatchRecipientId=function(){return this.name},e.prototype.initialize=function(e){o.prototype.initialize.call(this,e),this.value=this.computeValue(this.initialValue);for(var t=0,n=this.dependencies;t<n.length;t++){n[t].onChange(this.onDependencyChange)}},e.prototype.destroy=function(){for(var e=0,t=this.dependencies;e<t.length;e++){t[e].offChange(this.onDependencyChange)}this.value=null,o.prototype.destroy.call(this)},e.prototype.getActionHandler=function(){var o=this;return function(e){for(var t=0,n=o.dependencies;t<n.length;t++){var r=n[t];o.dispatcher.waitFor(r)}if(o.dependencyDidChange){var i=o.computeValue(o.value);F.isEqual(i,o.value)||(o.value=i,o.emitChange()),o.dependencyDidChange=!1}}},e.prototype.computeValue=function(e){var t=F.map(this.dependencies,function(e){return e.getValue()}),n=[e].concat(t);return this.valueFunction.apply(this,n)},e}(Rf.ValueStore);t.ComputedValueStore=i});e(Of);Of.ComputedValueStore;var Lf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Action=If.Action,t.ActionResponder=_f.ActionResponder,t.ActionStore=Af.ActionStore,t.ComputedValueStore=Of.ComputedValueStore,t.Dispatcher=Ef.Dispatcher,t.DispatchRecipient=xf.DispatchRecipient,t.Store=kf.Store,t.ValueStore=Rf.ValueStore});e(Lf);Lf.Action,Lf.ActionResponder,Lf.ActionStore,Lf.ComputedValueStore,Lf.Dispatcher,Lf.DispatchRecipient,Lf.Store,Lf.ValueStore;var Ff=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("MetricsTimer");var n=function(){function e(e,t,n){this.metrics=e,this.metricName=t,this.marketplaceId=n,this.startTime=Date.now(),this.elapsedTime=null}return e.prototype.end=function(){return null===this.elapsedTime&&(this.elapsedTime=Date.now()-this.startTime,this.metrics.putMetric(this.metricName,this.elapsedTime,"ms",this.marketplaceId)),this.elapsedTime},e}();t.MetricsTimer=n});e(Ff);Ff.MetricsTimer;var Df=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("Metrics"),n=function(){function e(){this.handler=function(){},this.flusher=function(){}}return e.prototype.setHandler=function(e){this.handler=e},e.prototype.setFlusher=function(e){this.flush(),this.flusher=e},e.prototype.putMetric=function(t,e,n,r){try{this.handler(t,e,n,r)}catch(e){i.error("An error occurred while publishing metric "+t+": "+e.name+": "+e.message,e)}},e.prototype.flush=function(){try{this.flusher()}catch(e){i.error("An error occurred while flushing metrics",e)}},e.prototype.startTimer=function(e,t){return new Ff.MetricsTimer(this,e,t)},e}();t.Metrics=n});e(Df);Df.Metrics;var Nf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Metrics=Df.Metrics,t.MetricsTimer=Ff.MetricsTimer});e(Nf);Nf.Metrics,Nf.MetricsTimer;var Uf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new Nf.Metrics;t.XrayPmetReporter=n});e(Uf);Uf.XrayPmetReporter;var Bf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=S.of("XrayServiceResponseParser"),r=function(){function e(e,t){void 0===t&&(t=new Mf.Validator),this.modelId=n(e,"modelId").exists(),this.validator=t}return e.prototype.parse=function(e,t,n){var r=null;try{r=JSON.parse(e)}catch(e){n(e)}if(null!==r){var i=this.validator.forId(this.modelId).validate(r);null===i?n(new Error("Response failed validation: "+e)):t(i)}},e}();t.XrayServiceResponseParser=r});e(Bf);Bf.XrayServiceResponseParser;var Vf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=S.of("XrayPageCache"),n=function(){function i(){this.cache={}}return i.prototype.put=function(e,t,n){o(e,"pageContext").exists(),o(t,"value").exists();var r=i.keyFromPageContext(e);this.cache[r]=n?{value:t,expirationTimeMs:n}:{value:t}},i.prototype.get=function(e){return o(e,"pageContext").exists(),this.cache[i.keyFromPageContext(e)]||null},i.keyFromPageContext=function(e){return e.getPageId()+"-"+e.getServiceToken()},i}();t.XrayResponseCache=n});e(Vf);Vf.XrayResponseCache;var jf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.XRAY_DATA_LOAD_TIME="Xray-DataLoad-Time-INCEPTION",e.XRAY_DATA_LOAD_FAIL="Xray-DataLoad-Failure-INCEPTION",e.XRAY_DATA_GET_WIDGETS_LOAD_TIME="Xray-DataGetWidgetsLoad-Time-INCEPTION",e.XRAY_DATA_GET_WIDGETS_LOAD_FAIL="Xray-DataGetWidgetsLoad-Failure-INCEPTION",e.XRAY_DATA_LOAD_TIME_STREAMING="XrayData-Loadtime-INCEPTION-Streaming",e.XRAY_DATA_LOAD_FAIL_STREAMING="XrayData-Load-Failure-INCEPTION-Streaming",e.XRAY_DATA_LOAD_TIME_STREAMING_FEATURE="XrayData-Loadtime-INCEPTION-Streaming-Feature",e.XRAY_DATA_LOAD_TIME_STREAMING_LIVE="XrayData-Loadtime-INCEPTION-Streaming-Live",e.XRAY_DATA_LOAD_FAIL_STREAMING_FEATURE="XrayData-Load-Failure-INCEPTION-Streaming-Feature",e.XRAY_DATA_LOAD_FAIL_STREAMING_LIVE="XrayData-Load-Failure-INCEPTION-Streaming-Live",e.XRAY_LIVE_DYNAMIC_ADD_FAIL="Xray-Live-Dynamic-Add-Fail",e.XRAY_TIME_UNIT_MS="ms",e.XRAY_LIVE_UI_VISIBLE="Xray-Live-UI-Visible",e.XRAY_LIVE_UI_HIDDEN="Xray-Live-UI-Hidden",e.XRAY_HIGHLIGHT_READY_TO_WATCH="Xray-Highlight-ReadyToWatch",e.XRAY_HIGHLIGHT_COMPLETION_PERCENTAGE="Xray-Highlight-CompletionPercentage",e.XRAY_HIGHLIGHT_LOAD_ERROR="Xray-Highlight-LoadError",e}();t.XrayMetricsConstants=n});e(jf);jf.XrayMetricsConstants;var Xf=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(e){var t=this.constructor,n=r.call(this,"AcquisitionError-"+e.type)||this;return Object.setPrototypeOf(n,t.prototype),n.reason=e,n}return n(e,r),e}(Error);t.AcquisitionError=i});e(Xf);Xf.AcquisitionError;var zf=function(){function e(e){void 0===e&&(e=A.timer),this.timer=e,this.capabilities={isSupported:null!=window&&null!=window.localStorage}}return e.prototype.init=function(e){this.timer.setImmediate(e)},Object.defineProperty(e.prototype,"isInitialized",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.get=function(e,t){var n=window.localStorage.getItem(e);this.timer.setImmediate(function(){return t(null,n)})},e.prototype.set=function(e,t,n){try{void 0!==t?window.localStorage.setItem(e,t):window.localStorage.removeItem(e),this.timer.setImmediate(n)}catch(e){var r=e;r.code=-1,this.timer.setImmediate(function(){return n(r)})}},e}(),qf=new zf,Wf={KeyValueStore:zf,keyValueStore:qf},Hf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("QueuedRequestPool");var n=function(){function e(){this.diagnostics=pp.Diagnostics.create("NetworkRequestManager.QueuedRequestPool"),this.requestsQueue=new Rp.PriorityQueue(function(e,t){return e.request.getPriority()<t.request.getPriority()})}return e.prototype.enqueue=function(e,t){var n=this,r=new Fe.Deferred,i={request:e,onCompleted:function(e){n.reportDiagnostics(),r.resolve(e)},onFailed:function(e){n.reportDiagnostics(),r.reject(e)},cancelToken:t};return this.requestsQueue.push(i),t.promise.then(function(e){n.requestsQueue.remove(i),i.onFailed(e)}),this.reportDiagnostics(),r.promise},e.prototype.getRequest=function(){var e=this.requestsQueue.pop();return this.reportDiagnostics(),e},e.prototype.size=function(){return this.requestsQueue.size()},e.prototype.reportDiagnostics=function(){var e={requests:this.requestsQueue.getItems().map(function(e){return e.cancelToken.requested?{status:"pending cancellation",description:e.request.description}:{priority:e.request.getPriority(),description:e.request.description}}),timestamp:Date.now()};this.diagnostics.report("state",e)},e}();t.QueuedRequestPool=n});e(Hf);Hf.QueuedRequestPool;var Gf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("StatisticsTrackingExecutor");var n=function(){function e(e,t){this.statisticsStore=e,this.timeoutTransferSizeCalculator=t}return e.prototype.execute=function(i,e,o,a){var s=this;return o.requested?o.promise.then(function(e){throw e}):new Fe.Promise(function(t,r){if(null==e)throw new Fe.CancelError;var n=e.build().onLoad(function(e){s.statisticsStore.addLatencySample(e.getLatencyMs(),a),s.statisticsStore.addContentTransferSample(e.getMetrics().downloadMs,e.getMetrics().loadedBytes,a),t(e)}).onError(function(e,t){null!=t&&s.statisticsStore.addLatencySample(t.getLatencyMs(),a);var n=s.createAcquisitionError(e,t);r(n)}).onTimeout(function(e){s.handleTimeoutStatistics(i,e,a);var t=new Xf.AcquisitionError({type:"Timeout",timing:{totalMs:e.timeoutMs}});r(t)}).onAbort(function(e){var t=new Xf.AcquisitionError({type:"UnknownError",cause:new Error("Unexpected network abort")});r(t)});o.promise.then(function(e){n.abort(),r(e)}),n.send()})},e.prototype.createAcquisitionError=function(e,t){return null!=t?new Xf.AcquisitionError({type:"HttpError",body:"",headers:t.getHeaders(),statusCode:t.getStatus(),timing:{latencyMs:t.getLatencyMs(),downloadMs:t.getDownloadMs(),totalMs:t.getTotalMs(),parseMs:null},cause:e}):new Xf.AcquisitionError({type:"UnknownNetworkError",error:e})},e.prototype.handleTimeoutStatistics=function(e,t,n){if(0<t.latencyMs&&this.statisticsStore.addLatencySample(t.latencyMs,n),0<t.downloadMs)this.statisticsStore.addContentTransferSample(t.downloadMs,t.loadedBytes,n);else{var r=this.timeoutTransferSizeCalculator.getTransferSize(e,t,n);null!=r&&this.statisticsStore.addContentTransferSample(t.timeoutMs,r,n)}},e}();t.StatisticsTrackingExecutor=n});e(Gf);Gf.StatisticsTrackingExecutor;var Kf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getTransferSize=function(e,t,n){return null},e}();t.NullTransferSizeCalculator=n});e(Kf);Kf.NullTransferSizeCalculator;var Qf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.statisticsStore=e,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.networkRequestManager&&null!=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator&&null!=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.bandwidthPercentage&&null!=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.bandwidthPercentage.factor?this.factor=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.bandwidthPercentage.factor:this.factor=null}return e.prototype.getTransferSize=function(e,t,n){if(null==this.factor||this.factor<0||1<this.factor)return null;var r=this.statisticsStore.getBandwidthAverageKbps();return null==r?null:t.timeoutMs*this.factor*r/8},e}();t.BandwidthBasedTimeoutTransferSizeCalculator=n});e(Qf);Qf.BandwidthBasedTimeoutTransferSizeCalculator;var Yf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.networkRequestManager&&null!=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator&&null!=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.estimatedTotalSize&&null!=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.estimatedTotalSize.factor?this.factor=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.estimatedTotalSize.factor:this.factor=null}return e.prototype.getTransferSize=function(e,t,n){if(null==this.factor||this.factor<=0||1<this.factor)return null;var r=null==e.getApproximateResponseSizeBytes?null:e.getApproximateResponseSizeBytes();return null==r?null:this.factor*r},e}();t.EstimatedTotalSizeTransferSizeCalculator=n});e(Yf);Yf.EstimatedTotalSizeTransferSizeCalculator;var Jf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.componentStrategies=[new Yf.EstimatedTotalSizeTransferSizeCalculator,new Qf.BandwidthBasedTimeoutTransferSizeCalculator(e)]}return e.prototype.getTransferSize=function(t,n,r){return this.componentStrategies.map(function(e){return e.getTransferSize(t,n,r)}).reduce(function(e,t){return null==e?t:null==t?e:Math.min(e,t)},null)},e}();t.CompositeTransferSizeCalculator=n});e(Jf);Jf.CompositeTransferSizeCalculator;var $f=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.statisticsStore=e}return e.prototype.getNetworkStatistics=function(e){return this.statisticsStore.getStatistics()},e}();t.AggregateRequesterReturnedStatisticsStrategy=n});e($f);$f.AggregateRequesterReturnedStatisticsStrategy;var Zf=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.statisticsStore=e}return e.prototype.estimateTotalDownloadDurationMs=function(e,t){var n=this.statisticsStore.getLatencyAverageMs();if(null==n)return 1/0;if(null==t)return 1/0;var r=this.statisticsStore.getBandwidthAverageKbps();return null==r?1/0:n+8*t/r},e}();t.BasicDownloadDurationCalculationStrategy=n});e(Zf);Zf.BasicDownloadDurationCalculationStrategy;var eh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.statisticsStore=e}return e.prototype.getScheduleDelayMs=function(e){if(0===e.length)return 0;var t=e[e.length-1].expectedCompletionTimeMs;if(Date.now()>t)return null;var n=this.statisticsStore.getLatencyAverageMs();return null==n&&(n=0),Math.max(t-Date.now()-n,0)},e}();t.BasicLinearizationScheduleStrategy=n});e(eh);eh.BasicLinearizationScheduleStrategy;var th=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.statisticsStore=e}return e.prototype.getNetworkStatistics=function(e){return this.statisticsStore.getStatistics(e)},e}();t.PerAssetRequesterReturnedStatisticsStrategy=n});e(th);th.PerAssetRequesterReturnedStatisticsStrategy;var nh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("LinearizationChannel"),n=function(){function u(e,t,n,r){if(this.inflightRequests=[],e<=0)throw new Error("Cannot create LinearizationChannel with non-positive LinearizationPotential of \""+e+"\".");this.linearizationPotential=e,this.getQueuedRequest=n,this.onIdle=r,this.id=""+u.channelCounter++;var i=t.getRawStatisticsStore();null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.networkRequestManager?("perAsset"===up.configurationStore.configuration.networkRequestManager.requesterReturnedStatisticsStrategy?this.requesterReturnedStatisticsStrategy=new th.PerAssetRequesterReturnedStatisticsStrategy(t):this.requesterReturnedStatisticsStrategy=new $f.AggregateRequesterReturnedStatisticsStrategy(t),null!=up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator?"estimatedTotalSize"===up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.strategy?this.timeoutTransferSizeCalculator=new Yf.EstimatedTotalSizeTransferSizeCalculator:"bandwidthPercentage"===up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.strategy?this.timeoutTransferSizeCalculator=new Qf.BandwidthBasedTimeoutTransferSizeCalculator(i):"composite"===up.configurationStore.configuration.networkRequestManager.timeoutTransferSizeCalculator.strategy?this.timeoutTransferSizeCalculator=new Jf.CompositeTransferSizeCalculator(i):this.timeoutTransferSizeCalculator=new Kf.NullTransferSizeCalculator:this.timeoutTransferSizeCalculator=new Kf.NullTransferSizeCalculator):(this.requesterReturnedStatisticsStrategy=new $f.AggregateRequesterReturnedStatisticsStrategy(t),this.timeoutTransferSizeCalculator=new Kf.NullTransferSizeCalculator),this.schedulerStrategy=new eh.BasicLinearizationScheduleStrategy(i),this.downloadDurationCalculator=new Zf.BasicDownloadDurationCalculationStrategy(i),this.statisticsTrackingExecutor=new Gf.StatisticsTrackingExecutor(t,this.timeoutTransferSizeCalculator),this.diagnostics=pp.Diagnostics.create("NetworkRequestManager.LinearizationChannel."+this.id)}return u.prototype.updateLinearizationPotential=function(e){this.linearizationPotential=e},u.prototype.inflightCount=function(){return this.inflightRequests.length},u.prototype.availability=function(){return Math.max(this.linearizationPotential-this.inflightRequests.length,0)},u.prototype.notifyRequestAvailable=function(){this.scheduleNextRequest()},u.prototype.getInflightDiagnosticMetadata=function(){return this.inflightRequests.map(function(e){return e.request.cancelToken.requested?{status:"pending cancellation",description:e.request.request.description}:{priority:e.request.request.getPriority(),description:e.request.request.description}})},u.prototype.scheduleNextRequest=function(){var e=this;if(!(this.availability()<=0))if(0!==this.inflightRequests.length){var t=this.inflightRequests[this.inflightRequests.length-1];if(null==t.nextRequestTimeoutId){var n=this.schedulerStrategy.getScheduleDelayMs(this.inflightRequests);null!=n&&isFinite(n)&&(t.nextRequestTimeoutId=A.timer.setTimeout(function(){t.nextRequestTimeoutId=null,e.tryTriggerNetworkRequest()},n))}}else this.tryTriggerNetworkRequest()},u.prototype.tryTriggerNetworkRequest=function(){var t=this,n=this.getQueuedRequest();if(null!==n&&!n.cancelToken.requested)try{var e=n.request,r=e.assetType,i=e.getRequestBuilder(this.requesterReturnedStatisticsStrategy.getNetworkStatistics(r)),o=null!=e.getApproximateResponseSizeBytes?e.getApproximateResponseSizeBytes():null,a=this.downloadDurationCalculator.estimateTotalDownloadDurationMs(r,o),s={request:n,startTimeMs:Date.now(),expectedCompletionTimeMs:Date.now()+a},l=null==n.request.id?"NetworkRequestManager-"+u.requestCounter++:n.request.id;this.diagnostics.report("network.scheduled",{id:l,channelId:this.id,timestamp:Date.now()}),this.inflightRequests.push(s);(null==i?Fe.Promise.resolve():this.statisticsTrackingExecutor.execute(n.request,i,n.cancelToken,r).then(n.onCompleted).catch(n.onFailed)).then(function(){var e=t.inflightRequests.indexOf(s);t.inflightRequests.splice(e,1),t.onRequestCompletion(s,e)}).catch(function(e){c.error("Unexpected error while triggering request completion:",e,e.stack)}),this.scheduleNextRequest()}catch(e){c.error("Unexpected error in request generation:",e,e.stack),n.onFailed(e),this.scheduleNextRequest(),0===this.inflightCount()&&A.timer.setImmediate(function(){t.onIdle()})}},u.prototype.onRequestCompletion=function(e,t){if(0===t&&0<this.linearizationPotential)null!=e.nextRequestTimeoutId&&A.timer.clearTimeout(e.nextRequestTimeoutId),this.tryTriggerNetworkRequest();else{for(var n=0;n<t;n++)this.inflightRequests[n].expectedCompletionTimeMs=1/0;this.scheduleNextRequest()}0===this.inflightCount()&&this.onIdle()},u.channelCounter=0,u.requestCounter=0,u}();t.LinearizationChannel=n});e(nh);nh.LinearizationChannel;var rh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("RequestScheduler");function n(e){return{id:e.id,linearizationPotential:e.linearizationPotential,inflightCount:e.inflightCount(),inflightRequests:e.getInflightDiagnosticMetadata()}}var r=function(){function e(e,t,n){var r=this;this.pendingRemovalChannels=[],this.activeLinearizationChannels=[],this.idleLinearizationChannels=[],this.linearizationPotential=1,this.getQueuedRequest=function(){var e=r.requestPool.getRequest();return r.reportDiagnostics(),e},this.diagnostics=pp.Diagnostics.create("NetworkRequestManager.RequestScheduler"),this.requestPool=e,this.linearizationChannelCount=n,this.statisticsStore=t,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.networkRequestManager&&(this.linearizationPotential=up.configurationStore.configuration.networkRequestManager.linearizationPotential),this.createNewChannels(this.linearizationChannelCount),this.reportDiagnostics()}return e.prototype.setConcurrentChannelCount=function(e){e>this.linearizationChannelCount?this.createNewChannels(e-this.linearizationChannelCount):e<this.linearizationChannelCount&&this.removeChannels(this.linearizationChannelCount-e),this.linearizationChannelCount=e,this.reportDiagnostics()},e.prototype.notifyItemEnqueued=function(){if(0!==this.requestPool.size()){if(0<this.idleLinearizationChannels.length){var e=this.idleLinearizationChannels.pop();e.notifyRequestAvailable(),this.activeLinearizationChannels.push(e)}this.reportDiagnostics()}else o.warn("Request pool is empty after new item is enqueued.")},e.prototype.createNewChannels=function(e){for(var r=this,t=function(e){var n=new nh.LinearizationChannel(i.linearizationPotential,i.statisticsStore,i.getQueuedRequest,function(){var e=r.pendingRemovalChannels.indexOf(n);if(0<=e)return r.pendingRemovalChannels.splice(e,1),void r.reportDiagnostics();var t=r.activeLinearizationChannels.indexOf(n);-1!==t?(r.activeLinearizationChannels.splice(t,1),r.idleLinearizationChannels.push(n),r.reportDiagnostics()):o.warn("LinearizationChannel '"+n.id+"' became idle while not active")});i.idleLinearizationChannels.push(n)},i=this,n=0;n<e;n++)t()},e.prototype.removeChannels=function(e){for(var t=0;t<e;t++){var n=(0<this.idleLinearizationChannels.length?this.idleLinearizationChannels:this.activeLinearizationChannels).pop();null!=n&&(n.updateLinearizationPotential(0),0<n.inflightCount()&&this.pendingRemovalChannels.push(n))}},e.prototype.reportDiagnostics=function(){var e={idleChannels:this.idleLinearizationChannels.map(n),activeChannels:this.activeLinearizationChannels.map(n),linearizationPoolSize:this.linearizationChannelCount,timestamp:Date.now()};0<this.pendingRemovalChannels.length&&(e.pendingRemovalChannels=this.pendingRemovalChannels.map(n)),this.diagnostics.report("state",e)},e}();t.RequestScheduler=r});e(rh);rh.RequestScheduler;var ih=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("NetworkStatisticsStore"),n=function(){function e(e,t,n,r){this.diagnostics=pp.Diagnostics.create("NetworkRequestManager.NetworkStatisticsStore."+r),this.statisticWindows=e,this.transferTimeMsTracker=new Rp.WindowSampleTracker(n),this.contentSizeBytesTracker=new Rp.WindowSampleTracker(n),this.latencyMsAggregator=new Rp.SampleAggregator(t),this.bandwidthKbpsAggregator=new Rp.SampleAggregator(t)}return e.prototype.addLatencySample=function(e){this.latencyMsAggregator.addSample(e),this.reportDiagnostics()},e.prototype.addContentTransferSample=function(e,t){this.transferTimeMsTracker.addSample(e),this.contentSizeBytesTracker.addSample(t);var n=this.transferTimeMsTracker.sum(),r=this.contentSizeBytesTracker.sum();this.bandwidthKbpsAggregator.addSample(8*r/n),this.reportDiagnostics()},e.prototype.getLatencyAverageMs=function(){return this.latencyMsAggregator.getAverage(this.statisticWindows.latencyAvgWindow)},e.prototype.getLatencyStdDevMs=function(){return this.latencyMsAggregator.getStdDev(this.statisticWindows.latencyStdDevWindow)},e.prototype.getBandwidthAverageKbps=function(){return this.bandwidthKbpsAggregator.getAverage(this.statisticWindows.bandwidthAverageWindow)},e.prototype.getBandwidthStdDevKbps=function(){return this.bandwidthKbpsAggregator.getStdDev(this.statisticWindows.bandwidthStdDevWindow)},e.prototype.getStatistics=function(){return{bandwidthAvgKbps:this.getBandwidthAverageKbps(),bandwidthStdDevKbps:this.getBandwidthStdDevKbps(),latencyAvgMs:this.getLatencyAverageMs(),latencyStdDevMs:this.getLatencyStdDevMs()}},e.prototype.serialize=function(){var e={version:1,transferTimeAggregator:this.transferTimeMsTracker.getSamples(),latencyAggregator:this.latencyMsAggregator.getSamplesInWindow(1/0),contentSizeAggregator:this.contentSizeBytesTracker.getSamples(),bandwidthAggregator:this.bandwidthKbpsAggregator.getSamplesInWindow(1/0)};return JSON.stringify(e)},e.prototype.deserialize=function(t){var e;try{var n=JSON.parse(t),r=n.version;if(1!==r)return o.warn("The version of the last known state ["+r+"] does not match the current version [1]"),!1;e=n}catch(e){return o.warn("Failed to parse last known state: "+t,e),!1}function i(e,t){t.reset();for(var n=0,r=e;n<r.length;n++){var i=r[n];if(null==i)throw new Error("Sample invalid");t.addSample(i)}}try{i(e.transferTimeAggregator,this.transferTimeMsTracker),i(e.latencyAggregator,this.latencyMsAggregator),i(e.contentSizeAggregator,this.contentSizeBytesTracker),i(e.bandwidthAggregator,this.bandwidthKbpsAggregator),this.reportDiagnostics()}catch(e){return o.error("Failed to reconstruct the last known bandwidth estimate state: "+t,e),this.reportDiagnostics(),!1}return!0},e.prototype.reportDiagnostics=function(){var e={statistics:this.getStatistics(),timestamp:Date.now()};this.diagnostics.report("state",e)},e}();t.NetworkStatisticsStore=n});e(ih);ih.NetworkStatisticsStore;var oh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.stores={},this.statisticWindows=e,this.eventStorageToRetain=t,this.bandwidthAggregationWindow=n,this.holisticStore=new ih.NetworkStatisticsStore(this.statisticWindows,this.eventStorageToRetain,this.bandwidthAggregationWindow,"holistic")}return e.prototype.getRawStatisticsStore=function(e){return null!=e&&null!=this.stores[e]?this.stores[e]:this.holisticStore},e.prototype.addLatencySample=function(e,t){this.holisticStore.addLatencySample(e),null!=t&&this.getStore(t).addLatencySample(e)},e.prototype.addContentTransferSample=function(e,t,n){this.holisticStore.addContentTransferSample(e,t),null!=n&&this.getStore(n).addContentTransferSample(e,t)},e.prototype.getStatistics=function(e){return this.getRawStatisticsStore(e).getStatistics()},e.prototype.serialize=function(){return this.holisticStore.serialize()},e.prototype.deserialize=function(e){return this.holisticStore.deserialize(e)},e.prototype.getStore=function(e){return null==this.stores[e]&&(this.stores[e]=new ih.NetworkStatisticsStore(this.statisticWindows,this.eventStorageToRetain,this.bandwidthAggregationWindow,e)),this.stores[e]},e}();t.AggregateNetworkStatisticsStore=n});e(oh);oh.AggregateNetworkStatisticsStore;var ah=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("NetworkRequestManager"),a="NetworkRequestManagerState",r={networkStatisticsWindows:{bandwidthAverageWindow:4,bandwidthStdDevWindow:4,latencyAvgWindow:4,latencyStdDevWindow:4},eventStorageToRetain:4,bandwidthAggregationWindow:4,maxConcurrentRequests:3},i=function(){function e(){this.config=r,this.diagnostics=pp.Diagnostics.create("NetworkRequestManager"),this.requestPool=new Hf.QueuedRequestPool,this.statisticsStore=new oh.AggregateNetworkStatisticsStore(this.config.networkStatisticsWindows,this.config.eventStorageToRetain,this.config.bandwidthAggregationWindow),this.scheduler=new rh.RequestScheduler(this.requestPool,this.statisticsStore,this.config.maxConcurrentRequests),this.loadState().catch(function(e){o.info("loadState failed with reason:",e)})}return e.prototype.updateConfig=function(e){xt.sanitize(e),this.config=n({},this.config,e),this.scheduler.setConcurrentChannelCount(this.config.maxConcurrentRequests),this.reportDiagnostics()},e.prototype.requestDownload=function(e,t){var n=this.requestPool.enqueue(e,t);return M.enabledFor(M.DEBUG)&&n.then(function(e){}).catch(function(e){}),this.scheduler.notifyItemEnqueued(),n},e.prototype.getNetworkStatistics=function(){return this.statisticsStore.getStatistics()},e.prototype.storeState=function(){var r=this.statisticsStore.serialize();return new Fe.Promise(function(t,n){Wf.keyValueStore.set(a,r,function(e){null!=e?(o.warn("Failed to store the current state, reason:",e),n(e)):(o.info("Successfully stored the current state:",r),t())})})},e.prototype.loadState=function(){var i=this;return new Fe.Promise(function(n,r){Wf.keyValueStore.get(a,function(e,t){if(null!=e)o.warn("Failed to retrieve the last known state, reason:",e),r(e);else{if(null!=t){if(o.info("Successfully retrieved last known state:",t),!i.statisticsStore.deserialize(t))return void i.removeState().then(n).catch(r)}else o.info("Last state was never stored under key:",a);n()}})})},e.prototype.removeState=function(){return new Fe.Promise(function(t,n){Wf.keyValueStore.set(a,void 0,function(e){null!=e?(o.warn("Failed to remove existing stored state, reason:",e),n(e)):t()})})},e.prototype.reportDiagnostics=function(){var e={config:this.config,timestamp:Date.now()};this.diagnostics.report("state",e)},e}();t.NetworkRequestManager=i});e(ah);ah.NetworkRequestManager;var sh=null,lh={AcquisitionError:Xf.AcquisitionError,getInstance:function(){return null===sh&&(sh=new ah.NetworkRequestManager),sh}},uh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.reportAcquisitionEventsForInFlightRequest=function(i,e,o){var a=this;e.once("success",function(e){var t=a.createNonFragmentAcquisitionRequest(e.url,e.headers),n=a.createAcquisitionResponse(!0,e.status,e.totalBytes,e.headers),r=a.createAcquisitionPerformance(e.latencyMs,e.downloadTimeMs);o.reportAcquisition(i,t,n,r)}),e.once("fail",function(e){var t=a.createNonFragmentAcquisitionRequest(e.url,e.headers),n=a.createAcquisitionResponse(!1,e.status||0,e.totalBytes||0,e.headers||{}),r=a.createAcquisitionPerformance(e.latencyMs||0,e.downloadTimeMs||0);o.reportAcquisition(i,t,n,r)})},e.createNonFragmentAcquisitionRequest=function(e,t){return{url:e,bytesExpected:null,server:this.createEdgeServer(e,t)}},e.createEdgeServer=function(e,t){var n=xt.exists(t)?t["x-server-ip"]:null;return{hostname:new Ce.URL(e).hostname,ipv4:xt.exists(n)&&Ce.IPAddress.isValidIPv4Address(n)?n:null,ipv6:null}},e.createAcquisitionResponse=function(e,t,n,r,i){var o="Success",a=i instanceof lh.AcquisitionError?i:null;return e||(o=null!==a&&"Timeout"===a.reason.type?"NetworkTimeout":"UnknownError"),{response:o,responseCode:t,bytesAcquired:n,headers:this.convertHeaderValueFromStringToArray(r)}},e.createAcquisitionPerformance=function(e,t){return{timeToFirstByte:Math.round(e),timeToLastByte:Math.round(e+t)}},e.convertHeaderValueFromStringToArray=function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t[i]=[e[i]]}return t},e}();t.AcquisitionEventFactory=n});e(uh);uh.AcquisitionEventFactory;var ch=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.avod.xray.FragmentVersion,n=function(){function n(){}return n.setFragmentVersion=function(e){this.fragmentVersion=e},n.prototype.startTimer=function(){this.startTime=Date.now(),this.elapsedTime=null},n.prototype.endTimerAndReport=function(e,t){if(this.startTime){var n=M.get(t);this.elapsedTime=Date.now()-this.startTime,Uf.XrayPmetReporter.putMetric(e,this.elapsedTime,jf.XrayMetricsConstants.XRAY_TIME_UNIT_MS),n.info("Reporting METRIC: "+e+" Took: "+this.elapsedTime+jf.XrayMetricsConstants.XRAY_TIME_UNIT_MS)}},n.prototype.endTimerAndReportInitialLoad=function(e){if(void 0===e&&(e=!0),null===this.elapsedTime)if(this.elapsedTime=Date.now()-this.startTime,e){Uf.XrayPmetReporter.putMetric(jf.XrayMetricsConstants.XRAY_DATA_LOAD_TIME_STREAMING,this.elapsedTime,jf.XrayMetricsConstants.XRAY_TIME_UNIT_MS);var t="LiveSwift"===n.fragmentVersion?jf.XrayMetricsConstants.XRAY_DATA_LOAD_TIME_STREAMING_LIVE:jf.XrayMetricsConstants.XRAY_DATA_LOAD_TIME_STREAMING_FEATURE;Uf.XrayPmetReporter.putMetric(t,this.elapsedTime,jf.XrayMetricsConstants.XRAY_TIME_UNIT_MS)}else{Uf.XrayPmetReporter.putMetric(jf.XrayMetricsConstants.XRAY_DATA_LOAD_FAIL_STREAMING,this.elapsedTime,jf.XrayMetricsConstants.XRAY_TIME_UNIT_MS);t="LiveSwift"===n.fragmentVersion?jf.XrayMetricsConstants.XRAY_DATA_LOAD_FAIL_STREAMING_LIVE:jf.XrayMetricsConstants.XRAY_DATA_LOAD_FAIL_STREAMING_FEATURE;Uf.XrayPmetReporter.putMetric(t,this.elapsedTime,jf.XrayMetricsConstants.XRAY_TIME_UNIT_MS)}},n.fragmentVersion=r.SWIFT,n}();t.LoadMetricsReporter=n});e(ch);ch.LoadMetricsReporter;var dh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="/cdp/insights/reportEvent/v1/xrayclient",i={},n="XRAY_INSIGHT_METRIC_CACHE",o=M.get("XrayInsightClient"),a=function(){function e(e,t){this.queuedMetric=[];var n=!!xt.exists(t)&&(!!F.isBoolean(t)&&t);this.metricServerClent=e.createBasicServiceClient(n?"/cdp/insights/reportEvent/v1/xrayclient-dev":r,i)}return e.prototype.start=function(){var e,t=this;(e=this.queuedMetric).push.apply(e,this.readMetricFromLocalStorage()),this.reportingInterval=setInterval(function(){60<=t.queuedMetric.length&&(t.postEvents(t.queuedMetric),t.queuedMetric=[])},1e4),this.localStorageSyncInterval=setInterval(function(){t.saveMetricToLocalStorage()},2e4)},e.prototype.stop=function(){clearInterval(this.reportingInterval),clearInterval(this.localStorageSyncInterval),this.saveMetricToLocalStorage()},e.prototype.sendEvent=function(e){this.queuedMetric.push(e)},e.prototype.getQueueSize=function(){return this.queuedMetric.length},e.prototype.postEvents=function(e){var t={method:"POST",body:JSON.stringify(e)};this.metricServerClent.send(t,Fe.CancelToken.source().token).then(function(e){return e.response()}).then(function(e){o.log(e.getStatus())})},e.prototype.readMetricFromLocalStorage=function(){if(!this.isInNodeJS()){var e=localStorage.getItem(n);if(xt.exists(e)&&0<e.length)return JSON.parse(e)}return[]},e.prototype.saveMetricToLocalStorage=function(){if(!this.isInNodeJS())try{localStorage.setItem(n,JSON.stringify(this.queuedMetric))}catch(e){o.error("Unable to store queued insights events in localStorage: "+e)}},e.prototype.isInNodeJS=function(){return"object"==typeof process&&"object"==typeof process.versions&&void 0!==process.versions.node},e}();t.XrayInsightEventQueueReporter=a});e(dh);dh.XrayInsightEventQueueReporter;var ph=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.v4=function(){for(var e=Se.randomEngine,t=new Uint8Array(16),n=0;n<16;n++)t[n]=256*e.getRandom();return t[6]=15&t[6]|64,t[8]=63&t[8]|128,this.bytesToUuid(t)},e.bytesToUuid=function(e){for(var t=[],n=0;n<256;n++)t[n]=(n+256).toString(16).substr(1);var r=0;return[t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],"-",t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[r++]],t[e[15]]].join("")},e}();t.UUID=n});e(ph);ph.UUID;var fh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UUID=ph.UUID});e(fh);fh.UUID;var hh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){this.hardware={deviceTypeId:"AOAGZA014O5RE"},this.software={operatingSystem:{name:"UNKNOWN"},middleware:{name:"UNKNOWN",version:"UNKNOWN",userAgent:navigator.userAgent}},this.storage={fragmentCache:{sizeBytes:52428800}}};t.DeviceInformationW3C=n});e(hh);hh.DeviceInformationW3C;var mh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.intervalId=null,this.throttledEventListener=null,this.eventEmitter=new Dt.EventEmitter,this.output={video:{display:{height:screen.height,width:screen.width,dynamicRangeFormatSupport:[],hdcpStatus:"Unknown"},applicationViewport:{height:window.innerHeight,width:window.innerWidth}}},this.network={type:xt.nestedValue(navigator,"connection.type","unknown")}}return e.prototype.on=function(t,e){var n=this;switch(t){case"output.video.display":this.eventEmitter.on(t,e),null==this.intervalId&&(this.intervalId=A.timer.setInterval(function(){var e={height:screen.height,width:screen.width,dynamicRangeFormatSupport:[],hdcpStatus:"Unknown"};n.output.video.display=e,n.eventEmitter.emit(t,e)},1e4));break;case"output.video.applicationViewport":this.eventEmitter.on(t,e),null==this.throttledEventListener&&(this.throttledEventListener=new Ce.ThrottledEventListener,this.throttledEventListener.attachThrottledListener(window,"resize",1e4,function(){var e={height:window.innerHeight,width:window.innerWidth};n.output.video.applicationViewport=e,n.eventEmitter.emit(t,e)}));break;case"network":var r=navigator.connection;r&&r.onchange&&r.addEventListener("change",e)}},e.prototype.off=function(e,t){switch(e){case"output.video.display":this.eventEmitter.off(e,t),null!=this.intervalId&&0===this.eventEmitter.listeners(e).length&&(A.timer.clearInterval(this.intervalId),this.intervalId=null);break;case"output.video.applicationViewport":this.eventEmitter.off(e,t),null!=this.throttledEventListener&&0===this.eventEmitter.listeners(e).length&&(this.throttledEventListener.removeThrottledListener(),this.throttledEventListener=null);break;case"network":var n=navigator.connection;n&&n.onchange&&n.removeEventListener("change",t)}},e}();t.DeviceCapabilitiesW3C=n});e(mh);mh.DeviceCapabilitiesW3C;var yh={deviceInformation:new hh.DeviceInformationW3C,initDeviceInformation:function(e,t){t()},deviceCapabilities:new mh.DeviceCapabilitiesW3C,initDeviceCapabilities:function(e,t){t()},DeviceInformationW3C:hh.DeviceInformationW3C,DeviceCapabilitiesW3C:mh.DeviceCapabilitiesW3C},gh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.configure=function(e){this.configuration=e},e.prototype.evaluate=function(e){return new Function(e)()},e.prototype.onUncaughtException=function(e){},e.prototype.loadavg=function(){return null},e}();t.WebPlatformRuntime=n});e(gh);gh.WebPlatformRuntime;var vh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformRuntime=gh.WebPlatformRuntime;var n=new gh.WebPlatformRuntime;t.platformRuntime=n});e(vh);vh.PlatformRuntime,vh.platformRuntime;var Sh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=/^.*(\.(amazon|primevideo)\.(com|co.jp|co.uk|de))$/,a=/^.*(\.imdb\.com)$/,n=function(){function i(){}return i.fromMarketplaceId=function(e){var t=xt.nestedValue(vh.platformRuntime.configuration,"clientConfig.useCurrentDomain",!0),n=i.getDomain(e,t,window);return"https://"+i.getSubdomain(e,n)+n},i.getDomain=function(e,t,n){if(t){var r=n.location.host.match(o);if(null!==r)return r[1];if(e===Y.MarketplaceID.US&&null!==(r=n.location.host.match(a)))return r[1]}return i.getDomainFromMarketplaceId(e)},i.getSubdomain=function(e,t){if(".imdb.com"===t)return"primevideo-dp-na";switch(e){case Y.MarketplaceID.US:return xt.nestedValue(vh.platformRuntime.configuration,"clientConfig.useGammaPartnerService",!1)?"atv-ps-gamma":"atv-ps";case Y.MarketplaceID.ROW_NA:return"atv-ps";case Y.MarketplaceID.ROE_EU:case Y.MarketplaceID.ROW_EU:case Y.MarketplaceID.UK:case Y.MarketplaceID.DE:return"atv-ps-eu";case Y.MarketplaceID.ROW_FE:case Y.MarketplaceID.JP:return"atv-ps-fe";default:throw new Error("Can't get PartnerServiceEndpoint for unknown MarketplaceId! Received: "+e)}},i.getDomainFromMarketplaceId=function(e){switch(e){case Y.MarketplaceID.ROW_NA:case Y.MarketplaceID.ROE_EU:case Y.MarketplaceID.ROW_EU:case Y.MarketplaceID.ROW_FE:return".primevideo.com";case Y.MarketplaceID.DE:return".amazon.de";case Y.MarketplaceID.JP:return".amazon.co.jp";case Y.MarketplaceID.UK:return".amazon.co.uk";default:return".amazon.com"}},i}();t.PartnerServiceEndpoint=n});e(Sh);Sh.PartnerServiceEndpoint;var bh=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this)||this;return t.clientConfig=null!=e.clientConfig?e.clientConfig:null,t}return i(e,n),Object.defineProperty(e.prototype,"deviceProxyUrl",{get:function(){if(null!==this.clientConfig&&null!=this.clientConfig.marketplaceId)return Sh.PartnerServiceEndpoint.fromMarketplaceId(this.clientConfig.marketplaceId)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gascEnabled",{get:function(){return"primevideo.com"===window.location.hostname},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"marketplaceId",{get:function(){if(null!==this.clientConfig&&null!=this.clientConfig.marketplaceId)return this.clientConfig.marketplaceId},enumerable:!0,configurable:!0}),e}(yh.DeviceCapabilitiesW3C);t.DeviceCapabilitiesWeb=n});e(bh);var Th,Ph;bh.DeviceCapabilitiesWeb;(Ph=Th||(Th={}))[Ph.Unknown=0]="Unknown",Ph[Ph.AmazonWebView=1]="AmazonWebView",Ph[Ph.Android=2]="Android",Ph[Ph.AppleWebKit=3]="AppleWebKit",Ph[Ph.BlackBerry=4]="BlackBerry",Ph[Ph.Chrome=5]="Chrome",Ph[Ph.Chromium=6]="Chromium",Ph[Ph.Edge=7]="Edge",Ph[Ph.EdgeNext=8]="EdgeNext",Ph[Ph.Firefox=9]="Firefox",Ph[Ph.Firefox64=10]="Firefox64",Ph[Ph.IE=11]="IE",Ph[Ph.Opera=12]="Opera",Ph[Ph.Safari=13]="Safari",Ph[Ph.SeaMonkey=14]="SeaMonkey",Ph[Ph.Silk=15]="Silk";var wh,Ch,Mh=Th,Ih=Ce.Version,Eh=function(){function a(e,t){this.type=e,this.version=null!=t?t:null}return a.fromUserAgent=function(e){for(var t=0,n=a.REGEXES;t<n.length;t++){var r=n[t],i=r.regex.exec(e);if(i){var o=i[1]?Ih.fromString(i[1]):null;return new a(r.type,o)}}return new a(Mh.Unknown)},a.prototype.getType=function(){return this.type},a.prototype.getVersion=function(){return this.version},a.prototype.toString=function(){var e=Mh[this.type];return null!==this.version&&(e+=" "+this.version),e},a.prototype.equals=function(e){return this.type===e.type&&(null===this.version?null===e.version:this.version.equals(e.version))},a.UNKNOWN=new a(Mh.Unknown),a.REGEXES=[{regex:/(?:Camino|Chimera|hpwOS|webOS|Play[Ss]tation)\//,type:Mh.Unknown},{regex:/Silk\/(\d+[.0-9\-]+)/,type:Mh.Silk},{regex:/(?:BlackBerry|BB10).*Version\/(\d+[.0-9]*)/,type:Mh.BlackBerry},{regex:/(?:OPR\/|Opera |Opera.*Version\/)(\d+[.0-9]*)/,type:Mh.Opera},{regex:/(?:Edg)\/(\d+[.0-9]*)/,type:Mh.EdgeNext},{regex:/(?:Edge)\/(\d+[.0-9]*)/,type:Mh.Edge},{regex:/(?:MSIE |Trident.*rv:)(\d+[.0-9]*)/,type:Mh.IE},{regex:/Chromium\/(\d+[.0-9]*)/,type:Mh.Chromium},{regex:/(?:Chrome|CriOS)\/(\d+[.0-9]*)/,type:Mh.Chrome},{regex:/SeaMonkey\/(\d+[.0-9]*)/,type:Mh.SeaMonkey},{regex:/x64;.*Firefox\/(\d+[.0-9]*)/,type:Mh.Firefox64},{regex:/Firefox\/(\d+[.0-9]*)/,type:Mh.Firefox},{regex:/(?:Amazon.com|Windowshop|Amazon)\/(\d+[.0-9]*)/,type:Mh.AmazonWebView},{regex:/Android[ \-/](\d+[.0-9a-z\-]*)/,type:Mh.Android},{regex:/Version\/(\d+[.0-9]*).*Safari/,type:Mh.Safari},{regex:/AppleWebKit\/(\d+[.0-9]*)/,type:Mh.AppleWebKit}],a}();(Ch=wh||(wh={}))[Ch.Unknown=0]="Unknown",Ch[Ch.Android=1]="Android",Ch[Ch.BlackBerry=2]="BlackBerry",Ch[Ch.ChromeOS=3]="ChromeOS",Ch[Ch.FirefoxOS=4]="FirefoxOS",Ch[Ch.GoogleTV=5]="GoogleTV",Ch[Ch.iOS=6]="iOS",Ch[Ch.Linux=7]="Linux",Ch[Ch.Mac=8]="Mac",Ch[Ch.MacPPC=9]="MacPPC",Ch[Ch.Windows=10]="Windows",Ch[Ch.WindowsPhone=11]="WindowsPhone",Ch[Ch.WindowsRT=12]="WindowsRT",Ch[Ch.XboxOne=13]="XboxOne";var _h,xh,kh,Rh,Ah=wh,Oh=V&&V.__extends||(_h=function(e,t){return(_h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}_h(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Lh=Ce.Version;(Rh=kh||(kh={}))[Rh.Windows2000=0]="Windows2000",Rh[Rh.WindowsXP=1]="WindowsXP",Rh[Rh.WindowsVista=2]="WindowsVista",Rh[Rh.Windows7=3]="Windows7",Rh[Rh.Windows8=4]="Windows8",Rh[Rh.Windows8_1=5]="Windows8_1",Rh[Rh.Windows10=6]="Windows10";var Fh,Dh={"5.0":kh.Windows2000,5.1:kh.WindowsXP,5.2:kh.WindowsXP,"6.0":kh.WindowsVista,6.1:kh.Windows7,6.2:kh.Windows8,6.3:kh.Windows8_1,6.4:kh.Windows10,"10.0":kh.Windows10,10.1:kh.Windows10,10.2:kh.Windows10},Nh=((xh={})[kh.Windows2000]="2000",xh[kh.WindowsXP]="XP",xh[kh.WindowsVista]="Vista",xh[kh.Windows7]="7",xh[kh.Windows8]="8",xh[kh.Windows8_1]="8.1",xh[kh.Windows10]="10",xh),Uh=function(t){function n(e){return t.call(this,[e],Nh[e])||this}return Oh(n,t),n.fromKernelVersion=function(e){var t=Dh[e];if(null==t)throw new Error("Unexpected Windows kernel version: "+e);return new n(t)},n.WINDOWS_2000=new n(kh.Windows2000),n.WINDOWS_XP=new n(kh.WindowsXP),n.WINDOWS_VISTA=new n(kh.WindowsVista),n.WINDOWS_7=new n(kh.Windows7),n.WINDOWS_8=new n(kh.Windows8),n.WINDOWS_8_1=new n(kh.Windows8_1),n.WINDOWS_10=new n(kh.Windows10),n}(Lh),Bh=Ce.Version,Vh=((Fh={})[Ah.Unknown]="Unknown",Fh[Ah.Android]="Android",Fh[Ah.BlackBerry]="BlackBerry",Fh[Ah.ChromeOS]="Chrome OS",Fh[Ah.FirefoxOS]="Firefox OS",Fh[Ah.GoogleTV]="Google TV",Fh[Ah.iOS]="iOS",Fh[Ah.Linux]="Linux",Fh[Ah.Mac]="Mac OS X",Fh[Ah.MacPPC]="Mac OS PPC",Fh[Ah.Windows]="Windows",Fh[Ah.WindowsPhone]="Windows Phone",Fh[Ah.WindowsRT]="Windows RT",Fh[Ah.XboxOne]="Xbox One",Fh),jh=function(){function o(e,t,n){this.family=e,this.version=null!=t?t:Bh.createUnknownVersion(),this.kernelVersion=null!=n?n:this.version}return o.fromUserAgent=function(e){for(var t=0,n=o.REGEXES;t<n.length;t++){var r=n[t],i=r.regex.exec(e);if(i)return r.handler(i)}return new o(Ah.Unknown)},o.prototype.getFamily=function(){return this.family},o.prototype.getFamilyName=function(){return Vh[this.family]||null},o.prototype.getVersion=function(){return this.version},o.prototype.getKernelVersion=function(){return this.kernelVersion},o.prototype.toString=function(){var e=Vh[this.family];return null===this.version||this.version.isUnknownVersion()||(e+=" "+this.version),e},o.prototype.equals=function(e){return this.family===e.family&&(null===this.version?null===e.version:this.version.equals(e.version))},o.UNKNOWN=new o(Ah.Unknown),o.MAC_OS_X_YOSEMITE=new o(Ah.Mac,Bh.fromString("10.10")),o.WINDOWS_2000=new o(Ah.Windows,Uh.WINDOWS_2000),o.WINDOWS_XP=new o(Ah.Windows,Uh.WINDOWS_XP),o.WINDOWS_VISTA=new o(Ah.Windows,Uh.WINDOWS_VISTA),o.WINDOWS_7=new o(Ah.Windows,Uh.WINDOWS_7),o.WINDOWS_8=new o(Ah.Windows,Uh.WINDOWS_8),o.WINDOWS_8_1=new o(Ah.Windows,Uh.WINDOWS_8_1),o.WINDOWS_10=new o(Ah.Windows,Uh.WINDOWS_10),o.REGEXES=[{regex:/Windows ?Mobile|Xbox(?!.*One)|Play[Ss]tation/,handler:function(){return new o(Ah.Unknown)}},{regex:/Windows Phone(?: (?:OS[ /])?(\d+[.0-9]*))?/,handler:function(e){var t=e[1]?Bh.fromString(e[1]):null;return new o(Ah.WindowsPhone,t)}},{regex:/Xbox One(?: (?:OS[ /])?(\d+[.0-9]*))?/,handler:function(e){var t=e[1]?Bh.fromString(e[1]):null;return new o(Ah.XboxOne,t)}},{regex:/(?:BB10|BlackBerry)(?:.*Version\/(\d+[.0-9]*))?/,handler:function(e){var t=e[1]?Bh.fromString(e[1]):null;return new o(Ah.BlackBerry,t)}},{regex:/GoogleTV(?:[ /]([0-9a-b]+[.0-9]*))?/,handler:function(e){var t=e[1]?Bh.fromString(e[1]):null;return new o(Ah.GoogleTV,t)}},{regex:/Android(?:[ \-/](\d+[.0-9a-z\-]*))?|\bSilk\b/,handler:function(e){var t=e[1]?Bh.fromString(e[1]):null;return new o(Ah.Android,t)}},{regex:/CrOS(?: i686 (\d+[.0-9]*))?/,handler:function(e){var t=e[1]?Bh.fromString(e[1]):null;return new o(Ah.ChromeOS,t)}},{regex:/(?:iPad|iPhone|iPod)(?:.*OS (\d+[_.0-9]*))?/,handler:function(e){var t=e[1]?Bh.fromString(e[1].replace(/_/g,".")):null;return new o(Ah.iOS,t)}},{regex:/Intel Mac OS X(?: (\d+[_.0-9]*))?/,handler:function(e){var t=e[1]?Bh.fromString(e[1].replace(/_/g,".")):null;return new o(Ah.Mac,t)}},{regex:/PPC Mac OS(?: X)?(?: (\d+[_.0-9]*))?/,handler:function(e){var t=e[1]?Bh.fromString(e[1].replace(/_/g,".")):null;return new o(Ah.MacPPC,t)}},{regex:/Windows NT(?: (5\.[012]|6\.[01234]))?.*ARM/,handler:function(e){var t=e[1],n=t?Uh.fromKernelVersion(t):null,r=t?Bh.fromString(t):null;return new o(Ah.WindowsRT,n,r)}},{regex:/Windows NT(?: (5\.[012]|6\.[01234]|10\.[012]))?/,handler:function(e){var t=e[1],n=t?Uh.fromKernelVersion(t):null,r=t?Bh.fromString(t):null;return new o(Ah.Windows,n,r)}},{regex:/Linux/,handler:function(){return new o(Ah.Linux)}},{regex:/Mozilla\/5.0 \((?:Mobile|Tablet); (?:[0-9A-Za-z .\-]+; )?rv:\d+[.0-9]*\) Gecko\/\d+[.0-9]* Firefox\/\d+[.0-9]*/,handler:function(){return new o(Ah.FirefoxOS)}}],o}(),Xh={Browser:Eh,BrowserType:Mh,OperatingSystem:jh,OperatingSystemFamily:Ah,WindowsVersion:Uh,getBrowser:function(e){return void 0===e&&(e=navigator.userAgent),Eh.fromUserAgent(e)},getOperatingSystem:function(e){return void 0===e&&(e=navigator.userAgent),jh.fromUserAgent(e)}},zh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Xh.BrowserType,n=function(e,t,n,r){void 0===t&&(t=Xh.getBrowser()),void 0===n&&(n=Xh.getOperatingSystem()),this.hardware={deviceTypeId:e,isHighPerformance:!0},this.software={operatingSystem:{name:n.getFamilyName(),version:n.getKernelVersion().toString()},middleware:{name:i[t.getType()],version:xt.exists(t.getVersion())?t.getVersion().toString():"UNKNOWN",userAgent:xt.withDefault(r,navigator.userAgent)},playerBundle:{name:"ATVWebPlayerSDK",version:"ATVWebPlayerSDK-1.0.209200.0"},nativeApplication:{name:i[t.getType()],version:xt.exists(t.getVersion())?t.getVersion().toString():"UNKNOWN"}},this.storage={fragmentCache:{sizeBytes:235929600}}};t.DeviceInformationWeb=n});e(zh);zh.DeviceInformationWeb;var qh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.applicationName=e.an,this.applicationVersion=e.av,this.operatingSystem=e.os,this.operatingSystemVersion=e.ov,this.productLine=e.di.pr,this.model=e.di.md,this.modelVersion=e.di.v,this.manufacturer=e.di.mf,this.deviceSerialNumber=e.di.dsn,this.deviceTypeId=e.di.dti,this.serviceProvider=e.di.ca,this.connectionType=e.di.ct,this.displayHeight=e.dm.h,this.displayWidth=e.dm.w}return e.prototype.getSimulatedUserAgent=function(){return this.applicationName+"/"+this.applicationVersion+" ("+this.operatingSystem+"/"+this.operatingSystemVersion+"/"+this.model+")"},e}();t.MashCookie=n});e(qh);qh.MashCookie;var Wh=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=qh.MashCookie,a=M.get("MashDeviceInformationFactory"),n=function(){function e(){}return e.fromCookie=function(t,n){try{var e=new o(JSON.parse(n.slice(n.indexOf("{")))),r=Xh.Browser.fromUserAgent(e.getSimulatedUserAgent()),i=Xh.OperatingSystem.fromUserAgent(e.getSimulatedUserAgent());return new zh.DeviceInformationWeb(t,r,i,e.getSimulatedUserAgent())}catch(e){return a.warn("Error parsing the MASH cookie. Returning unknown browser and operating system. Cookie format: "+n,e),new zh.DeviceInformationWeb(t,Xh.Browser.UNKNOWN,Xh.OperatingSystem.UNKNOWN)}},e}();t.MashDeviceInformationFactory=n});e(Wh);Wh.MashDeviceInformationFactory;var Hh=V&&V.__assign||function(){return(Hh=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Gh=null,Kh=null,Qh={};var Yh={setDeviceCapabilitiesClientConfig:function(e){Qh=e},get deviceInformation(){return Gh},initDeviceInformation:function(e,t){var n=(new Ce.CookieStorage).get("amzn-app-ctxt");Gh=xt.exists(n)?Wh.MashDeviceInformationFactory.fromCookie(e.deviceTypeId,n):new zh.DeviceInformationWeb(e.deviceTypeId),t()},get deviceCapabilities(){return Kh},initDeviceCapabilities:function(e,t){e.clientConfig=Hh({},e.clientConfig,Qh),Kh=new bh.DeviceCapabilitiesWeb(e),t()}},Jh=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReceiveTitleInfo"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.ReceiveTitleInfoAction=n});e(Jh);Jh.ReceiveTitleInfoAction;var $h=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).RESOURCE_LOAD="ResourceLoad",r.SESSION_START="SessionStart",r.SESSION_END="SessionEnd",r.IMPRESSION_START="ImpressionStart",r.IMPRESSION_END="ImpressionEnd",r.INTERACTION="Interaction",r.PLAYBACK="Playback",r.ERROR="Error",t.XrayInsightEventType=n});e($h);$h.XrayInsightEventType;var Zh=t(function(e,t){var r,n,i,o=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),(i=n||(n={}))[i.JOIN_LIVE=0]="JOIN_LIVE",i[i.RESUME=1]="RESUME",t.XrayHighlightExitType=n;var a=function(t){function n(e){return t.call(this,n.getName(),e)||this}return o(n,t),n.getName=function(){return"Xray.HighlightModeAction"},n.store=new Lf.ActionStore(n.getName(),{isHighlightModeOn:!1,shouldTransitionExit:!1}),n}(Lf.Action);t.XrayHighlightModeAction=a});e(Zh);Zh.XrayHighlightExitType,Zh.XrayHighlightModeAction;var em=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReplayBoothModeAction"},n.store=new Lf.ActionStore(n.getName(),{isReplayBoothOn:!1}),n}(Lf.Action);t.XrayReplayBoothModeAction=n});e(em);em.XrayReplayBoothModeAction;var tm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.XrayPlaybackContextAction"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.XrayPlaybackContextAction=n});e(tm);tm.XrayPlaybackContextAction;var nm=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});S.of("XrayInsightContentTypeStore");var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.valueFunction=function(e,t,n,r){return xt.exists(n)&&n.isReplayBoothOn||xt.exists(r)&&r.isHighlightModeOn?"XrayHighlight":xt.exists(t)?t.videoMaterialType:"UNKNOWN"},t.getInstance=function(){return t.instance},t.instance=new Lf.ComputedValueStore("XrayInsightContentTypeStore",[tm.XrayPlaybackContextAction.store,em.XrayReplayBoothModeAction.store,Zh.XrayHighlightModeAction.store],t.valueFunction,"UNKNOWN"),t}(Lf.ComputedValueStore);t.XrayInsightContentTypeStore=i});e(nm);nm.XrayInsightContentTypeStore;var rm=t(function(e,t){var s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.contentInfoActionStore=Jh.ReceiveTitleInfoAction.store,this.contentTypeStore=nm.XrayInsightContentTypeStore.getInstance(),this.xrayToken=e,this.playerSdkSessionId=xt.exists(t.playerSdkSessionId)?t.playerSdkSessionId:fh.UUID.v4(),this.primitiveSessionId=xt.exists(t.primitiveSessionId)?t.primitiveSessionId:fh.UUID.v4(),this.bundleId=t.bundleId}return e.prototype.buildResourceLoadEvent=function(e,t,n,r,i,o,a){return xt.exists(this.contentInfoActionStore.getValue())?s({},this.buildCommonParams($h.XrayInsightEventType.RESOURCE_LOAD),{resourceId:e,resourceType:t,isCached:n,bytesDownloaded:r,timeToFirstByteMillis:i,timeToLastByteMillis:o,videoBitrate:a}):null},e.prototype.buildSessionStartEvent=function(e,t){return xt.exists(this.contentInfoActionStore.getValue())?s({},this.buildCommonParams($h.XrayInsightEventType.SESSION_START),{referenceId:t,initiationReason:e}):null},e.prototype.buildSessionEndEvent=function(e,t,n){return xt.exists(this.contentInfoActionStore.getValue())?s({},this.buildCommonParams($h.XrayInsightEventType.SESSION_END),{referenceSessionStartId:e,sessionDurationMillis:t,exitReason:n}):null},e.prototype.buildImpressionStartEvent=function(e,t,n,r){return xt.exists(this.contentInfoActionStore.getValue())?s({},this.buildCommonParams($h.XrayInsightEventType.IMPRESSION_START),{impressionType:e,referenceId:t,parentImpressionId:n,sessionId:r}):null},e.prototype.buildImpressionEndEvent=function(e,t,n,r,i,o){return xt.exists(this.contentInfoActionStore.getValue())?s({},this.buildCommonParams($h.XrayInsightEventType.IMPRESSION_END),{referenceId:e,referenceStartImpressionId:t,impressionDurationMillis:n,sessionId:o,enabledImpressionCount:r,completedImpressionCount:i}):null},e.prototype.buildInteractionEvent=function(e,t,n){return xt.exists(this.contentInfoActionStore.getValue())?s({},this.buildCommonParams($h.XrayInsightEventType.INTERACTION),{referenceId:e,interactionType:t,sessionId:n}):null},e.prototype.buildPlaybackEvent=function(e,t,n,r){return s({},this.buildCommonParams($h.XrayInsightEventType.PLAYBACK),{playbackEventType:e,playbackSessionType:t.sessionType,playbackSessionId:t.sessionId,contentId:t.contentId,playbackUrl:t.playbackUrl,sessionId:n,duration:r})},e.prototype.buildErrorEvent=function(e,t,n,r,i,o){return xt.exists(this.contentInfoActionStore.getValue())?s({},this.buildCommonParams($h.XrayInsightEventType.ERROR),{errorType:e,message:t,uri:n,statusCode:r,sessionId:i,playbackSessionId:o}):null},e.prototype.buildCommonParams=function(e){var t=this.contentInfoActionStore.getValue(),n=this.contentTypeStore.getValue(),r=fh.UUID.v4(),i=Math.floor((new Date).getTime()/1e3),o=null===t?"UNKNOWN":t.titleId,a=this.playerSdkSessionId,s=this.primitiveSessionId,l=xt.exists(Yh.deviceInformation)&&xt.exists(Yh.deviceInformation.software.playerBundle)?Yh.deviceInformation.software.playerBundle.version:"UNKNOWN_VERSION",u=xt.exists(this.bundleId)?this.bundleId:l;return{id:r,uniqueId:r,creationDate:i,eventType:e,titleIdentifier:o,contentType:n,xrayTokenVersion:this.xrayToken,weblabTreatments:"",appVersion:u,userWatchSessionId:a,primitiveSessionId:s}},e}();t.XrayInsightEventBuilder=n});e(rm);rm.XrayInsightEventBuilder;var im=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.keyFunction=e,this.map={},this.inputMap={}}return e.prototype.get=function(e){var t=this.keyFunction(e);return this.map[t]||null},e.prototype.put=function(e,t){var n=this.keyFunction(e);this.map[n]=t,this.inputMap[n]=e},e.prototype.remove=function(e){var t=this.keyFunction(e),n=this.get(e);return null!==n&&(delete this.map[t],delete this.inputMap[t]),n},e.prototype.clear=function(){this.map={},this.inputMap={}},e.prototype.keys=function(){return F.values(this.inputMap)},e.prototype.values=function(){return F.values(this.map)},e}();t.KeyedMap=n});e(im);im.KeyedMap;var om=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("XrayInsightClient");var n=function(){function r(e,t,n){this.isStarted=!1,this.currentSessionReferenceId=void 0,this.insightEventQueueReporter=new dh.XrayInsightEventQueueReporter(e,n.debug),this.durationMap=new im.KeyedMap(function(e){return e}),this.xrayInsightEventBuilder=new rm.XrayInsightEventBuilder(t,n)}return r.initialize=function(e,t,n){this._instance=new r(e,t,n)},r.getInstance=function(){if(void 0===this._instance)throw new Error("XrayInsightClient is not initialized.");return this._instance},r.prototype.start=function(){this.isStarted=!0,this.insightEventQueueReporter.start()},r.prototype.stop=function(){this.isStarted&&(this.isStarted=!1,this.insightEventQueueReporter.stop())},r.prototype.sendResourceLoadEvent=function(e,t,n,r,i,o,a){var s=this.xrayInsightEventBuilder.buildResourceLoadEvent(e,t,n,r,i,o,a);this.sendEvent(s)},r.prototype.sendSessionStartEvent=function(e){if(!xt.exists(this.currentSessionReferenceId)){var t=this.xrayInsightEventBuilder.buildSessionStartEvent(e);this.currentSessionReferenceId=t.id,this.durationMap.put(this.currentSessionReferenceId,{startTimestamp:(new Date).getTime(),startId:this.currentSessionReferenceId}),this.sendEvent(t)}},r.prototype.sendSessionEndEvent=function(e){if(xt.exists(this.currentSessionReferenceId)){var t=this.currentSessionReferenceId;this.currentSessionReferenceId=null;var n=this.durationMap.remove(t);if(xt.exists(n)){var r=(new Date).getTime()-n.startTimestamp,i=this.xrayInsightEventBuilder.buildSessionEndEvent(t,r,e);this.sendEvent(i)}}},r.prototype.sendImpressionStartEvent=function(e,t,n){var r=this.durationMap.get(t);if(!xt.exists(r)){var i=this.xrayInsightEventBuilder.buildImpressionStartEvent(e,t,n,this.currentSessionReferenceId);this.durationMap.put(t,{startTimestamp:(new Date).getTime(),startId:i.id}),this.sendEvent(i)}},r.prototype.sendImpressionEndEvent=function(e,t,n){var r=this.durationMap.remove(e);if(xt.exists(r)){var i=(new Date).getTime()-r.startTimestamp,o=this.xrayInsightEventBuilder.buildImpressionEndEvent(e,r.startId,i,t,n,this.currentSessionReferenceId);this.sendEvent(o)}},r.prototype.sendInteractionEvent=function(e,t){var n=this.xrayInsightEventBuilder.buildInteractionEvent(e,t);this.sendEvent(n)},r.prototype.sendPlaybackEvent=function(e,t,n){var r=this.xrayInsightEventBuilder.buildPlaybackEvent(e,t,this.currentSessionReferenceId,n);this.sendEvent(r)},r.prototype.sendErrorEvent=function(e,t,n,r,i){var o=this.xrayInsightEventBuilder.buildErrorEvent(e,t,n,r,this.currentSessionReferenceId,i);this.sendEvent(o)},r.prototype.sendEvent=function(e){xt.exists(e)&&this.insightEventQueueReporter.sendEvent(e)},r._instance=void 0,r}();t.XrayInsightClient=n});e(om);om.XrayInsightClient;var am=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).STATIC_SWIFT="STATIC_SWIFT",r.DYNAMIC_SWIFT="DYNAMIC_SWIFT",r.IMAGE="IMAGE",r.TRICKPLAY="TRICKPLAY",r.VIDEO_MANIFEST="VIDEO_MANIFEST",r.MEDIA_FRAGMENT="MEDIA_FRAGMENT",t.XrayInsightResourceType=n});e(am);am.XrayInsightResourceType;var sm=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).RESOURCELOAD="RESOURCE",r.RUNTIME="RUNTIME",r.PLAYBACK="PLAYBACK",t.XrayInsightErrorType=n});e(sm);sm.XrayInsightErrorType;var lm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.GetPageResponse,o=Mf.com.amazon.atv.discovery.GetWidgetsResponse,c=S.of("XrayClient"),s={decorationScheme:"none",version:"inception-v2"},r=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=new Vf.XrayResponseCache),void 0===o&&(o=new Vf.XrayResponseCache),void 0===a&&(a=new Mf.Validator),this.pageServiceClient=e.createBasicServiceClient("/swift/page/xray",s),this.widgetsServiceClient=e.createBasicServiceClient("/swift/widgets/xray",s),this.metricsFeature=c(t,"metricsFeature").exists(),this.localizationAdapter=c(n,"localizationAdapter").exists(),this.xrayToken=c(r,"xrayToken").exists(),this.xrayPageCache=c(i,"xrayPageCache").exists(),this.xrayWidgetsCache=c(o,"xrayWidgetsCache").exists(),this.validator=a}return e.prototype.loadPage=function(e,t){var n=this;c(e,"pageContext").exists();var r=new Error("Service response was not of correct type: "+t),i=new ch.LoadMetricsReporter;i.startTimer();var o=this.xrayPageCache.get(e);if(o&&null!==o.value){var a=o.value,s=o.expirationTimeMs?o.expirationTimeMs:null,l=this.validateAndExtractPage(a,t);if(null===l)return Fe.Promise.reject(r);var u=!!s&&Date.now()>s;if(a&&a.page.cache&&u)switch(a.page.cache.ttl.updatePolicy){case"neverStale":return this.loadAndCachePage(e,t,r,i);case"staleIfError":return this.loadAndCachePage(e,t,r,i).catch(function(){return om.XrayInsightClient.getInstance().sendResourceLoadEvent(e.toString(),am.XrayInsightResourceType.STATIC_SWIFT,!0),Fe.Promise.resolve(l)});case"staleWhileRefresh":return Fe.Promise.resolve(l).then(function(){return n.loadAndCachePage(e,t,r,i)});default:throw new Error("Unknown cache policy provided by response.")}return Fe.Promise.resolve(l)}return this.loadAndCachePage(e,t,r,i)},e.prototype.loadWidgets=function(n){var r=this;c(n,"pageContext").exists();var e=this.xrayWidgetsCache.get(n);if(e&&null!==e.value){var t=e.value.widgets.widgetList;return Fe.Promise.resolve(t)}var i=new ch.LoadMetricsReporter;return i.startTimer(),this.load(this.widgetsServiceClient,o,n).then(function(e){var t=e.data.widgets.widgetList;if(null===t)throw new Error("Widget list was missing in service response");return i.endTimerAndReport(jf.XrayMetricsConstants.XRAY_DATA_GET_WIDGETS_LOAD_TIME,"XrayClient"),r.xrayWidgetsCache.put(n,e.data),t}).catch(function(e){throw om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RESOURCELOAD,e.message),Uf.XrayPmetReporter.putMetric(jf.XrayMetricsConstants.XRAY_DATA_GET_WIDGETS_LOAD_FAIL),e})},e.prototype.validateAndExtractPage=function(e,t){var n=e.page;return this.validator.isA(n,t)?n:null},e.prototype.loadAndCachePage=function(r,i,o,a){var s=this;return this.load(this.pageServiceClient,n,r).then(function(e){var t=s.validateAndExtractPage(e.data,i);if(null===t)throw o;a.endTimerAndReport(jf.XrayMetricsConstants.XRAY_DATA_LOAD_TIME,"XrayClient");var n=1e3*e.data.page.cache.ttl.maxAgeSeconds;return s.xrayPageCache.put(r,e.data,Date.now()+n),t}).catch(function(e){throw om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RESOURCELOAD,e.message),Uf.XrayPmetReporter.putMetric(jf.XrayMetricsConstants.XRAY_DATA_LOAD_FAIL),e})},e.prototype.load=function(e,r,t){var n=this,i={method:"GET",queryParams:F.extend({uxLocale:this.localizationAdapter.getCurrentLocalization().currentLocale,featureScheme:this.xrayToken},t.toPageParams())};return e.send(i,Fe.CancelToken.source().token).then(function(e){return uh.AcquisitionEventFactory.reportAcquisitionEventsForInFlightRequest("X-Ray",e,n.metricsFeature),e.once("success",function(e){om.XrayInsightClient.getInstance().sendResourceLoadEvent(t.toString(),am.XrayInsightResourceType.STATIC_SWIFT,!1,e.totalBytes,e.latencyMs,e.downloadTimeMs+e.latencyMs)}),e.once("fail",function(e){om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RESOURCELOAD,e.error.message,e.url,e.status)}),e.response()}).then(function(e){return new Fe.Promise(function(n,t){new Bf.XrayServiceResponseParser(r).parse(e.getText(),function(e,t){n({data:e,downloadTimeMs:t})},function(e){t(e)})})})},e}();t.XrayClient=r});e(lm);lm.XrayClient;var um=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.GetPage=0]="GetPage",r[r.GetWidgets=1]="GetWidgets",t.XrayApiEndpoint=n});e(um);um.XrayApiEndpoint;var cm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=Mf.com.amazon.avod.xray.XRayParameterMapKey,l=Mf.com.amazon.atv.discovery.PageType,o=S.of("XrayPageContext"),n=function(){function a(e,t,n,r,i){this.pageId=o(e,"pageId").exists(),this.pageParams=t,this.serviceToken=n,this.apiEndpoint=r,this.liveEventId=i}return a.fromParamsMap=function(e,t){if(null===e)return null;var n=e.liveEventId||null,r=e[s.PAGE_ID]||null,i=e[s.PAGE_TYPE]||null,o=e[s.SERVICE_TOKEN]||null;return i!==l.XRAY_PAGE||null===r?null:new a(r,e,o,t,n)},a.prototype.getLiveEventId=function(){return this.liveEventId},a.prototype.getPageId=function(){return this.pageId},a.prototype.getServiceToken=function(){return this.serviceToken},a.prototype.getApiEndpoint=function(){return this.apiEndpoint},a.prototype.toPageParams=function(){return this.pageParams},a.prototype.equals=function(e){return this.pageId===e.pageId&&this.serviceToken===e.serviceToken&&this.apiEndpoint===e.apiEndpoint},a.prototype.toString=function(){return"Page ID: "+this.pageId+" Service Token: "+this.serviceToken+" Endpoint: "+um.XrayApiEndpoint[this.apiEndpoint]},a}();t.XrayPageContext=n});e(cm);cm.XrayPageContext;var dm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.XrayNavigationParameterType,n=S.of("XrayPageContext"),r=function(){function i(e,t){this.pageContext=n(e,"pageContext").exists(),this.tabId=n(t,"tabId").exists()}return i.fromParamsMap=function(e,t){var n=cm.XrayPageContext.fromParamsMap(e,t);if(null===n)return null;var r=e[o.WIDGET_ID]||null;return null===r?null:new i(n,r)},i.prototype.getTabId=function(){return this.tabId},i.prototype.getPageContext=function(){return this.pageContext},i.prototype.equals=function(e){return e===this||this.tabId===e.getTabId()&&this.getPageContext().getPageId()===e.getPageContext().getPageId()&&this.getPageContext().getServiceToken()===e.getPageContext().getServiceToken()},i.prototype.toString=function(){return"Tab ID: "+this.tabId+" "+this.pageContext.toString()},i}();t.XrayCardKey=r});e(dm);dm.XrayCardKey;var pm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.XrayInitializationContextAction"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.XrayInitializationContextAction=n});e(pm);pm.XrayInitializationContextAction;var fm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.isPlaying=!1,this.resumePlaybackOnFocusRelease=!1,this.hasFocus=!1,this.playbackStateChange=function(e){e===Gd.PlaybackState.Playing?t.isPlaying=!0:e===Gd.PlaybackState.Paused&&(t.isPlaying=!1)},this.player=e,this.player.on(Gd.PlayerEvent.PlaybackStateChange,this.playbackStateChange)}return e.prototype.requestFocus=function(){this.resumePlaybackOnFocusRelease=this.isPlaying,this.player.pause(),this.hasFocus=!0},e.prototype.releaseFocus=function(){this.hasFocus&&(this.hasFocus=!1,this.resumePlaybackOnFocusRelease&&this.player.play())},e.prototype.destroy=function(){this.player.off(Gd.PlayerEvent.PlaybackStateChange,this.playbackStateChange)},e}();t.FullScreenPlayerStateManager=n});e(fm);fm.FullScreenPlayerStateManager;var hm=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.getInstance=function(){return this.instance},t.instance=new t,t}(Lf.Dispatcher);t.XrayDispatcher=i});e(hm);hm.XrayDispatcher;var mm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReceivePlaybackPosition"},n.store=new Lf.ActionStore(n.getName(),0),n}(Lf.Action);t.ReceivePlaybackPositionAction=n});e(mm);mm.ReceivePlaybackPositionAction;var ym=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReceiveContentState"},n.store=new Lf.ActionStore(n.getName(),Gd.ContentState.Waiting),n}(Lf.Action);t.ReceiveContentStateAction=n});e(ym);ym.ReceiveContentStateAction;var gm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReceivePlaybackState"},n.store=new Lf.ActionStore(n.getName(),Gd.PlaybackState.Paused),n}(Lf.Action);t.ReceivePlaybackStateAction=n});e(gm);gm.ReceivePlaybackStateAction;var vm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.AdBreakResponse"},n.store=new Lf.ActionStore(n.getName(),!1),n}(Lf.Action);t.AdBreakResponseAction=n});e(vm);vm.AdBreakResponseAction;var Sm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e||null)||this}return i(n,t),n.prototype.isEqual=function(e){if(!xt.exists(e))return!1;var t=this.getValue(),n=e.getValue();if(null===t)return null===n;if(null===n)return!1;if(!F.isEqual(t.selectionDataMap,n.selectionDataMap))return!1;var r=t.xrayCardKey,i=n.xrayCardKey;return null===r?null===i:void 0===r?void 0===i:r.equals(i)},n.prototype.isClearingSelection=function(){return null===this.getValue()},n.getName=function(){return"XraySwiftSelectAction"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.XraySwiftSelectAction=n});e(Sm);Sm.XraySwiftSelectAction;var bm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.plr_LVL1="plr_",e.XRAY_LVL2_="x_",e.PLAYER_BUTTONS_LVL2="b_",e.QUICKVIEW_EXPAND="bbl_more",e.QUICKVIEW_COLLAPSE="bbl_less",e.NAVBAR_CLOSE="nb_close",e.BACK_BUTTON="close_back",e.ESC_BUTTON="esc_back",e.EXTERNAL_INTERACTION="revisit",e.GALLERY_DETAIL_NEXT="gall_next",e.GALLERY_DETAIL_PREV="gall_prev",e.HIGHLIGHT_RESUME="hlt_exit_resume",e.HIGHLIGHT_GO_LIVE="hlt_exit_live",e.TRIVIA_DETAIL="trivia_detail_page",e.ERROR_PAGE="err_page",e}();t.XrayRefMarkers=n});e(bm);bm.XrayRefMarkers;var Tm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("XrayMetricsReporter"),n=function(){function e(){}return e.sendInteractionEvent=function(e,t,n,r,i,o){void 0===o&&(o=null);var a=pm.XrayInitializationContextAction.store.getValue();if(xt.exists(a)){var s={_type:"X-Ray",linkType:n,refMarker:xt.nestedValue(i,"local.refMarker",null),refMarkerIndex:null,navType:e,navValue:t,scrollAmount:o};a.metricsFeature.reportInteraction("X-Ray","Navigation",r,s)}else l.warn("Cannot send event due to InitializationContext is empty.")},e.sendInteractionEventWithRefMarker=function(e,t,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=null);var a=pm.XrayInitializationContextAction.store.getValue();if(xt.exists(a)){var s={_type:"X-Ray",linkType:n,refMarker:i,refMarkerIndex:null,navType:e,navValue:t,scrollAmount:o};a.metricsFeature.reportInteraction("X-Ray","Navigation",r,s)}else l.warn("Cannot send event due to InitializationContext is empty.")},e}();t.InteractionEventReporter=n});e(Tm);Tm.InteractionEventReporter;var Pm=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).NAVIGATION="NAVIGATION",r.EXTERNALLINK="EXTERNALLINK",r.VIDEOLAUNCH="VIDEOLAUNCH",r.INTERACTION="INTERACTION",t.XrayInsightInteractionType=n});e(Pm);Pm.XrayInsightInteractionType;var wm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.Close"},n.responder=new Lf.ActionResponder(n.getName(),function(e,t){void 0===t&&(t=hm.XrayDispatcher.getInstance());var n=bm.XrayRefMarkers.plr_LVL1+bm.XrayRefMarkers.XRAY_LVL2_+e;t.dispatch(new Sm.XraySwiftSelectAction(null)),null!==pm.XrayInitializationContextAction.store.getValue()&&(Tm.InteractionEventReporter.sendInteractionEventWithRefMarker(null,null,"X-Ray",null,n,null),om.XrayInsightClient.getInstance().sendInteractionEvent(n,Pm.XrayInsightInteractionType.NAVIGATION))}),n}(Lf.Action);t.CloseXrayAction=n});e(wm);wm.CloseXrayAction;var Cm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.load=function(e){return Fe.Promise.resolve()},e.prototype.cancel=function(e){},e.prototype.stop=function(){},e}();t.NoOpXrayLoader=n});e(Cm);Cm.NoOpXrayLoader;var Mm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReceiveInitialSwiftPage"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.ReceiveInitialSwiftPageAction=n});e(Mm);Mm.ReceiveInitialSwiftPageAction;var Im=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReceiveLivePollingUrl"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.ReceiveLivePollingUrlAction=n});e(Im);Im.ReceiveLivePollingUrlAction;var Em=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.atv.discovery.PageV2,o=Mf.com.amazon.avod.xray.XRaySwiftFragment,a=S.of("SwiftXrayLoader"),s=M.get("SwiftXrayLoader"),n=function(){function e(e,t,n){void 0===t&&(t=hm.XrayDispatcher.getInstance()),void 0===n&&(n=new Mf.Validator),this.xrayClient=a(e,"xrayClient").exists(),this.dispatcher=t,this.validator=n}return e.prototype.load=function(e){var t=this;a(e,"xrayFragment").exists(),a(this.validator.isA(e,o)).is.true();var n=e,r=cm.XrayPageContext.fromParamsMap(n.parameters,um.XrayApiEndpoint.GetPage);return null===r?(s.warn("Could not load X-Ray with invalid params: "+n.parameters),Fe.Promise.resolve(null)):this.xrayClient.loadPage(r,i).then(function(e){t.dispatcher.dispatch(new Mm.ReceiveInitialSwiftPageAction({page:e,pageContext:r}))}).catch(function(e){om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RESOURCELOAD,jf.XrayMetricsConstants.XRAY_DATA_LOAD_FAIL_STREAMING),Uf.XrayPmetReporter.putMetric(jf.XrayMetricsConstants.XRAY_DATA_LOAD_FAIL_STREAMING),s.error("Initial Xray Swift load failed",e)})},e.prototype.cancel=function(e){},e.prototype.stop=function(){},e}();t.SwiftXrayLoader=n});e(Em);Em.SwiftXrayLoader;var _m=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.generateDefaultId=function(e,t){return void 0===t&&(t=null),null!==t?t:(this.count++,e+this.count)},e.clear=function(){this.count=0},e.count=0,e}();t.ViewModelIdGenerator=n});e(_m);_m.ViewModelIdGenerator;var xm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.clear()}return e.getInstance=function(){return this.instance},e.prototype.getById=function(e){return xt.withDefault(this.registryMap[e],null)},e.prototype.registerViewModel=function(e){var t=this.getById(e.id);if(this.registryMap[e.id]=e,null===t)for(var n=0,r=this.onViewModelRegisteredListeners;n<r.length;n++){(0,r[n])(e)}else if(!F.isEqual(t,e)){var i=xt.withDefault(this.onViewModelUpdatedListeners[e.id],null);null!==i&&i(e)}},e.prototype.deleteViewModel=function(e){xt.exists(this.registryMap[e])&&(delete this.registryMap[e],this.removeOnViewModelUpdatedListener(e))},e.prototype.addOnViewModelRegisteredListener=function(e){this.onViewModelRegisteredListeners.push(e)},e.prototype.removeOnViewModelRegisteredListener=function(e){var t=this.onViewModelRegisteredListeners.indexOf(e);-1<t&&this.onViewModelRegisteredListeners.splice(t,1)},e.prototype.setOnViewModelUpdatedListener=function(e,t){this.onViewModelUpdatedListeners[e]=t},e.prototype.removeOnViewModelUpdatedListener=function(e){this.onViewModelUpdatedListeners[e]=null},e.prototype.clear=function(){this.registryMap={},this.onViewModelRegisteredListeners=[],this.onViewModelUpdatedListeners={}},e.instance=new e,e}();t.ViewModelRegistry=n});e(xm);xm.ViewModelRegistry;var km=t(function(e,t){var n,r,i;Object.defineProperty(t,"__esModule",{value:!0}),(i=r||(r={}))[i.DASH=0]="DASH",i[i.SmoothStreaming=1]="SmoothStreaming",i[i.HLS=2]="HLS",i[i.MP4=3]="MP4",i[i.WMV=4]="WMV",i[i.MPEGPS=5]="MPEGPS",i[i.MPEGTS=6]="MPEGTS";var o=((n={})[(t.StreamingTechnologyEnum=r).DASH]="DASH",n[r.HLS]="HLS",n);t.StreamingTechnologyToFragmentEntryMap=o});e(km);km.StreamingTechnologyEnum,km.StreamingTechnologyToFragmentEntryMap;var Rm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("XrayDebugLiveOffsetSetter"),n=function(){function e(){}return e.setOffsetByNextEventTime=function(e){if(this.enabled){var t=Date.now(),n=t-e-3e4;r.info("Current UTC time is "+new Date(t)+". Next event time is "+new Date(e)+". Using a delay time of 30000 ms.\nSetting live offset to -"+n+" ms."),this.currentLiveOffset=n}},e.getCurrentLiveOffset=function(){return this.enabled?this.currentLiveOffset:0},e.setEnabled=function(e){this.enabled=e},e.setPollerUrlOverride=function(e){this.pollerUrlOverride=e},e.getPollerUrlOverride=function(){return this.pollerUrlOverride},e.setDynamicLogsEnabled=function(e){this.dynamicLogsEnabled=e},e.getDynamicLogsEnabled=function(){return this.dynamicLogsEnabled},e.setEncoderTimestamp=function(e){this.encoderTimestampEnabled=!0,this.encoderTimestampValue=e},e.getEncoderTimestampEnabled=function(){return this.encoderTimestampEnabled},e.getEncoderTimestampValue=function(){return this.encoderTimestampValue},e.currentLiveOffset=0,e.enabled=!1,e.pollerUrlOverride=null,e.dynamicLogsEnabled=!1,e.encoderTimestampEnabled=!1,e.encoderTimestampValue=!1,e}();t.XrayLiveDebugConfig=n});e(Rm);Rm.XrayLiveDebugConfig;var Am=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReceiveEncoderTimestampConfig"},n.store=new Lf.ActionStore(n.getName(),!1),n}(Lf.Action);t.ReceiveEncoderTimestampConfigAction=n});e(Am);Am.ReceiveEncoderTimestampConfigAction;var Om=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ChangeVolume"},n.store=new Lf.ActionStore(n.getName(),1),n}(Lf.Action);t.ChangeVolumeAction=n});e(Om);Om.ChangeVolumeAction;var Lm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c,n,d=Mf.com.amazon.avod.xray.FragmentVersion,p=Mf.com.amazon.avod.xray.XRaySwiftFragment,f=Mf.com.amazon.avod.xray.XRayLiveSwiftFragment,h=M.get("XrayMediaPlayerEventAdapter"),m=S.of("XrayMediaPlayerEventAdapter");(n=c||(c={}))[n.NotLoaded=0]="NotLoaded",n[n.Loading=1]="Loading",n[n.Loaded=2]="Loaded",n[n.Unavailable=3]="Unavailable";var r=function(){function e(e,t,n,r,i,o,a,s,l){void 0===o&&(o=new Mf.Validator),void 0===a&&(a=new Cm.NoOpXrayLoader),void 0===s&&(s=Cm.NoOpXrayLoader),void 0===l&&(l=Em.SwiftXrayLoader);var u=this;this.hasReportedInitialMetric=!1,this.volumeFeature=null,this.currentGroupId=null,this.currentContentId=null,this.isCurrentlyPlayingAd=!1,this.lastDispatchedTimeMs=null,this.weblabs={},this.shouldUseEncoderTimestamp=!1,this.xrayLoadStatus=c.Unavailable,this.isInitialized=!1,this.onContentStateChange=function(e){u.updateContentState(),u.dispatcher.dispatch(new ym.ReceiveContentStateAction(e))},this.onPlaybackStateChange=function(e){u.dispatcher.dispatch(new gm.ReceivePlaybackStateAction(e))},this.onTimelineChange=function(){u.updateContentState()},this.onTimeDataChange=function(e){u.updateContentState(),u.xrayLoadStatus===c.Loaded&&(null===u.lastDispatchedTimeMs||1e3<Math.abs(e.currentPosition-u.lastDispatchedTimeMs))&&u.dispatchTimeChange(e)},this.onVolumeFeatureAvailable=function(e){u.volumeFeature=e,u.volumeFeature.onChange(u.onVolumeChange),u.onVolumeChange()},this.onVolumeChange=function(){h.log("Change volume to "+u.volumeFeature.volume),u.dispatcher.dispatch(new Om.ChangeVolumeAction(u.volumeFeature.volume))},this.reset=function(){u.xrayLoader.stop(),u.clearXray(),u.currentGroupId=null,u.currentContentId=null,u.isCurrentlyPlayingAd=!1,u.lastDispatchedTimeMs=null},this.player=m(e,"player").exists(),this.dispatcher=m(t,"dispatcher").exists(),this.xrayClient=m(n,"xrayClient").exists(),this.loadMetricsReporter=m(r,"LoadMetricsReporter").exists(),this.dynamicAdapter=m(i,"dynamicAdapter").exists(),this.validator=o,this.noOpXrayLoaderType=s,this.swiftXrayLoaderType=l,this.xrayLoader=a}return e.prototype.initialize=function(e){void 0===e&&(e={}),this.player.on(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange),this.player.on(Gd.PlayerEvent.PlaybackStateChange,this.onPlaybackStateChange),this.player.on(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChange),this.player.on(Gd.PlayerEvent.TimelineEnded,this.reset),this.player.on(Gd.PlayerEvent.TimelineChange,this.onTimelineChange),this.dynamicAdapter.initialize(),this.isInitialized=!0,this.hasReportedInitialMetric=!1,this.weblabs=e,this.player.getFeature(Gd.PlayerFeatures.Volume).then(this.onVolumeFeatureAvailable).catch(function(e){return h.error(e)})},e.prototype.destroy=function(){this.isInitialized&&(this.reset(),this.player.off(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange),this.player.off(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChange),this.player.off(Gd.PlayerEvent.TimelineEnded,this.reset),this.player.off(Gd.PlayerEvent.TimelineChange,this.onTimelineChange),this.player.off(Gd.PlayerEvent.PlaybackStateChange,this.onPlaybackStateChange),this.dynamicAdapter.destroy(),null!==this.volumeFeature&&this.volumeFeature.offChange(this.onVolumeChange),this.isInitialized=!1,this.hasReportedInitialMetric=!1)},e.prototype.updateContentState=function(){var e=this.player.timeline,t=this.player.currentTime;if(xt.exists(t)){var n=e.items[t.currentTimelineItemIndex];if(!xt.exists(n))return this.clearXray(),this.currentGroupId=null,void(this.currentContentId=null);if(n.groupId!==this.currentGroupId){this.currentGroupId=n.groupId,this.clearXray();var r=e.contentInfos[n.contentId];this.dispatcher.dispatch(new Jh.ReceiveTitleInfoAction(r)),this.updateXrayMetadata(r)}if(n.contentId!==this.currentContentId){this.currentContentId=n.contentId;r=e.contentInfos[n.contentId];this.updateXrayMetadata(r),"Advertisement"===r.contentType?(this.dispatcher.dispatch(new vm.AdBreakResponseAction(!0)),this.isCurrentlyPlayingAd=!0):this.isCurrentlyPlayingAd&&(this.dispatcher.dispatch(new vm.AdBreakResponseAction(!1)),this.isCurrentlyPlayingAd=!1)}this.tryLoadXray()}},e.prototype.updateXrayMetadata=function(e){if("Feature"===e.contentType){var t=tm.XrayPlaybackContextAction.store.getValue();e.xrayMetadata&&"Trailer"!==t.videoMaterialType?(this.xrayLoadStatus=c.NotLoaded,this.xrayMetadata=e.xrayMetadata):this.xrayLoadStatus=c.Unavailable}},e.prototype.tryLoadXray=function(){this.player.contentState===Gd.ContentState.Ready&&xt.exists(this.player.timeline)&&this.xrayLoadStatus===c.NotLoaded&&xt.exists(this.xrayMetadata)&&this.loadXray(this.xrayMetadata)},e.prototype.dispatchTimeChange=function(e){this.shouldUseEncoderTimestamp?(this.dispatcher.dispatch(new mm.ReceivePlaybackPositionAction(e.mediaWallClockUtcTime)),this.lastDispatchedTimeMs=e.mediaWallClockUtcTime):(this.dispatcher.dispatch(new mm.ReceivePlaybackPositionAction(e.currentPosition)),this.lastDispatchedTimeMs=e.currentPosition)},e.prototype.clearXray=function(){this.xrayLoadStatus=c.NotLoaded,this.xrayMetadata=null,this.dispatcher.dispatch(new Mm.ReceiveInitialSwiftPageAction(null)),this.dispatcher.dispatch(new Im.ReceiveLivePollingUrlAction(null)),this.dispatcher.dispatch(new wm.CloseXrayAction(bm.XrayRefMarkers.EXTERNAL_INTERACTION)),this.dynamicAdapter.reset(),this.dispatchTimeChange(this.player.currentTime),_m.ViewModelIdGenerator.clear(),xm.ViewModelRegistry.getInstance().clear(),om.XrayInsightClient.getInstance().stop()},e.prototype.loadXray=function(e){var t=this;this.clearXray(),om.XrayInsightClient.getInstance().start(),this.xrayLoadStatus=c.Loading,this.loadMetricsReporter.startTimer();var n=null;if(xt.exists(e)&&xt.exists(e.streamingTechnology)&&(n=e.streamingTechnology),this.checkFragmentType(e)){var r;switch(e.version){case d.SWIFT:if(null===(r=this.validator.forId(p).validate(e))){var i="Fragment metadata incorrectly formatted: "+e;return om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RUNTIME,i),void h.error(i)}break;case d.LIVE_SWIFT:if(r=this.validator.forId(f).validate(e),ch.LoadMetricsReporter.setFragmentVersion(d.LIVE_SWIFT),null===r){i="Fragment metadata incorrectly formatted: "+e;return om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RUNTIME,i),void h.error(i)}var o=r;this.shouldUseEncoderTimestamp=this.determineEncoderTimestamp(o,this.weblabs);var a=this.getFragmentMapKey(n),s=o.liveFragmentMap[a],l=void 0;l=xt.exists(s)?{pollingIntervalMs:xt.withDefault(s.pollingInterval,o.pollingInterval),url:xt.withDefault(s.url,o.url),domain:s.domain,path:s.path,cdnPreferenceList:o.cdnNamePreferenceList,documentUrlMap:s.documentUrlMap}:{pollingIntervalMs:o.pollingInterval,url:o.url,cdnPreferenceList:o.cdnNamePreferenceList},this.dispatcher.dispatch(new Im.ReceiveLivePollingUrlAction(l));break;default:var u="Unsupported X-Ray fragment version: "+e.version;return om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RUNTIME,u),void h.error(u)}this.dispatcher.dispatch(new Am.ReceiveEncoderTimestampConfigAction(this.shouldUseEncoderTimestamp)),this.xrayLoader=new this.swiftXrayLoaderType(this.xrayClient),this.xrayLoader.load(r).then(function(){t.xrayLoadStatus=c.Loaded})}},e.prototype.checkFragmentType=function(e){return xt.exists(e)&&xt.exists(e.version)},e.prototype.getFragmentMapKey=function(e){if(this.shouldUseEncoderTimestamp)return km.StreamingTechnologyToFragmentEntryMap[km.StreamingTechnologyEnum.HLS];switch(e){case km.StreamingTechnologyEnum.HLS:return km.StreamingTechnologyToFragmentEntryMap[km.StreamingTechnologyEnum.HLS];default:return km.StreamingTechnologyToFragmentEntryMap[km.StreamingTechnologyEnum.DASH]}},e.prototype.determineEncoderTimestamp=function(e,t){if(Rm.XrayLiveDebugConfig.getEncoderTimestampEnabled())return Rm.XrayLiveDebugConfig.getEncoderTimestampValue();var n=xt.exists(t)&&t.AIV_XRAY_LIVE_ENCODER_TIMESTAMP_241326===Y.WeblabTreatment.T1,r=xt.exists(e)&&"true"===e.parameters.useEncoderTimestamp;return n||r},e}();t.MediaPlayerEventAdapter=r});e(Lm);Lm.MediaPlayerEventAdapter;var Fm=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.atv.discovery.SectionV2,a=Mf.com.amazon.atv.discovery.WidgetGroup,s=Mf.com.amazon.atv.discovery.SectionType,l=M.get("XraySwiftQuickViewWidgetGroupStore"),i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.valueFunction=function(e,t,n){if(null===t||null===t.page)return null;var r=i.parseQuickViewWidgetGroup(t.page);return null===r?(n.loadMetricsReporter.endTimerAndReportInitialLoad(!1),null):(n.loadMetricsReporter.endTimerAndReportInitialLoad(),r)},i.parseQuickViewWidgetGroup=function(e,t){void 0===t&&(t=new Mf.Validator);var n=e.sections[s.LEFT];if(!t.isA(n,o))return l.warn("Page had no left section or was not a SectionV2"),null;var r=n.widgets.widgetList,i=0===r.length?null:r[0];return t.isA(i,a)?i:(l.warn("First widget in left section is missing or not a widget group."),null)},i.getInstance=function(){return this.instance},i.instance=new Lf.ComputedValueStore("XraySwiftQuickViewWidgetGroupStore",[Mm.ReceiveInitialSwiftPageAction.store,pm.XrayInitializationContextAction.store],i.valueFunction),i}(Lf.ComputedValueStore);t.XraySwiftQuickViewWidgetGroupStore=i});e(Fm);Fm.XraySwiftQuickViewWidgetGroupStore;var Dm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.TextType;function r(e){return xt.exists(e)?e:null}t.textModelFromTextMap=function(e){return xt.exists(e)?{primaryText:r(e[n.PRIMARY]),secondaryText:r(e[n.SECONDARY]),tertiaryText:r(e[n.TERTIARY]),quaternaryText:r(e[n.QUATERNARY])}:{primaryText:null,secondaryText:null,tertiaryText:null,quaternaryText:null}},t.hasNoText=function(e){return null===e.primaryText&&null===e.secondaryText&&null===e.tertiaryText&&null===e.quaternaryText}});e(Dm);Dm.textModelFromTextMap,Dm.hasNoText;var Nm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.XrayNavigationParameterType,n=M.get("PlayerNavigationalActionResolver"),a=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.SeekToTimecodeAction"},n}(Lf.Action),s=function(){function e(){}return e.prototype.resolve=function(e){if(!xt.exists(e)||!xt.exists(e.parameters))return null;var t=parseInt(e.parameters[o.TIMECODE]);if(null===t||F.isNaN(t)||t<0)return null;var n=xt.nestedValue(e,"analytics.local.refMarker",null);return new a({timecodeMillis:t,refMarker:n})},e.responder=new Lf.ActionResponder(a.getName(),function(e){var t=pm.XrayInitializationContextAction.store.getValue()||null;null!==t&&(t.player.seek(e.timecodeMillis),hm.XrayDispatcher.getInstance().dispatch(new wm.CloseXrayAction(bm.XrayRefMarkers.EXTERNAL_INTERACTION)),null!==e.refMarker?(Tm.InteractionEventReporter.sendInteractionEventWithRefMarker("Timecode",e.timecodeMillis.toString(),"Player",null,e.refMarker),om.XrayInsightClient.getInstance().sendInteractionEvent(e.refMarker,Pm.XrayInsightInteractionType.NAVIGATION)):n.warn("No ref marker in link action; cannot report interaction"))}),e}();t.PlayerNavigationalActionResolver=s});e(Nm);Nm.PlayerNavigationalActionResolver;var Um=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.atv.discovery.NavigationalActionV2,n=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.resolve=function(e){if(!xt.exists(e))return null;var t=xt.withDefault(e.parameters,null),n=this.getApiEndpoint(e),r=dm.XrayCardKey.fromParamsMap(t,n);return null===r?null:new Sm.XraySwiftSelectAction({xrayCardKey:r,analytics:xt.withDefault(e.analytics,null),selectionDataMap:t})},e.prototype.getApiEndpoint=function(e){if(this.validator.isA(e,r)){var t=e,n=um.XrayApiEndpoint[t.api];if(xt.exists(n))return n}return um.XrayApiEndpoint.GetPage},e}();t.XraySwiftNavigationalActionResolver=n});e(Um);Um.XraySwiftNavigationalActionResolver;var Bm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(n){function e(){var t=null!==n&&n.apply(this,arguments)||this;return t.reportInteraction=function(){var e=t.getValue();Tm.InteractionEventReporter.sendInteractionEvent("WidgetID",e.widgetId,"X-Ray","MouseClick",e.analytics),om.XrayInsightClient.getInstance().sendInteractionEvent(t.getRefMarker(e.analytics),Pm.XrayInsightInteractionType.NAVIGATION)},t.getRefMarker=function(e){var t="UNKNOWN";return xt.exists(e)&&xt.exists(e.local)&&xt.exists(e.local.refMarker)?e.local.refMarker:t},t}return i(e,n),e.prototype.initialize=function(e){n.prototype.initialize.call(this,e),this.onChange(this.reportInteraction)},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.offChange(this.reportInteraction)},e}(Lf.ActionStore),n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"XrayCollectionSelectAction"},n.store=new o(n.getName(),{widgetId:null,selectionIndex:0,analytics:null}),n}(Lf.Action);t.XrayCollectionSelectAction=n});e(Bm);Bm.XrayCollectionSelectAction;var Vm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.avod.xray.XrayNavigationParameterType,n=function(){function e(){}return e.prototype.resolve=function(e){if(!xt.exists(e))return null;var t=xt.withDefault(e.parameters,null);if(null===t)return null;if(!xt.exists(t[r.WIDGET_ID])||!xt.exists(t[r.COLLECTION_INDEX]))return null;var n=parseInt(t[r.COLLECTION_INDEX]);return isNaN(n)?null:new Bm.XrayCollectionSelectAction({widgetId:t[r.WIDGET_ID],selectionIndex:n,analytics:e.analytics})},e}();t.XraySwiftWidgetSelectionActionResolver=n});e(Vm);Vm.XraySwiftWidgetSelectionActionResolver;var jm=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"XrayCollectionFilterAction"},n.store=new Lf.ActionStore(n.getName(),{widgetId:null,analytics:null,filterKey:"primary"}),n}(Lf.Action);t.XrayCollectionFilterAction=n});e(jm);jm.XrayCollectionFilterAction;var Xm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.avod.xray.XrayNavigationParameterType,r=function(){function e(){}return e.prototype.resolve=function(e){if(!xt.exists(e))return null;var t=xt.withDefault(e.parameters,null);return null===t?null:xt.exists(t[n.WIDGET_ID])&&xt.exists(t[n.FILTER_KEY])?new jm.XrayCollectionFilterAction({widgetId:t[n.WIDGET_ID],filterKey:t[n.FILTER_KEY],analytics:e.analytics}):null},e}();t.XraySwiftWidgetFilterActionResolver=r});e(Xm);Xm.XraySwiftWidgetFilterActionResolver;var zm=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.atv.discovery.LinkType,o=M.get("SwiftLinkActionResolver"),i=function(){function e(){}return e.addOverrideResolvers=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];this.resolverMap[r]=e[r].concat(this.resolverMap[r])}},e.getActionFromNavigationalAction=function(e){if(!xt.exists(e))return null;var t=this.resolverMap[e.linkType]||null;if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n].resolve(e);if(xt.exists(i))return i}return o.warn("No link action resolver registered for navigationalAction: "+e),null},e.resolverMap=((n={})[r.XRAY]=[new Um.XraySwiftNavigationalActionResolver,new Vm.XraySwiftWidgetSelectionActionResolver,new Xm.XraySwiftWidgetFilterActionResolver],n[r.PLAYER]=[new Nm.PlayerNavigationalActionResolver],n),e}();t.SwiftLinkActionResolver=i});e(zm);zm.SwiftLinkActionResolver;var qm=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.PERSON=0]="PERSON",r[r.MUSIC=1]="MUSIC",r[r.SCENES=2]="SCENES",r[r.PRODUCT=3]="PRODUCT",r[r.FALLBACK_1X1=4]="FALLBACK_1X1",r[r.FALLBACK_16X9=5]="FALLBACK_16X9",r[r.FALLBACK_4X3=6]="FALLBACK_4X3",t.XrayPlaceholder=n});e(qm);qm.XrayPlaceholder;var Wm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("ButtonViewModel"),o="buttonViewModel";function r(e,t){if(!xt.exists(e))return null;var n=e.text||null;if(null===n)return i.warn("Nav action missing text member; cannot create ButtonViewModel",e),null;var r=zm.SwiftLinkActionResolver.getActionFromNavigationalAction(e);return null===r?(i.warn("Cannot create ButtonViewModel without link action"),null):{type:o,linkAction:r,label:n,icon:t,id:_m.ViewModelIdGenerator.generateDefaultId(o)}}t.ButtonViewModelType=o,t.buttonModelFromLinkActionMap=function(e,t,n){return r(Km.XraySwiftUtils.navigationalActionFromLinkActionMap(e,t),n)},t.buttonModelFromNavigationalAction=r});e(Wm);Wm.ButtonViewModelType,Wm.buttonModelFromLinkActionMap,Wm.buttonModelFromNavigationalAction;var Hm=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.PLAY=0]="PLAY",r[r.LIVE_STATS=1]="LIVE_STATS",t.XrayIcon=n});e(Hm);Hm.XrayIcon;var Gm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r,o=Mf.com.amazon.atv.discovery.ImageType,a=Mf.com.amazon.atv.discovery.LinkActionType;(r=n||(n={}))[r.CAST=0]="CAST",r[r.RELATED_NAME=1]="RELATED_NAME",r[r.IMAGE_GALLERY=2]="IMAGE_GALLERY",r[r.VIDEO_GALLERY=3]="VIDEO_GALLERY",r[r.FILMO_MOVIE=4]="FILMO_MOVIE",r[r.FILMO_TV=5]="FILMO_TV",r[r.PERSON=6]="PERSON",r[r.MUSIC=7]="MUSIC",t.GridTileStyle=n;var i={product:qm.XrayPlaceholder.PRODUCT};t.GridTilePlaceholderMap=i;var s="gridTileImageViewModel";t.GridTileImageViewModelType=s,t.gridModelFromBlueprintedItem=function(e,t,n){if(void 0===n&&(n=null),!xt.exists(e))return null;var r=Km.XraySwiftUtils.navigationalActionFromLinkActionMap(e.linkActionMap,a.PRIMARY),i=zm.SwiftLinkActionResolver.getActionFromNavigationalAction(r);return{type:s,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap),accessibilityDescription:Km.XraySwiftUtils.createAccessibilityDescription(e.accessibilityMap,e.textMap),jumpToSceneModel:Wm.buttonModelFromLinkActionMap(e.linkActionMap,a.SECONDARY,Hm.XrayIcon.PLAY),viewInStoreButton:Wm.buttonModelFromLinkActionMap(e.linkActionMap,a.TERTIARY),linkAction:i,image:{imageData:Km.XraySwiftUtils.imageModelFromImageMap(e.imageMap,o.PRIMARY),placeholder:Km.XraySwiftUtils.placeholderFromPlaceholderMap(e.blueprint.properties,"placeholder_primary",n)},style:t,properties:e.blueprint.properties}}});e(Gm);Gm.GridTileStyle,Gm.GridTilePlaceholderMap,Gm.GridTileImageViewModelType,Gm.gridModelFromBlueprintedItem;var Km=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.atv.discovery.NavigationalAction,o=Mf.com.amazon.atv.discovery.NavigationalActionV2,n=Mf.com.amazon.atv.discovery.ImageSizeUnit,s=Mf.com.amazon.atv.discovery.TextType,a={x:0,y:0,unit:n.PX},r=function(){function r(){}return r.navigationalActionFromLinkActionMap=function(e,t,n){if(void 0===n&&(n=new Mf.Validator),!xt.exists(e))return null;var r=e[t];return n.isA(r,i)?r:n.isA(r,o)?r:null},r.imageModelFromImageMap=function(e,t){if(!xt.exists(e))return null;var n=e[t];if(!xt.exists(n))return null;var r=n.size||a;return{width:r.x,height:r.y,imageUrl:n.url}},r.validateBlueprintProperty=function(e,t){return xt.exists(e)&&xt.exists(e[t])},r.placeholderFromPlaceholderMap=function(e,t,n){return r.validateBlueprintProperty(e,t)&&xt.exists(Gm.GridTilePlaceholderMap[e[t]])?Gm.GridTilePlaceholderMap[e[t]]:n},r.createAccessibilityDescription=function(e,t){if(xt.exists(e)){var n=e[s.PRIMARY];if(xt.exists(n))return[n]}if(!xt.exists(t))return[];for(var r=[],i=0,o=[t[s.PRIMARY],t[s.SECONDARY],t[s.TERTIARY],t[s.QUATERNARY]];i<o.length;i++){var a=o[i];a&&0<a.length&&r.push(a)}return r},r}();t.XraySwiftUtils=r});e(Km);Km.XraySwiftUtils;var Qm=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.atv.discovery.NavigationsV2,a=Mf.com.amazon.atv.discovery.BlueprintedItem,s=Mf.com.amazon.atv.discovery.LinkActionType,l=M.get("XraySwiftNavigationsStore"),u={items:[],blueprintId:null};t.EMPTY_NAVIGATIONS_MODEL=u;var o=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.valueFunction=function(e,t,n){return void 0===n&&(n=new Mf.Validator),null===t||null===t.page?u:r.parseTabBarItems(t.page,n)},r.parseTabBarItems=function(e,o){var t=e.navigations;if(!o.isA(t,i))return l.warn("Page had no navigations or was not a NavigationsV2",t),u;var n=t,r=n.navigationList;return xt.exists(r)?{items:F.chain(r).map(function(e){var t;if(!o.isA(e,a))return l.warn("Navigation list item was not a blueprinted item",e),null;t=e;var n=Km.XraySwiftUtils.navigationalActionFromLinkActionMap(t.linkActionMap,s.PRIMARY);if(null===n)return l.warn("Could not get primary navigational action from navigation item",t),null;var r=zm.SwiftLinkActionResolver.getActionFromNavigationalAction(n);if(null===r)return l.warn("Navigational action on tab bar item was invalid.",t),null;var i=r.getValue().xrayCardKey;return null===i?(l.warn("Could not create card key from navigational item parameters",t),null):{label:n.text,linkAction:r,xrayCardKey:i,tabType:t.id}}).filter(function(e){return null!==e}).value(),blueprintId:xt.exists(n.blueprint)?n.blueprint.id:null}:u},r.getInstance=function(){return this.instance},r.instance=new Lf.ComputedValueStore("XraySwiftNavigationsStore",[Mm.ReceiveInitialSwiftPageAction.store],r.valueFunction,u),r}(Lf.ComputedValueStore);t.XraySwiftNavigationsStore=o});e(Qm);Qm.EMPTY_NAVIGATIONS_MODEL,Qm.XraySwiftNavigationsStore;var Ym=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.SelectPreviousAction"},n}(Lf.Action);t.SelectPreviousAction=n});e(Ym);Ym.SelectPreviousAction;var Jm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayTabBarItemType="XrayTabBarItem"});e(Jm);Jm.XrayTabBarItemType;var $m=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this,t.getName(),!0)||this}return n(t,e),t.getName=function(){return"Xray.RefreshDynamicActionsHistoryAction"},t}(Lf.Action);t.RefreshDynamicActionsHistoryAction=i});e($m);$m.RefreshDynamicActionsHistoryAction;var Zm=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("XraySwiftTabViewModelDataSource"),n={local:{},cascade:{}},r=new RegExp("[^_]*"),o=function(){function e(e,t,n,r){this.xrayTab=i(e,"xrayTab").exists(),this.xrayCardKey=i(t,"xrayCardKey").exists(),this.widgetTransformer=i(n,"widgetTransformer").exists(),this.selectionDataMap=i(r,"selectionDataMap").exists(),this.tabViewModel=this.widgetTransformer.transform(this.xrayTab)}return e.prototype.getViewModel=function(){return{viewModel:this.tabViewModel,shouldShowNavbar:!this.xrayTab.hideNavigationBar,tabType:this.xrayTab.tabType,analytics:this.xrayTab.analytics||n,metricsId:e.buildMetricName(this.xrayCardKey),selectionDataMap:this.selectionDataMap,xrayCardKey:this.xrayCardKey,accessibilityDescription:this.xrayTab.accessibilityDescription}},e.prototype.getCardKey=function(){return this.xrayCardKey},e.prototype.updateXrayTab=function(e){if(!F.isEqual(e,this.xrayTab)){var t=hm.XrayDispatcher.getInstance();this.xrayTab=e,this.tabViewModel=this.widgetTransformer.transform(e),t.dispatch(new $m.RefreshDynamicActionsHistoryAction)}},e.prototype.updateTransformer=function(e){F.isEqual(e,this.widgetTransformer)||(this.widgetTransformer=e,this.tabViewModel=e.transform(this.xrayTab))},e.prototype.updateSelectionDataMap=function(e){this.selectionDataMap=e},e.buildMetricName=function(e){var t=e.getTabId().match(r);return null===t||0===t.length?null:"xray-"+e.getPageContext().getPageId()+"-"+t[0]},e}();t.XraySwiftTabViewModelDataSource=o});e(Zm);Zm.XraySwiftTabViewModelDataSource;var ey=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Hidden=0]="Hidden",r[r.Loaded=1]="Loaded",r[r.Loading=2]="Loading",r[r.Error=3]="Error",t.XrayFullViewState=n});e(ey);ey.XrayFullViewState;var ty=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.ImageTextLinkModelType="imageTextLinkModel"});e(ty);ty.ImageTextLinkModelType;var ny=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.atv.discovery.ImageType,i=Mf.com.amazon.atv.discovery.LinkActionType,n=S.of("DataWidgetImageTextLinkTransformer"),o=function(){function e(e){this.placeholder=n(e,"placeholder").exists()}return e.prototype.transform=function(e){var t={type:ty.ImageTextLinkModelType,image:{imageData:Km.XraySwiftUtils.imageModelFromImageMap(e.imageMap,r.PRIMARY),placeholder:xt.exists(e.blueprint)?Km.XraySwiftUtils.placeholderFromPlaceholderMap(e.blueprint.properties,"placeholder_primary",this.placeholder):this.placeholder},id:_m.ViewModelIdGenerator.generateDefaultId(ty.ImageTextLinkModelType,e.id)},n=Km.XraySwiftUtils.navigationalActionFromLinkActionMap(e.linkActionMap,i.PRIMARY);return null!==n&&(t.text=n.text||null,t.linkAction=zm.SwiftLinkActionResolver.getActionFromNavigationalAction(n)),t},e}();t.DataWidgetImageTextLinkTransformer=o});e(ny);ny.DataWidgetImageTextLinkTransformer;var ry=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("BlueprintAwareWidgetTransformer"),r=function(){function e(e,t){this.transformersMap=e,this.fallbackTransformer=t||null}return e.prototype.transform=function(e){var t=e.blueprint||null;if(null===t)return this.tryFallbackTransform(e);var n=t.id,r=this.transformersMap[n]||null;return null===r?this.tryFallbackTransform(e):r.transform(e)},e.prototype.tryFallbackTransform=function(e){return null===this.fallbackTransformer?(n.warn("No fallback transformer registered, cannot transform widget. Full object:\n"+JSON.stringify(e)),null):this.fallbackTransformer.transform(e)},e}();t.BlueprintAwareWidgetTransformer=r});e(ry);ry.BlueprintAwareWidgetTransformer;var iy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayQuickViewHeaderModelType="XrayQuickViewHeaderModel"});e(iy);iy.XrayQuickViewHeaderModelType;var oy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.LinkActionType,r=M.get("DataWidgetQuickViewHeaderTransformer"),i=S.of("DataWidgetQuickViewHeaderTransformer"),o=function(){function e(e){this.localization=i(e,"localization").exists()}return e.prototype.transform=function(e){var t=Wm.buttonModelFromLinkActionMap(e.linkActionMap,n.PRIMARY);return null===t?(r.warn("Could not create view all link from quick view data widget",e),null):{type:iy.XrayQuickViewHeaderModelType,viewAllLinkModel:t,logoText:this.localization.localizedStrings.navbar.logo,id:_m.ViewModelIdGenerator.generateDefaultId(iy.XrayQuickViewHeaderModelType,e.id)}},e}();t.DataWidgetQuickViewHeaderTransformer=o});e(oy);oy.DataWidgetQuickViewHeaderTransformer;var ay=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.LinkActionType,r=function(){function e(){}return e.prototype.transform=function(e){return Wm.buttonModelFromLinkActionMap(e.linkActionMap,n.PRIMARY)},e}();t.DataWidgetTextButtonTransformer=r});e(ay);ay.DataWidgetTextButtonTransformer;var sy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r;t.StyledTextLinkModelType="StyledTextLinkItem",(r=n||(n={}))[r.TITLE=0]="TITLE",r[r.PRIMARY_TEXT=1]="PRIMARY_TEXT",r[r.SECONDARY_TEXT=2]="SECONDARY_TEXT",r[r.SECONDARY_TEXT_LINKABLE=3]="SECONDARY_TEXT_LINKABLE",r[r.PARAGRAPH_TEXT=4]="PARAGRAPH_TEXT",r[r.HIDDEN=5]="HIDDEN",t.StyledTextLinkItemStyle=n});e(sy);sy.StyledTextLinkModelType,sy.StyledTextLinkItemStyle;var ly=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r;t.TextCollectionType="textCollectionModel",(r=n||(n={}))[r.CONTAINER=0]="CONTAINER",r[r.PARAGRAPH_TEXT=1]="PARAGRAPH_TEXT",r[r.LABELLED_COLLECTION=2]="LABELLED_COLLECTION",t.TextCollectionStyle=n});e(ly);ly.TextCollectionType,ly.TextCollectionStyle;var uy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("DataWidgetTextCollectionTransformer"),n=function(){function e(e){this.collectionStyle=xt.exists(e.collectionStyle)?e.collectionStyle:null,this.primaryStyle=xt.exists(e.primaryStyle)?e.primaryStyle:null,this.secondaryStyle=xt.exists(e.secondaryStyle)?e.secondaryStyle:null,this.tertiaryStyle=xt.exists(e.tertiaryStyle)?e.tertiaryStyle:null,this.quaternaryStyle=xt.exists(e.quaternaryStyle)?e.quaternaryStyle:null,this.isExpandable=e.isExpandable||!1}return e.prototype.transform=function(e){var t=Dm.textModelFromTextMap(e.textMap);if(Dm.hasNoText(t))return r.warn("Data widget had no text, cannot transform",e),null;var n=[];return this.addTextLinkItemIfPresent(t.primaryText,this.primaryStyle,n),this.addTextLinkItemIfPresent(t.secondaryText,this.secondaryStyle,n),this.addTextLinkItemIfPresent(t.tertiaryText,this.tertiaryStyle,n),this.addTextLinkItemIfPresent(t.quaternaryText,this.quaternaryStyle,n),{type:ly.TextCollectionType,style:this.collectionStyle,textModels:n,id:_m.ViewModelIdGenerator.generateDefaultId(ly.TextCollectionType,e.id)}},e.prototype.addTextLinkItemIfPresent=function(e,t,n){if(xt.exists(e)){var r={type:sy.StyledTextLinkModelType,text:e,style:t,isExpandable:this.isExpandable,id:_m.ViewModelIdGenerator.generateDefaultId(sy.StyledTextLinkModelType)};n.push(r)}},e}();t.DataWidgetTextCollectionTransformer=n});e(uy);uy.DataWidgetTextCollectionTransformer;var cy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayLiveQuickViewButtonModelType="XrayLiveQuickViewButtonModel"});e(cy);cy.XrayLiveQuickViewButtonModelType;var dy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.atv.discovery.LinkActionType,o=M.get("DataWidgetLiveQuickViewButtonTransformer"),n=function(){function e(){}return e.prototype.transform=function(e){var t=Dm.textModelFromTextMap(e.textMap);if(null===t.primaryText)return o.warn("Live stats button data widget missing primary text. Cannot transform. "+e),null;var n=Km.XraySwiftUtils.navigationalActionFromLinkActionMap(e.linkActionMap,i.PRIMARY);if(null===n)return o.warn("No primary action present on live stats button data widget. Cannot transform. "+e),null;var r=zm.SwiftLinkActionResolver.getActionFromNavigationalAction(n);return null===r?(o.warn("Could not transform primary action on live stats button data widget. Cannot transform. "+e),null):{type:cy.XrayLiveQuickViewButtonModelType,id:_m.ViewModelIdGenerator.generateDefaultId(cy.XrayLiveQuickViewButtonModelType,e.id),primaryText:t.primaryText,linkAction:r}},e}();t.DataWidgetLiveQuickViewButtonTransformer=n});e(dy);dy.DataWidgetLiveQuickViewButtonTransformer;var py=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.BlueprintIds,n=function(t){function n(e){return t.call(this,n.createTransformersMap(e))||this}return i(n,t),n.createTransformersMap=function(e){var t={};return t[o.XRAY_QUICKVIEW_VIEW_ALL_BUTTON]=new oy.DataWidgetQuickViewHeaderTransformer(e),t[o.XRAY_DETAIL_IMAGE_ITEM]=new ny.DataWidgetImageTextLinkTransformer(qm.XrayPlaceholder.PERSON),t[o.XRAY_DETAIL_TITLE]=new uy.DataWidgetTextCollectionTransformer({primaryStyle:sy.StyledTextLinkItemStyle.TITLE}),t[o.PARAGRAPH_TEXT]=new uy.DataWidgetTextCollectionTransformer({collectionStyle:ly.TextCollectionStyle.PARAGRAPH_TEXT,primaryStyle:sy.StyledTextLinkItemStyle.PARAGRAPH_TEXT,secondaryStyle:sy.StyledTextLinkItemStyle.HIDDEN,tertiaryStyle:sy.StyledTextLinkItemStyle.HIDDEN,quaternaryStyle:sy.StyledTextLinkItemStyle.HIDDEN}),t[o.EXPANDABLE_TEXT]=new uy.DataWidgetTextCollectionTransformer({collectionStyle:ly.TextCollectionStyle.PARAGRAPH_TEXT,isExpandable:!0,primaryStyle:sy.StyledTextLinkItemStyle.PARAGRAPH_TEXT,secondaryStyle:sy.StyledTextLinkItemStyle.HIDDEN,tertiaryStyle:sy.StyledTextLinkItemStyle.HIDDEN,quaternaryStyle:sy.StyledTextLinkItemStyle.HIDDEN}),t[o.TEXT_BUTTON]=new ay.DataWidgetTextButtonTransformer,t[o.XRAY_LIVE_QUICKVIEW_VIEW_ALL_BUTTON]=new dy.DataWidgetLiveQuickViewButtonTransformer,t[o.XRAY_SQUARE_DETAIL_IMAGE_ITEM]=new ny.DataWidgetImageTextLinkTransformer(qm.XrayPlaceholder.SCENES),t[o.XRAY_DETAIL_TITLE_SUBHEADER]=new uy.DataWidgetTextCollectionTransformer({primaryStyle:sy.StyledTextLinkItemStyle.SECONDARY_TEXT}),t[o.XRAY_BOLD_TEXT_BUTTON]=new ay.DataWidgetTextButtonTransformer,t},n}(ry.BlueprintAwareWidgetTransformer);t.DataWidgetTransformer=n});e(py);py.DataWidgetTransformer;var fy=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.VERTICALLY_SCROLLABLE=0]="VERTICALLY_SCROLLABLE",r[r.VERTICAL=1]="VERTICAL",r[r.HORIZONTAL=2]="HORIZONTAL",r[r.DETAIL_TITLE_CONTAINER=3]="DETAIL_TITLE_CONTAINER",r[r.DETAIL_INFO_CONTAINER=4]="DETAIL_INFO_CONTAINER",r[r.QUICKVIEW_CONTAINER=5]="QUICKVIEW_CONTAINER",r[r.XRAY_TAB=6]="XRAY_TAB",r[r.XRAY_TAB_BAR=7]="XRAY_TAB_BAR",r[r.XRAY_MATERIAL_TAB_BAR=8]="XRAY_MATERIAL_TAB_BAR",t.WidgetGroupStyle=n;t.WidgetGroupType="widgetGroupModel"});e(fy);fy.WidgetGroupStyle,fy.WidgetGroupType;var hy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function r(e,t){this.style=e,this.widgetTransformer=t}return r.prototype.transform=function(e){var t=this,n=F.chain(e.widgets.widgetList).map(function(e){return t.widgetTransformer.transform(e)}).filter(function(e){return null!==e}).value();return e.id||(e.id="widgetGroupId"+r.generatedWidgetId++),{id:_m.ViewModelIdGenerator.generateDefaultId(fy.WidgetGroupType,e.id),type:fy.WidgetGroupType,style:this.style,items:n}},r.generatedWidgetId=0,r}();t.WidgetGroupCollectionModelTransformer=n});e(hy);hy.WidgetGroupCollectionModelTransformer;var my=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.TwoSectionDetailViewModelType="TwoSectionDetailViewModel"});e(my);my.TwoSectionDetailViewModelType;var yy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("TwoSectionDetailWidgetGroupTransformer"),r=function(){function e(e){this.widgetTransformer=e}return e.prototype.transform=function(e){var t=e.widgets.widgetList;return t.length<2?(n.warn("Provided detail page widget group had fewer than two widgets",e),null):(2<t.length&&n.warn("Provided detail page widget group had more than two widgets. Extra widgets will be ignored.",e),{type:my.TwoSectionDetailViewModelType,leftSectionModel:this.widgetTransformer.transform(t[0]),rightSectionModel:this.widgetTransformer.transform(t[1]),id:_m.ViewModelIdGenerator.generateDefaultId(my.TwoSectionDetailViewModelType,e.id)})},e}();t.TwoSectionDetailWidgetGroupTransformer=r});e(yy);yy.TwoSectionDetailWidgetGroupTransformer;var gy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XraySelectableCollectionContainerType="XraySelectableCollectionContainerModel"});e(gy);gy.XraySelectableCollectionContainerType;var vy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("WidgetGroupSelectableCollectionContainerTransformer"),n=function(){function e(e){this.widgetTransformer=e}return e.prototype.transform=function(e){for(var t=[],n=0,r=e.widgets.widgetList;n<r.length;n++){var i=r[n];t.push(this.widgetTransformer.transform(i))}return e.id?{id:e.id,type:gy.XraySelectableCollectionContainerType,items:t,initialSelectionIndex:0}:(o.warn("Selectable Collection Container has null widgetId: "+e),null)},e}();t.WidgetGroupSelectableCollectionContainerTransformer=n});e(vy);vy.WidgetGroupSelectableCollectionContainerTransformer;var Sy=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.BlueprintIds,n=function(t){function n(e){return t.call(this,n.createTransformersMap(e),new hy.WidgetGroupCollectionModelTransformer(fy.WidgetGroupStyle.VERTICAL,e))||this}return i(n,t),n.createTransformersMap=function(e){var t;return(t={})[o.VERTICALLY_SCROLLING]=new hy.WidgetGroupCollectionModelTransformer(fy.WidgetGroupStyle.VERTICALLY_SCROLLABLE,e),t[o.VERTICAL_LAYOUT]=new hy.WidgetGroupCollectionModelTransformer(fy.WidgetGroupStyle.VERTICAL,e),t[o.HORIZONTAL_LAYOUT]=new hy.WidgetGroupCollectionModelTransformer(fy.WidgetGroupStyle.HORIZONTAL,e),t[o.DETAIL_TAB]=new yy.TwoSectionDetailWidgetGroupTransformer(e),t[o.XRAY_DETAIL_TITLE_CONTAINER]=new hy.WidgetGroupCollectionModelTransformer(fy.WidgetGroupStyle.DETAIL_TITLE_CONTAINER,e),t[o.XRAY_DETAIL_INFO_CONTAINER]=new hy.WidgetGroupCollectionModelTransformer(fy.WidgetGroupStyle.DETAIL_INFO_CONTAINER,e),t[o.XRAY_QUICKVIEW_CONTAINER]=new hy.WidgetGroupCollectionModelTransformer(fy.WidgetGroupStyle.QUICKVIEW_CONTAINER,e),t[o.CAROUSEL_CONTAINER]=new vy.WidgetGroupSelectableCollectionContainerTransformer(e),t},n}(ry.BlueprintAwareWidgetTransformer);t.WidgetGroupTransformer=n});e(Sy);Sy.WidgetGroupTransformer;var by=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("GridTileDataTransformer"),n=function(){function e(e,t){void 0===t&&(t=qm.XrayPlaceholder.PERSON),this.style=e,this.placeholder=t}return e.prototype.convertSwiftItemToViewModel=function(e){var t=Gm.gridModelFromBlueprintedItem(e,this.style,this.placeholder),n=t.image.imageData;return!Dm.hasNoText(t.textMap)||null!==n&&xt.exists(n.imageUrl)?t:(r.warn("Cannot display a grid tile that has neither image nor any text"),null)},e}();t.GridTileDataTransformer=n});e(by);by.GridTileDataTransformer;var Ty=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.atv.discovery.LinkActionType,i="gridTileTextViewModel";t.GridTileTextViewModelType=i,t.gridTextViewModelFromBlueprintedItem=function(e){if(!xt.exists(e))return null;var t=Km.XraySwiftUtils.navigationalActionFromLinkActionMap(e.linkActionMap,r.PRIMARY),n=zm.SwiftLinkActionResolver.getActionFromNavigationalAction(t);return{type:i,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap),linkAction:n}}});e(Ty);Ty.GridTileTextViewModelType,Ty.gridTextViewModelFromBlueprintedItem;var Py=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("GridTileDataTransformer"),r=function(){function e(){}return e.prototype.convertSwiftItemToViewModel=function(e){var t=Ty.gridTextViewModelFromBlueprintedItem(e);return Dm.hasNoText(t.textMap)?(n.warn("Cannot display a grid text tile that has no text"),null):t},e}();t.GridTextTileDataTransformer=r});e(Py);Py.GridTextTileDataTransformer;var wy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.TriviaViewModelType="triviaViewModel"});e(wy);wy.TriviaViewModelType;var Cy=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.GRID=0]="GRID",r[r.LIST=1]="LIST",r[r.COLLAPSIBLE_LIST=2]="COLLAPSIBLE_LIST",r[r.CAROUSEL=3]="CAROUSEL",r[r.CAROUSEL_MINI_DETAILS=4]="CAROUSEL_MINI_DETAILS",r[r.STATIC_CAROUSEL=5]="STATIC_CAROUSEL",r[r.QUICKVIEW_LIST=6]="QUICKVIEW_LIST",r[r.TITLE=7]="TITLE",r[r.HORIZONTAL_QUICKVIEW=8]="HORIZONTAL_QUICKVIEW",r[r.POP_UP=9]="POP_UP",t.CollectionStyle=n;t.CollectionModelType="collectionModel"});e(Cy);Cy.CollectionStyle,Cy.CollectionModelType;var My=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r;t.XrayListItemViewModelType="xrayListItemViewModel",(r=n||(n={}))[r.MUSIC=0]="MUSIC",r[r.TRIVIA=1]="TRIVIA",r[r.SCENES=2]="SCENES",t.XrayListItemStyle=n});e(My);My.XrayListItemViewModelType,My.XrayListItemStyle;var Iy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.atv.discovery.RelatedCollectionBlueprintedItem,o=Mf.com.amazon.atv.discovery.BlueprintedItem,a=Mf.com.amazon.atv.discovery.ItemType,s=Mf.com.amazon.atv.discovery.LinkActionType,n=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){if(!this.validator.isA(e,o))return null;var t=Wm.buttonModelFromLinkActionMap(e.linkActionMap,s.SECONDARY,Hm.XrayIcon.PLAY),n=Km.XraySwiftUtils.createAccessibilityDescription(e.accessibilityMap,e.textMap),r={type:wy.TriviaViewModelType,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap),accessibilityDescription:n,jumpToSceneModel:t,image:null,relatedNames:null,style:My.XrayListItemStyle.TRIVIA};return this.validator.isA(e,i)&&(r.relatedNames=this.processRelatedCollection(e.relatedCollection)),r},e.prototype.processRelatedCollection=function(e){var t=this;if(!xt.exists(e))return null;var n=e.itemList;if(!xt.exists(n))return null;var r=F.chain(n).map(function(e){switch(e.type){case a.BLUEPRINTED_ITEM:return t.validator.isA(e,o)?Gm.gridModelFromBlueprintedItem(e,Gm.GridTileStyle.RELATED_NAME,qm.XrayPlaceholder.PERSON):null;default:return null}}).filter(function(e){return null!==e}).value();return F.isEmpty(r)?null:{type:Cy.CollectionModelType,items:r,style:Cy.CollectionStyle.STATIC_CAROUSEL,id:_m.ViewModelIdGenerator.generateDefaultId(Cy.CollectionModelType)}},e}();t.TriviaItemDataTransformer=n});e(Iy);Iy.TriviaItemDataTransformer;var Ey=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.BlueprintedItem,r=Mf.com.amazon.atv.discovery.LinkActionType,i=Mf.com.amazon.atv.discovery.ImageType,o=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return this.validator.isA(e,n)?{type:My.XrayListItemViewModelType,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap),accessibilityDescription:Km.XraySwiftUtils.createAccessibilityDescription(e.accessibilityMap,e.textMap),jumpToSceneModel:Wm.buttonModelFromLinkActionMap(e.linkActionMap,r.SECONDARY,Hm.XrayIcon.PLAY),viewInStoreButton:Wm.buttonModelFromLinkActionMap(e.linkActionMap,r.TERTIARY),image:{placeholder:qm.XrayPlaceholder.MUSIC,imageData:Km.XraySwiftUtils.imageModelFromImageMap(e.imageMap,i.PRIMARY)},style:My.XrayListItemStyle.MUSIC}:null},e}();t.MusicItemDataTransformer=o});e(Ey);Ey.MusicItemDataTransformer;var _y=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.LinkActionType,r=Mf.com.amazon.atv.discovery.BlueprintedItem,i=Mf.com.amazon.atv.discovery.ImageType,o=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return this.validator.isA(e,r)?{type:My.XrayListItemViewModelType,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap),accessibilityDescription:Km.XraySwiftUtils.createAccessibilityDescription(e.accessibilityMap,e.textMap),jumpToSceneModel:Wm.buttonModelFromLinkActionMap(e.linkActionMap,n.SECONDARY,Hm.XrayIcon.PLAY),image:{imageData:Km.XraySwiftUtils.imageModelFromImageMap(e.imageMap,i.PRIMARY),placeholder:qm.XrayPlaceholder.SCENES},style:My.XrayListItemStyle.SCENES}:null},e}();t.SceneItemDataTransformer=o});e(_y);_y.SceneItemDataTransformer;var xy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.atv.discovery.LinkActionType,n=function(){function e(e){void 0===e&&(e=null),this.itemStyle=e}return e.prototype.convertSwiftItemToViewModel=function(e){var t,n,r=Wm.buttonModelFromLinkActionMap(e.linkActionMap,o.PRIMARY);if(null!==r)t=r.label,n=r.linkAction;else{var i=Dm.textModelFromTextMap(e.textMap).primaryText||null;if(null===i)return null;t=i,n=null}return{id:e.id,type:sy.StyledTextLinkModelType,text:t,style:this.itemStyle,linkAction:n}},e}();t.BlueprintedItemStyledTextLinkTransformer=n});e(xy);xy.BlueprintedItemStyledTextLinkTransformer;var ky=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("CollectionV2ViewModelTransformer"),n=S.of("CollectionV2ViewModelTransformer"),r=function(){function e(e){this.itemListTransformer=n(e.itemListTransformer,"itemListTransformer").exists(),this.collectionStyle=e.collectionStyle,this.dynamicLoad=e.dynamicLoad||!1,e.label?(this.labelStyle=e.label.style,this.labelSeparator=e.label.separator||null):(this.labelSeparator=null,this.labelStyle=null)}return e.prototype.transform=function(e){var t=e.items||null;if(null===t)return null;var n=this.itemListTransformer.transform(t.itemList),r=null,i=e.text||null;return null!==i&&(null===this.labelStyle?o.warn("No label style was specified, but the collection had a label. Ignoring label"):(null!==this.labelSeparator&&(i+=this.labelSeparator),r={type:sy.StyledTextLinkModelType,text:i,style:this.labelStyle,id:_m.ViewModelIdGenerator.generateDefaultId(sy.StyledTextLinkModelType)})),{type:Cy.CollectionModelType,items:n,style:this.collectionStyle,title:r,dynamicLoad:this.dynamicLoad,id:_m.ViewModelIdGenerator.generateDefaultId(Cy.CollectionModelType,e.id),analytics:e.analytics}},e}();t.CollectionV2ViewModelTransformer=r});e(ky);ky.CollectionV2ViewModelTransformer;var Ry=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.ItemType,r=S.of("ItemListTransformer"),i=M.get("ItemListTransformer"),o=function(){function e(e,t,n){void 0===n&&(n=new Mf.Validator),this.itemTransformers=r(e,"itemTransformers").exists(),this.fallbackItemTransformer=t||null,this.validator=n}return e.prototype.transform=function(e){var n=this;return F.chain(e).map(function(e){var t=n.getBlueprintForItem(e);return xt.exists(t)?F.has(n.itemTransformers,t)?n.itemTransformers[t].convertSwiftItemToViewModel(e):(i.warn("No transformer registered for item blueprint: "+t),null===n.fallbackItemTransformer?null:n.fallbackItemTransformer.convertSwiftItemToViewModel(e)):(i.warn("Item in collection has no blueprint",e),null)}).filter(function(e){return null!==e}).value()},e.prototype.getBlueprintForItem=function(e){switch(e.type){case n.XRAY_SCOREBOARD_ITEM:case n.BLUEPRINTED_ITEM:case n.RELATED_COLLECTION_BLUEPRINTED_ITEM:case n.XRAY_GRAPHED_ITEM:return e.blueprint.id;default:return null}},e}();t.ItemListTransformer=o});e(Ry);Ry.ItemListTransformer;var Ay=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.itemDelimiter=xt.exists(e.itemDelimiter)?e.itemDelimiter:", ",this.style=e.style;var n=new xy.BlueprintedItemStyledTextLinkTransformer(e.itemStyle);this.collectionTransformer=t||new ky.CollectionV2ViewModelTransformer({itemListTransformer:new Ry.ItemListTransformer({},n),collectionStyle:Cy.CollectionStyle.LIST,dynamicLoad:!1,label:{style:e.labelStyle}})}return e.prototype.transform=function(e){var r=this,t=this.collectionTransformer.transform(e),i=t.items,n=F.map(i,function(e,t){var n=e;return t===i.length-1||(n.text+=r.itemDelimiter),n});return{type:ly.TextCollectionType,textModels:n,style:this.style,label:t.title,id:_m.ViewModelIdGenerator.generateDefaultId(ly.TextCollectionType,e.id)}},e}();t.DelimitedTextCollectionTransformer=n});e(Ay);Ay.DelimitedTextCollectionTransformer;var Oy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.PhotoGalleryCollectionModelType="photoGalleryCollectionModel"});e(Oy);Oy.PhotoGalleryCollectionModelType;var Ly=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.atv.discovery.BlueprintedItem,o=M.get("CollectionV2GalleryViewModelTransformer"),n=function(){function e(e,t){void 0===t&&(t=new Mf.Validator),this.itemTransformer=e,this.validator=t}return e.prototype.transform=function(e){var n=this,t=e.items||null;if(null===t)return o.warn("Could not transform Gallery, ItemsBase was null",e),null;this.itemTransformer.setItemIndexMapping(t.itemList);var r=F.chain(t.itemList).map(function(e){if(!n.validator.isA(e,i))return o.warn("Item in collection is not a blueprinted item, cannot render",e),null;var t=e;return n.itemTransformer.convertSwiftItemToViewModel(t)}).filter(function(e){return null!==e}).value();return{type:Oy.PhotoGalleryCollectionModelType,galleryItems:r,id:_m.ViewModelIdGenerator.generateDefaultId(Oy.PhotoGalleryCollectionModelType,e.id)}},e}();t.CollectionV2GalleryViewModelTransformer=n});e(Ly);Ly.CollectionV2GalleryViewModelTransformer;var Fy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.PhotoGalleryImageModelType="photoGalleryImageModelType"});e(Fy);Fy.PhotoGalleryImageModelType;var Dy=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.PhotoGalleryChangeItemAction"},n}(Lf.Action);t.PhotoGalleryChangeItemAction=n});e(Dy);Dy.PhotoGalleryChangeItemAction;var Ny=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=Mf.com.amazon.atv.discovery.BlueprintedItem,c=Mf.com.amazon.atv.discovery.ImageType,d=M.get("PhotoGallerySwiftDataTransformer"),p=S.of("PhotoGallerySwiftDataTransformer"),n=function(){function e(e,t){void 0===t&&(t=new Mf.Validator),this.itemIndexMap={},this.blueprintedItems=[],this.itemMappingCreated=!1,this.localization=p(e,"localization").exists(),this.validator=t}return e.prototype.setItemIndexMapping=function(e){this.itemMappingCreated=!1,this.blueprintedItems=[],this.itemIndexMap={};for(var t=0;t<e.length;t++){var n=e[t];if(this.validator.isA(n,a)){var r=n;this.blueprintedItems.push(r)}else d.warn("Non blueprinted item found in gallery itemList")}for(var i=0;i<this.blueprintedItems.length;i++){var o=this.blueprintedItems[i];this.itemIndexMap[o.id]=i}this.itemMappingCreated=!0},e.prototype.convertSwiftItemToViewModel=function(e){if(p(this.itemMappingCreated,"item mapping must be created first").true(),!xt.exists(e))return null;var t=this.itemIndexMap[e.id];if(!xt.exists(t))return d.warn("Tried to create PhotoGalleryImageModel for item who's id is not mapped",t),null;var n=this.blueprintedItems[t+1]||null,r=null;null!==n&&(r={itemId:n.id,refMarker:bm.XrayRefMarkers.GALLERY_DETAIL_NEXT});var i=this.blueprintedItems[t-1]||null,o=null;null!==i&&(o={itemId:i.id,refMarker:bm.XrayRefMarkers.GALLERY_DETAIL_PREV});var a=Dm.textModelFromTextMap(e.textMap),s=a.primaryText||null,l=xt.exists(a.secondaryText)?a.secondaryText:this.localization.localizedStrings.photoGallery.count,u=t+1;return{type:Fy.PhotoGalleryImageModelType,id:e.id,caption:s,image:{imageData:Km.XraySwiftUtils.imageModelFromImageMap(e.imageMap,c.PRIMARY),placeholder:null},numberOfImagesText:l.replace("{{current}}",""+u).replace("{{total}}",""+this.blueprintedItems.length),exitGalleryText:this.localization.localizedStrings.photoGallery.exit,nextItemAction:null!==r?new Dy.PhotoGalleryChangeItemAction(r):null,prevItemAction:null!==o?new Dy.PhotoGalleryChangeItemAction(o):null,imagePreloadData:[]}},e}();t.PhotoGallerySwiftDataTransformer=n});e(Ny);Ny.PhotoGallerySwiftDataTransformer;var Uy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.ImageType;t.imageModelFromImageMap=function(e){return xt.exists(e)?{primaryImage:Km.XraySwiftUtils.imageModelFromImageMap(e,n.PRIMARY),secondaryImage:Km.XraySwiftUtils.imageModelFromImageMap(e,n.SECONDARY),tertiaryImage:Km.XraySwiftUtils.imageModelFromImageMap(e,n.TERTIARY)}:{primaryImage:null,secondaryImage:null,tertiaryImage:null}},t.containsValidImageModel=function(e){return null===e.primaryImage&&null===e.secondaryImage&&null===e.tertiaryImage}});e(Uy);Uy.imageModelFromImageMap,Uy.containsValidImageModel;var By=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r;t.LiveStatsTableViewModelType="liveStatsTableViewModelType",(r=n||(n={}))[r.THREE_COLUMN=0]="THREE_COLUMN",r[r.FIVE_COLUMN=1]="FIVE_COLUMN",t.LiveStatsTableViewModelStyle=n});e(By);By.LiveStatsTableViewModelType,By.LiveStatsTableViewModelStyle;var Vy=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.PRIMARY=0]="PRIMARY",r[r.SECONDARY=1]="SECONDARY",r[r.TERTIARY=2]="TERTIARY",r[r.QUATERNARY=3]="QUATERNARY",r[r.NONE=4]="NONE",t.TextMapHighlightedIndex=n});e(Vy);Vy.TextMapHighlightedIndex;var jy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=Mf.com.amazon.avod.xray.BlueprintIds;t.LiveStatsTableRowModelType="liveStatsTableRowModelType",(r=n||(n={}))[r.HEADER=0]="HEADER",r[r.NORMAL=1]="NORMAL",r[r.HIGHLIGHTED=2]="HIGHLIGHTED",t.LiveStatsTableRowModelStyle=n,t.determineHighlightedIndex=function(e){switch(e){case i.XRAY_TEAM_STAT_SECONDARY_HIGHLIGHTED:return Vy.TextMapHighlightedIndex.SECONDARY;case i.XRAY_TEAM_STAT_TERTIARY_HIGHLIGHTED:return Vy.TextMapHighlightedIndex.TERTIARY;default:return Vy.TextMapHighlightedIndex.NONE}}});e(jy);jy.LiveStatsTableRowModelType,jy.LiveStatsTableRowModelStyle,jy.determineHighlightedIndex;var Xy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.RelatedCollectionBlueprintedItem,s=Mf.com.amazon.atv.discovery.BlueprintedItem,r=Mf.com.amazon.avod.xray.BlueprintIds,i=function(){function e(e,t){void 0===t&&(t=new Mf.Validator),this.modelStyle=e,this.validator=t}return e.prototype.convertSwiftItemToViewModel=function(e){return this.validator.isA(e,n)?{id:e.id,type:By.LiveStatsTableViewModelType,textMap:Dm.textModelFromTextMap(e.textMap),imageMap:Uy.imageModelFromImageMap(e.imageMap),tables:this.buildTables(e),style:this.modelStyle}:null},e.prototype.buildTables=function(e){if(!xt.exists(e.relatedCollection))return[];var t=[],n={table:[]};this.modelStyle===By.LiveStatsTableViewModelStyle.THREE_COLUMN&&xt.exists(e.imageMap)&&n.table.push({id:e.id+"_header",type:jy.LiveStatsTableRowModelType,textMap:Dm.textModelFromTextMap(e.textMap),imageMap:Uy.imageModelFromImageMap(e.imageMap),style:jy.LiveStatsTableRowModelStyle.HEADER,highlightedItemIndex:Vy.TextMapHighlightedIndex.NONE});for(var r=0,i=e.relatedCollection.itemList;r<i.length;r++){var o=i[r];if(this.validator.isA(o,s)){var a=this.liveStatsTableViewModelFromBlueprintedItem(o);a.style===jy.LiveStatsTableRowModelStyle.HEADER&&0!==n.table.length&&(t.push(n),n={table:[]}),n.table.push(a)}}return 0<n.table.length&&t.push(n),t},e.prototype.liveStatsTableViewModelFromBlueprintedItem=function(e){return xt.exists(e)?{id:e.id,type:jy.LiveStatsTableRowModelType,textMap:Dm.textModelFromTextMap(e.textMap),imageMap:Uy.imageModelFromImageMap(e.imageMap),style:this.determineItemStyle(e.blueprint.id),highlightedItemIndex:jy.determineHighlightedIndex(e.blueprint.id)}:null},e.prototype.determineItemStyle=function(e){switch(e){case r.XRAY_STAT_ITEM_SUB_HEADER:case r.XRAY_THREE_COLUMN_SUB_HEADER:return jy.LiveStatsTableRowModelStyle.HEADER;case r.XRAY_TEAM_STAT_SECONDARY_HIGHLIGHTED:case r.XRAY_TEAM_STAT_TERTIARY_HIGHLIGHTED:return jy.LiveStatsTableRowModelStyle.HIGHLIGHTED;default:return jy.LiveStatsTableRowModelStyle.NORMAL}},e}();t.LiveStatsTransformer=i});e(Xy);Xy.LiveStatsTransformer;var zy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r;t.LivePlayHistoryViewModelType="livePlayHistoryViewModelType",(r=n||(n={}))[r.NORMAL=0]="NORMAL",r[r.PENDING=1]="PENDING",t.LivePlayHistoryViewModelStyle=n});e(zy);zy.LivePlayHistoryViewModelType,zy.LivePlayHistoryViewModelStyle;var qy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.atv.discovery.LinkActionType,i=M.get("BlueprintAwareWidgetTransformer"),n=function(){function t(e,t){void 0===t&&(t=new Mf.Validator),this.modelStyle=e,this.validator=t}return t.prototype.convertSwiftItemToViewModel=function(e){return{id:e.id,type:zy.LivePlayHistoryViewModelType,textMap:Dm.textModelFromTextMap(e.textMap),imageIcon:Uy.imageModelFromImageMap(e.imageMap).primaryImage,annexImageIcon:Uy.imageModelFromImageMap(e.imageMap).secondaryImage,highlightButton:t.convertHighlightButton(e,this.validator),replayBoothButton:t.convertReplayBoothButton(e,this.validator),style:this.modelStyle}},t.convertHighlightButton=function(e,t){if(!xt.exists(Uy.imageModelFromImageMap(e.imageMap).secondaryImage))return null;var n=this.getBlueprintedItemLinkAction(e,t);return null===n?null:xt.exists(n)&&xt.exists(n.parameters)&&xt.exists(n.parameters.id)&&xt.exists(n.parameters.duration)&&!isNaN(Number(n.parameters.duration))&&xt.exists(n.parameters.timecode)&&!isNaN(Number(n.parameters.timecode))&&xt.exists(n.parameters.title)?{clipDurationMs:Number(n.parameters.duration),clipStartPositionMs:Number(n.parameters.timecode),title:n.parameters.title,id:n.parameters.id,analytics:n.analytics}:null},t.convertReplayBoothButton=function(e,t){var n=this.getBlueprintedItemLinkAction(e,t);if(null===n)return null;if(!(xt.exists(n)&&xt.exists(n.parameters)&&xt.exists(n.parameters.id)&&xt.exists(n.parameters.videoUrlMap)))return null;var r,i,o=this.parseUrlMap(n.parameters.videoUrlMap);if(!xt.exists(o.UrlMap)||!xt.exists(o.CdnPreferenceList)||0===o.CdnPreferenceList.length)return null;i=o.UrlMap,r=o.CdnPreferenceList;var a=this.parseUrlMap(n.parameters.miniXrayUrlMap);return{videoUrlMap:i,miniXrayUrlMap:a.UrlMap,videoCdnPreferenceList:r,miniXrayCdnPreferenceList:a.CdnPreferenceList,headerText:n.parameters.header,title:n.parameters.title,id:n.parameters.id,analytics:n.analytics}},t.getBlueprintedItemLinkAction=function(e,t){var n=Km.XraySwiftUtils.navigationalActionFromLinkActionMap(e.linkActionMap,r.PRIMARY,t);return xt.exists(n)&&xt.exists(n.parameters)?n:null},t.parseUrlMap=function(t){var e=null,n=[];try{e=JSON.parse(t),n=Object.keys(e)}catch(e){i.warn("Cannot transfer the url map. "+t)}return{UrlMap:e,CdnPreferenceList:n}},t}();t.LivePlayHistoryTransformer=n});e(qy);qy.LivePlayHistoryTransformer;var Wy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=Mf.com.amazon.avod.xray.BlueprintIds,n=Mf.com.amazon.atv.discovery.LinkActionType,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return{id:e.id,type:zy.LivePlayHistoryViewModelType,textMap:Dm.textModelFromTextMap(e.textMap),imageIcon:Uy.imageModelFromImageMap(e.imageMap).primaryImage,annexImageIcon:Uy.imageModelFromImageMap(e.imageMap).secondaryImage,highlightButton:qy.LivePlayHistoryTransformer.convertHighlightButton(e,this.validator),replayBoothButton:qy.LivePlayHistoryTransformer.convertReplayBoothButton(e,this.validator),style:zy.LivePlayHistoryViewModelStyle.NORMAL,subItems:this.convertRelatedCollection(e),filters:this.convertFilter(e)}},e.prototype.convertRelatedCollection=function(e){var t,n=null,r=null,i=null,o=e.relatedCollection;if(xt.exists(o))for(var a=0;a<o.itemList.length;a++){switch((t=e.relatedCollection.itemList[a]).blueprint.id){case s.XRAY_PLAY_HISTORY_BUTTON_SUB_ITEM:n=this.convertButtonModel(t);break;case s.XRAY_PLAY_HISTORY_ROUTE_MAP_SUB_ITEM:r=Uy.imageModelFromImageMap(t.imageMap);break;case s.XRAY_PLAY_HISTORY_REPLAY_BOOTH_SUB_ITEM:i=this.convertReplay(t)}}return{buttonViewModel:n,routeMap:r,replayViewModel:i}},e.prototype.convertButtonModel=function(e){var t=e.blueprint.properties;return{textMap:Dm.textModelFromTextMap(e.textMap),expandedInitially:xt.exists(t)&&xt.exists(t.expandedInitially)&&"true"===t.expandedInitially}},e.prototype.convertReplay=function(e){return{textMap:Dm.textModelFromTextMap(e.textMap),imageMap:Uy.imageModelFromImageMap(e.imageMap),linkAction:xt.exists(e.linkActionMap)&&xt.exists(e.linkActionMap.PRIMARY)?zm.SwiftLinkActionResolver.getActionFromNavigationalAction(Km.XraySwiftUtils.navigationalActionFromLinkActionMap(e.linkActionMap,n.PRIMARY)):null}},e.prototype.convertFilter=function(e){var t=e.blueprint.properties;if(xt.exists(t)&&xt.exists(t.filters))return t.filters},e}();t.LiveFormattedPlayHistoryTransformer=r});e(Wy);Wy.LiveFormattedPlayHistoryTransformer;var Hy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r;t.XrayTwoColumnLiveItemModelType="XrayTwoColumnLiveItemModel",(r=n||(n={}))[r.PLAYER_ITEM=0]="PLAYER_ITEM",r[r.TEAM_HEADER_ITEM=1]="TEAM_HEADER_ITEM",t.XrayTwoColumnLiveItemStyle=n});e(Hy);Hy.XrayTwoColumnLiveItemModelType,Hy.XrayTwoColumnLiveItemStyle;var Gy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.RelatedCollectionBlueprintedItem,r=Mf.com.amazon.atv.discovery.ImageType,i=function(){function e(e,t,n){void 0===n&&(n=new Mf.Validator),this.validator=n,this.style=t,this.swiftDataTransformer=e}return e.prototype.convertSwiftItemToViewModel=function(e){return this.validator.isA(e,n)?{type:Hy.XrayTwoColumnLiveItemModelType,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap),relatedItems:this.processRelatedCollection(e.relatedCollection),image:{placeholder:qm.XrayPlaceholder.PERSON,imageData:Km.XraySwiftUtils.imageModelFromImageMap(e.imageMap,r.PRIMARY)},style:this.style,analytics:e.analytics}:null},e.prototype.processRelatedCollection=function(e){if(!xt.exists(e))return null;var t=e.itemList;if(!xt.exists(t))return null;for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r],a=this.swiftDataTransformer.convertSwiftItemToViewModel(o);xt.exists(a)&&n.push(a)}return 0===n.length?null:{id:_m.ViewModelIdGenerator.generateDefaultId(fy.WidgetGroupType),type:fy.WidgetGroupType,style:fy.WidgetGroupStyle.VERTICAL,items:n}},e}();t.XrayTwoColumnLiveItemTransformer=i});e(Gy);Gy.XrayTwoColumnLiveItemTransformer;var Ky=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.ItemType,r=M.get("BlueprintAwareBlueprintedItemTransformer"),i=function(){function e(e,t){this.transformersMap=e,this.fallbackTransformer=t||null}return e.prototype.convertSwiftItemToViewModel=function(e){var t=this.getBlueprintIdForItem(e),n=this.transformersMap[t]||null;return null===n?this.tryFallbackTransform(e):n.convertSwiftItemToViewModel(e)},e.prototype.tryFallbackTransform=function(e){return null===this.fallbackTransformer?(r.warn("No fallback transformer registered, cannot transform blueprintedItem. Full object:\n"+JSON.stringify(e)),null):this.fallbackTransformer.convertSwiftItemToViewModel(e)},e.prototype.getBlueprintIdForItem=function(e){switch(e.type){case n.XRAY_SCOREBOARD_ITEM:case n.BLUEPRINTED_ITEM:case n.RELATED_COLLECTION_BLUEPRINTED_ITEM:return e.blueprint.id;default:return null}},e}();t.BlueprintAwareBlueprintedItemTransformer=i});e(Ky);Ky.BlueprintAwareBlueprintedItemTransformer;var Qy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.TwoColumnTableItemModelType="TwoColumnTableItemModel"});e(Qy);Qy.TwoColumnTableItemModelType;var Yy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.convertSwiftItemToViewModel=function(e){var t=Dm.textModelFromTextMap(e.textMap);return{type:Qy.TwoColumnTableItemModelType,id:e.id,primaryText:t.primaryText,supplementalText:t.secondaryText}},e}();t.TwoColumnTableItemTransformer=n});e(Yy);Yy.TwoColumnTableItemTransformer;var Jy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.TwoColumnSubheaderItemModelType="TwoColumnSubheaderItemModel"});e(Jy);Jy.TwoColumnSubheaderItemModelType;var $y=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.convertSwiftItemToViewModel=function(e){var t=Dm.textModelFromTextMap(e.textMap);return{type:Jy.TwoColumnSubheaderItemModelType,id:e.id,primaryText:t.primaryText}},e}();t.TwoColumnSubheaderItemTransformer=n});e($y);$y.TwoColumnSubheaderItemTransformer;var Zy=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.LiveOneColumnTableModelType="liveOneColumnTableModelType";t.LiveMatchStatsRowModelType="liveMatchStatsRowModelType";t.LiveMatchStatsTextRowModelType="liveMatchStatsTextRowModelType"});e(Zy);Zy.LiveOneColumnTableModelType,Zy.LiveMatchStatsRowModelType,Zy.LiveMatchStatsTextRowModelType;var eg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.atv.discovery.BlueprintedItem,a=Mf.com.amazon.avod.xray.XRayGraphedItem,n=Mf.com.amazon.avod.xray.BlueprintIds,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return{id:e.id,type:Zy.LiveOneColumnTableModelType,rows:this.buildRows(e),title:Dm.textModelFromTextMap(e.textMap).primaryText,analytics:e.analytics}},e.prototype.buildRows=function(e){for(var t=[],n=0,r=e.relatedCollection.itemList;n<r.length;n++){var i=r[n];this.validator.isA(i,a)?t.push(this.createMatchStatsRow(i)):this.validator.isA(i,o)&&t.push(this.createMatchedStatsTextRow(i))}return t},e.prototype.createMatchStatsRow=function(e){return xt.exists(e)?{id:e.id,type:Zy.LiveMatchStatsRowModelType,expandedInitially:Km.XraySwiftUtils.validateBlueprintProperty(e.blueprint.properties,"expandedInitially"),left:this.createMatchStatsComponent(e.left),right:this.createMatchStatsComponent(e.right),title:e.title}:null},e.prototype.createMatchStatsComponent=function(e){return xt.exists(e)?{textMap:Dm.textModelFromTextMap(e.textMap),iconImage:Uy.imageModelFromImageMap(e.imageMap).primaryImage,value:e.value,color:e.color}:null},e.prototype.createMatchedStatsTextRow=function(e){return xt.exists(e)?{id:e.id,type:Zy.LiveMatchStatsTextRowModelType,expandedInitially:!!xt.exists(e.blueprint.properties)&&xt.exists(e.blueprint.properties.expandedInitially),iconImage:Uy.imageModelFromImageMap(e.imageMap),textMap:Dm.textModelFromTextMap(e.textMap),isSubHeader:e.blueprint.id===n.XRAY_TEAM_STAT_CENTERED_SUBHEADER_ITEM,highlightedItemIndex:this.determineHighlightedIndex(e.blueprint.id)}:null},e.prototype.determineHighlightedIndex=function(e){switch(e){case n.XRAY_TEAM_STAT_CENTERED_SECONDARY_HIGHLIGHTED:return Vy.TextMapHighlightedIndex.SECONDARY;case n.XRAY_TEAM_STAT_CENTERED_TERTIARY_HIGHLIGHTED:return Vy.TextMapHighlightedIndex.TERTIARY;default:return Vy.TextMapHighlightedIndex.NONE}},e}();t.LiveOneColumnTableTransformer=r});e(eg);eg.LiveOneColumnTableTransformer;var tg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.LiveScorecardViewModelType="liveScorecardViewModelType"});e(tg);tg.LiveScorecardViewModelType;var ng=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.LiveTeamIconViewModelType="LiveTeamIconViewModelType"});e(ng);ng.LiveTeamIconViewModelType;var rg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.LiveScorecardColumnViewModelType="LiveScorecardColumnViewModelType"});e(rg);rg.LiveScorecardColumnViewModelType;var ig=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.atv.discovery.BlueprintedItem,n=Mf.com.amazon.avod.xray.XRayScoreboardItem,a=Mf.com.amazon.avod.xray.BlueprintIds,s=M.get("XrayScoreboardTransformer"),r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return this.validator.isA(e,n)?{id:e.id,type:tg.LiveScorecardViewModelType,textMap:Dm.textModelFromTextMap(e.gameInfo.textMap),leftTeam:this.buildTeamIcon(e.leftTeam),rightTeam:this.buildTeamIcon(e.rightTeam),expandableData:this.buildTable(e.expandableCollection)}:null},e.prototype.buildTeamIcon=function(e){var t=e.blueprint.properties,n=xt.exists(t)&&xt.exists(t.possession)&&"true"===t.possession;return{type:ng.LiveTeamIconViewModelType,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap),imageMap:Uy.imageModelFromImageMap(e.imageMap),possession:n}},e.prototype.buildTable=function(e){for(var t=[],n=0,r=e.itemList;n<r.length;n++){var i=r[n];if(this.validator.isA(i,o))i.blueprint.id===a.XRAY_SCORECARD_COLUMN_ITEM&&t.push(this.buildTableColumn(i));else s.warn("scorecard column is not blueprinted item")}return t},e.prototype.buildTableColumn=function(e){var t={primary:!1,secondary:!1,tertiary:!1,quaternary:!1},n=e.blueprint.properties;return xt.exists(n)&&(t.primary=xt.exists(n.primaryTextHighlighted)&&"true"===n.primaryTextHighlighted,t.secondary=xt.exists(n.secondaryTextHighlighted)&&"true"===n.secondaryTextHighlighted,t.tertiary=xt.exists(n.tertiaryTextHighlighted)&&"true"===n.tertiaryTextHighlighted,t.quaternary=xt.exists(n.quaternaryTextHighlighted)&&"true"===n.quaternaryTextHighlighted),{type:rg.LiveScorecardColumnViewModelType,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap),imageMap:Uy.imageModelFromImageMap(e.imageMap),textHighlights:t}},e}();t.XrayScoreboardTransformer=r});e(ig);ig.XrayScoreboardTransformer;var og=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayImageGraphProbabilityPercentageModelType="XrayImageGraphProbabilityPercentageModelType"});e(og);og.XrayImageGraphProbabilityPercentageModelType;var ag=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.avod.xray.XRayGraphedItem,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){if(!this.validator.isA(e,n))return null;var t=Uy.imageModelFromImageMap(e.left.imageMap);return{id:e.id,type:og.XrayImageGraphProbabilityPercentageModelType,title:e.title,mainText:Dm.textModelFromTextMap(e.left.textMap).primaryText,backgroundImage:t.primaryImage,cursorImage:t.secondaryImage,initialValue:e.left.value,endValue:e.right.value,analytics:e.analytics}},e}();t.XrayImageGraphProbabilityPercentageModelTransformer=r});e(ag);ag.XrayImageGraphProbabilityPercentageModelTransformer;var sg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayParagraphTextModelType="XrayParagraphTextModelType"});e(sg);sg.XrayParagraphTextModelType;var lg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.BlueprintedItem,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return this.validator.isA(e,n)?{id:e.id,type:sg.XrayParagraphTextModelType,textMap:Dm.textModelFromTextMap(e.textMap),analytics:e.analytics}:null},e}();t.XrayParagraphTextModelTransformer=r});e(lg);lg.XrayParagraphTextModelTransformer;var ug=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayPlayerStatisticModelType="XrayPlayerStatisticModelType"});e(ug);ug.XrayPlayerStatisticModelType;var cg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=Mf.com.amazon.atv.discovery.BlueprintedItem,n=function(){function e(e,t){void 0===t&&(t=new Mf.Validator),this.validator=t,this.swiftDataTransformer=e}return e.prototype.convertSwiftItemToViewModel=function(e){return{id:e.id,type:ug.XrayPlayerStatisticModelType,primaryImage:Uy.imageModelFromImageMap(e.imageMap).primaryImage,textMap:Dm.textModelFromTextMap(e.textMap),isExpandable:Km.XraySwiftUtils.validateBlueprintProperty(e.blueprint.properties,"expandable"),parseTextAsHtml:Km.XraySwiftUtils.validateBlueprintProperty(e.blueprint.properties,"parseTextAsHtml"),items:this.convertSwiftItemsFromRelatedCollection(e.relatedCollection.itemList),analytics:e.analytics}},e.prototype.convertSwiftItemsFromRelatedCollection=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(this.validator.isA(i,s)){var o=i,a=this.swiftDataTransformer.convertSwiftItemToViewModel(o);t.push(a)}}return t},e}();t.XrayPlayerStatisticModelTransformer=n});e(cg);cg.XrayPlayerStatisticModelTransformer;var dg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayTitledParagraphTextModelType="XrayTitledParagraphTextModelType"});e(dg);dg.XrayTitledParagraphTextModelType;var pg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.BlueprintedItem,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){if(!this.validator.isA(e,n))return null;var t=Dm.textModelFromTextMap(e.textMap);return{id:e.id,type:dg.XrayTitledParagraphTextModelType,title:t.primaryText,content:t.secondaryText,analytics:e.analytics}},e}();t.XrayTitledParagraphTextModelTransformer=r});e(pg);pg.XrayTitledParagraphTextModelTransformer;var fg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayTitledImageModelType="XrayTitledImageModelType"});e(fg);fg.XrayTitledImageModelType;var hg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.atv.discovery.BlueprintedItem,n=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){if(!this.validator.isA(e,r))return null;var t=Dm.textModelFromTextMap(e.textMap),n=Uy.imageModelFromImageMap(e.imageMap);return{id:e.id,type:fg.XrayTitledImageModelType,title:t.primaryText,content:n.primaryImage,analytics:e.analytics}},e}();t.XrayTitledImageModelTransformer=n});e(hg);hg.XrayTitledImageModelTransformer;var mg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayBrandingImageModelType="XrayBrandingImageModelType"});e(mg);mg.XrayBrandingImageModelType;var yg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.BlueprintedItem,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){if(!this.validator.isA(e,n))return null;var t=Uy.imageModelFromImageMap(e.imageMap);return{id:e.id,type:mg.XrayBrandingImageModelType,brandingImage:t.primaryImage,analytics:e.analytics}},e}();t.XrayBrandingImageModelTransformer=r});e(yg);yg.XrayBrandingImageModelTransformer;var gg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayPlayerStatisticQuickViewModelType="XrayPlayerStatisticQuickViewModelType"});e(gg);gg.XrayPlayerStatisticQuickViewModelType;var vg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.BlueprintedItem,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return this.validator.isA(e,n)?{id:e.id,type:gg.XrayPlayerStatisticQuickViewModelType,primaryImage:Uy.imageModelFromImageMap(e.imageMap).primaryImage,textMap:Dm.textModelFromTextMap(e.textMap),analytics:e.analytics}:null},e}();t.XrayPlayerStatisticQuickViewModelTransformer=r});e(vg);vg.XrayPlayerStatisticQuickViewModelTransformer;var Sg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayTitledEmphasizedTextModelType="XrayTitledEmphasizedTextModelType"});e(Sg);Sg.XrayTitledEmphasizedTextModelType;var bg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.BlueprintedItem,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return this.validator.isA(e,n)?{id:e.id,type:Sg.XrayTitledEmphasizedTextModelType,textMap:Dm.textModelFromTextMap(e.textMap),analytics:e.analytics}:null},e}();t.XrayTitledEmphasizedTextModelTransformer=r});e(bg);bg.XrayTitledEmphasizedTextModelTransformer;var Tg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r;t.LiveHintableButtonViewModelType="LiveHintableViewModel",(r=n||(n={}))[r.center=0]="center",r[r.left=1]="left",r[r.right=2]="right",r[r.top=3]="top",r[r.bottom=4]="bottom",t.HintableButtonGravity=n});e(Tg);Tg.LiveHintableButtonViewModelType,Tg.HintableButtonGravity;var Pg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.LinkActionType,r=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return{type:Tg.LiveHintableButtonViewModelType,textMap:Dm.textModelFromTextMap(e.textMap),horizontalGravity:this.getHorizontalGravity(e),verticalGravity:this.getVerticalGravity(e),id:e.id,imageMap:Uy.imageModelFromImageMap(e.imageMap),linkAction:zm.SwiftLinkActionResolver.getActionFromNavigationalAction(Km.XraySwiftUtils.navigationalActionFromLinkActionMap(e.linkActionMap,n.PRIMARY)),replayBoothButton:qy.LivePlayHistoryTransformer.convertReplayBoothButton(e,this.validator)}},e.prototype.getHorizontalGravity=function(e){var t=e.blueprint.properties;if(xt.exists(t)&&xt.exists(t.horizontal_gravity))switch(t.horizontal_gravity){case"RIGHT":return Tg.HintableButtonGravity.right;case"LEFT":return Tg.HintableButtonGravity.left}return Tg.HintableButtonGravity.center},e.prototype.getVerticalGravity=function(e){var t=e.blueprint.properties;if(xt.exists(t)&&xt.exists(t.vertical_gravity))switch(t.vertical_gravity){case"TOP":return Tg.HintableButtonGravity.top;case"CENTER":return Tg.HintableButtonGravity.center}return Tg.HintableButtonGravity.bottom},e}();t.LiveHintableButtonTransformer=r});e(Pg);Pg.LiveHintableButtonTransformer;var wg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.PopUpToggleViewModelType="PopUpToggleViewModel"});e(wg);wg.PopUpToggleViewModelType;var Cg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.convertSwiftItemToViewModel=function(e){return{type:wg.PopUpToggleViewModelType,textMap:Dm.textModelFromTextMap(e.textMap),id:e.id,filters:this.convertFilter(e)}},e.prototype.convertFilter=function(e){var t=e.blueprint.properties;return xt.exists(t)&&xt.exists(t.filters)?t.filters:""},e}();t.PopUpToggleTransformer=n});e(Cg);Cg.PopUpToggleTransformer;var Mg=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.BlueprintIds,n=function(t){function n(e){return t.call(this,n.createTransformersMap(e))||this}return i(n,t),n.createTransformersMap=function(e){var t={};return t[o.GRID]=this.createGridTransformer(),t[o.VERTICAL_LIST]=this.createVerticalListTransformer(),t[o.XRAY_DETAIL_TITLE_LINKABLE_COLLECTION]=new Ay.DelimitedTextCollectionTransformer({itemStyle:sy.StyledTextLinkItemStyle.SECONDARY_TEXT_LINKABLE,style:ly.TextCollectionStyle.CONTAINER}),t[o.LABELLED_COLLECTION]=new Ay.DelimitedTextCollectionTransformer({style:ly.TextCollectionStyle.LABELLED_COLLECTION,itemStyle:sy.StyledTextLinkItemStyle.SECONDARY_TEXT,itemDelimiter:"",labelStyle:sy.StyledTextLinkItemStyle.PRIMARY_TEXT}),t[o.PHOTO_GALLERY_COLLECTION]=this.createPhotoGalleryTransformer(e),t[o.CAROUSEL]=this.createCarouselTransformer(Cy.CollectionStyle.CAROUSEL),t[o.CAROUSEL_MINI_DETAILS]=this.createCarouselTransformer(Cy.CollectionStyle.CAROUSEL_MINI_DETAILS),t[o.XRAY_QUICKVIEW_CAROUSEL]=this.createHorizontalCarouselListTransformer(),t.XrayDismissibleContainer=this.createDismissibleContainerTransformer(),t},n.createBlueprintedItemTransformerMap=function(){var e={};return e[o.XRAY_TWO_COLUMN_TABLE_ITEM]=new Yy.TwoColumnTableItemTransformer,e[o.XRAY_TWO_COLUMN_SUBHEADER]=new $y.TwoColumnSubheaderItemTransformer,e[o.XRAY_PARAGRAPH_TEXT]=new lg.XrayParagraphTextModelTransformer,e},n.createGridTransformer=function(){var e={};return e[o.XRAY_PERSON_ITEM]=new by.GridTileDataTransformer(Gm.GridTileStyle.CAST),new ky.CollectionV2ViewModelTransformer({itemListTransformer:new Ry.ItemListTransformer(e),collectionStyle:Cy.CollectionStyle.GRID,dynamicLoad:!0})},n.createVerticalListTransformer=function(){var e=new qy.LivePlayHistoryTransformer(zy.LivePlayHistoryViewModelStyle.NORMAL),t=this.createBlueprintedItemTransformerMap(),n={};return n[o.XRAY_MUSIC_ITEM]=new Ey.MusicItemDataTransformer,n[o.XRAY_SCENE_ITEM]=new _y.SceneItemDataTransformer,n[o.XRAY_TRIVIA_ITEM]=new Iy.TriviaItemDataTransformer,n[o.XRAY_GAME_LEADERS_ITEM]=new Xy.LiveStatsTransformer(By.LiveStatsTableViewModelStyle.FIVE_COLUMN),n[o.XRAY_THREE_COLUMN_ITEM]=new Xy.LiveStatsTransformer(By.LiveStatsTableViewModelStyle.THREE_COLUMN),n[o.XRAY_PLAY_HISTORY_ITEM]=e,n[o.XRAY_ONE_COLUMN_ITEM]=new eg.LiveOneColumnTableTransformer,n[o.XRAY_FORMATTED_PLAY_HISTORY_ITEM]=new Wy.LiveFormattedPlayHistoryTransformer,n[o.XRAY_EMPTY_COLLECTION_PLACEHOLDER_ITEM]=new qy.LivePlayHistoryTransformer(zy.LivePlayHistoryViewModelStyle.PENDING),n[o.XRAY_PLAY_HISTORY_POP_UP_TOGGLE_BUTTON]=new Cg.PopUpToggleTransformer,n[o.XRAY_LIVE_HINTABLE_BUTTON]=new Pg.LiveHintableButtonTransformer,n[o.XRAY_TEAMS_HEADER_ITEM]=new Gy.XrayTwoColumnLiveItemTransformer(new Ky.BlueprintAwareBlueprintedItemTransformer(t),Hy.XrayTwoColumnLiveItemStyle.TEAM_HEADER_ITEM),n[o.XRAY_PLAYER_ITEM]=new Gy.XrayTwoColumnLiveItemTransformer(new Ky.BlueprintAwareBlueprintedItemTransformer(t),Hy.XrayTwoColumnLiveItemStyle.PLAYER_ITEM),n[o.XRAY_SCOREBOARD]=new ig.XrayScoreboardTransformer,n[o.XRAY_PLAYER_STATISTIC]=new cg.XrayPlayerStatisticModelTransformer(new Ky.BlueprintAwareBlueprintedItemTransformer(t)),n[o.XRAY_IMAGE_GRAPH_PROBABILITY_PERCENTAGE]=new ag.XrayImageGraphProbabilityPercentageModelTransformer,n[o.XRAY_TITLED_PARAGRAPH_TEXT]=new pg.XrayTitledParagraphTextModelTransformer,n[o.XRAY_TITLED_IMAGE]=new hg.XrayTitledImageModelTransformer,n[o.XRAY_BRANDING_IMAGE]=new yg.XrayBrandingImageModelTransformer,new ky.CollectionV2ViewModelTransformer({itemListTransformer:new Ry.ItemListTransformer(n),collectionStyle:Cy.CollectionStyle.LIST})},n.createPhotoGalleryTransformer=function(e){return new Ly.CollectionV2GalleryViewModelTransformer(new Ny.PhotoGallerySwiftDataTransformer(e))},n.createCarouselTransformer=function(e){return new ky.CollectionV2ViewModelTransformer({itemListTransformer:new Ry.ItemListTransformer(this.createCarouselBlueprintedItemTransformerMap()),collectionStyle:e,label:{style:sy.StyledTextLinkItemStyle.TITLE}})},n.createDismissibleContainerTransformer=function(){var e={};return e[o.XRAY_LIVE_HINTABLE_BUTTON]=new Pg.LiveHintableButtonTransformer,new ky.CollectionV2ViewModelTransformer({itemListTransformer:new Ry.ItemListTransformer(e),collectionStyle:Cy.CollectionStyle.POP_UP})},n.createCarouselBlueprintedItemTransformerMap=function(){var e={};return e[o.XRAY_IMAGE_GALLERY_ITEM]=new by.GridTileDataTransformer(Gm.GridTileStyle.IMAGE_GALLERY),e[o.XRAY_COVER_MOVIE]=new by.GridTileDataTransformer(Gm.GridTileStyle.FILMO_MOVIE),e[o.XRAY_COVER_TV_SHOW]=new by.GridTileDataTransformer(Gm.GridTileStyle.FILMO_TV),e[o.XRAY_VIDEO_GALLERY_ITEM]=new by.GridTileDataTransformer(Gm.GridTileStyle.VIDEO_GALLERY,qm.XrayPlaceholder.SCENES),e[o.XRAY_PERSON_ITEM]=new by.GridTileDataTransformer(Gm.GridTileStyle.PERSON),e[o.XRAY_MUSIC_ITEM]=new by.GridTileDataTransformer(Gm.GridTileStyle.MUSIC,qm.XrayPlaceholder.MUSIC),e[o.XRAY_SCENE_ITEM]=new _y.SceneItemDataTransformer,e[o.XRAY_TRIVIA_ITEM]=new Iy.TriviaItemDataTransformer,e.XrayFactItem=new Py.GridTextTileDataTransformer,e},n.createHorizontalCarouselListTransformer=function(){var e={};return e[o.XRAY_PLAYER_STATISTIC]=new vg.XrayPlayerStatisticQuickViewModelTransformer,e[o.XRAY_TITLES_EMPHASIZED_TEXT]=new bg.XrayTitledEmphasizedTextModelTransformer,new ky.CollectionV2ViewModelTransformer({itemListTransformer:new Ry.ItemListTransformer(e),collectionStyle:Cy.CollectionStyle.HORIZONTAL_QUICKVIEW})},n}(ry.BlueprintAwareWidgetTransformer);t.CollectionV2Transformer=n});e(Mg);Mg.CollectionV2Transformer;var Ig=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=Mf.com.amazon.avod.xray.BlueprintIds,m=Mf.com.amazon.avod.xray.ItemChangeType,l=S.of("TimestampBasedTimeIndexedCollection"),y=M.get("TimestampBasedTimeIndexedCollection"),n=function(){function h(e,t){this.type=h.TYPE,l(e,"collection").exists(),l(t,"itemTransformer").exists(),this.itemModelMap={};for(var n=0;n<e.items.length;n++){var r=e.items[n],i=t.convertSwiftItemToViewModel(r.item);null!==i&&(this.itemModelMap[r.id]=i)}this.partitions=F.sortBy(e.partitionedChangeList,function(e){return e.timeRange.startTime}),this.id=_m.ViewModelIdGenerator.generateDefaultId(this.type,e.id),this.priorResult={timestamp:-1,itemIds:[],partitionIndex:-1,changeIndex:-1,pinnedItems:[],insertedPinnedIds:{}};for(var o=0;o<this.partitions.length;o++){var a=this.partitions[o];this.insertPinnedItems(a.initialItemIds),this.insertPinnedItems(a.changesCollection.map(function(e){return e.itemId}))}if(xt.exists(e.blueprint))switch(e.blueprint.id){case s.CAROUSEL:this.style=Cy.CollectionStyle.CAROUSEL;break;case s.XRAY_DETAIL_TITLE_UNLINKABLE_COLLECTION:this.style=Cy.CollectionStyle.TITLE;break;case s.VERTICAL_LIST:case s.XRAY_QUICKVIEW_CAROUSEL:this.style=Cy.CollectionStyle.QUICKVIEW_LIST;break;case s.CAROUSEL_MINI_DETAILS:this.style=Cy.CollectionStyle.CAROUSEL_MINI_DETAILS}}return h.prototype.getItems=function(e){var t=h.findPartitionIndex(e,this.priorResult,this.partitions);if(-1===t)return[];var n,r,i=this.partitions[t];for(i.changesCollection=F.sortBy(i.changesCollection,function(e){return e.timePosition}),t===this.priorResult.partitionIndex&&e>=this.priorResult.timestamp?(n=this.priorResult.changeIndex,r=this.priorResult.itemIds):(n=0,r=[],xt.exists(i.initialItemIds)&&(r=i.initialItemIds.slice()));n<i.changesCollection.length;n++){var o=i.changesCollection[n];if(o.timePosition>e)break;if(o.changeType===m.ADD_ITEM)r.push(o.itemId);else{var a=r.indexOf(o.itemId);0<=a?r.splice(a,1):y.warn("Can't remove item that hasn't been added: "+o.itemId)}}this.priorResult={timestamp:e,itemIds:r,partitionIndex:t,changeIndex:n,pinnedItems:this.priorResult.pinnedItems,insertedPinnedIds:this.priorResult.insertedPinnedIds};for(var s=[],l={},u=0,c=0;c<r.length;c++){void 0===this.itemModelMap[r[c]]?y.warn("Collection doesn't contain item: "+r[c]):xt.exists(this.priorResult.insertedPinnedIds[r[c]])?l[r[c]]=r[c]:s[u++]=this.itemModelMap[r[c]]}for(var d=[],p=0;p<this.priorResult.pinnedItems.length;p++){var f=this.priorResult.pinnedItems[p];xt.exists(l[f.id])&&d.push(f)}return s.concat(d.reverse())},h.findPartitionIndex=function(t,e,n){if(0<=e.partitionIndex)for(var r=-1===e.partitionIndex?0:e.partitionIndex;r<n.length&&r<e.partitionIndex+2;r++)if(t<n[r].timeRange.endTime&&t>=n[r].timeRange.startTime)return r;return Mp.binarySearchIndexOf(n,function(e){return t<e.timeRange.startTime?-1:t>=e.timeRange.endTime?1:0})},h.prototype.insertPinnedItems=function(e){if(xt.exists(e))for(var t=0;t<e.length;t++){var n=e[t],r=this.itemModelMap[n];if(r){if(!xt.exists(this.priorResult.insertedPinnedIds[n])&&xt.exists(r.properties)&&"true"===r.properties.pinned){var i=r.properties.pin_index,o=parseInt(i);!xt.exists(i)||o<=0||isNaN(o)?this.priorResult.pinnedItems.unshift(r):o>=this.priorResult.pinnedItems.length?this.priorResult.pinnedItems.push(r):this.priorResult.pinnedItems.splice(o,0,r),this.priorResult.insertedPinnedIds[n]=n}}else y.warn("Item id does not exist in item model map.")}},h.TYPE="TimestampBasedTimeIndexedCollection",h}();t.TimestampBasedTimeIndexedCollection=n});e(Ig);Ig.TimestampBasedTimeIndexedCollection;var Eg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=S.of("TimestampBasedTimeIndexedCollectionTransformer"),r=function(){function e(e){this.itemTransformer=n(e,"itemTransformer").exists()}return e.prototype.transform=function(e){return new Ig.TimestampBasedTimeIndexedCollection(e,this.itemTransformer)},e}();t.TimestampBasedTimeIndexedCollectionTransformer=r});e(Eg);Eg.TimestampBasedTimeIndexedCollectionTransformer;var _g=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r;t.InSceneItemType="inSceneItem",(r=n||(n={}))[r.PortraitImage=0]="PortraitImage",r[r.SquareImage=1]="SquareImage",r[r.TextOnly=2]="TextOnly",t.InSceneItemStyle=n});e(_g);_g.InSceneItemType,_g.InSceneItemStyle;var xg=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0});var f=Mf.com.amazon.atv.discovery.BlueprintedItem,h=Mf.com.amazon.atv.discovery.ImageType,m=Mf.com.amazon.atv.discovery.LinkActionType,y=Mf.com.amazon.avod.xray.BlueprintIds,g=((n={})[y.XRAY_FACT_QUICKVIEW_ITEM]=_g.InSceneItemStyle.TextOnly,n[y.XRAY_MUSIC_QUICKVIEW_ITEM]=_g.InSceneItemStyle.SquareImage,n[y.XRAY_PERSON_QUICKVIEW_ITEM]=_g.InSceneItemStyle.PortraitImage,n[y.XRAY_PRODUCT_QUICKVIEW_ITEM]=_g.InSceneItemStyle.SquareImage,n.XrayKnownForLabel=_g.InSceneItemStyle.SquareImage,n),v=((r={})[y.XRAY_MUSIC_QUICKVIEW_ITEM]=qm.XrayPlaceholder.MUSIC,r[y.XRAY_PERSON_QUICKVIEW_ITEM]=qm.XrayPlaceholder.PERSON,r),S=M.get("QuickViewItemDataTransformer"),i=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){if(!this.validator.isA(e,f))return null;var t=e,n=t.blueprint.id,r=g[n];if(!xt.exists(r))return S.warn("Can't transform Quick View item with unknown blueprint ID",t),null;var i,o,a=Dm.textModelFromTextMap(t.textMap);if(null===a.primaryText)return S.warn("Can't transform Quick View item with no primary text",t),null;if(n===y.XRAY_FACT_QUICKVIEW_ITEM){if(null===a.secondaryText)return S.warn("Can't transform trivia Quick View item with no secondary text",t),null;i=a.secondaryText,o=a.primaryText}else i=a.primaryText,o=a.secondaryText;var s,l=Km.XraySwiftUtils.navigationalActionFromLinkActionMap(t.linkActionMap,m.PRIMARY),u=zm.SwiftLinkActionResolver.getActionFromNavigationalAction(l),c=v[n],d=t.blueprint.properties;s=xt.exists(c)?{placeholder:Km.XraySwiftUtils.placeholderFromPlaceholderMap(d,"placeholder_primary",c),imageData:Km.XraySwiftUtils.imageModelFromImageMap(t.imageMap,h.PRIMARY)}:null;var p=Km.XraySwiftUtils.createAccessibilityDescription(t.accessibilityMap,t.textMap);return{id:t.id,type:_g.InSceneItemType,style:r,action:u,primaryText:i,supplementalText:o,accessibilityDescription:p,image:s,properties:d}},e}();t.QuickViewItemDataTransformer=i});e(xg);xg.QuickViewItemDataTransformer;var kg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.TabHeaderType="tabHeaderModel"});e(kg);kg.TabHeaderType;var Rg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.convertSwiftItemToViewModel=function(e){return{type:kg.TabHeaderType,id:e.id,textMap:Dm.textModelFromTextMap(e.textMap)}},e}();t.TabHeaderTransformer=n});e(Rg);Rg.TabHeaderTransformer;var Ag=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("TimeIndexedCarouselTransformer"),r=function(){function e(){this.transformersMap=Mg.CollectionV2Transformer.createCarouselBlueprintedItemTransformerMap()}return e.prototype.convertSwiftItemToViewModel=function(e){var t=this.transformersMap[e.blueprint.id];return xt.exists(t)?t.convertSwiftItemToViewModel(e):(n.warn("Blueprint id not recognized for time indexed carousel."),null)},e}();t.TimeIndexedCarouselTransformer=r});e(Ag);Ag.TimeIndexedCarouselTransformer;var Og=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.avod.xray.BlueprintIds,o=function(e){function t(){return e.call(this,t.createTransformersMap())||this}return n(t,e),t.createTransformersMap=function(){var e,t=new Eg.TimestampBasedTimeIndexedCollectionTransformer(new xg.QuickViewItemDataTransformer),n=new Eg.TimestampBasedTimeIndexedCollectionTransformer(new Rg.TabHeaderTransformer),r=new Eg.TimestampBasedTimeIndexedCollectionTransformer(new Ag.TimeIndexedCarouselTransformer);return(e={})[i.VERTICAL_LIST]=t,e[i.XRAY_QUICKVIEW_CAROUSEL]=t,e[i.XRAY_DETAIL_TITLE_UNLINKABLE_COLLECTION]=n,e[i.CAROUSEL]=r,e[i.CAROUSEL_MINI_DETAILS]=r,e},t}(ry.BlueprintAwareWidgetTransformer);t.TimeIndexedCollectionTransformer=o});e(Og);Og.TimeIndexedCollectionTransformer;var Lg=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.XRAY_HEAD_TO_HEAD_NAV_BAR=0]="XRAY_HEAD_TO_HEAD_NAV_BAR",r[r.XRAY_TAB_BAR=1]="XRAY_TAB_BAR",t.XraySelectableNavigationsStyle=n;t.XraySelectableNavigationsType="XraySelectableNavigationsModel"});e(Lg);Lg.XraySelectableNavigationsStyle,Lg.XraySelectableNavigationsType;var Fg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=Mf.com.amazon.atv.discovery.LinkActionType,f=Mf.com.amazon.atv.discovery.BlueprintedItem,n=Mf.com.amazon.atv.discovery.TextType,h=Mf.com.amazon.avod.xray.BlueprintIds,m=M.get("XraySwiftNavigationsStore"),r=function(){function d(e){this.style=e}return d.prototype.transform=function(e,t){if(void 0===t&&(t=new Mf.Validator),!e)return null;var n=d.parseNavigationList(e,t),r=null;return n&&(r=xt.exists(n[0])?n[0].id:null),{id:_m.ViewModelIdGenerator.generateDefaultId(Lg.XraySelectableNavigationsType,e.id),type:Lg.XraySelectableNavigationsType,items:n,style:this.style,initialSelectionId:r}},d.parseNavigationList=function(e,t){var n=e.navigationList;if(!xt.exists(n))return[];for(var r=[],i=0,o=n;i<o.length;i++){var a=o[i],s=void 0;if(t.isA(a,f)){s=a;var l=Km.XraySwiftUtils.navigationalActionFromLinkActionMap(s.linkActionMap,p.PRIMARY);if(null!==l){var u=zm.SwiftLinkActionResolver.getActionFromNavigationalAction(l);if(null!==u){var c=d.getTabLabel(s.textMap,l);null!==c?r.push({type:Jm.XrayTabBarItemType,id:s.id,label:c,isSelected:s.blueprint.id===h.XRAY_NAVBAR_LINK_ITEM_SELECTED,isClickable:!0,linkAction:u}):m.warn("Could not get primary label from blueprinted item",s)}else m.warn("Navigational action on tab bar item was invalid.",s)}else m.warn("Could not get primary navigational action from navigation item",s)}else m.warn("Navigation list item was not a blueprinted item",a)}return r},d.getTabLabel=function(e,t){return xt.exists(e)&&xt.exists(e[n.PRIMARY])?e.PRIMARY:xt.withDefault(t.text,null)},d}();t.XraySelectableNavigationsTransformer=r});e(Fg);Fg.XraySelectableNavigationsTransformer;var Dg=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.avod.xray.BlueprintIds,o=function(e){function t(){return e.call(this,t.createTransformersMap(),new Fg.XraySelectableNavigationsTransformer(Lg.XraySelectableNavigationsStyle.XRAY_TAB_BAR))||this}return n(t,e),t.createTransformersMap=function(){var e;return(e={})[i.XRAY_HEAD_TO_HEAD_NAVBAR]=new Fg.XraySelectableNavigationsTransformer(Lg.XraySelectableNavigationsStyle.XRAY_HEAD_TO_HEAD_NAV_BAR),e},t}(ry.BlueprintAwareWidgetTransformer);t.NavigationsV2Transformer=o});e(Dg);Dg.NavigationsV2Transformer;var Ng=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.atv.discovery.WidgetType,r=Mf.com.amazon.avod.xray.WidgetType,i=Mf.com.amazon.atv.discovery.DataWidget,o=Mf.com.amazon.atv.discovery.WidgetGroup,s=Mf.com.amazon.avod.xray.XrayTab,l=Mf.com.amazon.atv.discovery.CollectionV2,u=Mf.com.amazon.avod.xray.TimeIndexedCollection,c=Mf.com.amazon.atv.discovery.NavigationsV2,d=S.of("TypeAwareWidgetTransformer"),p=M.get("TypeAwareWidgetTransformer"),a=function(){function a(e,t,n,r){void 0===r&&(r=new Mf.Validator),d(e,"localization").exists(),this.transformersMap=n||this.createTransformersMap(e),this.overrideTransformersMap=d(t,"overrideTransformersMap").exists(),this.validator=r}return a.prototype.transform=function(e){d(e,"widget").exists();var t=e.type,n=a.validationTypesMap[t]||null;if(null===n)return p.warn("Could not transform widget of type: "+t),null;if(!this.validator.isA(e,n))return p.warn("Widget had type "+t+" but was not a "+n),null;var r=this.overrideTransformersMap[t]||null;if(null!==r){var i=r.transform(e);if(xt.exists(i))return i}var o=this.transformersMap[t]||null;return null===o?(p.warn("No transformer registered for widget type "+t),null):o.transform(e)},a.prototype.createTransformersMap=function(e){var t;return(t={})[r.XRAY_TAB]=new hy.WidgetGroupCollectionModelTransformer(fy.WidgetGroupStyle.XRAY_TAB,this),t[n.WIDGET_GROUP]=new Sy.WidgetGroupTransformer(this),t[n.DATA_WIDGET]=new py.DataWidgetTransformer(e),t[n.COLLECTION]=new Mg.CollectionV2Transformer(e),t[r.TIME_INDEXED_COLLECTION]=new Og.TimeIndexedCollectionTransformer,t[n.NAVIGATIONS]=new Dg.NavigationsV2Transformer,t},a.createValidationTypesMap=function(){var e;return(e={})[n.DATA_WIDGET]=i,e[n.WIDGET_GROUP]=o,e[r.XRAY_TAB]=s,e[n.COLLECTION]=l,e[r.TIME_INDEXED_COLLECTION]=u,e[n.NAVIGATIONS]=c,e},a.validationTypesMap=a.createValidationTypesMap(),a}();t.TypeAwareWidgetTransformer=a});e(Ng);Ng.TypeAwareWidgetTransformer;var Ug=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"ReceiveLocalizationAction"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.ReceiveLocalizationAction=n});e(Ug);Ug.ReceiveLocalizationAction;var Bg=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.valueFunction=function(e,t,n){return null===t||null===n?null:new Ng.TypeAwareWidgetTransformer(t,n.transformers)},t.getInstance=function(){return this.instance},t.instance=new Lf.ComputedValueStore("SwiftWidgetTransformerStore",[Ug.ReceiveLocalizationAction.store,pm.XrayInitializationContextAction.store],t.valueFunction),t}(Lf.ComputedValueStore);t.SwiftWidgetTransformerStore=i});e(Bg);Bg.SwiftWidgetTransformerStore;var Vg=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"ReceiveXraySwiftTabDataAction"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.ReceiveXraySwiftTabDataAction=n});e(Vg);Vg.ReceiveXraySwiftTabDataAction;var jg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Mf.com.amazon.avod.xray.XrayNavigationParameterType,o=S.of("MediaEventReportingUtils"),r=function(){function e(){}return e.navTypeAndValueFromSelectionDataMap=function(e){o(e,"selectionDataMap").exists();for(var t=0,n=this.selectionMediaEventParamMapping;t<n.length;t++){var r=n[t],i=e[r.serviceParam];if(xt.exists(i))return{navType:r.mediaEventParam,navValue:i}}return{navType:null,navValue:null}},e.selectionMediaEventParamMapping=[{serviceParam:n.ITEM_ID,mediaEventParam:"ItemID"},{serviceParam:n.ASIN,mediaEventParam:"ASIN"},{serviceParam:n.GTI,mediaEventParam:"GTI"},{serviceParam:n.TITLE_ID,mediaEventParam:"TitleID"},{serviceParam:n.URL,mediaEventParam:"URL"},{serviceParam:n.WIDGET_ID,mediaEventParam:"WidgetID"},{serviceParam:n.TIMECODE,mediaEventParam:"Timecode"}],e}();t.MediaEventReportingUtils=r});e(jg);jg.MediaEventReportingUtils;var Xg=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=S.of("XraySwiftFullViewDataStores"),l=M.get("XraySwiftFullViewDataStores"),n=function(n){function e(){var t=null!==n&&n.apply(this,arguments)||this;return t.reportEvent=function(){var e=t.getValue();null!==e&&(null!==pm.XrayInitializationContextAction.store.getValue()&&(Tm.InteractionEventReporter.sendInteractionEventWithRefMarker(e.navType,e.navValue,e.linkType,null,e.refMarker,e.scrollAmount),om.XrayInsightClient.getInstance().sendInteractionEvent(e.refMarker,Pm.XrayInsightInteractionType.NAVIGATION)))},t}return i(e,n),e.prototype.initialize=function(e){n.prototype.initialize.call(this,e),this.onChange(this.reportEvent)},e.prototype.destroy=function(){n.prototype.destroy.call(this),this.offChange(this.reportEvent)},e}(Lf.ComputedValueStore),a=function(){function p(){}return Object.defineProperty(p,"allStores",{get:function(){return[p.fullViewDataSourcesStore,p.fullViewTabSelectionStore,p.fullViewMediaEventXrayNavigationStore]},enumerable:!0,configurable:!0}),p.cloneDataSourcesAndUpdateTransformer=function(e,t){for(var n=new im.KeyedMap(function(e){return null===e?null:e.toString()}),r=0,i=e.keys();r<i.length;r++){var o=i[r],a=e.get(o);a.updateTransformer(t),n.put(o,a)}return n},p.fullViewDataSourcesStore=new Lf.ComputedValueStore("XraySwiftFullViewDataSourcesStore",[Sm.XraySwiftSelectAction.store,Vg.ReceiveXraySwiftTabDataAction.store,Bg.SwiftWidgetTransformerStore.getInstance()],function(e,t,n,r){if(null===r)return e;var i=p.cloneDataSourcesAndUpdateTransformer(e.dataSourceMap,r);if(null===t)return{dataSourceMap:i,currentCardKey:null,state:ey.XrayFullViewState.Hidden};var o=t.xrayCardKey,a=t.selectionDataMap,s=i.get(o),l=null!==s,u=null!==n&&o.equals(n.xrayCardKey),c=u&&null!==n.xrayTab;if(l&&s.updateSelectionDataMap(a),c)if(l)s.updateXrayTab(n.xrayTab);else{var d=new Zm.XraySwiftTabViewModelDataSource(n.xrayTab,o,r,a);i.put(o,d)}return{dataSourceMap:i,currentCardKey:o,state:c||l&&!u?ey.XrayFullViewState.Loaded:u?ey.XrayFullViewState.Error:ey.XrayFullViewState.Loading}},{dataSourceMap:new im.KeyedMap(function(e){return null===e?null:e.toString()}),currentCardKey:null,state:ey.XrayFullViewState.Hidden}),p.fullViewTabSelectionStore=new Lf.ComputedValueStore("XrayFullViewTabSelectionStoreInstance",[p.fullViewDataSourcesStore],function(e,t){var n=t.dataSourceMap.get(t.currentCardKey),r=null===n?null:n.getViewModel();return t.state===ey.XrayFullViewState.Loaded&&o(r,"Data source set must have valid view model for selection if state is loaded").is.not.null(),{state:t.state,tabViewModel:r}}),p.fullViewMediaEventXrayNavigationStore=new n("XrayFullViewXrayNavigationStore",[p.fullViewTabSelectionStore,Sm.XraySwiftSelectAction.store],function(e,t,n){if(t.state!==ey.XrayFullViewState.Loaded)return null;var r=n.analytics||null,i=null===r?{}:r.local||{};F.isEmpty(i)&&l.warn("Creating clickstream event without any selection analytics");var o=s({},t.tabViewModel.analytics.local,i).refMarker;if(null===o)return null;var a=jg.MediaEventReportingUtils.navTypeAndValueFromSelectionDataMap(n.selectionDataMap);return{_type:"X-Ray",linkType:"X-Ray",refMarker:o,refMarkerIndex:null,navType:a.navType,navValue:a.navValue,scrollAmount:null}}),p}();t.XraySwiftFullViewDataStores=a});e(Xg);Xg.XraySwiftFullViewDataStores;var zg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=Mf.com.amazon.avod.xray.BlueprintIds,d=M.get("XraySwiftTabBarStores"),p="XrayTabBar",n={tabBarItemsModel:{id:t.TAB_BAR_ID=p,type:fy.WidgetGroupType,items:[]},shouldShow:!0},r={xrayTabBarModel:t.DEFAULT_TAB_BAR_MODEL=n,isOnTopLevelTab:!1},i=function(){function e(){}return Object.defineProperty(e,"swiftTabBarStore",{get:function(){return e.swiftTabBarStoreInstance},enumerable:!0,configurable:!0}),Object.defineProperty(e,"swiftTopLevelTabStore",{get:function(){return e.swiftTabBarTopLevelTabStoreInstance},enumerable:!0,configurable:!0}),Object.defineProperty(e,"allStores",{get:function(){return[e.swiftTabBarCompositeStoreInstance,e.swiftTabBarStoreInstance,e.swiftTabBarTopLevelTabStoreInstance]},enumerable:!0,configurable:!0}),e.swiftTabBarCompositeStoreInstance=new Lf.ComputedValueStore("XraySwiftTabBarIntermediateStore",[Qm.XraySwiftNavigationsStore.getInstance(),Xg.XraySwiftFullViewDataStores.fullViewTabSelectionStore],function(e,t,n){var r,i=n.tabViewModel,o=n.state===ey.XrayFullViewState.Loaded,a=!1,s=!1,l=F.map(t.items,function(e){var t=o&&e.tabType===i.tabType,n=!t||!e.xrayCardKey.equals(i.xrayCardKey);return a=a||t,s=s||t&&!n,{type:Jm.XrayTabBarItemType,label:e.label,linkAction:e.linkAction,isSelected:t,isClickable:!t||!e.xrayCardKey.equals(i.xrayCardKey),id:_m.ViewModelIdGenerator.generateDefaultId(Jm.XrayTabBarItemType)}});switch(t.blueprintId){case c.XRAY_TILE_NAVIGATION:r=fy.WidgetGroupStyle.XRAY_MATERIAL_TAB_BAR;break;default:r=fy.WidgetGroupStyle.XRAY_TAB_BAR}var u={id:p,type:fy.WidgetGroupType,items:l,style:r};return!a&&o&&d.warn("No tab bar item for selected tab type: ",i.tabType),{xrayTabBarModel:{tabBarItemsModel:u,shouldShow:o?i.shouldShowNavbar:e.xrayTabBarModel.shouldShow},isOnTopLevelTab:s}},r),e.swiftTabBarStoreInstance=new Lf.ComputedValueStore("XraySwiftTabBarStore",[e.swiftTabBarCompositeStoreInstance],function(e,t){return t.xrayTabBarModel},r.xrayTabBarModel),e.swiftTabBarTopLevelTabStoreInstance=new Lf.ComputedValueStore("XraySwiftTabBarTopLevelTabStore",[e.swiftTabBarCompositeStoreInstance],function(e,t){return t.isOnTopLevelTab},r.isOnTopLevelTab),e}();t.XraySwiftTabBarStores=i});e(zg);zg.TAB_BAR_ID,zg.DEFAULT_TAB_BAR_MODEL,zg.XraySwiftTabBarStores;var qg=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){void 0===e&&(e=zg.XraySwiftTabBarStores.swiftTopLevelTabStore);var a=t.call(this)||this;return a.actionBackstack=[],a.onAction=function(e){var t=!1;if(a.dispatcher.waitFor(a.swiftTopLevelTabStore),e.getType()===Sm.XraySwiftSelectAction.getName()){var n=e;if(!a.isNewSelection(n))return;n.isClearingSelection()?a.actionBackstack=[]:a.actionBackstack.push(n),t=!0}var r=a.swiftTopLevelTabStore.getValue(),i=a.actionBackstack.length;if(r&&0<i&&(a.actionBackstack=[a.actionBackstack[i-1]],t=!0),t&&a.emitChange(),e.getType()===Ym.SelectPreviousAction.getName()){var o=a.getPreviousAction();if(!xt.exists(o))return;switch(o.getType()){case Sm.XraySwiftSelectAction.getName():a.dispatcher.dispatch(o)}}},a.swiftTopLevelTabStore=e,a}return n(e,t),e.getInstance=function(){return this.instance},e.prototype.getDispatchRecipientId=function(){return"Xray.ActionBackStackStore"},e.prototype.getActionHandler=function(){return this.onAction},e.prototype.getValue=function(){return this.actionBackstack},e.prototype.getPreviousAction=function(){return this.actionBackstack.length<2?null:(this.actionBackstack.pop(),this.actionBackstack.pop())},e.prototype.isNewSelection=function(e){var t=this.actionBackstack.length;if(t<1)return!0;var n=this.actionBackstack[t-1];return!e.isEqual(n)},e.instance=new e,e}(Lf.ValueStore);t.ActionBackstackStore=i});e(qg);qg.ActionBackstackStore;var Wg=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.UpdateQuickViewItemsAction"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.UpdateQuickViewItemsAction=n});e(Wg);Wg.UpdateQuickViewItemsAction;var Hg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"allStores",{get:function(){return[this.pageTypeIdStore,this.adBreakIsPlayingStore,this.hasDataStore,this.quickViewListItemsAtTimeStore,this.quickViewShouldShowArrowStore]},enumerable:!0,configurable:!0}),e.adBreakIsPlayingStore=new Lf.ComputedValueStore("Xray.QuickView.AdBreakIsPlaying",[vm.AdBreakResponseAction.store],function(e,t){return!t}),e.pageTypeIdStore=new Lf.ComputedValueStore("Xray.QuickView.PageInfo",[Mm.ReceiveInitialSwiftPageAction.store],function(e,t){return null===t?null:t.pageContext.getPageId()}),e.hasDataStore=new Lf.ComputedValueStore("Xray.QuickView.HasData",[Fm.XraySwiftQuickViewWidgetGroupStore.getInstance()],function(e,t){return null!==t&&0<t.widgets.widgetList.length}),e.quickViewListItemsAtTimeStore=new Lf.ComputedValueStore("Xray.QuickView.QuickViewListItemsAtTime",[Wg.UpdateQuickViewItemsAction.store],function(e,t){return null===t?[]:t}),e.quickViewShouldShowArrowStore=new Lf.ComputedValueStore("Xray.QuickView.ShouldShowArrow",[e.quickViewListItemsAtTimeStore],function(e,t){return null!==t&&0<t.length}),e}();t.QuickViewStores=n});e(Hg);Hg.QuickViewStores;var Gg=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.valueFunction=function(e,t,n){return null===t||null===n?null:t.transform(n)},t.getInstance=function(){return this.instance},t.instance=new Lf.ComputedValueStore("SwiftQuickViewModelStore",[Bg.SwiftWidgetTransformerStore.getInstance(),Fm.XraySwiftQuickViewWidgetGroupStore.getInstance()],t.valueFunction),t}(Lf.ComputedValueStore);t.SwiftQuickViewModelStore=i});e(Gg);Gg.SwiftQuickViewModelStore;var Kg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.atv.discovery.SectionV2,a=Mf.com.amazon.avod.xray.XrayTab,i=Mf.com.amazon.atv.discovery.SectionType,s=M.get("XraySwiftFullViewParser"),n=function(){function e(e){void 0===e&&(e=new Mf.Validator),this.validator=e}return e.prototype.parseFullViewPage=function(e){if(!xt.exists(e)||!xt.exists(e.sections))return s.warn("Page is null or page has no sections"),null;var t=e.sections[i.CENTER];if(!this.validator.isA(t,r))return s.warn("Center section is missing or is not a SectionV2"),null;var n=t;return this.parseWidgetList(n.widgets.widgetList)},e.prototype.parseFullViewWidgets=function(e){return this.parseWidgetList(e)},e.prototype.parseWidgetList=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];if(this.validator.isA(i,a)){var o=i;xt.exists(o.id)?t[o.id]=o:s.warn("XrayTab must have a tab id")}else s.warn("Widget in center section widget list was not an XrayTab",i)}return t},e}();t.XraySwiftFullViewParser=n});e(Kg);Kg.XraySwiftFullViewParser;var Qg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.atv.discovery.PageV2,o=S.of("XrayTabCache"),n=function(){function e(e,t,n){void 0===t&&(t=new Kg.XraySwiftFullViewParser),void 0===n&&(n=new im.KeyedMap(function(e){return e.toString()})),this.xrayClient=o(e,"xrayClient").exists(),this.swiftFullViewParser=t,this.pagesModelsCache=n}return e.prototype.putSwiftData=function(e){o(e,"xraySwiftPageModel").exists(),this.parseAndSavePage(e.page,e.pageContext)},e.prototype.getIfPresent=function(e){return o(e,"xrayCardKey").exists(),this.pagesModelsCache.get(e)||null},e.prototype.get=function(t){var n=this;o(t,"xrayCardKey").exists();var r=t.getPageContext();return r.getApiEndpoint()===um.XrayApiEndpoint.GetWidgets?this.xrayClient.loadWidgets(r).then(function(e){return n.parseAndSaveWidgets(e,r),n.getIfPresent(t)}):this.xrayClient.loadPage(r,i).then(function(e){return n.parseAndSavePage(e,r),n.getIfPresent(t)})},e.prototype.clearCache=function(){this.pagesModelsCache.clear()},e.prototype.parseAndSavePage=function(e,t){var n=this.swiftFullViewParser.parseFullViewPage(e);this.saveTabs(n,t)},e.prototype.parseAndSaveWidgets=function(e,t){var n=this.swiftFullViewParser.parseFullViewWidgets(e);this.saveTabs(n,t)},e.prototype.saveTabs=function(e,t){if(xt.exists(e))for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];this.pagesModelsCache.put(new dm.XrayCardKey(t,i),e[i])}},e}();t.XrayTabCache=n});e(Qg);Qg.XrayTabCache;var Yg=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i){void 0===t&&(t=new Qg.XrayTabCache(e)),void 0===n&&(n=Mm.ReceiveInitialSwiftPageAction.store),void 0===r&&(r=Sm.XraySwiftSelectAction.store),void 0===i&&(i=hm.XrayDispatcher.getInstance());var o=this;this.onReceiveSwiftPage=function(){var e=o.receiveSwiftPageStore.getValue();null!==e&&(o.xrayTabCache.putSwiftData(e),o.onSelectionUpdate())},this.onSelectionUpdate=function(){var e=o.xraySelectionStore.getValue(),t=null===e?null:e.xrayCardKey||null;null!==t&&o.loadForSelection(t)},this.xrayTabCache=t,this.receiveSwiftPageStore=n,this.xraySelectionStore=r,this.dispatcher=i}return e.prototype.initialize=function(){this.receiveSwiftPageStore.onChange(this.onReceiveSwiftPage),this.xraySelectionStore.onChange(this.onSelectionUpdate)},e.prototype.destroy=function(){this.receiveSwiftPageStore.offChange(this.onReceiveSwiftPage),this.xraySelectionStore.offChange(this.onSelectionUpdate),this.xrayTabCache.clearCache()},e.prototype.loadForSelection=function(t){var n=this;this.xrayTabCache.get(t).then(function(e){n.dispatcher.dispatch(new Vg.ReceiveXraySwiftTabDataAction({xrayTab:e,xrayCardKey:t}))}).catch(function(){n.dispatcher.dispatch(new Vg.ReceiveXraySwiftTabDataAction({xrayTab:null,xrayCardKey:t}))})},e}();t.SwiftXraySelectionLoader=n});e(Yg);Yg.SwiftXraySelectionLoader;var Jg=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).BUTTON="BUTTON",r.ROTATION="ROTATION",r.EXCEPTION="EXCEPTION",t.XrayInsightSessionTransitionReason=n});e(Jg);Jg.XrayInsightSessionTransitionReason;var $g=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=S.of("XraySwiftFullViewStore"),i=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return n(s,e),s.valueFunction=function(e,t,n,r,i){if(null===t||null===n)return e;var o=l(t.playerStateManager,"playerStateManager").exists();s.handleFocusChange(e.fullViewState,r.state,o);var a=n.localizedStrings||null;return{tabViewModel:r.tabViewModel,fullViewState:r.state,tabBarModel:i,errorMessage:a?a.swiftErrorMessage:null,backButtonText:a?a.backText:null}},s.handleFocusChange=function(e,t,n){t!==ey.XrayFullViewState.Hidden&&e===ey.XrayFullViewState.Hidden?n.requestFocus():t===ey.XrayFullViewState.Hidden&&e!==ey.XrayFullViewState.Hidden&&n.releaseFocus()},s.getInstance=function(){return s.instance},s.instance=new Lf.ComputedValueStore("XraySwiftFullViewStore",[tm.XrayPlaybackContextAction.store,Ug.ReceiveLocalizationAction.store,Xg.XraySwiftFullViewDataStores.fullViewTabSelectionStore,zg.XraySwiftTabBarStores.swiftTabBarStore],s.valueFunction,{tabViewModel:null,fullViewState:ey.XrayFullViewState.Hidden,tabBarModel:zg.DEFAULT_TAB_BAR_MODEL}),s}(Lf.ComputedValueStore);t.XraySwiftFullViewStore=i;var o=new Lf.ComputedValueStore("Xray.IsFullViewOpenStore",[i.getInstance()],function(e,t){var n=t.fullViewState!==ey.XrayFullViewState.Hidden;return n?om.XrayInsightClient.getInstance().sendSessionStartEvent(Jg.XrayInsightSessionTransitionReason.BUTTON):om.XrayInsightClient.getInstance().sendSessionEndEvent(Jg.XrayInsightSessionTransitionReason.BUTTON),n},!1);t.IsFullViewOpenStore=o});e($g);$g.XraySwiftFullViewStore,$g.IsFullViewOpenStore;var Zg=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ShowXrayModal"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.ShowXrayModalAction=n});e(Zg);Zg.ShowXrayModalAction;var ev=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e,"allStores",{get:function(){return[this.isShowingStore]},enumerable:!0,configurable:!0}),e.isShowingStore=new Lf.ComputedValueStore("Xray.XrayModalIsShowing",[Zg.ShowXrayModalAction.store],function(e,t){return null!==t&&null!==t.body},!1),e}();t.XrayModalStores=n});e(ev);ev.XrayModalStores;var tv=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.onViewModelUpdated=function(e){t.setState({currentViewModel:e})},t.viewModelRegistry=xm.ViewModelRegistry.getInstance(),t.state={currentViewModel:t.props.viewModelProps.viewModel},t}return i(e,n),e.prototype.componentDidMount=function(){this.viewModelRegistry.setOnViewModelUpdatedListener(this.props.viewModelProps.viewModel.id,this.onViewModelUpdated),this.viewModelRegistry.registerViewModel(this.props.viewModelProps.viewModel)},e.prototype.render=function(){if(null===this.state.currentViewModel)return null;var e=o({},this.props.viewModelProps,{viewModel:this.state.currentViewModel});return Vn.createElement(this.props.viewClass,o({},e,this.props.extraProps))},e.prototype.shouldComponentUpdate=function(e,t){return!F.isEqual(this.props,e)||!F.isEqual(this.state,t)},e.prototype.componentDidUpdate=function(e){F.isEqual(this.props.viewModelProps.viewModel.id,e.viewModelProps.viewModel.id)||(this.viewModelRegistry.removeOnViewModelUpdatedListener(e.viewModelProps.viewModel.id),this.viewModelRegistry.setOnViewModelUpdatedListener(this.props.viewModelProps.viewModel.id,this.onViewModelUpdated)),F.isEqual(this.props.viewModelProps.viewModel,e.viewModelProps.viewModel)||(this.viewModelRegistry.registerViewModel(this.props.viewModelProps.viewModel),this.setState({currentViewModel:this.props.viewModelProps.viewModel}))},e}(Vn.Component);t.XrayDynamicContainer=n});e(tv);tv.XrayDynamicContainer;var nv=t(function(e,t){var l=V&&V.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("XrayViewModelRenderer"),c=S.of("XrayViewModelRenderer"),n=function(){function s(){}return s.setViewClassMap=function(e){this.viewClassMap=e},s.setDynamicEnabled=function(e){this.dynamicEnabled=e},s.prototype.renderViewModel=function(e,t,n,r,i){void 0===r&&(r={}),void 0===i&&(i={}),c(e,"viewModel").exists(),c(t,"loadListener").exists(),c(n,"isShowing").exists();var o=s.viewClassMap[e.type]||null;if(null===o)return u.warn("No view type registered in map for view model type: ",e.type),null;var a={viewModel:e,loadListener:t,selectionDataMap:r,viewModelRenderer:this,isShowing:n};return s.dynamicEnabled?Vn.createElement(tv.XrayDynamicContainer,{viewClass:o,extraProps:i,viewModelProps:a,key:e.id}):Vn.createElement(o,l({},a,i))},s.viewClassMap={},s.dynamicEnabled=!1,s}();t.XrayViewModelRenderer=n});e(nv);nv.XrayViewModelRenderer;var rv=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onAction=function(e){e.getType()===$m.RefreshDynamicActionsHistoryAction.getName()&&t.emitChange()},t}return n(t,e),t.getInstance=function(){return this.instance},t.prototype.getActionHandler=function(){return this.onAction},t.prototype.getDispatchRecipientId=function(){return"Xray.RefreshDynamicActionsHistoryAction"},t.instance=new t,t}(Lf.Store);t.RefreshDynamicActionsHistoryActionStore=i});e(rv);rv.RefreshDynamicActionsHistoryActionStore;var iv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});S.of("ScalingPlayerStateManager");var n=function(){function e(e){this.playerScalingController=e}return e.prototype.requestFocus=function(){this.playerScalingController.setPlayerScaling(!0)},e.prototype.releaseFocus=function(){this.playerScalingController.setPlayerScaling(!1)},e}();t.ScalingPlayerStateManager=n});e(iv);iv.ScalingPlayerStateManager;var ov=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.OVERLAY_PLAYBACK=0]="OVERLAY_PLAYBACK",r[r.SIDE_BY_SIDE_PLAYBACK=1]="SIDE_BY_SIDE_PLAYBACK",t.FullViewDisplayMode=n});e(ov);ov.FullViewDisplayMode;var av=t(function(e,t){var s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});M.get("XrayDocumentLoaderWithRetries");var n=function(){function e(e,t,n,r){void 0===n&&(n=Qp.RetriableHttpRequest),void 0===r&&(r=Fe.CancelToken),this.createRetry=function(){return(new Op.ExponentialBackoffRetry).withMaxAttempts(4).withInitialIntervalMs(500).withExponentialFactor(2).withRandomizationFactor(200)},this.serviceResponseParser=e,this.metricsFeature=t,this.currentCancelTokenAndFunction=null,this.cancelTokenType=r,this.retriableHttpRequestType=n}return e.prototype.load=function(e){this.nonRetriableErrors=xt.exists(e.nonRetriableErrors)?e.nonRetriableErrors:null,this.nonReportableErrors=xt.exists(e.nonReportableErrors)?e.nonReportableErrors:null;var t=this.createUrlList(e);return 0<t.length?this.repeatLoad(0,t,e.resourceType,e.xrayPlaybackSessionId):Promise.reject(new Error("No URLs given"))},e.prototype.cancel=function(){null!==this.currentCancelTokenAndFunction&&(this.currentCancelTokenAndFunction.cancel(),this.currentCancelTokenAndFunction=null)},e.prototype.repeatLoad=function(t,n,r,i){var o=this;return t>=n.length?Promise.reject(new Error("All provided URLs have failed loading")):this.attemptLoad(n[t++],r,i).then(function(e){return Promise.resolve(e)}).catch(function(e){return o.repeatLoad(t++,n,r,i)})},e.prototype.attemptLoad=function(e,r,i){var o=this;return new Promise(function(t,n){o.currentCancelTokenAndFunction=o.cancelTokenType.source(),o.retriableRequest=o.createRetriableRequest(e),o.retriableRequest.send(o.currentCancelTokenAndFunction.token).then(function(e){return xt.exists(o.metricsFeature)&&uh.AcquisitionEventFactory.reportAcquisitionEventsForInFlightRequest("X-Ray",e,o.metricsFeature),e.once("success",function(e){om.XrayInsightClient.getInstance().sendResourceLoadEvent(e.url,r,!1,e.totalBytes,e.latencyMs,e.downloadTimeMs)}),e.once("fail",function(e){xt.exists(o.nonReportableErrors)&&xt.exists(e.status)&&-1!==o.nonReportableErrors.indexOf(e.status)||om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RESOURCELOAD,e.error.message,e.url,e.status,i)}),e.response()}).then(function(e){o.serviceResponseParser.parse(e.getText(),function(e){t(e)},function(e){n(e)})}).catch(function(e){n(e)})})},e.prototype.createUrlList=function(e){if(xt.exists(e.overrideUrl))return[e.overrideUrl];if(xt.exists(e.documentUrlMap)){var t=[],n=s({},e.documentUrlMap);if(xt.exists(e.cdnPreferenceList))for(var r=0;r<e.cdnPreferenceList.length;r++){var i=n[e.cdnPreferenceList[r]];if(xt.exists(i)&&(t.push(i),delete n[e.cdnPreferenceList[r]],!e.shouldTryMultipleUrls))return t}var o=Object.keys(n);for(r=0;r<o.length;r++){var a=n[r];xt.exists(a)&&t.push(a)}if(0<t.length)return t}return xt.exists(e.fallbackUrls)?e.shouldTryMultipleUrls?e.fallbackUrls:[e.fallbackUrls[0]]:[]},e.prototype.createRetriableRequest=function(t){return new this.retriableHttpRequestType(this.createRetry,function(e){return new mp.HttpRequest("GET",t)},function(e,t){return t(e)},this.nonRetriableErrors)},e}();t.XrayDocumentLoaderWithRetries=n});e(av);av.XrayDocumentLoaderWithRetries;var sv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=Mf.com.amazon.avod.xray.XRayActionsCollection,f=(M.get("XrayActionsPoller"),[403]),n=function(){function e(e,t,n,r,i,o,a,s,l,u,c){void 0===l&&(l=A.timer),void 0===u&&(u=new Bf.XrayServiceResponseParser(p)),void 0===c&&(c=new av.XrayDocumentLoaderWithRetries(u,t));var d=this;this.runQuery=function(){var e={resourceType:am.XrayInsightResourceType.DYNAMIC_SWIFT,shouldTryMultipleUrls:!1,cdnPreferenceList:d.cdnPreferenceList,documentUrlMap:d.currentDocumentUrlMap,fallbackUrls:[d.getBackupUrl()],nonRetriableErrors:f,overrideUrl:Rm.XrayLiveDebugConfig.getPollerUrlOverride(),nonReportableErrors:f};d.xrayDocumentLoaderWithRetries.load(e).then(function(e){d.actionExecutor.queueAllActions(e.actionsList),d.currentPollingIntervalMs=xt.withDefault(e.pollingIntervalMillis,d.currentPollingIntervalMs),d.currentDocumentUrlMap=e.nextDocumentUrlMap,d.currentPollPath=e.nextPath,d.currentPollUrl=e.nextUrl,(xt.exists(e.nextDocumentUrlMap)||xt.exists(e.nextPath)||xt.exists(e.nextUrl))&&d.tryNextRequest()}).catch(function(e){d.tryNextRequest()})},this.actionExecutor=e,this.PrimaryPollUrl=n,this.PrimaryPollDomain=r,this.PrimaryPollPath=i,this.PrimaryPollingIntervalMs=o,this.cdnPreferenceList=a,this.currentDocumentUrlMap=s,this.timer=l,this.xrayDocumentLoaderWithRetries=c,this.isRunning=!1,this.queuedRequestId=null}return e.prototype.getIsRunning=function(){return this.isRunning},e.prototype.start=function(){this.currentPollingIntervalMs=this.PrimaryPollingIntervalMs,this.isRunning=!0,this.runQuery()},e.prototype.stop=function(){this.isRunning=!1,this.xrayDocumentLoaderWithRetries.cancel(),null!==this.queuedRequestId&&(this.timer.clearTimeout(this.queuedRequestId),this.queuedRequestId=null)},e.prototype.getBackupUrl=function(){return xt.exists(this.PrimaryPollDomain)&&xt.exists(this.currentPollPath)?this.PrimaryPollDomain+this.currentPollPath:xt.exists(this.currentPollUrl)?this.currentPollUrl:xt.exists(this.PrimaryPollDomain)&&xt.exists(this.PrimaryPollPath)?this.PrimaryPollDomain+this.PrimaryPollPath:this.PrimaryPollUrl},e.prototype.tryNextRequest=function(){var e=this;this.isRunning&&(this.queuedRequestId=this.timer.setTimeout(function(){e.queuedRequestId=null,e.runQuery()},this.currentPollingIntervalMs))},e}();t.XrayActionsPoller=n});e(sv);sv.XrayActionsPoller;var lv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.itemList=[],this.comparator=e}return e.prototype.peek=function(){return 0===this.size()?null:this.itemList[this.size()-1]},e.prototype.push=function(e){if(0!==this.size()){var t=this.findInsertIndex(e);0<this.comparator(e,this.itemList[t])&&(t+=1),this.itemList.splice(t,0,e)}else this.itemList.push(e)},e.prototype.remove=function(e){var t=this.itemList.indexOf(e);return-1!==t&&(t===this.itemList.length-1?this.itemList.pop():this.itemList.splice(t,1),!0)},e.prototype.pop=function(){return 0===this.itemList.length?null:this.itemList.pop()},e.prototype.size=function(){return this.itemList.length},e.prototype.findInsertIndex=function(t){for(var n=this,e=Mp.binarySearchIndexOfClosestBelow(this.itemList,function(e){return n.comparator(t,e)});0<e&&0===this.comparator(t,this.itemList[e-1]);)e-=1;return e},e}();t.PriorityQueue=n});e(lv);lv.PriorityQueue;var uv=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return n(e,r),e.prototype.put=function(e,t){var n=r.prototype.get.call(this,e);xt.exists(n)?(n.push.apply(n,t),r.prototype.put.call(this,e,n)):r.prototype.put.call(this,e,t)},e}(im.KeyedMap);t.MultiMap=i});e(uv);uv.MultiMap;var cv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.avod.xray.XRayAddAction,s=Mf.com.amazon.avod.xray.XRayActionType,l=M.get("ActionExecutor"),n=function(){function e(e,t,n,r){void 0===r&&(r=new Mf.Validator);var i=this;this.onViewModelRegistered=function(e){var t=e.id,n=i.deadActionsMap.get(t);n&&(i.executeImmediately(n,t),i.deadActionsMap.remove(e.id))},this.viewModelUpdater=t,this.viewModelRegistry=e,this.metricsReportingFeature=n,this.validator=r,this.actionQueue=new lv.PriorityQueue(function(e,t){return t.sourceTime-e.sourceTime}),this.actionHistoryQueue=new lv.PriorityQueue(function(e,t){return t.sourceTime-e.sourceTime}),this.dynamicViewModelsToClear=[],this.dynamicChildViewModelsToClear=[],this.deadActionsMap=new uv.MultiMap(function(e){return e}),this.isEnabled=!1,this.currentPlayerTimeMs=0,this.refreshDynamicActionsHistoryActionStore=rv.RefreshDynamicActionsHistoryActionStore.getInstance()}return e.prototype.start=function(){var e=this;this.viewModelRegistry.addOnViewModelRegisteredListener(this.onViewModelRegistered),this.refreshDynamicActionsHistoryActionStore.onChange(function(){return e.reloadActions()}),this.isEnabled=!0},e.prototype.stop=function(){this.viewModelRegistry.removeOnViewModelRegisteredListener(this.onViewModelRegistered),this.refreshDynamicActionsHistoryActionStore.offChange(this.reloadActions),this.clear(),this.isEnabled=!1},e.prototype.queueAllActions=function(e){if(this.isEnabled)for(var t=0,n=e;t<n.length;t++){var r=n[t];this.actionQueue.push(r),this.actionHistoryQueue.push(r)}},e.prototype.getIsEnabled=function(){return this.isEnabled},e.prototype.onTimeUpdate=function(e){this.isEnabled&&(e-=Rm.XrayLiveDebugConfig.getCurrentLiveOffset(),this.currentPlayerTimeMs=e,this.mapAndExecuteActions(this.actionQueue))},e.prototype.executeAll=function(e,t){if(this.shouldRegisterForDynamicClearing(e)&&this.dynamicViewModelsToClear.push(t),null===this.viewModelRegistry.getById(t))for(var n=0,r=e;n<r.length;n++){var i=r[n];this.deadActionsMap.put(t,[i])}else this.executeImmediately(e,t)},e.prototype.executeImmediately=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];switch(i.type){case s.ADD:this.performAdd(i,t);break;case s.REMOVE:this.performRemove(i,t);break;case s.UPDATE:this.performUpdate(i,t);break;default:var o="Action type provided is invalid: "+i.type;om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RUNTIME,o),l.error(o)}}},e.prototype.shouldRegisterForDynamicClearing=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(this.validator.isA(r,i))return!0}return!1},e.prototype.performAdd=function(e,t){var n=this,r=this.getViewModelAndClone(t);if(null!==r){if(this.viewModelRegistry.getById(e.targetId))return l.error("View model for "+e.targetId+" already exists, duplicate id cannot be added."),om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RUNTIME,jf.XrayMetricsConstants.XRAY_LIVE_DYNAMIC_ADD_FAIL),Uf.XrayPmetReporter.putMetric(jf.XrayMetricsConstants.XRAY_LIVE_DYNAMIC_ADD_FAIL,1),void this.metricsReportingFeature.reportError(!1,{name:"X-Ray",message:"Dynamic add failed for id: "+e.targetId},"Application","Unknown");var i=e.maxJitterMillis;if(xt.exists(i)&&0<i)return e.maxJitterMillis=null,setTimeout(function(){n.performAdd(e,t)},Math.random()*i),null;if(xt.exists(e.visibilityDurationMillis)&&0<e.visibilityDurationMillis){var o={parentTargetId:e.parentTargetId,targetId:e.targetId,type:s.REMOVE,version:1};setTimeout(function(){n.performRemove(o,t)},e.visibilityDurationMillis)}var a=this.viewModelUpdater.add(e,r);null!==a&&(this.viewModelRegistry.registerViewModel(r),this.viewModelRegistry.registerViewModel(a),this.dynamicChildViewModelsToClear.push(a.id))}},e.prototype.performRemove=function(e,t){var n=this.getViewModelAndClone(t);null!==n&&(-1<this.viewModelUpdater.remove(e,n)&&(this.viewModelRegistry.deleteViewModel(e.targetId),this.viewModelRegistry.registerViewModel(n)))},e.prototype.performUpdate=function(e,t){var n=this.getViewModelAndClone(t);if(null!==n){var r=this.viewModelUpdater.update(e,n);null!==r&&(this.viewModelRegistry.registerViewModel(r),this.viewModelRegistry.registerViewModel(n))}},e.prototype.isAddActionOutOfBounds=function(e,t){if(e.type!==s.ADD)return!1;var n=e;return!!(xt.exists(n.visibilityWindowMillis)&&0<n.visibilityWindowMillis)&&t+n.visibilityWindowMillis<this.currentPlayerTimeMs},e.prototype.getViewModelAndClone=function(e){var t=this.viewModelRegistry.getById(e);return null===t?(om.XrayInsightClient.getInstance().sendErrorEvent(sm.XrayInsightErrorType.RUNTIME,jf.XrayMetricsConstants.XRAY_LIVE_DYNAMIC_ADD_FAIL),l.error("View model for "+e+" should exist in registry."),null):this.viewModelUpdater.clone(t)},e.prototype.clear=function(){for(var e=0,t=this.dynamicViewModelsToClear;e<t.length;e++){var n=t[e],r=this.viewModelRegistry.getById(n);null!==r&&this.viewModelUpdater.clear(r,this.viewModelRegistry)}for(this.clearChildViewModels(),this.dynamicViewModelsToClear=[],this.deadActionsMap.clear();0<this.actionQueue.size();)this.actionQueue.pop()},e.prototype.clearChildViewModels=function(){for(var e=0,t=this.dynamicChildViewModelsToClear;e<t.length;e++){var n=t[e];this.viewModelRegistry.deleteViewModel(n)}this.dynamicChildViewModelsToClear=[]},e.prototype.reloadActions=function(){for(var e=0,t=this.dynamicViewModelsToClear;e<t.length;e++){var n=t[e],r=this.viewModelRegistry.getById(n);null!==r&&this.viewModelUpdater.clear(r,this.viewModelRegistry)}this.clearChildViewModels(),this.mapAndExecuteActions(this.actionHistoryQueue,!0)},e.prototype.mapAndExecuteActions=function(e,t){for(var n=[];0<e.size();){if(e.peek().sourceTime>this.currentPlayerTimeMs)break;n.push(e.pop())}for(var r=new uv.MultiMap(function(e){return e}),i=0,o=n;i<o.length;i++){for(var a=o[i],s=0,l=a.actionList;s<l.length;s++){var u=l[s];this.isAddActionOutOfBounds(u,a.sourceTime)||r.put(u.parentTargetId,[u])}t&&e.push(a)}for(var c=0,d=r.keys();c<d.length;c++){var p=d[c];this.executeAll(r.get(p),p)}},e}();t.ActionExecutor=n});e(cv);cv.ActionExecutor;var dv=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.avod.xray.XRayActionTargetType,s=M.get("CollectionViewModelUpdater"),i=function(){function e(e,t){this.swiftTransformer=e,this.widgetTransformer=t}return e.prototype.add=function(e,t){var n=this.transformTarget(e.target);if(null===n)return s.warn("Could not transform add action target: "+e.target+"."),null;if(Rm.XrayLiveDebugConfig.getDynamicLogsEnabled()){var r=e.target.item;s.info("Xray adding item "+JSON.stringify(r))}return t.items.unshift(n),n},e.prototype.remove=function(e,t){for(var n=t.items,r=0;r<n.length;r++)if(n[r].id===e.targetId)return n.splice(r,1),r;return-1},e.prototype.update=function(e,t){for(var n=this.transformTarget(e.target),r=t.items,i=null,o=0;o<r.length;o++)if(r[o].id===e.targetId&&!F.isEqual(n,r[o])){r.splice(o,1),i=o;break}if(null===n)return s.warn("Could not transform update action target: "+e.target+"."),null;if(null===i)return s.info("No view model found that required an update for id: "+e.targetId+"."),null;if(Rm.XrayLiveDebugConfig.getDynamicLogsEnabled()){var a=e.target.item;s.info("Xray updating item "+JSON.stringify(a))}return t.items.splice(i,0,n),n},e.prototype.clear=function(e,t){for(var n=0,r=e.items;n<r.length;n++){var i=r[n];t.deleteViewModel(i.id)}e.items=[]},e.prototype.clone=function(e){return n({},e,{items:[].concat(e.items)})},e.prototype.transformTarget=function(e){switch(e.type){case r.ITEM:return this.swiftTransformer.convertSwiftItemToViewModel(e.item);case r.WIDGET:return this.widgetTransformer.transform(e.widget);default:return s.warn("Unknown target type: "+e.type),null}},e}();t.CollectionViewModelUpdater=i});e(dv);dv.CollectionViewModelUpdater;var pv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Mf.com.amazon.avod.xray.BlueprintIds,r=M.get("TypeAwareViewModelUpdater"),n=function(){function e(e){this.updatersMap=e||this.createUpdatersMap()}return e.prototype.add=function(e,t){var n=this.updatersMap[t.type]||null;return null!==n?n.add(e,t):(r.warn("View model of type: "+t.type+" is not supported"),null)},e.prototype.remove=function(e,t){var n=this.updatersMap[t.type]||null;return null!==n?n.remove(e,t):(r.warn("View model of type: "+t.type+" is not supported"),-1)},e.prototype.update=function(e,t){var n=this.updatersMap[t.type]||null;return null!==n?n.update(e,t):(r.warn("View model of type: "+t.type+" is not supported"),null)},e.prototype.clear=function(e,t){var n=this.updatersMap[e.type]||null;null!==n?n.clear(e,t):r.warn("View model of type: "+e.type+" is not supported")},e.prototype.clone=function(e){var t=this.updatersMap[e.type]||null;return null!==t?t.clone(e):(r.warn("View model of type: "+e.type+" is not supported"),null)},e.prototype.createUpdatersMap=function(){var e,t,n=new Ky.BlueprintAwareBlueprintedItemTransformer(((e={})[i.XRAY_GAME_LEADERS_ITEM]=new Xy.LiveStatsTransformer(By.LiveStatsTableViewModelStyle.FIVE_COLUMN),e[i.XRAY_THREE_COLUMN_ITEM]=new Xy.LiveStatsTransformer(By.LiveStatsTableViewModelStyle.THREE_COLUMN),e[i.XRAY_PLAY_HISTORY_ITEM]=new qy.LivePlayHistoryTransformer(zy.LivePlayHistoryViewModelStyle.NORMAL),e[i.XRAY_FORMATTED_PLAY_HISTORY_ITEM]=new Wy.LiveFormattedPlayHistoryTransformer,e[i.XRAY_EMPTY_COLLECTION_PLACEHOLDER_ITEM]=new qy.LivePlayHistoryTransformer(zy.LivePlayHistoryViewModelStyle.PENDING),e[i.XRAY_ONE_COLUMN_ITEM]=new eg.LiveOneColumnTableTransformer,e[i.XRAY_SCOREBOARD]=new ig.XrayScoreboardTransformer,e[i.XRAY_PLAY_HISTORY_POP_UP_TOGGLE_BUTTON]=new Cg.PopUpToggleTransformer,e[i.XRAY_LIVE_HINTABLE_BUTTON]=new Pg.LiveHintableButtonTransformer,e)),r=new dv.CollectionViewModelUpdater(n,{transform:function(e){return null}});return(t={})[fy.WidgetGroupType]=r,t[Cy.CollectionModelType]=r,t},e}();t.TypeAwareViewModelUpdater=n});e(pv);pv.TypeAwareViewModelUpdater;var fv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i){void 0===t&&(t=Im.ReceiveLivePollingUrlAction.store),void 0===n&&(n=mm.ReceivePlaybackPositionAction.store),void 0===r&&(r=new cv.ActionExecutor(xm.ViewModelRegistry.getInstance(),new pv.TypeAwareViewModelUpdater,e)),void 0===i&&(i=sv.XrayActionsPoller);var o=this;this.onLivePollingUrlUpdate=function(){var e=o.receiveLivePollingUrlActionStore.getValue();null!==e&&(o.actionsPoller=new o.actionsPollerType(o.actionExecutor,o.metricsReportingFeature,e.url,e.domain,e.path,e.pollingIntervalMs,e.cdnPreferenceList,e.documentUrlMap),o.actionsPoller.getIsRunning()||o.actionsPoller.start(),o.actionExecutor.getIsEnabled()||o.actionExecutor.start(),nv.XrayViewModelRenderer.setDynamicEnabled(!0))},this.onTimeUpdate=function(){var e=o.receivePlaybackPositionActionStore.getValue();null!==e&&o.actionExecutor.onTimeUpdate(e)},this.metricsReportingFeature=e,this.receiveLivePollingUrlActionStore=t,this.receivePlaybackPositionActionStore=n,this.actionExecutor=r,this.actionsPollerType=i,this.actionsPoller=null}return e.prototype.initialize=function(){this.receiveLivePollingUrlActionStore.onChange(this.onLivePollingUrlUpdate),this.receivePlaybackPositionActionStore.onChange(this.onTimeUpdate),null!==this.actionsPoller&&this.actionsPoller.start(),this.actionExecutor.start()},e.prototype.reset=function(){null!==this.actionsPoller&&this.actionsPoller.stop(),this.actionExecutor.stop(),this.actionsPoller=null,nv.XrayViewModelRenderer.setDynamicEnabled(!1)},e.prototype.destroy=function(){this.reset(),this.receiveLivePollingUrlActionStore.offChange(this.onLivePollingUrlUpdate),this.receivePlaybackPositionActionStore.offChange(this.onTimeUpdate),xt.exists(this.actionsPoller)&&this.actionsPoller.stop(),this.actionExecutor.stop()},e}();t.XrayDynamicAdapter=n});e(fv);fv.XrayDynamicAdapter;var hv=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ReceiveMiniXrayModelAction"},n.store=new Lf.ActionStore(n.getName()),n}(Lf.Action);t.ReceiveMiniXrayModelAction=n});e(hv);hv.ReceiveMiniXrayModelAction;var mv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=Mf.com.amazon.atv.discovery.SectionV2,s=Mf.com.amazon.atv.discovery.WidgetGroup,l=Mf.com.amazon.atv.discovery.SectionType,n=Mf.com.amazon.atv.discovery.GetPageResponse,u=M.get("MiniXrayLoader"),r=[403],i=function(){function e(e,t){void 0===e&&(e=hm.XrayDispatcher.getInstance()),void 0===t&&(t=new Bf.XrayServiceResponseParser(n)),this.localizationStore=Ug.ReceiveLocalizationAction.store,this.initializationContextStore=pm.XrayInitializationContextAction.store,this.dispatcher=e,this.serviceResponseParser=t,this.xrayDocumentLoaderWithRetries=new av.XrayDocumentLoaderWithRetries(this.serviceResponseParser)}return e.getInstance=function(){return xt.exists(this.instance)||(this.instance=new e),this.instance},e.prototype.destroy=function(){this.xrayDocumentLoaderWithRetries.cancel()},e.prototype.load=function(e,t){var s=this,n={resourceType:am.XrayInsightResourceType.DYNAMIC_SWIFT,shouldTryMultipleUrls:!0,cdnPreferenceList:e,documentUrlMap:t,nonRetriableErrors:r};this.xrayDocumentLoaderWithRetries.load(n).then(function(e){var t=new Ng.TypeAwareWidgetTransformer(s.localizationStore.getValue(),s.initializationContextStore.getValue().transformers),n=s.parseWidgetGroup(e.page,l.LEFT),r=s.parseWidgetGroup(e.page,l.CENTER),i=null;0!==n.widgets.widgetList.length&&(i=t.transform(n.widgets.widgetList[0]));var o=t.transform(r),a={isSuccess:!0,quickViewModel:i,fullViewModel:o,brandingImageModel:s.parseAndRemoveWidgetFromWidgetGroup(o,mg.XrayBrandingImageModelType)};s.dispatcher.dispatch(new hv.ReceiveMiniXrayModelAction(a))}).catch(function(e){s.dispatcher.dispatch(new hv.ReceiveMiniXrayModelAction({isSuccess:!1,quickViewModel:null,fullViewModel:null})),Uf.XrayPmetReporter.putMetric(jf.XrayMetricsConstants.XRAY_DATA_LOAD_FAIL_STREAMING),u.error("Mini Xray load failed",e)})},e.prototype.parseWidgetGroup=function(e,t,n){void 0===n&&(n=new Mf.Validator);var r=e.sections[t];if(!n.isA(r,a))return u.warn("Page had no "+t+" section or was not a SectionV2"),null;var i=r.widgets.widgetList,o=0===i.length?null:i[0];return n.isA(o,s)?o:(u.warn("First widget in "+t+" section is missing or not a widget group."),null)},e.prototype.parseAndRemoveWidgetFromWidgetGroup=function(e,t){if(e.type===fy.WidgetGroupType)for(var n=0;n<e.items.length;n++){var r=e.items[n];if(r.type===t)return e.items.splice(n,1),r;if(r.type===Cy.CollectionModelType)for(var i=r,o=0;o<i.items.length;o++){var a=i.items[o];if(a.type===t)return i.items.splice(o,1),a}}else u.warn("model is not type of WidgetGroupModel")},e}();t.MiniXrayLoader=i});e(mv);mv.MiniXrayLoader;var yv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.player=e,this.shouldUseEncoderTimestampStore=Am.ReceiveEncoderTimestampConfigAction.store}return e.prototype.play=function(){this.player.play()},e.prototype.pause=function(){this.player.pause()},e.prototype.seek=function(e){this.shouldUseEncoderTimestampStore.getValue()&&xt.exists(this.player.seekToWallClockTime)?this.player.seekToWallClockTime(e):this.player.seek(e)},e.prototype.on=function(e,t){this.player.on(e,t)},e.prototype.off=function(e,t){this.player.off(e,t)},e.prototype.isUsingEncoderTimestamp=function(){return this.shouldUseEncoderTimestampStore.getValue()},e.prototype.getLiveGameTimeRange=function(){var e,t,n,r=this.player.currentTime,i=this.player.timeline;return e=(n=xt.exists(i)?this.getLiveGameTimeRangeForXp(i):this.getLiveGameTimeRangeForCascade(r)).startPositionMs,t=n.livePositionMs,xt.exists(e)&&xt.exists(t)?{startPositionMs:e,livePositionMs:t}:null},e.prototype.getLiveGameTimeRangeForCascade=function(e){var t=null,n=null,r=e.playableRanges[0];return n=xt.exists(n)?Math.max(n,r.end):r.end,{startPositionMs:t=xt.exists(t)?Math.min(t,r.start):r.start,livePositionMs:n}},e.prototype.getLiveGameTimeRangeForXp=function(e){for(var t=null,n=null,r=0,i=e.items;r<i.length;r++){var o=i[r];n=xt.exists(n)?Math.max(n,o.endTime):o.endTime,t=xt.exists(t)?Math.min(t,o.startTime):o.startTime}return{startPositionMs:t,livePositionMs:n}},e}();t.XrayPlaybackController=n});e(yv);yv.XrayPlaybackController;var gv=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=Mf.com.amazon.atv.discovery.SectionV2,s=Mf.com.amazon.atv.discovery.SectionType,l=Mf.com.amazon.atv.discovery.CollectionV2,u=M.get("XraySwiftPopUpCollectionStore"),i=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return n(r,e),r.valueFunction=function(e,t,n){return null===t||null===t.page?null:r.parsePopUpWidgetGroup(t.page)},r.parsePopUpWidgetGroup=function(e,t){void 0===t&&(t=new Mf.Validator);var n=e.sections[s.BOTTOM];if(!t.isA(n,a))return u.warn("Page had no bottom section or was not a SectionV2"),null;var r=n,i=xt.exists(r)&&xt.exists(r.widgets)&&xt.exists(r.widgets.widgetList)?r.widgets.widgetList:[],o=xt.exists(i)&&0<i.length?i[0]:null;return t.isA(o,l)?o:(u.warn("First widget in bottom section is missing or not a collectionV2"),null)},r.getInstance=function(){return this.instance},r.instance=new Lf.ComputedValueStore("XraySwiftPopUpCollectionStore",[Mm.ReceiveInitialSwiftPageAction.store,pm.XrayInitializationContextAction.store],r.valueFunction),r}(Lf.ComputedValueStore);t.XraySwiftPopUpCollectionStore=i});e(gv);gv.XraySwiftPopUpCollectionStore;var vv=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.valueFunction=function(e,t,n){return null===t||null===n?null:t.transform(n)},t.getInstance=function(){return this.instance},t.instance=new Lf.ComputedValueStore("XrayPopUpViewModelStore",[Bg.SwiftWidgetTransformerStore.getInstance(),gv.XraySwiftPopUpCollectionStore.getInstance()],t.valueFunction),t}(Lf.ComputedValueStore);t.XrayPopUpViewModelStore=i});e(vv);vv.XrayPopUpViewModelStore;var Sv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var h=S.of("XrayController"),i=M.get("XrayController"),n=function(){function f(e,t,n,r,i,o,a,s,l,u,c){h(e,"playerObjects"),h(t,"xrayObjects"),this.player=e.player,this.metricsFeature=e.metricsFeature,this.weblabs=e.weblabs,this.playerConfig=e.playerConfig,this.playerHighlightModeController=e.playerHighlightModeController;var d=e.serviceClientFactory,p=e.pmetReporter;Uf.XrayPmetReporter.setFlusher(function(){return p.flush()}),Uf.XrayPmetReporter.setHandler(function(e,t,n){return p.putMetric(e,t,n)}),this.loadMetricsReporter=c||new ch.LoadMetricsReporter,this.fullScreenPlayerManager=n||new fm.FullScreenPlayerStateManager(this.player),this.scalingPlayerStateManager=r||new iv.ScalingPlayerStateManager(e.playerScalingController),i=i||new lm.XrayClient(d,this.metricsFeature,t.localizationAdapter,t.xrayToken),this.dispatcher=o||hm.XrayDispatcher.getInstance(),this.allStores=a||f.getDefaultStores().concat(t.additionalStores),this.actionResponders=u||f.getDefaultActionResponders().concat(t.actionResponders),this.mediaPlayerEventAdapter=s||new Lm.MediaPlayerEventAdapter(this.player,this.dispatcher,i,this.loadMetricsReporter,new fv.XrayDynamicAdapter(this.metricsFeature)),this.swiftXraySelectionLoader=l||new Yg.SwiftXraySelectionLoader(i),this.localizationStoreAdapter=t.localizationAdapter,this.transformers=t.transformers,this.displayModeOverride=t.displayModeOverride,this.miniXrayLoader=mv.MiniXrayLoader.getInstance(),zm.SwiftLinkActionResolver.addOverrideResolvers(t.navigationalActionResolvers),nv.XrayViewModelRenderer.setViewClassMap(t.viewClassMap),om.XrayInsightClient.initialize(d,t.xrayToken,this.playerConfig)}return f.prototype.initialize=function(){var t=this;i.info("Initializing Xray");var e={playerConfig:this.playerConfig,metricsFeature:this.metricsFeature,weblabs:this.weblabs,loadMetricsReporter:this.loadMetricsReporter,transformers:this.transformers,playerHighlightModeController:this.playerHighlightModeController,player:new yv.XrayPlaybackController(this.player)};F.each(this.allStores,function(e){e.initialize(t.dispatcher)}),F.each(this.actionResponders,function(e){e.initialize(t.dispatcher)}),this.swiftXraySelectionLoader.initialize(),this.localizationStoreAdapter.initialize(this.dispatcher),this.dispatcher.dispatch(new pm.XrayInitializationContextAction(e)),this.mediaPlayerEventAdapter.initialize(this.weblabs)},f.prototype.setContentConfig=function(e){var t=e.videoMaterialType;i.info("Setting video material type "+t);var n=this.determineFullViewDisplayMode(e,this.displayModeOverride),r={fullViewDisplayMode:n,playerStateManager:n===ov.FullViewDisplayMode.SIDE_BY_SIDE_PLAYBACK?this.scalingPlayerStateManager:this.fullScreenPlayerManager,videoMaterialType:t};this.dispatcher.dispatch(new tm.XrayPlaybackContextAction(r))},f.prototype.destroy=function(){i.info("Destroying xray"),this.mediaPlayerEventAdapter.destroy(),this.swiftXraySelectionLoader.destroy(),this.localizationStoreAdapter.destroy(),this.fullScreenPlayerManager.destroy(),this.miniXrayLoader.destroy(),F.each(this.allStores,function(e){e.destroy()}),F.each(this.actionResponders,function(e){e.destroy()})},f.prototype.determineFullViewDisplayMode=function(e,t){return t||("LiveStreaming"===e.videoMaterialType?ov.FullViewDisplayMode.SIDE_BY_SIDE_PLAYBACK:ov.FullViewDisplayMode.OVERLAY_PLAYBACK)},f.getDefaultStores=function(){return[Mm.ReceiveInitialSwiftPageAction.store,Fm.XraySwiftQuickViewWidgetGroupStore.getInstance(),Qm.XraySwiftNavigationsStore.getInstance(),qg.ActionBackstackStore.getInstance(),pm.XrayInitializationContextAction.store,Sm.XraySwiftSelectAction.store,vm.AdBreakResponseAction.store,Om.ChangeVolumeAction.store,mm.ReceivePlaybackPositionAction.store,Ug.ReceiveLocalizationAction.store,Vg.ReceiveXraySwiftTabDataAction.store,ym.ReceiveContentStateAction.store,Jh.ReceiveTitleInfoAction.store,Am.ReceiveEncoderTimestampConfigAction.store,gm.ReceivePlaybackStateAction.store,hv.ReceiveMiniXrayModelAction.store,Bg.SwiftWidgetTransformerStore.getInstance(),Gg.SwiftQuickViewModelStore.getInstance(),$g.XraySwiftFullViewStore.getInstance(),nm.XrayInsightContentTypeStore.getInstance(),Zh.XrayHighlightModeAction.store,em.XrayReplayBoothModeAction.store,Zg.ShowXrayModalAction.store,Wg.UpdateQuickViewItemsAction.store,Im.ReceiveLivePollingUrlAction.store,rv.RefreshDynamicActionsHistoryActionStore.getInstance(),tm.XrayPlaybackContextAction.store,$g.IsFullViewOpenStore,Bm.XrayCollectionSelectAction.store,jm.XrayCollectionFilterAction.store,vv.XrayPopUpViewModelStore.getInstance(),gv.XraySwiftPopUpCollectionStore.getInstance()].concat(Hg.QuickViewStores.allStores).concat(Xg.XraySwiftFullViewDataStores.allStores).concat(zg.XraySwiftTabBarStores.allStores).concat(ev.XrayModalStores.allStores)},f.getDefaultActionResponders=function(){return[Nm.PlayerNavigationalActionResolver.responder,wm.CloseXrayAction.responder]},f}();t.XrayController=n});e(Sv);Sv.XrayController;var bv=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(){var n=null!==i&&i.apply(this,arguments)||this;return n.items=[],n.idItemMapping={},n.onAction=function(e){if(e.getType()===Dy.PhotoGalleryChangeItemAction.getName()){var t=e.getValue();xt.exists(t.itemId)?n.currentViewModel=n.idItemMapping[t.itemId]||null:n.currentViewModel=null,n.emitChange()}},n}return n(e,i),e.prototype.initialize=function(e,t){void 0===t&&(t=null),i.prototype.initialize.call(this,e),this.items=t;for(var n=0;n<t.length;n++){var r=this.items[n];this.idItemMapping[r.id]=r}},e.prototype.getValue=function(){return this.currentViewModel},e.prototype.getActionHandler=function(){return this.onAction},e.prototype.getDispatchRecipientId=function(){return"Xray.PhotoGallerySwiftStore"},e}(Lf.ValueStore);t.PhotoGallerySwiftStore=i});e(bv);bv.PhotoGallerySwiftStore;var Tv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=S.of("LoadTimeTracker"),n=function(){function e(){this.loadListener=null,this.reset()}return e.prototype.reset=function(){this.isLocked=!1,this.loadTimeItems={},this.loadTimeItemsRemaining=0},e.prototype.registerId=function(e){var t=this;return this.isLocked?function(){}:(o(this.loadTimeItems[e],"Item was already registered").is.not.exists(),this.loadTimeItems[e]=!1,this.loadTimeItemsRemaining++,function(){t.markReported(e),t.notifyLoadedIfNecessary()})},e.prototype.setOnLoadListener=function(e){this.loadListener=e},e.prototype.lock=function(e){if(!this.isLocked){if(o(this.loadListener,"Must have set a load listener before locking").is.not.null(),e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;for(var r in this.loadTimeItems)if(this.loadTimeItems.hasOwnProperty(r)){var i=parseInt(r);!t[i]&&this.markReported(i)}}this.isLocked=!0,this.notifyLoadedIfNecessary()}},e.prototype.markReported=function(e){!1===this.loadTimeItems[e]&&(this.loadTimeItemsRemaining--,this.loadTimeItems[e]=!0)},e.prototype.notifyLoadedIfNecessary=function(){0===this.loadTimeItemsRemaining&&this.isLocked&&(this.loadTimeItemsRemaining--,this.loadListener())},e}();t.LoadTimeTracker=n});e(Tv);Tv.LoadTimeTracker;var Pv=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("ComputedStateView"),o=function(r){function e(e,t){var n=r.call(this,e)||this;return n.onStoreChange=function(){n.setState(n.getStateFromStores())},n.dependencyStoresMap=i(t,"dependencyStoresMap").exists(),n.state=n.getStateFromStores(),n}return n(e,r),e.prototype.componentDidMount=function(){for(var e=0,t=F.values(this.dependencyStoresMap);e<t.length;e++){t[e].onChange(this.onStoreChange)}},e.prototype.componentWillUnmount=function(){for(var e=0,t=F.values(this.dependencyStoresMap);e<t.length;e++){t[e].offChange(this.onStoreChange)}},e.prototype.getStateFromStores=function(){var e={};for(var t in this.dependencyStoresMap)this.dependencyStoresMap.hasOwnProperty(t)&&(e[t]=this.dependencyStoresMap[t].getValue());return e},e}(Vn.Component);t.ComputedStateView=o});e(Pv);Pv.ComputedStateView;var wv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.ExpandableTextModalViewModelType="ExpandableTextModalViewModel"});e(wv);wv.ExpandableTextModalViewModelType;var Cv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.EmptyImageModel={imageUrl:null,width:0,height:0}});e(Cv);Cv.EmptyImageModel;var Mv=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.shouldComponentUpdate=function(e,t){return!F.isEqual(this.props,e)||!F.isEqual(this.state,t)},t}(Vn.Component);t.XrayViewModelComponent=i});e(Mv);Mv.XrayViewModelComponent;var Iv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayGlobalNavigationModelType="XrayGlobalNavigationModel"});e(Iv);Iv.XrayGlobalNavigationModelType;var Ev=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).ACTIVE="ACTIVE",r.PASSIVE="PASSIVE",t.XrayInsightImpressionType=n});e(Ev);Ev.XrayInsightImpressionType;var _v=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).OPEN="OPEN",r.BUFFER_UNEXPECTED="BUFFER_UNEXPECTED",r.BUFFER_SEEK="BUFFER_SEEK",r.BUFFER_INITIALIZATION="BUFFER_INITIALIZATION",r.READY_TO_WATCH="READY_TO_WATCH",r.EXIT="EXIT",r.UPDATE="UPDATE",t.XrayInsightPlaybackEventType=n});e(_v);_v.XrayInsightPlaybackEventType;var xv=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).BONUS_CONTENT="BONUS_CONTENT",r.HIGHLIGHT="HIGHLIGHT",r.HIGHLIGHT_SEEK="HIGHLIGHT_SEEK",t.XrayInsightPlaybackSessionType=n});e(xv);xv.XrayInsightPlaybackSessionType;var kv=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e,{playbackPositionMillis:mm.ReceivePlaybackPositionAction.store})||this;return t.defaultId=_m.ViewModelIdGenerator.generateDefaultId(Cy.CollectionModelType),t.itemsAtCurrentTime=[],t.itemsAtCurrentTime=t.props.viewModel.getItems(t.state.playbackPositionMillis),t}return i(e,n),e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this),hm.XrayDispatcher.getInstance().dispatch(new Wg.UpdateQuickViewItemsAction(this.itemsAtCurrentTime))},e.prototype.shouldComponentUpdate=function(e,t){return!F.isEqual(this.props.viewModel,e.viewModel)||!F.isEqual(this.state,t)||!F.isEqual(this.props.shouldShow,e.shouldShow)},e.prototype.componentWillUpdate=function(e,t){var n=this.props.viewModel.getItems(t.playbackPositionMillis);F.isEqual(this.props.viewModel,e.viewModel)&&F.isEqual(n,this.itemsAtCurrentTime)||(this.itemsAtCurrentTime=n,hm.XrayDispatcher.getInstance().dispatch(new Wg.UpdateQuickViewItemsAction(this.itemsAtCurrentTime)))},e.prototype.render=function(){var e={type:Cy.CollectionModelType,style:this.props.viewModel.style,items:this.props.shouldReverse?this.itemsAtCurrentTime.reverse():this.itemsAtCurrentTime,id:this.defaultId},t=!xt.exists(this.props.shouldShow)||this.props.shouldShow;return this.props.viewModelRenderer.renderViewModel(e,this.props.loadListener,t)},e}(Pv.ComputedStateView);t.XrayTimeIndexedCollectionView=n});e(kv);kv.XrayTimeIndexedCollectionView;var Rv=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.XrayClient=lm.XrayClient,t.XrayCardKey=dm.XrayCardKey,t.XrayPageContext=cm.XrayPageContext,t.XrayMetricsConstants=jf.XrayMetricsConstants,t.XrayInitializationContextAction=pm.XrayInitializationContextAction,t.XrayController=Sv.XrayController,t.ReceiveLocalizationAction=Ug.ReceiveLocalizationAction,t.BlueprintAwareWidgetTransformer=ry.BlueprintAwareWidgetTransformer,t.ShowXrayModalAction=Zg.ShowXrayModalAction,t.XraySwiftUtils=Km.XraySwiftUtils,t.SwiftLinkActionResolver=zm.SwiftLinkActionResolver,t.XrayDispatcher=hm.XrayDispatcher,t.PhotoGalleryImageModelType=Fy.PhotoGalleryImageModelType,t.XrayRefMarkers=bm.XrayRefMarkers,t.PhotoGalleryChangeItemAction=Dy.PhotoGalleryChangeItemAction,t.PhotoGallerySwiftStore=bv.PhotoGallerySwiftStore,t.XrayTabBarItemType=Jm.XrayTabBarItemType,t.CloseXrayAction=wm.CloseXrayAction,t.ActionBackstackStore=qg.ActionBackstackStore,t.SelectPreviousAction=Ym.SelectPreviousAction,t.XrayFullViewState=ey.XrayFullViewState,t.XraySwiftFullViewStore=$g.XraySwiftFullViewStore,t.IsFullViewOpenStore=$g.IsFullViewOpenStore,t.KeyedMap=im.KeyedMap,t.XrayModalStores=ev.XrayModalStores,t.QuickViewStores=Hg.QuickViewStores,t.SwiftQuickViewModelStore=Gg.SwiftQuickViewModelStore,t.ReceivePlaybackPositionAction=mm.ReceivePlaybackPositionAction,t.ReceiveContentStateAction=ym.ReceiveContentStateAction,t.ReceivePlaybackStateAction=gm.ReceivePlaybackStateAction,t.TimestampBasedTimeIndexedCollection=Ig.TimestampBasedTimeIndexedCollection,t.LoadTimeTracker=Tv.LoadTimeTracker,t.XraySwiftSelectAction=Sm.XraySwiftSelectAction,t.XrayViewModelRenderer=nv.XrayViewModelRenderer,t.ComputedStateView=Pv.ComputedStateView,t.UpdateQuickViewItemsAction=Wg.UpdateQuickViewItemsAction,t.hasNoText=Dm.hasNoText,t.textModelFromTextMap=Dm.textModelFromTextMap,t.PhotoGalleryCollectionModelType=Oy.PhotoGalleryCollectionModelType,t.buttonModelFromLinkActionMap=Wm.buttonModelFromLinkActionMap,t.buttonModelFromNavigationalAction=Wm.buttonModelFromNavigationalAction,t.ButtonViewModelType=Wm.ButtonViewModelType,t.XrayQuickViewHeaderModelType=iy.XrayQuickViewHeaderModelType,t.InSceneItemStyle=_g.InSceneItemStyle,t.InSceneItemType=_g.InSceneItemType,t.TwoSectionDetailViewModelType=my.TwoSectionDetailViewModelType,t.CollectionV2ViewModelTransformer=ky.CollectionV2ViewModelTransformer,t.CollectionModelType=Cy.CollectionModelType,t.CollectionStyle=Cy.CollectionStyle,t.GridTileImageViewModelType=Gm.GridTileImageViewModelType,t.GridTileStyle=Gm.GridTileStyle,t.GridTileTextViewModelType=Ty.GridTileTextViewModelType,t.ImageTextLinkModelType=ty.ImageTextLinkModelType,t.StyledTextLinkItemStyle=sy.StyledTextLinkItemStyle,t.StyledTextLinkModelType=sy.StyledTextLinkModelType,t.TextCollectionStyle=ly.TextCollectionStyle,t.TextCollectionType=ly.TextCollectionType,t.TriviaViewModelType=wy.TriviaViewModelType,t.ExpandableTextModalViewModelType=wv.ExpandableTextModalViewModelType,t.WidgetGroupStyle=fy.WidgetGroupStyle,t.WidgetGroupType=fy.WidgetGroupType,t.XrayListItemStyle=My.XrayListItemStyle,t.XrayListItemViewModelType=My.XrayListItemViewModelType,t.XrayPlaceholder=qm.XrayPlaceholder,t.XrayIcon=Hm.XrayIcon,t.EmptyImageModel=Cv.EmptyImageModel,t.imageModelFromImageMap=Uy.imageModelFromImageMap,t.containsValidImageModel=Uy.containsValidImageModel,t.LiveStatsTableRowModelStyle=jy.LiveStatsTableRowModelStyle,t.LiveStatsTableRowModelType=jy.LiveStatsTableRowModelType,t.LiveStatsTableViewModelStyle=By.LiveStatsTableViewModelStyle,t.LiveStatsTableViewModelType=By.LiveStatsTableViewModelType,t.LiveOneColumnTableModelType=Zy.LiveOneColumnTableModelType,t.LiveMatchStatsRowModelType=Zy.LiveMatchStatsRowModelType,t.LiveMatchStatsTextRowModelType=Zy.LiveMatchStatsTextRowModelType,t.LiveScorecardViewModelType=tg.LiveScorecardViewModelType,t.TabHeaderType=kg.TabHeaderType,t.TextMapHighlightedIndex=Vy.TextMapHighlightedIndex,t.GridTileDataTransformer=by.GridTileDataTransformer,t.MusicItemDataTransformer=Ey.MusicItemDataTransformer,t.ReceiveInitialSwiftPageAction=Mm.ReceiveInitialSwiftPageAction,t.XraySwiftNavigationsStore=Qm.XraySwiftNavigationsStore,t.XrayApiEndpoint=um.XrayApiEndpoint,t.ItemListTransformer=Ry.ItemListTransformer,t.ViewModelIdGenerator=_m.ViewModelIdGenerator,t.FullScreenPlayerStateManager=fm.FullScreenPlayerStateManager,t.FullViewDisplayMode=ov.FullViewDisplayMode,t.XrayPlaybackContextAction=tm.XrayPlaybackContextAction,t.XrayViewModelComponent=Mv.XrayViewModelComponent,t.LivePlayHistoryViewModelStyle=zy.LivePlayHistoryViewModelStyle,t.LivePlayHistoryViewModelType=zy.LivePlayHistoryViewModelType,t.XraySelectableCollectionContainerType=gy.XraySelectableCollectionContainerType,t.XrayTwoColumnLiveItemModelType=Hy.XrayTwoColumnLiveItemModelType,t.XrayTwoColumnLiveItemStyle=Hy.XrayTwoColumnLiveItemStyle,t.TwoColumnSubheaderItemModelType=Jy.TwoColumnSubheaderItemModelType,t.TwoColumnTableItemModelType=Qy.TwoColumnTableItemModelType,t.XrayCollectionSelectAction=Bm.XrayCollectionSelectAction,t.XrayCollectionFilterAction=jm.XrayCollectionFilterAction,t.XrayReplayBoothModeAction=em.XrayReplayBoothModeAction,t.XrayHighlightModeAction=Zh.XrayHighlightModeAction,t.XrayHighlightExitType=Zh.XrayHighlightExitType,t.XraySelectableNavigationsStyle=Lg.XraySelectableNavigationsStyle,t.XraySelectableNavigationsType=Lg.XraySelectableNavigationsType,t.XrayGlobalNavigationModelType=Iv.XrayGlobalNavigationModelType,t.InteractionEventReporter=Tm.InteractionEventReporter,t.XrayInsightClient=om.XrayInsightClient,t.XrayInsightErrorType=sm.XrayInsightErrorType,t.XrayInsightEventType=$h.XrayInsightEventType,t.XrayInsightImpressionType=Ev.XrayInsightImpressionType,t.XrayInsightInteractionType=Pm.XrayInsightInteractionType,t.XrayInsightPlaybackEventType=_v.XrayInsightPlaybackEventType,t.XrayInsightPlaybackSessionType=xv.XrayInsightPlaybackSessionType,t.XrayInsightResourceType=am.XrayInsightResourceType,t.XrayInsightSessionTransitionReason=Jg.XrayInsightSessionTransitionReason,t.XrayLiveQuickViewButtonModelType=cy.XrayLiveQuickViewButtonModelType,t.XrayLiveDebugConfig=Rm.XrayLiveDebugConfig,t.LoadMetricsReporter=ch.LoadMetricsReporter,t.MiniXrayLoader=mv.MiniXrayLoader,t.XrayPlaybackController=yv.XrayPlaybackController,t.XrayTimeIndexedCollectionView=kv.XrayTimeIndexedCollectionView,t.LiveTeamIconViewModelType=ng.LiveTeamIconViewModelType,t.LiveScorecardColumnViewModelType=rg.LiveScorecardColumnViewModelType,t.ReceiveMiniXrayModelAction=hv.ReceiveMiniXrayModelAction,t.XrayBrandingImageModelType=mg.XrayBrandingImageModelType,t.XrayImageGraphProbabilityPercentageModelType=og.XrayImageGraphProbabilityPercentageModelType,t.XrayPlayerStatisticModelType=ug.XrayPlayerStatisticModelType,t.XrayParagraphTextModelType=sg.XrayParagraphTextModelType,t.XrayTitledImageModelType=fg.XrayTitledImageModelType,t.XrayTitledParagraphTextModelType=dg.XrayTitledParagraphTextModelType,t.XrayPlayerStatisticQuickViewModelType=gg.XrayPlayerStatisticQuickViewModelType,t.XrayTitledEmphasizedTextModelType=Sg.XrayTitledEmphasizedTextModelType,t.XrayPopUpViewModelStore=vv.XrayPopUpViewModelStore,t.LiveHintableButtonViewModelType=Tg.LiveHintableButtonViewModelType,t.HintableButtonGravity=Tg.HintableButtonGravity,t.PopUpToggleViewModelType=wg.PopUpToggleViewModelType,t.ChangeVolumeAction=Om.ChangeVolumeAction});e(Rv);Rv.XrayClient,Rv.XrayCardKey,Rv.XrayPageContext,Rv.XrayMetricsConstants,Rv.XrayInitializationContextAction,Rv.XrayController,Rv.ReceiveLocalizationAction,Rv.BlueprintAwareWidgetTransformer,Rv.ShowXrayModalAction,Rv.XraySwiftUtils,Rv.SwiftLinkActionResolver,Rv.XrayDispatcher,Rv.PhotoGalleryImageModelType,Rv.XrayRefMarkers,Rv.PhotoGalleryChangeItemAction,Rv.PhotoGallerySwiftStore,Rv.XrayTabBarItemType,Rv.CloseXrayAction,Rv.ActionBackstackStore,Rv.SelectPreviousAction,Rv.XrayFullViewState,Rv.XraySwiftFullViewStore,Rv.IsFullViewOpenStore,Rv.KeyedMap,Rv.XrayModalStores,Rv.QuickViewStores,Rv.SwiftQuickViewModelStore,Rv.ReceivePlaybackPositionAction,Rv.ReceiveContentStateAction,Rv.ReceivePlaybackStateAction,Rv.TimestampBasedTimeIndexedCollection,Rv.LoadTimeTracker,Rv.XraySwiftSelectAction,Rv.XrayViewModelRenderer,Rv.ComputedStateView,Rv.UpdateQuickViewItemsAction,Rv.hasNoText,Rv.textModelFromTextMap,Rv.PhotoGalleryCollectionModelType,Rv.buttonModelFromLinkActionMap,Rv.buttonModelFromNavigationalAction,Rv.ButtonViewModelType,Rv.XrayQuickViewHeaderModelType,Rv.InSceneItemStyle,Rv.InSceneItemType,Rv.TwoSectionDetailViewModelType,Rv.CollectionV2ViewModelTransformer,Rv.CollectionModelType,Rv.CollectionStyle,Rv.GridTileImageViewModelType,Rv.GridTileStyle,Rv.GridTileTextViewModelType,Rv.ImageTextLinkModelType,Rv.StyledTextLinkItemStyle,Rv.StyledTextLinkModelType,Rv.TextCollectionStyle,Rv.TextCollectionType,Rv.TriviaViewModelType,Rv.ExpandableTextModalViewModelType,Rv.WidgetGroupStyle,Rv.WidgetGroupType,Rv.XrayListItemStyle,Rv.XrayListItemViewModelType,Rv.XrayPlaceholder,Rv.XrayIcon,Rv.EmptyImageModel,Rv.imageModelFromImageMap,Rv.containsValidImageModel,Rv.LiveStatsTableRowModelStyle,Rv.LiveStatsTableRowModelType,Rv.LiveStatsTableViewModelStyle,Rv.LiveStatsTableViewModelType,Rv.LiveOneColumnTableModelType,Rv.LiveMatchStatsRowModelType,Rv.LiveMatchStatsTextRowModelType,Rv.LiveScorecardViewModelType,Rv.TabHeaderType,Rv.TextMapHighlightedIndex,Rv.GridTileDataTransformer,Rv.MusicItemDataTransformer,Rv.ReceiveInitialSwiftPageAction,Rv.XraySwiftNavigationsStore,Rv.XrayApiEndpoint,Rv.ItemListTransformer,Rv.ViewModelIdGenerator,Rv.FullScreenPlayerStateManager,Rv.FullViewDisplayMode,Rv.XrayPlaybackContextAction,Rv.XrayViewModelComponent,Rv.LivePlayHistoryViewModelStyle,Rv.LivePlayHistoryViewModelType,Rv.XraySelectableCollectionContainerType,Rv.XrayTwoColumnLiveItemModelType,Rv.XrayTwoColumnLiveItemStyle,Rv.TwoColumnSubheaderItemModelType,Rv.TwoColumnTableItemModelType,Rv.XrayCollectionSelectAction,Rv.XrayCollectionFilterAction,Rv.XrayReplayBoothModeAction,Rv.XrayHighlightModeAction,Rv.XrayHighlightExitType,Rv.XraySelectableNavigationsStyle,Rv.XraySelectableNavigationsType,Rv.XrayGlobalNavigationModelType,Rv.InteractionEventReporter,Rv.XrayInsightClient,Rv.XrayInsightErrorType,Rv.XrayInsightEventType,Rv.XrayInsightImpressionType,Rv.XrayInsightInteractionType,Rv.XrayInsightPlaybackEventType,Rv.XrayInsightPlaybackSessionType,Rv.XrayInsightResourceType,Rv.XrayInsightSessionTransitionReason,Rv.XrayLiveQuickViewButtonModelType,Rv.XrayLiveDebugConfig,Rv.LoadMetricsReporter,Rv.MiniXrayLoader,Rv.XrayPlaybackController,Rv.XrayTimeIndexedCollectionView,Rv.LiveTeamIconViewModelType,Rv.LiveScorecardColumnViewModelType,Rv.ReceiveMiniXrayModelAction,Rv.XrayBrandingImageModelType,Rv.XrayImageGraphProbabilityPercentageModelType,Rv.XrayPlayerStatisticModelType,Rv.XrayParagraphTextModelType,Rv.XrayTitledImageModelType,Rv.XrayTitledParagraphTextModelType,Rv.XrayPlayerStatisticQuickViewModelType,Rv.XrayTitledEmphasizedTextModelType,Rv.XrayPopUpViewModelStore,Rv.LiveHintableButtonViewModelType,Rv.HintableButtonGravity,Rv.PopUpToggleViewModelType,Rv.ChangeVolumeAction;var Av=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.XrayNavigationParameterType,a=M.get("ExternalLinkNavigationalActionResolver"),s=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ExternalLink"},n}(Lf.Action),n=function(){function e(){}return e.prototype.resolve=function(e){if(!xt.exists(e)||!xt.exists(e.parameters))return null;var t=e.parameters[o.URL]||null;if(null===t)return null;var n=xt.nestedValue(e,"analytics.local.refMarker",null);return new s({url:t,refMarker:n})},e.responder=new Lf.ActionResponder(s.getName(),function(e){if(window.open(e.url),null!==e.refMarker){var t=Rv.XrayInitializationContextAction.store.getValue();if(null===t){var n="Action triggered before init context available";return Rv.XrayInsightClient.getInstance().sendErrorEvent(Rv.XrayInsightErrorType.RUNTIME,n),void a.error(n)}var r={_type:"X-Ray",linkType:"ExternalLink",refMarker:e.refMarker,refMarkerIndex:null,navType:"URL",navValue:e.url,scrollAmount:null};t.metricsFeature.reportInteraction("X-Ray","Navigation",null,r)}else a.warn("No ref marker in link action; cannot report interaction")}),e}();t.ExternalLinkNavigationalActionResolver=n});e(Av);Av.ExternalLinkNavigationalActionResolver;var Ov,Lv,Fv=t(function(e,r){!function(e){var c=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};function s(){this._events={},this._conf&&t.call(this,this._conf)}function t(e){e&&((this._conf=e).delimiter&&(this.delimiter=e.delimiter),e.maxListeners&&(this._events.maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this.newListener=e.newListener),this.wildcard&&(this.listenerTree={}))}function n(e){this._events={},this.newListener=!1,t.call(this,e)}function m(e,t,n,r){if(!n)return[];var i,o,a,s,l,u,c,d=[],p=t.length,f=t[r],h=t[r+1];if(r===p&&n._listeners){if('function'==typeof n._listeners)return e&&e.push(n._listeners),[n];for(i=0,o=n._listeners.length;i<o;i++)e&&e.push(n._listeners[i]);return[n]}if('*'===f||'**'===f||n[f]){if('*'===f){for(a in n)'_listeners'!==a&&n.hasOwnProperty(a)&&(d=d.concat(m(e,t,n[a],r+1)));return d}if('**'===f){for(a in(c=r+1===p||r+2===p&&'*'===h)&&n._listeners&&(d=d.concat(m(e,t,n,p))),n)'_listeners'!==a&&n.hasOwnProperty(a)&&('*'===a||'**'===a?(n[a]._listeners&&!c&&(d=d.concat(m(e,t,n[a],p))),d=d.concat(m(e,t,n[a],r))):d=a===h?d.concat(m(e,t,n[a],r+2)):d.concat(m(e,t,n[a],r)));return d}d=d.concat(m(e,t,n[f],r+1))}if((s=n['*'])&&m(e,t,s,r+1),l=n['**'])if(r<p)for(a in l._listeners&&m(e,t,l,p),l)'_listeners'!==a&&l.hasOwnProperty(a)&&(a===h?m(e,t,l[a],r+2):a===f?m(e,t,l[a],r+1):((u={})[a]=l[a],m(e,t,{'**':u},r+1)));else l._listeners?m(e,t,l,p):l['*']&&l['*']._listeners&&m(e,t,l['*'],p);return d}n.prototype.delimiter='.',n.prototype.setMaxListeners=function(e){this._events||s.call(this),this._events.maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e},n.prototype.event='',n.prototype.once=function(e,t){return this.many(e,1,t),this},n.prototype.many=function(e,t,n){var r=this;if('function'!=typeof n)throw new Error('many only accepts instances of Function');function i(){0==--t&&r.off(e,i),n.apply(this,arguments)}return i._origin=n,this.on(e,i),r},n.prototype.emit=function(){this._events||s.call(this);var e,t=arguments[0];if('newListener'===t&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var n=arguments.length,r=new Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];for(i=0,n=this._all.length;i<n;i++)this.event=t,this._all[i].apply(this,r)}if('error'===t&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(this.wildcard){e=[];var o='string'==typeof t?t.split(this.delimiter):t.slice();m.call(this,e,o,this.listenerTree,0)}else e=this._events[t];if('function'==typeof e){if(this.event=t,1===arguments.length)e.call(this);else if(1<arguments.length)switch(arguments.length){case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,r=new Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];e.apply(this,r)}return!0}if(e){for(n=arguments.length,r=new Array(n-1),i=1;i<n;i++)r[i-1]=arguments[i];var a=e.slice();for(i=0,n=a.length;i<n;i++)this.event=t,a[i].apply(this,r);return 0<a.length||!!this._all}return!!this._all},n.prototype.on=function(e,t){if('function'==typeof e)return this.onAny(e),this;if('function'!=typeof t)throw new Error('on only accepts instances of Function');if(this._events||s.call(this),this.emit('newListener',e,t),this.wildcard)return function(e,t){for(var n=0,r=(e='string'==typeof e?e.split(this.delimiter):e.slice()).length;n+1<r;n++)if('**'===e[n]&&'**'===e[n+1])return;for(var i=this.listenerTree,o=e.shift();o;){if(i[o]||(i[o]={}),i=i[o],0===e.length){if(i._listeners){if('function'==typeof i._listeners)i._listeners=[i._listeners,t];else if(c(i._listeners)&&(i._listeners.push(t),!i._listeners.warned)){var a=10;void 0!==this._events.maxListeners&&(a=this._events.maxListeners),0<a&&i._listeners.length>a&&(i._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",i._listeners.length),console.trace())}}else i._listeners=t;return!0}o=e.shift()}return!0}.call(this,e,t),this;if(this._events[e]){if('function'==typeof this._events[e])this._events[e]=[this._events[e],t];else if(c(this._events[e])&&(this._events[e].push(t),!this._events[e].warned)){var n=10;void 0!==this._events.maxListeners&&(n=this._events.maxListeners),0<n&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}else this._events[e]=t;return this},n.prototype.onAny=function(e){if('function'!=typeof e)throw new Error('onAny only accepts instances of Function');return this._all||(this._all=[]),this._all.push(e),this},n.prototype.addListener=n.prototype.on,n.prototype.off=function(e,t){if('function'!=typeof t)throw new Error('removeListener only takes instances of Function');var n,r=[];if(this.wildcard){var i='string'==typeof e?e.split(this.delimiter):e.slice();r=m.call(this,null,i,this.listenerTree,0)}else{if(!this._events[e])return this;n=this._events[e],r.push({_listeners:n})}for(var o=0;o<r.length;o++){var a=r[o];if(n=a._listeners,c(n)){for(var s=-1,l=0,u=n.length;l<u;l++)if(n[l]===t||n[l].listener&&n[l].listener===t||n[l]._origin&&n[l]._origin===t){s=l;break}if(s<0)continue;return this.wildcard?a._listeners.splice(s,1):this._events[e].splice(s,1),0===n.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e])}return this},n.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&0<this._all.length){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n])return t.splice(n,1),this}else this._all=[];return this},n.prototype.removeListener=n.prototype.off,n.prototype.removeAllListeners=function(e){if(0===arguments.length)return!this._events||s.call(this),this;if(this.wildcard)for(var t='string'==typeof e?e.split(this.delimiter):e.slice(),n=m.call(this,null,t,this.listenerTree,0),r=0;r<n.length;r++){n[r]._listeners=null}else{if(!this._events[e])return this;this._events[e]=null}return this},n.prototype.listeners=function(e){if(this.wildcard){var t=[],n='string'==typeof e?e.split(this.delimiter):e.slice();return m.call(this,t,n,this.listenerTree,0),t}return this._events||s.call(this),this._events[e]||(this._events[e]=[]),c(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},n.prototype.listenersAny=function(){return this._all?this._all:[]},r.EventEmitter2=n}()}),Dv=(Fv.EventEmitter2,S.of("BasicEventEmitter")),Nv={BasicEventEmitter:function(){function e(){this.eventEmitter=new Fv.EventEmitter2}return e.prototype.on=function(e,t){var n=this.getKey(e);this.eventEmitter.on(n,t)},e.prototype.onAny=function(e){this.eventEmitter.onAny(e)},e.prototype.once=function(e,t){var n=this.getKey(e);this.eventEmitter.once(n,t)},e.prototype.many=function(e,t,n){var r=this.getKey(e);this.eventEmitter.many(r,t,n)},e.prototype.off=function(e,t){var n=this.getKey(e);this.eventEmitter.off(n,t)},e.prototype.offAny=function(e){this.eventEmitter.offAny(e)},e.prototype.emit=function(e,t){var n=this.getKey(e),r=void 0!==t?t:e;this.eventEmitter.emit(n,r)},e.prototype.getKey=function(e){return Dv(e,"eventType").exists(),Dv(e.toString,"toString").is.a.function(),e.toString()},e}()},Uv=xt.exists,Bv=S.of("WindowMessageChannel"),Vv=function(){function e(e,t,n,r){void 0===r&&(r=window);var i=this;this.channelId=Bv(e,"channelId").exists(),this.senderOrigin=Bv(t,"senderOrigin").exists(),this.onMessageData=Bv(n,"onMessageData").exists(),this.windowRef=r,this.eventListener=function(e){return i.onMessage(e)},this.windowRef.addEventListener("message",this.eventListener,!1)}return e.prototype.destroy=function(){this.windowRef.removeEventListener("message",this.eventListener)},e.prototype.onMessage=function(e){if(this.senderOrigin===e.origin&&Uv(e.data)){var t=e.data;this.channelId===t.channel&&this.onMessageData(t.payload)}},e}(),jv=fh.UUID,Xv=Nv.BasicEventEmitter,zv=S.of("IframePlayer"),qv="{{stage}}",Wv="{{endpoint}}",Hv="https://"+Wv,Gv="https://"+Wv+"/packages/ATVWebEmbeddablePlayerPage-1.0/"+qv+"/EmbeddablePlayer.html",Kv="{{stage}}",Qv="{{endpoint}}",Yv="https://"+Qv,Jv="https://"+Qv+"/packages/ATVWebXrayReplayPlayerUI-1.0/"+Kv+"/replayPlayer.html",$v={clientId:"d5aac186-d7bc-42e5-9c64-a9203c63a9c7"},Zv=function(){function e(e,t,n,r,i,o){void 0===t&&(t="prod"),void 0===n&&(n="cloudfront.xp-assets.aiv-cdn.net"),void 0===r&&(r=new Xv),void 0===i&&(i=window.document),void 0===o&&(o=Vv);var a=this;this.windowMessageReceiver=null,this.iframe=null,this.onIframeLoad=function(){a.domElement.style.removeProperty("visibility"),a.iframe.removeEventListener("load",a.onIframeLoad)},this.domElement=zv(e,"domElement").exists(),this.pageStage=t,this.pageEndpoint=n,this.eventEmitter=r,this.documentRef=i,this.windowMessageReceiverType=o}return e.prototype.start=function(e){var t=this;zv(e,"iframePlayerConfig").exists();var n=jv.v4(),r=Hv.replace(Wv,this.pageEndpoint);this.windowMessageReceiver=new this.windowMessageReceiverType(n,r,function(e){t.eventEmitter.emit(e.eventType,e.eventPayload)});var i=F.extend({},$v,e,{messageChannelId:n}),o=op(i),a=Gv.replace(qv,this.pageStage).replace(Wv,this.pageEndpoint)+"?"+o;this.onPlayerInitialize(a)},e.prototype.startReplayPlayer=function(e,t,n){var r=this;zv(e,"videoUrl").exists(),zv(t,"marketplaceId").exists();var i=jv.v4(),o=Yv.replace(Qv,this.pageEndpoint);this.windowMessageReceiver=new this.windowMessageReceiverType(i,o,function(e){r.eventEmitter.emit(e.eventType,e.eventPayload)});var a=op({messageChannelId:i,videoUrl:e,marketplaceId:t,initialVolume:n}),s=Jv.replace(Kv,this.pageStage).replace(Qv,this.pageEndpoint)+"?"+a;this.onPlayerInitialize(s)},e.prototype.destroy=function(){null!==this.windowMessageReceiver&&(this.windowMessageReceiver.destroy(),this.iframe.src=null)},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.onPlayerInitialize=function(e){"iframe"===this.domElement.tagName.toLowerCase()?this.iframe=this.domElement:(this.iframe=this.documentRef.createElement("iframe"),this.domElement.appendChild(this.iframe)),this.iframe.style.visibility="hidden",this.iframe.setAttribute("allow","autoplay; encrypted-media"),this.iframe.addEventListener("load",this.onIframeLoad),this.iframe.src=e},e}();(Lv=Ov||(Ov={})).closed="closed",Lv.error="error",Lv.ready="ready",Lv.runtimeError="runtimeError",Lv.userActive="userActive",Lv.userNotActive="userNotActive",Lv.hoverOnControl="hoverOnControl",Lv.hoverOffControl="hoverOffControl",Lv.videoEnded="videoEnded",Lv.buffering="buffering",Lv.playing="playing",Lv.fragmentLoaded="fragmentLoaded",Lv.manifestLoaded="manifestLoaded",Lv.seeking="seeking";var eS,tS=Ov;(eS||(eS={})).Trailer="Trailer";var nS,rS,iS=eS,oS=S.of("WindowMessageChannel"),aS={IframePlayer:Zv,PlayerEvent:tS,VideoType:iS,WindowMessageSender:function(){function e(e,t,n){this.channelId=oS(e,"channelId").exists(),this.targetWindow=oS(t,"targetWindow").exists(),this.targetOrigin=oS(n,"targetOrigin").exists()}return e.prototype.send=function(e){this.targetWindow.postMessage({channel:this.channelId,payload:e},this.targetOrigin)},e}()},sS=aS.IframePlayer,lS=S.of("EmbeddablePlayer"),uS=function(){function e(e,t){void 0===t&&(t=sS),this.playerConfig=lS(e,"playerConfig").exists(),this.iframePlayer=new t(e.domElement,e.pageVersion,e.pageEndpoint)}return e.prototype.start=function(e){lS(e,"contentConfig").exists();var t=F.extend({},F.omit(this.playerConfig,"domElement"),e);this.iframePlayer.start(t)},e.prototype.destroy=function(){this.iframePlayer.destroy()},e.prototype.on=function(e,t){this.iframePlayer.on(e,t)},e.prototype.once=function(e,t){this.iframePlayer.once(e,t)},e.prototype.off=function(e,t){this.iframePlayer.off(e,t)},e}();(rS=nS||(nS={})).closed="closed",rS.error="error";var cS,dS=nS;(cS||(cS={})).Trailer="Trailer";var pS={EmbeddablePlayer:uS,PlayerEvent:dS,VideoType:cS},fS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.EmbeddedVideoViewModelType="embeddedVideoViewModel"});e(fS);fS.EmbeddedVideoViewModelType;var hS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("EmbeddedVideoViewTransformer"),n=function(){function e(){}return e.transform=function(e,t,n){if(void 0===n&&(n=null),!xt.exists(e)){var r="Can't transform null/undefined GTI";return Rv.XrayInsightClient.getInstance().sendErrorEvent(Rv.XrayInsightErrorType.RUNTIME,r),s.error(r),null}if(!xt.exists(t)){r="Can't transform with null/undefined analytics";return Rv.XrayInsightClient.getInstance().sendErrorEvent(Rv.XrayInsightErrorType.RUNTIME,r),s.error(r),null}var i=t.local,o=xt.exists(i)?i.refMarker:null;if(!xt.exists(o)){r="No ref marker present in supplied analytics: "+t+"; can't transform.";return Rv.XrayInsightClient.getInstance().sendErrorEvent(Rv.XrayInsightErrorType.RUNTIME,r),s.error(r),null}var a={titleId:e,clickstreamRefMarker:o,videoType:pS.VideoType.Trailer};return{type:fS.EmbeddedVideoViewModelType,title:n,contentConfig:a,id:Rv.ViewModelIdGenerator.generateDefaultId(fS.EmbeddedVideoViewModelType)}},e}();t.EmbeddedVideoViewTransformer=n});e(hS);hS.EmbeddedVideoViewTransformer;var mS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.transform=function(e,t,n){void 0===n&&(n=null);var r=hS.EmbeddedVideoViewTransformer.transform(e,t,n);return null===r?null:{body:r,className:"videoModal"}},e}();t.VideoModalTransformer=n});e(mS);mS.VideoModalTransformer;var yS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.avod.xray.XrayNavigationParameterType,n=function(){function e(){}return e.prototype.resolve=function(e){if(!xt.exists(e))return null;var t=e.parameters||null;if(F.has(t,r.GTI)){var n=mS.VideoModalTransformer.transform(t[r.GTI],e.analytics,e.text);return null===n?null:new Rv.ShowXrayModalAction(n)}return null},e}();t.EmbeddedVideoNavigationalActionResolver=n});e(yS);yS.EmbeddedVideoNavigationalActionResolver;var gS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.XrayTabLinkItemModelType="XrayTabLinkItem"});e(gS);gS.XrayTabLinkItemModelType;var vS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.atv.discovery.LinkActionType,a=M.get("XrayTabLinkSwiftDataTransformer"),n=function(){function e(){}return e.prototype.convertSwiftItemToViewModel=function(e){var t=Rv.textModelFromTextMap(e.textMap),n=Rv.XraySwiftUtils.navigationalActionFromLinkActionMap(e.linkActionMap,o.PRIMARY),r=Rv.SwiftLinkActionResolver.getActionFromNavigationalAction(n);if(!xt.exists(r))return a.warn("Can not create a XrayTabLinkItemModel without a valid link action"),null;var i=t.primaryText;return xt.exists(i)?{type:gS.XrayTabLinkItemModelType,linkAction:r,textMap:t,id:e.id}:(a.warn("Can not create a XrayTabLinkItemModel without primaryText"),null)},e}();t.XrayTabLinkSwiftDataTransformer=n});e(vS);vS.XrayTabLinkSwiftDataTransformer;var SS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.CollapsibleListViewModelType="collapsibleListViewModel"});e(SS);SS.CollapsibleListViewModelType;var bS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=S.of("CollapsibleListCollectionTransformer"),r=function(){function e(e){this.collectionTransformer=n(e,"collectionTransformer").exists()}return e.prototype.transform=function(e){return{type:SS.CollapsibleListViewModelType,quickViewList:this.collectionTransformer.transform(e),id:Rv.ViewModelIdGenerator.generateDefaultId(SS.CollapsibleListViewModelType,e.id)}},e}();t.CollapsibleListCollectionTransformer=r});e(bS);bS.CollapsibleListCollectionTransformer;var TS=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.BlueprintIds,n=function(t){function n(){var e;return t.call(this,((e={})[o.COLLAPSIBLE_VERTICAL_LIST]=n.createCollapsibleVerticalListTransformer(),e))||this}return i(n,t),n.createCollapsibleVerticalListTransformer=function(){var e={};e[o.XRAY_TAB_LINK_ITEM]=new vS.XrayTabLinkSwiftDataTransformer;var t=new Rv.CollectionV2ViewModelTransformer({itemListTransformer:new Rv.ItemListTransformer(e),collectionStyle:Rv.CollectionStyle.COLLAPSIBLE_LIST});return new bS.CollapsibleListCollectionTransformer(t)},n}(Rv.BlueprintAwareWidgetTransformer);t.WebCollectionV2Transformer=n});e(TS);TS.WebCollectionV2Transformer;var PS=t(function(e){!function(){var a={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var r=typeof n;if('string'===r||'number'===r)e.push(n);else if(Array.isArray(n)&&n.length){var i=s.apply(null,n);i&&e.push(i)}else if('object'===r)for(var o in n)a.call(n,o)&&n[o]&&e.push(o)}}return e.join(' ')}e.exports?(s.default=s,e.exports=s):window.classNames=s}()}),wS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PrimaryColor="#fff",t.SecondaryColor="#ddd",t.TextColor="#bbb",t.LinkColor="#4cd2ff",t.LinkHoverColor="#94e2fc"});e(wS);wS.PrimaryColor,wS.SecondaryColor,wS.TextColor,wS.LinkColor,wS.LinkHoverColor;var CS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SMALL_SCREEN_BREAKPOINT=480,t.MEDIUM_SCREEN_BREAKPOINT=640,t.LARGE_SCREEN_BREAKPOINT=1200,t.EXTRA_LARGE_SCREEN_BREAKPOINT=1921});e(CS);CS.SMALL_SCREEN_BREAKPOINT,CS.MEDIUM_SCREEN_BREAKPOINT,CS.LARGE_SCREEN_BREAKPOINT,CS.EXTRA_LARGE_SCREEN_BREAKPOINT;var MS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=100/CS.LARGE_SCREEN_BREAKPOINT;t.CalculateVw=function(e){return e*n+"vw"}});e(MS);MS.CalculateVw;var IS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.debugClassName=function(e,t){return null==e||0===e.length?t:e+"-"+t}});e(IS);IS.debugClassName;var ES=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.styler=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,i=e;r<i.length;r++){var o=i[r];Array.isArray(o)?n=n.concat(o):"string"==typeof o?n.push(o):n.push(Vd.style(o))}return Vd.classes.apply(void 0,n)},t.getAssembledCSS=Vd.getStyles});e(ES);ES.styler,ES.getAssembledCSS;var _S=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Vd.keyframes({from:{opacity:0,transform:"scale(0.95)"},to:{opacity:1,transform:"scale(1)"}});t.scaleUpAndInTransition=ES.styler({animationName:n,animationDuration:"200ms",animationTimingFunction:"ease",animationFillMode:"both"}),t.scaleDownAndOut=Vd.keyframes({from:{opacity:100,transform:"scale(1.0)"},to:{opacity:0,transform:"scale(0.95)"}}),t.scaleDownAndOutTransition=ES.styler({animationName:t.scaleDownAndOut,animationDuration:"200ms",animationTimingFunction:"ease",animationFillMode:"both"}),t.slideFromTop=Vd.keyframes({from:{transform:"translateY(-100%)",opacity:0}}),t.slideToTop=Vd.keyframes({to:{transform:"translateY(-100%)",opacity:0}}),t.slideFromTopTransition=ES.styler({animationName:t.slideFromTop,animationDuration:"700ms",animationTimingFunction:"ease",animationFillMode:"both"})});e(_S);_S.scaleUpAndInTransition,_S.scaleDownAndOut,_S.scaleDownAndOutTransition,_S.slideFromTop,_S.slideToTop,_S.slideFromTopTransition;var xS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayNone=ES.styler({display:"none"}),t.DisplayBlock=ES.styler({display:"block"}),t.Width100Percent=ES.styler({width:"100%"}),t.Height100Percent=ES.styler({height:"100%"}),t.RTLStyle=function(e){return{"html[dir=rtl] &":e}}});e(xS);xS.DisplayNone,xS.DisplayBlock,xS.Width100Percent,xS.Height100Percent,xS.RTLStyle;var kS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SmallScreen=function(e){return Vd.media({minWidth:CS.SMALL_SCREEN_BREAKPOINT},e)},t.MediumScreen=function(e){return Vd.media({minWidth:CS.MEDIUM_SCREEN_BREAKPOINT},e)},t.LargeScreen=function(e){return Vd.media({minWidth:CS.LARGE_SCREEN_BREAKPOINT},e)},t.ExtraLargeScreen=function(e){return Vd.media({minWidth:CS.EXTRA_LARGE_SCREEN_BREAKPOINT},e)}});e(kS);kS.SmallScreen,kS.MediumScreen,kS.LargeScreen,kS.ExtraLargeScreen;var RS=t(function(e,t){var s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ScaleProperty=function(e,t,n){var r,i;void 0===n&&(n=!1);var o=n?" !important":"";return Vd.style(Vd.media({minWidth:0,maxWidth:CS.LARGE_SCREEN_BREAKPOINT-1},((r={})[e]=t+"px"+o,r)),kS.LargeScreen(((i={})[e]=""+MS.CalculateVw(t)+o,i)))},t.ScaleNestedProperty=function(e,t,n){var r,i;void 0===n&&(n=!1);var o=Vd.media({minWidth:0,maxWidth:CS.LARGE_SCREEN_BREAKPOINT-1},((r={})[e]=t+"px"+(n?" !important":""),r)),a=kS.LargeScreen(((i={})[e]=MS.CalculateVw(t),i));return{$nest:s({},o.$nest,a.$nest)}}});e(RS);RS.ScaleProperty,RS.ScaleNestedProperty;var AS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ScalableFontSize=function(e){return RS.ScaleProperty("font-size",e)},t.ScalableLineHeight=function(e){return RS.ScaleProperty("line-height",e)}});e(AS);AS.ScalableFontSize,AS.ScalableLineHeight;var OS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="\"Amazon Ember 2\", Helvetica, sans-serif";t.FontLight={fontFamily:"\"Amazon Ember Thin\", Helvetica, sans-serif",fontWeight:"normal","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"},t.FontNormal={fontFamily:n,fontWeight:"normal","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"},t.FontBold={fontFamily:n,fontWeight:"bold","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale"},t.FontWeightLight=ES.styler(t.FontLight),t.FontWeightNormal=ES.styler(t.FontNormal),t.FontWeightBold=ES.styler(t.FontBold),t.FontL03=AS.ScalableFontSize(40),t.FontL04=AS.ScalableFontSize(32),t.FontL05=AS.ScalableFontSize(28),t.FontL06=AS.ScalableFontSize(26),t.FontL07=AS.ScalableFontSize(24),t.FontL08=AS.ScalableFontSize(22),t.FontL10=AS.ScalableFontSize(18),t.FontL12=AS.ScalableFontSize(14),t.FontL13=AS.ScalableFontSize(12),t.FontL14=AS.ScalableFontSize(10),t.FontTitle=ES.styler(t.FontL03,t.FontLight),t.FontBody=ES.styler(t.FontL10,t.FontNormal)});e(OS);OS.FontLight,OS.FontNormal,OS.FontBold,OS.FontWeightLight,OS.FontWeightNormal,OS.FontWeightBold,OS.FontL03,OS.FontL04,OS.FontL05,OS.FontL06,OS.FontL07,OS.FontL08,OS.FontL10,OS.FontL12,OS.FontL13,OS.FontL14,OS.FontTitle,OS.FontBody;var LS=t(function(e,t){function P(e){return e.map(function(e){return e+"px"}).join(" ")}function w(e,t,n,r){if(t-e==1)return P(n);for(var i,o,a,s,l,u=[],c=0;c<n.length;c++){var d=n[c],p=r[c],f=(a=e,s=parseInt(d),l=t,(parseInt(p)-s)/(l-a)),h=(i=f,o=e,parseInt(d)-i*o),m=void 0;m=0===f?h+"px":0===h?100*f+"vw":"calc("+100*f+"vw + "+h+"px)",u.push(m)}return u.join(" ")}Object.defineProperty(t,"__esModule",{value:!0}),t.BreakpointSizes=function(e,t,n,r){var i,o,a;void 0===n&&(n=!0),void 0===r&&(r=!1);var s=Object.keys(t),l=s.map(function(e){return t[e]}),u={0:P(l[0].split(" "))};if(n)for(var c=0;c<s.length;c++){var d=s[c],p=xt.withDefault(s[c+1],d),f=l[c],h=xt.withDefault(l[c+1],f),m=w(parseInt(d),parseInt(p),f.split(" "),h.split(" "));F.extend(u,((i={})[d]=m,i))}else for(c=0;c<s.length;c++){var y=s[c],g=P(l[c].split(" "));F.extend(u,((o={})[y]=g,o))}var v,S,b=s[s.length-1],T=l[l.length-1];return r?v=P(T.split(" ")):(S=parseInt(b),v=T.split(" ").map(function(e){return 100*parseInt(e)/S+"vw"}).join(" ")),F.extend(u,((a={})[b]=v,a)),function(e,t){for(var n,r,i=[],o="",a=0,s=Object.keys(t);a<s.length;a++){var l=s[a],u=t[l],c=parseInt(l);u!==o&&(0===c?i.push(((n={})[e]=u,n)):i.push(Vd.media({minWidth:c+"px"},((r={})[e]=u,r))),o=u)}return ES.styler.apply(void 0,i)}(e,u)}});e(LS);LS.BreakpointSizes;var FS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ScalableHeight=function(e){return RS.ScaleProperty("height",e)},t.ScalableWidth=function(e){return RS.ScaleProperty("width",e)},t.ScalableMinHeight=function(e){return RS.ScaleProperty("min-height",e)},t.ScalableMinWidth=function(e){return RS.ScaleProperty("min-width",e)},t.ScalableMaxWidth=function(e){return RS.ScaleProperty("max-width",e)},t.ScalableMaxHeight=function(e){return RS.ScaleProperty("max-height",e)}});e(FS);FS.ScalableHeight,FS.ScalableWidth,FS.ScalableMinHeight,FS.ScalableMinWidth,FS.ScalableMaxWidth,FS.ScalableMaxHeight;var DS=t(function(e,t){function a(e){return RS.ScaleProperty("margin-top",e)}function s(e){return RS.ScaleProperty("margin-bottom",e)}function l(e){return RS.ScaleProperty("margin-right",e)}function u(e){return RS.ScaleProperty("margin-left",e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ScalableMarginTop=a,t.ScalableMarginBottom=s,t.ScalableMarginRight=l,t.ScalableMarginLeft=u,t.ScalableMargin=function(e,t,n,r){var i=void 0===n,o=void 0===r;if(void 0===t&&i&&o)return RS.ScaleProperty("margin",e);if(i&&o)return[a(e),s(e),u(t),l(t)];if(o)throw new Error("ScalableMargin requires 1, 2, or 4 parameters");return[a(e),s(n),u(r),l(t)]}});e(DS);DS.ScalableMarginTop,DS.ScalableMarginBottom,DS.ScalableMarginRight,DS.ScalableMarginLeft,DS.ScalableMargin;var NS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ScalableBottom=function(e){return RS.ScaleProperty("bottom",e)},t.ScalableTop=function(e){return RS.ScaleProperty("top",e)},t.ScalableRight=function(e){return RS.ScaleProperty("right",e)},t.ScalableLeft=function(e){return RS.ScaleProperty("left",e)}});e(NS);NS.ScalableBottom,NS.ScalableTop,NS.ScalableRight,NS.ScalableLeft;var US=t(function(e,t){function a(e){return RS.ScaleProperty("padding-top",e)}function s(e){return RS.ScaleProperty("padding-bottom",e)}function l(e){return RS.ScaleProperty("padding-right",e)}function u(e){return RS.ScaleProperty("padding-left",e)}Object.defineProperty(t,"__esModule",{value:!0}),t.ScalablePaddingTop=a,t.ScalablePaddingBottom=s,t.ScalablePaddingRight=l,t.ScalablePaddingLeft=u,t.ScalablePadding=function(e,t,n,r){var i=void 0===n,o=void 0===r;if(void 0===t&&i&&o)return RS.ScaleProperty("padding",e);if(i&&o)return[a(e),s(e),u(t),l(t)];if(o)throw new Error("ScalablePadding requires 1, 2, or 4 parameters");return[a(e),s(n),u(r),l(t)]}});e(US);US.ScalablePaddingTop,US.ScalablePaddingBottom,US.ScalablePaddingRight,US.ScalablePaddingLeft,US.ScalablePadding;var BS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",VS={encode:function(e){var t=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);return VS.encodeString(String.fromCharCode.apply(null,t))},decode:function(e){return new Uint8Array(VS.decodeString(e).split("").map(function(e){return e.charCodeAt(0)}))},encodeString:function(e){for(var t=[],n=0;n<e.length;){var r=e.charCodeAt(n++),i=e.charCodeAt(n++),o=e.charCodeAt(n++),a=r>>2,s=(3&r)<<4|i>>4,l=(15&i)<<2|o>>6,u=63&o;isNaN(i)?l=u=64:isNaN(o)&&(u=64),t.push(BS.charAt(a)),t.push(BS.charAt(s)),t.push(BS.charAt(l)),t.push(BS.charAt(u))}return t.join("")},decodeString:function(e){var t=[];e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var n=0;n<e.length;){var r=BS.indexOf(e.charAt(n++)),i=BS.indexOf(e.charAt(n++)),o=BS.indexOf(e.charAt(n++)),a=BS.indexOf(e.charAt(n++)),s=r<<2|i>>4,l=(15&i)<<4|o>>2,u=(3&o)<<6|a;t.push(String.fromCharCode(s)),64!==o&&t.push(String.fromCharCode(l)),64!==a&&t.push(String.fromCharCode(u))}return t.join("")}},jS=VS,XS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return"data:image/svg+xml;base64,"+jS.encodeString(e)},r=function(){function e(){}return e.ScrollbarThumbHorizontal=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\"><rect fill=\"#ccc\" fill-opacity=\".7\" y=\"5\" width=\"15\" height=\"5\" rx=\"2.5\" ry=\"2.5\"/></svg>"),e.ScrollbarThumbHorizontalOver=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\"><rect fill=\"#fff\" y=\"5\" width=\"15\" height=\"5\" rx=\"2.5\" ry=\"2.5\"/></svg>"),e.ScrollbarThumbVertical=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\"><rect fill=\"#ccc\" fill-opacity=\".7\" x=\"5\" width=\"5\" height=\"15\" rx=\"2.5\" ry=\"2.5\"/></svg>"),e.ScrollbarThumbVerticalOver=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\"><rect fill=\"#fff\" x=\"5\" width=\"5\" height=\"15\" rx=\"2.5\" ry=\"2.5\"/></svg>"),e}();t.SVG=r});e(XS);XS.SVG;var zS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ES.styler({overflow:"auto","-ms-overflow-style":"-ms-autohiding-scrollbar",scrollbarWidth:"thin",scrollbarColor:"transparent transparent",$nest:{"&:hover":{scrollbarWidth:"thin",scrollbarColor:"#fff transparent"},"&::-webkit-scrollbar":{width:15},"&::-webkit-scrollbar-button":{display:"none"},"&::-webkit-scrollbar-track":{display:"none"},"&::-webkit-scrollbar-thumb":{boxSizing:"border-box",background:"transparent",borderImageSlice:"5 fill",borderImageWidth:5,display:"none"},"&:hover::-webkit-scrollbar-thumb":{display:"block"},"&::-webkit-scrollbar-thumb:vertical":{borderImageSource:"url("+XS.SVG.ScrollbarThumbVertical+")"},"&::-webkit-scrollbar-thumb:vertical:hover":{borderImageSource:"url("+XS.SVG.ScrollbarThumbVerticalOver+")"},"&::-webkit-scrollbar-thumb:horizontal":{borderImageSource:"url("+XS.SVG.ScrollbarThumbHorizontal+")"},"&::-webkit-scrollbar-thumb:horizontal:hover":{borderImageSource:"url("+XS.SVG.ScrollbarThumbHorizontalOver+")"}}});t.BaseScrollableStyle=n;var r=ES.styler(n,{touchAction:"pan-y",$nest:{"& *":{touchAction:"pan-y"}}});t.ScrollableVertical=r;var i=ES.styler(n,{touchAction:"pan-x",$nest:{"& *":{touchAction:"pan-x"}}});t.ScrollableHorizontal=i;var o=ES.styler(n,{touchAction:"pan-x pan-y",$nest:{"& *":{touchAction:"pan-x pan-y"}}});t.ScrollableUniversal=o});e(zS);zS.BaseScrollableStyle,zS.ScrollableVertical,zS.ScrollableHorizontal,zS.ScrollableUniversal;var qS=t(function(e,n){function t(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}Object.defineProperty(n,"__esModule",{value:!0}),t(wS),t(MS),t(IS),t(_S),t(xS),t(OS),t(LS),t(kS),t(FS),t(DS),t(NS),t(US),t(AS),t(RS),t(zS),t(ES)});e(qS);var WS=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return i(s,e),s.prototype.render=function(){var e=this.props.viewModel||null,t=!1;if(null===e)return null;var n=new Rv.LoadTimeTracker;n.setOnLoadListener(this.props.loadListener);for(var r=[],i=0;i<e.items.length;i++){var o=e.items[i];r.push(this.props.viewModelRenderer.renderViewModel(o,n.registerId(i),this.props.isShowing,this.props.selectionDataMap,{key:o.id})),o.type===Rv.XraySelectableNavigationsType&&(t=!0)}n.lock();var a=s.STYLE_CLASS_NAME_MAP[e.style];return Vn.createElement("div",{className:t?"widgetGroupView teamsTab":PS("widgetGroupView",a,qS.BaseScrollableStyle)},r)},s.STYLE_CLASS_NAME_MAP=((n={})[Rv.WidgetGroupStyle.VERTICALLY_SCROLLABLE]=""+qS.ScrollableVertical,n[Rv.WidgetGroupStyle.VERTICAL]="vertical",n[Rv.WidgetGroupStyle.HORIZONTAL]="horizontal",n[Rv.WidgetGroupStyle.DETAIL_TITLE_CONTAINER]="detailViewNameItem narrow",n[Rv.WidgetGroupStyle.DETAIL_INFO_CONTAINER]="xrayDetailViewItem split",n[Rv.WidgetGroupStyle.QUICKVIEW_CONTAINER]="quickViewContainer",n[Rv.WidgetGroupStyle.XRAY_TAB]="tabViewModelContainer",n[Rv.WidgetGroupStyle.XRAY_TAB_BAR]="xrayTabBar",n[Rv.WidgetGroupStyle.XRAY_MATERIAL_TAB_BAR]="xrayMaterialTabBar",n),s}(Rv.XrayViewModelComponent);t.WidgetGroupView=o});e(WS);WS.WidgetGroupView;var HS=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function s(){return null!==e&&e.apply(this,arguments)||this}return i(s,e),s.prototype.render=function(){var e=this.props.viewModel||null;if(null===e)return null;var t=new Rv.LoadTimeTracker;t.setOnLoadListener(this.props.loadListener);for(var n=[],r=0;r<e.textModels.length;r++){var i=e.textModels[r];n.push(this.props.viewModelRenderer.renderViewModel(i,t.registerId(r),this.props.isShowing,this.props.selectionDataMap,{key:r}))}var o=e.label?this.props.viewModelRenderer.renderViewModel(e.label,t.registerId(n.length),this.props.isShowing,this.props.selectionDataMap):null;t.lock();var a=s.STYLE_CLASS_NAME_MAP[e.style];return Vn.createElement("div",{className:a},o,n)},s.STYLE_CLASS_NAME_MAP=((n={})[Rv.TextCollectionStyle.CONTAINER]="",n[Rv.TextCollectionStyle.PARAGRAPH_TEXT]="detailInfoItem xrayDetailViewItem",n[Rv.TextCollectionStyle.LABELLED_COLLECTION]="detailKnownForItem show detailInfoItem",n),s}(Rv.XrayViewModelComponent);t.TextCollectionView=o});e(HS);HS.TextCollectionView;var GS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.XRAY_QUICK_VIEW_LIST_EXPANDED="xray_quick_view_list_expanded",e}();t.XrayStorageKeys=n});e(GS);GS.XrayStorageKeys;var KS=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=new Ce.LocalStorage,a=function(t){function n(e){return t.call(this,n.getName(),e)||this}return i(n,t),n.getName=function(){return"Xray.ToggleQuickViewList"},n.getInitialValue=function(){var e=o.get(GS.XrayStorageKeys.XRAY_QUICK_VIEW_LIST_EXPANDED);return null===e||"true"===e},n.store=new Lf.ActionStore(n.getName(),n.getInitialValue()),n}(Lf.Action);(t.ToggleQuickViewListAction=a).store.onChange(function(){var e=a.store.getValue();o.set(GS.XrayStorageKeys.XRAY_QUICK_VIEW_LIST_EXPANDED,e.toString());var t=e?Rv.XrayRefMarkers.QUICKVIEW_EXPAND:Rv.XrayRefMarkers.QUICKVIEW_COLLAPSE,n=Rv.XrayRefMarkers.plr_LVL1+Rv.XrayRefMarkers.PLAYER_BUTTONS_LVL2+t,r=Rv.XrayInitializationContextAction.store.getValue();if(null!==r){var i={_type:"X-Ray",linkType:"Local",refMarker:n,refMarkerIndex:null,navType:null,navValue:null,scrollAmount:null};r.metricsFeature.reportInteraction("X-Ray","Navigation",null,i)}})});e(KS);KS.ToggleQuickViewListAction;var QS=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=S.of("LocalizationStoreAdapter"),r=function(){function e(e){var t=this;this.onLanguageChanged=function(){t.dispatchLocalizationStore()},this.localizationStore=n(e,"localizationStore").exists()}return e.prototype.initialize=function(e){this.dispatcher=e,this.dispatchLocalizationStore(),this.localizationStore.onLanguageChanged(this.onLanguageChanged)},e.prototype.getCurrentLocalization=function(){return this.localization},e.prototype.destroy=function(){this.localizationStore.offLanguageChanged(this.onLanguageChanged)},e.prototype.dispatchLocalizationStore=function(){var e=this.localizationStore.getLocalization(),t={currentLocale:this.localizationStore.getCurrentLanguage(),localizedStrings:e?e.xray:{close:null,exitFullscreen:null,fullscreen:null,navbar:{logo:null},photoGallery:{count:null,exit:null},textViewSeeLess:null,textViewSeeMore:null}};this.localization=t,this.dispatcher.dispatch(new Rv.ReceiveLocalizationAction(t))},e}();t.LocalizationStoreAdapter=r});e(QS);QS.LocalizationStoreAdapter;var YS=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=PS(i,this.props.className);return Vn.createElement("img",{className:e,src:this.props.src,alt:xt.withDefault(this.props.alt,"")})},t}(Vn.PureComponent);t.SVGImage=o});e(YS);YS.SVGImage;var JS=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({cursor:"pointer",display:"inline-block",userSelect:"none","-webkit-appearance":"none",boxSizing:"border-box",border:"none",backgroundColor:"#ccc",color:"#222",fontWeight:"normal",fontFamily:"inherit",textAlign:"center",boxShadow:"inset 0px 4px 0px -3px rgba(255, 255, 255, 0.3), 0px 1px 2px 0px rgba(0, 0, 0, 0.5)",borderRadius:"4px",$nest:{"&:not(.disabled):hover":{backgroundColor:qS.PrimaryColor},"&.disabled":{opacity:.1,cursor:"default"}}},qS.ScalableFontSize(17),qS.ScalableHeight(41),qS.ScalableLineHeight(41),qS.ScalableMinWidth(140),qS.ScalablePadding(0,10)),o=qS.styler({}),a=qS.styler({}),s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){"function"!=typeof t.props.onClick||t.props.disabled||t.props.onClick(e)},t}return n(t,e),t.prototype.render=function(){var e=null!=this.props.icon,t=PS(i,this.props.className,{disabled:this.props.disabled},e?o:null);return Vn.createElement("button",{className:t,"aria-label":this.props.ariaLabel,onClick:this.onClick,onPointerUp:this.props.onPointerUp,onPointerDown:this.props.onPointerDown,onTouchStart:this.props.onTouchStart,onTouchEnd:this.props.onTouchEnd,onKeyDown:this.props.onKeyDown,style:this.props.style},e?Vn.createElement("div",{className:a},Vn.createElement(YS.SVGImage,{className:this.props.iconClassName,src:this.props.icon})):null,this.props.children)},t.defaultProps={disabled:!1,className:null,icon:null,onClick:null,style:null},t}(Vn.PureComponent);t.Button=s});e(JS);JS.Button;var $S=S.of("Arrays"),ZS=function(){function t(){}return t.binarySearchIndexOf=function(e,t){return this.binarySearch(e,t,!1)},t.binarySearchIndexOfClosestBelow=function(e,t){return this.binarySearch(e,t,!0)},t.binarySearch=function(e,t,n){$S(e,"array").exists(),$S(t,"compare").exists();for(var r,i,o=0,a=e.length-1;o<=a;){if(0===(i=t(e[r=Math.floor((a+o)/2)])))return r;i<0?a=r-1:o=r+1}return n?Math.max(a,0):-1},t.indexOfMinimum=function(e,t){$S(e,"array").exists(),$S(0<e.length,"length > 0").is.true(),$S(t,"compare").exists();for(var n=0,r=e[0],i=1;i<e.length;++i)t(e[i],r)<0&&(r=e[i],n=i);return n},t.indexOfMaximum=function(e,n){return $S(e,"array").exists(),$S(0<e.length,"length > 0").is.true(),$S(n,"compare").exists(),t.indexOfMinimum(e,function(e,t){return-1*n(e,t)})},t}(),eb={encode:function(e){var t=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);return eb.encodeString(String.fromCharCode.apply(null,t))},decode:function(e){return new Uint8Array(eb.decodeString(e).split("").map(function(e){return e.charCodeAt(0)}))},encodeString:function(e){return btoa(e)},decodeString:function(e){return atob(e)}},tb=eb,nb=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return"data:image/svg+xml;base64,"+tb.encodeString(e)},r=function(){function e(){}return e.CheckMark=n("<svg width=\"19\" height=\"15\" viewBox=\"0 0 19 15\" xmlns=\"http://www.w3.org/2000/svg\"><title>Rectangle 50 + Rectangle 50 Copy</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M2.121 6l6.364 6.364-2.121 2.122L0 8.122z\"/><path d=\"M18.728 2.121L7.12 13.728 5 11.607 16.607 0l2.12 2.121z\"/></g></svg>"),e.Close=n("<svg width=\"25\" height=\"25\" viewBox=\"0 0 25 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>close</title><path d=\"M24.805 2.318L22.682.197 12.5 10.379 2.318.197.197 2.318 10.379 12.5.197 22.682l2.121 2.121L12.5 14.621l10.182 10.182 2.121-2.121L14.621 12.5 24.805 2.318z\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),e.Fullscreen=n("<svg width=\"25\" height=\"25\" viewBox=\"0 0 25 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>fullscreen</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M24.969.002V0h-3v.002l-6-.002v3h3.754l-5.871 5.871 2.121 2.121 5.996-5.996V9h3V.002zM9 22H5.246l5.871-5.871-2.121-2.121L3 20.004V16H0v9h9v-3z\"/></g></svg>"),e.ExitFullscreen=n("<svg width=\"29\" height=\"27\" viewBox=\"0 0 29 27\" xmlns=\"http://www.w3.org/2000/svg\"><title>browser copy</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M9.984 15h-6l.001 3h3.753L.867 24.871l2.122 2.121 6.995-6.996V24h3v-8.999l-3-.001zM21.262 9l6.871-6.871L26.012.008l-6.996 6.996V3h-3v8.999l3 .001h6V9h-3.754z\"/></g></svg>"),e.HD=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"36.859\" height=\"20\" viewBox=\"0 -3 36.859 20\"><g fill=\"#FFF\"><path d=\"M16 17V-3h-4v8H4v-8H0v20h4V9h8v8h4zM27.625 17c2.938 0 5.203-.875 6.828-2.625 1.609-1.75 2.422-4.219 2.422-7.438s-.812-5.609-2.422-7.344C32.828-2.125 30.531-3 27.547-3H20v20h7.625zm-.891-17C30.234 0 33 2.391 33 6.641v.953C33 11.875 30.25 14 26.75 14H24V0h2.734z\"/></g></svg>"),e.HDDisabled=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"36.859\" height=\"20\" viewBox=\"0 -3 36.859 20\"><g opacity=\".25\"><path d=\"M16 17V-3h-4v8H4v-8H0v20h4V9h8v8h4zM27.625 17c2.938 0 5.203-.875 6.828-2.625 1.609-1.75 2.422-4.219 2.422-7.438s-.812-5.609-2.422-7.344C32.828-2.125 30.531-3 27.547-3H20v20h7.625zm-.891-17C30.234 0 33 2.391 33 6.641v.953C33 11.875 30.25 14 26.75 14H24V0h2.734z\"/></g></svg>"),e.HDSupported=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"36.859\" height=\"20\" viewBox=\"0 -3 36.859 20\"><g opacity=\".25\" fill=\"#fff\"><path d=\"M16 17V-3h-4v8H4v-8H0v20h4V9h8v8h4zM27.625 17c2.938 0 5.203-.875 6.828-2.625 1.609-1.75 2.422-4.219 2.422-7.438s-.812-5.609-2.422-7.344C32.828-2.125 30.531-3 27.547-3H20v20h7.625zm-.891-17C30.234 0 33 2.391 33 6.641v.953C33 11.875 30.25 14 26.75 14H24V0h2.734z\"/></g></svg>"),e.LoadingSpinner=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"130\" height=\"130\" viewBox=\"0 0 130 130\"><path fill=\"#FFF\" d=\"M65 127C30.758 127 3 99.241 3 65S30.758 3 65 3V0C29.102 0 0 29.102 0 65s29.102 65 65 65v-3z\"/><linearGradient id=\"a\" gradientUnits=\"userSpaceOnUse\" x1=\"97.5\" y1=\"130\" x2=\"97.5\"><stop offset=\"0\" stop-color=\"#fff\"/><stop offset=\".841\" stop-color=\"#fff\" stop-opacity=\"0\"/></linearGradient><path fill=\"url(#a)\" d=\"M65 127c34.242 0 62-27.759 62-62S99.242 3 65 3V0c35.898 0 65 29.102 65 65s-29.102 65-65 65v-3z\"/><circle fill=\"#FFF\" cx=\"65\" cy=\"1.5\" r=\"1.5\"/></svg>"),e.ModalCloseOver=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 15 15\"><path opacity=\".8\" fill=\"#FFF\" d=\"M15 1.293L13.706 0 7.5 6.207 1.292 0 0 1.293 6.207 7.5 0 13.705l1.292 1.293L7.5 8.793l6.207 6.205L15 13.705 8.792 7.5 15 1.293z\"/></svg>"),e.ModalCloseUp=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 15 15\"><path opacity=\".8\" fill=\"#CDCCCC\" d=\"M15 1.293L13.706 0 7.5 6.207 1.292 0 0 1.293 6.207 7.5 0 13.705l1.292 1.293L7.5 8.793l6.207 6.205L15 13.705 8.792 7.5 15 1.293z\"/></svg>"),e.BackArrow=n("<svg width=\"11\" height=\"17\" viewBox=\"0 0 11 17\" xmlns=\"http://www.w3.org/2000/svg\"><title>Artboard 16</title><path d=\"M2.632 10l6.53 6 1.069-.9-7.272-6.6 7.183-6.6-.98-.9-6.53 6L1 8.5 2.632 10z\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),e.RateYourExperienceIcon=n("<svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>emoji-good-up</title><defs><circle id=\"a\" cx=\"24\" cy=\"24\" r=\"24\"/><mask id=\"b\" x=\"0\" y=\"0\" width=\"48\" height=\"48\" fill=\"#fff\"><use xlink:href=\"#a\"/></mask></defs><g fill=\"none\" fill-rule=\"evenodd\"><use stroke=\"#F9F9F9\" mask=\"url(#b)\" stroke-width=\"4\" xlink:href=\"#a\"/><path d=\"M34.603 33.477C31.772 36.284 28.006 37.83 24 37.83c-4.005 0-7.77-1.545-10.602-4.352a1.162 1.162 0 0 0-1.631 0 1.134 1.134 0 0 0 0 1.616c3.267 3.238 7.612 5.022 12.233 5.022 4.622 0 8.966-1.784 12.234-5.022.45-.446.45-1.169 0-1.616a1.162 1.162 0 0 0-1.63 0\" fill=\"#FFF\"/><g transform=\"translate(13.714 17.143)\" fill=\"#FFF\"><circle cx=\"18.286\" cy=\"2.286\" r=\"2.286\"/><circle cx=\"2.286\" cy=\"2.286\" r=\"2.286\"/></g></g></svg>"),e}();t.SVG=r});e(nb);nb.SVG;var rb=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=qS.styler({position:"absolute",cursor:"default",pointerEvents:"none",$nest:{"&:hover":{visibility:"hidden"}}}),s=qS.styler({cursor:"pointer",display:"inline-block",position:"relative",$nest:o((n={"&:not(:first-child)":qS.ScaleNestedProperty("margin-left",19)},n["&:not(:hover) ."+a]={visibility:"hidden"},n),qS.RTLStyle({$nest:{"&:not(:first-child)":o({marginLeft:"0px"},qS.ScaleNestedProperty("margin-right",19))}}))}),l=qS.styler({display:"block",cursor:"pointer",backgroundSize:"100% 100%",backgroundColor:"transparent",boxShadow:"none",shapeRendering:"crispEdges",$nest:{"&:not(.disabled):hover":{backgroundColor:"transparent"}}},qS.ScalableHeight(18),qS.ScalableWidth(18)),u=qS.styler({color:qS.PrimaryColor,fontWeight:"normal",textAlign:"left",whiteSpace:"nowrap",marginLeft:"-50%",$nest:o({},qS.RTLStyle(o({textAlign:"right",marginLeft:"auto",marginRight:"-50%",paddingLeft:"0px"},qS.ScaleNestedProperty("padding-right",17))))},qS.ScalableFontSize(13),qS.ScalablePaddingTop(9),qS.ScalablePaddingLeft(17)),c={padding:"0",minWidth:"0"},d=qS.styler({color:qS.PrimaryColor,fontWeight:"normal",textAlign:"left",whiteSpace:"nowrap",marginLeft:"-50%",fontSize:13,paddingTop:9,paddingLeft:17}),p=qS.styler({height:"18px",width:"18px",display:"block",cursor:"pointer",backgroundSize:"100% 100%",backgroundColor:"transparent",boxShadow:"none",shapeRendering:"crispEdges",$nest:{"&:hover":{backgroundColor:"transparent !important"}}},qS.ScalableMinWidth(0)),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=null!=this.props.children,t=null==this.props.scalableTooltip||this.props.scalableTooltip,n=PS(t?l:p,this.props.className),r=PS(s,this.props.wrapperClassName),i=PS(t?u:d,this.props.tooltipClassName),o=a;return null!=this.props.tooltipWrapperClassName&&(o+=" "+this.props.tooltipWrapperClassName),Vn.createElement("div",{className:r},Vn.createElement(JS.Button,{className:n,ariaLabel:this.props.ariaLabel,onClick:this.props.onClick,onPointerUp:this.props.onPointerUp,onPointerDown:this.props.onPointerDown,onTouchStart:this.props.onTouchStart,onTouchEnd:this.props.onTouchEnd,onKeyDown:this.props.onKeyDown,icon:this.props.src,style:c}),e?Vn.createElement("div",{className:o},Vn.createElement("div",{className:i},this.props.children)):null)},t}(Vn.PureComponent);t.ImageButton=f});e(rb);rb.ImageButton;var ib=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({display:"flex",flexWrap:"nowrap",overflow:"hidden"}),a=qS.styler({}),s=qS.styler(qS.ScrollableHorizontal,{display:"flex",flex:"1 1 auto",minWidth:0,flexWrap:"nowrap",$nest:(n={},n["."+a]={display:"flex",overflow:"visible"},n)}),l=qS.styler({flex:"0 0 auto",alignItems:"center",justifyContent:"center",display:"none",$nest:{"&.show":{display:"flex"}}}),u=qS.styler({margin:0,opacity:.8,transition:"opacity 0.15s ease-in",$nest:{"&:hover":{opacity:1}}}),c=qS.styler({transform:"scale(-1, 1)"}),d=function(t){function n(e){var l=t.call(this,e)||this;return l.animationRunning=!1,l.scrollComponent=null,l.collectionComponent=null,l.updateItemPositions=function(){for(var e=[],t=Ld.findDOMNode(l.collectionComponent).children,n=0,r=0;r<t.length;r++){var i=window.getComputedStyle(t[r],null),o=[i.getPropertyValue("padding-left"),i.getPropertyValue("padding-right"),i.getPropertyValue("margin-left"),i.getPropertyValue("margin-right")].reduce(function(e,t,n,r){return e+parseInt(t)},0),a={itemStart:n,itemEnd:n+t[r].clientWidth+o};e.push(a),n=a.itemEnd+1}return e},l.getScrollEndPosition=function(e,t){var n=l.updateItemPositions(),r=e.scrollLeft,i=ZS.binarySearchIndexOf(n,function(e){return r<e.itemStart?-1:r>e.itemEnd?1:0});return n[t(i=-1===i?0:i,e.clientWidth,n)].itemStart},l.onClickRight=function(){var e=Ld.findDOMNode(l.scrollComponent);null!==e&&l.scroll(e,n.findIndexOfNextPage)},l.onClickLeft=function(){var e=Ld.findDOMNode(l.scrollComponent);null!==e&&l.scroll(e,n.findIndexOfPreviousPage)},l.scroll=function(e,t){if(!0!==l.animationRunning){l.animationRunning=!0;var n=l.getScrollEndPosition(e,t),r=e.scrollLeft;r!==n?l.scrollAnimate(e,r,n):l.animationRunning=!1}},l.scrollAnimate=function(n,r,i){var o=null,a=0,s=l;requestAnimationFrame(function e(t){o||(o=t),500<=(a=t-o)?s.animationRunning=!1:(n.scrollLeft=Rp.sinInterp(r,i,a/500),requestAnimationFrame(e))}),n.scrollLeft=i},l.state={shouldShowArrows:!1},l}return i(n,t),n.prototype.render=function(){var t=this;if(null===this.props.collectionView)return null;var e=!(xt.exists(this.props.enableArrow)&&!this.props.enableArrow),n=PS(this.props.className,o),r=PS(l,{show:this.state.shouldShowArrows&&e}),i=Vn.cloneElement(this.props.collectionView,{ref:function(e){t.collectionComponent=e},className:PS(this.props.collectionView.props.className,a)});return Vn.createElement("div",{className:n},Vn.createElement("div",{className:r},Vn.createElement(rb.ImageButton,{wrapperClassName:u,onClick:this.onClickLeft,src:nb.SVG.BackArrow})),Vn.createElement("div",{ref:function(e){t.scrollComponent=e},className:s},i),Vn.createElement("div",{className:r},Vn.createElement(rb.ImageButton,{wrapperClassName:PS(u,c),onClick:this.onClickRight,src:nb.SVG.BackArrow})))},n.prototype.componentDidMount=function(){this.updateArrows()},n.prototype.componentWillUpdate=function(e){F.isEqual(this.props,e)||(Ld.findDOMNode(this.scrollComponent).scrollLeft=0)},n.prototype.componentDidUpdate=function(){this.updateArrows()},n.prototype.updateArrows=function(){if(!xt.exists(this.props.enableArrow)||this.props.enableArrow){var e=Ld.findDOMNode(this.scrollComponent),t=e.scrollWidth>e.clientWidth;t!==this.state.shouldShowArrows&&this.setState({shouldShowArrows:t})}},n.findIndexOfNextPage=function(e,t,n){var r=n[e].itemStart;return ZS.binarySearchIndexOfClosestBelow(n.slice(e),function(e){return e.itemStart-r>t?-1:e.itemEnd-r<t?1:0})+e},n.findIndexOfPreviousPage=function(e,t,n){var r=n[e].itemEnd;return ZS.binarySearchIndexOfClosestBelow(n.slice(0,e),function(e){return r-e.itemStart>t?1:r-e.itemEnd<t?-1:0})},n.defaultProps={className:null,isShowing:!1,collectionView:null,enableArrow:!0},n}(Vn.Component);t.CarouselView=d});e(ib);ib.CarouselView;var ob=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=qS.styler({background:"url("+nb.SVG.CheckMark+") no-repeat !important",backgroundColor:"#0d0d0d",backgroundSize:"70% 55% !important",backgroundPosition:"center !important",$nest:{"&:hover":{color:qS.PrimaryColor}}}),s=qS.styler({background:"rgba(0, 0, 0, 0.47)",boxShadow:"1px 1px rgba(255, 255, 255, 0.09)",border:"1px solid rgba(0,0,0,0)"}),l=qS.styler(qS.ScalableMinHeight(25),qS.ScalableMinWidth(25),qS.ScaleProperty("border-radius",1)),u=qS.styler({cursor:"pointer","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale",$nest:o({},qS.RTLStyle(o({marginLeft:"auto"},qS.ScaleNestedProperty("margin-right",10))))},qS.ScalableFontSize(17),qS.ScalableMarginLeft(10)),c=qS.styler({display:"flex",alignItems:"center",color:qS.TextColor,cursor:"pointer",fontWeight:"normal",$nest:o((n={"&:not(:first-child)":qS.ScaleNestedProperty("margin-left",30)},n["&:hover > ."+s]={borderColor:"#757575",backgroundColor:"#242424"},n),qS.RTLStyle({$nest:{"&:not(:first-child)":o({marginLeft:"auto"},qS.ScaleNestedProperty("margin-right",30))}}))}),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(e){"keydown"===e.type&&"Enter"!==e.key||"function"==typeof t.props.onChange&&t.props.onChange(!t.props.isChecked)},t}return i(t,e),t.prototype.render=function(){var e,t,n=PS(c,this.props.checkboxClassName),r=PS(s,l,((e={})[a]=this.props.isChecked,e),this.props.checkmarkBoxClassName),i=PS(u,((t={})[this.props.checkmarkBoxCheckedClassName]=this.props.isChecked,t),this.props.textClassName);return Vn.createElement("div",{className:n,onClick:this.onChange},Vn.createElement("input",{type:"checkbox",style:{opacity:0,position:"absolute",bottom:"8px"},checked:this.props.isChecked,onChange:function(){},onKeyDown:this.onChange,"aria-label":this.props.ariaLabel}),Vn.createElement("div",{className:r}),Vn.createElement("label",{className:i},this.props.children))},t.defaultProps={isChecked:!1},t}(Vn.Component);t.Checkbox=d});e(ob);ob.Checkbox;var ab=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler(qS.ScrollableVertical,{$debugName:"collectionView",display:"block",willChange:"transform"}),o=function(t){function e(e){var o=t.call(this,e)||this;return o.throttledScrollListener=null,o.throttledResizeListener=null,o.itemsToAdd=100,o.scrollToItem=function(e){for(var t=-1,n=0;n<o.props.items.length;n++){e===o.props.items[n].id&&(t=n)}if(0<=t){var r=Ld.findDOMNode(o.refs.list),i=r.childNodes[t];r.scrollTop=i.offsetTop-r.offsetTop}},o.computeNumberOfItems=function(){if(o.props.isShowing){var e=Ld.findDOMNode(o.refs.list);o.itemsToAdd=o.computeNumberToAdd(e),e.scrollHeight===e.clientHeight&&o.props.items.length>=o.state.itemCount&&o.setState({itemCount:o.state.itemCount+o.itemsToAdd})}},o.computeNumberToAdd=function(e){if(null==e.childNodes||0===e.childNodes.length)return o.itemsToAdd;var t=e.childNodes[0];return null!=t?Math.max(e.clientWidth/t.clientWidth*3,1):o.itemsToAdd},o.loadOnScroll=function(){var e,t=Ld.findDOMNode(o.refs.list),n=t.childNodes[0];null!=n&&(e=n.offsetHeight),t.scrollHeight-t.scrollTop<=t.clientHeight+e+300&&o.state.itemCount<o.props.items.length&&o.setState({itemCount:o.state.itemCount+o.itemsToAdd})},o.state={itemCount:100},o}return n(e,t),e.prototype.componentDidMount=function(){if(this.props.dynamicLoad){this.throttledScrollListener=new Ce.ThrottledEventListener,this.throttledResizeListener=new Ce.ThrottledEventListener;var e=Ld.findDOMNode(this.refs.list);this.throttledScrollListener.attachThrottledListener(e,"scroll",300,this.loadOnScroll),this.throttledResizeListener.attachThrottledListener(window,"resize",300,this.computeNumberOfItems),this.itemsToAdd=this.computeNumberToAdd(e)}},e.prototype.componentWillUnmount=function(){this.props.dynamicLoad&&(this.throttledScrollListener.removeThrottledListener(),this.throttledResizeListener.removeThrottledListener())},e.prototype.componentWillReceiveProps=function(e){F.isEqual(this.props.items,e.items)||(this.setState({itemCount:100}),Ld.findDOMNode(this.refs.list).scrollTop=0)},e.prototype.componentDidUpdate=function(){this.computeNumberOfItems()},e.prototype.render=function(){var e=PS(this.props.className,i),t=this.props.items;return null!==t&&this.props.dynamicLoad&&(t=t.slice(0,this.state.itemCount)),Vn.createElement("div",{className:e,ref:"list"},t.map(this.props.elementCreator))},e.defaultProps={elementCreator:null,items:[],className:null,dynamicLoad:!1,isShowing:!1},e}(Vn.PureComponent);t.CollectionView=o});e(ab);ab.CollectionView;var sb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=qS.styler({$nest:{"& > svg > .background":{fill:"rgba(0, 0, 0, 0.5)"},"& > svg > .border":{fill:"transparent",stroke:"#fff",strokeWidth:"4px"}}},qS.ScalableWidth(60),qS.ScalableHeight(60)),i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxPercent=98.96,e.viewportSize=100,e.radius=50,e}return n(e,t),e.prototype.render=function(){var e=Math.max(0,Math.min(this.maxPercent,this.props.percent)),t=Math.round(e/100*360),n=t*Math.PI/180,r=Math.sin(n)*this.radius,i=Math.cos(n)*-this.radius,o=180<t?1:0,a="M 0 -"+this.radius+" A "+this.radius+" "+this.radius+" 1 "+o+" 1 "+r+" "+i,s=l;return null!=this.props.className&&(s+=" "+this.props.className),Vn.createElement("div",{className:s},Vn.createElement("svg",{viewBox:"0 0 "+this.viewportSize+" "+this.viewportSize,preserveAspectRatio:"none",width:"100%",height:"100%"},Vn.createElement("circle",{className:"background",cx:"50%",cy:"50%",r:"50%"}),Vn.createElement("path",{className:"border",transform:"translate("+this.radius+", "+this.radius+") scale(0.96)",d:a})))},e.defaultProps={percent:100},e}(Vn.PureComponent);t.CountdownCircle=i});e(sb);sb.CountdownCircle;var lb=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.debugClassName=function(e){return qS.debugClassName("atvwebplayersdk",e)}});e(lb);lb.debugClassName;var ub=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){this.urlBase=e,this.physicalId=t,this.tags=n,this.extension=r,this.fileName=""+this.physicalId+this.getTagsAsString()+"."+this.extension,this.url=this.urlBase+"/"+this.fileName}return e.prototype.getTagsAsString=function(){return 0===this.tags.length?"":"._"+this.tags.join("_")+"_"},e}();t.ImageUrl=n});e(ub);ub.ImageUrl;var cb=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=M.get("ImageUrlParser"),n=function(){function e(){}return e.parse=function(e){var t=e.lastIndexOf("/");if(t<0)return d.warn("Unable to find filename slash ('/'); will not be able to parse image url: "+e),null;var n=e.substring(0,t),r=e.substring(t+1),i=r.lastIndexOf(".");if(i<0)return d.warn("Unable to find file extension dot ('.'); will not be able to parse image url: "+e),null;var o,a,s=r.substring(0,i),l=r.substring(i+1),u=s.indexOf("._");if(u<0)o=s,a=[];else{o=s.substring(0,u);var c=s.substring(u+2);a=this.parseTags(c)}return new ub.ImageUrl(n,o,a,l)},e.parseTags=function(e){for(var t=[],n=0,r=e.split("_");n<r.length;n++){var i=r[n];0<i.length&&t.push(i)}return t},e}();t.ImageUrlParser=n});e(cb);cb.ImageUrlParser;var db=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.JPEG=0]="JPEG",r[r.PNG=1]="PNG",r[r.WEBP=2]="WEBP",r[r.GIF=3]="GIF",t.ImageFormatType=n;var i=function(){function e(e){this.urlSourceTagFilter=null,this.tags=[],this.urlSource="string"==typeof e?cb.ImageUrlParser.parse(e):e||null}return e.prototype.removeAllUrlSourceTags=function(){return this.ignoreUrlSourceTags=!0,this},e.prototype.setUrlSourceTagFilter=function(e){return this.urlSourceTagFilter=e,this},e.prototype.addTag=function(e){return 0<e.length&&this.tags.push(e),this},e.prototype.addTags=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];this.addTag(r)}return this},e.prototype.addScaleToWidthTag=function(e){return this.addTag("SX"+e)},e.prototype.addScaleToHeightTag=function(e){return this.addTag("SY"+e)},e.prototype.addUpscaleToWidthTag=function(e){return this.addTag("UX"+e)},e.prototype.addUpscaleToHeightTag=function(e){return this.addTag("UY"+e)},e.prototype.addUpscaleToRectangleTag=function(e,t){return this.addTag("UR"+e+","+t)},e.prototype.addImageQualityTag=function(e){return this.addTag("QL"+e)},e.prototype.addCropTag=function(e,t,n,r){return this.addTag("CR"+[e,t,n,r].join(","))},e.prototype.addFormatTag=function(e){switch(e){case n.GIF:this.addTag("FMgif");break;case n.JPEG:break;case n.PNG:this.addTag("FMpng");break;case n.WEBP:this.addTag("FMwebp")}return this},e.prototype.create=function(){if(null===this.urlSource)return null;var e=this.ignoreUrlSourceTags?[]:this.urlSource.tags;e=null!==this.urlSourceTagFilter?e.filter(this.urlSourceTagFilter):e;var t=[].concat(e,this.tags);return new ub.ImageUrl(this.urlSource.urlBase,this.urlSource.physicalId,t,this.urlSource.extension)},e}();t.ImageUrlBuilder=i});e(db);db.ImageFormatType,db.ImageUrlBuilder;var pb=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({display:"inline-flex",alignItems:"center",shapeRendering:"crispEdges",opacity:.8},qS.ScalableHeight(13)),a=qS.styler({position:"relative",display:"inline-block"},qS.ScalableWidth(24),qS.ScalableHeight(13)),s=qS.styler({float:"right",color:qS.PrimaryColor},qS.ScalableMarginLeft(5)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.state={hasHd:!1,hdIconSVG:null,isHd:!1,is1080p:null},t}return i(e,n),e.prototype.componentWillReceiveProps=function(e){var t=e.videoStream;if(null!=t&&null!=t.activeVariantId){var n=F.findWhere(e.videoStream.variants,{id:e.videoStream.activeVariantId});if(null!=n){var r=F.some(t.variants,function(e){return 720<=e.height||1280<=e.width}),i=(720<=n.height||1280<=n.width)&&!e.downscalingToSd,o=(1080<=n.height||1920<=n.width)&&!e.hd1080pTextDisabled,a=null;r&&(a=e.hdDisabled?nb.SVG.HDDisabled:i?nb.SVG.HD:nb.SVG.HDSupported),this.setState({hasHd:r,hdIconSVG:a,isHd:i,is1080p:o})}}},e.prototype.render=function(){var e=this.state.hasHd?null:{display:"none"};return Vn.createElement("div",{className:o},null!==this.state.hdIconSVG?Vn.createElement("div",{className:a,style:e},Vn.createElement(YS.SVGImage,{src:this.state.hdIconSVG})):null,this.state.is1080p?Vn.createElement("div",{className:s},"1080p"):null)},e.defaultProps={hd1080pTextDisabled:!1},e}(Vn.Component);t.HDIndicator=n});e(pb);pb.HDIndicator;var fb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({display:"inline-flex",alignItems:"center",background:"rgba(0 ,0, 0, 0.17)",border:"1px solid #706f6f"},qS.ScalablePadding(2,5),qS.ScaleProperty("border-radius",2)),o=qS.styler({width:"100%",color:"#e1e1e1",fontWeight:"normal",textAlign:"center"},qS.ScalableFontSize(13)),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=i;null!=this.props.labelClassName&&(e+=" "+this.props.labelClassName);var t=o;return null!=this.props.textClassName&&(t+=" "+this.props.textClassName),Vn.createElement("div",{className:e},Vn.createElement("div",{className:t},this.props.children))},t}(Vn.PureComponent);t.Label=a});e(fb);fb.Label;var hb=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=Vd.keyframes({from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}),o=qS.styler({backgroundSize:"100% 100%",position:"absolute",top:"50%",left:"50%",width:"100% !important",height:"100%",marginTop:"-50%",marginLeft:"-50%",animationName:n,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",backgroundImage:"none",backgroundPositionX:0,backgroundPositionY:0}),a=qS.styler({backgroundImage:"url(\""+nb.SVG.LoadingSpinner+"\")",backgroundRepeat:"no-repeat"}),s=function(n){function e(e){var t=n.call(this,e)||this;return t.state={isIE:!1,spinnerDelayTimerId:null,isShowing:!0},t}return i(e,n),e.prototype.componentWillMount=function(){var e=Xh.getBrowser().getType();e!==Xh.BrowserType.IE&&e!==Xh.BrowserType.Edge||this.setState({isIE:!0})},e.prototype.componentWillReceiveProps=function(e){var t=this;if(!this.state.isShowing&&null===this.state.spinnerDelayTimerId&&e.shouldShow){var n=A.timer.setTimeout(function(){t.setState({isShowing:!0,spinnerDelayTimerId:null})},this.props.spinnerDelayMs);this.setState({spinnerDelayTimerId:n})}else e.shouldShow||(A.timer.clearTimeout(this.state.spinnerDelayTimerId),this.setState({isShowing:!1,spinnerDelayTimerId:null}))},e.prototype.shouldComponentUpdate=function(e,t){return this.state.isShowing!==t.isShowing},e.prototype.render=function(){var e,t={display:this.state.isShowing?"inline":"none"},n=PS(o,((e={})[a]=this.state.isIE,e));return Vn.createElement("div",{className:this.props.className},Vn.createElement("div",{className:n,style:t},this.state.isIE?null:Vn.createElement(YS.SVGImage,{src:this.props.spinnerSvg})))},e.defaultProps={shouldShow:!1,spinnerDelayMs:10,spinnerSvg:nb.SVG.LoadingSpinner},e}(Vn.Component);t.LoadingSpinner=s});e(hb);hb.LoadingSpinner;var mb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o="1px solid #444",a=qS.styler({width:"100%",height:"100%",position:"absolute",pointerEvents:"none",display:"flex",justifyContent:"space-between",alignItems:"center"}),s=qS.styler({display:"flex",flexDirection:"column",pointerEvents:"auto",boxSizing:"border-box",borderRadius:"4px",margin:"0 auto",backgroundColor:"#333",color:qS.TextColor,boxShadow:"2px 2px 3px rgba(0, 0, 0, 0.3)",maxWidth:"100%"},qS.ScalableFontSize(19),qS.ScalableWidth(600)),l={ClosePlayerClassName:qS.styler({position:"absolute",cursor:"pointer",backgroundImage:"url(\""+nb.SVG.ModalCloseUp+"\")",backgroundRepeat:"no-repeat",backgroundSize:"cover",$nest:i({"&:hover":{backgroundImage:"url(\""+nb.SVG.ModalCloseOver+"\")"}},qS.RTLStyle(i({right:"auto"},qS.ScaleNestedProperty("left",22))))},qS.ScalableWidth(15),qS.ScalableHeight(15),qS.ScalableTop(17),qS.ScalableRight(22)),DescriptionClassName:qS.styler({fontWeight:"lighter",overflowWrap:"break-word",boxSizing:"border-box",overflowY:"auto",lineHeight:"130%",maxHeight:"50vh",$nest:{"&:nth-last-child(2)":{maxHeight:"39vh"},"& .highlight, b":{fontWeight:"bold",color:qS.PrimaryColor},"& > :last-child":{marginBottom:"0"}}},qS.ScalablePadding(20,20,25,20)),FooterClassName:qS.styler({fontWeight:"normal",lineHeight:"130%",borderTop:o},qS.ScalableFontSize(15),qS.ScalablePadding(20),qS.ScaleProperty("border-top-width",1)),NotesClassName:qS.styler({fontWeight:"normal",lineHeight:"130%"},qS.ScalableFontSize(15)),TitleClassName:qS.styler({position:"relative",background:"#3c3c3c",borderBottom:o,borderRadius:"4px 4px 0 0",color:qS.PrimaryColor,fontWeight:"normal",$nest:i({},qS.RTLStyle(i({},qS.ScaleNestedProperty("padding-right",20))))},qS.ScalableFontSize(21),qS.ScalableMinHeight(25),qS.ScalablePadding(10,55,10,20),qS.ScaleProperty("border-bottom-width",1))};t.ModalStyles=l;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=null;this.props.useSmallPlayerModals()&&(e={width:"100%",height:"100%"});var t=PS(s,this.props.className),n={display:this.props.visible?"flex":"none"};return Vn.createElement("div",{className:a,style:n},Vn.createElement("div",{className:t,style:e},this.props.children))},t.defaultProps={visible:!0,useSmallPlayerModals:null},t}(Vn.Component);t.Modal=u});e(mb);mb.ModalStyles,mb.Modal;var yb=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var f=qS.styler({backgroundColor:"rgba(255, 255, 255, 0.25)",position:"absolute","-webkit-appearance":"none",display:"block",margin:"auto",$nest:{"&::-webkit-slider-thumb":{"-webkit-appearance":"none"},"&::-moz-range-thumb":{background:"transparent",border:"none"},"&::-ms-thumb":{background:"transparent",border:"none",borderRadius:"0"},"&::-ms-track":{background:"transparent",border:"none",borderColor:"transparent",height:"0px",color:"transparent"}}}),h=qS.styler({width:"100%"},qS.ScalablePadding(0),qS.ScalableHeight(3)),m=qS.styler({height:"100%"},qS.ScalablePadding(0),qS.ScalableWidth(3)),y=qS.styler({position:"absolute",perspective:"400px"}),g=qS.styler(qS.ScalableMarginTop(-5),qS.ScalableMarginLeft(-6.5)),v=qS.styler({left:"0"},qS.ScalableMarginLeft(5),qS.ScalableMarginBottom(-6)),o=qS.styler({backgroundColor:"rgb(221, 221, 221)",borderRadius:"50%",$nest:{"&:hover":{backgroundColor:qS.PrimaryColor}}}),S=qS.styler(o,qS.ScalableWidth(13),qS.ScalableHeight(13)),b=qS.styler({transform:"translateZ(-100px)",opacity:0,transition:"transform 100ms linear, opacity 100ms linear"}),T=qS.styler({transform:"translateZ(0px)",opacity:1}),P=qS.styler({cursor:"pointer",position:"relative",$nest:(n={},n["&:hover > ."+y+" > ."+o+"."+b]={transform:"translateZ(0px)",opacity:1},n)}),w=qS.styler({width:"100%"},qS.ScalableHeight(3),qS.ScalablePaddingTop(10),qS.ScalablePaddingBottom(10)),C=qS.styler({height:"100%"},qS.ScalableWidth(3),qS.ScalablePaddingLeft(10),qS.ScalablePaddingRight(10)),a=function(t){function e(e){var i=t.call(this,e)||this;return i.touched=!1,i.supportsPointerEvents=null!=window.PointerEvent,i.progressBarContainerRef=null,i.progressBarRef=null,i.getPercentageFromMouseEvent=function(e){var t=i.progressBarElement.getBoundingClientRect(),n=i.props.vertical?i.progressBarElement.offsetHeight-(e.clientY-t.top):e.clientX-t.left,r=i.props.vertical?n/i.progressBarElement.offsetHeight:n/i.progressBarElement.offsetWidth;return Math.min(Math.max(r,0),1)},i.onMouseDown=function(e){if(i.props.enabled&&!i.mouseDown){if(null!=e.touches||"touch"===e.pointerType)i.touched=!0;else if("touch"!==e.pointerType&&i.touched)return void(i.touched=!1);var t=null!=e.touches;e=t?e.touches[0]:e;var n=i.getPercentageFromMouseEvent(e);i.mouseDown=!0,i.setState({mouseDown:!0,handlePercent:n}),t||(document.addEventListener("mousemove",i.onMouseMove),document.addEventListener("mouseup",i.onMouseUp),document.addEventListener("pointermove",i.onMouseMove),document.addEventListener("pointerup",i.onMouseUp)),F.isFunction(i.props.onMouseDown)&&i.props.onMouseDown(n)}},i.onMouseUp=function(e){if(i.props.enabled&&i.mouseDown){if(null!=e.changedTouches||"touch"===e.pointerType)i.touched=!0;else if("touch"!==e.pointerType&&i.touched)return void(i.touched=!1);e.preventDefault();var t=null!=e.changedTouches;e=t?e.changedTouches[0]:e,i.state.mouseDown&&(i.mouseDown=!1,i.setState({mouseDown:!1}),t||(document.removeEventListener("mousemove",i.onMouseMove),document.removeEventListener("mouseup",i.onMouseUp),document.removeEventListener("pointermove",i.onMouseMove),document.removeEventListener("pointerup",i.onMouseUp)),F.isFunction(i.props.onPercentSelect)&&i.props.onPercentSelect(i.getPercentageFromMouseEvent(e)),F.isFunction(i.props.onMouseUp)&&i.props.onMouseUp(e))}},i.onMouseMove=function(e){if(!xt.isNullOrUndefined(e.pointerType)||!i.supportsPointerEvents){if(null!=e.touches||"touch"===e.pointerType)i.touched=!0;else if("touch"!==e.pointerType&&i.touched)return void(i.touched=!1);e.preventDefault(),e=xt.isNullOrUndefined(e.touches)?e:e.touches[0];var t=i.getPercentageFromMouseEvent(e);i.setState({handlePercent:t}),F.isFunction(i.props.onHandleDrag)&&i.state.mouseDown&&i.props.onHandleDrag(t),F.isFunction(i.props.onMouseMove)&&i.props.onMouseMove(t)}},i.mouseDown=!1,i.state={handlePercent:0,mouseDown:!1},i}return i(e,t),e.prototype.componentDidMount=function(){this.progressBarElement=Ld.findDOMNode(this.progressBarRef);var e=Ld.findDOMNode(this.progressBarContainerRef);e.addEventListener("pointerup",this.onMouseUp),e.addEventListener("pointerdown",this.onMouseDown),e.addEventListener("pointermove",this.onMouseMove)},e.prototype.componentWillUnmount=function(){var e=Ld.findDOMNode(this.progressBarContainerRef);e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointermove",this.onMouseMove)},e.prototype.render=function(){var e,t,n,r,i=this,o={display:null!==this.props.handlePercent?"inline-block":"none"},a=this.state.mouseDown?this.state.handlePercent:this.props.handlePercent,s=100*a+"%";this.props.vertical?o.bottom=s:o.left=s;var l=isNaN(a)?0:100*a,u=PS(P,((e={})[w]=!this.props.vertical,e[C]=this.props.vertical,e),this.props.progressBarContainerClassName),c=PS(f,((t={})[h]=!this.props.vertical,t[m]=this.props.vertical,t),this.props.progressBarClassName),d=PS(y,((n={})[g]=!this.props.vertical,n[v]=this.props.vertical,n),this.props.handleWrapperClassName),p=PS(S,((r={})[b]=this.props.showHandleOnHover,r[T]=this.props.showHandleOnHover&&this.state.mouseDown,r),this.props.handleClassName);return Vn.createElement("div",{ref:function(e){i.progressBarContainerRef=e},className:u,onTouchMove:this.onMouseMove,onTouchStart:this.onMouseDown,onTouchEnd:this.onMouseUp,onMouseMove:this.onMouseMove,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},Vn.createElement("input",{type:"range",className:c,min:"0",max:"100",value:l,onChange:function(){},step:"any",ref:function(e){i.progressBarRef=e},"aria-label":this.props.ariaLabel}),this.props.children,Vn.createElement("div",{className:d,style:o},Vn.createElement("div",{className:p})))},e.defaultProps={enabled:!0,vertical:!1,showHandleOnHover:!1},e}(Vn.PureComponent);t.ProgressBar=a});e(yb);yb.ProgressBar;var gb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=qS.styler({display:"block",position:"absolute",overflow:"hidden",backgroundColor:"rgb(221, 221, 221)"}),l=qS.styler(qS.ScalableHeight(3)),u=qS.styler({bottom:"0"},qS.ScalableWidth(3)),c=qS.styler({backgroundColor:"rgba(221, 221, 221, 0.33)",border:"none"}),i=function(t){function e(e){var a=t.call(this,e)||this;return a.getStateFromProps=function(e){var t,n=PS(s,((t={})[u]=e.vertical,t[l]=!e.vertical,t[c]=e.secondary,t)),r=100*e.startPercent+"%",i=100*(e.endPercent-e.startPercent)+"%",o={};return e.vertical?(o.bottom=r,o.height=i):(o.left=r,o.width=i),null!=a.props.className&&(n+=" "+a.props.className),{className:n,style:o}},a.state=a.getStateFromProps(e),a}return n(e,t),e.prototype.componentWillReceiveProps=function(e){this.setState(this.getStateFromProps(e))},e.prototype.render=function(){return Vn.createElement("span",{className:this.state.className,style:this.state.style})},e}(Vn.PureComponent);t.ProgressBarSegment=i});e(gb);gb.ProgressBarSegment;var vb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onChange=function(){"function"!=typeof e.props.onClick||e.props.isSelected||e.props.onClick(e)},e}return n(e,t),e.prototype.render=function(){return Vn.createElement(ob.Checkbox,{isChecked:this.props.isSelected,onChange:this.onChange,checkboxClassName:this.props.checkboxClassName,checkmarkBoxClassName:this.props.checkmarkBoxClassName,checkmarkBoxCheckedClassName:this.props.checkmarkBoxCheckedClassName,textClassName:this.props.textClassName,ariaLabel:this.props.ariaLabel},this.props.children)},e.defaultProps={isSelected:!1,value:""},e}(Vn.Component);t.RadioButtonCheckbox=i});e(vb);vb.RadioButtonCheckbox;var Sb=t(function(e,t){var r,n,i,o=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=V&&V.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=qS.styler({overflow:"auto","-ms-overflow-style":"-ms-autohiding-scrollbar",touchAction:"pan-y",$nest:{"& *":{touchAction:"pan-y"}}}),l=qS.styler({},qS.BreakpointSizes("paddingLeft",((n={})[1921]="16",n))),u=qS.styler({paddingBottom:"1px",$nest:a({},qS.RTLStyle(a({paddingRight:"0px"},l)))},s,qS.BreakpointSizes("paddingRight",((i={})[1921]="16",i))),c=qS.styler({pointerEvents:"none",position:"absolute",width:"100%",background:"linear-gradient(rgba(69, 69, 69, 0), rgba(69, 69, 69, 1) 50%)"},qS.ScalableBottom(0),qS.ScalableHeight(30)),d=function(n){function e(e){var t=n.call(this,e)||this;return t.element=null,t.scalableMarginOfErrorPx=1,t.scrollableRef=null,t.onScroll=function(){var e=t.element.scrollHeight-t.element.scrollTop<=t.element.offsetHeight+t.scalableMarginOfErrorPx;e!==t.state.atBottom&&t.setState({atBottom:e})},t.updateGradient=function(){var e=Ce.HTMLElementUtils.isScrollable(t.element);e!==t.state.isScrollable&&t.setState({isScrollable:e})},t.state={atBottom:!1,isScrollable:!1},t}return o(e,n),e.prototype.componentDidUpdate=function(){this.updateGradient()},e.prototype.componentDidMount=function(){this.element=Ld.findDOMNode(this.scrollableRef),this.updateGradient(),this.element.addEventListener("scroll",this.onScroll)},e.prototype.componentWillUnmount=function(){this.element.removeEventListener("scroll",this.onScroll),this.element=null},e.prototype.render=function(){var t=this,e=PS(u,this.props.scrollableContainerClassName);return Vn.createElement("div",null,Vn.createElement("div",{className:e,ref:function(e){t.scrollableRef=e}},this.props.children),this.state.isScrollable&&!this.state.atBottom?Vn.createElement("div",{className:c}):null)},e}(Vn.Component);t.ScrollableContainer=d});e(Sb);Sb.ScrollableContainer;var bb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o="#454545",d=qS.styler({position:"absolute",zIndex:999}),p=qS.styler({overflow:"hidden",height:"100%",width:"100%",marginLeft:"-50%",backgroundColor:o,$nest:{"&.transparent":{backgroundColor:"rgba(0, 0, 0, 0.8)"},"&:not(.transparent)":{boxShadow:"2px 2px 3px rgba(0, 0, 0, 0.3)"}}},qS.ScaleProperty("border-radius",4)),f=qS.styler({position:"absolute",zIndex:999},qS.ScalableWidth(14)),h=qS.styler({width:"0",height:"0",position:"absolute",marginLeft:"-50%",borderLeft:"solid transparent",borderRight:"solid transparent"},qS.ScaleProperty("border-left-width",7),qS.ScaleProperty("border-right-width",7)),m=qS.styler({$nest:i({},qS.RTLStyle({marginLeft:"auto",marginRight:"-50%"}))}),y=qS.styler({borderBottom:"solid "+o,$nest:{"&.transparent":{borderBottomColor:"rgba(0, 0, 0, 0.8)"}}},qS.ScaleProperty("border-bottom-width",7),qS.ScalableMarginTop(-6)),g=qS.styler({borderTop:"solid "+o,$nest:{"&.transparent":{borderTopColor:"rgba(0, 0, 0, 0.8)"}}},qS.ScaleProperty("border-top-width",7),qS.ScalableMarginTop(-1)),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isRTL=null,e.tooltipWindowPadding=10,e.tooltipElement=null,e.updateDirection=function(){e.isRTL="rtl"===document.documentElement.dir&&!e.props.forceLTR},e}return n(e,t),e.prototype.shouldComponentUpdate=function(e){return this.props.updateWhenHidden||e.show||this.props.show!==e.show},e.prototype.render=function(){var e,t,n=this;this.updateDirection();var r={marginLeft:this.isRTL?"auto":this.props.x,marginRight:this.isRTL?this.props.x:"auto",display:this.props.show?"":"none"};this.props.below?r.top=""+this.props.y:r.bottom=""+this.props.y;var i=F.clone(r),o=PS(h,((e={})[m]=!this.props.forceLTR,e[y]=this.props.below,e[g]=!this.props.below,e.transparent=this.props.transparent,e)),a=PS(p,((t={})[m]=!this.props.forceLTR,t),"tooltip"),s=this.isRTL?r.marginRight:r.marginLeft;if(this.props.show&&this.tooltipElement&&F.isNumber(s)){var l=this.tooltipElement.parentNode.getBoundingClientRect().left,u=l+s,c=this.tooltipElement.offsetWidth/2;u+c>window.innerWidth-this.tooltipWindowPadding&&(s=window.innerWidth-this.tooltipWindowPadding-l-c),u-c<this.tooltipWindowPadding&&(s=c-l+this.tooltipWindowPadding)}return null!=this.props.xOffset&&(s="calc("+s+" + "+this.props.xOffset+")"),this.isRTL?r.marginRight=s:r.marginLeft=s,Vn.createElement("div",null,Vn.createElement("div",{className:d,style:r,ref:function(e){n.tooltipElement=e}},Vn.createElement("div",{className:this.props.transparent?a+" transparent":a,onMouseMove:this.props.onMouseMove,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},this.props.children)),Vn.createElement("div",{className:f,style:i},Vn.createElement("div",{className:o})))},e.defaultProps={x:0,y:0,below:!1,forceLTR:!1,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,show:!1,transparent:!1,updateWhenHidden:!1,xOffset:null},e}(Vn.Component);t.Tooltip=a});e(bb);bb.Tooltip;var Tb=t(function(e,t){var r,n,i,o=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=V&&V.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=qS.styler({display:"inline-block",float:"right",marginTop:"33%",borderLeft:"solid transparent",borderRight:"solid transparent",borderTop:"solid #999",$nest:a({},qS.RTLStyle(a({marginLeft:"auto"},qS.ScaleNestedProperty("margin-right",6))))},qS.ScaleProperty("border-left-width",4),qS.ScaleProperty("border-right-width",4),qS.ScaleProperty("border-top-width",4),qS.ScalableWidth(0),qS.ScalableHeight(0),qS.ScalableMarginLeft(6)),l=qS.styler({}),u=qS.styler({opacity:.5}),c=qS.styler({position:"relative",display:"inline-block",$nest:(n={},n["&:not(."+u+") > ."+l]={cursor:"pointer",$nest:(i={},i["&:hover > ."+s]={borderTopColor:"#333"},i)},n)}),d=qS.styler({display:"flex",alignItems:"baseline"},qS.ScalablePadding(10)),p=function(r){function e(e){var n=r.call(this,e)||this;n.collapsedGroupRef=null,n.tooltipElementRef=null,n.onButtonClicked=function(e){n.props.disabled||("function"==typeof n.props.onChange&&n.props.onChange(e.props.value),n.setState({selectedButton:e.props.value,showTooltip:!1}))},n.onCollapsedButtonClicked=function(){n.props.disabled||n.setState({showTooltip:!n.state.showTooltip})},n.getButtons=function(){return null==n.props.children?null:Vn.Children.map(n.props.children,function(e){var t=e;return Vn.cloneElement(t,{key:null===t.key?t.props.value:t.key,onClick:n.onButtonClicked,disabled:n.props.disabled,isSelected:t.props.value===n.state.selectedButton,isCollapsedButton:!1,value:t.props.value})})},n.getCollapsedButton=function(){return null==n.props.children?null:Vn.Children.map(n.props.children,function(e){var t=e;return t.props.value===n.state.selectedButton?Vn.cloneElement(t,{key:null===t.key?t.props.value:t.key,disabled:n.props.disabled,isSelected:!0,isCollapsedButton:!0,value:t.props.value}):null})},n.checkClickOutsideOfElement=function(e){!n.state.showTooltip||Ce.HTMLElementUtils.clickedInElement(n.collapsedGroupRef,e)||Ce.HTMLElementUtils.clickedInElement(n.tooltipElementRef,e)||n.setState({showTooltip:!1})};var t=n.props.children[0];return n.state={collapsed:!1,selectedButton:null!=n.props.selectedButton?n.props.selectedButton:null!=t?t.props.value:null,showTooltip:!1},n}return o(e,r),e.prototype.componentWillReceiveProps=function(e){null!=e.selectedButton&&e.selectedButton!==this.props.selectedButton&&e.selectedButton!==this.state.selectedButton&&this.setState({selectedButton:e.selectedButton})},e.prototype.componentDidMount=function(){window.addEventListener("click",this.checkClickOutsideOfElement)},e.prototype.componentWillUnmount=function(){window.removeEventListener("click",this.checkClickOutsideOfElement)},e.prototype.render=function(){var e,t=this,n=PS(c,((e={})[u]=this.props.disabled,e),this.props.className),r=this.state.collapsed?Vn.createElement("div",{className:l,ref:function(e){t.collapsedGroupRef=e},onClick:this.onCollapsedButtonClicked},this.getCollapsedButton(),Vn.createElement("div",{className:s}),Vn.createElement(bb.Tooltip,{x:"50%",y:"40px",show:this.state.showTooltip},Vn.createElement("div",{className:d,ref:function(e){t.tooltipElementRef=e}},this.getButtons()))):this.getButtons();return this.props.scrollable?Vn.createElement(Sb.ScrollableContainer,{scrollableContainerClassName:this.props.scrollableContainerClassName},Vn.createElement("div",{className:n},r)):Vn.createElement("div",{className:n},r)},e.defaultProps={canCollapse:!1,disabled:!1,scrollable:!1},e}(Vn.Component);t.RadioButtonGroup=p});e(Tb);Tb.RadioButtonGroup;var Pb=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Hover20s=2e4]="Hover20s",r[r.Standard=1500]="Standard",r[r.Touch=3e3]="Touch",t.UITimeoutMS=n});e(Pb);Pb.UITimeoutMS;var wb=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Button=JS.Button,t.CarouselView=ib.CarouselView,t.Checkbox=ob.Checkbox,t.CollectionView=ab.CollectionView,t.CountdownCircle=sb.CountdownCircle,t.debugClassName=lb.debugClassName,t.ImageButton=rb.ImageButton,t.ImageUrl=ub.ImageUrl,t.ImageUrlBuilder=db.ImageUrlBuilder,t.ImageFormatType=db.ImageFormatType,t.ImageUrlParser=cb.ImageUrlParser,t.HDIndicator=pb.HDIndicator,t.Label=fb.Label,t.LoadingSpinner=hb.LoadingSpinner,t.Modal=mb.Modal,t.ModalStyles=mb.ModalStyles,t.ProgressBar=yb.ProgressBar,t.ProgressBarSegment=gb.ProgressBarSegment,t.RadioButtonCheckbox=vb.RadioButtonCheckbox,t.RadioButtonGroup=Tb.RadioButtonGroup,t.ScrollableContainer=Sb.ScrollableContainer,t.SVG=nb.SVG,t.SVGImage=YS.SVGImage,t.Tooltip=bb.Tooltip,t.UITimeoutMS=Pb.UITimeoutMS});e(wb);wb.Button,wb.CarouselView,wb.Checkbox,wb.CollectionView,wb.CountdownCircle,wb.debugClassName,wb.ImageButton,wb.ImageUrl,wb.ImageUrlBuilder,wb.ImageFormatType,wb.ImageUrlParser,wb.HDIndicator,wb.Label,wb.LoadingSpinner,wb.Modal,wb.ModalStyles,wb.ProgressBar,wb.ProgressBarSegment,wb.RadioButtonCheckbox,wb.RadioButtonGroup,wb.ScrollableContainer,wb.SVG,wb.SVGImage,wb.Tooltip,wb.UITimeoutMS;var Cb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){var l=t.call(this,e)||this;return l.loadTimeTracker=new Rv.LoadTimeTracker,l.loadMetricsReporter=new Rv.LoadMetricsReporter,l.scrollToItem=function(e){l.refs.itemContainer.scrollToItem(e)},l.elementCreator=function(e,t){var n=l.loadTimeTracker.registerId(t);return l.props.elementCreator(e,t,n)},l.onLoad=function(){l.props.onLoadCallback?l.props.onLoadCallback():l.loadMetricsReporter.endTimerAndReport(l.props.loadMetricName,"MetricsReportingCollectionView")},l.calculateScrollDistance=function(e,t,n,r){var i=l.calculate2DVisibleComponents(e,e+n,r),o=l.calculate2DVisibleComponents(t,t+n,r);if(0===i.length&&0===o.length)return 0;if(0===i.length)return o.length;if(0===o.length)return i.length;var a=Math.abs(i[i.length-1]-o[o.length-1]),s=Math.abs(i[0]-o[0]);return Math.max(a,s)*(t<e?-1:1)},l.calculateComponentsForLoad=function(){if(l.props.loadMetricName||l.props.onLoadCallback){var e=Ld.findDOMNode(l.refs.itemContainer),t=e.getBoundingClientRect(),n=e.childNodes,r=l.calculateVisibleComponents(t,n);l.loadTimeTracker.setOnLoadListener(l.onLoad),l.props.isShowing&&(l.props.loadMetricName&&l.loadMetricsReporter.startTimer(),l.loadTimeTracker.lock(r))}},l.calculateVisibleComponents=function(e,t){for(var n=[],r=0;r<t.length;r++){var i=t[r].getBoundingClientRect();if(l.props.isShowing&&!l.doRectsCollide(e,i))break;n.push(r)}return n},l.calculate2DVisibleComponents=function(e,t,n){for(var r=[],i=!1,o=0;o<n.length;o++){var a=n[o].getBoundingClientRect();if(!l.props.isShowing||l.doIntervalCollide(e,t,a))r.push(o),i=!0;else if(i)break}return r},l.doIntervalCollide=function(e,t,n){return Math.max(e,n.top)<=Math.min(t,n.bottom)},l.doRectsCollide=function(e,t){return e.left<t.right&&e.right>t.left&&e.top<t.bottom&&e.bottom>t.top},l}return n(e,t),e.prototype.componentWillReceiveProps=function(e){this.props.items===e.items&&this.props.isShowing===e.isShowing||this.loadTimeTracker.reset()},e.prototype.render=function(){return Vn.createElement(wb.CollectionView,{className:this.props.className,items:this.props.items,elementCreator:this.elementCreator,dynamicLoad:this.props.dynamicLoad,isShowing:this.props.isShowing,ref:"itemContainer"})},e.prototype.componentDidUpdate=function(){this.calculateComponentsForLoad()},e.prototype.componentDidMount=function(){this.calculateComponentsForLoad()},e.prototype.componentWillUnmount=function(){},e.defaultProps={elementCreator:null,items:[],className:null,loadMetricName:null,isShowing:!1,onLoadCallback:null,dynamicLoad:!1},e}(Vn.PureComponent);t.MetricsReportingCollectionView=i});e(Cb);Cb.MetricsReportingCollectionView;var Mb=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.XrayNavigationParameterType,n=function(n){function e(e){var t=n.call(this,e,{isFullViewOpen:Rv.IsFullViewOpenStore,filterStore:Rv.XrayCollectionFilterAction.store})||this;return t.prevScrollPos=0,t.getCollectionViewRef=function(e){t.collectionViewRef=e},t.calculateLastIteminCollection=function(e,t){for(var n=e.getBoundingClientRect(),r=0;r<t.length;r++){if(t[r].getBoundingClientRect().bottom>n.bottom+1e-4)return r}return t.length},t.getArrowEnabled=function(){return!(Xh.getBrowser().getType()===Xh.BrowserType.IE)},t.collectionViewRef=null,t}return i(e,n),e.prototype.componentWillReceiveProps=function(e){if(this.props.isShowing&&!e.isShowing||this.props.isShowing&&e.isShowing){var t=Ld.findDOMNode(this.collectionViewRef);xt.exists(t)&&(this.prevScrollPos=t.scrollTop)}if(!this.props.isShowing&&e.isShowing&&Rv.XrayInsightClient.getInstance().sendImpressionStartEvent(Rv.XrayInsightImpressionType.PASSIVE,this.props.viewModel.id),this.props.isShowing&&!e.isShowing){t=Ld.findDOMNode(this.collectionViewRef);var n=0;xt.exists(t)&&(n=this.calculateLastIteminCollection(t,t.childNodes)),Rv.XrayInsightClient.getInstance().sendImpressionEndEvent(this.props.viewModel.id,this.props.viewModel.items.length,n)}},e.prototype.render=function(){var e=this.props.viewModel,t=this.getCollectionClassName(e.style),n=Vn.createElement(Cb.MetricsReportingCollectionView,{className:PS(t,{show:this.props.isShowing}),elementCreator:this.createElement.bind(this),items:e.items,isShowing:this.props.isShowing,onLoadCallback:this.props.loadListener,dynamicLoad:e.dynamicLoad,ref:this.getCollectionViewRef,analytics:e.analytics,widgetID:e.id});e.style===Rv.CollectionStyle.CAROUSEL&&(n=Vn.createElement(wb.CarouselView,{className:"xrayCarousel",collectionView:n,enableArrow:this.getArrowEnabled()}));var r=e.title?this.props.viewModelRenderer.renderViewModel(e.title,function(){},this.props.isShowing,this.props.selectionDataMap):null,i=this.getWrapperClassName(e.style);return i||r?Vn.createElement("div",{className:i},r,n):n},e.prototype.componentDidMount=function(){n.prototype.componentDidMount.call(this),this.scrollToSelectedItem()},e.prototype.componentDidUpdate=function(e){var t=Ld.findDOMNode(this.collectionViewRef);xt.exists(t)&&(F.isEqual(e.viewModel,this.props.viewModel)||(this.state.isFullViewOpen||this.props.isShowing?t.scrollTop=this.prevScrollPos:(t.scrollTop=0,this.prevScrollPos=0))),this.scrollToSelectedItem()},e.prototype.createElement=function(e,t,n){return this.props.viewModelRenderer.renderViewModel(e,n,this.props.isShowing,this.props.selectionDataMap,{key:e.id})},e.prototype.scrollToSelectedItem=function(){if(null!==this.collectionViewRef){var e=this.props.selectionDataMap[o.ITEM_ID]||null;null!==e&&this.collectionViewRef.scrollToItem(e)}},e.prototype.getCollectionClassName=function(e){switch(e){case Rv.CollectionStyle.GRID:return"xrayFullScreenGrid";case Rv.CollectionStyle.LIST:return"xrayListView";case Rv.CollectionStyle.CAROUSEL:return null;case Rv.CollectionStyle.STATIC_CAROUSEL:return"relatedNamesContainer";case Rv.CollectionStyle.COLLAPSIBLE_LIST:case Rv.CollectionStyle.QUICKVIEW_LIST:return PS("xrayQuickViewList",qS.ScrollableVertical,{show:this.props.isShowing});case Rv.CollectionStyle.TITLE:return"xrayTitle";case Rv.CollectionStyle.HORIZONTAL_QUICKVIEW:return"replayQuickAreaContainer";case Rv.CollectionStyle.POP_UP:return"dismissibleContainer";default:throw new Error("Unrecognized style "+Rv.CollectionStyle[e])}},e.prototype.getWrapperClassName=function(e){switch(e){case Rv.CollectionStyle.GRID:return"xrayGridContainer";case Rv.CollectionStyle.LIST:return"xrayListContainer";case Rv.CollectionStyle.CAROUSEL:return"xrayCarouselWrapper";case Rv.CollectionStyle.STATIC_CAROUSEL:case Rv.CollectionStyle.QUICKVIEW_LIST:case Rv.CollectionStyle.COLLAPSIBLE_LIST:case Rv.CollectionStyle.TITLE:case Rv.CollectionStyle.POP_UP:return null;case Rv.CollectionStyle.HORIZONTAL_QUICKVIEW:return"horizontalQuickviewContainer";default:throw new Error("Unrecognized style "+Rv.CollectionStyle[e])}},e}(Rv.ComputedStateView);t.XrayCollectionView=n});e(Mb);Mb.XrayCollectionView;var Ib=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=S.of("ScalingSpecUtils"),n=function(){function e(){}return e.getDefaultScalingSpec=function(e){return void 0===e&&(e=window),[{viewportWidth:Y.Styling.LARGE_SCREEN_MIN_WIDTH,mediaQuery:e.matchMedia(Y.Styling.SCREEN_LARGE_MEDIA_QUERY),scaleFactor:Y.Styling.EXTRA_LARGE_SCREEN_MIN_WIDTH/Y.Styling.LARGE_SCREEN_MIN_WIDTH}]},e.scalingSpecFromBreakpoints=function(r,e,i){return void 0===i&&(i=window),o(r,"defaultSize").exists(),o(0<r,"defaultSize > 0").is.true(),o(e,"breakpoints").is.not.empty(),F.chain(e).sortBy(function(e){return e.viewportWidth}).map(function(e){var t="(max-width:"+e.viewportWidth+"px)",n=i.matchMedia(t);return{viewportWidth:e.viewportWidth,scaleFactor:e.size/r,mediaQuery:n}}).value()},e.scalingSpecFromGridSizing=function(e,t,n){void 0===n&&(n=window),o(e,"defaultSize").exists(),o(0<e,"defaultSize > 0").is.true(),o(t,"gridSizes").is.not.empty();var r=F.map(t,function(e){return{viewportWidth:e.viewportWidth,size:(e.viewportWidth-2*e.externalSpacing-e.internalSpacing*(e.numCols-1))/e.numCols}});return this.scalingSpecFromBreakpoints(e,r,n)},e}();t.ScalingSpecUtils=n});e(Ib);Ib.ScalingSpecUtils;var Eb=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.None=0]="None",r[r.Crop=1]="Crop",r[r.Stretch=2]="Stretch",r[r.Fit=3]="Fit",t.ScalingStrategy=n});e(Eb);Eb.ScalingStrategy;var _b=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.buildScaledAndCenteredImageUrl=function(e,t,n,r,i,o){if(!xt.exists(e))return null;var a=new wb.ImageUrlBuilder(e),s=0,l=0,u=r/i;if(t/n<u){var c=Math.round(n*u);t<c&&(s=(c-t)/2),i<n?a.addUpscaleToRectangleTag(c,n):a.addScaleToHeightTag(n)}else{var d=Math.round(t/u);n<d&&(l=(d-n)/2),r<t?a.addUpscaleToRectangleTag(t,d):a.addScaleToWidthTag(t)}return(0<s||0<l)&&a.addCropTag(Math.floor(s),Math.floor(l),t,n),xt.exists(o)&&a.addFormatTag(o),a.create()},e.buildFixedSizeImageUrl=function(e,t,n,r,i){if(void 0===r&&(r=1),!xt.exists(e))return null;r<1&&0<r&&(t=Math.round(t*r),n=Math.round(n*r));var o=new wb.ImageUrlBuilder(e);return o.addUpscaleToRectangleTag(t,n),xt.exists(i)&&o.addFormatTag(i),o.create()},e.buildScaledToFitImageUrl=function(e,t,n,r,i,o){if(i<=0||r<=0)throw new Error("Invalid values for actualHeight: "+i+" and actualWidth: "+r);if(!xt.exists(e))return null;var a=0,s=0,l=r/i;t/n<l?s=(a=t)/l:(a=n*l,s=n);var u=new wb.ImageUrlBuilder(e);return a=Math.round(100*a)/100,s=Math.round(100*s)/100,u.addUpscaleToRectangleTag(a,s),xt.exists(o)&&u.addFormatTag(o),u.create()},e.buildSanitizedScaledImageUrl=function(e,t,n,r){if(!xt.exists(e))return null;var i,o=e.tags,a=o.length-1;i=0<o.length&&this.ASPECT_RATIO_FREE_RESIZE_TAG_PATTERN.test(o[a])?o.slice(0,a):o;var s=new wb.ImageUrlBuilder(e);return s.setUrlSourceTagFilter(function(){return!1}),s.addTags(i),s.addUpscaleToRectangleTag(t,n),xt.exists(r)&&s.addFormatTag(r),s.create()},e.ASPECT_RATIO_FREE_RESIZE_TAG_PATTERN=/UR[0-9]+,[0-9]+/,e}();t.ImageUrlUtils=n});e(_b);_b.ImageUrlUtils;var xb=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function l(){}return l.createImageUrl=function(e,t){var n=l.getCurrentScaleFactor(t.scalingSpec),r=xt.withDefault(window.devicePixelRatio,1)*n,i=l.computeTargetImageSize(t.targetWidthPx,t.targetHeightPx,r),o=null;if(0!==i.width&&0!==i.height){var a=wb.ImageUrlParser.parse(e),s=void 0;switch(t.scalingStrategy){case Eb.ScalingStrategy.Crop:s=_b.ImageUrlUtils.buildScaledAndCenteredImageUrl(a,i.width,i.height,t.imageWidth,t.imageHeight,t.imageFormatType);break;case Eb.ScalingStrategy.Stretch:s=_b.ImageUrlUtils.buildFixedSizeImageUrl(a,i.width,i.height,void 0,t.imageFormatType);break;case Eb.ScalingStrategy.Fit:s=_b.ImageUrlUtils.buildScaledToFitImageUrl(a,i.width,i.height,t.imageWidth,t.imageHeight,t.imageFormatType);break;case Eb.ScalingStrategy.None:default:s=new wb.ImageUrlBuilder(a).addScaleToHeightTag(i.height).addScaleToWidthTag(i.width).addFormatTag(t.imageFormatType).create()}null!==s&&(o=s.url)}return xt.withDefault(o,e)},l.getCurrentScaleFactor=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.mediaQuery.matches)return n.scaleFactor}return 1},l.computeTargetImageSize=function(e,t,n){return 0===e||0===t?{width:0,height:0}:{width:Math.round(e*n),height:Math.round(t*n)}},l}();t.ScaledUrlFactory=n});e(xb);xb.ScaledUrlFactory;var kb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return this.props.shouldShow?Vn.createElement(wb.LoadingSpinner,i({},this.props)):null},t}(Vn.PureComponent);t.XrayLoadingSpinner=o});e(kb);kb.XrayLoadingSpinner;var Rb=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.onImageLoaded=function(){t.setState({hasImageLoaded:!0,hasPreviousImageLoaded:!0,imageUrl:t.props.imageUrl}),t.props.onLoadCallback&&t.props.onLoadCallback()},t.state={hasPreviousImageLoaded:!1,hasImageLoaded:!1,imageUrl:null},t}return i(e,n),e.prototype.componentWillReceiveProps=function(e){var t=!xt.isNullOrUndefined(this.props.imageUrl),n=this.props.imageUrl===e.imageUrl;this.setState({hasImageLoaded:t&&this.state.hasImageLoaded&&n})},e.prototype.render=function(){var e,t={},n=!this.state.hasPreviousImageLoaded||this.props.shouldShowPlaceholderOnUpdate&&!this.state.hasImageLoaded,r=PS("imageView",this.props.className),i=PS("imageSurface",{show:!n,fullImage:this.props.scalingStrategy===Eb.ScalingStrategy.None});if(n||(t.backgroundImage="url("+this.state.imageUrl+")"),!this.props.imageUrl&&this.props.onLoadCallback&&this.props.onLoadCallback(),this.props.placeholderIsSpinner){var o=PS("spinnerContainer",{show:n});e=Vn.createElement("div",{className:o},Vn.createElement(kb.XrayLoadingSpinner,{className:"whiteSpinner",spinnerSvg:this.props.placeholder,shouldShow:n,spinnerDelayMs:200}))}else{var a=PS("placeholder",{show:n});e=Vn.createElement(wb.SVGImage,{className:a,src:this.props.placeholder})}return Vn.createElement("div",{className:r},Vn.createElement("div",{className:i,style:t}),e,Vn.createElement("img",{className:"imageSurface",src:this.props.imageUrl,onLoad:this.onImageLoaded}))},e.defaultProps={imageUrl:null,placeholder:null,placeholderIsSpinner:!1,shouldShowPlaceholderOnUpdate:!0,className:null,onLoadCallback:null,scalingStrategy:Eb.ScalingStrategy.Crop},e}(Vn.PureComponent);t.ImageView=n});e(Rb);Rb.ImageView;var Ab=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.createXrayImageView=function(e,t,n,r,i){var o=Eb.ScalingStrategy.Fit,a=null,s=n,l=t;return xt.exists(e)&&(a=e.imageUrl,0<e.height&&0<e.width&&(s=e.height,l=e.width)),xt.exists(i)||(i=function(){}),Vn.createElement(u,{imageUrl:a,imageWidth:l,imageHeight:s,targetWidthPx:t,targetHeightPx:n,scalingSpec:Ib.ScalingSpecUtils.getDefaultScalingSpec(),scalingStrategy:o,imageFormatType:wb.ImageFormatType.PNG,onLoadCallback:i,placeholder:r})};var u=function(n){function e(e){var t=n.call(this,e)||this;return t.computeState=function(e){var t=null;return null!==e.imageUrl&&(t=xb.ScaledUrlFactory.createImageUrl(e.imageUrl,{imageWidth:e.imageWidth,imageHeight:e.imageHeight,targetWidthPx:e.targetWidthPx,targetHeightPx:e.targetHeightPx,scalingSpec:e.scalingSpec,scalingStrategy:e.scalingStrategy,imageFormatType:e.imageFormatType})),{imageUrl:t}},t.state=t.computeState(e),t}return i(e,n),e.prototype.componentWillReceiveProps=function(e){this.setState(this.computeState(e))},e.prototype.shouldComponentUpdate=function(e,t){return this.props!==e||this.state.imageUrl!==t.imageUrl},e.prototype.render=function(){return Vn.createElement(Rb.ImageView,{className:this.props.className,imageUrl:this.state.imageUrl,placeholder:this.props.placeholder,placeholderIsSpinner:this.props.placeholderIsSpinner,onLoadCallback:this.props.onLoadCallback,scalingStrategy:this.props.scalingStrategy,shouldShowPlaceholderOnUpdate:this.props.shouldShowPlaceholderOnUpdate})},e.defaultProps={imageUrl:null,placeholder:null,placeholderIsSpinner:!1,className:null,imageWidth:0,imageHeight:0,targetWidthPx:0,targetHeightPx:0,onLoadCallback:null,scalingSpec:Ib.ScalingSpecUtils.getDefaultScalingSpec(),scalingStrategy:Eb.ScalingStrategy.Crop},e}(Vn.Component);t.XrayAssetImageView=u});e(Ab);Ab.createXrayImageView,Ab.XrayAssetImageView;var Ob=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.TV=1920,e.PC=1440,e.TABLET=1024,e.MOBILE=667,e.COMPACT=533,e.S=480,e.XS=320,e.XXS=240,e}();t.XrayBreakpoints=n});e(Ob);Ob.XrayBreakpoints;var Lb=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.getDimensionsForStyle=function(e){return this.dimensionsMap[e]},e.dimensionsMap=((n={})[Rv.GridTileStyle.CAST]={targetWidthPx:267,targetHeightPx:400,scalingSpec:Ib.ScalingSpecUtils.scalingSpecFromGridSizing(267,[{viewportWidth:Ob.XrayBreakpoints.XXS,numCols:1,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.XS,numCols:2,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.S,numCols:3,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.COMPACT,numCols:4,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.MOBILE,numCols:5,internalSpacing:13,externalSpacing:30},{viewportWidth:Ob.XrayBreakpoints.TABLET,numCols:5,internalSpacing:16,externalSpacing:55},{viewportWidth:Ob.XrayBreakpoints.PC,numCols:6,internalSpacing:20,externalSpacing:60},{viewportWidth:Ob.XrayBreakpoints.TV,numCols:6,internalSpacing:20,externalSpacing:100}])},n[Rv.GridTileStyle.IMAGE_GALLERY]={targetWidthPx:265,targetHeightPx:398,scalingSpec:Ib.ScalingSpecUtils.scalingSpecFromGridSizing(265,[{viewportWidth:Ob.XrayBreakpoints.XXS,numCols:1,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.XS,numCols:2,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.S,numCols:3,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.COMPACT,numCols:4,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.MOBILE,numCols:5,internalSpacing:13,externalSpacing:30},{viewportWidth:Ob.XrayBreakpoints.TABLET,numCols:5,internalSpacing:16,externalSpacing:55},{viewportWidth:Ob.XrayBreakpoints.PC,numCols:6,internalSpacing:20,externalSpacing:60},{viewportWidth:Ob.XrayBreakpoints.TV,numCols:6,internalSpacing:20,externalSpacing:100}])},n[Rv.GridTileStyle.VIDEO_GALLERY]={targetWidthPx:640,targetHeightPx:360,scalingSpec:Ib.ScalingSpecUtils.scalingSpecFromBreakpoints(640,[{viewportWidth:Ob.XrayBreakpoints.COMPACT,size:256},{viewportWidth:Ob.XrayBreakpoints.MOBILE,size:320},{viewportWidth:Ob.XrayBreakpoints.TABLET,size:400},{viewportWidth:Ob.XrayBreakpoints.PC,size:512},{viewportWidth:Ob.XrayBreakpoints.TV,size:640}])},n[Rv.GridTileStyle.FILMO_MOVIE]={targetWidthPx:208,targetHeightPx:277,scalingSpec:Ib.ScalingSpecUtils.scalingSpecFromBreakpoints(208,[{viewportWidth:Ob.XrayBreakpoints.COMPACT,size:86},{viewportWidth:Ob.XrayBreakpoints.MOBILE,size:107},{viewportWidth:Ob.XrayBreakpoints.TABLET,size:133},{viewportWidth:Ob.XrayBreakpoints.PC,size:166},{viewportWidth:Ob.XrayBreakpoints.TV,size:208}])},n[Rv.GridTileStyle.FILMO_TV]={targetWidthPx:371,targetHeightPx:277,scalingSpec:Ib.ScalingSpecUtils.scalingSpecFromBreakpoints(371,[{viewportWidth:Ob.XrayBreakpoints.COMPACT,size:152},{viewportWidth:Ob.XrayBreakpoints.MOBILE,size:190},{viewportWidth:Ob.XrayBreakpoints.TABLET,size:238},{viewportWidth:Ob.XrayBreakpoints.PC,size:297},{viewportWidth:Ob.XrayBreakpoints.TV,size:371}])},n[Rv.GridTileStyle.RELATED_NAME]={targetWidthPx:67,targetHeightPx:100,scalingSpec:Ib.ScalingSpecUtils.scalingSpecFromBreakpoints(67,[{viewportWidth:Ob.XrayBreakpoints.COMPACT,size:34},{viewportWidth:Ob.XrayBreakpoints.MOBILE,size:43},{viewportWidth:Ob.XrayBreakpoints.TABLET,size:53},{viewportWidth:Ob.XrayBreakpoints.PC,size:67},{viewportWidth:Ob.XrayBreakpoints.TV,size:67}])},n[Rv.GridTileStyle.PERSON]={targetWidthPx:267,targetHeightPx:400,scalingSpec:Ib.ScalingSpecUtils.scalingSpecFromGridSizing(267,[{viewportWidth:Ob.XrayBreakpoints.XXS,numCols:1,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.XS,numCols:2,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.S,numCols:3,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.COMPACT,numCols:4,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.MOBILE,numCols:5,internalSpacing:13,externalSpacing:30},{viewportWidth:Ob.XrayBreakpoints.TABLET,numCols:5,internalSpacing:16,externalSpacing:55},{viewportWidth:Ob.XrayBreakpoints.PC,numCols:6,internalSpacing:20,externalSpacing:60},{viewportWidth:Ob.XrayBreakpoints.TV,numCols:6,internalSpacing:20,externalSpacing:100}])},n[Rv.GridTileStyle.MUSIC]={targetWidthPx:267,targetHeightPx:400,scalingSpec:Ib.ScalingSpecUtils.scalingSpecFromGridSizing(267,[{viewportWidth:Ob.XrayBreakpoints.XXS,numCols:1,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.XS,numCols:2,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.S,numCols:3,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.COMPACT,numCols:4,internalSpacing:10,externalSpacing:20},{viewportWidth:Ob.XrayBreakpoints.MOBILE,numCols:5,internalSpacing:13,externalSpacing:30},{viewportWidth:Ob.XrayBreakpoints.TABLET,numCols:5,internalSpacing:16,externalSpacing:55},{viewportWidth:Ob.XrayBreakpoints.PC,numCols:6,internalSpacing:20,externalSpacing:60},{viewportWidth:Ob.XrayBreakpoints.TV,numCols:6,internalSpacing:20,externalSpacing:100}])},n),e}();t.GridTileDimensionUtils=r});e(Lb);Lb.GridTileDimensionUtils;var Fb=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return"data:image/svg+xml;base64,"+jS.encodeString(e)},r=function(){function t(){}return t.GetSvgFromPlaceholder=function(e){switch(e){case Rv.XrayPlaceholder.PERSON:return t.CAST_PLACEHOLDER;case Rv.XrayPlaceholder.MUSIC:return t.MUSIC_PLACEHOLDER;case Rv.XrayPlaceholder.SCENES:return t.SCENES_PLACEHOLDER;case Rv.XrayPlaceholder.PRODUCT:return t.PRODUCT_PLACEHOLDER;case Rv.XrayPlaceholder.FALLBACK_1X1:return t.FALLBACK_1X1;case Rv.XrayPlaceholder.FALLBACK_16X9:return t.FALLBACK_16X9;case Rv.XrayPlaceholder.FALLBACK_4X3:return t.FALLBACK_4X3;default:throw new Error("Unknown placeholder type "+Rv.XrayPlaceholder[e])}},t.BACK_ARROW=n("<svg width=\"11\" height=\"17\" viewBox=\"0 0 11 17\" xmlns=\"http://www.w3.org/2000/svg\"><title>Artboard 16</title><path d=\"M2.632 10l6.53 6 1.069-.9-7.272-6.6 7.183-6.6-.98-.9-6.53 6L1 8.5 2.632 10z\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),t.CAST_PLACEHOLDER=n("<svg width=\"280\" height=\"280\" viewBox=\"0 0 280 280\" xmlns=\"http://www.w3.org/2000/svg\"><title>castPlaceholder</title><g fill=\"none\" fill-rule=\"evenodd\"><path opacity=\".3\" d=\"M0 0h280v280H0z\"/><g transform=\"translate(77 77)\" fill=\"#949494\"><path d=\"M.283 126.742h126.052c0-20.173-11.002-37.962-27.738-48.481-9.48 8.629-21.99 13.378-35.288 13.378-13.297 0-25.808-4.749-35.288-13.378C11.283 88.78.283 106.569.283 126.742z\"/><circle cx=\"63.309\" cy=\"39.475\" r=\"38.785\"/></g></g></svg>"),t.MUSIC_PLACEHOLDER=n("<svg width=\"280\" height=\"280\" viewBox=\"0 0 280 280\" xmlns=\"http://www.w3.org/2000/svg\"><title>musicPlaceholder</title><g fill=\"none\" fill-rule=\"evenodd\"><path opacity=\".3\" d=\"M0 0h280v280H0z\"/><g fill=\"#949494\"><path d=\"M97.547 170.438c9.557 0 17.304 5.891 17.304 13.156 0 7.266-7.747 13.157-17.304 13.157-9.557 0-17.304-5.89-17.304-13.157 0-7.265 7.747-13.156 17.304-13.156\"/><path d=\"M121.558 183.6c-1.997-26.5-46.248-26.5-48.244 0-.968 12.854 13.571 19.641 24.122 20.108 12.023.53 23.209-7.977 24.122-20.107M193.992 164.806c-1.997-26.5-46.249-26.5-48.244 0-.97 12.852 13.57 19.639 24.121 20.107 12.022.53 23.21-7.978 24.123-20.107\"/><path d=\"M121.558 183.595v-80.551c0-8.95-13.95-8.95-13.95 0v80.55c0 8.95 13.95 8.95 13.95 0M194.26 164.8V84.249c0-8.95-13.95-8.95-13.95 0v80.55c0 8.95 13.95 8.95 13.95 0\"/><path d=\"M116.498 109.508l72.557-18.64c8.652-2.224 4.98-15.576-3.685-13.35-24.186 6.213-48.373 12.426-72.557 18.64-8.654 2.223-4.981 15.576 3.685 13.35\"/><path d=\"M116.498 118.1l72.557-18.64c8.652-2.224 4.98-15.576-3.685-13.35a1109616.2 1109616.2 0 0 0-72.557 18.64c-8.654 2.223-4.981 15.576 3.685 13.35\"/><path d=\"M116.498 125.617l72.557-18.64c8.652-2.223 4.98-15.575-3.685-13.35l-72.557 18.641c-8.654 2.223-4.981 15.576 3.685 13.35\"/><path d=\"M113.778 102.597l.963 15.483 75.763-19.342-1.848-14.489-74.878 18.348\"/></g></g></svg>"),t.PLAY=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"90\" height=\"90\" viewBox=\"0 0 90 90\"><path fill=\"#FFF\" d=\"M88.164 42.761c2.447 1.237 2.447 3.241 0 4.478L4.434 89.514C1.985 90.75 0 89.547 0 86.83V3.169C0 .45 1.985-.751 4.434.486l83.73 42.275z\"/></svg>"),t.PAUSE=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"75\" height=\"95\" viewBox=\"0 0 75 95\"><path fill=\"#FFF\" d=\"M0 0h25v95H0zM50 0h25v95H50z\"/></svg>"),t.REWIND=n("<svg width=\"80\" height=\"85\" viewBox=\"0 0 80 85\" xmlns=\"http://www.w3.org/2000/svg\"><title>10s back</title><path d=\"M15.197 14.478l3.268 1.753C9.495 22.79 3.662 33.387 3.662 45.352c0 19.913 16.143 36.056 36.056 36.056 19.914 0 36.057-16.143 36.057-36.056 0-18.24-13.547-33.308-31.127-35.713v4.868s.008.968-.305 1.103c-.425.183-1.04-.224-1.04-.224L31.428 9.049s-.818-.386-.818-.74c0-.422.816-.797.816-.797L43.6.898s.368-.264.772-.048c.29.154.276.823.276.823V6.24c19.451 2.427 34.507 19.004 34.507 39.113 0 21.78-17.656 39.437-39.437 39.437-21.78 0-39.436-17.657-39.436-39.437 0-12.51 5.83-23.65 14.915-30.874\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),t.FAST_FORWARD=n("<svg width=\"80\" height=\"85\" viewBox=\"0 0 80 85\" xmlns=\"http://www.w3.org/2000/svg\"><title>10s forward</title><path d=\"M64.24 14.478l-3.269 1.753c8.972 6.559 14.804 17.156 14.804 29.121 0 19.913-16.143 36.056-36.057 36.056-19.913 0-36.056-16.143-36.056-36.056 0-18.24 13.547-33.308 31.127-35.713v4.868s-.008.968.305 1.103c.425.183 1.04-.224 1.04-.224L48.01 9.049s.818-.386.818-.74c0-.422-.817-.797-.817-.797L35.837.898s-.369-.264-.772-.048c-.29.154-.276.823-.276.823V6.24C15.337 8.666.282 25.243.282 45.352c0 21.78 17.656 39.437 39.436 39.437s39.437-17.657 39.437-39.437c0-12.51-5.831-23.65-14.915-30.874\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),t.SCENES_PLACEHOLDER=n("<svg width=\"280\" height=\"280\" viewBox=\"0 0 280 280\" xmlns=\"http://www.w3.org/2000/svg\"><title>scenesPlaceholder</title><g fill=\"none\" fill-rule=\"evenodd\"><path opacity=\".3\" d=\"M0 0h280v280H0z\"/><path d=\"M106.156 140.177l84.29-43.646-7.19-14.887c-1.992-3.933-6.799-5.832-10.75-3.853L86.801 120.72c-3.943 1.986-6.023 6.693-4.04 10.634l3.32 7.46v54.655c0 4.412 4.559 10.531 8.982 10.531h95.975c4.422 0 7.014-6.127 7.014-10.53v-53.293h-91.896zm44.892 39.89h-31.992a3.995 3.995 0 0 1-3.999-3.99 3.995 3.995 0 0 1 4-3.988h31.991a3.995 3.995 0 0 1 3.999 3.989 3.995 3.995 0 0 1-3.999 3.989zm23.994-15.956h-55.986a3.995 3.995 0 0 1-3.999-3.989 3.995 3.995 0 0 1 4-3.989h55.985a3.995 3.995 0 0 1 3.999 3.989 3.995 3.995 0 0 1-4 3.989z\" fill=\"#949494\"/></g></svg>"),t.MORE_PHOTOS=n("<svg width=\"21\" height=\"21\" viewBox=\"0 0 21 21\" xmlns=\"http://www.w3.org/2000/svg\"><title>Artboard 17</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M1 1h5v5H1zM8 1h5v5H8zM15 1h5v5h-5zM1 8h5v5H1zM8 8h5v5H8zM15 8h5v5h-5zM1 15h5v5H1zM8 15h5v5H8zM15 15h5v5h-5z\"/></g></svg>"),t.IMDB_LOGO=n("<svg width=\"60\" height=\"32\" viewBox=\"0 0 60 32\" xmlns=\"http://www.w3.org/2000/svg\"><title>Artboard 14</title><g transform=\"translate(1 1)\" fill=\"none\" fill-rule=\"evenodd\"><rect stroke-opacity=\".37\" stroke=\"#FFF\" width=\"58\" height=\"30\" rx=\"3.429\"/><g fill=\"#FFF\"><path d=\"M8.353 7.03h4.233v15.76H8.353V7.03zM21.612 7.03l-.98 7.362-.606-4.003a112.24 112.24 0 0 0-.508-3.36h-5.487v15.76h3.707l.013-10.405 1.56 10.406h2.641l1.48-10.638.014 10.638h3.695V7.03h-5.529M32.831 9.738v10.343h.667a.666.666 0 0 0 .666-.662V10.4a.663.663 0 0 0-.666-.663h-.667zm.885 13.052c1.014 0 1.773-.054 2.277-.16.504-.108.927-.296 1.27-.564.342-.27.582-.642.72-1.118.138-.476.22-1.421.22-2.833V12.58c0-1.49-.06-2.49-.155-2.999a2.793 2.793 0 0 0-.705-1.385c-.376-.415-.925-.713-1.647-.894-.722-.181-1.9-.272-3.95-.272H28.59v15.76h5.127zM44.444 13.246a.739.739 0 0 0-.733.734v5.909c0 .405.326.734.733.734a.739.739 0 0 0 .734-.734V13.98a.732.732 0 0 0-.734-.734zM39.631 7.03v15.76h3.81l.264-1.004c.345.403.725.706 1.14.908.416.201 1.037.302 1.516.302.67 0 1.247-.17 1.734-.51.486-.34.795-.74.927-1.203.132-.463.198-1.167.198-2.112V14.75c0-.952-.022-1.573-.066-1.864-.044-.292-.174-.59-.39-.893-.216-.304-.53-.54-.942-.709-.412-.169-.898-.253-1.459-.253-.486 0-1.11.094-1.525.28a3.345 3.345 0 0 0-1.13.845V7.03h-4.077z\"/></g></g></svg>"),t.STATS=n("<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><title>Icons/Dark/Player/Stats/hover@1x</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M17 15.5v5a1.5 1.5 0 0 0 3 0v-5a1.5 1.5 0 1 0-3 0zM12 2a1.5 1.5 0 0 0-1.5 1.5v17a1.5 1.5 0 0 0 3 0v-17A1.5 1.5 0 0 0 12 2M7 20.5a1.5 1.5 0 1 1-3 0v-11a1.5 1.5 0 1 1 3 0v11z\"/></g></svg>"),t.PLAYER_PLACEHOLDER=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"60\" height=\"60\" viewBox=\"0, 0, 400,400\"><g fill-rule=\"evenodd\"><path d=\"M192.561 108.403c-4.175.453-6.778.921-7.405 1.332-.532.348-1.93.839-3.107 1.092-1.177.252-2.775.889-3.55 1.416-.776.526-1.718.957-2.093.957s-.999.35-1.385.777c-.387.428-1.207.888-1.821 1.023-.614.135-1.434.595-1.821 1.023-.386.427-.902.777-1.145.777-.244 0-1.161.627-2.038 1.392-.878.766-1.706 1.396-1.841 1.4-.771.025-6.695 5.895-8.755 8.676-.77 1.04-1.805 2.331-2.3 2.87-.495.538-.9 1.195-.9 1.458 0 .264-.36.806-.8 1.204-.44.398-.8 1.031-.8 1.406s-.42 1.301-.932 2.056c-.513.756-1.145 1.984-1.405 2.73s-.727 1.638-1.038 1.982c-.311.344-.833 1.706-1.161 3.026-.329 1.32-.86 3.12-1.181 4-1.56 4.279-1.512 25.637.062 27.534.238.287.719 1.755 1.069 3.262.349 1.507.972 3.168 1.383 3.691.411.523.86 1.463.998 2.09.138.627.59 1.447 1.005 1.823.415.376.878 1.249 1.029 1.941.151.693.656 1.743 1.123 2.334.466.591 1.472 1.941 2.234 3s1.61 2.195 1.885 2.525l1.615 1.94c1.709 2.056 2.988 3.255 6.5 6.093 1.203.972 2.542 2.082 2.976 2.467.434.385 1.003.7 1.264.7.262 0 .699.269.972.598.274.329 1.206.811 2.073 1.071.867.259 1.752.8 1.967 1.201.214.402.699.731 1.076.731.377.001 1.316.387 2.086.858.77.47 2.44 1.099 3.711 1.396 1.271.297 2.722.81 3.224 1.14.503.329 2.703.783 4.89 1.008 2.186.225 5.408.571 7.159.769 4.114.463 15.924-.803 18.169-1.948.806-.411 2.311-.875 3.343-1.029 1.033-.155 2.078-.523 2.323-.818.245-.295 1.106-.751 1.913-1.014.807-.264 1.977-.903 2.599-1.421.622-.518 1.45-.942 1.841-.942s1.197-.45 1.79-1c.594-.55 1.313-1 1.599-1 .286 0 1.061-.495 1.723-1.1a132.14 132.14 0 0 1 3.347-2.9c2.181-1.83 4.564-4.252 6.369-6.47a33.429 33.429 0 0 1 1.9-2.126c.495-.493.9-1.075.9-1.295 0-.219.54-1.078 1.2-1.909.66-.831 1.2-1.749 1.2-2.041 0-.292.54-1.383 1.2-2.423.66-1.041 1.2-2.105 1.2-2.365 0-.26.269-.696.597-.969.329-.272.787-1.239 1.019-2.149.233-.909.757-2.463 1.166-3.453.409-.99.86-2.88 1.002-4.2.142-1.32.546-3.75.898-5.4.827-3.88.831-9.414.01-13.2-.357-1.65-.765-4.08-.905-5.4-.14-1.32-.593-3.173-1.006-4.117-.413-.945-.87-2.385-1.016-3.2-.145-.816-.579-1.843-.965-2.283-.386-.44-.91-1.453-1.166-2.252-.255-.798-.817-1.771-1.249-2.162-.432-.39-.785-.974-.785-1.296 0-.698-1.796-3.681-3.2-5.316-.55-.641-1.45-1.716-2-2.39-1.206-1.478-5.584-5.837-7.105-7.075a89.652 89.652 0 0 1-2.454-2.1c-.748-.665-1.581-1.209-1.851-1.209-.271 0-.737-.295-1.035-.655-.299-.36-1.356-1.003-2.349-1.428-.993-.426-2.076-1.01-2.406-1.298-.33-.289-1.05-.659-1.6-.824-.55-.165-1.474-.634-2.054-1.042-.579-.408-2.018-.948-3.196-1.201-1.178-.253-2.555-.73-3.06-1.061-.789-.517-13.595-2.172-15.69-2.028-.33.022-3.497.355-7.039.74m-46.562 109.798c-.509.542-1.302 1.103-1.762 1.247-.796.249-1.887 1.016-4.329 3.045-1.532 1.272-9.923 9.671-10.994 11.004-.813 1.011-2.063 2.615-4.406 5.654-.491.637-1.072 1.628-1.291 2.203-.218.575-.56 1.046-.759 1.046-.198 0-.596.585-.883 1.3-.286.715-.938 1.809-1.448 2.431-.51.622-.927 1.352-.927 1.622s-.45 1.102-1 1.847c-.55.745-1 1.655-1 2.022 0 .366-.431 1.302-.959 2.079-.527.777-1.08 1.964-1.227 2.637-.148.674-.592 1.638-.985 2.143-.394.506-.837 1.735-.984 2.732-.147.997-.602 2.362-1.01 3.033-.408.672-.871 2.016-1.028 2.987-.158.972-.631 2.56-1.052 3.53-.421.969-.949 3.489-1.173 5.6-.224 2.11-.664 4.917-.976 6.237-.489 2.063-.746 5.657-.636 8.9l.03.9h185.585l.254-1.013c.25-.996-.489-9.621-.878-10.251-.11-.177-.446-2.674-.748-5.549-.301-2.874-.748-5.468-.993-5.763-.244-.294-.715-1.83-1.044-3.412-.33-1.583-.858-3.27-1.172-3.75-.314-.48-.767-1.782-1.005-2.894-.239-1.112-.876-2.896-1.417-3.963-.54-1.067-.982-2.158-.982-2.424s-.269-.706-.598-.979c-.329-.274-.813-1.241-1.076-2.149-.263-.909-.894-2.162-1.402-2.784-.508-.622-1.034-1.567-1.167-2.1-.134-.533-.413-.969-.621-.969-.207 0-.623-.589-.923-1.308-.301-.72-.922-1.647-1.38-2.062-.458-.415-.833-.981-.833-1.258 0-.482-.6-1.297-2.8-3.799-.55-.626-1.63-1.89-2.4-2.808-2.206-2.632-4.348-4.755-7.8-7.734-1.76-1.518-3.47-3-3.8-3.293-1.61-1.432-3.086-2.456-3.913-2.714-.502-.157-1.381-.72-1.952-1.25-1.197-1.108-2.443-.988-3.918.378-2.183 2.022-6.204 5.048-6.709 5.048-.21 0-.86.37-1.445.823-2.09 1.618-4.674 3.163-5.301 3.17-.351.004-.964.368-1.364.809-.399.441-1.455.998-2.347 1.238-.893.241-2.058.78-2.591 1.199-.532.418-1.367.761-1.854.761-.488 0-1.694.429-2.681.954-.986.524-2.588 1.086-3.559 1.248-.971.161-2.45.641-3.287 1.065-.967.49-2.951.894-5.451 1.112-2.162.187-4.358.584-4.88.881-1.318.751-18.132.778-19.437.032-.49-.28-2.724-.684-4.966-.897-2.343-.224-4.468-.646-4.999-.994-.508-.332-1.873-.801-3.035-1.042-1.161-.241-2.706-.78-3.434-1.198-.727-.419-1.556-.761-1.84-.761-.285 0-1.311-.421-2.279-.937-.969-.515-2.436-1.159-3.26-1.431-.824-.272-1.498-.655-1.498-.852 0-.197-.887-.739-1.971-1.206-1.085-.466-2.069-1.101-2.188-1.411-.119-.31-.433-.563-.699-.563-.709 0-4.681-2.765-6.464-4.5-.848-.825-1.694-1.5-1.881-1.5-.186 0-.669-.42-1.073-.933-1.147-1.458-2.62-1.643-3.725-.466\" fill=\"#365d75\"/><path d=\"M0 200v200h400V0H0v200m209.4-93.339c.88.345 2.68.801 4 1.014 3.459.559 5.4 1.104 5.4 1.517 0 .197.825.483 1.834.634 1.077.162 2.257.667 2.858 1.224.564.523 1.345.95 1.736.95s1.219.423 1.841.939c.622.517 1.595 1.052 2.162 1.191.567.138 1.522.705 2.121 1.26.599.556 1.338 1.01 1.642 1.01.303 0 .658.333.787.739.129.407.686.945 1.238 1.197.552.251 1.108.729 1.235 1.061.127.331.454.603.725.603.578 0 4.292 3.56 6.021 5.773.66.844 1.598 2.006 2.084 2.581 2.338 2.768 2.971 3.687 3.386 4.916.247.732.78 1.65 1.185 2.041.404.391.855 1.201 1.001 1.8.146.599.688 1.598 1.205 2.22.542.652.939 1.657.939 2.374 0 .694.354 1.621.802 2.097.534.569.923 1.779 1.164 3.626.199 1.525.693 3.402 1.098 4.172 1.112 2.115 1.111 19.887-.001 22-.405.77-.886 2.552-1.068 3.959-.198 1.527-.667 3.013-1.164 3.684-.457.619-.831 1.68-.831 2.36 0 .768-.349 1.568-.921 2.116-.507.485-1.139 1.627-1.404 2.54-.265.912-.734 1.755-1.041 1.873-.307.117-.682.774-.832 1.459-.15.685-.707 1.713-1.238 2.285-.53.573-.964 1.172-.964 1.332 0 .161-.791 1.117-1.758 2.126-.967 1.01-2.127 2.432-2.578 3.162-.45.729-1.774 2.089-2.942 3.022-3.89 3.107-4.328 3.477-5.2 4.382-.476.495-1.072.9-1.324.9s-.867.435-1.366.966c-.499.532-1.374 1.083-1.943 1.226-.569.143-1.556.698-2.193 1.234-.636.536-1.469.974-1.849.974-.38 0-1.302.45-2.047 1-.745.55-1.836 1-2.424 1-.587 0-1.549.378-2.137.841-.719.566-2.062.963-4.108 1.218-1.672.207-3.601.684-4.286 1.059-1.85 1.013-17.76 1.015-19.845.002-.77-.374-2.722-.857-4.338-1.073-1.616-.215-3.239-.664-3.607-.997-.367-.333-1.565-.806-2.661-1.051-1.097-.246-2.354-.773-2.794-1.171-.44-.397-1.29-.839-1.889-.98-.599-.142-1.409-.592-1.8-1-.391-.408-1.399-.964-2.239-1.235-.84-.272-1.618-.729-1.729-1.017-.11-.287-.734-.744-1.387-1.014-.653-.271-1.366-.827-1.585-1.237-.22-.41-.611-.745-.87-.745s-.928-.459-1.486-1.02c-.558-.561-2.13-2.136-3.493-3.5-4.039-4.042-4.522-4.57-4.522-4.945 0-.196-.495-.82-1.1-1.387-1.223-1.145-3.3-4.381-3.3-5.142 0-.27-.45-1.025-1-1.679-.55-.654-1-1.508-1-1.899s-.439-1.184-.974-1.763c-.599-.645-1.084-1.788-1.257-2.958-.155-1.049-.595-2.309-.978-2.801-.412-.529-.807-1.999-.968-3.6-.149-1.488-.62-3.742-1.047-5.008-1.126-3.339-1.126-13.657 0-16.996.427-1.266.898-3.52 1.047-5.008.161-1.601.556-3.071.968-3.6.383-.492.823-1.752.978-2.801.173-1.17.658-2.313 1.257-2.958.535-.579.974-1.372.974-1.763 0-.391.45-1.245 1-1.899.55-.654 1-1.417 1-1.696 0-.576 2.176-4.17 3.255-5.377a93.377 93.377 0 0 0 1.83-2.145c1.466-1.768 6.06-6.389 7.611-7.655l2.365-1.927c2.933-2.386 4.316-3.273 5.105-3.273.471 0 1.16-.355 1.532-.789.371-.434 1.176-.908 1.789-1.053.612-.144 1.501-.615 1.975-1.044.474-.43 1.641-.957 2.594-1.171.953-.214 2.019-.649 2.369-.965.35-.317 2.152-.777 4.006-1.023 1.853-.245 3.595-.629 3.871-.852 1.524-1.229 16.613-1.571 19.498-.442m-59.06 110.464c.583.618 1.375 1.242 1.76 1.387.385.145.7.539.7.875 0 .337.253.613.562.613.524 0 2.874 1.691 4.92 3.538.485.438 1.268.919 1.741 1.069.473.15 1.496.705 2.274 1.233.778.528 1.649.96 1.936.96.287 0 .763.345 1.058.766.295.421 1.219.893 2.054 1.05.835.157 1.819.601 2.186.987.368.387 1.652.91 2.853 1.164 1.201.253 2.484.733 2.852 1.066.368.333 1.906.794 3.417 1.025 1.511.232 3.287.747 3.947 1.146 3.103 1.876 29.529 1.859 32.753-.021.686-.4 2.55-.904 4.142-1.121 1.592-.217 3.168-.667 3.5-1 .333-.333 1.64-.82 2.904-1.083 1.265-.262 2.703-.795 3.197-1.183.493-.388 1.504-.82 2.246-.959.741-.139 1.668-.606 2.058-1.037.39-.431 1.303-.896 2.027-1.031.725-.136 1.407-.48 1.516-.764.109-.284 1.021-.831 2.027-1.215 1.007-.384 1.83-.863 1.83-1.065 0-.201.63-.629 1.4-.951.77-.322 1.4-.759 1.4-.971 0-.213.727-.758 1.617-1.211.889-.454 1.951-1.133 2.359-1.509 2.948-2.711 3.246-2.883 5-2.883 1.242 0 2.096.271 2.893.917 1.345 1.091 2.905 2.171 4.814 3.334 2.891 1.761 11.501 10.085 14.319 13.842 1.034 1.379 2.131 2.651 2.439 2.827.307.176.559.583.559.904 0 .321.37.897.821 1.28.452.383 1.174 1.416 1.606 2.296 1.167 2.382 2.069 3.801 3.073 4.836.495.51.9 1.36.9 1.887 0 .528.45 1.446 1 2.039.571.616 1 1.559 1 2.197 0 .614.352 1.435.781 1.824.43.389 1.006 1.722 1.28 2.962.273 1.24.73 2.435 1.015 2.655.285.22.715 1.48.955 2.8.241 1.32.767 3.03 1.17 3.8.427.817.853 2.808 1.024 4.782.169 1.955.637 4.149 1.108 5.2 1.196 2.663 1.547 16.024.454 17.232-.951 1.051-185.785 1.263-187.211.215-1.182-.869-1.008-13.484.222-16.025.509-1.051.947-3.097 1.162-5.416.23-2.495.538-3.87.931-4.158.324-.237.791-1.581 1.039-2.988.248-1.406.719-2.854 1.046-3.216.328-.362.801-1.614 1.052-2.782.25-1.168.797-2.415 1.214-2.772.417-.358.758-1.072.758-1.587 0-1.032.659-2.463 1.421-3.085.269-.22.607-1.07.75-1.889.144-.818.601-1.726 1.017-2.017.415-.292.87-.984 1.009-1.54.139-.555.692-1.52 1.228-2.144.536-.624.975-1.35.975-1.614 0-.263.45-.965 1-1.558.55-.594 1-1.334 1-1.645 0-.311.495-1.113 1.1-1.781a65.294 65.294 0 0 0 2.1-2.465 47.965 47.965 0 0 1 1.9-2.216c.495-.532.9-1.097.9-1.256 0-.715 10.848-11.275 11.583-11.275.232 0 .814-.45 1.292-1 .478-.55 1.074-1 1.325-1 .251 0 1.061-.54 1.8-1.2 1.868-1.667 4.408-1.7 5.94-.075\" fill=\"#d4d4d4\"/><path d=\"M191.6 107.643c-2.09.414-4.61.919-5.6 1.122-2.099.431-6.246 1.841-7.4 2.516-.44.257-2.242 1.214-4.005 2.125-6.709 3.468-13.342 8.88-17.395 14.192a78.978 78.978 0 0 1-2.101 2.61c-1.062 1.254-2.669 4.112-5.617 9.992-1.762 3.515-3.361 8.701-3.884 12.6l-.833 6.2c-.45 3.346-.343 5.248.685 12.2 1.009 6.826 2.518 11.165 6.372 18.326 4.533 8.423 13.134 17.17 20.778 21.131.88.456 2.68 1.409 4 2.119 2.507 1.347 6.866 3.002 9.6 3.643 7.718 1.812 16.224 2.483 20 1.578.88-.21 3.276-.658 5.324-.995 2.048-.336 4.388-.896 5.2-1.243.812-.348 2.316-.889 3.343-1.202 1.027-.312 3.303-1.376 5.058-2.363 1.755-.987 3.327-1.794 3.495-1.794.167 0 .894-.45 1.616-1 .721-.55 1.438-1 1.593-1 .247 0 3.16-2.432 6.7-5.592.621-.554 2.522-2.628 4.224-4.608 3.466-4.031 4.725-5.933 7.409-11.2.56-1.1 1.19-2.27 1.399-2.6.832-1.312 1.968-5.294 3.618-12.674 1.134-5.075 1.145-13.839.021-18.126-.432-1.65-.789-3.396-.793-3.88-.009-1.11-2.392-8.534-2.973-9.264-.443-.555-1.791-3.084-3.548-6.656-2.619-5.325-17.113-19.4-19.978-19.4-.183 0-1.632-.74-3.22-1.644-8.803-5.01-22.74-7.164-33.088-5.113m15.686.712c4.53.47 7.417.951 8.004 1.336.505.331 1.882.808 3.06 1.061 1.178.253 2.617.793 3.196 1.201.58.408 1.504.877 2.054 1.042.55.165 1.27.535 1.6.824.33.288 1.413.872 2.406 1.298.993.425 2.05 1.068 2.349 1.428.298.36.764.655 1.035.655.27 0 1.103.544 1.851 1.209.747.665 1.852 1.61 2.454 2.1 1.521 1.238 5.899 5.597 7.105 7.075.55.674 1.45 1.749 2 2.39 1.404 1.635 3.2 4.618 3.2 5.316 0 .322.353.906.785 1.296.432.391.994 1.364 1.249 2.162.256.799.78 1.812 1.166 2.252.386.44.82 1.467.965 2.283.146.815.603 2.255 1.016 3.2.413.944.866 2.797 1.006 4.117.14 1.32.548 3.75.905 5.4.821 3.786.817 9.32-.01 13.2-.352 1.65-.756 4.08-.898 5.4-.142 1.32-.593 3.21-1.002 4.2-.409.99-.933 2.544-1.166 3.453-.232.91-.69 1.877-1.019 2.149-.328.273-.597.709-.597.969s-.54 1.324-1.2 2.365c-.66 1.04-1.2 2.131-1.2 2.423 0 .292-.54 1.21-1.2 2.041-.66.831-1.2 1.69-1.2 1.909 0 .22-.405.802-.9 1.295-.495.493-1.35 1.45-1.9 2.126-1.805 2.218-4.188 4.64-6.369 6.47a132.14 132.14 0 0 0-3.347 2.9c-.662.605-1.437 1.1-1.723 1.1-.286 0-1.005.45-1.599 1-.593.55-1.399 1-1.79 1s-1.219.424-1.841.942c-.622.518-1.792 1.157-2.599 1.421-.807.263-1.668.719-1.913 1.014-.245.295-1.29.663-2.323.818-1.032.154-2.537.618-3.343 1.029-2.245 1.145-14.055 2.411-18.169 1.948a879.255 879.255 0 0 0-7.159-.769c-2.187-.225-4.387-.679-4.89-1.008-.502-.33-1.953-.843-3.224-1.14-1.271-.297-2.941-.926-3.711-1.396-.77-.471-1.709-.857-2.086-.858-.377 0-.862-.329-1.076-.731-.215-.401-1.1-.942-1.967-1.201-.867-.26-1.799-.742-2.073-1.071-.273-.329-.71-.598-.972-.598-.261 0-.83-.315-1.264-.7-.434-.385-1.773-1.495-2.976-2.467-3.512-2.838-4.791-4.037-6.5-6.093l-1.615-1.94c-.275-.33-1.123-1.466-1.885-2.525a109.396 109.396 0 0 0-2.234-3c-.467-.591-.972-1.641-1.123-2.334-.151-.692-.614-1.565-1.029-1.941-.415-.376-.867-1.196-1.005-1.823-.138-.627-.587-1.567-.998-2.09-.411-.523-1.034-2.184-1.383-3.691-.35-1.507-.831-2.975-1.069-3.262-1.574-1.897-1.622-23.255-.062-27.534.321-.88.852-2.68 1.181-4 .328-1.32.85-2.682 1.161-3.026.311-.344.778-1.236 1.038-1.982s.892-1.974 1.405-2.73c.512-.755.932-1.681.932-2.056s.36-1.008.8-1.406c.44-.398.8-.94.8-1.204 0-.263.405-.92.9-1.458.495-.539 1.53-1.83 2.3-2.87 2.06-2.781 7.984-8.651 8.755-8.676.135-.004.963-.634 1.841-1.4.877-.765 1.794-1.392 2.038-1.392.243 0 .759-.35 1.145-.777.387-.428 1.207-.888 1.821-1.023.614-.135 1.434-.595 1.821-1.023.386-.427 1.01-.777 1.385-.777s1.317-.431 2.093-.957c.775-.527 2.373-1.164 3.55-1.416 1.177-.253 2.575-.744 3.107-1.092.782-.513 9.089-1.704 14.444-2.072.33-.023 3.789.289 7.686.692m-61.615 109c-.589.47-2.14 1.573-3.446 2.45-5.371 3.607-19.425 18.663-19.425 20.81 0 .268-.261.704-.58.969-.319.264-1.168 1.501-1.885 2.749l-1.881 3.267c-1.338 2.322-2.054 3.798-2.054 4.236 0 .256-.26.682-.578.946-.318.264-.881 1.411-1.251 2.549-.371 1.138-.901 2.339-1.178 2.669-.277.33-.63 1.23-.783 2-.154.77-.61 2.12-1.014 3-.403.88-1 2.59-1.326 3.8-.326 1.21-.873 2.92-1.214 3.8-.342.88-.629 2.422-.638 3.427-.01 1.005-.374 3.165-.808 4.8-.957 3.603-1.492 12.074-.863 13.673l.433 1.1h92.761c82.328 0 92.818-.068 93.263-.605.709-.854.282-12.1-.557-14.707-.339-1.051-.739-3.301-.89-5-.151-1.698-.537-3.808-.857-4.688-.321-.88-.906-2.77-1.301-4.2-1.402-5.068-2.157-6.969-5.407-13.6-2.394-4.886-3.172-6.293-3.955-7.159-.35-.387-.637-.829-.637-.982 0-.374-2.604-4.257-3.526-5.259-.406-.44-1.876-2.199-3.267-3.909-3.669-4.51-10.751-11.163-14.239-13.378a206.7 206.7 0 0 1-2.968-1.963c-2.854-1.913-3.9-1.839-6.6.467-2.485 2.123-4.35 3.497-6 4.42-.66.369-1.333.897-1.495 1.173-.162.275-.792.625-1.4.777-.608.151-1.375.505-1.705.787-.583.496-4.126 2.378-8.2 4.353-1.1.534-2.627 1.107-3.394 1.274-.767.167-1.757.539-2.2.825-.443.287-1.706.731-2.806.987s-3.016.801-4.258 1.211c-8.293 2.74-29.466 2.727-37.142-.022-1.21-.433-2.92-.954-3.8-1.157-.88-.204-3.13-1.037-5-1.852-1.87-.815-4.12-1.745-5-2.067-.88-.322-1.96-.894-2.4-1.272-.44-.378-1.43-.997-2.2-1.375-.77-.379-1.861-1.001-2.424-1.384a589.323 589.323 0 0 0-2.951-1.978c-1.949-1.297-5.253-4.008-6.788-5.569-1.241-1.262-2.883-1.417-4.166-.393m4.053 1.312c.404.513.887.933 1.073.933.187 0 1.033.675 1.881 1.5 1.783 1.735 5.755 4.5 6.464 4.5.266 0 .58.253.699.563.119.31 1.103.945 2.188 1.411 1.084.467 1.971 1.009 1.971 1.206 0 .197.674.58 1.498.852s2.291.916 3.26 1.431c.968.516 1.994.937 2.279.937.284 0 1.113.342 1.84.761.728.418 2.273.957 3.434 1.198 1.162.241 2.527.71 3.035 1.042.531.348 2.656.77 4.999.994 2.242.213 4.476.617 4.966.897 1.305.746 18.119.719 19.437-.032.522-.297 2.718-.694 4.88-.881 2.5-.218 4.484-.622 5.451-1.112.837-.424 2.316-.904 3.287-1.065.971-.162 2.573-.724 3.559-1.248.987-.525 2.193-.954 2.681-.954.487 0 1.322-.343 1.854-.761.533-.419 1.698-.958 2.591-1.199.892-.24 1.948-.797 2.347-1.238.4-.441 1.013-.805 1.364-.809.627-.007 3.211-1.552 5.301-3.17.585-.453 1.235-.823 1.445-.823.505 0 4.526-3.026 6.709-5.048 1.475-1.366 2.721-1.486 3.918-.378.571.53 1.45 1.093 1.952 1.25.827.258 2.303 1.282 3.913 2.714.33.293 2.04 1.775 3.8 3.293 3.452 2.979 5.594 5.102 7.8 7.734.77.918 1.85 2.182 2.4 2.808 2.2 2.502 2.8 3.317 2.8 3.799 0 .277.375.843.833 1.258.458.415 1.079 1.342 1.38 2.062.3.719.716 1.308.923 1.308.208 0 .487.436.621.969.133.533.659 1.478 1.167 2.1.508.622 1.139 1.875 1.402 2.784.263.908.747 1.875 1.076 2.149.329.273.598.713.598.979s.442 1.357.982 2.424c.541 1.067 1.178 2.851 1.417 3.963.238 1.112.691 2.414 1.005 2.894.314.48.842 2.167 1.172 3.75.329 1.582.8 3.118 1.044 3.412.245.295.692 2.889.993 5.763.302 2.875.638 5.372.748 5.549.389.63 1.128 9.255.878 10.251l-.254 1.013H107.2l-.03-.9c-.11-3.243.147-6.837.636-8.9.312-1.32.752-4.127.976-6.237.224-2.111.752-4.631 1.173-5.6.421-.97.894-2.558 1.052-3.53.157-.971.62-2.315 1.028-2.987.408-.671.863-2.036 1.01-3.033.147-.997.59-2.226.984-2.732.393-.505.837-1.469.985-2.143.147-.673.7-1.86 1.227-2.637.528-.777.959-1.713.959-2.079 0-.367.45-1.277 1-2.022.55-.745 1-1.577 1-1.847s.417-1 .927-1.622c.51-.622 1.162-1.716 1.448-2.431.287-.715.685-1.3.883-1.3.199 0 .541-.471.759-1.046.219-.575.8-1.566 1.291-2.203 2.343-3.039 3.593-4.643 4.406-5.654 1.071-1.333 9.462-9.732 10.994-11.004 2.442-2.029 3.533-2.796 4.329-3.045.46-.144 1.253-.705 1.762-1.247 1.105-1.177 2.578-.992 3.725.466\" fill=\"#7c94a4\"/><path d=\"M199.1 106.689c.715.089 1.885.089 2.6 0 .715-.088.13-.161-1.3-.161-1.43 0-2.015.073-1.3.161m25.333 5.832c.092.067.707.437 1.367.824l1.2.702-.944-.823c-.52-.453-1.135-.824-1.367-.824-.232 0-.347.054-.256.121M240 123.8c.746.77 1.447 1.4 1.557 1.4.11 0-.411-.63-1.157-1.4-.746-.77-1.447-1.4-1.557-1.4-.11 0 .411.63 1.157 1.4M144.501 159c.004.88.086 1.193.182.695.096-.497.092-1.217-.008-1.6-.1-.382-.179.025-.174.905m111.645 3.6c.001 2.2.068 3.049.149 1.887.081-1.163.081-2.963-.002-4-.082-1.038-.148-.087-.147 2.113m-111.645 3.6c.004.88.086 1.193.182.695.096-.497.092-1.217-.008-1.6-.1-.382-.179.025-.174.905m54.799 52.487a8.899 8.899 0 0 0 2.2 0c.605-.092.11-.167-1.1-.167-1.21 0-1.705.075-1.1.167m63.1 4.238c0 .069.585.654 1.3 1.3l1.3 1.175-1.175-1.3c-1.095-1.212-1.425-1.484-1.425-1.175m-130 5.275c-.972.99-1.677 1.8-1.567 1.8.11 0 .995-.81 1.967-1.8.972-.99 1.677-1.8 1.567-1.8-.11 0-.995.81-1.967 1.8m63.1 8.482a5.661 5.661 0 0 0 1.8 0c.495-.095.09-.173-.9-.173s-1.395.078-.9.173m4.8 0a5.661 5.661 0 0 0 1.8 0c.495-.095.09-.173-.9-.173s-1.395.078-.9.173M106.509 283.6c0 .99.078 1.395.173.9a5.661 5.661 0 0 0 0-1.8c-.095-.495-.173-.09-.173.9m187.215 5.8c.002 1.32.077 1.812.166 1.093.089-.719.087-1.799-.004-2.4s-.164-.013-.162 1.307\" fill=\"#8a9cac\"/><path d=\"M191.702 106.39c-.713.169-1.523.49-1.8.713-.276.223-2.018.607-3.871.852-1.854.246-3.656.706-4.006 1.023-.35.316-1.416.751-2.369.965-.953.214-2.12.741-2.594 1.171-.474.429-1.363.9-1.975 1.044-.613.145-1.418.619-1.789 1.053-.372.434-1.061.789-1.532.789-.789 0-2.172.887-5.105 3.273l-2.365 1.927c-1.551 1.266-6.145 5.887-7.611 7.655a93.377 93.377 0 0 1-1.83 2.145c-1.079 1.207-3.255 4.801-3.255 5.377 0 .279-.45 1.042-1 1.696-.55.654-1 1.508-1 1.899s-.439 1.184-.974 1.763c-.599.645-1.084 1.788-1.257 2.958-.155 1.049-.595 2.309-.978 2.801-.412.529-.807 1.999-.968 3.6-.149 1.488-.62 3.742-1.047 5.008-1.126 3.339-1.126 13.657 0 16.996.427 1.266.898 3.52 1.047 5.008.161 1.601.556 3.071.968 3.6.383.492.823 1.752.978 2.801.173 1.17.658 2.313 1.257 2.958.535.579.974 1.372.974 1.763 0 .391.45 1.245 1 1.899.55.654 1 1.409 1 1.679 0 .761 2.077 3.997 3.3 5.142.605.567 1.1 1.191 1.1 1.387 0 .375.483.903 4.522 4.945 1.363 1.364 2.935 2.939 3.493 3.5.558.561 1.227 1.02 1.486 1.02.259 0 .65.335.87.745.219.41.932.966 1.585 1.237.653.27 1.277.727 1.387 1.014.111.288.889.745 1.729 1.017.84.271 1.848.827 2.239 1.235.391.408 1.201.858 1.8 1 .599.141 1.449.583 1.889.98.44.398 1.697.925 2.794 1.171 1.096.245 2.294.718 2.661 1.051.368.333 1.991.782 3.607.997 1.616.216 3.568.699 4.338 1.073 2.085 1.013 17.995 1.011 19.845-.002.685-.375 2.614-.852 4.286-1.059 2.046-.255 3.389-.652 4.108-1.218.588-.463 1.55-.841 2.137-.841.588 0 1.679-.45 2.424-1 .745-.55 1.667-1 2.047-1 .38 0 1.213-.438 1.849-.974.637-.536 1.624-1.091 2.193-1.234.569-.143 1.444-.694 1.943-1.226.499-.531 1.114-.966 1.366-.966s.848-.405 1.324-.9c.872-.905 1.31-1.275 5.2-4.382 1.168-.933 2.492-2.293 2.942-3.022.451-.73 1.611-2.152 2.578-3.162.967-1.009 1.758-1.965 1.758-2.126 0-.16.434-.759.964-1.332.531-.572 1.088-1.6 1.238-2.285.15-.685.525-1.342.832-1.459.307-.118.776-.961 1.041-1.873.265-.913.897-2.055 1.404-2.54.572-.548.921-1.348.921-2.116 0-.68.374-1.741.831-2.36.497-.671.966-2.157 1.164-3.684.182-1.407.663-3.189 1.068-3.959 1.112-2.113 1.113-19.885.001-22-.405-.77-.899-2.647-1.098-4.172-.241-1.847-.63-3.057-1.164-3.626-.448-.476-.802-1.403-.802-2.097 0-.717-.397-1.722-.939-2.374-.517-.622-1.059-1.621-1.205-2.22-.146-.599-.597-1.409-1.001-1.8-.405-.391-.938-1.309-1.185-2.041-.415-1.229-1.048-2.148-3.386-4.916a108.574 108.574 0 0 1-2.084-2.581c-1.729-2.213-5.443-5.773-6.021-5.773-.271 0-.598-.272-.725-.603-.127-.332-.683-.81-1.235-1.061-.552-.252-1.109-.79-1.238-1.197-.129-.406-.484-.739-.787-.739-.304 0-1.043-.454-1.642-1.01-.599-.555-1.554-1.122-2.121-1.26-.567-.139-1.54-.674-2.162-1.191-.622-.516-1.45-.939-1.841-.939s-1.172-.427-1.736-.95c-.601-.557-1.781-1.062-2.858-1.224-1.009-.151-1.834-.437-1.834-.634 0-.413-1.941-.958-5.4-1.517-1.32-.213-3.12-.669-4-1.014-1.74-.681-15.109-.886-17.698-.271m15.993.85c.718.212 2.989.644 5.048.96 2.059.315 3.949.741 4.2.946.251.205 1.357.641 2.457.97 1.1.329 3.17 1.243 4.6 2.032 1.43.789 3.455 1.822 4.5 2.296 1.045.475 1.9.997 1.9 1.161 0 .164.519.513 1.153.776.634.262 1.532.869 1.995 1.348.462.479 1.411 1.321 2.108 1.871 4.827 3.808 11.193 11.306 12.613 14.855.34.85.759 1.545.931 1.545.172 0 .619.765.992 1.7.374.935.888 1.951 1.144 2.258.558.671 2.146 5.139 2.716 7.642.225.99.8 3.33 1.277 5.2 1.218 4.776 1.211 14.688-.013 19.4-.457 1.76-.949 4.01-1.094 5-.144.99-.494 2.16-.777 2.6-.282.44-.736 1.7-1.008 2.8-.272 1.1-.821 2.36-1.22 2.8-.399.44-.858 1.25-1.02 1.8-.162.55-.497 1.252-.744 1.559-.247.308-1.17 1.873-2.051 3.479-1.968 3.586-6.3 8.562-10.938 12.562-1.148.99-2.474 2.205-2.947 2.7-.474.495-1.075.9-1.335.9-.261 0-.957.38-1.547.844-.59.464-1.829 1.241-2.754 1.726-.924.485-2.581 1.382-3.681 1.993-2.481 1.377-6.773 2.914-10.2 3.652-1.43.307-3.95.866-5.6 1.242-3.897.886-12.413.901-15.8.029-1.32-.341-3.39-.744-4.6-.897-1.21-.153-3.23-.708-4.488-1.234-1.258-.525-2.518-.955-2.8-.955-.282 0-1.862-.711-3.512-1.579-1.65-.867-3.762-1.94-4.693-2.382-5.26-2.5-15.771-12.359-18.752-17.59-2.402-4.217-2.999-5.309-4.288-7.849-.781-1.54-1.628-3.61-1.883-4.6-.254-.99-.613-1.984-.796-2.209-.184-.225-.543-1.665-.797-3.2a384.223 384.223 0 0 0-1.027-5.831c-.72-3.88-.723-10.329-.007-13.834.307-1.499.684-3.806.839-5.126.155-1.32.624-3.155 1.043-4.078.418-.923.761-1.983.761-2.355 0-.703 2.055-4.963 4.93-10.22.919-1.679 2.615-4.134 3.77-5.454 1.155-1.321 2.1-2.498 2.1-2.617 0-.425 2.674-2.924 6.496-6.069 5.606-4.614 6.12-4.986 7.584-5.485.726-.247 1.749-.781 2.274-1.186.525-.405 1.175-.736 1.446-.736.271 0 .921-.334 1.446-.742.525-.408 1.674-.958 2.554-1.223.88-.265 2.41-.81 3.4-1.21 1.699-.689 6.847-1.714 12.2-2.43 2.825-.378 10.028-.109 11.895.445M144.4 217.2c-.739.66-1.549 1.2-1.8 1.2-.251 0-.847.45-1.325 1s-1.06 1-1.292 1c-.735 0-11.583 10.56-11.583 11.275 0 .159-.405.724-.9 1.256a47.965 47.965 0 0 0-1.9 2.216 65.294 65.294 0 0 1-2.1 2.465c-.605.668-1.1 1.47-1.1 1.781 0 .311-.45 1.051-1 1.645-.55.593-1 1.295-1 1.558 0 .264-.439.99-.975 1.614-.536.624-1.089 1.589-1.228 2.144-.139.556-.594 1.248-1.009 1.54-.416.291-.873 1.199-1.017 2.017-.143.819-.481 1.669-.75 1.889-.762.622-1.421 2.053-1.421 3.085 0 .515-.341 1.229-.758 1.587-.417.357-.964 1.604-1.214 2.772-.251 1.168-.724 2.42-1.052 2.782-.327.362-.798 1.81-1.046 3.216-.248 1.407-.715 2.751-1.039 2.988-.393.288-.701 1.663-.931 4.158-.215 2.319-.653 4.365-1.162 5.416-1.23 2.541-1.404 15.156-.222 16.025 1.426 1.048 186.26.836 187.211-.215 1.093-1.208.742-14.569-.454-17.232-.471-1.051-.939-3.245-1.108-5.2-.171-1.974-.597-3.965-1.024-4.782-.403-.77-.929-2.48-1.17-3.8-.24-1.32-.67-2.58-.955-2.8-.285-.22-.742-1.415-1.015-2.655-.274-1.24-.85-2.573-1.28-2.962-.429-.389-.781-1.21-.781-1.824 0-.638-.429-1.581-1-2.197-.55-.593-1-1.511-1-2.039 0-.527-.405-1.377-.9-1.887-1.004-1.035-1.906-2.454-3.073-4.836-.432-.88-1.154-1.913-1.606-2.296-.451-.383-.821-.959-.821-1.28 0-.321-.252-.728-.559-.904-.308-.176-1.405-1.448-2.439-2.827-2.818-3.757-11.428-12.081-14.319-13.842-1.909-1.163-3.469-2.243-4.814-3.334-.797-.646-1.651-.917-2.893-.917-1.754 0-2.052.172-5 2.883-.408.376-1.47 1.055-2.359 1.509-.89.453-1.617.998-1.617 1.211 0 .212-.63.649-1.4.971-.77.322-1.4.75-1.4.951 0 .202-.823.681-1.83 1.065-1.006.384-1.918.931-2.027 1.215-.109.284-.791.628-1.516.764-.724.135-1.637.6-2.027 1.031-.39.431-1.317.898-2.058 1.037-.742.139-1.753.571-2.246.959-.494.388-1.932.921-3.197 1.183-1.264.263-2.571.75-2.904 1.083-.332.333-1.908.783-3.5 1-1.592.217-3.456.721-4.142 1.121-3.224 1.88-29.65 1.897-32.753.021-.66-.399-2.436-.914-3.947-1.146-1.511-.231-3.049-.692-3.417-1.025-.368-.333-1.651-.813-2.852-1.066-1.201-.254-2.485-.777-2.853-1.164-.367-.386-1.351-.83-2.186-.987-.835-.157-1.759-.629-2.054-1.05-.295-.421-.771-.766-1.058-.766-.287 0-1.158-.432-1.936-.96s-1.801-1.083-2.274-1.233c-.473-.15-1.256-.631-1.741-1.069-2.046-1.847-4.396-3.538-4.92-3.538-.309 0-.562-.276-.562-.613 0-.336-.315-.73-.7-.875-.385-.145-1.177-.769-1.76-1.387-1.532-1.625-4.072-1.592-5.94.075m8.013 2.59c1.99 1.655 3.757 3.01 3.927 3.01.17 0 .735.405 1.256.9.981.933 2.236 1.698 5.051 3.082.906.445 1.873 1.081 2.149 1.413.276.333.709.605.963.605s1.537.534 2.851 1.187c1.315.654 2.66 1.199 2.99 1.213.33.014 1.5.468 2.6 1.009 1.1.541 2.33.985 2.733.987.403.002 2.023.445 3.6.983 2.928 1.001 17.049 2.713 19.667 2.386.66-.083 4.137-.435 7.726-.783 4.375-.424 7.51-.954 9.512-1.607 1.643-.536 3.386-.981 3.874-.988.489-.006 1.788-.455 2.888-.996 1.1-.541 2.288-.985 2.64-.987.353-.002 1.487-.454 2.522-1.004 1.034-.55 2.059-1 2.278-1 .342 0 4.977-2.48 6.76-3.618.33-.21 1.05-.563 1.6-.784.55-.221 1.81-1.027 2.8-1.793.99-.765 2.458-1.749 3.263-2.187.805-.438 1.525-.936 1.6-1.107.284-.644 3.483-2.882 4.475-3.131.82-.206 1.623.141 3.879 1.68 1.565 1.067 3.236 2.156 3.714 2.421 1.947 1.078 9.849 8.589 13.17 12.519 4.005 4.739 6.018 7.566 8.17 11.473.479.869 1.154 1.816 1.5 2.103.346.287.629.723.629.969 0 .432 2.062 4.97 3.568 7.855.403.77.866 2.03 1.031 2.8.164.77.615 2.03 1.002 2.8s.834 2.186.994 3.146c.16.961.612 2.491 1.005 3.4.393.91.833 2.914.979 4.454.145 1.54.609 4.171 1.031 5.846.815 3.233 1.295 14.083.666 15.054-.529.818-185.991.725-186.671-.094-.715-.861-.31-11.852.516-14.019.339-.888.8-3.264 1.025-5.28.225-2.017.671-4.081.992-4.587.32-.506.772-1.82 1.005-2.92.232-1.1.79-2.713 1.239-3.585.45-.871.819-1.951.819-2.4.001-.448.333-1.357.737-2.02.404-.662 1.048-2.147 1.43-3.3.383-1.152.848-2.095 1.033-2.095.185 0 .55-.675.811-1.5s.864-2.13 1.341-2.9c1.57-2.535 1.83-2.982 2.812-4.825.535-1.004 1.257-2.061 1.604-2.349.347-.288.631-.734.631-.99s.533-1.089 1.184-1.851c.651-.762 1.191-1.512 1.2-1.667.009-.155.421-.707.916-1.226.495-.519 1.35-1.546 1.9-2.281 1.566-2.093 11.192-11.589 12.934-12.759.862-.578 2.129-1.407 2.816-1.84.688-.433 1.61-1.121 2.05-1.527 1.259-1.164 2.647-.596 6.613 2.705\" fill=\"#90a4ac\"/></g></svg>"),t.HIGHLIGHT_PLAY=n("<svg width=\"40\" height=\"40\" viewBox=\"0 0 40 40\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>Parts/icon/play/default</title><defs><path d=\"M18 0c9.941 0 18 8.059 18 18s-8.059 18-18 18S0 27.941 0 18 8.059 0 18 0z\" id=\"b\"/><filter x=\"-8.3%\" y=\"-8.3%\" width=\"116.7%\" height=\"116.7%\" filterUnits=\"objectBoundingBox\" id=\"a\"><feOffset in=\"SourceAlpha\" result=\"shadowOffsetOuter1\"/><feGaussianBlur stdDeviation=\"1\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"/><feComposite in=\"shadowBlurOuter1\" in2=\"SourceAlpha\" operator=\"out\" result=\"shadowBlurOuter1\"/><feColorMatrix values=\"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.204115716 0\" in=\"shadowBlurOuter1\"/></filter></defs><g fill=\"none\" fill-rule=\"evenodd\"><g opacity=\".7\" transform=\"translate(2 2)\"><use fill=\"#000\" filter=\"url(#a)\" xlink:href=\"#b\"/><path stroke=\"#FFF\" stroke-width=\"2\" d=\"M18 1C8.61 1 1 8.61 1 18s7.61 17 17 17 17-7.61 17-17S27.39 1 18 1z\" stroke-linejoin=\"square\" fill=\"#222\"/></g><path d=\"M17.13 13.152c-.621-.357-1.13-.063-1.13.654v12.388c0 .717.509 1.011 1.13.654l10.78-6.198c.621-.358.621-.942 0-1.3l-10.78-6.198z\" fill=\"#FFF\"/></g></svg>"),t.PRODUCT_PLACEHOLDER=n("<svg width=\"310\" height=\"460\" viewBox=\"0 0 310 460\" xmlns=\"http://www.w3.org/2000/svg\"><title>ic_no_product cart</title><defs><linearGradient x1=\"29.996%\" y1=\"-3.626%\" x2=\"70.935%\" y2=\"122.937%\" id=\"a\"><stop stop-color=\"#314358\" offset=\"0%\"/><stop stop-color=\"#182430\" offset=\"100%\"/></linearGradient></defs><g fill=\"none\" fill-rule=\"evenodd\"><path fill=\"url(#a)\" d=\"M0 0h310v460H0z\"/><g fill=\"#171F29\"><path d=\"M274 179.746h-25.571l-32.727 71.07H137.04L89.236 147H36v23.161h38.317l47.827 103.82V274H230.68v-.148L274 179.746M148 299.509c0 8.01-6.482 14.491-14.497 14.491-8.016 0-14.503-6.482-14.503-14.491 0-8.023 6.487-14.509 14.503-14.509 8.015 0 14.497 6.486 14.497 14.509M234 299.509c0 8.01-6.506 14.491-14.518 14.491-7.985 0-14.482-6.482-14.482-14.491 0-8.023 6.497-14.509 14.482-14.509 8.012 0 14.518 6.486 14.518 14.509\"/><path d=\"M152 193.509c0 8.01-6.506 14.491-14.518 14.491-7.985 0-14.482-6.482-14.482-14.491 0-8.023 6.497-14.509 14.482-14.509 8.012 0 14.518 6.486 14.518 14.509M190 193.509c0 8.01-6.506 14.491-14.518 14.491-7.985 0-14.482-6.482-14.482-14.491 0-8.023 6.497-14.509 14.482-14.509 8.012 0 14.518 6.486 14.518 14.509M228 193.509c0 8.01-6.506 14.491-14.518 14.491-7.985 0-14.482-6.482-14.482-14.491 0-8.023 6.497-14.509 14.482-14.509 8.012 0 14.518 6.486 14.518 14.509M171 229.509c0 8.01-6.506 14.491-14.518 14.491-7.985 0-14.482-6.482-14.482-14.491 0-8.023 6.497-14.509 14.482-14.509 8.012 0 14.518 6.486 14.518 14.509M209 229.509c0 8.01-6.506 14.491-14.518 14.491-7.985 0-14.482-6.482-14.482-14.491 0-8.023 6.497-14.509 14.482-14.509 8.012 0 14.518 6.486 14.518 14.509\"/></g></g></svg>"),t.FALLBACK_1X1=n("<svg width=\"500px\" height=\"500px\" viewBox=\"0 0 500 500\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>1:1 Fallback@2x</title><defs><path d=\"M172.34365,234.248051 C172.680174,234.248051 173.061079,234.358142 173.463999,234.610227 C195.777328,248.650604 223.381738,257.108629 251.887739,257.108629 C271.125874,257.108629 292.261543,252.78916 311.713194,243.865881 C314.644413,242.525864 317.100375,245.953391 314.232407,248.256874 C296.880624,262.096704 271.724837,269.461538 250.06324,269.461538 C219.707929,269.461538 192.372948,257.323901 171.679338,237.123723 C171.273622,236.72824 171.060106,236.293839 171,235.886785 L171,235.886785 L171,235.40961 C171.101691,234.75047 171.62098,234.248051 172.34365,234.248051 Z M316.968106,231 C322.258489,231 326.531611,232.136315 327.441588,233.351516 C329.3538,235.886399 326.949907,253.462991 317.636961,261.845635 C316.211888,263.14393 314.856357,262.444821 315.485024,260.751042 C317.578602,255.12837 322.264779,242.505143 320.04365,239.444351 C317.826016,236.377248 305.372528,237.982674 299.788604,238.706676 C298.923007,238.817116 298.431326,238.461602 298.358989,237.932186 L298.358989,237.932186 L298.358989,237.647144 C298.417347,237.187849 298.741641,236.652474 299.359475,236.183363 C304.490506,232.296542 311.311846,231 316.968106,231 Z\" id=\"path-1\"></path></defs><g id=\"1:1-Fallback\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g id=\"Group\" transform=\"translate(0.000000, 0.000000)\"><rect id=\"Mask\" fill=\"#1C2430\" x=\"0\" y=\"0.448717949\" width=\"500\" height=\"500\"></rect><mask id=\"mask-2\" fill=\"white\"><use xlink:href=\"#path-1\"></use></mask><use id=\"Mask\" fill=\"#384354\" xlink:href=\"#path-1\"></use></g></g></svg>"),t.FALLBACK_16X9=n("<svg width=\"1600px\" height=\"900px\" viewBox=\"0 0 1600 900\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>16:9 Fallback@2x</title><defs><path d=\"M553.017629,394.393764 C554.094506,394.393764 555.313401,394.746053 556.602746,395.552728 C628.005398,440.481934 716.33951,467.547613 807.558713,467.547613 C869.120744,467.547613 936.754885,453.725313 999.000169,425.17082 C1008.38007,420.882766 1016.23915,431.85085 1007.06165,439.221996 C951.535946,483.509453 871.037429,507.076923 801.720317,507.076923 C704.583323,507.076923 617.111384,468.236484 550.891831,403.595915 C549.59354,402.330367 548.910288,400.940283 548.717949,399.637711 L548.717949,399.637711 L548.717949,398.110751 C549.04336,396.001504 550.705083,394.393764 553.017629,394.393764 Z M1015.81589,384 C1032.74511,384 1046.4191,387.636207 1049.33103,391.524851 C1055.45011,399.636477 1047.75765,455.88157 1017.95622,482.706032 C1013.39599,486.860575 1009.05829,484.623427 1011.07003,479.203335 C1017.76948,461.210784 1032.76524,420.816459 1025.65763,411.021923 C1018.5612,401.207193 978.710038,406.344556 960.841483,408.661362 C958.071572,409.014773 956.498191,407.877126 956.266712,406.182996 L956.266712,406.182996 L956.266712,405.270859 C956.453461,403.801118 957.491199,402.087916 959.468269,400.58676 C975.887569,388.148934 997.715856,384 1015.81589,384 Z\" id=\"path-1\"></path></defs><g id=\"16:9-Fallback\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g id=\"Group\" transform=\"translate(0.000000, -3.000000)\"><rect id=\"Mask\" fill=\"#1C2430\" x=\"0\" y=\"-7.95807864e-13\" width=\"1600\" height=\"903\"></rect><mask id=\"mask-2\" fill=\"white\"><use xlink:href=\"#path-1\"></use></mask><use id=\"Mask\" fill=\"#384354\" xlink:href=\"#path-1\"></use></g></g></svg>"),t.FALLBACK_4X3=n("<svg width=\"1200px\" height=\"900px\" viewBox=\"0 0 1200 900\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>4:3 Fallback@2x</title><defs><path d=\"M414.763222,405.795323 C415.57088,405.795323 416.485051,406.05954 417.45206,406.664546 C471.004049,440.361451 537.254633,460.66071 605.669035,460.66071 C651.840558,460.66071 702.566164,450.293985 749.250126,428.878115 C756.285052,425.662074 762.179361,433.888138 755.296238,439.416497 C713.651959,472.63209 653.278071,490.307692 601.290238,490.307692 C528.437492,490.307692 462.833538,461.177363 413.168874,412.696936 C412.195155,411.747775 411.682716,410.705212 411.538462,409.728283 L411.538462,409.728283 L411.538462,408.583063 C411.78252,407.001128 413.028812,405.795323 414.763222,405.795323 Z M761.861917,398 C774.558834,398 784.814327,400.727155 786.998274,403.643638 C791.587582,409.727358 785.818238,451.911177 763.467168,472.029524 C760.046993,475.145431 756.793717,473.46757 758.302519,469.402501 C763.327107,455.908088 774.57393,425.612344 769.243221,418.266443 C763.920899,410.905395 734.032529,414.758417 720.631112,416.496021 C718.553679,416.76108 717.373643,415.907844 717.200034,414.637247 L717.200034,414.637247 L717.200034,413.953144 C717.340095,412.850838 718.118399,411.565937 719.601202,410.44007 C731.915677,401.1117 748.286892,398 761.861917,398 Z\" id=\"path-1\"></path></defs><g id=\"4:3-Fallback\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g id=\"Group\"><rect id=\"Mask\" fill=\"#1C2430\" x=\"0\" y=\"0.0769230769\" width=\"1200\" height=\"900\"></rect><mask id=\"mask-2\" fill=\"white\"><use xlink:href=\"#path-1\"></use></mask><use id=\"Mask\" fill=\"#384354\" xlink:href=\"#path-1\"></use></g></g></svg>"),t}();t.SVG=r});e(Fb);Fb.SVG;var Db=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.doXrayImpressionEventReporting=function(e,t){!e.isShowing&&t.isShowing&&Rv.XrayInsightClient.getInstance().sendImpressionStartEvent(Rv.XrayInsightImpressionType.PASSIVE,e.viewModel.id),e.isShowing&&!t.isShowing&&Rv.XrayInsightClient.getInstance().sendImpressionEndEvent(e.viewModel.id)},e}();t.XrayImpressionEventHelper=n});e(Db);Db.XrayImpressionEventHelper;var Nb=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function c(){return null!==e&&e.apply(this,arguments)||this}return i(c,e),c.prototype.componentWillReceiveProps=function(e){Db.XrayImpressionEventHelper.doXrayImpressionEventReporting(this.props,e)},c.prototype.onClickTile=function(e){null!==e&&Rv.XrayDispatcher.getInstance().dispatch(e)},c.prototype.renderSupplementalText=function(e){return xt.exists(e)?Vn.createElement("div",{className:"supplementalText"},e):null},c.prototype.shouldShowTextAndGradient=function(e){return xt.exists(e.primaryText)||xt.exists(e.secondaryText)||xt.exists(e.tertiaryText)},c.prototype.render=function(){var e=this.props.viewModel,t=e.image.imageData||Rv.EmptyImageModel,n=e.linkAction||null,r=c.STYLE_DATA_MAP[e.style];if(void 0===r)throw new Error("Unhandled style "+Rv.GridTileStyle[e.style]);var i=xt.exists(r.scalingStrategy)?r.scalingStrategy:Eb.ScalingStrategy.Crop,o=xt.exists(r.overlayIcon)?r.overlayIcon:null,a=PS("gridTileElement",r.className,{clickable:null!==n}),s=Lb.GridTileDimensionUtils.getDimensionsForStyle(e.style);if(null===s)return null;var l=PS("textOverlayContainer",{show:this.shouldShowTextAndGradient(e.textMap)}),u=null===o?null:Vn.createElement("div",{className:"overlayIcon"},Vn.createElement(wb.SVGImage,{src:o}));return Vn.createElement("div",{className:a,onClick:this.onClickTile.bind(this,e.linkAction)},Vn.createElement(Ab.XrayAssetImageView,{placeholder:Fb.SVG.GetSvgFromPlaceholder(e.image.placeholder),imageUrl:t.imageUrl,imageWidth:t.width,imageHeight:t.height,targetWidthPx:s.targetWidthPx,targetHeightPx:s.targetHeightPx,onLoadCallback:this.props.loadListener,scalingSpec:s.scalingSpec,scalingStrategy:i}),Vn.createElement("div",{className:l},Vn.createElement("div",{className:"backgroundGradient"}),Vn.createElement("div",{className:"textOverlay"},Vn.createElement("div",{className:"primaryText"},e.textMap.primaryText),this.renderSupplementalText(e.textMap.secondaryText),this.renderSupplementalText(e.textMap.tertiaryText))),u)},c.STYLE_DATA_MAP=((n={})[Rv.GridTileStyle.CAST]={className:"xrayPersonTileElement"},n[Rv.GridTileStyle.IMAGE_GALLERY]={className:"xrayCarouselItem xrayImageGalleryItem"},n[Rv.GridTileStyle.VIDEO_GALLERY]={className:"xrayCarouselItem xrayVideoGalleryItem",overlayIcon:Fb.SVG.PLAY},n[Rv.GridTileStyle.RELATED_NAME]={className:"relatedName"},n[Rv.GridTileStyle.FILMO_MOVIE]={className:"xrayCarouselItem xrayImageCoverMovie",scalingStrategy:Eb.ScalingStrategy.Stretch},n[Rv.GridTileStyle.FILMO_TV]={className:"xrayCarouselItem xrayImageCoverTv",scalingStrategy:Eb.ScalingStrategy.Stretch},n[Rv.GridTileStyle.PERSON]={className:"xrayPersonCarouselTileElement"},n[Rv.GridTileStyle.MUSIC]={className:"xrayMusicTileElement",scalingStrategy:Eb.ScalingStrategy.Stretch},n),c}(Rv.XrayViewModelComponent);t.XrayImageGridTile=o});e(Nb);Nb.XrayImageGridTile;var Ub=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.onClickTile=function(e){null!==e&&Rv.XrayDispatcher.getInstance().dispatch(e)},t.prototype.componentWillReceiveProps=function(e){Db.XrayImpressionEventHelper.doXrayImpressionEventReporting(this.props,e)},t.prototype.renderSupplementalText=function(e){return xt.exists(e)?Vn.createElement("div",{className:"supplementalText"},e):null},t.prototype.render=function(){var e=this.props.viewModel,t=e.linkAction||null,n=PS("gridTileElement xrayFactTileElement",{clickable:null!==t});return Vn.createElement("div",{className:n,onClick:this.onClickTile.bind(this,e.linkAction)},Vn.createElement("div",{className:"textOverlayContainer show"},Vn.createElement("div",{className:"textBody"},this.renderSupplementalText(e.textMap.secondaryText),Vn.createElement("div",{className:"primaryText"},e.textMap.primaryText))))},t}(Rv.XrayViewModelComponent);t.XrayTextGridTile=i});e(Ub);Ub.XrayTextGridTile;var Bb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.componentWillReceiveProps=function(e){Db.XrayImpressionEventHelper.doXrayImpressionEventReporting(this.props,e)},t.prototype.render=function(){var e=this.props.viewModel;if(null===e)return null;var t=null;return null===e.relatedNames?this.props.loadListener():t=this.props.viewModelRenderer.renderViewModel(e.relatedNames,this.props.loadListener,this.props.isShowing,this.props.selectionDataMap),Vn.createElement("div",{className:"listViewItem xrayListViewItem triviaListItem"},Vn.createElement("div",{className:"textContainer"},Vn.createElement("div",{className:"supplementalText"},e.textMap.secondaryText),Vn.createElement("div",{className:"primaryText"},e.textMap.primaryText),t,Vn.createElement("div",{className:"supplementalText"},Vn.createElement("span",{className:"scene"},e.textMap.tertiaryText)," ",e.textMap.quaternaryText)),Vn.createElement("div",{className:"buttonsContainer"},Vn.createElement("div",{className:"buttonWrapper show"},xt.exists(e.jumpToSceneModel)?this.props.viewModelRenderer.renderViewModel(e.jumpToSceneModel,function(){},this.props.isShowing):null)))},t}(Rv.XrayViewModelComponent);t.TriviaListItem=i});e(Bb);Bb.TriviaListItem;var Vb=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.state={shouldDisableBlink:!1},t.shouldBlink=!1,t}return i(e,n),e.prototype.shouldComponentUpdate=function(e,t){if(t.shouldDisableBlink)return!0;var n=e.textContent!==this.props.textContent;return n&&(this.shouldBlink=!0),n},e.prototype.componentDidUpdate=function(){this.setState({shouldDisableBlink:!1})},e.prototype.render=function(){var e=this,t=this.props;if(null===t)return null;var n=PS(t.classname,this.shouldBlink?"blink":"no-blink");return this.shouldBlink&&(this.shouldBlink=!1,setTimeout(function(){e.setState({shouldDisableBlink:!0})},1e3)),Vn.createElement("span",{className:n},this.props.textContent)},e}(Vn.Component);t.BlinkingTextView=n});e(Vb);Vb.BlinkingTextView;var jb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.tableViewItem;return null===e?null:this.renderThreeColumnTableHeader(e,this.props.isPureText,e.id+"_subheader")},t.prototype.renderThreeColumnTableHeader=function(e,t,n){var r,i,o;return t?(r=e.textMap.primaryText,i=e.textMap.secondaryText,o=e.textMap.tertiaryText):(r=null,i=xt.exists(e.imageMap.secondaryImage)?Ab.createXrayImageView(e.imageMap.secondaryImage,20,20,Fb.SVG.FALLBACK_4X3):null,o=xt.exists(e.imageMap.tertiaryImage)?Ab.createXrayImageView(e.imageMap.tertiaryImage,20,20,Fb.SVG.FALLBACK_4X3):null),Vn.createElement("div",{className:"rowHeader",key:n},Vn.createElement("div",{className:"category"},r),Vn.createElement("div",{className:"stat"},i),t?null:Vn.createElement("div",{className:"xrayDivider"}),Vn.createElement("div",{className:"stat"},o))},t}(Vn.PureComponent);t.LiveStatsThreeColumnTableHeaderView=a;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.tableViewItem;return null===e?null:this.renderThreeColumnTableBody(e,this.props.isPureText,e.id+"_body")},t.prototype.renderThreeColumnTableBody=function(e,t,n){return Vn.createElement("div",{className:"normalRow",key:n},Vn.createElement("div",{className:"category"},Vn.createElement(Vb.BlinkingTextView,{textContent:e.textMap.primaryText})),Vn.createElement("div",{className:PS("stat",{highlighted:e.highlightedItemIndex===Rv.TextMapHighlightedIndex.SECONDARY})},Vn.createElement(Vb.BlinkingTextView,{textContent:e.textMap.secondaryText})),t?null:Vn.createElement("div",{className:"xrayDivider"}),Vn.createElement("div",{className:PS("stat",{highlighted:e.highlightedItemIndex===Rv.TextMapHighlightedIndex.TERTIARY})},Vn.createElement(Vb.BlinkingTextView,{textContent:e.textMap.tertiaryText})))},t}(Vn.PureComponent);t.LiveStatsThreeColumnTableBodyView=s;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.tableViewModel;return null===e?null:Vn.createElement("div",{className:PS("threeColumnTable",{pregameOdds:"statsTab_odds"===e.id}),key:e.id+"_table"},this.renderThreeColumnTable(e))},t.prototype.renderThreeColumnTable=function(e){var t=[];t.push(Vn.createElement("div",{className:"tableHeader",key:e.id+"_main_header"},e.textMap.primaryText));for(var n=0;n<e.tables.length;n++)t.push(Vn.createElement("div",{className:"tableContent",key:e.id+"_table_"+n},this.renderThreeColumnTableItem(e.tables[n],this.isPureTextThreeColumnTable(e))));return t},t.prototype.renderThreeColumnTableItem=function(e,t){if(!xt.exists(e))return null;for(var n=[],r=0,i=e.table;r<i.length;r++){var o=i[r];switch(o.style){case Rv.LiveStatsTableRowModelStyle.HEADER:n.push(Vn.createElement(a,{tableViewItem:o,isPureText:t,key:o.id}));break;default:n.push(Vn.createElement(s,{tableViewItem:o,isPureText:t,key:o.id}))}}return n},t.prototype.isPureTextThreeColumnTable=function(e){return e.style===Rv.LiveStatsTableViewModelStyle.THREE_COLUMN&&(!xt.exists(e.imageMap.secondaryImage)&&!xt.exists(e.imageMap.tertiaryImage))},t}(Vn.PureComponent);t.LiveStatsThreeColumnTableView=i});e(jb);jb.LiveStatsThreeColumnTableHeaderView,jb.LiveStatsThreeColumnTableBodyView,jb.LiveStatsThreeColumnTableView;var Xb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.tableViewItem;return null===e?null:this.renderFiveColumnTableHeader(e.textMap,e.imageMap,e.id+"_subheader")},t.prototype.renderFiveColumnTableHeader=function(e,t,n){return Vn.createElement("div",{className:"rowHeader",key:n},Vn.createElement("div",{className:"category"},xt.exists(t.primaryImage)?Ab.createXrayImageView(t.primaryImage,19,19,Fb.SVG.FALLBACK_4X3):null,Vn.createElement(Vb.BlinkingTextView,{classname:"categoryText",textContent:e.primaryText})),Vn.createElement("div",{className:"stat"},e.secondaryText),Vn.createElement("div",{className:"stat"},e.tertiaryText),Vn.createElement("div",{className:"stat"},e.quaternaryText))},t}(Vn.PureComponent);t.LiveStatsFiveColumnTableHeaderView=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.tableViewItem;return null===e?null:this.renderFiveColumnTableBody(e.imageMap,e.textMap,e.id+"_body")},t.prototype.renderFiveColumnTableBody=function(e,t,n){return Vn.createElement("div",{className:"normalRow",key:n},Vn.createElement("div",{className:"category"},xt.exists(e.primaryImage)?Ab.createXrayImageView(e.primaryImage,19,19,Fb.SVG.FALLBACK_4X3):null,Vn.createElement(Vb.BlinkingTextView,{classname:"categoryText",textContent:t.primaryText})),Vn.createElement("div",{className:"stat"},Vn.createElement(Vb.BlinkingTextView,{textContent:t.secondaryText})),Vn.createElement("div",{className:"stat"},Vn.createElement(Vb.BlinkingTextView,{textContent:t.tertiaryText})),Vn.createElement("div",{className:"stat"},Vn.createElement(Vb.BlinkingTextView,{textContent:t.quaternaryText})))},t}(Vn.PureComponent);t.LiveStatsFiveColumnTableBodyView=a;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.tableViewModel;return null===e?null:Vn.createElement("div",{className:"fiveColumnTable",key:e.id+"_table"},this.renderFiveColumnTable(e))},t.prototype.renderFiveColumnTable=function(e){var t=[];t.push(Vn.createElement("div",{className:"tableHeader",key:e.id+"_main_header"},e.textMap.primaryText));for(var n=0;n<e.tables.length;n++)t.push(Vn.createElement("div",{className:"tableContent",key:e.id+"_table_"+n},this.renderFiveColumnTableItem(e.tables[n])));return t},t.prototype.renderFiveColumnTableItem=function(e){if(!xt.exists(e))return null;for(var t=[],n=0,r=e.table;n<r.length;n++){var i=r[n];switch(i.style){case Rv.LiveStatsTableRowModelStyle.HEADER:t.push(Vn.createElement(o,{tableViewItem:i,key:i.id}));break;default:t.push(Vn.createElement(a,{tableViewItem:i,key:i.id}))}}return t},t}(Vn.PureComponent);t.LiveStatsFiveColumnTableView=i});e(Xb);Xb.LiveStatsFiveColumnTableHeaderView,Xb.LiveStatsFiveColumnTableBodyView,Xb.LiveStatsFiveColumnTableView;var zb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.componentDidMount=function(){this.props.loadListener&&this.props.loadListener()},t.prototype.componentWillReceiveProps=function(e){Db.XrayImpressionEventHelper.doXrayImpressionEventReporting(this.props,e)},t.prototype.render=function(){var e=this.props.viewModel;return null===e?null:Vn.createElement("div",{className:"liveStatsTableViewModel"},this.convertTable(e))},t.prototype.convertTable=function(e){switch(e.style){case Rv.LiveStatsTableViewModelStyle.THREE_COLUMN:return Vn.createElement(jb.LiveStatsThreeColumnTableView,{tableViewModel:e});case Rv.LiveStatsTableViewModelStyle.FIVE_COLUMN:return Vn.createElement(Xb.LiveStatsFiveColumnTableView,{tableViewModel:e});default:return null}},t}(Rv.XrayViewModelComponent);t.LiveStatsView=i});e(zb);zb.LiveStatsView;var qb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.renderTextDiv=function(e){return xt.exists(e)?Vn.createElement("div",{className:"supplementalText"},e):null},t.prototype.componentWillReceiveProps=function(e){Db.XrayImpressionEventHelper.doXrayImpressionEventReporting(this.props,e)},t.prototype.render=function(){var e=this.props.viewModel;if(null===e)return null;var t=this.getImageData(e),n=t.imageTargetWidth,r=t.imageTargetHeight,i=t.scalingSpec,o=e.image.imageData||Rv.EmptyImageModel,a=PS("listViewItem","xrayListViewItem",{xraySceneListItem:e.style===Rv.XrayListItemStyle.SCENES}),s=e.jumpToSceneModel||null,l=e.viewInStoreButton||null,u=PS("buttonWrapper",{show:xt.exists(s)}),c=PS("buttonWrapper",{show:xt.exists(l)});return Vn.createElement("div",{className:a},Vn.createElement(Ab.XrayAssetImageView,{className:"imageContainer",imageUrl:o.imageUrl,placeholder:Fb.SVG.GetSvgFromPlaceholder(e.image.placeholder),imageWidth:o.width,imageHeight:o.height,targetWidthPx:n,targetHeightPx:r,scalingSpec:i,onLoadCallback:this.props.loadListener}),Vn.createElement("div",{className:"textContainer"},Vn.createElement("div",{className:"primaryText"},e.textMap.primaryText),this.renderTextDiv(e.textMap.secondaryText),this.renderTextDiv(e.textMap.tertiaryText),this.renderTextDiv(e.textMap.quaternaryText)),Vn.createElement("div",{className:"buttonsContainer"},Vn.createElement("div",{className:u},xt.exists(s)?this.props.viewModelRenderer.renderViewModel(s,function(){},this.props.isShowing):null),Vn.createElement("div",{className:c},xt.exists(l)?this.props.viewModelRenderer.renderViewModel(l,function(){},this.props.isShowing):null)))},t.prototype.getImageData=function(e){switch(e.style){case Rv.XrayListItemStyle.MUSIC:return{imageTargetWidth:t.MUSIC_TARGET_IMAGE_WIDTH,imageTargetHeight:t.TARGET_IMAGE_HEIGHT,scalingSpec:t.IMAGE_SCALING_SPEC};case Rv.XrayListItemStyle.SCENES:return{imageTargetWidth:t.SCENE_TARGET_IMAGE_WIDTH,imageTargetHeight:t.TARGET_IMAGE_HEIGHT,scalingSpec:t.IMAGE_SCALING_SPEC};default:return{}}},t.TARGET_IMAGE_HEIGHT=200,t.MUSIC_TARGET_IMAGE_WIDTH=200,t.SCENE_TARGET_IMAGE_WIDTH=355,t.IMAGE_SCALING_SPEC=Ib.ScalingSpecUtils.scalingSpecFromBreakpoints(t.TARGET_IMAGE_HEIGHT,[{viewportWidth:Ob.XrayBreakpoints.MOBILE,size:128},{viewportWidth:Ob.XrayBreakpoints.TABLET,size:160},{viewportWidth:Ob.XrayBreakpoints.PC,size:200},{viewportWidth:Ob.XrayBreakpoints.TV,size:200}]),t}(Rv.XrayViewModelComponent);t.XrayImageListItem=i});e(qb);qb.XrayImageListItem;var Wb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loadTimeTracker=new Rv.LoadTimeTracker,e}return n(e,t),e.prototype.render=function(){this.loadTimeTracker.setOnLoadListener(this.props.loadListener);var e=this.loadTimeTracker.registerId(0),t=this.loadTimeTracker.registerId(1);return this.loadTimeTracker.lock(),Vn.createElement("div",{className:"xrayDetailView"},Vn.createElement("div",{className:"detailContainer"},this.props.viewModelRenderer.renderViewModel(this.props.viewModel.leftSectionModel,e,this.props.isShowing,this.props.selectionDataMap),Vn.createElement("div",{className:PS("detailMain",qS.ScrollableVertical)},this.props.viewModelRenderer.renderViewModel(this.props.viewModel.rightSectionModel,t,this.props.isShowing,this.props.selectionDataMap))))},e}(Rv.XrayViewModelComponent);t.TwoSectionDetailView=i});e(Wb);Wb.TwoSectionDetailView;var Hb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=Ib.ScalingSpecUtils.scalingSpecFromBreakpoints(310,[{viewportWidth:Ob.XrayBreakpoints.COMPACT,size:240},{viewportWidth:Ob.XrayBreakpoints.MOBILE,size:300},{viewportWidth:Ob.XrayBreakpoints.TABLET,size:375},{viewportWidth:Ob.XrayBreakpoints.PC,size:465},{viewportWidth:Ob.XrayBreakpoints.TV,size:465}]),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.viewModel,t=xt.exists(e.linkAction),n=PS("photoGalleryLinkInfo",{show:t}),r=PS("imageTextContainer",{galleryAvailable:t}),i=t?Vn.createElement("div",{className:"gradientBackground"}):null,o=e.image,a=o.imageData||Rv.EmptyImageModel,s=e.text||null;return Vn.createElement("div",{className:"detailImageContainer"},Vn.createElement("div",{onClick:this.onClickImage.bind(this,e.linkAction),className:r},Vn.createElement(Ab.XrayAssetImageView,{className:"detailImage",imageUrl:a.imageUrl,imageWidth:a.width,imageHeight:a.height,targetWidthPx:310,targetHeightPx:465,scalingSpec:l,placeholder:Fb.SVG.GetSvgFromPlaceholder(o.placeholder),onLoadCallback:this.props.loadListener}),i,Vn.createElement("div",{className:n},Vn.createElement("div",{className:"galleryIcon"},Vn.createElement(wb.SVGImage,{src:Fb.SVG.MORE_PHOTOS})),null===s?null:Vn.createElement("div",null,s))))},t.prototype.onClickImage=function(e){xt.exists(e)&&Rv.XrayDispatcher.getInstance().dispatch(e)},t}(Rv.XrayViewModelComponent);t.DetailPagePhoto=i});e(Hb);Hb.DetailPagePhoto;var Gb=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Vn.createContext({localization:null}),r=n.Provider;t.XrayContextProvider=r;var i=n.Consumer;t.XrayContextConsumer=i});e(Gb);Gb.XrayContextProvider,Gb.XrayContextConsumer;var Kb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){if(!this.props.rawText)return null;for(var e=this.props.rawText.split("\n"),t=[],n=0;n<e.length;n++)t.push(Vn.createElement("span",{key:n},e[n])),t.push(Vn.createElement("br",null));return Vn.createElement("div",{className:this.props.className},t)},t.defaultProps={rawText:null,className:null},t}(Vn.PureComponent);t.MultiLineTextView=i});e(Kb);Kb.MultiLineTextView;var Qb=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){var r=t.call(this,e)||this;return r.textView=null,r.updateExpandability=function(){if(r.props.rawText){var e=Ld.findDOMNode(r.textView),t=e.offsetHeight,n=0<e.scrollHeight-t||r.state.isExpanded;n!==r.state.canExpand&&r.setState({canExpand:n})}},r.expandText=function(){r.setState({isExpanded:!r.state.isExpanded})},r.getButtonText=function(e){var t=e.localization.localizedStrings;return r.state.isExpanded?t.textViewSeeLess:t.textViewSeeMore},r.state={isExpanded:!1,canExpand:!1},r}return n(e,t),e.prototype.componentWillReceiveProps=function(e){this.props.rawText!==e.rawText&&this.setState({isExpanded:!1,canExpand:!1})},e.prototype.componentDidMount=function(){this.updateExpandability()},e.prototype.componentDidUpdate=function(){this.updateExpandability()},e.prototype.render=function(){var t=this,e=this.state.isExpanded,n=this.state.canExpand||this.state.isExpanded,r=PS("expandableTextView",{collapse:!e}),i=PS("readMoreArrow",{show:n,collapse:!e}),o=PS("expandButton",{show:n});return Vn.createElement(Gb.XrayContextConsumer,null,function(e){return Vn.createElement("div",{className:t.props.className},Vn.createElement(Kb.MultiLineTextView,{rawText:t.props.rawText,className:r,ref:function(e){t.textView=e}}),Vn.createElement("div",{className:o,onClick:t.expandText},Vn.createElement("div",{className:i},Vn.createElement(wb.SVGImage,{src:Fb.SVG.BACK_ARROW})),t.getButtonText(e)))})},e.defaultProps={rawText:null},e}(Vn.PureComponent);t.ExpandableTextView=i});e(Qb);Qb.ExpandableTextView;var Yb=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function a(){return null!==e&&e.apply(this,arguments)||this}return i(a,e),a.prototype.render=function(){var e=this,t=this.props.viewModel,n=a.STYLE_CLASS_NAME_MAP[t.style],r=t.linkAction||null,i=PS(n,{textLink:null!==r});this.props.loadListener();var o=Vn.createElement("div",{className:i,onClick:function(){return e.onClick(r)}},Vn.createElement(Kb.MultiLineTextView,{rawText:t.text}));return t.isExpandable?Vn.createElement(Qb.ExpandableTextView,{className:i,rawText:t.text}):o},a.prototype.onClick=function(e){null!==e&&Rv.XrayDispatcher.getInstance().dispatch(e)},a.STYLE_CLASS_NAME_MAP=((n={})[Rv.StyledTextLinkItemStyle.HIDDEN]="hidden",n[Rv.StyledTextLinkItemStyle.PARAGRAPH_TEXT]="xrayDetailTextItem narrow",n[Rv.StyledTextLinkItemStyle.PRIMARY_TEXT]="primaryText",n[Rv.StyledTextLinkItemStyle.SECONDARY_TEXT]="secondaryText",n[Rv.StyledTextLinkItemStyle.SECONDARY_TEXT_LINKABLE]="secondaryText inlineText",n[Rv.StyledTextLinkItemStyle.TITLE]="xrayCarouselTitle xrayDetailTextTitle",n),a}(Rv.XrayViewModelComponent);t.StyledTextLinkView=o});e(Yb);Yb.StyledTextLinkView;var Jb=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.actionBackstackStore=Rv.ActionBackstackStore.getInstance(),t.onBackstackUpdate=function(){t.setState(t.getStateFromStore())},t.state=t.getStateFromStore(),t}return i(e,n),e.prototype.componentDidMount=function(){this.actionBackstackStore.onChange(this.onBackstackUpdate)},e.prototype.componentWillUnmount=function(){this.actionBackstackStore.offChange(this.onBackstackUpdate)},e.prototype.render=function(){var e=this.props.buttonText||null;if(null===e)return null;var t=PS("backButtonContainer",this.props.className,{show:this.state.shouldShow});return Vn.createElement("div",{className:t},Vn.createElement("div",{className:"backButton",onClick:this.onClickBack},Vn.createElement("div",{className:"backArrow"},Vn.createElement(wb.SVGImage,{src:Fb.SVG.BACK_ARROW})),e))},e.prototype.getStateFromStore=function(){return{shouldShow:1<this.actionBackstackStore.getValue().length}},e.prototype.onClickBack=function(){Rv.XrayDispatcher.getInstance().dispatch(new Rv.SelectPreviousAction(Rv.XrayRefMarkers.BACK_BUTTON))},e}(Vn.Component);t.BackButton=n});e(Jb);Jb.BackButton;var $b=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this,t=this.props.viewModel;if(!xt.exists(t))return null;var n=PS("arrow",{show:xt.exists(t.prevItemAction)}),r=PS("arrow flip",{show:xt.exists(t.nextItemAction)}),i=PS("photoGalleryOverlay",{show:this.props.showOverlay});return Vn.createElement("div",{className:i},Vn.createElement("div",{className:"bottomGradientOverlay"}),Vn.createElement("div",{className:"top"}),Vn.createElement("div",{className:"middle"},Vn.createElement("div",{onClick:function(){return e.props.onClickArrow(t.prevItemAction)},className:n},Vn.createElement(wb.SVGImage,{src:Fb.SVG.BACK_ARROW})),Vn.createElement("div",{onClick:function(){return e.props.onClickArrow(t.nextItemAction)},className:r},Vn.createElement(wb.SVGImage,{src:Fb.SVG.BACK_ARROW}))),Vn.createElement("div",{className:"bottom"},Vn.createElement("div",{className:"backContainer"},Vn.createElement(Jb.BackButton,{className:"inline",buttonText:t.exitGalleryText})),this.renderText(t.caption,"caption"),this.renderText(t.numberOfImagesText,"counter")))},t.prototype.renderText=function(e,t){return xt.exists(e)?Vn.createElement("div",{className:t},e):null},t}(Vn.Component);t.PhotoGalleryItemOverlay=i});e($b);$b.PhotoGalleryItemOverlay;var Zb=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Ib.ScalingSpecUtils.scalingSpecFromBreakpoints(1920,[{viewportWidth:Ob.XrayBreakpoints.COMPACT,size:533},{viewportWidth:Ob.XrayBreakpoints.MOBILE,size:667},{viewportWidth:Ob.XrayBreakpoints.TABLET,size:1024},{viewportWidth:Ob.XrayBreakpoints.PC,size:1920},{viewportWidth:Ob.XrayBreakpoints.TV,size:1920}]),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onMouseEnter=function(){t.setState({showOverlay:!0})},t.onMouseLeave=function(){t.setState({showOverlay:!1})},t.onClick=function(){t.setState({showOverlay:!t.state.showOverlay})},t.state={showOverlay:!0},t}return i(e,n),e.prototype.createPreloaders=function(e){return F.map(e,function(e){return xt.exists(e)?Vn.createElement(Ab.XrayAssetImageView,{className:"galleryImagePreloader",imageUrl:e.imageUrl,imageWidth:e.width,imageHeight:e.height,targetWidthPx:1920,targetHeightPx:1080,scalingSpec:o,scalingStrategy:Eb.ScalingStrategy.None}):null})},e.prototype.render=function(){var e=this.props.viewModel;if(!xt.exists(e))return null;var t=xt.exists(e)?e.image.imageData:Rv.EmptyImageModel;return Vn.createElement("div",{className:"photoGalleryItem show",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},Vn.createElement("div",{className:"galleryImageContainer",onClick:this.onClick},this.createPreloaders(e.imagePreloadData),Vn.createElement(Ab.XrayAssetImageView,{className:"galleryImageFull",imageUrl:t.imageUrl,imageWidth:t.width,imageHeight:t.height,targetWidthPx:1920,targetHeightPx:1080,scalingSpec:o,scalingStrategy:Eb.ScalingStrategy.None,placeholderIsSpinner:!0,placeholder:wb.SVG.LoadingSpinner})),Vn.createElement($b.PhotoGalleryItemOverlay,{showOverlay:this.state.showOverlay,onClickArrow:this.props.onClickArrow,viewModel:e}))},e}(Vn.Component);t.PhotoGalleryItemView=n});e(Zb);Zb.PhotoGalleryItemView;var eT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Mf.com.amazon.avod.xray.XrayNavigationParameterType,n=function(n){function e(e){var t=n.call(this,e)||this;return t.photoGalleryItemRef=null,t.handleKeyDown=function(e){switch(e.keyCode){case Y.KeyCode.LEFT_ARROW:t.launchGalleryAction(t.state.currentItem.prevItemAction);break;case Y.KeyCode.RIGHT_ARROW:t.launchGalleryAction(t.state.currentItem.nextItemAction)}},t.launchGalleryAction=function(e){null!==e&&t.galleryDispatcher.dispatch(e)},t.getStateFromStore=function(){t.setState({currentItem:t.dataStore.getValue()})},t.setPhotoGalleryItemRef=function(e){t.photoGalleryItemRef=e},t.state={currentItem:null},t}return i(e,n),e.prototype.componentWillMount=function(){this.dataStore=new Rv.PhotoGallerySwiftStore,this.galleryDispatcher=new Lf.Dispatcher,this.dataStore.initialize(this.galleryDispatcher,this.props.viewModel.galleryItems),this.dataStore.onChange(this.getStateFromStore),this.selectItemFromSelectionMap(this.props.selectionDataMap)},e.prototype.componentDidMount=function(){this.photoGalleryItemRef&&(this.photoGalleryItemRef.focus(),this.photoGalleryItemRef.addEventListener("keydown",this.handleKeyDown))},e.prototype.componentWillUnmount=function(){this.photoGalleryItemRef.removeEventListener("keydown",this.handleKeyDown),this.dataStore.offChange(this.getStateFromStore),this.dataStore.destroy()},e.prototype.componentWillUpdate=function(e){F.isEqual(this.props.viewModel,e.viewModel)||(this.dataStore.destroy(),this.dataStore.initialize(this.galleryDispatcher,e.viewModel.galleryItems)),!this.props.isShowing&&e.isShowing&&this.selectItemFromSelectionMap(e.selectionDataMap)},e.prototype.componentDidUpdate=function(){this.photoGalleryItemRef&&this.props.isShowing&&this.photoGalleryItemRef.focus()},e.prototype.render=function(){return Vn.createElement("div",{ref:this.setPhotoGalleryItemRef,tabIndex:-1},Vn.createElement(Zb.PhotoGalleryItemView,{onClickArrow:this.launchGalleryAction.bind(this),viewModel:this.state.currentItem}))},e.prototype.selectItemFromSelectionMap=function(e){var t=e[o.ITEM_ID]||null;null!==t&&this.galleryDispatcher.dispatch(new Rv.PhotoGalleryChangeItemAction({itemId:t,refMarker:null}))},e}(Rv.XrayViewModelComponent);t.PhotoGallerySwiftContainer=n});e(eT);eT.PhotoGallerySwiftContainer;var tT=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.toggleQuickViewList=function(){var e=Rv.XrayDispatcher.getInstance(),t=!KS.ToggleQuickViewListAction.store.getValue();e.dispatch(new KS.ToggleQuickViewListAction(t))},e}();t.QuickViewActions=n});e(tT);tT.QuickViewActions;var nT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){return t.call(this,e,{listIsExpanded:KS.ToggleQuickViewListAction.store,listIsExpandable:Rv.QuickViewStores.hasDataStore,pageTypeId:Rv.QuickViewStores.pageTypeIdStore,shouldShowArrow:Rv.QuickViewStores.quickViewShouldShowArrowStore})||this}return n(e,t),e.prototype.render=function(){var e=this.props.viewModel;if(null===e)return null;var t=PS("xrayHeaderTitle",{expanded:this.state.listIsExpanded}),n=PS("arrow",{show:this.state.shouldShowArrow&&this.state.listIsExpandable}),r=e.viewAllLinkModel,i=this.state.shouldShowArrow&&this.state.listIsExpandable?this.onClickTitle.bind(this):this.onClickFullViewLink.bind(this,r.linkAction);return this.props.loadListener(),Vn.createElement("div",{className:"collapsibleXrayHeader"},Vn.createElement("div",{className:t,onClick:i},e.logoText,Vn.createElement("div",{className:n},Vn.createElement(wb.SVGImage,{src:Fb.SVG.BACK_ARROW}))),Vn.createElement("div",{className:"xrayDivider"}),Vn.createElement("div",{className:"xrayHeaderViewAll",onClick:this.onClickFullViewLink.bind(this,r.linkAction)},r.label))},e.prototype.onClickFullViewLink=function(e){Rv.XrayDispatcher.getInstance().dispatch(e)},e.prototype.onClickTitle=function(){tT.QuickViewActions.toggleQuickViewList()},e}(Rv.ComputedStateView);t.CollapsibleXrayHeaderView=i});e(nT);nT.CollapsibleXrayHeaderView;var rT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){return t.call(this,e,{isQuickViewExpanded:KS.ToggleQuickViewListAction.store})||this}return n(e,t),e.prototype.render=function(){var e=this.state.isQuickViewExpanded,t=this.props.viewModel.quickViewList;return t.style=Rv.CollectionStyle.COLLAPSIBLE_LIST,this.props.viewModelRenderer.renderViewModel(t,this.props.loadListener,e)},e}(Rv.ComputedStateView);t.XraySwiftCollapsibleListContainer=i});e(rT);rT.XraySwiftCollapsibleListContainer;var iT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dispatcher=Rv.XrayDispatcher.getInstance(),e.onClick=function(){e.dispatcher.dispatch(e.props.viewModel.linkAction)},e}return n(e,t),e.prototype.render=function(){return Vn.createElement("div",{onClick:this.onClick,className:"xrayQuickViewListItem categoryCountItem"},Vn.createElement("div",{className:"textContainer"},Vn.createElement("div",{className:"primaryText"},Vn.createElement("div",null,this.props.viewModel.textMap.primaryText+" "),Vn.createElement("div",{className:"numberText"},this.props.viewModel.textMap.tertiaryText)),Vn.createElement("div",{className:"secondaryText"},this.props.viewModel.textMap.secondaryText)),Vn.createElement("div",{className:"arrow"},Vn.createElement(wb.SVGImage,{src:Fb.SVG.BACK_ARROW})))},e}(Rv.XrayViewModelComponent);t.XrayTabLinkItem=i});e(iT);iT.XrayTabLinkItem;var oT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this,t=this.convertXrayIcon(this.props.viewModel.icon),n=null===t?null:Vn.createElement("div",{className:"icon"},Vn.createElement(wb.SVGImage,{src:t,className:"svgBackground"}));return Vn.createElement("div",{className:"xrayButton iconButton",onClick:function(){return e.onButtonClick(e.props.viewModel.linkAction)}},n,Vn.createElement("span",null,this.props.viewModel.label))},t.prototype.onButtonClick=function(e){Rv.XrayDispatcher.getInstance().dispatch(e)},t.prototype.convertXrayIcon=function(e){switch(e){case Rv.XrayIcon.PLAY:return Fb.SVG.PLAY;default:return null}},t}(Rv.XrayViewModelComponent);t.XrayButton=i});e(oT);oT.XrayButton;var aT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("EmbeddedVideoView"),n=function(n){function e(e){var t=n.call(this,e,{initializationContext:Rv.XrayInitializationContextAction.store,localization:Rv.ReceiveLocalizationAction.store,volume:Rv.ChangeVolumeAction.store})||this;return t.iframe=null,t.player=null,t.onPlayerClosed=function(){t.dispatcher.dispatch(new Rv.ShowXrayModalAction(null))},t.dispatcher=Rv.XrayDispatcher.getInstance(),t}return i(e,n),e.prototype.render=function(){var t=this,e=this.props.viewModel.title,n=xt.exists(e);return Vn.createElement("div",{className:"embeddedVideoViewContainer"},n?Vn.createElement("p",{className:"embeddedVideoTitle"},e):null,Vn.createElement("div",{className:"embeddedVideoView"},Vn.createElement("iframe",{ref:function(e){t.iframe=e}})),n?Vn.createElement("p",{className:"embeddedVideoTitle"}," "):null)},e.prototype.componentDidMount=function(){this.startPlayback()},e.prototype.componentDidUpdate=function(){this.startPlayback()},e.prototype.componentWillUnmount=function(){null!==this.player&&(this.player.off(pS.PlayerEvent.closed,this.onPlayerClosed),this.player.destroy())},e.prototype.startPlayback=function(){if(null!==this.player&&(this.player.off(pS.PlayerEvent.closed,this.onPlayerClosed),this.player.destroy()),null!==this.props.viewModel){var e=this.props.viewModel.contentConfig,t=this.state.initializationContext,n=this.state.localization;if(null!==e&&null!==t&&null!==n){var r=this.state.volume,i=sp.QueryString.getQueryString(),o={clientId:"d5aac186-d7bc-42e5-9c64-a9203c63a9c7",deviceId:t.playerConfig.deviceId,marketplaceId:t.playerConfig.marketplaceId,domElement:this.iframe,locale:n.currentLocale,initialVolume:r,pageVersion:i.xrayEmbeddedPlayerPageVersion,pageEndpoint:i.xrayEmbeddedPlayerPageEndpoint,enableVolume:!1,playerDebug:t.playerConfig.debug};this.player=new pS.EmbeddablePlayer(o),this.player.on(pS.PlayerEvent.closed,this.onPlayerClosed),this.player.start(e)}}},e}(Rv.ComputedStateView);t.EmbeddedVideoView=n,Rv.ShowXrayModalAction.store.onChange(function(){var e=Rv.ShowXrayModalAction.store.getValue();if(null!==e&&null!==e.body&&e.body.type===fS.EmbeddedVideoViewModelType){var t=e.body.contentConfig,n=Rv.XrayInitializationContextAction.store.getValue();if(null===n){var r="Action triggered before init context available";return Rv.XrayInsightClient.getInstance().sendErrorEvent(Rv.XrayInsightErrorType.RUNTIME,r),void o.error(r)}var i={_type:"X-Ray",linkType:"X-Ray",refMarker:t.clickstreamRefMarker,refMarkerIndex:null,navType:"GTI",navValue:t.titleId,scrollAmount:null};n.metricsFeature.reportInteraction("X-Ray","Navigation",null,i)}})});e(aT);aT.EmbeddedVideoView;var sT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=Ib.ScalingSpecUtils.scalingSpecFromBreakpoints(82,[{viewportWidth:Ob.XrayBreakpoints.MOBILE,size:42},{viewportWidth:Ob.XrayBreakpoints.TABLET,size:61},{viewportWidth:Ob.XrayBreakpoints.PC,size:82},{viewportWidth:Ob.XrayBreakpoints.TV,size:82}]),i=function(t){function s(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){Rv.XrayDispatcher.getInstance().dispatch(e.props.viewModel.action)},e}return n(s,t),s.prototype.render=function(){var e,t=this.props.viewModel,n=s.getQuickViewDataForStyle(t.style),r=null,i=n.imageSizeInfo;if(i){var o=t.image.imageData||Rv.EmptyImageModel;r=Vn.createElement(Ab.XrayAssetImageView,{className:"quickViewImage",imageUrl:o.imageUrl,imageWidth:o.width,imageHeight:o.height,targetWidthPx:i.width,targetHeightPx:i.height,placeholder:Fb.SVG.GetSvgFromPlaceholder(t.image.placeholder),onLoadCallback:this.props.loadListener,scalingSpec:l})}else this.props.loadListener();e=t.supplementalText&&t.supplementalText.length?Vn.createElement("div",{className:"supplementalText"},t.supplementalText):null;var a=PS("xrayQuickViewListItem",n.className);return Vn.createElement("div",{className:a,onClick:this.onClick},r,Vn.createElement("div",{className:"textContainer"},Vn.createElement("div",{className:"primaryText"},t.primaryText),e))},s.getQuickViewDataForStyle=function(e){switch(e){case Rv.InSceneItemStyle.PortraitImage:return{className:"portraitImage",imageSizeInfo:{width:82,height:123}};case Rv.InSceneItemStyle.SquareImage:return{className:"squareImage",imageSizeInfo:{width:82,height:82}};case Rv.InSceneItemStyle.TextOnly:return{className:"textOnly",imageSizeInfo:null};default:return null}},s}(Rv.XrayViewModelComponent);t.XrayQuickViewListItem=i});e(sT);sT.XrayQuickViewListItem;var lT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.onTabClick=function(e,t){t&&(xt.exists(n.props.onClick)&&n.props.onClick(),Rv.XrayDispatcher.getInstance().dispatch(e))},n}return n(t,e),t.prototype.componentDidMount=function(){this.props.loadListener&&this.props.loadListener()},t.prototype.render=function(){var e=this.props.viewModel;if(!xt.exists(e))return null;var t=PS("xrayTabItem",{selected:e.isSelected,isClickable:e.isClickable});return Vn.createElement("div",{className:t,onClick:this.onTabClick.bind(this,e.linkAction,e.isClickable)},e.label)},t}(Rv.XrayViewModelComponent);t.XrayTab=i});e(lT);lT.XrayTab;var uT={timer:new(function(){function e(e){void 0===e&&(e=V),this.globalTimers=e}return e.prototype.setInterval=function(e,t){return this.globalTimers.setInterval(e,t)},e.prototype.clearInterval=function(e){return this.globalTimers.clearInterval(e)},e.prototype.setTimeout=function(e,t){return this.globalTimers.setTimeout(e,t)},e.prototype.clearTimeout=function(e){return this.globalTimers.clearTimeout(e)},e.prototype.setImmediate=function(e){return this.globalTimers.setImmediate(e)},e.prototype.clearImmediate=function(e){return this.globalTimers.clearImmediate(e)},e}())},cT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.scrollIntoViewManager=function(){xt.exists(t.props.enableAnimataion)&&!t.props.enableAnimataion?t.scrollIntoView():t.updateViewInterval=uT.timer.setInterval(function(){t.scrollIntoView()},16)},t.scrollIntoView=function(){},t.onTransitionEnd=function(){uT.timer.clearInterval(t.updateViewInterval),t.scrollIntoView()},t.onClick=function(){t.transitionApplied||xt.exists(t.props.enableAnimataion)&&!t.props.enableAnimataion||(t.expandableWidgetViewRef.current.style.transition="height 0.15s linear",t.transitionApplied=!0),t.state.isExpanded||(Rv.InteractionEventReporter.sendInteractionEvent("ItemID",t.props.id,"X-Ray","MouseClick",t.props.analytics),Rv.XrayInsightClient.getInstance().sendInteractionEvent(t.props.id,Rv.XrayInsightInteractionType.INTERACTION)),t.setState({isExpanded:!t.state.isExpanded})},t.state={isExpanded:!1},t.expandableWidgetViewRef=Vn.createRef(),t.transitionApplied=!1,t.viewHeights={initialHeight:null,expandedHeight:null,marginValue:null},t}return i(e,n),e.prototype.shouldComponentUpdate=function(e,t){return!F.isEqual(this.props,e)||!F.isEqual(this.state,t)},e.prototype.componentWillUnmount=function(){uT.timer.clearInterval(this.updateViewInterval)},e.prototype.render=function(){var t=this,n=this.props;if(null===n)return null;var e=this.props.buttonMessage;return xt.exists(e)?Vn.createElement("div",{className:PS("expandableWidget",{withPadding:!xt.exists(n.withExtraPadding)||n.withExtraPadding}),ref:this.expandableWidgetViewRef,key:n.id,onClick:this.onClick,onTransitionEnd:this.onTransitionEnd},this.renderRows(n.rows)):Vn.createElement(Gb.XrayContextConsumer,null,function(e){return Vn.createElement("div",{className:PS("expandableWidget",{withPadding:!xt.exists(n.withExtraPadding)||n.withExtraPadding}),ref:t.expandableWidgetViewRef,key:n.id,onClick:t.onClick,onTransitionEnd:t.onTransitionEnd},Vn.createElement("div",{className:PS("tableHeaderContainer expandedInitial",{emptyTitle:!xt.exists(n.title)}),key:n.id+"_header"},Vn.createElement("div",{className:"tableHeader"},Vn.createElement("div",{className:"title"},n.title),xt.exists(t.props.showChevron)&&!t.props.showChevron?null:Vn.createElement("div",{className:PS("icon",{expanded:t.state.isExpanded})},Vn.createElement(wb.SVGImage,{src:Fb.SVG.BACK_ARROW})))),t.renderRows(n.rows),xt.exists(t.props.showSeeLess)&&!t.props.showSeeLess?null:Vn.createElement("div",{className:"seeLessContainer"},Vn.createElement("div",{className:PS("seeLess",{hide:!t.state.isExpanded}),onClick:t.onClick},e.localization.localizedStrings.textViewSeeLess)))})},e.prototype.renderRows=function(e){for(var t=[],n=[],r=[],i=0,o=e;i<o.length;i++){var a=o[i];a.expandedInitial?n.push(Vn.createElement("div",{className:PS("expandableWidgetRow",{alternateRowHighlighting:a.useAlternateRowHighlighting,expandedInitial:!0,hide:!1})},a.row)):r.push(Vn.createElement("div",{className:PS("expandableWidgetRow",{alternateRowHighlighting:a.useAlternateRowHighlighting,expandedInitial:!1,hide:!this.state.isExpanded})},a.row))}var s=null,l=this.props.buttonMessage;return xt.exists(l)&&(s=Vn.createElement("div",{className:PS("expandableWidgetRow",{expandedInitial:!0,hide:!1})},Vn.createElement("div",{className:"expansionMessage"},Vn.createElement("div",{className:"message"},this.state.isExpanded?l.secondaryText:l.primaryText),Vn.createElement("div",{className:PS("icon",{expanded:this.state.isExpanded})},Vn.createElement(wb.SVGImage,{src:Fb.SVG.BACK_ARROW}))))),t.push.apply(t,n),this.state.isExpanded||t.push(s),t.push.apply(t,r),this.state.isExpanded&&t.push(s),t},e.prototype.componentDidMount=function(){this.calculateHeightValue(),this.expandableWidgetViewRef.current.style.height=this.viewHeights.initialHeight+this.viewHeights.marginValue+"px"},e.prototype.componentDidUpdate=function(e,t){xt.exists(this.props.isShowing)&&!this.props.isShowing||(this.calculateHeightValue(),this.state.isExpanded?this.expandableWidgetViewRef.current.style.height=this.viewHeights.expandedHeight+this.viewHeights.marginValue+"px":this.expandableWidgetViewRef.current.style.height=this.viewHeights.initialHeight+this.viewHeights.marginValue+"px",t.isExpanded!==this.state.isExpanded&&this.scrollIntoViewManager())},e.prototype.calculateHeightValue=function(){var e=0,t=0;if(!xt.exists(this.viewHeights.marginValue)||0===this.viewHeights.marginValue){var n=!xt.exists(this.props.withExtraPadding)||this.props.withExtraPadding;this.viewHeights.marginValue=n?this.expandableWidgetViewRef.current.getBoundingClientRect().height:0}for(var r=0;r<this.expandableWidgetViewRef.current.childElementCount;r++){var i=this.expandableWidgetViewRef.current.children.item(r),o=i.getBoundingClientRect().height;0<=i.className.indexOf("expandedInitial")&&(e+=o),t+=o}this.viewHeights.initialHeight=e,this.viewHeights.expandedHeight=t},e}(Vn.PureComponent);t.ExpandableWidgetView=n});e(cT);cT.ExpandableWidgetView;var dT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){var n=t.call(this,e)||this;return n.receivePlaybackPositionActionStore=Rv.ReceivePlaybackPositionAction.store,n.isAnnexAvailable=function(e){var t=e.viewModel;return xt.exists(t.annexImageIcon)&&(!n.isMultiPurposeItem||n.isMultiPurposeItem)},n.onClickHighlight=function(e){xt.exists(e)&&(Rv.InteractionEventReporter.sendInteractionEvent("ItemID",e.id,"X-Ray","MouseClick",e.analytics),Rv.XrayInsightClient.getInstance().sendInteractionEvent(e.id,Rv.XrayInsightInteractionType.NAVIGATION),n.dispatcher.dispatch(new Rv.XrayHighlightModeAction({isHighlightModeOn:!0,clipDurationMs:e.clipDurationMs,clipStartPositionMs:e.clipStartPositionMs,originalPlaybackPositionMs:n.receivePlaybackPositionActionStore.getValue(),title:e.title})))},n.onClickReplayBooth=function(e){xt.exists(e)&&(Rv.InteractionEventReporter.sendInteractionEvent("ItemID",e.id,"X-Ray","MouseClick",e.analytics),n.dispatcher.dispatch(new Rv.XrayReplayBoothModeAction({isReplayBoothOn:!0,referenceId:e.id,videoUrlMap:e.videoUrlMap,miniXrayUrlMap:e.miniXrayUrlMap,videoCdnPreferenceList:e.videoCdnPreferenceList,miniXrayCdnPreferenceList:e.miniXrayCdnPreferenceList,headerText:e.headerText,title:e.title})))},n.dispatcher=Rv.XrayDispatcher.getInstance(),n.isMultiPurposeItem=xt.exists(n.props.viewModel.highlightButton)||xt.exists(n.props.viewModel.replayBoothButton),n.shouldRenderAnnex=n.isAnnexAvailable(e),n}return n(e,t),e.prototype.componentWillUpdate=function(e){this.isMultiPurposeItem=xt.exists(this.props.viewModel.highlightButton)||xt.exists(this.props.viewModel.replayBoothButton),this.shouldRenderAnnex=this.isAnnexAvailable(e)},e.prototype.render=function(){var e=this,t=this.props.viewModel,n=[];if(null===t)return null;var r=Vn.createElement("div",{className:"top"},Vn.createElement("div",{className:"main"},Vn.createElement("div",{className:"score"},Vn.createElement("div",{className:"imageContainer"},Ab.createXrayImageView(t.imageIcon,51,38,Fb.SVG.FALLBACK_16X9)),Vn.createElement("div",{className:"scoreText",dangerouslySetInnerHTML:{__html:t.textMap.tertiaryText}})),Vn.createElement("div",{className:"body"},Vn.createElement("div",{className:"headerText",dangerouslySetInnerHTML:{__html:t.textMap.secondaryText}}),Vn.createElement("div",{className:"hintText",dangerouslySetInnerHTML:{__html:t.textMap.quaternaryText}}),Vn.createElement("div",{className:"bodyText",dangerouslySetInnerHTML:{__html:t.textMap.primaryText}}))),this.shouldRenderAnnex?Vn.createElement("div",{className:"annex"},Vn.createElement("div",{className:"imageContainer",onClick:function(){e.onClickHighlight(e.props.viewModel.highlightButton)}},xt.exists(t.annexImageIcon)?Ab.createXrayImageView(t.annexImageIcon,313,176,Fb.SVG.FALLBACK_16X9):null,this.isMultiPurposeItem?Vn.createElement("div",{className:"iconView"},Vn.createElement(wb.SVGImage,{src:Fb.SVG.HIGHLIGHT_PLAY})):null,this.isMultiPurposeItem?Vn.createElement("div",{className:"gradientOverlay"}):null)):null),i=Vn.createElement("div",{className:"normalPlayHistoryContainer"},r);if(!xt.exists(t.subItems))return i;n.push({row:i,expandedInitial:!0});var o=t.subItems;return xt.exists(o.routeMap)?(n.push(this.getRouteMap(o.routeMap,this.props.viewModel.highlightButton)),Vn.createElement(cT.ExpandableWidgetView,{id:t.id,rows:n,withExtraPadding:!1,isShowing:this.props.isShowing,buttonMessage:xt.exists(o.buttonViewModel)?o.buttonViewModel.textMap:null})):xt.exists(o.replayViewModel)?Vn.createElement("div",{className:"normalPlayHistoryContainer"},r,this.getReplay(o.replayViewModel.imageMap,o.replayViewModel.textMap,this.props.viewModel.replayBoothButton).row):i},e.prototype.getRouteMap=function(e,t){var n=this,r=Ab.createXrayImageView(e.primaryImage,313,176,Fb.SVG.FALLBACK_16X9);return{row:Vn.createElement("div",{className:"routeMap",onClick:function(){n.onClickHighlight(t)}},r),expandedInitial:!1}},e.prototype.getReplay=function(e,t,n){var r=this;return{row:Vn.createElement("div",{className:"routeMap",onClick:function(){r.onClickReplayBooth(n)}},Ab.createXrayImageView(e.primaryImage,313,176,Fb.SVG.FALLBACK_16X9),Vn.createElement("div",{className:"gradientOverlay"}),Vn.createElement("div",{className:"textContainer"},Vn.createElement("div",{className:"textView"},t.primaryText)),Vn.createElement("div",{className:"playIcon"},Vn.createElement(wb.SVGImage,{className:"playSVG",src:Fb.SVG.HIGHLIGHT_PLAY}))),expandedInitial:!0}},e}(Vn.PureComponent);t.LivePlayHistoryNormalView=i});e(dT);dT.LivePlayHistoryNormalView;var pT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return xt.exists(this.props.primaryText)?Vn.createElement("div",{className:"pendingPlayHistoryContainer"},Vn.createElement("div",{className:"titleText",dangerouslySetInnerHTML:{__html:this.props.primaryText}}),this.props.secondaryText&&Vn.createElement("div",{className:"bodyText",dangerouslySetInnerHTML:{__html:this.props.secondaryText}})):null},t}(Vn.PureComponent);t.LivePlayHistoryPendingView=i});e(pT);pT.LivePlayHistoryPendingView;var fT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){return t.call(this,e,{filterModelStore:Rv.XrayCollectionFilterAction.store})||this}return n(e,t),e.prototype.render=function(){var e=!1,t=this.state.filterModelStore;if(xt.exists(t)&&xt.exists(t.filterKey)&&xt.exists(this.props.filter))for(var n=0,r=this.props.filter.split(",");n<r.length;n++){if(r[n]===t.filterKey){e=!0;break}}else e=!0;return xt.exists(this.props.onDisplayChange)&&this.props.onDisplayChange(!e),Vn.createElement("div",{className:PS("filterable",{hideFilterable:!e})},this.props.children)},e}(Rv.ComputedStateView);t.FilterableItemView=i});e(fT);fT.FilterableItemView;var hT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({transition:'all 0.5s'}),a=qS.styler({display:'none'}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onFilteredChange=function(e){t.setState({isFiltered:e})},t.state={isAnimationReady:!1,initialRender:!0,isFiltered:!1},t.livePlayHistoryViewRef=Vn.createRef(),t}return i(e,n),e.prototype.componentWillReceiveProps=function(e){Db.XrayImpressionEventHelper.doXrayImpressionEventReporting(this.props,e)},e.prototype.shouldComponentUpdate=function(e,t){return!F.isEqual(this.props.viewModel,e.viewModel)||(this.props.isShowing!==e.isShowing||(this.state.isFiltered!==t.isFiltered||this.state.isAnimationReady!==t.isAnimationReady))},e.prototype.componentDidMount=function(){if(this.state.initialRender){if(xt.exists(this.livePlayHistoryViewRef.current)){var e=-1*this.livePlayHistoryViewRef.current.clientHeight;this.originalMarginTop=this.livePlayHistoryViewRef.current.style.marginTop,this.livePlayHistoryViewRef.current.style.marginTop=e+"px"}this.setState({isAnimationReady:!0,initialRender:!1})}},e.prototype.componentDidUpdate=function(){this.state.isAnimationReady&&xt.exists(this.livePlayHistoryViewRef.current)&&(this.livePlayHistoryViewRef.current.style.marginTop=this.originalMarginTop)},e.prototype.render=function(){var e=this.props.viewModel;if(null===e)return null;var t=["livePlayHistoryTile"];return this.state.initialRender&&t.push(a),this.state.isAnimationReady&&t.push(o),Vn.createElement(fT.FilterableItemView,{filter:e.filters,onDisplayChange:this.onFilteredChange},Vn.createElement("div",{className:PS.apply(void 0,t),ref:this.livePlayHistoryViewRef,key:this.props.viewModel.id},this.convertSection(e)))},e.prototype.convertSection=function(e){switch(e.style){case Rv.LivePlayHistoryViewModelStyle.NORMAL:return Vn.createElement(dT.LivePlayHistoryNormalView,{viewModel:e,isShowing:this.props.isShowing&&!this.state.isFiltered});case Rv.LivePlayHistoryViewModelStyle.PENDING:return Vn.createElement(pT.LivePlayHistoryPendingView,{primaryText:e.textMap.primaryText,secondaryText:e.textMap.secondaryText});default:return null}},e}(Rv.XrayViewModelComponent);t.LivePlayHistoryView=n});e(hT);hT.LivePlayHistoryView;var mT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("XraySelectableCollectionContainerView"),n=function(n){function e(e){var t=n.call(this,e)||this;return t.xrayCollectionSelectActionStore=Rv.XrayCollectionSelectAction.store,t.onStoreChange=function(){var e=t.xrayCollectionSelectActionStore.getValue();e.widgetId===t.props.viewModel.id&&t.setState({selectedIndex:e.selectionIndex})},t.state={selectedIndex:e.viewModel.initialSelectionIndex},t}return i(e,n),e.prototype.render=function(){if(null===this.props.viewModel)return null;for(var e=[],t=0;t<this.props.viewModel.items.length;t++)e.push(this.props.viewModelRenderer.renderViewModel(this.props.viewModel.items[t],this.props.loadListener,this.props.isShowing&&t===this.getSelectedIndex(),this.props.selectionDataMap));return e},e.prototype.componentDidMount=function(){this.xrayCollectionSelectActionStore.onChange(this.onStoreChange)},e.prototype.componentWillUnmount=function(){this.xrayCollectionSelectActionStore.offChange(this.onStoreChange)},e.prototype.getSelectedIndex=function(){var e=this.state.selectedIndex;return!xt.exists(e)||e<0||e>=this.props.viewModel.items.length?(o.info("selectedIndex="+e+" is an invalid selection.\n                Setting selectedIndex to default value "+this.props.viewModel.initialSelectionIndex),this.props.viewModel.initialSelectionIndex):e},e}(Vn.Component);t.XraySelectableCollectionContainerView=n});e(mT);mT.XraySelectableCollectionContainerView;var yT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.componentDidMount=function(){this.props.loadListener()},t.prototype.render=function(){var e=this.props.viewModel;return Vn.createElement("div",{className:"twoColumnSubheader"},e.primaryText)},t}(Rv.XrayViewModelComponent);t.TwoColumnSubheaderItemView=i});e(yT);yT.TwoColumnSubheaderItemView;var gT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.componentDidMount=function(){this.props.loadListener()},t.prototype.render=function(){var e=this.props.viewModel;return Vn.createElement("div",{className:"twoColumnTableItem"},Vn.createElement(Kb.MultiLineTextView,{className:"leftColumn",rawText:e.primaryText}),Vn.createElement(Kb.MultiLineTextView,{className:"rightColumn",rawText:e.supplementalText}))},t}(Rv.XrayViewModelComponent);t.TwoColumnTableItemView=i});e(gT);gT.TwoColumnTableItemView;var vT=t(function(e,t){var r,i,n,o=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),(n=i||(i={}))[n.IMAGE_VIEW=0]="IMAGE_VIEW",n[n.TEAM_INFO=1]="TEAM_INFO";var a=function(n){function e(e){var t=n.call(this,e)||this;return t.state={isExpanded:!1},t.xrayTwoColumnLiveItemRef=Vn.createRef(),t}return o(e,n),e.prototype.componentWillReceiveProps=function(e){Db.XrayImpressionEventHelper.doXrayImpressionEventReporting(this.props,e)},e.prototype.render=function(){if(null===this.props.viewModel)return null;var e=new Rv.LoadTimeTracker;e.setOnLoadListener(this.props.loadListener);var t=e.registerId(i.TEAM_INFO);return e.lock(),this.convertSection(this.props,t)},e.prototype.convertSection=function(e,t){switch(e.viewModel.style){case Rv.XrayTwoColumnLiveItemStyle.PLAYER_ITEM:return this.renderPlayerItem(e,t);case Rv.XrayTwoColumnLiveItemStyle.TEAM_HEADER_ITEM:return this.renderTeamHeaderItem(e,t);default:return null}},e.prototype.renderTeamHeaderItem=function(e,t){var n=e.viewModel;return Vn.createElement("div",{ref:this.xrayTwoColumnLiveItemRef,className:"teamHeaderItem"},Vn.createElement("div",{className:"top"},Ab.createXrayImageView(n.image.imageData,50,50,Fb.SVG.PLAYER_PLACEHOLDER,this.props.loadListener),Vn.createElement("div",{className:"textContainer"},Vn.createElement(Kb.MultiLineTextView,{className:"primaryText",rawText:n.textMap.primaryText}),Vn.createElement(Kb.MultiLineTextView,{className:"supplementalText",rawText:n.textMap.secondaryText}))),Vn.createElement("div",{className:"bottom"},this.props.viewModelRenderer.renderViewModel(this.props.viewModel.relatedItems,t,this.props.isShowing,this.props.selectionDataMap)))},e.prototype.renderPlayerItem=function(e,t){var n=e.viewModel,r=[],i=Vn.createElement("div",{ref:this.xrayTwoColumnLiveItemRef,className:"xrayPlayerItem"},Vn.createElement("div",{className:"top"},Ab.createXrayImageView(n.image.imageData,50,50,Fb.SVG.PLAYER_PLACEHOLDER,this.props.loadListener),Vn.createElement("div",{className:"textContainer"},Vn.createElement(Kb.MultiLineTextView,{className:"primaryText",rawText:n.textMap.primaryText}),Vn.createElement(Kb.MultiLineTextView,{className:"supplementalText",rawText:n.textMap.secondaryText}))));r.push({row:i,expandedInitial:!0});var o=Vn.createElement("div",{ref:this.xrayTwoColumnLiveItemRef,className:"xrayPlayerItem"},Vn.createElement("div",{className:"bottom"},e.viewModelRenderer.renderViewModel(n.relatedItems,t,e.isShowing,e.selectionDataMap)));return r.push({row:o,expandedInitial:!1}),Vn.createElement(cT.ExpandableWidgetView,{id:n.id,rows:r,analytics:n.analytics,isShowing:e.isShowing})},e}(Rv.XrayViewModelComponent);t.XrayTwoColumnLiveItemView=a});e(vT);vT.XrayTwoColumnLiveItemView;var ST=t(function(e,t){var r,i,o=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function s(e){var t=n.call(this,e)||this;return t.onClickTab=function(e){t.setState({selectedItemId:e})},t.state={selectedItemId:e.viewModel.initialSelectionId},t}return o(s,n),s.prototype.render=function(){var n=this;if(!this.props.viewModel)return null;var r=new Rv.LoadTimeTracker;r.setOnLoadListener(this.props.loadListener);for(var i=[],e=function(e){var t=o.props.viewModel.items[e];t.isSelected=t.id===o.state.selectedItemId,i.push(o.props.viewModelRenderer.renderViewModel(t,r.registerId(e),o.props.isShowing,o.props.selectionDataMap,{key:e,onClick:function(){return n.onClickTab(t.id)}}))},o=this,t=0;t<this.props.viewModel.items.length;t++)e(t);r.lock();var a=s.STYLE_CLASS_NAME_MAP[this.props.viewModel.style];return Vn.createElement("div",{className:PS("xraySelectableNavigationsView",a)},i)},s.STYLE_CLASS_NAME_MAP=((i={})[Rv.XraySelectableNavigationsStyle.XRAY_HEAD_TO_HEAD_NAV_BAR]="xrayHeadToHeadNavbar",i[Rv.XraySelectableNavigationsStyle.XRAY_TAB_BAR]="xrayTabBar",i),s}(Rv.XrayViewModelComponent);t.XraySelectableNavigationsView=n});e(ST);ST.XraySelectableNavigationsView;var bT=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mf.com.amazon.avod.xray.XRayToken,n=Mf.com.amazon.avod.xray.XRayPlaybackMode,i=Mf.com.amazon.avod.xray.XRayDeviceClass,o=r.XRAY_WEB_2020_V3;t.getCurrentXrayToken=function(e){var t=sp.QueryString.getQueryString(),n=r.XRAY_WEB_2020_V3;return n?xt.withDefault(t.xrayToken,n):xt.withDefault(t.xrayToken,o)};var a={playbackMode:n.PLAYBACK,deviceClass:i.NORMAL,token:xt.withDefault(sp.QueryString.getQueryString().xrayToken,o)};t.DEFAULT_XRAY_CONFIG=a});e(bT);bT.getCurrentXrayToken,bT.DEFAULT_XRAY_CONFIG;var TT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(e){Rv.XrayDispatcher.getInstance().dispatch(e)},e}return n(e,t),e.prototype.render=function(){var e=this,t=this.props.viewModel,n=t.primaryText,r=t.linkAction,i=PS("xrayLiveQuickViewButton",{show:this.props.isShowing});return Vn.createElement("div",null,Vn.createElement("div",{className:i,onClick:function(){return e.onClick(r)}},Vn.createElement("div",{className:"icon"},Vn.createElement(wb.SVGImage,{src:Fb.SVG.STATS,className:"svgBackground"})),Vn.createElement("div",{className:"textContainer"},Vn.createElement("span",{className:"primaryText"},n))))},e}(Rv.XrayViewModelComponent);t.XrayLiveQuickViewButton=i});e(TT);TT.XrayLiveQuickViewButton;var PT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({display:'flex',flexDirection:'row',justifyContent:'space-between'}),o=qS.styler({transition:'all 0.5s',height:"1rem"}),a=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.shouldComponentUpdate=function(e){return!F.isEqual(this.props,e)},e.prototype.render=function(){if(null===this.props)return null;var e={flex:this.props.leftValue,marginRight:"2.5px",minWidth:"1px",background:this.props.leftColor},t={flex:this.props.rightValue,marginLeft:"2.5px",minWidth:"1px",background:this.props.rightColor};return Vn.createElement("div",{className:i},Vn.createElement("div",{className:o,style:e}),Vn.createElement("div",{className:o,style:t}))},e}(Vn.Component);t.PercentageBar=a});e(PT);PT.PercentageBar;var wT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this.props.viewModel;return null===e?null:Vn.createElement("div",{className:"matchStatsRow",key:e.id},Vn.createElement("div",{className:"titleRow"},Vn.createElement("div",{className:"homeLogoImage"},xt.exists(e.left.iconImage)?Ab.createXrayImageView(e.left.iconImage,20,20,Fb.SVG.FALLBACK_4X3):null),Vn.createElement("div",{className:"title"},Vn.createElement(Vb.BlinkingTextView,{textContent:e.title})),Vn.createElement("div",{className:"awayLogoImage"},xt.exists(e.right.iconImage)?Ab.createXrayImageView(e.right.iconImage,20,20,Fb.SVG.FALLBACK_4X3):null)),Vn.createElement("div",{className:"normalRow"},Vn.createElement("div",{className:"leftText"},Vn.createElement(Vb.BlinkingTextView,{textContent:e.left.textMap.primaryText})),Vn.createElement("div",{className:"percentageBar"},Vn.createElement(PT.PercentageBar,{leftColor:e.left.color,leftValue:e.left.value,rightColor:e.right.color,rightValue:e.right.value})),Vn.createElement("div",{className:"rightText"},Vn.createElement(Vb.BlinkingTextView,{textContent:e.right.textMap.primaryText}))),Vn.createElement("div",{className:"xrayDivider"}))},t}(Vn.PureComponent),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this.props.viewModel;return null===e?null:e.isSubHeader?this.renderHeaderTextView(e):this.renderNormalTextView(e)},t.prototype.renderHeaderTextView=function(e){return Vn.createElement("div",{className:"matchStatsRow",key:e.id},Vn.createElement("div",{className:"titleRow"},Vn.createElement("div",{className:"homeLogoImage"},xt.exists(e.iconImage.primaryImage)?Ab.createXrayImageView(e.iconImage.primaryImage,20,20,Fb.SVG.FALLBACK_4X3):null),Vn.createElement("div",{className:"title"}),Vn.createElement("div",{className:"awayLogoImage"},xt.exists(e.iconImage.secondaryImage)?Ab.createXrayImageView(e.iconImage.secondaryImage,20,20,Fb.SVG.FALLBACK_4X3):null)))},t.prototype.renderNormalTextView=function(e){return Vn.createElement("div",{className:"matchStatsNormalRow",key:e.id},Vn.createElement("div",{className:"normalTextRow"},Vn.createElement("div",{className:PS("leftText",{highlighted:e.highlightedItemIndex===Rv.TextMapHighlightedIndex.SECONDARY})},e.textMap.secondaryText),Vn.createElement("div",{className:"middleText"},e.textMap.primaryText),Vn.createElement("div",{className:PS("rightText",{highlighted:e.highlightedItemIndex===Rv.TextMapHighlightedIndex.TERTIARY})},e.textMap.tertiaryText)))},t}(Vn.PureComponent),n=function(n){function e(e){var t=n.call(this,e)||this;return t.isExpandable=!1,t}return i(e,n),e.prototype.render=function(){var e=this.props.viewModel;return null===e?null:(this.isExpandable=!1,Vn.createElement(cT.ExpandableWidgetView,{rows:this.buildRows(e),id:e.id,title:e.title,analytics:e.analytics,isShowing:this.props.isShowing,showSeeLess:this.isExpandable,showChevron:this.isExpandable}))},e.prototype.buildRows=function(e){for(var t=[],n=0,r=e.rows;n<r.length;n++){var i=r[n];switch(i.type){case Rv.LiveMatchStatsRowModelType:var o=i,a=o.expandedInitially;a||(this.isExpandable=!0),t.push({row:Vn.createElement(u,{viewModel:o}),expandedInitial:a});break;case Rv.LiveMatchStatsTextRowModelType:var s=i,l=s.expandedInitially;l||(this.isExpandable=!0),t.push({row:Vn.createElement(c,{viewModel:s}),expandedInitial:l,useAlternateRowHighlighting:!0})}}return t},e}(Rv.XrayViewModelComponent);t.LiveOneColumnTableView=n});e(wT);wT.LiveOneColumnTableView;var CT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.viewModel;return null===e?null:Vn.createElement("div",{className:"tabHeaderContainer"},Vn.createElement("span",null,e.textMap.primaryText),Vn.createElement("span",null,e.textMap.secondaryText),Vn.createElement("span",null,e.textMap.tertiaryText))},t}(Rv.XrayViewModelComponent);t.XrayTabHeader=i});e(CT);CT.XrayTabHeader;var MT=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new Nf.Metrics;t.metrics=n});e(MT);MT.metrics;var IT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){function e(e){return t.call(this,e,{isQuickViewExpanded:KS.ToggleQuickViewListAction.store})||this}return n(e,t),e.prototype.render=function(){var e=this.props.viewModel.style!==Rv.CollectionStyle.QUICKVIEW_LIST||this.state.isQuickViewExpanded;return Vn.createElement(Rv.XrayTimeIndexedCollectionView,i({},this.props,{shouldShow:e,shouldReverse:!0}))},e}(Rv.ComputedStateView);t.ExpandableTimeIndexedCollectionView=o});e(IT);IT.ExpandableTimeIndexedCollectionView;var ET=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props.viewModel,t=e.imageMap.primaryImage;return null===e?null:Vn.createElement("div",{className:"liveTeamIcon"},Vn.createElement("div",{className:this.props.isLeftTeam?"leftTeam":"rightTeam"},Vn.createElement("div",{className:"rowContainer"},Vn.createElement("div",{className:"imageContainer"},Ab.createXrayImageView(t,70,46,Fb.SVG.FALLBACK_4X3)),Vn.createElement("div",{className:e.possession?"possessionOn":"possessionOff"})),Vn.createElement("div",{className:"teamRecordText",dangerouslySetInnerHTML:{__html:e.textMap.secondaryText}})))},t}(Vn.PureComponent);t.LiveTeamIconView=i});e(ET);ET.LiveTeamIconView;var _T=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.state={isAnimationReady:!1,initialRender:!0},t}return i(e,n),e.prototype.render=function(){var e=this.props.viewModel,t=[],n=new Rv.LoadTimeTracker;if(n.setOnLoadListener(this.props.loadListener),null===e)return null;for(var r=Vn.createElement("div",{className:"liveScorecardTile"},Vn.createElement(ET.LiveTeamIconView,{viewModel:e.leftTeam,isLeftTeam:!0}),Vn.createElement("div",{className:"gameInfo"},Vn.createElement("div",{className:"gameScore"},e.textMap.primaryText),Vn.createElement("div",{className:"gamePeriod"},e.textMap.secondaryText)),Vn.createElement(ET.LiveTeamIconView,{viewModel:e.rightTeam,isLeftTeam:!1})),i=[],o=0;o<e.expandableData.length;o++){var a=e.expandableData[o];i.push(this.props.viewModelRenderer.renderViewModel(a,n.registerId(o),this.props.isShowing,this.props.selectionDataMap,{key:a.id}))}var s=Vn.createElement("div",{className:"liveScorecardTileBottom"},Vn.createElement("div",{className:"dividingLine"}),Vn.createElement("div",{className:"bottom"},Vn.createElement("div",{className:PS("teamNameColumn",{reducedSize:4<i.length})},Vn.createElement("div",{className:"emptyRow"}),Vn.createElement("div",{className:PS("leftTeam","teamNameContainer")},Vn.createElement("div",{className:"imageContainer"},Ab.createXrayImageView(e.leftTeam.imageMap.primaryImage,18,27,Fb.SVG.FALLBACK_4X3)),Vn.createElement("div",{className:"teamName"}," ",e.leftTeam.textMap.primaryText," ")),Vn.createElement("div",{className:"teamNameContainer"},Vn.createElement("div",{className:"imageContainer"},Ab.createXrayImageView(e.rightTeam.imageMap.primaryImage,18,27,Fb.SVG.FALLBACK_4X3)),Vn.createElement("div",{className:"teamName"},e.rightTeam.textMap.primaryText))),Vn.createElement("div",{className:PS("expandableColumns",{scrollColumns:5<i.length})},i)));return t.push({row:r,expandedInitial:!0}),t.push({row:s,expandedInitial:!1}),Vn.createElement(cT.ExpandableWidgetView,{id:e.id,rows:t,showSeeLess:!1,isShowing:this.props.isShowing})},e}(Rv.XrayViewModelComponent);t.LiveScorecardView=n});e(_T);_T.LiveScorecardView;var xT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:"scorecardColumn"},Vn.createElement("div",{className:PS("columnItem","columnHeader")},this.props.viewModel.textMap.primaryText),Vn.createElement("div",{className:PS("evenItem","columnItem",this.props.viewModel.textHighlights.secondary?"highlighted":"")},this.props.viewModel.textMap.secondaryText),Vn.createElement("div",{className:PS("columnItem",this.props.viewModel.textHighlights.tertiary?"highlighted":"")},this.props.viewModel.textMap.tertiaryText))},t}(Rv.XrayViewModelComponent);t.LiveScorecardColumnView=i});e(xT);xT.LiveScorecardColumnView;var kT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return this.props.isShowing?Vn.createElement("div",{className:"xrayBrandingImageView"},Ab.createXrayImageView(this.props.viewModel.brandingImage,this.props.viewModel.brandingImage.width,this.props.viewModel.brandingImage.height)):null},t}(Rv.XrayViewModelComponent);t.XrayBrandingImageView=i});e(kT);kT.XrayBrandingImageView;var RT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return this.props.isShowing?Vn.createElement("div",{className:"xrayTitledImageModelView"},Vn.createElement("div",{className:"xrayTitledImageModelViewContent"},Vn.createElement("div",{className:"titledHeader"},this.props.viewModel.title),Vn.createElement("div",{className:"titledImageBody"},Ab.createXrayImageView(this.props.viewModel.content,312,175,Fb.SVG.FALLBACK_16X9)))):null},t}(Rv.XrayViewModelComponent);t.XrayTitledImageModelView=i});e(RT);RT.XrayTitledImageModelView;var AT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return this.props.isShowing?Vn.createElement("div",{className:"xrayTitledParagraphTextView"},Vn.createElement("div",{className:"xrayTitledParagraphTextViewContent"},Vn.createElement("div",{className:"titledHeader"},this.props.viewModel.title),Vn.createElement("div",{className:"titledTextBody",dangerouslySetInnerHTML:{__html:this.props.viewModel.content}}))):null},t}(Rv.XrayViewModelComponent);t.XrayTitledParagraphTextView=i});e(AT);AT.XrayTitledParagraphTextView;var OT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){if(!this.props.isShowing)return null;var e=[],t=Vn.createElement("div",{className:"titledStatisticBody"},Vn.createElement("div",{className:"icon"},Ab.createXrayImageView(this.props.viewModel.primaryImage,105,105,Fb.SVG.FALLBACK_4X3)),Vn.createElement("div",{className:"textGroup"},Vn.createElement("div",{className:"textHeader"},Vn.createElement("div",{className:"mainText"},this.props.viewModel.textMap.secondaryText),Vn.createElement("div",{className:"mainSubtext"},this.props.viewModel.textMap.tertiaryText)),this.props.viewModel.parseTextAsHtml?Vn.createElement("div",{className:"textSubheader",dangerouslySetInnerHTML:{__html:this.props.viewModel.textMap.quaternaryText}}):Vn.createElement("div",{className:"textSubheader"},this.props.viewModel.textMap.quaternaryText)));e.push({row:t,expandedInitial:!0});var n=Vn.createElement("div",{className:"titledStatisticExpandedBody"},this.buildItemList(this.props.viewModel.items));return e.push({row:n,expandedInitial:!1}),Vn.createElement("div",{className:"xrayPlayerStatisticView"},Vn.createElement(cT.ExpandableWidgetView,{rows:e,id:this.props.viewModel.id,analytics:this.props.viewModel.analytics,title:this.props.viewModel.textMap.primaryText,isShowing:this.props.isShowing,showSeeLess:!1}))},t.prototype.buildItemList=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n],o=Vn.createElement("div",{className:"expandedItem"},Vn.createElement("div",{className:"itemBodyDivider"}),this.props.viewModelRenderer.renderViewModel(i,this.props.loadListener,this.props.isShowing,this.props.selectionDataMap));t.push(o)}return t},t}(Rv.XrayViewModelComponent);t.XrayPlayerStatisticView=i});e(OT);OT.XrayPlayerStatisticView;var LT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return this.props.isShowing?Vn.createElement("div",{className:"xrayImageGraphProbabilityPercentageView"},Vn.createElement("div",{className:"xrayImageGraphProbabilityPercentageViewContent"},Vn.createElement("div",{className:"titledHeader"},this.props.viewModel.title),Vn.createElement("div",{className:"titledGraphBody"},Vn.createElement("div",{className:"mainText"},this.props.viewModel.mainText),Vn.createElement("div",{className:"graphArea"},Vn.createElement("div",{className:"graph"},Vn.createElement("div",{className:"cursorImage",style:{left:"calc("+100*this.props.viewModel.initialValue+"% - 6px)"}},Ab.createXrayImageView(this.props.viewModel.cursorImage,16,40)),Vn.createElement("div",{className:"backgroundImage"},Ab.createXrayImageView(this.props.viewModel.backgroundImage,210,48))))))):null},t}(Rv.XrayViewModelComponent);t.XrayImageGraphProbabilityPercentageView=i});e(LT);LT.XrayImageGraphProbabilityPercentageView;var FT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return this.props.isShowing?Vn.createElement("div",{className:"xrayParagraphTextView"},this.props.viewModel.textMap.primaryText):null},t}(Rv.XrayViewModelComponent);t.XrayParagraphTextView=i});e(FT);FT.XrayParagraphTextView;var DT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){if(!this.props.isShowing)return null;var e=this.props.viewModel.textMap;return Vn.createElement("div",{className:"xrayPlayerStatisticQuickView"},Vn.createElement("div",{className:"icon"},Ab.createXrayImageView(this.props.viewModel.primaryImage,105,105,Fb.SVG.FALLBACK_1X1)),Vn.createElement("div",{className:"textGroup"},Vn.createElement("div",{className:"textHeader"},Vn.createElement("div",{className:"mainTitle"},e.primaryText),Vn.createElement("div",{className:"mainText"},Number(this.props.viewModel.textMap.secondaryText).toFixed(2)),Vn.createElement("div",{className:"mainSubtext"},e.tertiaryText)),Vn.createElement("div",{className:"textSubheader",dangerouslySetInnerHTML:{__html:e.quaternaryText}})))},t}(Rv.XrayViewModelComponent);t.XrayPlayerStatisticQuickView=i});e(DT);DT.XrayPlayerStatisticQuickView;var NT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return this.props.isShowing?Vn.createElement("div",{className:"xrayTitledEmphasizedText"},Vn.createElement("div",{className:"xrayTitledEmphasizedTextContent"},Vn.createElement("div",{className:"primaryText"},this.props.viewModel.textMap.primaryText),Vn.createElement("div",{className:"secondaryText"},this.props.viewModel.textMap.secondaryText))):null},t}(Rv.XrayViewModelComponent);t.XrayTitledEmphasizedTextView=i});e(NT);NT.XrayTitledEmphasizedTextView;var UT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i="xrayPopUp";t.LOCAL_STORAGE_POP_UP_TOGGLE_KEY=i;t.TOGGLE_ON="on";t.TOGGLE_OFF="off";var o=function(t){function e(e){var n=t.call(this,e)||this;return n.onClick=function(){var e=!n.state.toggleOn;n.setState({toggleOn:e});var t=e?"on":"off";n.saveToggleValue(t)},n.state={toggleOn:!1},n}return n(e,t),e.prototype.render=function(){var e=this.props.viewModel,t=this.state.toggleOn?"on":"off";return Vn.createElement(fT.FilterableItemView,{filter:e.filters},Vn.createElement("div",{className:"popUpToggleButton",onClick:this.onClick},Vn.createElement("div",{className:"textContainer"},Vn.createElement("div",{className:"primaryText"},e.textMap.primaryText),Vn.createElement("div",{className:"secondaryText"},e.textMap.secondaryText)),Vn.createElement("div",{className:"switchContainer"},Vn.createElement("div",{className:PS("toggleBox",t)},Vn.createElement("div",{className:PS("toggleSwitch",t)})))))},e.prototype.componentDidMount=function(){var e=localStorage.getItem(i);xt.exists(e)||this.saveToggleValue("on");var t="off"!==e;this.setState({toggleOn:t})},e.prototype.saveToggleValue=function(e){localStorage.setItem(i,e)},e}(Rv.XrayViewModelComponent);t.PopUpToggleButtonView=o});e(UT);UT.LOCAL_STORAGE_POP_UP_TOGGLE_KEY,UT.TOGGLE_ON,UT.TOGGLE_OFF,UT.PopUpToggleButtonView;var BT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClickReplay=function(e){xt.exists(e)&&(Rv.InteractionEventReporter.sendInteractionEvent("ItemID",e.id,"X-Ray","MouseClick",e.analytics),Rv.XrayDispatcher.getInstance().dispatch(new Rv.XrayReplayBoothModeAction({isReplayBoothOn:!0,videoUrlMap:e.videoUrlMap,miniXrayUrlMap:e.miniXrayUrlMap,videoCdnPreferenceList:e.videoCdnPreferenceList,miniXrayCdnPreferenceList:e.miniXrayCdnPreferenceList,headerText:e.headerText,title:e.title})))},e}return n(e,t),e.prototype.render=function(){var e=this;if(!this.isInNodeJS()&&localStorage.getItem(UT.LOCAL_STORAGE_POP_UP_TOGGLE_KEY)===UT.TOGGLE_OFF)return null;var t=this.props.viewModel,n=xt.exists(t.imageMap)&&xt.exists(t.imageMap.primaryImage)?Vn.createElement("div",{className:"imageContainer"},Ab.createXrayImageView(t.imageMap.primaryImage,100,100,Fb.SVG.FALLBACK_1X1)):null,r=xt.exists(t.imageMap)&&xt.exists(t.imageMap.secondaryImage)?Vn.createElement("div",{className:"iconContainer"},Ab.createXrayImageView(t.imageMap.secondaryImage,30,30)):null;return Vn.createElement("div",{className:PS("liveHintableButton",this.getGravityClassname(t.verticalGravity))},Vn.createElement("div",{className:PS("horizontalContainer",this.getGravityClassname(t.horizontalGravity)),onClick:function(){e.onClickReplay(t.replayBoothButton)}},Vn.createElement("div",{className:"imageContainer"},n,xt.exists(n)?Vn.createElement("div",{className:"gradientOverlay"}):null,r),Vn.createElement("div",{className:"textContainer"},Vn.createElement("div",{className:"primaryText"},t.textMap.primaryText),Vn.createElement("div",{className:"secondaryText"},t.textMap.secondaryText))))},e.prototype.isInNodeJS=function(){return"object"==typeof process&&"object"==typeof process.versions&&void 0!==process.versions.node},e.prototype.getGravityClassname=function(e){switch(e){case Rv.HintableButtonGravity.center:return"center";case Rv.HintableButtonGravity.left:return"left";case Rv.HintableButtonGravity.right:return"right";case Rv.HintableButtonGravity.top:return"top";case Rv.HintableButtonGravity.bottom:return"bottom"}},e}(Rv.XrayViewModelComponent);t.LiveHintableButtonView=i});e(BT);BT.LiveHintableButtonView;var VT=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=Mf.com.amazon.atv.discovery.LinkType,f=Mf.com.amazon.atv.discovery.WidgetType,n=function(){function e(e,t,n,r,i,o,a,s,l){var u,c,d;this.controller=new Rv.XrayController({player:e,metricsFeature:t,weblabs:r,serviceClientFactory:i,playerConfig:o,playerScalingController:a,playerHighlightModeController:s,pmetReporter:MT.metrics},{navigationalActionResolvers:(u={},u[p.EXTERNALLINK]=[new Av.ExternalLinkNavigationalActionResolver],u[p.XRAY]=[new yS.EmbeddedVideoNavigationalActionResolver],u),actionResponders:[Av.ExternalLinkNavigationalActionResolver.responder],additionalStores:[KS.ToggleQuickViewListAction.store],localizationAdapter:new QS.LocalizationStoreAdapter(n),transformers:(c={},c[f.COLLECTION]=new TS.WebCollectionV2Transformer,c),viewClassMap:(d={},d[Rv.CollectionModelType]=Mb.XrayCollectionView,d[Rv.GridTileImageViewModelType]=Nb.XrayImageGridTile,d[Rv.GridTileTextViewModelType]=Ub.XrayTextGridTile,d[Rv.TriviaViewModelType]=Bb.TriviaListItem,d[Rv.LiveStatsTableViewModelType]=zb.LiveStatsView,d[Rv.LivePlayHistoryViewModelType]=hT.LivePlayHistoryView,d[Rv.XrayListItemViewModelType]=qb.XrayImageListItem,d[Rv.TwoSectionDetailViewModelType]=Wb.TwoSectionDetailView,d[Rv.ImageTextLinkModelType]=Hb.DetailPagePhoto,d[Rv.StyledTextLinkModelType]=Yb.StyledTextLinkView,d[Rv.PhotoGalleryCollectionModelType]=eT.PhotoGallerySwiftContainer,d[Rv.InSceneItemType]=sT.XrayQuickViewListItem,d[Rv.XrayQuickViewHeaderModelType]=nT.CollapsibleXrayHeaderView,d[Rv.TimestampBasedTimeIndexedCollection.TYPE]=IT.ExpandableTimeIndexedCollectionView,d[SS.CollapsibleListViewModelType]=rT.XraySwiftCollapsibleListContainer,d[gS.XrayTabLinkItemModelType]=iT.XrayTabLinkItem,d[Rv.ButtonViewModelType]=oT.XrayButton,d[fS.EmbeddedVideoViewModelType]=aT.EmbeddedVideoView,d[Rv.WidgetGroupType]=WS.WidgetGroupView,d[Rv.TextCollectionType]=HS.TextCollectionView,d[Rv.XrayTabBarItemType]=lT.XrayTab,d[Rv.XraySelectableCollectionContainerType]=mT.XraySelectableCollectionContainerView,d[Rv.TwoColumnSubheaderItemModelType]=yT.TwoColumnSubheaderItemView,d[Rv.TwoColumnTableItemModelType]=gT.TwoColumnTableItemView,d[Rv.XrayTwoColumnLiveItemModelType]=vT.XrayTwoColumnLiveItemView,d[Rv.XraySelectableNavigationsType]=ST.XraySelectableNavigationsView,d[Rv.XrayLiveQuickViewButtonModelType]=TT.XrayLiveQuickViewButton,d[Rv.LiveOneColumnTableModelType]=wT.LiveOneColumnTableView,d[Rv.TabHeaderType]=CT.XrayTabHeader,d[Rv.LiveScorecardViewModelType]=_T.LiveScorecardView,d[Rv.LiveScorecardColumnViewModelType]=xT.LiveScorecardColumnView,d[Rv.XrayBrandingImageModelType]=kT.XrayBrandingImageView,d[Rv.XrayTitledImageModelType]=RT.XrayTitledImageModelView,d[Rv.XrayTitledParagraphTextModelType]=AT.XrayTitledParagraphTextView,d[Rv.XrayPlayerStatisticModelType]=OT.XrayPlayerStatisticView,d[Rv.XrayImageGraphProbabilityPercentageModelType]=LT.XrayImageGraphProbabilityPercentageView,d[Rv.XrayParagraphTextModelType]=FT.XrayParagraphTextView,d[Rv.XrayPlayerStatisticQuickViewModelType]=DT.XrayPlayerStatisticQuickView,d[Rv.XrayTitledEmphasizedTextModelType]=NT.XrayTitledEmphasizedTextView,d[Rv.LiveHintableButtonViewModelType]=BT.LiveHintableButtonView,d[Rv.PopUpToggleViewModelType]=UT.PopUpToggleButtonView,d),xrayToken:bT.getCurrentXrayToken(r),displayModeOverride:this.getDisplayModeOverride()},l),this.setupLiveDebugOffsetSetter()}return e.prototype.initialize=function(){this.controller.initialize()},e.prototype.setVideoMaterialType=function(e){this.controller.setContentConfig({videoMaterialType:this.convertVideoMaterialType(e),titleId:"NO_TITLE"})},e.prototype.destroy=function(){this.controller.destroy()},e.prototype.getDisplayModeOverride=function(){if(!0===sp.QueryString.getParameter("forceScaledXrayUI"))return Rv.FullViewDisplayMode.SIDE_BY_SIDE_PLAYBACK},e.prototype.convertVideoMaterialType=function(e){return-1<e.indexOf("Live")?"LiveStreaming":e},e.prototype.setupLiveDebugOffsetSetter=function(){!0===sp.QueryString.getParameter("playerDebug")&&(Rv.XrayLiveDebugConfig.setEnabled(!0),window.xrayLiveDebugConfig=Rv.XrayLiveDebugConfig)},e}();t.XrayWebController=n});e(VT);VT.XrayWebController;var jT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e,{quickViewModel:Rv.SwiftQuickViewModelStore.getInstance()})||this;return t.xrayViewModelRenderer=new Rv.XrayViewModelRenderer,t}return i(e,n),e.prototype.render=function(){var e=this.state.quickViewModel;return null===e?null:this.xrayViewModelRenderer.renderViewModel(e,function(){},this.props.isShowing)},e}(Rv.ComputedStateView);t.XraySwiftQuickView=n});e(jT);jT.XraySwiftQuickView;var XT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:PS("hideUntilCssLoaded",this.props.className),style:{display:"none"}},this.props.children)},t}(Vn.PureComponent);t.CssDeferredComponent=i});e(XT);XT.CssDeferredComponent;var zT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});M.get("XrayQuickView");var n=function(n){function e(e){var t=n.call(this,e)||this;return t.adBreakIsPlayingStore=Rv.QuickViewStores.adBreakIsPlayingStore,t.IsFullViewOpenStore=Rv.IsFullViewOpenStore,t.lock=null,t.onClick=function(){t.lock.unlock()},t.onMouseMove=function(){t.props.isUserActive&&t.lock.lock(wb.UITimeoutMS.Hover20s)},t.onMouseLeave=function(){t.lock.unlock()},t.onStoreChange=function(){t.setState(t.getStateFromStore())},t.getStateFromStore=function(){return{isQuickViewAvailable:t.adBreakIsPlayingStore.getValue()&&!t.IsFullViewOpenStore.getValue()}},t.state={isQuickViewAvailable:t.adBreakIsPlayingStore.getValue()&&!t.IsFullViewOpenStore.getValue()},t}return i(e,n),e.prototype.componentDidMount=function(){this.lock=this.props.newLock(),this.adBreakIsPlayingStore.onChange(this.onStoreChange),this.IsFullViewOpenStore.onChange(this.onStoreChange)},e.prototype.componentWillUnmount=function(){null!==this.lock&&(this.props.deleteLock(this.lock),this.lock=null),this.adBreakIsPlayingStore.offChange(this.onStoreChange),this.IsFullViewOpenStore.offChange(this.onStoreChange)},e.prototype.render=function(){if(!this.state.isQuickViewAvailable)return null;var e=this.props.canShowXray&&this.props.isUserActive,t=PS("xrayQuickView",{show:e});return Vn.createElement(XT.CssDeferredComponent,null,Vn.createElement("div",{className:t,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onClick:this.onClick},Vn.createElement(jT.XraySwiftQuickView,{isShowing:e})))},e}(Vn.PureComponent);t.XrayQuickView=n});e(zT);zT.XrayQuickView;var qT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e,{isShowing:Rv.XrayModalStores.isShowingStore,viewModel:Rv.ShowXrayModalAction.store})||this;return t.dispatcher=Rv.XrayDispatcher.getInstance(),t}return i(e,n),e.prototype.render=function(){var e=this;if(!this.state.isShowing)return null;if(null===this.state.viewModel||null===this.state.viewModel.body)return null;var t=this.state.viewModel,n=PS("xrayModal",t.className),r=this.props.xrayViewModelRenderer;return Vn.createElement("div",{className:"xrayModalOverlay",onClick:function(){e.onClickOverlay()}},Vn.createElement("div",{className:n},r.renderViewModel(t.body,function(){},!0)))},e.prototype.onClickOverlay=function(){this.dispatcher.dispatch(new Rv.ShowXrayModalAction(null))},e}(Rv.ComputedStateView);t.XrayModal=n});e(qT);qT.XrayModal;var WT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:this.props.className},Vn.createElement("div",{className:"xrayLogo text"},"X-Ray"),this.props.showImdbLogo?Vn.createElement("div",{className:"xrayLogo imdbLogo"},Vn.createElement(wb.SVGImage,{src:Fb.SVG.IMDB_LOGO})):null)},t}(Vn.Component);t.XrayLogo=i});e(WT);WT.XrayLogo;var HT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClickFullscreen=function(){e.props.toggleFullscreen("MouseClick"),Rv.XrayInitializationContextAction.store.getValue().metricsFeature.reportInteraction("X-Ray",e.props.isFullscreen?"FullscreenOn":"FullscreenOff")},e}return n(e,t),e.prototype.render=function(){var t=this,n=this.props.isFullscreen?wb.SVG.ExitFullscreen:wb.SVG.Fullscreen,r=PS("fullscreenButton",{toggled:this.props.isFullscreen}),i=this.props.isFullscreen?"exitFullscreen":"fullscreen";return Vn.createElement(Gb.XrayContextConsumer,null,function(e){return Vn.createElement(wb.ImageButton,{wrapperClassName:"fullscreenButtonWrapper",className:r,onClick:t.onClickFullscreen,src:n,scalableTooltip:t.props.isScalable},e.localization.localizedStrings[i])})},e}(Vn.PureComponent);t.FullscreenButton=i});e(HT);HT.FullscreenButton;var GT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var t=this;return Vn.createElement(Gb.XrayContextConsumer,null,function(e){return Vn.createElement(wb.ImageButton,{className:"closeXrayButton",tooltipClassName:"closePlayerTooltip",wrapperClassName:"closeButtonWrapper",onClick:t.props.onClickClose,src:wb.SVG.Close,scalableTooltip:t.props.isScalable},t.props.tooltipText||e.localization.localizedStrings.close)})},t}(Vn.PureComponent);t.CloseButton=i});e(GT);GT.CloseButton;var KT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClickClose=function(){Rv.XrayDispatcher.getInstance().dispatch(new Rv.CloseXrayAction(Rv.XrayRefMarkers.NAVBAR_CLOSE))},e.noOpLoadListener=function(){},e}return n(e,t),e.prototype.render=function(){var e=PS("navBar",{show:this.props.shouldShow}),t=this.props.xrayViewModelRenderer;return Vn.createElement("div",{className:e},Vn.createElement(WT.XrayLogo,{className:"left",showImdbLogo:!0}),Vn.createElement("div",{className:"center"},t.renderViewModel(this.props.tabBarItemsModel,this.noOpLoadListener,this.props.shouldShow)),Vn.createElement("div",{className:"right"},Vn.createElement(HT.FullscreenButton,{isFullscreen:this.props.isFullscreen,toggleFullscreen:this.props.toggleFullscreen,isScalable:!0}),Vn.createElement("div",{className:"xrayDivider"}),Vn.createElement(GT.CloseButton,{onClickClose:this.onClickClose,isScalable:!0})))},e}(Vn.Component);t.XrayNavBar=i});e(KT);KT.XrayNavBar;var QT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.props,t=e.tabBarModel,n=e.fullViewState,r=t.shouldShow,i=n===Rv.XrayFullViewState.Hidden,o=PS("xrayFullView","xrayOverlayFullView","flexColumn",{show:!i}),a=PS("fullViewTop",{show:r,blur:this.props.modalIsShowing}),s=PS("swiftErrorPage",{show:n===Rv.XrayFullViewState.Error}),l=this.props.errorMessage||null;return Vn.createElement("div",{className:o},Vn.createElement("div",{className:a},Vn.createElement(KT.XrayNavBar,{shouldShow:r,tabBarItemsModel:t.tabBarItemsModel,isFullscreen:this.props.isFullscreen,toggleFullscreen:this.props.toggleFullscreen,xrayViewModelRenderer:this.props.xrayViewModelRenderer}),Vn.createElement(Jb.BackButton,{buttonText:this.props.backButtonText})),Vn.createElement(kb.XrayLoadingSpinner,{className:"whiteSpinner",shouldShow:n===Rv.XrayFullViewState.Loading}),Vn.createElement("p",{className:s},l),this.props.tabViews,Vn.createElement(qT.XrayModal,{xrayViewModelRenderer:this.props.xrayViewModelRenderer}))},t}(Vn.PureComponent);t.XrayOverlayFullView=i});e(QT);QT.XrayOverlayFullView;var YT=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.getTimeDisplay=function(e){var t=Math.floor(e/1e3),n=Math.floor(t/60);return t%=60,this.prefixInteger(n,2)+":"+this.prefixInteger(t,2)},e.prefixInteger=function(e,t){return e.toString().length>=t?e:(Array(t).join("0")+e).slice(-t)},e}();t.TimeDisplayUtils=n});e(YT);YT.TimeDisplayUtils;var JT=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({textAlign:"center",overflow:"hidden",opacity:1},Vd.media({maxWidth:"960px"},{display:"none"}),qS.ScalableMarginTop(34)),o=qS.styler({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),a=qS.styler({fontWeight:"normal"},qS.ScalableFontSize(24),o),s=qS.styler({fontWeight:"lighter"},qS.ScalableFontSize(21),qS.ScalablePaddingTop(3),o),l=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.render=function(){return Vn.createElement("div",{className:i},Vn.createElement("div",{className:a},this.props.seriesTitle),Vn.createElement("div",{className:s},this.props.contentTitle))},e}(Vn.Component);t.TopTitleView=l});e(JT);JT.TopTitleView;var $T=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({backgroundColor:qS.PrimaryColor,opacity:.25},qS.ScalableMarginBottom(-1),qS.ScalableWidth(1),qS.ScalableHeight(25)),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return xt.exists(this.props.show)&&!this.props.show?null:Vn.createElement("div",{className:i})},t}(Vn.Component);t.DividerView=o});e($T);$T.DividerView;var ZT=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({color:qS.PrimaryColor,opacity:.8,fontSize:"17px",transition:"opacity 150ms ease-in",cursor:"pointer",$nest:{"&:not(:first-child)":qS.ScaleNestedProperty("margin-left",18),"&:hover":{opacity:1}}},qS.ScalableMarginRight(19),qS.ScalableFontSize(17)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onClick=function(){t.dispatcher.dispatch(t.props.onClick)},t.dispatcher=Rv.XrayDispatcher.getInstance(),t}return i(e,n),e.prototype.render=function(){return xt.exists(this.props.show)&&!this.props.show?null:Vn.createElement("div",{className:o,onClick:this.onClick},this.props.buttonText)},e}(Vn.PureComponent);t.TextButtonView=n});e(ZT);ZT.TextButtonView;var eP=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({display:"inline-flex",alignItems:"center"},qS.ScalableMarginTop(30)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.isJABTitle="LiveStreaming"!==Rv.XrayPlaybackContextAction.store.getValue().videoMaterialType,t}return i(e,n),e.prototype.render=function(){return Vn.createElement("div",{className:o},Vn.createElement(HT.FullscreenButton,{isFullscreen:this.props.isFullscreen,toggleFullscreen:this.props.toggleFullscreen,isScalable:!0}),Vn.createElement($T.DividerView,null),Vn.createElement(ZT.TextButtonView,{buttonText:"Go Live",onClick:this.props.goLiveAction,show:!this.isJABTitle}),Vn.createElement($T.DividerView,{show:!this.isJABTitle}),Vn.createElement(ZT.TextButtonView,{buttonText:"Resume",onClick:this.props.resumeAction}))},e}(Vn.Component);t.TopButtonsView=n});e(eP);eP.TopButtonsView;var tP=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",pointerEvents:"auto",position:"absolute",$nest:{"&.hide":{opacity:0}}}),a=qS.styler({margin:"0 auto",perspective:"400px"}),n=qS.styler({cursor:"pointer"}),s=qS.styler({display:"inline-block"},qS.BreakpointSizes("margin",{0:"0 20",1200:"0 90"})),l=qS.styler({display:"inline-flex",alignItems:"center",fontWeight:"normal"},qS.ScalableFontSize(19)),u=qS.styler({borderStyle:"solid",borderColor:"transparent",opacity:.25,$nest:{"&.hide":{opacity:0,visibility:"hidden"},"&:hover:not(.hide)":{opacity:.75}}},qS.ScaleProperty("border-width",10)),c=qS.styler({position:"relative",shapeRendering:"crispEdges",float:"left"},qS.ScalableWidth(50),qS.ScalableHeight(50)),d=qS.styler({textAlign:"center"},qS.ScalableHeight(20),qS.ScalableWidth(49)),p=qS.styler(c,u,l,n),f=qS.styler(c,u,l,n),h=qS.styler(c,s,u,n),m=function(n){function e(e){var t=n.call(this,e)||this;return t.playbackController=Rv.XrayInitializationContextAction.store.getValue().player,t.receivePlaybackPositionActionStore=Rv.ReceivePlaybackPositionAction.store,t.receivePlaybackStateActionStore=Rv.ReceivePlaybackStateAction.store,t.onPlaybackStateChange=function(){t.setState({isPlaying:t.receivePlaybackStateActionStore.getValue()===Gd.PlaybackState.Playing})},t.onClickPlay=function(){t.state.isPlaying?t.playbackController.pause():t.playbackController.play()},t.onClickFastSeekBack=function(){var e=Math.max(0,t.receivePlaybackPositionActionStore.getValue()-3e3);xt.exists(t.props.minPositionMS)&&(e=Math.max(e,t.props.minPositionMS)),t.playbackController.seek(e),t.props.onSeek(e)},t.onClickFastSeekForward=function(){var e=Math.max(0,t.receivePlaybackPositionActionStore.getValue()+3e3);xt.exists(t.props.maxPositionMS)&&(e=Math.min(e,t.props.maxPositionMS)),t.playbackController.seek(e),t.props.onSeek(e)},t.state={isPlaying:!0},t}return i(e,n),e.prototype.componentDidMount=function(){this.onPlaybackStateChange(),this.receivePlaybackStateActionStore.onChange(this.onPlaybackStateChange)},e.prototype.componentWillUnmount=function(){this.receivePlaybackStateActionStore.offChange(this.onPlaybackStateChange)},e.prototype.render=function(){return Vn.createElement("div",{className:PS(o,{hide:!this.props.userActive})},Vn.createElement("div",{className:a},Vn.createElement("div",{className:p,onClick:this.onClickFastSeekBack},Vn.createElement(wb.SVGImage,{src:Fb.SVG.REWIND}),Vn.createElement("div",{className:d},3)),Vn.createElement("div",{className:h,onClick:this.onClickPlay},this.getPlayButtonSVG(this.state.isPlaying)),Vn.createElement("div",{className:f,onClick:this.onClickFastSeekForward},Vn.createElement(wb.SVGImage,{src:Fb.SVG.FAST_FORWARD}),Vn.createElement("div",{className:d},3))))},e.prototype.getPlayButtonSVG=function(e){return e?Vn.createElement(wb.SVGImage,{src:Fb.SVG.PAUSE}):Vn.createElement(wb.SVGImage,{src:Fb.SVG.PLAY})},e}(Vn.Component);t.PlayControlView=m});e(tP);tP.PlayControlView;var nP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("XrayOverlayPlayerView"),o=qS.styler({opacity:0}),a=function(t){function e(e){var n=t.call(this,e)||this;return n.playbackController=Rv.XrayInitializationContextAction.store.getValue().player,n.receivePlaybackPositionActionStore=Rv.ReceivePlaybackPositionAction.store,n.receiveContentStateActionStore=Rv.ReceiveContentStateAction.store,n.seekBarElement=null,n.lock=null,n.lockStore=null,n.touched=!1,n.pointerEventsSupported=xt.exists(window.PointerEvent),n.overlayPlayerViewRef=null,n.hasTimeUpdated=!1,n.seekToPosition=function(e){var t=n.props.highlightModel.clipStartPositionMs+Math.floor(e*n.props.highlightModel.clipDurationMs);n.playbackController.seek(t),n.props.onSeek(t)},n.onContentStateChange=function(){n.receiveContentStateActionStore.getValue()===Gd.ContentState.Ready&&n.initialLoad&&(n.playbackController.play(),n.loadMetricsReporter.endTimerAndReport(Rv.XrayMetricsConstants.XRAY_HIGHLIGHT_READY_TO_WATCH,null),n.initialLoad=!1)},n.onLockChange=function(e){n.setState({userActive:e})},n.onMouseEnterOverlayPlayer=function(){n.touched=!1,window.addEventListener("touchstart",n.onTouchInWindow),n.lock.lock(wb.UITimeoutMS.Standard)},n.onMouseLeaveOverlayPlayer=function(){n.touched||(n.lock.unlock(),window.removeEventListener("touchstart",n.onTouchInWindow))},n.onMouseMoveOverlayPlayer=function(){n.touched||n.lock.lock(null!==wb.UITimeoutMS.Standard?wb.UITimeoutMS.Standard:wb.UITimeoutMS.Touch)},n.onPointerDownOverlayPlayer=function(e){"touch"===e.pointerType&&(n.touched=!0,n.lock.lock(wb.UITimeoutMS.Touch))},n.onTouchStartOverlayPlayer=function(){n.pointerEventsSupported||(n.touched=!0,n.lock.lock(wb.UITimeoutMS.Touch))},n.onTouchInWindow=function(e){var t=e.touches[0];Ce.HTMLElementUtils.clickedInElement(n.overlayPlayerViewRef,t)||n.onMouseLeaveOverlayPlayer()},n.onMouseEnterProgressBar=function(){n.setState({isMouseInProgressBar:!0})},n.onMouseLeaveProgressBar=function(){n.setState({isMouseInProgressBar:!1})},n.onMouseMoveProgressBar=function(e){n.setState({mouseAtProgressBarPercentage:e})},n.onTimeUpdate=function(){if(n.receiveContentStateActionStore.getValue()===Gd.ContentState.Ready){if(!n.hasTimeUpdated)return void(n.hasTimeUpdated=!0);var e=n.receivePlaybackPositionActionStore.getValue()-n.props.highlightModel.clipStartPositionMs,t=Math.max(0,Math.min(1,e/n.props.highlightModel.clipDurationMs));1===t&&n.dispatcher.dispatch(n.props.goLiveAction),n.setState({currentPlayingRatio:t})}},n.state={currentPlayingRatio:0,isMouseInProgressBar:!1,mouseAtProgressBarPercentage:0,userActive:!1},n.lockStore=new tp.LockStore,n.dispatcher=Rv.XrayDispatcher.getInstance(),n.initialLoad=!0,n.loadMetricsReporter=new Rv.LoadMetricsReporter,n}return n(e,t),e.prototype.componentDidMount=function(){this.loadMetricsReporter.startTimer(),this.lock=this.lockStore.newLock(),this.receivePlaybackPositionActionStore.onChange(this.onTimeUpdate),this.onContentStateChange(),this.receiveContentStateActionStore.onChange(this.onContentStateChange),this.lockStore.onChange(this.onLockChange),this.playbackController.seek(this.props.highlightModel.clipStartPositionMs),this.hasTimeUpdated=!1},e.prototype.componentWillUnmount=function(){i.info("Reporting METRIC: "+Rv.XrayMetricsConstants.XRAY_HIGHLIGHT_COMPLETION_PERCENTAGE+" With: "+this.state.currentPlayingRatio),MT.metrics.putMetric(Rv.XrayMetricsConstants.XRAY_HIGHLIGHT_COMPLETION_PERCENTAGE,this.state.currentPlayingRatio),this.lockStore.deleteLock(this.lock),this.lock=null,this.receivePlaybackPositionActionStore.offChange(this.onTimeUpdate),this.receiveContentStateActionStore.offChange(this.onContentStateChange),this.lockStore.offChange(this.onLockChange)},e.prototype.render=function(){var t=this;if(null===this.props)return null;var e=0;this.state.isMouseInProgressBar&&(e=Math.floor(this.state.mouseAtProgressBarPercentage*this.seekBarElement.offsetWidth));var n=null;return this.state.userActive||(n=o),Vn.createElement("div",{className:"xrayOverlayPlayerView",onMouseEnter:this.onMouseEnterOverlayPlayer,onMouseLeave:this.onMouseLeaveOverlayPlayer,onMouseMove:this.onMouseMoveOverlayPlayer,onPointerDown:this.onPointerDownOverlayPlayer,onTouchStart:this.onTouchStartOverlayPlayer},Vn.createElement(tP.PlayControlView,{userActive:this.state.userActive,minPositionMS:this.props.highlightModel.clipStartPositionMs,maxPositionMS:this.props.highlightModel.clipDurationMs+this.props.highlightModel.clipStartPositionMs,onSeek:this.props.onSeek}),Vn.createElement("div",{className:PS("topView",n)},Vn.createElement("div",{className:"topBottons"},Vn.createElement(eP.TopButtonsView,{resumeAction:this.props.resumingAction,goLiveAction:this.props.goLiveAction,toggleFullscreen:this.props.toggleFullscreen,isFullscreen:this.props.isFullScreen})),Vn.createElement("div",{className:"title"},Vn.createElement(JT.TopTitleView,{seriesTitle:this.props.highlightModel.title}))),Vn.createElement("div",{className:PS("bottomView",n)},Vn.createElement("div",{className:"progressArea",ref:function(e){t.seekBarElement=e}},Vn.createElement(wb.Tooltip,{x:e,y:"85px",show:this.state.isMouseInProgressBar},Vn.createElement("div",{className:"tooltipText"},this.getDisplayTime(this.state.mouseAtProgressBarPercentage))),Vn.createElement(wb.ProgressBar,{enabled:!0,handlePercent:this.state.currentPlayingRatio,showHandleOnHover:!0,onMouseEnter:this.onMouseEnterProgressBar,onMouseLeave:this.onMouseLeaveProgressBar,onMouseMove:this.onMouseMoveProgressBar,onPercentSelect:this.seekToPosition},Vn.createElement(wb.ProgressBarSegment,{startPercent:0,endPercent:this.state.currentPlayingRatio}))),Vn.createElement("div",{className:"bottomArea"},Vn.createElement("div",{className:"text"},Vn.createElement("div",{className:"currentText"},this.getDisplayTime(this.state.currentPlayingRatio)),Vn.createElement("div",{className:"spliter"},"/"),Vn.createElement("div",{className:"totalText"},this.getDisplayTime(1-this.state.currentPlayingRatio))))))},e.prototype.getDisplayTime=function(e){var t=Math.floor(e*this.props.highlightModel.clipDurationMs);return YT.TimeDisplayUtils.getTimeDisplay(t)},e}(Vn.PureComponent);t.XrayOverlayPlayerView=a});e(nP);nP.XrayOverlayPlayerView;var rP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({background:"#1B2530",width:"100%",height:"100%",transition:"width 0.2s linear, height 0.2s linear",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",pointerEvents:"auto",position:"absolute",$nest:{"&.scale":{width:"71.875vw",height:"40.43vw",marginTop:"65px"}}}),o=qS.styler({color:"#ffffff",opacity:.8,marginTop:-50,fontSize:"1.3125rem",lineHeight:"1.5rem"}),a=qS.styler({position:"absolute",top:"calc(20.215vw + 75px)",left:"calc(35.9375vw - 25px)",width:"50px",height:"50px",transition:"top 0.2s linear, left 0.2s linear"},Vd.media({maxWidth:"960px"},{top:"50%",left:"calc(50% - 25px)"})),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playbackController=Rv.XrayInitializationContextAction.store.getValue().player,e.receiveContentStateActionStore=Rv.ReceiveContentStateAction.store,e.onContentStateChange=function(){e.receiveContentStateActionStore.getValue()===Gd.ContentState.Ready&&(e.playbackController.pause(),e.isMinTimeMet&&(e.playbackController.play(),e.props.onTransitionCompleted()))},e}return n(e,t),e.prototype.componentDidMount=function(){var e=this;this.onContentStateChange(),this.receiveContentStateActionStore.onChange(this.onContentStateChange),this.timer=setTimeout(function(){e.isMinTimeMet=!0,e.onContentStateChange()},this.props.minimumTimeToTransitionMs),this.playbackController.seek(this.props.resumingMs)},e.prototype.componentWillUnmount=function(){this.receiveContentStateActionStore.offChange(this.onContentStateChange),clearTimeout(this.timer)},e.prototype.render=function(){return Vn.createElement("div",{className:PS(i,{scale:this.props.isXrayOpen})},Vn.createElement("div",{className:o},this.props.resumingText),Vn.createElement(kb.XrayLoadingSpinner,{className:a,shouldShow:!0}))},e}(Vn.PureComponent);t.XrayHighlightTransitionView=s});e(rP);rP.XrayHighlightTransitionView;var iP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("XrayHighlightView"),o=function(t){function e(e){var n=t.call(this,e)||this;return n.playbackController=Rv.XrayInitializationContextAction.store.getValue().player,n.isSeeking=!1,n.isInitialized=!1,n.bufferStartTimeMillis=0,n.onSeek=function(e){n.isSeeking=!0},n.onContentStateChange=function(e){switch(e){case Gd.ContentState.Waiting:n.bufferStartTimeMillis=(new Date).getTime();break;case Gd.ContentState.Ready:if(!0!==n.isInitialized){var t=(new Date).getTime()-n.currentPlaybackSessionContext.sessionStartTime;Rv.XrayInsightClient.getInstance().sendPlaybackEvent(Rv.XrayInsightPlaybackEventType.READY_TO_WATCH,n.currentPlaybackSessionContext,t)}n.reportPlaybackBufferEvent(),n.isSeeking=!1,n.isInitialized=!0;break;case Gd.ContentState.Unloaded:n.isSeeking=!1,n.bufferStartTimeMillis=0,n.isInitialized=!1;break;case Gd.ContentState.Error:Rv.XrayInsightClient.getInstance().sendErrorEvent(Rv.XrayInsightErrorType.PLAYBACK,"Error during playback session "+n.currentPlaybackSessionContext.sessionId),n.isSeeking=!1,n.bufferStartTimeMillis=0}},n.onTransitionCompleted=function(){n.setState({shouldDisplayTransitionViewNow:!1})},n.state={shouldDisplayTransitionViewNow:!1},n}return n(e,t),e.prototype.componentDidUpdate=function(e){null!==e&&null!==e.viewModel&&(!e.viewModel.isHighlightModeOn&&this.props.viewModel.isHighlightModeOn&&(this.setState({shouldDisplayTransitionViewNow:!1}),this.isInitialized=!1,this.props.xrayPlaybackController.on("ContentStateChange",this.onContentStateChange),this.currentPlaybackSessionContext={contentId:this.props.viewModel.title,sessionId:fh.UUID.v4(),sessionType:Rv.XrayInsightPlaybackSessionType.HIGHLIGHT_SEEK,sessionStartTime:(new Date).getTime()},Rv.XrayInsightClient.getInstance().sendPlaybackEvent(Rv.XrayInsightPlaybackEventType.OPEN,this.currentPlaybackSessionContext)),e.viewModel.isHighlightModeOn&&!this.props.viewModel.isHighlightModeOn&&(this.setState({shouldDisplayTransitionViewNow:!0}),Rv.XrayInsightClient.getInstance().sendPlaybackEvent(Rv.XrayInsightPlaybackEventType.EXIT,this.currentPlaybackSessionContext),this.currentPlaybackSessionContext=null,this.props.xrayPlaybackController.off("ContentStateChange",this.onContentStateChange)))},e.prototype.render=function(){if(null===this.props||null===this.props.viewModel)return null;var e=this.props.viewModel,t=new Rv.XrayHighlightModeAction({isHighlightModeOn:!1,originalPlaybackPositionMs:e.originalPlaybackPositionMs,exitType:Rv.XrayHighlightExitType.RESUME}),n=new Rv.XrayHighlightModeAction({isHighlightModeOn:!1,originalPlaybackPositionMs:e.originalPlaybackPositionMs,exitType:Rv.XrayHighlightExitType.JOIN_LIVE});if(e.isHighlightModeOn)return Vn.createElement(nP.XrayOverlayPlayerView,{highlightModel:e,toggleFullscreen:this.props.toggleFullscreen,isFullScreen:this.props.isFullscreen,resumingAction:t,goLiveAction:n,onSeek:this.onSeek});if(this.state.shouldDisplayTransitionViewNow){var r=e.originalPlaybackPositionMs;if(e.exitType===Rv.XrayHighlightExitType.JOIN_LIVE){Rv.InteractionEventReporter.sendInteractionEventWithRefMarker(null,null,"X-Ray","MouseClick",Rv.XrayRefMarkers.HIGHLIGHT_GO_LIVE),Rv.XrayInsightClient.getInstance().sendInteractionEvent(Rv.XrayRefMarkers.HIGHLIGHT_GO_LIVE,Rv.XrayInsightInteractionType.NAVIGATION);var i=this.playbackController.getLiveGameTimeRange().livePositionMs;xt.exists(i)&&(r=i)}else Rv.InteractionEventReporter.sendInteractionEventWithRefMarker(null,null,"X-Ray","MouseClick",Rv.XrayRefMarkers.HIGHLIGHT_RESUME),Rv.XrayInsightClient.getInstance().sendInteractionEvent(Rv.XrayRefMarkers.HIGHLIGHT_RESUME,Rv.XrayInsightInteractionType.NAVIGATION);return Vn.createElement(rP.XrayHighlightTransitionView,{resumingText:this.getExitText(e.exitType),resumingMs:r,onTransitionCompleted:this.onTransitionCompleted,minimumTimeToTransitionMs:2e3,isXrayOpen:this.props.isXrayShowing})}return null},e.prototype.reportPlaybackBufferEvent=function(){if(0<this.bufferStartTimeMillis){var e=(new Date).getTime()-this.bufferStartTimeMillis,t=void 0;t=this.isSeeking?Rv.XrayInsightPlaybackEventType.BUFFER_SEEK:this.isInitialized?Rv.XrayInsightPlaybackEventType.BUFFER_UNEXPECTED:Rv.XrayInsightPlaybackEventType.BUFFER_INITIALIZATION,Rv.XrayInsightClient.getInstance().sendPlaybackEvent(t,this.currentPlaybackSessionContext,e),this.bufferStartTimeMillis=0}},e.prototype.getExitText=function(e){switch(e){case Rv.XrayHighlightExitType.JOIN_LIVE:return"Joining live";case Rv.XrayHighlightExitType.RESUME:return"Resuming last watched";default:var t="XrayHighlightExitType "+e+" is invalid.";return Rv.XrayInsightClient.getInstance().sendErrorEvent(Rv.XrayInsightErrorType.RUNTIME,t),i.error(t),""}},e}(Vn.PureComponent);t.XrayHighlightView=o});e(iP);iP.XrayHighlightView;var oP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});M.get("XrayReplayBoothView");var i=function(t){function e(e){var r=t.call(this,e)||this;return r.playbackController=Rv.XrayInitializationContextAction.store.getValue().player,r.xrayInitializationContext=Rv.XrayInitializationContextAction.store.getValue(),r.receiveXrayReplayBoothModeActionStore=Rv.XrayReplayBoothModeAction.store,r.receiveMiniXrayActionStore=Rv.ReceiveMiniXrayModelAction.store,r.receiveVolumeActionStore=Rv.ChangeVolumeAction.store,r.localizationStore=Rv.ReceiveLocalizationAction.store,r.dispatcher=Rv.XrayDispatcher.getInstance(),r.miniXrayLoader=Rv.MiniXrayLoader.getInstance(),r.iframeDomElement=null,r.iReplayPlayer=null,r.videoUrlIndex=0,r.bufferStartTimeMillis=void 0,r.levels=void 0,r.isSeeking=!1,r.isInitialized=!1,r.onReceiveXrayReplayBoothModeAction=function(){var e=r.receiveXrayReplayBoothModeActionStore.getValue();e.isReplayBoothOn?e.isReplayBoothOn&&0<e.videoCdnPreferenceList.length&&(r.videoUrlIndex=0,r.setState({isFullScreen:!1,viewModel:e,miniXrayError:!1,videoError:!1},function(){r.playbackController.pause(),r.startPlayback()})):(r.clearReplayView(),r.videoUrlIndex=0,r.seekToLive(),r.setState({viewModel:e,miniXrayModel:void 0}))},r.onReceiveMiniXrayModelAction=function(){var e=r.receiveMiniXrayActionStore.getValue();xt.exists(e)&&(r.dispatcher.dispatch(new Rv.ReceiveMiniXrayModelAction(null)),r.setState({miniXrayModel:e,miniXrayError:!e.isSuccess}))},r.toggleFullScreen=function(){r.setState({isFullScreen:!r.state.isFullScreen})},r.exitReplayBooth=function(){r.dispatcher.dispatch(new Rv.XrayReplayBoothModeAction({isReplayBoothOn:!1}))},r.seekToLive=function(){var e=r.playbackController.getLiveGameTimeRange();xt.exists(e)&&!isNaN(e.livePositionMs)&&r.playbackController.seek(e.livePositionMs),r.reportPlaybackSessionEndEvent(),r.playbackController.play(),xt.exists(r.props.postToastMessage)&&!r.state.videoError&&r.props.postToastMessage("Joining Live",4e3)},r.onSeek=function(e){r.isSeeking=!0},r.onManifestLoaded=function(e){var t=JSON.parse(e);xt.exists(t)&&xt.exists(t.stats)&&(r.levels=t.levels,r.reportResourceLoadEvent(t.url,Rv.XrayInsightResourceType.VIDEO_MANIFEST,t.stats.loaded,t.stats.tfirst,t.stats.tload))},r.onFragmentLoaded=function(e){var t=JSON.parse(e);if(xt.exists(t)&&xt.exists(t.stats)&&xt.exists(t.frag)&&xt.exists(r.levels)){var n=void 0;t.frag.level<r.levels.length&&(n=r.levels[t.frag.level].bitrate),r.reportResourceLoadEvent(t.frag.url,Rv.XrayInsightResourceType.MEDIA_FRAGMENT,t.stats.loaded,t.stats.tfirst,t.stats.tload,n)}},r.onPlay=function(){},r.onBufferStart=function(){r.bufferStartTimeMillis=(new Date).getTime()},r.onPlaybackReady=function(){r.startDownloadSwiftData(),r.reportPlaybackReadyToWatchEvent(),r.reportPlaybackBufferEvent(),r.isInitialized=!0,r.isSeeking=!1},r.onPlaybackEnded=function(){r.exitReplayBooth()},r.onPlaybackError=function(e){xt.exists(r.currentPlaybackSessionContext)&&Rv.XrayInsightClient.getInstance().sendErrorEvent(Rv.XrayInsightErrorType.PLAYBACK,e,r.getVideoUrl(),null,r.currentPlaybackSessionContext.sessionId),r.videoUrlIndex>=r.state.viewModel.videoCdnPreferenceList.length-1?(xt.exists(r.props.postToastMessage)&&r.props.postToastMessage(r.localizationStore.getValue().localizedStrings.swiftErrorMessage,4e3),r.setState({videoError:!0}),r.exitReplayBooth()):(r.videoUrlIndex++,r.startPlayback())},r.onPlaybackRuntimeError=function(){},r.onUserActive=function(){r.setState({isUserFocusOnPlayer:!0})},r.onUserNotActive=function(){r.setState({isUserFocusOnPlayer:!1})},r.onUserHoverOnPlayerControl=function(){r.setState({isUserHoverOnPlayerControl:!0})},r.onUserHoverOffPlayerControl=function(){r.setState({isUserHoverOnPlayerControl:!1})},r.state={isUserFocusOnPlayer:!1,isUserHoverOnPlayerControl:!1,isFullScreen:!1,videoError:!1,miniXrayError:!1,viewModel:r.receiveXrayReplayBoothModeActionStore.getValue()},r}return n(e,t),e.prototype.componentDidMount=function(){this.receiveXrayReplayBoothModeActionStore.onChange(this.onReceiveXrayReplayBoothModeAction),this.receiveMiniXrayActionStore.onChange(this.onReceiveMiniXrayModelAction)},e.prototype.componentWillUnmount=function(){this.receiveXrayReplayBoothModeActionStore.offChange(this.onReceiveXrayReplayBoothModeAction),this.receiveMiniXrayActionStore.offChange(this.onReceiveMiniXrayModelAction),this.isInitialized=!1},e.prototype.render=function(){var t=this,e=this.state.viewModel;if(!e.isReplayBoothOn)return null;var n=this.props.xrayViewModelRenderer,r=null;return r=this.state.miniXrayError?Vn.createElement(Gb.XrayContextConsumer,null,function(e){return Vn.createElement("div",{className:"replayMiniXrayError"},Vn.createElement("div",null,e.localization.localizedStrings.swiftErrorMessage))}):xt.exists(this.state.miniXrayModel)?n.renderViewModel(this.state.miniXrayModel.fullViewModel,function(){},!this.state.isFullScreen):Vn.createElement(kb.XrayLoadingSpinner,{shouldShow:!0,className:"replayLoadingSpinner"}),Vn.createElement("div",{className:"replayBoothContainer"},Vn.createElement("div",{className:PS("replayBoothHeader",{fullscreen:this.state.isFullScreen})},Vn.createElement("div",{className:"left"},e.headerText),Vn.createElement("div",{className:"right"},Vn.createElement("div",{className:"backButton",onClick:this.exitReplayBooth},"Go Live"))),Vn.createElement("div",{className:PS("replayMainPanel",{fullscreen:this.state.isFullScreen})},Vn.createElement("div",{className:PS("replayPlayerContainer",{fullscreen:this.state.isFullScreen})},Vn.createElement("div",{className:PS("replayOverlayTopView",{fullscreen:this.state.isFullScreen},{focus:this.state.isUserFocusOnPlayer})},Vn.createElement("div",{className:PS("topViewTitle",{show:this.state.isFullScreen})},e.title),Vn.createElement(HT.FullscreenButton,{isFullscreen:this.state.isFullScreen,toggleFullscreen:this.toggleFullScreen,isScalable:!1})),xt.exists(this.state.miniXrayModel)&&xt.exists(this.state.miniXrayModel.quickViewModel)?Vn.createElement("div",{className:PS("replayQuickViewAreaContainer",{fullscreen:this.state.isFullScreen},{focus:this.state.isUserFocusOnPlayer},{hide:this.state.isUserHoverOnPlayerControl})},n.renderViewModel(this.state.miniXrayModel.quickViewModel,function(){},!0)):null,this.state.videoError?Vn.createElement(Gb.XrayContextConsumer,null,function(e){return Vn.createElement("div",{className:"replayPlayerError"},Vn.createElement("div",null,e.localization.localizedStrings.swiftErrorMessage))}):Vn.createElement("iframe",{className:"replayPlayer",ref:function(e){t.iframeDomElement=e}})),Vn.createElement("div",{className:PS("replayFooter",{fullscreen:this.state.isFullScreen})},Vn.createElement("div",{className:"replayTitle"},e.title),Vn.createElement("div",{className:"replayFooterText"},xt.exists(this.state.miniXrayModel)&&xt.exists(this.state.miniXrayModel.brandingImageModel)?n.renderViewModel(this.state.miniXrayModel.brandingImageModel,function(){},!0):null))),Vn.createElement("div",{className:PS("replaySidePanel",{fullscreen:this.state.isFullScreen})},Vn.createElement("div",{className:"replaySidePanelHeader"},"Stats"),r))},e.prototype.startDownloadSwiftData=function(){this.miniXrayLoader.load(this.state.viewModel.miniXrayCdnPreferenceList,this.state.viewModel.miniXrayUrlMap)},e.prototype.startPlayback=function(){this.clearReplayView(),this.iReplayPlayer=new aS.IframePlayer(this.iframeDomElement),this.iReplayPlayer.on(aS.PlayerEvent.videoEnded,this.onPlaybackEnded),this.iReplayPlayer.on(aS.PlayerEvent.error,this.onPlaybackError),this.iReplayPlayer.on(aS.PlayerEvent.runtimeError,this.onPlaybackRuntimeError),this.iReplayPlayer.on(aS.PlayerEvent.ready,this.onPlaybackReady),this.iReplayPlayer.on(aS.PlayerEvent.userActive,this.onUserActive),this.iReplayPlayer.on(aS.PlayerEvent.userNotActive,this.onUserNotActive),this.iReplayPlayer.on(aS.PlayerEvent.hoverOnControl,this.onUserHoverOnPlayerControl),this.iReplayPlayer.on(aS.PlayerEvent.hoverOffControl,this.onUserHoverOffPlayerControl),this.iReplayPlayer.on(aS.PlayerEvent.playing,this.onPlay),this.iReplayPlayer.on(aS.PlayerEvent.buffering,this.onBufferStart),this.iReplayPlayer.on(aS.PlayerEvent.manifestLoaded,this.onManifestLoaded),this.iReplayPlayer.on(aS.PlayerEvent.fragmentLoaded,this.onFragmentLoaded),this.iReplayPlayer.on(aS.PlayerEvent.seeking,this.onSeek);var e=this.getVideoUrl();this.iReplayPlayer.startReplayPlayer(e,this.xrayInitializationContext.playerConfig.marketplaceId,this.receiveVolumeActionStore.getValue()),this.currentPlaybackSessionContext={contentId:this.state.viewModel.referenceId,sessionId:fh.UUID.v4(),playbackUrl:this.getVideoUrl(),sessionType:xv.XrayInsightPlaybackSessionType.HIGHLIGHT,sessionStartTime:(new Date).getTime()},this.reportPlaybackSessionStartEvent()},e.prototype.clearReplayView=function(){xt.exists(this.iReplayPlayer)&&(this.iReplayPlayer.off(aS.PlayerEvent.videoEnded,this.onPlaybackEnded),this.iReplayPlayer.off(aS.PlayerEvent.error,this.onPlaybackError),this.iReplayPlayer.off(aS.PlayerEvent.runtimeError,this.onPlaybackRuntimeError),this.iReplayPlayer.off(aS.PlayerEvent.ready,this.onPlaybackReady),this.iReplayPlayer.off(aS.PlayerEvent.userActive,this.onUserActive),this.iReplayPlayer.off(aS.PlayerEvent.userNotActive,this.onUserNotActive),this.iReplayPlayer.off(aS.PlayerEvent.hoverOnControl,this.onUserHoverOnPlayerControl),this.iReplayPlayer.off(aS.PlayerEvent.hoverOffControl,this.onUserHoverOffPlayerControl),this.iReplayPlayer.off(aS.PlayerEvent.playing,this.onPlay),this.iReplayPlayer.off(aS.PlayerEvent.buffering,this.onBufferStart),this.iReplayPlayer.off(aS.PlayerEvent.manifestLoaded,this.onManifestLoaded),this.iReplayPlayer.off(aS.PlayerEvent.fragmentLoaded,this.onFragmentLoaded),this.iReplayPlayer.off(aS.PlayerEvent.seeking,this.onSeek),this.iReplayPlayer.destroy()),this.bufferStartTimeMillis=void 0,this.levels=void 0},e.prototype.getVideoUrl=function(){var e=this.state.viewModel.videoCdnPreferenceList[this.videoUrlIndex];return this.state.viewModel.videoUrlMap[e]},e.prototype.reportPlaybackSessionStartEvent=function(){Rv.XrayInsightClient.getInstance().sendPlaybackEvent(_v.XrayInsightPlaybackEventType.OPEN,this.currentPlaybackSessionContext)},e.prototype.reportPlaybackReadyToWatchEvent=function(){if(xt.exists(this.currentPlaybackSessionContext)){var e=(new Date).getTime()-this.currentPlaybackSessionContext.sessionStartTime;Rv.XrayInsightClient.getInstance().sendPlaybackEvent(_v.XrayInsightPlaybackEventType.READY_TO_WATCH,this.currentPlaybackSessionContext,e)}},e.prototype.reportPlaybackBufferEvent=function(){if(0<this.bufferStartTimeMillis){var e=(new Date).getTime()-this.bufferStartTimeMillis,t=void 0;t=this.isSeeking?_v.XrayInsightPlaybackEventType.BUFFER_SEEK:this.isInitialized?_v.XrayInsightPlaybackEventType.BUFFER_UNEXPECTED:_v.XrayInsightPlaybackEventType.BUFFER_INITIALIZATION,Rv.XrayInsightClient.getInstance().sendPlaybackEvent(t,this.currentPlaybackSessionContext,e),this.bufferStartTimeMillis=0}},e.prototype.reportPlaybackSessionEndEvent=function(){Rv.XrayInsightClient.getInstance().sendPlaybackEvent(_v.XrayInsightPlaybackEventType.EXIT,this.currentPlaybackSessionContext),this.currentPlaybackSessionContext=void 0},e.prototype.reportResourceLoadEvent=function(e,t,n,r,i,o){Rv.XrayInsightClient.getInstance().sendResourceLoadEvent(e,t,!1,n,r,i,o)},e}(Vn.PureComponent);t.XrayReplayBoothView=i});e(oP);oP.XrayReplayBoothView;var aP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){var n=t.call(this,e)||this;return n.create=function(e,t){n.state.isEnabled||(n.message=e,n.displayDurationMillis=t,n.setState({isEnabled:!0}))},n.message=null,n.displayDurationMillis=0,n.timer=null,n.state={isEnabled:!1},n}return n(e,t),e.prototype.shouldComponentUpdate=function(e){return xt.exists(e)&&this.state.isEnabled!==e.isEnabled},e.prototype.componentWillUnmount=function(){uT.timer.clearTimeout(this.timer)},e.prototype.render=function(){var e=this;this.state.isEnabled&&null===this.timer&&(this.timer=uT.timer.setTimeout(function(){e.timer=null,e.setState({isEnabled:!1})},this.displayDurationMillis));var t=PS("toastNotificationView",{hide:!this.state.isEnabled});return Vn.createElement("div",{className:t},Vn.createElement("div",{className:"toastNotificationTextView"},this.message))},e}(Vn.Component);t.ToastNotificationView=i});e(aP);aP.ToastNotificationView;var sP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("XrayScaledFullView"),o=function(t){function e(e){var r=t.call(this,e)||this;return r.xrayHighlightModeStore=Rv.XrayHighlightModeAction.store,r.xrayReplayModeStore=Rv.XrayReplayBoothModeAction.store,r.xrayInitializationContext=Rv.XrayInitializationContextAction.store.getValue(),r.initialSwiftPageStore=Rv.ReceiveInitialSwiftPageAction.store,r.playbackController=Rv.XrayInitializationContextAction.store.getValue().player,r.xrayPlaybackContext=Rv.XrayPlaybackContextAction.store.getValue(),r.isXrayShowing=!0,r.interval=null,r.shouldReportLiveUIVisibleMetric=!1,r.screenResize=function(){r.props.fullViewState===Rv.XrayFullViewState.Hidden||r.state.xrayHighlightModel.isHighlightModeOn||(r.mediaQuery.matches?(r.onXrayHide(),r.isXrayShowing=!1):(r.onXrayOpen(),r.isXrayShowing=!0))},r.onClickClose=function(){Rv.XrayDispatcher.getInstance().dispatch(new Rv.CloseXrayAction(Rv.XrayRefMarkers.NAVBAR_CLOSE))},r.onXrayHide=function(){r.xrayPlaybackContext.playerStateManager.releaseFocus()},r.onXrayOpen=function(){r.xrayPlaybackContext.playerStateManager.requestFocus()},r.onHighlightModeStoreChange=function(){var e=r.xrayHighlightModeStore.getValue(),t=r.playbackController.getLiveGameTimeRange();if(e.isHighlightModeOn&&(e.clipStartPositionMs<t.startPositionMs||e.clipStartPositionMs+e.clipDurationMs>t.livePositionMs))return i.info("Reporting METRIC: "+Rv.XrayMetricsConstants.XRAY_HIGHLIGHT_LOAD_ERROR),MT.metrics.putMetric(Rv.XrayMetricsConstants.XRAY_HIGHLIGHT_LOAD_ERROR),void r.toastNotificationRef.current.create("Highlight Unavailable",4e3);r.xrayInitializationContext.playerHighlightModeController.setXrayHighlight(e.isHighlightModeOn),e.isHighlightModeOn||r.mediaQuery.matches?(r.onXrayHide(),r.isXrayShowing=!1):(r.onXrayOpen(),r.isXrayShowing=!0),r.setState({xrayHighlightModel:e})},r.onReplayBoothModeStoreChange=function(){r.setState({xrayReplayMode:r.xrayReplayModeStore.getValue()})},r.wasXrayShownInPastMinute=function(){r.shouldReportLiveUIVisibleMetric||(r.shouldReportLiveUIVisibleMetric=r.props.fullViewState!==Rv.XrayFullViewState.Hidden&&r.isXrayShowing)},r.initiateMetricInterval=function(){if(null!==r.initialSwiftPageStore.getValue()){var e=r.initialSwiftPageStore.getValue().pageContext.getLiveEventId(),t=e?Rv.XrayMetricsConstants.XRAY_LIVE_UI_VISIBLE+"-"+e:Rv.XrayMetricsConstants.XRAY_LIVE_UI_VISIBLE,n=e?Rv.XrayMetricsConstants.XRAY_LIVE_UI_HIDDEN+"-"+e:Rv.XrayMetricsConstants.XRAY_LIVE_UI_HIDDEN;null===r.interval&&(r.interval=setInterval(function(){MT.metrics.putMetric(r.shouldReportLiveUIVisibleMetric?t:n),r.shouldReportLiveUIVisibleMetric=!1,r.wasXrayShownInPastMinute()},6e4))}},r.toastNotificationRef=Vn.createRef(),r.state={xrayHighlightModel:r.xrayHighlightModeStore.getValue(),xrayHighlightMsg:null,xrayReplayMode:r.xrayReplayModeStore.getValue()},r}return n(e,t),e.prototype.componentDidMount=function(){this.mediaQuery=window.matchMedia("only screen and (max-width: 960px)"),this.mediaQuery.addListener(this.screenResize),this.xrayHighlightModeStore.onChange(this.onHighlightModeStoreChange),this.initialSwiftPageStore.onChange(this.initiateMetricInterval),this.xrayReplayModeStore.onChange(this.onReplayBoothModeStoreChange)},e.prototype.componentWillUnmount=function(){this.mediaQuery.removeListener(this.screenResize),this.xrayHighlightModeStore.offChange(this.onHighlightModeStoreChange),this.xrayReplayModeStore.offChange(this.onReplayBoothModeStoreChange),clearInterval(this.interval)},e.prototype.render=function(){var e=this.props,t=e.tabBarModel,n=e.fullViewState,r=t.shouldShow,i=n===Rv.XrayFullViewState.Hidden,o=PS("xrayFullView","xrayScaledFullView","flexColumn",{show:!i||this.state.xrayReplayMode.isReplayBoothOn}),a=PS("fullViewTop",{show:r,blur:this.props.modalIsShowing}),s=PS("swiftErrorPage",{show:n===Rv.XrayFullViewState.Error}),l=this.props.errorMessage||null;return this.wasXrayShownInPastMinute(),Vn.createElement("div",{className:o},Vn.createElement(aP.ToastNotificationView,{ref:this.toastNotificationRef}),Vn.createElement(oP.XrayReplayBoothView,{xrayViewModelRenderer:this.props.xrayViewModelRenderer,postToastMessage:xt.exists(this.toastNotificationRef.current)?this.toastNotificationRef.current.create:void 0}),Vn.createElement(iP.XrayHighlightView,{viewModel:this.state.xrayHighlightModel,isFullscreen:this.props.isFullscreen,isXrayShowing:this.isXrayShowing,toggleFullscreen:this.props.toggleFullscreen,xrayPlaybackController:this.playbackController}),Vn.createElement("div",{className:PS("header",{hide:this.state.xrayHighlightModel.isHighlightModeOn})},Vn.createElement(WT.XrayLogo,{className:"left",showImdbLogo:!1}),Vn.createElement("div",{className:"right"},Vn.createElement(HT.FullscreenButton,{isFullscreen:this.props.isFullscreen,isScalable:!1,toggleFullscreen:this.props.toggleFullscreen}),Vn.createElement("div",{className:"xrayDivider"}),Vn.createElement(GT.CloseButton,{onClickClose:this.onClickClose,isScalable:!1}))),Vn.createElement("div",{className:PS("sidePanel",{hide:this.state.xrayHighlightModel.isHighlightModeOn})},Vn.createElement("div",{className:a},this.props.xrayViewModelRenderer.renderViewModel(this.props.tabBarModel.tabBarItemsModel,function(){},this.props.tabBarModel.shouldShow)),Vn.createElement("p",{className:s},l),this.props.tabViews,Vn.createElement(kb.XrayLoadingSpinner,{className:"whiteSpinner",shouldShow:n===Rv.XrayFullViewState.Loading})),Vn.createElement(qT.XrayModal,{xrayViewModelRenderer:this.props.xrayViewModelRenderer}))},e}(Vn.PureComponent);t.XrayScaledFullView=o});e(sP);sP.XrayScaledFullView;var lP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("XrayFullView"),o=function(t){function e(e){var r=t.call(this,e,{fullViewModel:Rv.XraySwiftFullViewStore.getInstance(),playbackContext:Rv.XrayPlaybackContextAction.store,modalIsShowing:Rv.XrayModalStores.isShowingStore,localization:Rv.ReceiveLocalizationAction.store,xrayHighlightModel:Rv.XrayHighlightModeAction.store})||this;return r.previouslyShownTabs=[],r.fullViewRef=null,r.actionBackstackStore=Rv.ActionBackstackStore.getInstance(),r.xrayHighlightModeStore=Rv.XrayHighlightModeAction.store,r.XrayReplayBoothModeActionStore=Rv.XrayReplayBoothModeAction.store,r.handleKeyDown=function(e){if(e.stopPropagation(),e.keyCode===Y.KeyCode.ESC){if(null!==Rv.ShowXrayModalAction.store.getValue())return void Rv.XrayDispatcher.getInstance().dispatch(new Rv.ShowXrayModalAction(null));var t=r.xrayHighlightModeStore.getValue();if(t.isHighlightModeOn)return void Rv.XrayDispatcher.getInstance().dispatch(new Rv.XrayHighlightModeAction({isHighlightModeOn:!1,originalPlaybackPositionMs:t.originalPlaybackPositionMs,exitType:Rv.XrayHighlightExitType.JOIN_LIVE}));var n=r.XrayReplayBoothModeActionStore.getValue();if(null!==n&&n.isReplayBoothOn)return void Rv.XrayDispatcher.getInstance().dispatch(new Rv.XrayReplayBoothModeAction({isReplayBoothOn:!1}));if(1<r.actionBackstackStore.getValue().length)return void Rv.XrayDispatcher.getInstance().dispatch(new Rv.SelectPreviousAction(Rv.XrayRefMarkers.ESC_BUTTON));if(r.state.fullViewModel.fullViewState!==Rv.XrayFullViewState.Hidden)return void Rv.XrayDispatcher.getInstance().dispatch(new Rv.CloseXrayAction(Rv.XrayRefMarkers.ESC_BUTTON))}},r.handleKeyUp=function(e){e.stopPropagation()},r.noOpLoadListener=function(){i.info("Reporting METRIC: no-op")},r.setFullViewRef=function(e){r.fullViewRef=e},r.xrayViewModelRenderer=new Rv.XrayViewModelRenderer,r.tabViewModelMap=new Rv.KeyedMap(function(e){return e.toString()}),r}return n(e,t),e.prototype.componentWillUpdate=function(e,t){xt.exists(this.fullViewRef)&&t.fullViewModel.fullViewState!==Rv.XrayFullViewState.Hidden&&(this.fullViewRef.addEventListener("keydown",this.handleKeyDown),this.fullViewRef.addEventListener("keyup",this.handleKeyUp),this.fullViewRef.focus())},e.prototype.componentWillUnmount=function(){xt.exists(this.fullViewRef)&&(this.fullViewRef.removeEventListener("keydown",this.handleKeyDown),this.fullViewRef.removeEventListener("keyup",this.handleKeyUp))},e.prototype.render=function(){var e=this.state,t=e.fullViewModel,n=e.playbackContext,r=e.localization;if(null===t||null===n||null===r)return null;var i=t.tabViewModel;t.fullViewState===Rv.XrayFullViewState.Loaded&&this.tabViewModelMap.put(i.xrayCardKey,i);var o=this.buildTabViews(i),a={localization:r};return Vn.createElement(XT.CssDeferredComponent,null,Vn.createElement(Gb.XrayContextProvider,{value:a},Vn.createElement("div",{ref:this.setFullViewRef,tabIndex:-1},this.state.playbackContext.fullViewDisplayMode===Rv.FullViewDisplayMode.OVERLAY_PLAYBACK?Vn.createElement(QT.XrayOverlayFullView,s({},t,{tabViews:o,xrayViewModelRenderer:this.xrayViewModelRenderer,isFullscreen:this.props.isFullscreen,toggleFullscreen:this.props.toggleFullscreen,modalIsShowing:this.state.modalIsShowing})):Vn.createElement(sP.XrayScaledFullView,s({},t,{tabViews:o,xrayViewModelRenderer:this.xrayViewModelRenderer,isFullscreen:this.props.isFullscreen,toggleFullscreen:this.props.toggleFullscreen,modalIsShowing:this.state.modalIsShowing,hideButtonText:"Hide X-Ray"})))))},e.prototype.buildTabViews=function(a){var s=this;return F.map(this.tabViewModelMap.keys(),function(e){var t=null!==a&&a.xrayCardKey.equals(e),n=s.tabViewModelMap.get(e),r=s.state.modalIsShowing,i=PS("xrayTab",{withNavbar:n.shouldShowNavbar},{show:t,blur:r}),o=s.createLoadListener(n,t);return t?Rv.XrayInsightClient.getInstance().sendImpressionStartEvent(Rv.XrayInsightImpressionType.ACTIVE,n.viewModel.id):Rv.XrayInsightClient.getInstance().sendImpressionEndEvent(n.viewModel.id),Vn.createElement("div",{className:i,key:e.toString()},s.xrayViewModelRenderer.renderViewModel(n.viewModel,o,t,n.selectionDataMap))})},e.prototype.createLoadListener=function(e,t){var n=this;if(F.contains(this.previouslyShownTabs,e.xrayCardKey)||!t||!xt.exists(e.metricsId))return this.noOpLoadListener;var r=new Rv.LoadMetricsReporter;return r.startTimer(),function(){r.endTimerAndReport(e.metricsId,"XrayFullView"),n.previouslyShownTabs.push(e.xrayCardKey)}},e}(Rv.ComputedStateView);t.XrayFullView=o});e(lP);lP.XrayFullView;var uP=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e,{popUpModel:Rv.XrayPopUpViewModelStore.getInstance()})||this;return t.xrayViewModelRenderer=new Rv.XrayViewModelRenderer,t}return i(e,n),e.prototype.render=function(){var e=this.state.popUpModel;return null===e?null:this.xrayViewModelRenderer.renderViewModel(e,function(){},this.props.isShowing)},e}(Rv.ComputedStateView);t.XraySwiftPopUpView=n});e(uP);uP.XraySwiftPopUpView;var cP=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.IsFullViewOpenStore=Rv.IsFullViewOpenStore,t.lock=null,t.onClick=function(){t.lock.unlock()},t.onMouseMove=function(){t.props.isUserActive&&t.lock.lock(wb.UITimeoutMS.Hover20s)},t.onMouseLeave=function(){t.lock.unlock()},t.onStoreChange=function(){t.setState(t.getStateFromStore())},t.getStateFromStore=function(){return{isXrayFullView:!t.IsFullViewOpenStore.getValue()}},t.state={isXrayFullView:!t.IsFullViewOpenStore.getValue()},t}return i(e,n),e.prototype.componentDidMount=function(){this.lock=this.props.newLock(),this.IsFullViewOpenStore.onChange(this.onStoreChange)},e.prototype.componentWillUnmount=function(){null!==this.lock&&(this.props.deleteLock(this.lock),this.lock=null),this.IsFullViewOpenStore.offChange(this.onStoreChange)},e.prototype.render=function(){if(!this.state.isXrayFullView)return null;var e=this.props.canShowXray&&this.props.isUserActive,t=PS("xrayPopUpView",{show:e});return Vn.createElement(XT.CssDeferredComponent,{className:"popUpContainer"},Vn.createElement("div",{className:t,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,onClick:this.onClick},Vn.createElement(uP.XraySwiftPopUpView,{isShowing:e})))},e}(Vn.PureComponent);t.XrayPopUpView=n});e(cP);cP.XrayPopUpView;var dP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Localization=Yp.Localization,t.XrayController=VT.XrayWebController,t.XrayQuickView=zT.XrayQuickView,t.XrayFullView=lP.XrayFullView,t.WebXrayConfig=bT.DEFAULT_XRAY_CONFIG,t.XrayPopUpView=cP.XrayPopUpView});e(dP);dP.Localization,dP.XrayController,dP.XrayQuickView,dP.XrayFullView,dP.WebXrayConfig,dP.XrayPopUpView;var pP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.player=e}return e.prototype.getAllItems=function(){for(var e=[],t=this.player.timeline,n=t.items,r=0;r<n.length;r++){var i=n[r];e.push({timelineItem:i,timelineItemIndex:r,contentInfo:t.contentInfos[i.contentId]})}return e},e.prototype.getAllMainContentItems=function(){return this.getAllItems().filter(function(e){return"Feature"===e.contentInfo.contentType})},e.prototype.getFirstMainContentTimelineItem=function(e){return this.getMainContentItems(e)[0]},e.prototype.getItemForNextMainContentTitle=function(e){for(var t=this.player.timeline,n=t.items[e],r=e;r<t.items.length;r++){var i=t.items[r],o=t.contentInfos[i.contentId];if(n.groupId!==i.groupId&&"Feature"===o.contentType)return{timelineItem:i,timelineItemIndex:r,contentInfo:o}}return null},e.prototype.getItemsInGroup=function(e){for(var t=[],n=this.player.timeline,r=n.items,i=0;i<r.length;i++){var o=r[i];o.groupId===e&&t.push({timelineItem:o,timelineItemIndex:i,contentInfo:n.contentInfos[o.contentId]})}return t},e.prototype.getItemsInSameGroup=function(e){return this.getItemsInGroup(e.groupId)},e.prototype.getLastMainContentTimelineItem=function(e){var t=this.getMainContentItems(e);return t[t.length-1]},e.prototype.getMainContentItems=function(e){return this.getItemsInSameGroup(e).filter(function(e){return"Feature"===e.contentInfo.contentType})},e.prototype.getMidrollPosition=function(e,t){void 0===t&&(t=null),null===t&&(t=this.getItemsInSameGroup(e));for(var n=0,r=0,i=t;r<i.length;r++){var o=i[r],a=o.timelineItem.endTime;if("Feature"===o.contentInfo.contentType&&null!==a)n=a;else if(o.timelineItem.contentId===e.contentId)return n}return n},e.prototype.getMidrollPositions=function(e,t){var n=this;void 0===t&&(t=[]);for(var r=this.getItemsInGroup(e);"Feature"!==r[0].contentInfo.contentType;)r.shift();for(;"Feature"!==r[r.length-1].contentInfo.contentType;)r.pop();var i=r.filter(function(e){return"Advertisement"===e.contentInfo.contentType}).filter(function(e){return!F.contains(t,e.timelineItem.contentId)}).map(function(e){return n.getMidrollPosition(e.timelineItem,r)});return F.uniq(i)},e}();t.TimelineQuerier=n});e(pP);pP.TimelineQuerier;var fP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("SeekHelper"),n=function(){function e(e){this.player=e,this.timelineQuerier=new pP.TimelineQuerier(e)}return e.prototype.adjustSeekPosition=function(e,t,n){var r=this.player.timeline,i=this.player.currentTime;if(null==r||0===r.items.length||null==i)return null;if(null!=n)return{positionMs:e,timelineItemIndex:n};var o=r.items[i.currentTimelineItemIndex];if(this.getMainContentEndPositionMs(o)-3e3<=e)return t&&this.canAutoplayNextTitle(o,r)?this.adjustSeekPositionToNextTitle(o,r):this.adjustSeekPositionToEndOfTitle(o);for(var a=0,s=this.timelineQuerier.getMainContentItems(o);a<s.length;a++){var l=s[a];if(e<(null!=l.timelineItem.endTime?l.timelineItem.endTime:1/0))return{positionMs:e,timelineItemIndex:l.timelineItemIndex}}return null},e.prototype.adjustSeekPositionToEndOfTitle=function(e){o.info(">> adjustSeekPositionToEndOfTitle");var t=this.timelineQuerier.getLastMainContentTimelineItem(e);return{positionMs:(null!=t.timelineItem.endTime?t.timelineItem.endTime:1/0)-3e3,timelineItemIndex:t.timelineItemIndex}},e.prototype.adjustSeekPositionToNextTitle=function(e,t){o.info(">> adjustSeekPositionToNextTitle");var n=this.timelineQuerier.getLastMainContentTimelineItem(e),r=n.timelineItemIndex+1;if(t.items.length<=r)return o.warn("adjustSeekPositionToNextTitle, Reached end of timeline, last timeline index of current content is "+n.timelineItemIndex+", number of timeline items is "+t.items.length+" (Should not reach here!!!)"),null;var i=t.items[r];return{positionMs:null!=i.startTime?i.startTime:0,timelineItemIndex:r}},e.prototype.getMainContentEndPositionMs=function(e){var t=this.timelineQuerier.getLastMainContentTimelineItem(e);return null!=t.timelineItem.endTime?t.timelineItem.endTime:1/0},e.prototype.isLastTitleInTimeline=function(e,t){if(0===t.items.length)return!0;var n=t.items.length;return t.items[n-1].groupId===e.groupId},e.prototype.canAutoplayNextTitle=function(e,t){if(this.isLastTitleInTimeline(e,t))return!1;var n=this.timelineQuerier.getItemsInGroup(e.groupId),r=n[n.length-1],i=t.items[r.timelineItemIndex+1],o=this.timelineQuerier.getFirstMainContentTimelineItem(i);return null!=o.contentInfo.transitionTimecodes&&null!=o.contentInfo.transitionTimecodes.autoplaySettings&&o.contentInfo.transitionTimecodes.autoplaySettings.autoplayEnabled},e}();t.SeekHelper=n});e(fP);fP.SeekHelper;var hP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SeekHelper=fP.SeekHelper,t.TimelineQuerier=pP.TimelineQuerier});e(hP);hP.SeekHelper,hP.TimelineQuerier;var mP=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Preroll=0]="Preroll",r[r.Midroll=1]="Midroll",r[r.Postroll=2]="Postroll",t.AdBreakType=n});e(mP);mP.AdBreakType;var yP=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.AVOD=0]="AVOD",r[r.Draper=1]="Draper",t.AdType=n});e(yP);yP.AdType;var gP=t(function(e,t){var a=V&&V.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("AdPlaybackStore"),n=function(){function e(e,t,n,r,i){var o=this;this.adBreakType=null,this.adPlaying=!1,this.adReportingFeature=null,this.currentAdInfo=null,this.currentAdMetadata=null,this.volumeFeature=null,this.volume=1,this.previousContentType=null,this.previousContentId=null,this.onTimeDataChange=function(e){var t=o.player.timeline.items[e.currentTimelineItemIndex];if(null!=t){var n=o.player.timeline.contentInfos[t.contentId];if(null!=n){if("Advertisement"!==n.contentType)return o.previousContentType=n.contentType,o.previousContentId=t.contentId,void(o.adPlaying&&o.onAdBreakEnd());t.contentId!==o.previousContentId&&(null!==o.volumeFeature&&(o.volume=o.volumeFeature.volume),"Feature"!==o.previousContentType&&null!==o.previousContentType||o.onAdBreakStart(o.getAdBreakType(t)),o.onAdClipStart(n.metadata)),o.previousContentId=t.contentId,o.previousContentType=n.contentType;var r={startPositionMs:t.startTime,endPositionMs:o.getLastAdInBreakEndPosition(e.currentTimelineItemIndex),positionMs:e.currentPosition};o.currentAdInfo=a({},o.currentAdInfo,r),o.multicastCallback.invoke(o.currentAdInfo)}}},this.onFullscreenChange=function(){if(o.adPlaying){var e=o.fullscreenStore.isFullscreen()?"fullscreenOn":"fullscreenOff";s.info("Reporting ad event \""+e+"\".")}},this.onVolumeChange=function(){var e=o.volumeFeature.volume;o.adPlaying&&(0===e&&0!==o.volume?s.info("Reporting ad event \"mute\"."):0!==e&&0===o.volume&&s.info("Reporting ad event \"unmute\".")),o.volume=e},this.player=e,this.fullscreenStore=t,this.modalStore=n,this.networkStateStore=r,this.playerStuckStore=i,this.multicastCallback=new Dt.MulticastCallback,this.timelineQuerier=new hP.TimelineQuerier(this.player)}return e.prototype.initialize=function(){var t=this;this.fullscreenStore.addFullscreenListener(this.onFullscreenChange),this.player.on("TimeDataChange",this.onTimeDataChange),this.player.getFeature(this.player.Features.Volume).then(function(e){t.volumeFeature=e,t.volumeFeature.onChange(t.onVolumeChange)}).catch(function(e){s.error("An error occurred while trying to acquire the VolumeFeature.",e)}),this.player.getFeature(this.player.Features.AdReporting).then(function(e){t.adReportingFeature=e}).catch(function(e){s.error("An error occurred while trying to acquire the AdReportingFeature.",e)})},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.currentAdInfo=null,this.currentAdMetadata=null,this.fullscreenStore.removeFullscreenListener(this.onFullscreenChange),this.player.off("TimeDataChange",this.onTimeDataChange),this.previousContentType=null,(this.previousContentId=null)!==this.volumeFeature&&this.volumeFeature.offChange(this.onVolumeChange),this.volumeFeature=null},e.prototype.onAdPlaybackInfoChange=function(e){this.multicastCallback.add(e)},e.prototype.offAdPlaybackInfoChange=function(e){this.multicastCallback.remove(e)},e.prototype.getAdPlaybackInfo=function(){return this.currentAdInfo},e.prototype.skipClicked=function(){this.player.seek(0,this.player.currentTime.currentTimelineItemIndex+1)},e.prototype.clickThroughURLClicked=function(){null!=this.adReportingFeature?(this.player.pause(),s.info("Reporting ad clickthrough tracking URLs."),this.adReportingFeature.notifyAdInteractionEvent("clickThrough",this.currentAdMetadata.adInstanceId)):s.warn("Couldn't report clickthrough URL tracking because we don't have an AdReportingFeature.")},e.prototype.addToWatchlistClicked=function(){null!=this.adReportingFeature?(s.info("Reporting ad event \"addToWatchlist\"."),this.adReportingFeature.notifyAdInteractionEvent("customClick",this.currentAdMetadata.adInstanceId,"watchlist")):s.warn("Couldn't report \"addToWatchlist\" because we don't have an AdReportingFeature.")},e.prototype.getAdBreakType=function(e){var t=this.timelineQuerier.getItemsInSameGroup(e);return t[0].timelineItem.contentId===e.contentId?mP.AdBreakType.Preroll:t[t.length-1].timelineItem.contentId===e.contentId?mP.AdBreakType.Postroll:mP.AdBreakType.Midroll},e.prototype.onAdClipStart=function(e){var t="ATVDraperSchedulingService"===(this.currentAdMetadata=e).adSystem.name?yP.AdType.Draper:yP.AdType.AVOD,n=this.currentAdMetadata.showCountdownTimer||t!==yP.AdType.Draper,r=F.contains(this.currentAdMetadata.customClicks,"watchlist"),i=!0===this.currentAdMetadata.showSkipCountdownTimer,o=null!=this.currentAdMetadata.clickThroughUri?this.currentAdMetadata.clickThroughUri:null,a=xt.withDefault(this.currentAdMetadata.skipOffset,null);this.currentAdInfo={adType:t,clickThroughURL:o,hasAddToWatchlist:r,hasAdTimeIndicator:n,hasSkipTimeIndicator:i,showSeekBar:this.adBreakType!==mP.AdBreakType.Preroll,skipOffsetMs:a},this.multicastCallback.invoke(this.currentAdInfo)},e.prototype.onAdBreakStart=function(e){this.adPlaying=!0,this.networkStateStore.disable(),this.adBreakType=e},e.prototype.onAdBreakEnd=function(){this.adPlaying=!1,this.adBreakType=null,this.playerStuckStore.initiatingPlayback(),this.modalStore.resetWasPlaying(),this.networkStateStore.enable(),this.currentAdInfo=null,this.multicastCallback.invoke(this.currentAdInfo),this.currentAdMetadata=null},e.prototype.getLastAdInBreakEndPosition=function(e){for(var t=this.player.timeline.items,n=t[e],r=n.endTime,i=e+1;i<t.length;i++){var o=t[i];if("Feature"===this.player.timeline.contentInfos[o.contentId].contentType||o.groupId!==n.groupId)break;r=o.endTime}return r},e}();t.AdPlaybackStore=n});e(gP);gP.AdPlaybackStore;var vP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.LanguageCodeLabelMap={de:"Deutsch","de-de":"Deutsch",en:"English",eng:"English (US)","en-gb":"English (UK)","en-us":"English",es:"Español","es-es":"Español",fr:"Français","fr-fr":"Français",ja:"日本語","ja-jp":"日本語",pt:"Português","pt-br":"Português",aua:"Storm - Kremer",aub:"Scout’s Feed",sfx:"Stadium FX"}});e(vP);vP.LanguageCodeLabelMap;var SP=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).BetaLocalStorageKey="html5_web_player_beta",r.PreviousAudioTrack="websdk_previous_audio_track",r.AutoplayEnabled="autoplay_enabled",r.DontShowContentWarning="dont_show_content_warning",r.DontShowForceSDAssetWarning="dont_show_force_sd_asset_warning",r.ShowAutoplayCard="show_autoplay_card",r.CaptionsPreset="captions_preset",r.CaptionsScale="captions_scale",r.PreviousCaptions="html5_previous_captions",r.Muted="muted",r.Volume="volume",r.DataSaverSetting="data_saver_setting",t.StorageKeys=n});e(SP);SP.StorageKeys;var bP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.getStreamForStreamId=function(e,t,n){var r=e.streamGroups[n];if(null!==t)for(var i=0,o=r.streams;i<o.length;i++){var a=o[i];if(a.id===t)return a}return null},e.getActiveVariant=function(e,t){var n=this.getActiveStream(e,t);if(null!==n)for(var r=0,i=n.variants;r<i.length;r++){var o=i[r];if(o.id===n.activeVariantId)return o}return null},e.getActiveStream=function(e,t){var n=e.streamGroups[t];if(null!==n.activeId)for(var r=0,i=n.streams;r<i.length;r++){var o=i[r];if(o.id===n.activeId)return o}return null},e}();t.StreamQuerier=n});e(bP);bP.StreamQuerier;var TP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("AudioStreamStore"),n={streams:[],activeStream:null,activeVariant:null},a=["Dialog","Commentary","Descriptive",null],i=function(){function e(e){var r=this;this.audioStreamInfo=F.clone(n),this.currentLanguage=null,this.localizationStore=null,this.metricsReportingFeature=null,this.previousAudioStreamInfo=this.audioStreamInfo,this.streamFeature=null,this.onActiveStreamChange=function(e,t){if("Audio"===e){var n=null===r.audioStreamInfo.activeStream?null:r.audioStreamInfo.activeStream.id;r.previousAudioStreamInfo=r.audioStreamInfo,n!==t&&r.generateAndEmitAudioStreamInfo()}},this.onActiveVariantChange=function(e,t,n){"Audio"===e&&((null===r.previousAudioStreamInfo.activeVariant?null:r.previousAudioStreamInfo.activeVariant.id)!==n&&r.generateAndEmitAudioStreamInfo())},this.onLanguageChanged=function(e){e!==r.currentLanguage&&(r.currentLanguage=e,r.generateAndEmitAudioStreamInfo())},this.onStreamGroupChange=function(e,t){"Audio"===e&&r.generateAndEmitAudioStreamInfo()},this.onStreamChange=function(e,t){"Audio"===e&&r.generateAndEmitAudioStreamInfo()},this.player=e,this.storage=new Ce.LocalStorage,this.multicastCallback=new Dt.MulticastCallback}return e.prototype.initialize=function(e,t){var n=this;this.localizationStore=e,this.currentLanguage=xt.withDefault(this.localizationStore.getCurrentLanguage(),null),this.metricsReportingFeature=t,this.localizationStore.onLanguageChanged(this.onLanguageChanged),this.player.getFeature(this.player.Features.Stream).then(function(e){n.streamFeature=e,n.generateAndEmitAudioStreamInfo(),n.setInitialTrack(),n.streamFeature.on("ActiveStreamChange",n.onActiveStreamChange),n.streamFeature.on("ActiveVariantChange",n.onActiveVariantChange),n.streamFeature.on("StreamGroupChange",n.onStreamGroupChange),n.streamFeature.on("StreamChange",n.onStreamChange)}).catch(function(e){r.warn(e)})},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.audioStreamInfo=F.clone(n),null!==this.localizationStore&&this.localizationStore.offLanguageChanged(this.onLanguageChanged),(this.localizationStore=null)!==this.streamFeature&&(this.streamFeature.off("ActiveStreamChange",this.onActiveStreamChange),this.streamFeature.off("ActiveVariantChange",this.onActiveVariantChange),this.streamFeature.off("StreamGroupChange",this.onStreamGroupChange),this.streamFeature.off("StreamChange",this.onStreamChange)),this.streamFeature=null,this.metricsReportingFeature=null},e.prototype.onAudioStreamInfoChange=function(e){this.multicastCallback.add(e)},e.prototype.offAudioStreamInfoChange=function(e){this.multicastCallback.remove(e)},e.prototype.getAudioStreamInfo=function(){return this.audioStreamInfo},e.prototype.changeAudioStream=function(e,t){void 0===t&&(t="MouseClick"),r.info("Changing audio track to "+e+"."),this.metricsReportingFeature.reportInteraction("PlayerUI","Pause","Forced",null,null,null,"Customer"),this.metricsReportingFeature.reportInteraction("Player","TrackChange",t,null,null,null,"Customer"),this.setAudioStreamInStorage(e);var n=bP.StreamQuerier.getStreamForStreamId(this.streamFeature,e,"Audio");this.streamFeature.setStreamMatchers("Audio",[{language:n.language,type:n.type}])},e.prototype.selectNextTrack=function(){var e=this.audioStreamInfo.streams,t=e.indexOf(this.audioStreamInfo.activeStream),n=e[(t+1)%e.length];null!=n&&n!==this.audioStreamInfo.activeStream&&this.changeAudioStream(n.id,"KeyboardPress")},e.prototype.setInitialTrack=function(){var e=this.storage.get(SP.StorageKeys.PreviousAudioTrack);if(null!=e){var t;try{t=JSON.parse(e)}catch(e){return void r.warn("Couldn't parse previous track from local storage: "+e)}r.info("Setting initial audio track to "+t.id+"."),this.streamFeature.setStreamMatchers("Audio",[{language:t.language,type:t.type}])}},e.prototype.setAudioStreamInStorage=function(e){var t=bP.StreamQuerier.getStreamForStreamId(this.streamFeature,e,"Audio");null!==t&&this.storage.set(SP.StorageKeys.PreviousAudioTrack,JSON.stringify(t))},e.prototype.generateAndEmitAudioStreamInfo=function(){for(var e=this.streamFeature.streamGroups.Audio.streams,t=0,n=e;t<n.length;t++){var r=n[t];null==r.label&&(r.label=vP.LanguageCodeLabelMap[r.language])}var o,i=(o=Qt.Locales.makeLocaleComparator(e,function(e){return e.language},this.currentLanguage),function(e,t){var n=o(e,t);if(0===n){var r=a.indexOf(e.type),i=a.indexOf(t.type);return r<0&&(r=a.length),i<0&&(i=a.length),r-i}return n});this.audioStreamInfo={streams:e.sort(i),activeStream:bP.StreamQuerier.getActiveStream(this.streamFeature,"Audio"),activeVariant:bP.StreamQuerier.getActiveVariant(this.streamFeature,"Audio")},this.multicastCallback.invoke(this.audioStreamInfo)},e}();t.AudioStreamStore=i});e(TP);TP.AudioStreamStore;var PP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r,i=M.get("QualityCapStrategy");(r=n||(n={})).best="best",r.better="better",r.good="good",t.QualityCapStrategy=n,t.parse=function(e){var t;return"best"===e?t=n.best:"better"===e?t=n.better:"good"===e?t=n.good:(i.warn("QualityCapStrategy parse unexpected streamQuality: "+e),t=n.best),t}});e(PP);PP.QualityCapStrategy,PP.parse;var wP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("BandwidthCapperStore"),a=PP.QualityCapStrategy.best,r=function(){function e(e,t,n,r){var i=this;this.clickstreamReporter=null,this.currentBandwidthCapBitsPerSec=1/0,this.currentVideoStream=null,this.isHDCPCompliant=!0,this.streamFeature=null,this.onLanguageChanged=function(){i.updateQualityCaps()},this.updateHDCPCompliance=function(e){var t=e.isHDCPCompliant;t!==i.isHDCPCompliant&&(i.isHDCPCompliant=t,i.tryRunCurrentCapStrategy(),i.updateQualityCaps())},this.clickstreamReporter=r,this.hdcpStatusStore=n,this.localizationStore=t,this.player=e,this.storage=new Ce.LocalStorage,this.currentCapStrategyMulticastCallback=new Dt.MulticastCallback;var o=this.localizationStore.getLocalization();this.qualityCaps=[{id:PP.QualityCapStrategy.good,name:xt.nestedValue(o,"dataSaver.good.name"),description:xt.nestedValue(o,"dataSaver.good.description.hd.default")},{id:PP.QualityCapStrategy.better,name:xt.nestedValue(o,"dataSaver.better.name"),description:xt.nestedValue(o,"dataSaver.better.description.hd.default")},{id:PP.QualityCapStrategy.best,name:xt.nestedValue(o,"dataSaver.best.name"),description:xt.nestedValue(o,"dataSaver.best.description.hd.default")}],this.currentCapStrategy=PP.parse(xt.withDefault(this.storage.get(SP.StorageKeys.DataSaverSetting),a))}return e.prototype.initialize=function(){var t=this;this.player.getFeature(this.player.Features.Stream).then(function(e){t.streamFeature=e}).catch(function(e){n.warn(e)}),this.localizationStore.onLanguageChanged(this.onLanguageChanged),this.hdcpStatusStore.onHDCPStatusChange(this.updateHDCPCompliance)},e.prototype.destroy=function(){this.currentCapStrategyMulticastCallback.removeAll(),this.localizationStore.offLanguageChanged(this.onLanguageChanged),this.hdcpStatusStore.offHDCPStatusChange(this.updateHDCPCompliance),this.streamFeature=null},e.prototype.onCurrentCapStrategyUpdate=function(e){this.currentCapStrategyMulticastCallback.add(e)},e.prototype.offCurrentCapStrategyUpdate=function(e){this.currentCapStrategyMulticastCallback.remove(e)},e.prototype.setVideoStream=function(e){var t=this.hdAvailable(),n=this.isHEVC();this.currentVideoStream=e,this.tryRunCurrentCapStrategy(),t===this.hdAvailable()&&n===this.isHEVC()||this.updateQualityCaps()},e.prototype.setCapStrategy=function(e){if(this.currentCapStrategy=e,this.storage.set(SP.StorageKeys.DataSaverSetting,this.currentCapStrategy),this.currentCapStrategyMulticastCallback.invoke(this.currentCapStrategy),null!=this.clickstreamReporter){var t=e!==PP.QualityCapStrategy.good;this.clickstreamReporter.hdToggled(t)}this.tryRunCurrentCapStrategy()},e.prototype.getQualityCaps=function(){return this.qualityCaps},e.prototype.getCurrentCapStrategy=function(){return this.currentCapStrategy},e.prototype.getCurrentMaxBandwidth=function(){var e=1/0;return this.currentCapStrategy===PP.QualityCapStrategy.good?(this.hdAvailable(),e=8e5):this.currentCapStrategy===PP.QualityCapStrategy.better&&(e=this.hdAvailable()?3e6:18e5),e},e.prototype.tryRunCurrentCapStrategy=function(){if(null!=this.streamFeature){var e=this.getCurrentMaxBandwidth();if(e!==this.currentBandwidthCapBitsPerSec){this.currentBandwidthCapBitsPerSec=e,this.streamFeature.setMaxBitrateThreshold("Video",e);var t=e/1e3;n.info("Capping at "+t+" kbps.")}}else n.warn("No stream feature, can't run cap strategy.")},e.prototype.updateQualityCaps=function(){var e=this.isHEVC(),t=this.hdAvailable(),n=this.localizationStore.getLocalization();if(!F.isEmpty(n))for(var r=0,i=this.qualityCaps;r<i.length;r++){var o=i[r],a=n.dataSaver[o.id];o.name=a.name;var s=t&&this.isHDCPCompliant?a.description.hd:a.description.sd;o.description=e?s.hevc:s.default}},e.prototype.isHEVC=function(){return null!=this.currentVideoStream&&"hev1"===this.currentVideoStream.variants[0].codecs.split(".")[0]},e.prototype.hdAvailable=function(e){return void 0===e&&(e=this.currentVideoStream),null===e||F.some(e.variants,function(e){return 720<=e.height||1280<=e.width})},e}();t.BandwidthCapperStore=r});e(wP);wP.BandwidthCapperStore;var CP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.samples=e}return e.prototype.getSamplesAtPosition=function(t){var e=this.samples.filter(function(e){return e.beginTimeMs<=t&&t<e.endTimeMs});return 0<e.length?e:null},e.prototype.getSamples=function(){return this.samples},e}();t.CaptionsDocument=n});e(CP);CP.CaptionsDocument;var MP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var C=M.get("TtmlParserUtils"),n=function(){function w(){}return w.parseTtmlTimestampToMs=function(e,t,n){void 0===t&&(t=w.DEFAULT_FRAME_RATE),void 0===n&&(n=w.DEFAULT_SUBFRAME_RATE);var r=e.match(w.TIMESTAMP_REGEX);if(null===r||6!==r.length)throw new Error("ttmlTimestamp is in a wrong format: "+e);var i=parseInt(r[1]),o=parseInt(r[2]),a=parseInt(r[3]),s=0,l=0,u=0;return w.parsedTimestampHasFrames(r)&&(l=parseInt(w.stripLeadingPunctuation(r[4]))),w.parsedTimestampHasMillisOrSubframes(r)&&(w.parsedTimestampHasFrames(r)?u=parseInt(w.stripLeadingPunctuation(r[5])):s=1e3*parseFloat(r[5])),1e3*(60*(60*i+o)+(a+l/t+1/t/n*u))+s},w.parseLines=function(e,f,h,m,y,g,v,S,b){void 0===h&&(h=w.DEFAULT_FRAME_RATE),void 0===m&&(m=w.DEFAULT_SUBFRAME_RATE),void 0===y&&(y={}),void 0===g&&(g={}),null==f&&(f=function(e){C.info("Unhandled non-fatal error: "+e)});for(var T=[],P=e.getElementsByTagNameNS(e.namespaceURI,"p"),t=function(e){var t=P[e];if(!t.hasAttribute("begin"))return f(new Error("Missing begin attribute: "+(new XMLSerializer).serializeToString(t))),"continue";if(!t.hasAttribute("end"))return f(new Error("Missing end attribute: "+(new XMLSerializer).serializeToString(t))),"continue";var n=t.getAttribute("begin"),r=t.getAttribute("end"),i=w.parseTtmlTimestampToMs(n,h,m),o=w.parseTtmlTimestampToMs(r,h,m);if(o<i)return f(new Error("begin "+n+" was greater than end "+r)),"continue";var a=w.getInlineStyles(t),s=w.getRegionID(t,g,b),l=w.getStyleID(t),u=void 0,c=w.DEFAULT_WRITING_MODE;if(null!=s){u={id:s,styles:g[s]};var d=xt.nestedValue(u,"styles.writingMode",null);if(null!==d){if(!F.contains(w.VALID_WRITING_MODES,d))return f(new Error("Invalid/unsupported region writing mode: "+d)),"continue";c=d}}var p=w.bubbleUpRubyPosition({contents:w.parseElements(t,y,g,s),inlineStyles:a,styles:F.extend({},y[v],y[S],y[l])},c,function(e){f(new Error("Could not parse line "+T.length+" (begin=\""+n+"\", end=\""+r+"\"): "+e))});T.push({beginTimeMs:i,endTimeMs:o,element:p,region:u})},n=0;n<P.length;n++)t(n);return T},w.bubbleUpRubyPosition=function(e,t,n){null==n&&(n=function(e){C.info("Unhandled non-fatal error: "+e)});for(var r=w.WRITING_MODE_TTML_TO_CSS_MAP[t],i=[{element:e,elementName:"element",container:null}];0<i.length;){var o=i.pop(),a=o.element,s=o.container,l=xt.nestedValue(a,"styles.ruby",null),u=xt.nestedValue(a,"styles.rubyPosition",null);if(null!==u&&("before"!==u&&"after"!==u?n(new Error("rubyPosition \""+u+"\" is neither \"before\" nor \"after\" at "+o.elementName)):(u=r[u],a.styles.rubyPosition=u)),"container"===l)s=a;else if(null!==u){var c=!1;null===s&&(n(new Error("rubyPosition declared outside of a container at "+o.elementName)),c=!0),"text"!==l&&"textContainer"!==l&&(n(new Error("rubyPosition declared on an element besides text or textContainer at "+o.elementName)),c=!0),null!==xt.nestedValue(s,"styles.rubyPosition",null)&&(n(new Error("rubyPosition declared more than once in a container at "+o.elementName)),c=!0),c||(s.styles=xt.withDefault(s.styles,{}),s.styles.rubyPosition=u,delete a.styles.rubyPosition)}if("string"!=typeof a.contents)for(var d=a.contents,p=0;p<d.length;p++)"string"!=typeof d[p]&&i.push({element:d[p],elementName:o.elementName+".childNode("+p+")",container:s})}return e},w.htmlUnescape=function(e){return e.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},w.htmlEscape=function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},w.ttsAttributesWithoutNamespace=function(t){var e=Ce.DOMUtils.getAttributesInNamespace(t,w.TIMED_TEXT_STYLES_NAMESPACE),n={};return F.forEach(e,function(e){n[Ce.DOMUtils.getAttributeWithoutNamespace(e)]=t.getAttribute(e)}),n},w.getRegionID=function(e,t,n){void 0===n&&(n=null);var r=e.getAttribute("region");return""===r||null==r||null==t[r]?n:r},w.getStyleID=function(e,t){void 0===t&&(t=null);var n=e.getAttribute("style");return""===n||null==n?t:n},w.getInlineStyles=function(t){var n={};return F.forEach(Ce.DOMUtils.getAttributesInNamespace(t,w.TIMED_TEXT_STYLES_NAMESPACE),function(e){n[Ce.DOMUtils.getAttributeWithoutNamespace(e)]=t.getAttribute(e)}),n},w.parseElements=function(e,o,a,s){void 0===o&&(o={}),void 0===a&&(a={});var l=[];return F.forEach(e.childNodes,function(e){var t=e.nodeName.toLowerCase();switch(t){case"tt:br":case"br":l.push("<br>");break;case"tt:span":case"span":var n=e,r=w.getRegionID(n,a,s),i=w.getStyleID(n);l.push({contents:w.parseElements(n,o,a,r),inlineStyles:w.ttsAttributesWithoutNamespace(n),styles:F.clone(o[i])});break;case"#text":l.push(w.htmlEscape(w.htmlUnescape(e.nodeValue)));break;default:C.info("Unhandled type: "+t)}}),l},w.parsedTimestampHasFrames=function(e){return null!=e[4]},w.parsedTimestampHasMillisOrSubframes=function(e){return null!=e[5]},w.stripLeadingPunctuation=function(e){return e.substr(1,e.length-1)},w.camelCaseToDashed=function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},w.attributeIsCss=function(e){return!F.contains(w.NOT_CSS_ATTRIBUTES,e)},w.DEFAULT_FRAME_RATE=30,w.DEFAULT_SUBFRAME_RATE=1,w.DEFAULT_WRITING_MODE="lrtb",w.WRITING_MODE_TTML_TO_CSS_MAP={lrtb:{before:"over",after:"under"},rltb:{before:"over",after:"under"},tbrl:{before:"over",after:"under"},tblr:{before:"under",after:"over"}},w.VALID_WRITING_MODES=Object.keys(w.WRITING_MODE_TTML_TO_CSS_MAP),w.NOT_CSS_ATTRIBUTES=["background","backgroundColor","color","displayAlign","extent","fontFamily","fontShear","fontSize","origin","position","ruby","showBackground","textOutline","unicodeBidi","wrapOption"],w.TIMED_TEXT_STYLES_NAMESPACE="tts",w.TIMESTAMP_REGEX=/(\d{2,}):(\d{2}):(\d{2})(:\d{2,})?(\.\d+)?/,w}();t.TtmlParserUtils=n});e(MP);MP.TtmlParserUtils;var IP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("TtmlParser"),n=function(){function e(){}return e.prototype.parseString=function(e,t){var n=(new DOMParser).parseFromString(e,"application/xml");if(!n||!n.documentElement)throw new Error("Unable to parse TTML: DOMParser#parseFromString did not return a document");var r=n.documentElement.getElementsByTagName("parsererror");if(0<r.length)throw new Error("Unable to parse TTML: "+r[0]);return this.parse(n,t)},e.prototype.parse=function(e,t){if(0!==e.getElementsByTagName("parsererror").length)throw new Error("ttmlDocument parsing failed:\n"+e.getElementsByTagName("parsererror")[0].nodeValue);var n,r,i=this.getStylesFromHead(e.documentElement),o=this.getRegionsFromHead(e.documentElement,i),a=e.documentElement.getAttribute("ttp:frameRate"),s=e.documentElement.getAttribute("ttp:subframeRate");xt.exists(a)&&""!==a&&(n=parseInt(a)),xt.exists(s)&&""!==s&&(r=parseInt(s));var l=this.findFirstElementWithTag(e.documentElement,"body");if(!xt.exists(l))throw new Error("No body found in TTML document.");var u=this.findFirstElementWithTag(l,"div");if(!xt.exists(u))throw new Error("No div found in TTML body.");var c=MP.TtmlParserUtils.getRegionID(l,o),d=MP.TtmlParserUtils.getRegionID(u,o,c),p=MP.TtmlParserUtils.getStyleID(l),f=MP.TtmlParserUtils.getStyleID(u);return new CP.CaptionsDocument(MP.TtmlParserUtils.parseLines(u,t,n,r,i,o,p,f,d))},e.prototype.getStylesFromHead=function(e){var s={},l={},t=this.findFirstElementWithTag(e,"head");if(!xt.exists(t))return s;var n=this.findFirstElementWithTag(t,"styling");if(!xt.exists(n))return s;var r=n.getElementsByTagNameNS(e.namespaceURI,"style");return F.forEach(r,function(e){var t=e.getAttribute("xml:id");if("AmazonDefaultStyle"!==t){var n=Ce.DOMUtils.getAttributesInNamespace(e,"tts");s[t]={};for(var r=0,i=n;r<i.length;r++){var o=i[r];s[t][Ce.DOMUtils.getAttributeWithoutNamespace(o)]=e.getAttribute(o)}var a=e.getAttribute("style");xt.exists(a)&&""!==a&&(l[t]=a)}}),this.resolveStyleReferences(s,l),s},e.prototype.getRegionsFromHead=function(e,t){void 0===t&&(t={});var n={},r=this.findFirstElementWithTag(e,"head");if(!xt.exists(r))return n;var i=this.findFirstElementWithTag(r,"layout");if(!xt.exists(i))return n;for(var o=i.getElementsByTagNameNS(e.namespaceURI,"region"),a=0;a<o.length;a++){var s=o[a],l=s.getAttribute("xml:id");if("AmazonDefaultRegion"!==l){var u=Ce.DOMUtils.getAttributesInNamespace(s,"tts");n[l]={};for(var c=0,d=u;c<d.length;c++){var p=d[c];n[l][Ce.DOMUtils.getAttributeWithoutNamespace(p)]=s.getAttribute(p)}var f=s.getAttribute("style");if(xt.exists(f)){var h=t[f];xt.exists(h)&&(n[l]=F.extend(h,n[l]))}}}return n},e.prototype.resolveStyleReferences=function(e,t){var n=[];for(var r in e)e.hasOwnProperty(r)&&this.resolveStyleReference(r,e,t,n)},e.prototype.resolveStyleReference=function(e,t,n,r){r.push(e),xt.exists(n[e])&&(F.contains(r,n[e])||this.resolveStyleReference(n[e],t,n,r),F.extend(t[e],t[n[e]],t[e]))},e.prototype.findFirstElementWithTag=function(e,t){var n=e.getElementsByTagNameNS(e.namespaceURI,t);return 0<n.length?(1<n.length&&r.info("[TTML] Found multiple "+t+" tags. Using the first one."),n[0]):null},e}();t.TtmlParser=n});e(IP);IP.TtmlParser;var EP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CaptionsDocument=CP.CaptionsDocument,t.TtmlParser=IP.TtmlParser});e(EP);EP.CaptionsDocument,EP.TtmlParser;var _P=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Ad=0]="Ad",r[r.Live=1]="Live",r[r.Trailer=2]="Trailer",r[r.VOD=3]="VOD",t.ContentType=n});e(_P);_P.ContentType;var xP=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Captions=0]="Captions",r[r.ContentWarning=1]="ContentWarning",r[r.Diagnostics=2]="Diagnostics",r[r.Disclaimer=3]="Disclaimer",r[r.HDCPInfo=4]="HDCPInfo",r[r.Options=5]="Options",r[r.PIN=6]="PIN",r[r.PlayerStuck=7]="PlayerStuck",r[r.RateStreamingQuality=8]="RateStreamingQuality",r[r.SubtitlesAndAudio=9]="SubtitlesAndAudio",r[r.VideoQualityLearnMore=10]="VideoQualityLearnMore",t.Modal=n});e(xP);xP.Modal;var kP=t(function(e,t){var r=V&&V.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.fromRepresentativeTimedTextStream=function(e,t){var n=[];return n.push(e),null!=e.type&&"Mandatory"!==e.type&&(delete(e=r({},e)).type,n.push(e)),null!=e.subtype&&(delete(e=r({},e)).subtype,n.push(e)),"Mandatory"!==e.type&&null!=t&&n.push({type:"Mandatory",language:t}),n}});e(kP);kP.fromRepresentativeTimedTextStream;var RP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("TimedTextStreamDataDebouncer"),n=function(){function e(e){var i=this;this.eventEmitter=new Dt.EventEmitter,this.streamFeature=null,this.cachedTimedTextStreamData={},this.previousGroupId=null,this.previousTimelineItemIndex=null,this.onActiveStreamChange=function(e,t){"TimedText"===e&&i.reset()},this.onTimeDataChange=function(e){i.previousTimelineItemIndex!==e.currentTimelineItemIndex&&(i.previousTimelineItemIndex=e.currentTimelineItemIndex,i.onTimelineItemChange(e))},this.onTimedTextStreamData=function(e,t){var n=i.webPlayer.timeline.items[t.timelineItemIndex];if(null!=n){null==i.cachedTimedTextStreamData[n.groupId]&&(i.cachedTimedTextStreamData[n.groupId]={});var r=i.cachedTimedTextStreamData[n.groupId];null==r[n.contentId]||r[n.contentId].length!==t.data.length||r[n.contentId]!==t.data?(r[n.contentId]=t.data,i.eventEmitter.emit("TimedTextStreamData",e,t)):o.info("New timedTextStreamData for contentId "+n.contentId+" is identical to previously parsed one.")}},this.webPlayer=e}return e.prototype.initialize=function(){var t=this;this.webPlayer.on("TimeDataChange",this.onTimeDataChange),this.webPlayer.getFeature(this.webPlayer.Features.Stream).then(function(e){t.streamFeature=e,t.streamFeature.on("ActiveStreamChange",t.onActiveStreamChange),t.streamFeature.on("TimedTextStreamData",t.onTimedTextStreamData)}).catch(function(e){o.warn(e)})},e.prototype.destroy=function(){this.reset(),this.webPlayer.off("TimeDataChange",this.onTimeDataChange),null!=this.streamFeature&&(this.streamFeature.off("ActiveStreamChange",this.onActiveStreamChange),this.streamFeature.off("TimedTextStreamData",this.onTimedTextStreamData)),this.streamFeature=null},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.reset=function(){this.cachedTimedTextStreamData={}},e.prototype.onTimelineItemChange=function(e){if(0!==Object.keys(this.cachedTimedTextStreamData).length){var t=this.webPlayer.timeline.items[e.currentTimelineItemIndex].groupId;if(this.previousGroupId!==t)return this.previousGroupId=t,void this.onGroupIdChange(t);this.discardCachedTimedTextForPlayedAds(e,t)}},e.prototype.onGroupIdChange=function(e){this.discardAllCachedTimedTextNotForTheCurrentGroupId(e)},e.prototype.discardAllCachedTimedTextNotForTheCurrentGroupId=function(e){for(var t=0,n=Object.keys(this.cachedTimedTextStreamData);t<n.length;t++){var r=n[t];r!==e&&delete this.cachedTimedTextStreamData[r]}},e.prototype.discardCachedTimedTextForPlayedAds=function(e,t){var n=this.webPlayer.timeline.items,r=F.findIndex(n,function(e){return e.groupId===t});if(-1!==r)for(var i=r;i<e.currentTimelineItemIndex;i++){var o=n[i];if(o.groupId!==t)break;"Advertisement"===this.webPlayer.timeline.contentInfos[o.contentId].contentType&&delete this.cachedTimedTextStreamData[t][o.contentId]}},e}();t.TimedTextStreamDataDebouncer=n});e(RP);RP.TimedTextStreamDataDebouncer;var AP=t(function(e,t){var n,u=V&&V.__assign||function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("CaptionsStore"),d={streams:[],activeStream:null,activeVariant:null},p="default",f=((n={})[p]={txtColor:"#ffffff",bgColor:"#000000",bgOpacity:.5},n.preset1={txtColor:"#ffffff",bgColor:"#000000",bgOpacity:1},n.preset2={txtColor:"#000000",bgColor:"#ffffff",bgOpacity:1},n.preset3={txtColor:"#ffe000",bgColor:"#000000",bgOpacity:1},n),a=["Dialog","Commentary","Descriptive",null],r=function(){function n(e,t,n,r,i,o,a,s){var l=this;this.currentLanguage=null,this.gCastFeature=null,this.streamFeature=null,this.activeStreamId=null,this.currentAudioLanguage=null,this.currentCaptionsInfos=null,this.currentSamples=null,this.currentStreamMatcher=null,this.previousTimelineItemIndex=null,this.subtitlesEnabled=!1,this.timedTextStyle=null,this.timedTextStreamInfo=F.clone(d),this.onTitleInfoUpdate=function(e){if(e.contentType!==_P.ContentType.Ad){l.titleInfoStore.offUpdate(l.onTitleInfoUpdate);var r=Fe.CancelToken.source().token;l.serviceClient.send({queryParams:{consumptionType:"Streaming",desiredResources:"SubtitlePresets",resourceUsage:"ImmediateConsumption",titleId:e.titleId,videoMaterialType:l.videoMaterialType}},r).then(function(e){return r.throwIfRequested(),e.response()}).then(function(e){r.throwIfRequested();var t=e.getText(),n={};if(null!=t)try{n=JSON.parse(t)}catch(e){return c.warn("JSON parse error for response text: "+t),{}}return n}).then(function(e){r.throwIfRequested(),null!=e.subtitlePresets&&(l.captionsPresets=e.subtitlePresets.presets,l.setInitialStylePreset(),l.eventEmitter.emit("CaptionsPresetsChange",l.captionsPresets))}).catch(function(e){c.warn("Unable to acquire SubtitlesPresets: "+e)})}},this.onActiveStreamChange=function(e,t){"TimedText"===e&&(l.flushAllCaptions(),l.clearCaptions(),null==t?l.stopUpdating():null==l.activeStreamId&&l.startUpdating(),l.activeStreamId=t,(null===l.timedTextStreamInfo.activeStream?null:l.timedTextStreamInfo.activeStream.id)!==t&&l.generateTimedTextStreamInfo())},this.onActiveVariantChange=function(e,t,n){"TimedText"===e&&((null===l.timedTextStreamInfo.activeVariant?null:l.timedTextStreamInfo.activeVariant.id)!==n&&l.generateTimedTextStreamInfo())},this.onLanguageChanged=function(e){e!==l.currentLanguage&&(l.currentLanguage=e,l.generateTimedTextStreamInfo())},this.onTimedTextStreamData=function(e,t){if(null!==l.activeStreamId){var n=l.player.timeline.items[t.timelineItemIndex];if(null!=n){var r=l.parser.parseString(t.data,function(e){c.info(e)}),i=null!=t.timestampOffsetMs?t.timestampOffsetMs:0,o=null!=n.startTime?n.startTime:0,a=r.getSamples().map(function(e){var t=u({},e,{beginTimeMs:e.beginTimeMs-i+o,endTimeMs:e.endTimeMs-i+o});return xt.sanitize(t),t}),s=l.player.timeline.contentInfos[n.contentId];l.addToCurrentDocuments(new EP.CaptionsDocument(a),t,n,s),l.adjustToRetainableRanges(t)}}},this.onTimeDataChange=function(e){if(null!==l.currentCaptionsInfos&&0!==l.currentCaptionsInfos.length){l.previousTimelineItemIndex!==e.currentTimelineItemIndex&&(l.discardCaptionInfosForPlayedAdsOrNotTheCurrentGroupId(e),l.previousTimelineItemIndex=e.currentTimelineItemIndex);for(var t=null,n=0,r=l.currentCaptionsInfos;n<r.length;n++){var i=r[n];if(l.captionsInfoForCurrentContent(i,e)&&null!==(t=i.document.getSamplesAtPosition(e.currentPosition)))break}F.isEqual(t,l.currentSamples)||(l.currentSamples=t,l.eventEmitter.emit("CaptionsSamples",l.currentSamples))}},this.onPINRequiredChange=function(e){e?l.hide():l.show()},this.onTimedTextStyleChange=function(e){l.setTimedTextStyle(e)},this.onStreamGroupChange=function(e,t){"TimedText"===e&&(l.trySetInitialTimedTextStreamMatchers(),l.generateTimedTextStreamInfo())},this.onAudioStreamInfoChange=function(e){l.currentAudioLanguage=null==e.activeStream?null:e.activeStream.language,l.subtitlesEnabled?l.setStreamMatcher(l.currentStreamMatcher):l.disableStream()},this.player=e,this.modalStore=t,this.pinStore=n,this.localizationStore=r,this.serviceClient=i,this.titleInfoStore=o,this.isGCastPlayer=a,this.audioStreamStore=s,this.activePreset=p,this.captionsPresets=F.clone(f),this.eventEmitter=new Dt.EventEmitter,this.initializedTimedTextStreamMatchers=!1,this.parser=new EP.TtmlParser,this.storage=new Ce.LocalStorage,this.timedTextStreamDataDebouncer=new RP.TimedTextStreamDataDebouncer(e)}return n.prototype.initialize=function(){var t=this;this.currentCaptionsInfos=[],this.timedTextStyle=f[p];var e=parseFloat(this.storage.get(SP.StorageKeys.CaptionsScale))||1;this.currentLanguage=xt.withDefault(this.localizationStore.getCurrentLanguage(),null),this.localizationStore.onLanguageChanged(this.onLanguageChanged),this.timedTextStreamDataDebouncer.initialize(),this.timedTextStreamDataDebouncer.on("TimedTextStreamData",this.onTimedTextStreamData),this.player.getFeature(this.player.Features.Stream).then(function(e){t.streamFeature=e,t.generateTimedTextStreamInfo(),t.streamFeature.on("ActiveStreamChange",t.onActiveStreamChange),t.streamFeature.on("ActiveVariantChange",t.onActiveVariantChange),t.streamFeature.on("StreamGroupChange",t.onStreamGroupChange),t.player.on(Gd.PlayerEvent.TimeDataChange,t.onTimeDataChange)}).catch(function(e){c.warn(e)}),this.isGCastPlayer&&this.player.getFeature(this.player.Features.GCast).then(function(e){t.gCastFeature=e,t.gCastFeature.on("TimedTextStyleChange",t.onTimedTextStyleChange)}).catch(function(e){c.warn(e)}),this.pinStore.on("PINRequiredChange",this.onPINRequiredChange),this.setFontScale(e),this.audioStreamStore.onAudioStreamInfoChange(this.onAudioStreamInfoChange),null!==this.serviceClient&&this.titleInfoStore.onUpdate(this.onTitleInfoUpdate)},n.prototype.destroy=function(){this.timedTextStreamInfo=F.clone(d),this.eventEmitter.removeAllListeners(),this.localizationStore.offLanguageChanged(this.onLanguageChanged),this.player.off(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChange),this.pinStore.off("PINRequiredChange",this.onPINRequiredChange),null!==this.gCastFeature&&this.gCastFeature.off("TimedTextStyleChange",this.onTimedTextStyleChange),(this.gCastFeature=null)!==this.streamFeature&&(this.streamFeature.off("ActiveStreamChange",this.onActiveStreamChange),this.streamFeature.off("ActiveVariantChange",this.onActiveVariantChange),this.streamFeature.off("StreamGroupChange",this.onStreamGroupChange)),this.streamFeature=null,this.titleInfoStore.offUpdate(this.onTitleInfoUpdate),this.activeStreamId=null,this.currentAudioLanguage=null,this.currentCaptionsInfos=null,this.currentFontScale=null,this.currentSamples=null,this.currentStreamMatcher=null,this.initializedTimedTextStreamMatchers=!1,this.previousTimelineItemIndex=null,this.captionsPresets=F.clone(f),this.activePreset=p,this.timedTextStreamDataDebouncer.off("TimedTextStreamData",this.onTimedTextStreamData),this.timedTextStreamDataDebouncer.destroy()},n.prototype.on=function(e,t){this.eventEmitter.on(e,t)},n.prototype.once=function(e,t){this.eventEmitter.once(e,t)},n.prototype.off=function(e,t){this.eventEmitter.off(e,t)},n.prototype.show=function(){this.eventEmitter.emit("DisplayStatusChange",!0)},n.prototype.hide=function(){this.clearCaptions(),this.eventEmitter.emit("DisplayStatusChange",!1)},n.prototype.getTimedTextStyle=function(){return this.timedTextStyle},n.prototype.getTimedTextStreamInfo=function(){return this.timedTextStreamInfo},n.prototype.getFontScale=function(){return this.currentFontScale},n.prototype.onCaptionsSettingsClicked=function(e){var t=this.localizationStore.getLocalization();this.modalStore.showModal(xP.Modal.Captions,!1,e);var n=[{beginTimeMs:null,endTimeMs:null,element:{contents:null!=t?t.subtitlesExampleText:null}}];xt.sanitize(n[0]),this.eventEmitter.emit("CaptionsSamples",n)},n.prototype.onCloseModal=function(){this.clearCaptions()},n.prototype.onCaptionsTrackChanged=function(e){this.tryTrackChange(e)},n.prototype.onCaptionsSizeChanged=function(e){this.setFontScale(e)},n.prototype.setTimedTextStyle=function(e,t){void 0===t&&(t=null),this.timedTextStyle=e,this.timedTextStyle.fontScale=this.currentFontScale,this.eventEmitter.emit("TimedTextStyleChange",this.timedTextStyle),null!==t&&(this.activePreset=t,this.storage.set(SP.StorageKeys.CaptionsPreset,t),this.eventEmitter.emit("ActivePresetChange",t))},n.prototype.getCaptionsPresets=function(){return this.captionsPresets},n.prototype.getActiveCaptionsPreset=function(){return this.activePreset},n.prototype.setVideoMaterialType=function(e){this.videoMaterialType=e},n.prototype.selectNextTrack=function(){var e=n.OFF_ID;if(!F.isEmpty(this.timedTextStreamInfo.streams))if(null!=this.timedTextStreamInfo.activeStream){var t=this.timedTextStreamInfo.streams.indexOf(this.timedTextStreamInfo.activeStream);t<this.timedTextStreamInfo.streams.length-1&&(e=this.timedTextStreamInfo.streams[t+1].id)}else e=this.timedTextStreamInfo.streams[0].id;this.tryTrackChange(e)},n.prototype.setInitialStylePreset=function(){var e=this.storage.get(SP.StorageKeys.CaptionsPreset),t=this.captionsPresets[e];null!=t&&this.setTimedTextStyle(t,e)},n.prototype.trySetInitialTimedTextStreamMatchers=function(){if(!this.initializedTimedTextStreamMatchers){var e=this.storage.get(SP.StorageKeys.PreviousCaptions);if(null!==e){var t=JSON.parse(e);this.enableStream(t)}else this.disableStream();this.initializedTimedTextStreamMatchers=!0}},n.prototype.tryTrackChange=function(e){if(null!==this.currentCaptionsInfos){if(e===n.OFF_ID)return c.info("Captions were disabled."),this.storage.remove(SP.StorageKeys.PreviousCaptions),void this.disableStream();c.info("Changing captions track to "+e+".");var t=bP.StreamQuerier.getStreamForStreamId(this.streamFeature,e,"TimedText");this.storage.set(SP.StorageKeys.PreviousCaptions,JSON.stringify(t)),this.enableStream(t)}else c.error("Cannot change captions track, no captions available.")},n.prototype.enableStream=function(e){this.isGCastPlayer||(null!=e?(this.subtitlesEnabled=!0,this.setStreamMatcher({language:e.language,type:e.type,subtype:e.subtype})):c.warn("Track passed to enableStream does not exist, ignoring."))},n.prototype.setStreamMatcher=function(e){this.currentStreamMatcher=e;var t=kP.fromRepresentativeTimedTextStream(this.currentStreamMatcher,this.currentAudioLanguage);this.streamFeature.setStreamMatchers("TimedText",t)},n.prototype.disableStream=function(){this.isGCastPlayer||(null!=this.streamFeature?null!=this.currentAudioLanguage?(this.subtitlesEnabled=!1,this.setStreamMatcher({language:this.currentAudioLanguage,type:"Mandatory"}),this.flushAllCaptions()):c.warn("Tried to disable captions but currentAudioLanguage doesn't exist."):c.warn("Tried to disable captions but streamFeature doesn't exist."))},n.prototype.startUpdating=function(){this.stopUpdating(),this.player.on(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChange)},n.prototype.stopUpdating=function(){this.player.off(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChange),this.clearCaptions()},n.prototype.addToCurrentDocuments=function(e,t,n,r){if(0!==e.getSamples().length){var i={contentId:n.contentId,contentType:r.contentType,document:e,timelineItemIndex:t.timelineItemIndex,timestampOffsetMs:t.timestampOffsetMs,groupId:n.groupId,startPosition:t.startPosition,endPosition:t.endPosition};this.currentCaptionsInfos.push(i)}},n.prototype.adjustToRetainableRanges=function(s){var l=this;this.currentCaptionsInfos=this.currentCaptionsInfos.filter(function(e){var t=l.player.timeline.items,n=t[s.timelineItemIndex],r=t[s.timelineItemIndex].contentId;if(e.groupId!==n.groupId||e.contentId!==r)return!0;for(var i=0,o=s.retainableRanges;i<o.length;i++){var a=o[i];return e.endPosition>=a.startTimeMs&&e.startPosition<=a.endTimeMs}return!1})},n.prototype.discardCaptionInfosForPlayedAdsOrNotTheCurrentGroupId=function(t){var n=this.player.timeline.items[t.currentTimelineItemIndex];this.currentCaptionsInfos=this.currentCaptionsInfos.filter(function(e){return e.groupId===n.groupId&&("Feature"===e.contentType||!(e.timelineItemIndex<t.currentTimelineItemIndex))})},n.prototype.setFontScale=function(e){e<=0?c.error("Invalid captions font scale: "+e):(this.currentFontScale=e,this.setTimedTextStyle(this.timedTextStyle),this.storage.set(SP.StorageKeys.CaptionsScale,e.toString()))},n.prototype.generateTimedTextStreamInfo=function(){for(var e=this.streamFeature.streamGroups.TimedText.streams,t=0,n=e=e.filter(function(e){return"Mandatory"!==e.type});t<n.length;t++){var r=n[t];null==r.label&&(r.label=vP.LanguageCodeLabelMap[r.language])}var o,i=(o=Qt.Locales.makeLocaleComparator(e,function(e){return e.language},this.currentLanguage),function(e,t){var n=o(e,t);if(0===n){var r=a.indexOf(e.subtype),i=a.indexOf(t.subtype);return r<0&&(r=a.length),i<0&&(i=a.length),r-i}return n});this.timedTextStreamInfo={streams:e.sort(i),activeStream:bP.StreamQuerier.getActiveStream(this.streamFeature,"TimedText"),activeVariant:bP.StreamQuerier.getActiveVariant(this.streamFeature,"TimedText")},this.eventEmitter.emit("TimedTextStreamInfoChange",this.timedTextStreamInfo)},n.prototype.captionsInfoForCurrentContent=function(e,t){var n=this.player.timeline.items[t.currentTimelineItemIndex];return e.groupId===n.groupId&&n.contentId===e.contentId},n.prototype.flushAllCaptions=function(){this.currentCaptionsInfos=[]},n.prototype.clearCaptions=function(){this.eventEmitter.emit("CaptionsSamples",null)},n.OFF_ID="off",n}();t.CaptionsStore=r});e(AP);AP.CaptionsStore;var OP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.contentMetadata={}}return e.prototype.addContentMetadata=function(e,t){this.contentMetadata[e]=t},e.prototype.getContentMetadataFromTitle=function(e){return null==this.contentMetadata[e]?{}:this.contentMetadata[e]},e}();t.ContentMetadataStore=n});e(OP);OP.ContentMetadataStore;var LP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){var i=this;this.liveContentWarningShown=!1,this.contentState=null,this.onContentStateChange=function(e){i.contentState===Gd.ContentState.Unloaded&&e===Gd.ContentState.Waiting&&i.shouldShowContentWarning()&&(i.player.pause(),i.modalStore.showModal(xP.Modal.ContentWarning,!0),i.liveContentWarningShown=!0),i.contentState=e},this.player=e,this.modalStore=t,this.titleStore=n,this.uiConfigurationStore=r,this.storage=new Ce.LocalStorage}return e.prototype.initialize=function(){this.contentState=this.player.contentState,this.player.on(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange)},e.prototype.destroy=function(){this.liveContentWarningShown=!1,this.contentState=null},e.prototype.onCloseContentWarning=function(){this.liveContentWarningShown=!1},e.prototype.onContinueContentWarning=function(e){e?this.storage.set(SP.StorageKeys.DontShowContentWarning,"true"):this.storage.remove(SP.StorageKeys.DontShowContentWarning)},e.prototype.shouldShowContentWarning=function(){return!this.liveContentWarningShown&&this.uiConfigurationStore.getUIConfigurations().enableLiveContentWarning&&this.titleStore.getTitleInfo().contentType===_P.ContentType.Live&&"true"!==this.storage.get(SP.StorageKeys.DontShowContentWarning)},e}();t.ContentWarningStore=n});e(LP);LP.ContentWarningStore;var FP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var r=this;this.currentError=null,this.currentLocalizedError=null,this.pendingMetricsReportingFeature=null,this.metricsReportingFeature=null,this.onContentStateChange=function(e){if(e===Gd.ContentState.Error){var t=tp.ErrorCodeTransformer.transformError(r.player.contentError);r.showError(t)}else e===r.resetOnContentState&&r.reset()},this.onPlayerError=function(e){var t=tp.ErrorCodeTransformer.transformError(e);r.showError(t)},this.onLanguageChanged=function(e){null!==r.currentError&&r.showError(r.currentError)},this.player=e,this.resetOnContentState=t,this.requestedPlayerFeature=n,this.browser=Xh.getBrowser(),this.multicastCallback=new Dt.MulticastCallback}return e.prototype.initialize=function(e,t){this.amazonUrlCreator=e,this.localizationStore=t,this.player.on("Error",this.onPlayerError),this.player.on("ContentStateChange",this.onContentStateChange),this.localizationStore.onLanguageChanged(this.onLanguageChanged)},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.player.off("Error",this.onPlayerError),this.player.off("ContentStateChange",this.onContentStateChange),this.localizationStore.offLanguageChanged(this.onLanguageChanged),this.amazonUrlCreator=null,this.localizationStore=null,this.currentError=null,this.currentLocalizedError=null},e.prototype.showError=function(e){this.currentError=e;var t=this.player.currentTime.currentPosition,n=this.getLocalizedError(e),r={contactUsOrdersUrl:this.amazonUrlCreator.createCSUrl("CONTACT_US_ORDERS"),contactUsUrl:this.amazonUrlCreator.createCSUrl("CONTACT_US"),error1044Url:this.amazonUrlCreator.createCSUrl("1044"),error7031Url:this.amazonUrlCreator.createCSUrl("7031"),error7135Url:this.amazonUrlCreator.createCSUrl("7135"),hdcpHelpUrl:this.amazonUrlCreator.createCSUrl("HDCP_HELP"),ordersUrl:this.amazonUrlCreator.createCSUrl("ORDERS"),pvGoUpgradeUrl:this.amazonUrlCreator.createCSUrl("PVGO_UPGRADE"),settingsUrl:this.amazonUrlCreator.createCSUrl("SETTINGS"),setupPinUrl:this.amazonUrlCreator.createCSUrl("PIN_SETUP"),termsOfUseUrl:this.amazonUrlCreator.createCSUrl("TERMS_OF_USE"),videoHelpUrl:this.amazonUrlCreator.createCSUrl("VIDEO_HELP"),position:""+t},i=n.description;if(!xt.exists(i)&&xt.exists(n.default)){var o=this.requestedPlayerFeature===ct.WebPlayerSDKFeatures.GCastPlayer?"GCast":Xh.BrowserType[this.browser.getType()];xt.exists(n[o])||(o="default"),i=n[o]}Object.keys(r).forEach(function(e){i=i.replace(new RegExp("{{"+e+"}}","g"),r[e])}),n.description=i,n.playbackPosition=t,this.currentLocalizedError=n,this.multicastCallback.invoke(this.currentLocalizedError)},e.prototype.onError=function(e){this.multicastCallback.add(e)},e.prototype.offError=function(e){this.multicastCallback.remove(e)},e.prototype.getCurrentError=function(){return this.currentLocalizedError},e.prototype.reportError=function(t,n){return this.getMetricsReportingFeature().then(function(e){e.reportError(n,t,"Application","Error")})},e.prototype.getMetricsReportingFeature=function(){var t=this;return null!==this.pendingMetricsReportingFeature?this.pendingMetricsReportingFeature:null!==this.metricsReportingFeature?Fe.Promise.resolve(this.metricsReportingFeature):(this.pendingMetricsReportingFeature=this.player.getFeature(this.player.Features.MetricsReporting).then(function(e){return t.metricsReportingFeature=e,t.pendingMetricsReportingFeature=null,t.metricsReportingFeature}).catch(function(e){throw t.pendingMetricsReportingFeature=null,e}),this.pendingMetricsReportingFeature)},e.prototype.findLocalizedXpError=function(e,t,n){if(void 0===n&&(n=0),null==e)return null;var r=e.unknown||null,i=e[t[n]]||null;if(n===t.length-1)return null===i?r:i;var o=this.findLocalizedXpError(i,t,n+1);return null===o?r:o},e.prototype.getLocalizedError=function(e){var t=this.localizationStore.getLocalization();if(null==e.internalCode)return xt.withDefault(t[e.name],t.GenericError);var n=e.internalCode.split(".").map(function(e){return e.replace(/_([a-z])/g,function(e,t){return t.toUpperCase()})}),r=this.findLocalizedXpError(t.errors,n);return r.code=e.internalCode,r},e.prototype.reset=function(){null!==this.currentLocalizedError&&(this.currentError=null,this.currentLocalizedError=null,this.multicastCallback.invoke(this.currentLocalizedError))},e}();t.ErrorStore=n});e(FP);FP.ErrorStore;var DP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.focusedFeature=null,this.resumePlaybackOnFocusRelease=!1,this.keyInputStore=e,this.playbackStore=t}return e.prototype.requestFocus=function(e){return null===this.focusedFeature&&(this.playbackStore.getPlaybackState()===Gd.PlaybackState.Playing?(this.resumePlaybackOnFocusRelease=!0,this.playbackStore.pause()):this.resumePlaybackOnFocusRelease=!1,this.focusedFeature=e,!0)},e.prototype.releaseFocus=function(e){return e===this.focusedFeature&&(this.resumePlaybackOnFocusRelease&&this.playbackStore.play(),this.focusedFeature=null,this.keyInputStore.focusElement(),!0)},e.prototype.isFeatureFocused=function(){return null!==this.focusedFeature},e}();t.FeatureFocusStore=n});e(DP);DP.FeatureFocusStore;var NP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("FullscreenController"),r="mashfullscreenchange",i=function(){function e(e,t,n,r,i){void 0===r&&(r=document);var o=this;this.clickstreamReporter=null,this.metricsReportingFeature=null,this.isMASHView=!1,this.isMASHFullscreen=!1,this.onFullscreenChangeEvent=function(){var e=o.isFullscreen();if(o.multicastCallback.invoke(e),null!=o.metricsReportingFeature){var t=e?"Fullscreen":"Embedded";o.metricsReportingFeature.setDisplayMode(t)}},this.player=e,this.rootElement=t,this.uiConfigurationsStore=n,this.documentRef=r,this.clickstreamReporter=i,this.multicastCallback=new Dt.MulticastCallback}return e.prototype.initialize=function(e){this.metricsReportingFeature=e,this.addFullscreenListener(this.onFullscreenChangeEvent),this.updateFullscreenSupported(),this.checkMASHSupport()},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.metricsReportingFeature=null,this.removeFullscreenListener(this.onFullscreenChangeEvent)},e.prototype.onFullscreenStateChange=function(e){this.multicastCallback.add(e)},e.prototype.offFullscreenStateChange=function(e){this.multicastCallback.remove(e)},e.prototype.toggleFullscreen=function(e){var t;if(this.isFullscreen()?(t=!1,this.fullscreenOff()):(t=!0,this.fullscreenOn()),null!=this.metricsReportingFeature){var n=t?"FullscreenOn":"FullscreenOff";this.metricsReportingFeature.reportInteraction("Player",n,e)}null!=this.clickstreamReporter&&this.clickstreamReporter.fullScreenToggled(t)},e.prototype.isFullscreen=function(){var e=this.documentRef.fullscreenElement||this.documentRef.webkitFullscreenElement||this.documentRef.mozFullScreenElement||this.documentRef.msFullscreenElement;return this.isMASHFullscreen||null!==e&&e===this.rootElement},e.prototype.addFullscreenListener=function(e){this.documentRef.addEventListener(r,e),this.documentRef.addEventListener("fullscreenchange",e),this.documentRef.addEventListener("webkitfullscreenchange",e),this.documentRef.addEventListener("mozfullscreenchange",e),this.documentRef.addEventListener("MSFullscreenChange",e)},e.prototype.removeFullscreenListener=function(e){this.documentRef.removeEventListener(r,e),this.documentRef.removeEventListener("fullscreenchange",e),this.documentRef.removeEventListener("webkitfullscreenchange",e),this.documentRef.removeEventListener("mozfullscreenchange",e),this.documentRef.removeEventListener("MSFullscreenChange",e)},e.prototype.fullscreenOff=function(){this.isFullscreen()&&(this.isMASHView?this.mashExitFullscreen():this.documentRef.exitFullscreen?this.documentRef.exitFullscreen():this.documentRef.webkitExitFullscreen?this.documentRef.webkitExitFullscreen():this.documentRef.mozCancelFullScreen?this.documentRef.mozCancelFullScreen():this.documentRef.msExitFullscreen?this.documentRef.msExitFullscreen():n.error("Unable to exit fullscreen mode as this browser does not support HTML5 Fullscreen"))},e.prototype.fullscreenOn=function(){this.isMASHView?this.mashRequestFullscreen():xt.isNullOrUndefined(this.rootElement)?n.error("Entering fullscreen mode requires a root HTMLElement"):this.rootElement.requestFullscreen?this.rootElement.requestFullscreen():this.rootElement.webkitRequestFullscreen?this.rootElement.webkitRequestFullscreen():this.rootElement.mozRequestFullScreen?this.rootElement.mozRequestFullScreen():this.rootElement.msRequestFullscreen?this.rootElement.msRequestFullscreen():n.error("Unable to enter fullscreen mode as this browser does not support HTML5 Fullscreen")},e.prototype.updateFullscreenSupported=function(){this.uiConfigurationsStore.updateUIConfigurations({enableFullscreen:this.isFullscreenSupported()})},e.prototype.isFullscreenSupported=function(){return this.isMASHView||this.documentRef.fullscreenEnabled||this.documentRef.webkitFullscreenEnabled||this.documentRef.mozFullScreenEnabled||this.documentRef.msFullscreenEnabled},e.prototype.checkMASHSupport=function(){var t=this;Xh.getBrowser().getType()===Xh.BrowserType.AmazonWebView&&window.P&&window.P.when&&window.P.when("mash").execute(function(e){e.cancelFullscreen&&e.requestFullscreen&&(t.isMASHView=!0,t.updateFullscreenSupported())})},e.prototype.mashExitFullscreen=function(){var t=this;window.P.when("mash").execute(function(e){e.cancelFullscreen({successCallback:function(){t.isMASHFullscreen=!1,t.documentRef.dispatchEvent(new Event(r))},failCallback:function(){n.error("Unable to exit fullscreen mode by MASH")}})})},e.prototype.mashRequestFullscreen=function(){var t=this;window.P.when("mash").execute(function(e){e.requestFullscreen({successCallback:function(){t.isMASHFullscreen=!0,t.documentRef.dispatchEvent(new Event(r))},failCallback:function(){n.error("Unable to enter fullscreen mode by MASH")}})})},e}();t.FullscreenStore=i});e(NP);NP.FullscreenStore;var UP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("GCastBandwidthCapperStore"),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gCastFeature=null,t.dataUsage=i({},ct.DataUsageDefault),t.onFeatureDataUsageChange=function(e){t.dataUsage.displayText=e.displayText,null==e.bandwidthCap?(t.dataUsage.bandwidthCap=1/0,o.info("GCast bandwidth cap removed; display text to \""+t.dataUsage.displayText+"\"")):(t.dataUsage.bandwidthCap=e.bandwidthCap,o.info("GCast bandwidth cap changed to "+t.dataUsage.bandwidthCap/1e3+" kbps; display text to \""+t.dataUsage.displayText+"\"")),t.tryRunCurrentCapStrategy()},t}return n(t,e),t.prototype.initialize=function(){var t=this;e.prototype.initialize.call(this),this.player.getFeature(this.player.Features.GCast).then(function(e){t.gCastFeature=e,t.gCastFeature.on("DataUsageChange",t.onFeatureDataUsageChange)})},t.prototype.destroy=function(){e.prototype.destroy.call(this),null!==this.gCastFeature&&this.gCastFeature.off("DataUsageChange",this.onFeatureDataUsageChange),this.gCastFeature=null,this.dataUsage=i({},ct.DataUsageDefault)},t.prototype.getCurrentMaxBandwidth=function(){return this.dataUsage.bandwidthCap},t}(wP.BandwidthCapperStore);t.GCastBandwidthCapperStore=a});e(UP);UP.GCastBandwidthCapperStore;var BP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("GCastStore"),n=function(){function e(e,t){var n=this;this.gCastFeature=null,this.isFirmwareSupported=!0,this.currentCastState=ct.CastState.Disconnected,this.pinRequired=!1,this.preloadState=!1,this.onFeatureCastStateChange=function(e){n.currentCastState=e,n.eventEmitter.emit("CastStateChange",n.currentCastState)},this.onFeaturePINRequiredChange=function(e){n.pinRequired=e,n.eventEmitter.emit("PINRequiredChange",n.pinRequired)},this.onPreloadStateChange=function(e){var t=n.preloadState!==e;n.preloadState=e,t&&n.eventEmitter.emit("PreloadStateChange",e)},this.player=e,this.isGCastPlayer=t,this.eventEmitter=new Dt.EventEmitter}return e.prototype.initialize=function(){var t=this;this.isGCastPlayer&&(this.player.getFeature(this.player.Features.GCast).then(function(e){t.gCastFeature=e,t.gCastFeature.on("CastStateChange",t.onFeatureCastStateChange),t.gCastFeature.on("PINRequiredChange",t.onFeaturePINRequiredChange),t.gCastFeature.on("PreloadStateChange",t.onPreloadStateChange)}).catch(function(e){r.warn(e)}),this.isFirmwareSupported=this.validateFirmwareVersion())},e.prototype.destroy=function(){this.eventEmitter.removeAllListeners(),null!==this.gCastFeature&&(this.gCastFeature.off("CastStateChange",this.onFeatureCastStateChange),this.gCastFeature.off("PINRequiredChange",this.onFeaturePINRequiredChange),this.gCastFeature.off("PreloadStateChange",this.onPreloadStateChange)),this.gCastFeature=null,this.pinRequired=!1,this.currentCastState=ct.CastState.Disconnected},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.getCurrentCastState=function(){return this.currentCastState},e.prototype.getIsGCastPlayer=function(){return this.isGCastPlayer},e.prototype.getPINRequired=function(){return this.pinRequired},e.prototype.getIsFirmwareSupported=function(){return this.isFirmwareSupported},e.prototype.getPreloadState=function(){return this.preloadState},e.prototype.validateFirmwareVersion=function(){var e=Yh.deviceInformation.software.firmware;if(null==e)return r.error("Missing firmware"),!0;var t=Ce.Version.fromString(e.version),n=Ce.Version.fromString("1.29");return!(t.compareTo(n)<0)||(r.error("Firmware update required, "+e.version),!1)},e}();t.GCastStore=n});e(BP);BP.GCastStore;var VP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("HDCPStatusStore"),i={downscalingToSd:!1,isHDCPCompliant:!0,isHDCPRequired:!1},r=function(){function e(e,t){var r=this;this.hdcpStatus=F.clone(i),this.streamFeature=null,this.onStreamGroupRestrictionChange=function(e,t){if("Video"===e){var n=F.some(t,function(e){return"Hdcp"===e.restrictionType});r.hdcpStatus.isHDCPCompliant=!n,r.hdcpStatus.isHDCPRequired=n,r.multicastCallback.invoke(r.hdcpStatus)}},this.player=e,this.modalStore=t,this.multicastCallback=new Dt.MulticastCallback}return e.prototype.initialize=function(){var t=this;this.hdcpStatus=F.clone(i),this.player.getFeature(this.player.Features.Stream).then(function(e){t.streamFeature=e,t.streamFeature.on("StreamGroupRestrictionChange",t.onStreamGroupRestrictionChange)}).catch(function(e){n.error("Unable to acquire stream feature: "+e)})},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.hdcpStatus=F.clone(i),null!==this.streamFeature&&this.streamFeature.off("StreamGroupRestrictionChange",this.onStreamGroupRestrictionChange),this.streamFeature=null},e.prototype.onHDCPStatusChange=function(e){this.multicastCallback.add(e)},e.prototype.offHDCPStatusChange=function(e){this.multicastCallback.remove(e)},e.prototype.getHDCPStatus=function(){return this.hdcpStatus},e.prototype.hdcpInfoClicked=function(){this.modalStore.showModal(xP.Modal.HDCPInfo)},e}();t.HDCPStatusStore=r});e(VP);VP.HDCPStatusStore;var jP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("KeyInputStore"),h="KeyboardPress",r=function(){function e(e,t,n,r,i,o,a,s,l,u,c){var d,p,f=this;this.lifecycleStore=null,this.metricsReportingFeature=null,this.fullscreenEnabled=!0,this.playerCloseable=!0,this.volumeEnabled=!0,this.isPlayerPlaying=!1,this.keyInputInfo={keyboardFocus:!1},this.onPictureInPictureChange=function(e){f.fullscreenEnabled=!e},this.onPlaybackStateChange=function(e){f.isPlayerPlaying=e===Gd.PlaybackState.Playing},this.attachKeyListeners=function(e){e===Gd.PlaybackState.Playing&&(f.playbackStore.offPlaybackStateChange(f.attachKeyListeners),f.parentElement.addEventListener("keyup",f.onKeyup),f.parentElement.addEventListener("keydown",f.onKeydown),f.parentElement.addEventListener("click",f.onClick))},this.respondToKeyboardEvent=function(e,t){var n=f.modalStore.getModalInfo();if(!(f.modalStore.isModalShowing()||null!=n&&n.isPrePlayback||e.ctrlKey||e.altKey||e.metaKey)){e.keyCode!==Y.KeyCode.TAB&&(f.keyUpMap.hasOwnProperty(e.keyCode.toString())||f.keyDownMap.hasOwnProperty(e.keyCode.toString()))&&e.preventDefault();var r=t[e.keyCode];F.isFunction(r)&&(f.keyInputInfo.keyboardFocus=!0,f.multicastCallback.invoke(f.keyInputInfo),r(e))}},this.onKeyup=function(e){f.respondToKeyboardEvent(e,f.keyUpMap)},this.onKeydown=function(e){f.respondToKeyboardEvent(e,f.keyDownMap)},this.onClick=function(){f.keyInputInfo.keyboardFocus=!1,f.multicastCallback.invoke(f.keyInputInfo)},this.togglePlay=function(){f.playbackControlsPolicy.pauseEnabled&&(f.isPlayerPlaying?(null!==f.metricsReportingFeature&&f.metricsReportingFeature.reportInteraction("Player","Pause",h),f.playbackStore.pause()):(null!==f.metricsReportingFeature&&f.metricsReportingFeature.reportInteraction("Player","Play",h),f.playbackStore.play()))},this.fastSeekBack=function(){f.playbackControlsPolicy.seekBackwardEnabled&&f.playbackControlsPolicy.fastSeekEnabled&&(null!==f.metricsReportingFeature&&f.metricsReportingFeature.reportInteraction("Player","SeekBackward",h),f.playbackStore.seek(f.timelineInfoStore.getTimelineInfo().positionMs-1e4))},this.fastSeekForward=function(){f.playbackControlsPolicy.seekForwardEnabled&&f.playbackControlsPolicy.fastSeekEnabled&&(null!==f.metricsReportingFeature&&f.metricsReportingFeature.reportInteraction("Player","SeekForward",h),f.playbackStore.seek(f.timelineInfoStore.getTimelineInfo().positionMs+1e4))},this.volumeUp=function(){f.volumeEnabled&&(f.playbackStore.volume+=.05)},this.volumeDown=function(){f.volumeEnabled&&(f.playbackStore.volume-=.05)},this.toggleMute=function(){f.volumeEnabled&&f.playbackStore.toggleMute()},this.toggleFullscreen=function(){f.fullscreenEnabled&&f.fullScreenStore.toggleFullscreen(h)},this.closePlayer=function(){f.playerCloseable&&!f.fullScreenStore.isFullscreen()&&null!==f.lifecycleStore&&f.lifecycleStore.onClose(h)},this.tabFocus=function(e){f.trapFocus(e)},this.trapFocus=function(e){var t=f.parentElement.querySelectorAll('button:not([disabled]), input[type="range"]:not([disabled]), input[type="checkbox"]:not([disabled]), [tabIndex]:not([tabindex="-1"]'),n=t[0],r=t[t.length-3];e.shiftKey?document.activeElement===n&&(r.focus(),e.preventDefault()):document.activeElement===r&&(n.focus(),e.preventDefault())},this.enableNextCaptionsTrack=function(){f.captionsStore.selectNextTrack()},this.enableNextAudioTrack=function(){f.audioStreamStore.selectNextTrack()},this.onPlaybackControlsPolicyChange=function(e){f.playbackControlsPolicy=e},this.onUIConfigurationsChange=function(e){f.playerCloseable=e.playerCloseable,f.fullscreenEnabled=e.enableFullscreen,f.volumeEnabled=e.enableVolume},this.keyDownMap=((d={})[Y.KeyCode.ESC]=this.closePlayer,d[Y.KeyCode.LEFT_ARROW]=this.fastSeekBack,d[Y.KeyCode.RIGHT_ARROW]=this.fastSeekForward,d[Y.KeyCode.DOWN_ARROW]=this.volumeDown,d[Y.KeyCode.UP_ARROW]=this.volumeUp,d[Y.KeyCode.TAB]=this.tabFocus,d),this.keyUpMap=((p={})[Y.KeyCode.A]=this.enableNextAudioTrack,p[Y.KeyCode.C]=this.enableNextCaptionsTrack,p[Y.KeyCode.F]=this.toggleFullscreen,p[Y.KeyCode.M]=this.toggleMute,p[Y.KeyCode.SPACE]=this.togglePlay,p),this.parentElement=e,this.player=t,this.audioStreamStore=u,this.captionsStore=o,this.fullScreenStore=s,this.modalStore=n,this.multicastCallback=new Dt.MulticastCallback,this.pictureInPictureStore=c,this.playbackControlsPolicyStore=r,this.playbackStore=i,this.timelineInfoStore=a,this.uiConfigurationsStore=l,this.playbackControlsPolicy=this.playbackControlsPolicyStore.getPolicy()}return e.prototype.initialize=function(e){var t=this;this.lifecycleStore=e,this.pictureInPictureStore.onChange(this.onPictureInPictureChange),this.playbackStore.onPlaybackStateChange(this.attachKeyListeners),this.playbackStore.onPlaybackStateChange(this.onPlaybackStateChange),this.playbackControlsPolicyStore.onPolicyChange(this.onPlaybackControlsPolicyChange),this.uiConfigurationsStore.onUpdate(this.onUIConfigurationsChange),this.onUIConfigurationsChange(this.uiConfigurationsStore.getUIConfigurations()),this.player.getFeature(this.player.Features.MetricsReporting).then(function(e){t.metricsReportingFeature=e}).catch(function(e){n.error("Couldn't get MetricsReportingFeature: "+e)})},e.prototype.destroy=function(){this.keyInputOff(),this.pictureInPictureStore.offChange(this.onPictureInPictureChange),this.playbackStore.offPlaybackStateChange(this.attachKeyListeners),this.playbackStore.offPlaybackStateChange(this.onPlaybackStateChange),this.playbackControlsPolicyStore.offPolicyChange(this.onPlaybackControlsPolicyChange),this.uiConfigurationsStore.offUpdate(this.onUIConfigurationsChange)},e.prototype.keyInputOff=function(){this.parentElement.removeEventListener("keyup",this.onKeyup),this.parentElement.removeEventListener("keydown",this.onKeydown),this.parentElement.removeEventListener("click",this.onClick),this.playbackStore.onPlaybackStateChange(this.attachKeyListeners),this.keyInputInfo.keyboardFocus=!1,this.multicastCallback.invoke(this.keyInputInfo)},e.prototype.focusElement=function(){this.parentElement.focus()},e.prototype.getKeyInputInfo=function(){return this.keyInputInfo},e.prototype.onUpdate=function(e){this.multicastCallback.add(e)},e.prototype.offUpdate=function(e){this.multicastCallback.remove(e)},e}();t.KeyInputStore=r});e(jP);jP.KeyInputStore;var XP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("WebPlayerUI");var n=function(){function e(e,t,n,r,i,o,a,s,l,u){this.metricsReportingFeature=null,this.player=e,this.adPlaybackStore=t,this.fullscreenStore=n,this.keyInputStore=r,this.modalStore=i,this.nextUpInfoStore=o,this.timelineInfoStore=a,this.titleInfoStore=s,this.userInterfaceStatusStore=l,this.pictureInPictureStore=u}return e.prototype.initialize=function(e){this.metricsReportingFeature=e},e.prototype.destroy=function(){this.metricsReportingFeature=null},e.prototype.onClose=function(e){this.fullscreenStore.fullscreenOff(),this.timelineInfoStore.clearTimelineInfo(),this.titleInfoStore.clearTitle(),this.userInterfaceStatusStore.onClosePlayer(),this.modalStore.onClosePlayer(),this.nextUpInfoStore.clearNextUpInfo(),this.keyInputStore.keyInputOff(),this.pictureInPictureStore.onClosePlayer(),this.metricsReportingFeature.reportInteraction("Player","Stop",e),this.player.closePlayer()},e}();t.LifecycleStore=n});e(XP);XP.LifecycleStore;var zP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["tv_nr","nr","unrated"],a=M.get("MaturityRatingStore"),r=function(){function e(e,t){var r=this;this.currentMaturityRating={description:null,rating:null,ratingImageSrc:null},this.metricsReportingFeature=null,this.ratingChangeCallback=new Dt.MulticastCallback,this.onTitleStoreUpdate=function(e){if(e.contentType!==_P.ContentType.Live&&null!=e.titleId){var t=e.titleId,n=xt.withDefault(e.gti,t);r.fetchMaturityRating(t,n).then(function(e){r.titleInfoStore.getTitleInfo().titleId===t&&r.titleInfoStore.getTitleInfo().gti===n&&(r.currentMaturityRating=e,r.ratingChangeCallback.invoke(r.currentMaturityRating))})}},this.borgClient=e,this.titleInfoStore=t,this.previousReportedComponentState={isVisible:!1,maturityRating:{}}}return e.prototype.initialize=function(e){this.metricsReportingFeature=e,this.onTitleStoreUpdate(this.titleInfoStore.getTitleInfo()),this.titleInfoStore.onUpdate(this.onTitleStoreUpdate)},e.prototype.destroy=function(){this.titleInfoStore.offUpdate(this.onTitleStoreUpdate),this.ratingChangeCallback.removeAll()},e.prototype.getMaturityRating=function(){return this.currentMaturityRating},e.prototype.onMaturityRatingChange=function(e){this.ratingChangeCallback.add(e)},e.prototype.offMaturityRatingChange=function(e){this.ratingChangeCallback.remove(e)},e.prototype.reportVisibleMaturityRating=function(e,t){e!==this.previousReportedComponentState.isVisible&&(this.previousReportedComponentState={isVisible:e,maturityRating:t},e?Pt.metrics.putMetric("MaturityRatingShow"):Pt.metrics.putMetric("MaturityRatingHide"),null!=this.metricsReportingFeature&&this.metricsReportingFeature.reportInterface(e?"Show":"Hide","Player",{_type:"MaturityRating",maturityRating:t.rating}))},e.prototype.fetchMaturityRating=function(e,t){var i=this;return this.fetchBorgMaturityRating(e,t,"/dv-web-players/maturityRating/MaturityRating.v2.js").then(function(e){var t=e.result.data,n=i.processRatingText(t.amazonMaturityRating,t.regulatoryRating),r=null;return null!=n&&null!=t.contentDescriptors&&(r=t.contentDescriptors.join(", ")),{description:r,rating:n,ratingImageSrc:null}})},e.prototype.fetchBorgMaturityRating=function(e,t,n){var i=this,o={decorationScheme:"web-player",transformPath:n,pageId:e,entityId:t};return new Fe.Promise(function(n,r){i.borgClient.invokeBorgTransform(o,function(e,t){Pt.metrics.putMetric("BorgMaturityRatingTime",t),a.info("MaturityRating Response:",JSON.stringify(e)),n({result:e,latencyMs:t})},function(e,t){a.warn("An error occurred during MaturityRating request:",e.message),Pt.metrics.putMetric("BorgMaturityRatingError"),r(e)})})},e.prototype.processRatingText=function(e,t){return null==t||F.contains(n,t)?e:t},e}();t.MaturityRatingStore=r});e(zP);zP.MaturityRatingStore;var qP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("ModalStore"),n=[xP.Modal.ContentWarning,xP.Modal.PIN,xP.Modal.PlayerStuck],r=function(){function e(e,t,n,r,i,o,a,s){void 0===s&&(s=new Dt.MulticastCallback);var l=this;this.disclaimerText=null,this.lock=null,this.modalInfo=null,this.modalQueue=[],this.pauseEnabled=!0,this.wasMutedBeforeBlockingModal=!1,this.wasPlaying=!1,this.onCloseModal=function(){null!=l.modalInfo&&l.modalInfo.isPrePlayback&&(l.focusUiParent(),l.captionsStore.show()),l.unmuteAudioIfMutedOnBlockingModal(),l.captionsStore.onCloseModal();var e=l.modalInfo;l.closeModal(e,!1),l.tryShowNextModal(e)},this.onContentStateChange=function(e){e===Gd.ContentState.Unloaded&&(l.wasPlaying=!1)},this.onPlaybackStateChange=function(e){e===Gd.PlaybackState.Playing?l.onPlaying():l.onPaused()},this.onPlaying=function(){l.isModalShowing()||(l.wasPlaying=!0)},this.onPaused=function(){l.isModalShowing()||(l.wasPlaying=!1)},this.onPlaybackControlsPolicyChange=function(e){l.pauseEnabled=e.pauseEnabled},this.onTitleInfoUpdate=function(e){null!=e.disclaimerText&&e.disclaimerText!==l.disclaimerText&&l.showModal(xP.Modal.Disclaimer,!0),l.disclaimerText=null!=e.disclaimerText?e.disclaimerText:null},this.lockStore=t,this.playbackControlsPolicyStore=n,this.playbackStore=r,this.player=e,this.titleInfoStore=i,this.uiConfigurationsStore=o,this.requestedPlayerFeature=a,this.multicastCallback=s}return e.prototype.initialize=function(e,t){this.focusUiParent=t,this.captionsStore=e,this.wasPlaying=!1,this.bindEvents()},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.unbindEvents(),this.lock=null},e.prototype.onUpdate=function(e){this.multicastCallback.add(e)},e.prototype.offUpdate=function(e){this.multicastCallback.remove(e)},e.prototype.resetWasPlaying=function(){this.wasPlaying=!1},e.prototype.showModal=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!1),this.requestedPlayerFeature!==ct.WebPlayerSDKFeatures.GCastPlayer){var r={modal:e,isPrePlayback:t};n&&this.isModalShowing()?(this.modalQueue.unshift(r,this.modalInfo),this.onCloseModal()):(this.modalQueue.push(r),this.tryShowNextModal())}},e.prototype.isBlockingModalShowing=function(e){return void 0===e&&(e=this.modalInfo),null!==e&&F.contains(n,e.modal)},e.prototype.isModalInQueue=function(t){return this.modalQueue.some(function(e){return e.modal===t})},e.prototype.isModalShowing=function(e){return void 0===e&&(e=this.modalInfo),null!==e},e.prototype.getModalInfo=function(){return this.modalInfo},e.prototype.onClosePlayer=function(){this.unmuteAudioIfMutedOnBlockingModal(),this.modalQueue=[],this.closeModal(null,!1)},e.prototype.closeModal=function(e,t){if(void 0===t&&(t=!0),null!=this.lock){var n=!1;null!=this.modalInfo&&(i.info("Closing modal: "+xP.Modal[this.modalInfo.modal]),n=!(this.modalInfo=null));var r=null!=e&&e.isPrePlayback;(this.wasPlaying||r)&&t&&(this.lock.unlock(),this.playbackStore.play()),n&&this.onModalInfoChanged()}else i.warn("ModalStore is not initialized, this.lock is undefined")},e.prototype.tryShowNextModal=function(e){if(void 0===e&&(e=null),!this.isModalShowing()){var t=this.modalQueue.shift();if(null!=t){var n=this.isModalShowing(e);!this.wasPlaying&&!t.isPrePlayback||n||(this.wasMutedBeforeBlockingModal=this.playbackStore.muted,this.pauseEnabled?this.playbackStore.pause():this.isBlockingModalShowing(t)&&!this.wasMutedBeforeBlockingModal&&(this.playbackStore.muted=!0)),this.uiConfigurationsStore.getUIConfigurations().closePlayerOnBlockingModal&&this.isBlockingModalShowing(t)?this.player.closePlayer():(i.info("Showing modal: "+xP.Modal[t.modal]),(this.modalInfo=t).isPrePlayback&&this.captionsStore.hide(),this.onModalInfoChanged())}else this.closeModal(e)}},e.prototype.unmuteAudioIfMutedOnBlockingModal=function(){this.isBlockingModalShowing()&&!this.wasMutedBeforeBlockingModal&&(this.playbackStore.muted=!1)},e.prototype.bindEvents=function(){this.lock=this.lockStore.newLock(),this.playbackStore.onPlaybackStateChange(this.onPlaybackStateChange),this.playbackStore.onContentStateChange(this.onContentStateChange),this.playbackControlsPolicyStore.onPolicyChange(this.onPlaybackControlsPolicyChange),this.titleInfoStore.onUpdate(this.onTitleInfoUpdate)},e.prototype.unbindEvents=function(){null!=this.lock&&this.lockStore.deleteLock(this.lock),this.playbackStore.offPlaybackStateChange(this.onPlaybackStateChange),this.playbackStore.offContentStateChange(this.onContentStateChange),this.playbackControlsPolicyStore.offPolicyChange(this.onPlaybackControlsPolicyChange),this.titleInfoStore.offUpdate(this.onTitleInfoUpdate)},e.prototype.onModalInfoChanged=function(){this.multicastCallback.invoke(this.getModalInfo())},e}();t.ModalStore=r});e(qP);qP.ModalStore;var WP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={shouldShowNextUpCarousel:!1,nextUpAutoplayShowing:!1,nextUpItems:null},r=function(){function e(){this.nextUpInfo=F.clone(n),this.multicastCallback=new Dt.MulticastCallback}return e.prototype.initialize=function(){this.updateNextUpCarouselDisplayStatus(!1),this.updateNextUpAutoplayStatus(!1)},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.clearNextUpInfo()},e.prototype.getNextUpInfo=function(){return this.nextUpInfo},e.prototype.onUpdate=function(e){this.multicastCallback.add(e)},e.prototype.offUpdate=function(e){this.multicastCallback.remove(e)},e.prototype.updateNextUpItems=function(e){this.nextUpInfo.nextUpItems=e.filter(function(e){return e.isPlayable}),this.onNextUpInfoChanged()},e.prototype.clearNextUpInfo=function(){this.nextUpInfo=F.clone(n),this.onNextUpInfoChanged()},e.prototype.updateNextUpCarouselDisplayStatus=function(e){this.nextUpInfo.shouldShowNextUpCarousel=e,this.onNextUpInfoChanged()},e.prototype.updateNextUpAutoplayStatus=function(e){this.nextUpInfo.nextUpAutoplayShowing=e,this.onNextUpInfoChanged()},e.prototype.onNextUpInfoChanged=function(){this.multicastCallback.invoke(this.nextUpInfo)},e}();t.NextUpInfoStore=r});e(WP);WP.NextUpInfoStore;var HP=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Autoplay=0]="Autoplay",r[r.Button=1]="Button",r[r.Card=2]="Card",r[r.Carousel=3]="Carousel",t.NextTitleTransition=n});e(HP);HP.NextTitleTransition;var GP=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).Playable="PLAYABLE",r.Purchase="PURCHASE",r.Unknown="UNKNOWN",t.TitleAction=n});e(GP);GP.TitleAction;var KP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("NextTitleController"),l="BorgContinuousPlayTime",f={autoplayShowing:!1,autoplayTimerMs:null,canAutoplay:!0,isInSameSeries:!0,showAutoplayCard:!0,preferredImageName:null},r=function(){function e(e,t,n,r,i,o,a,s,l,u,c,d){void 0===s&&(s=null),void 0===c&&(c=!1),void 0===d&&(d=new Ce.LocalStorage);var p=this;this.clickstreamReporter=null,this.autoplayInfo=F.clone(f),this.autoplayStateReported=!1,this.cardIsHidden=!1,this.currentTitleId=null,this.currentPositionMs=null,this.endPositionMs=null,this.metricsReportingFeature=null,this.shouldAbortAutoplay=!1,this.outroCreditsStartMs=null,this.transitionTimeMs=null,this.userSeeked=!1,this.clickstreamRefMarker=null,this.convertToTitleInfo=function(e){return{asin:e.id,contentTitle:e.title,episodeImageUrl:e.episodeWideImageUrl,seasonImageUrl:e.titleWideImageUrl,hasCaptions:e.hasCaptions,regulatoryRating:e.regulatoryRating,isPlayable:e.titleAction===GP.TitleAction.Playable,isPrime:e.isPrime,episodeNumber:e.episodeNumber,seasonNumber:e.seasonNumber,seriesTitle:e.seriesTitle,isInSameSeries:e.isInSameSeries,preferredImage:e.preferredImage}},this.onTitleInfoUpdate=function(e){null!=e.nextTitle&&p.updateAutoplayModelFromNextTitle(e.nextTitle),p.currentTitleId!==e.titleId&&(p.currentTitleId=e.titleId,p.getNextUpTitles()),p.contentType=e.contentType,null!=e.autoplayTimerMs&&null!=e.outroCreditsStartMs?p.transitionTimeMs=e.outroCreditsStartMs+e.autoplayTimerMs:p.transitionTimeMs=null,null!=e.outroCreditsStartMs&&(p.outroCreditsStartMs=e.outroCreditsStartMs),p.updateAutoplayInfo({autoplayTimerMs:xt.withDefault(e.autoplayTimerMs,p.autoplayInfo.autoplayTimerMs)}),p.updateAutoplayState({autoplayTimerLengthMs:e.autoplayTimerMs,contentType:e.type,endCreditsStartTimecodeMs:e.outroCreditsStartMs})},this.onNextUpAutoplayUpdate=function(){var e=p.nextUpInfoStore.getNextUpInfo().nextUpAutoplayShowing;if(e){var t=Math.round(Math.max(xt.withDefault(p.transitionTimeMs,p.endPositionMs)-p.currentPositionMs,0));p.metricsReportingFeature.reportInterface(e?"Show":"Hide","Player",{_type:"NextUpCard",cardType:p.autoplayState.isInSameSeries?"NextEpisode":"Recommendation",inputOptions:["Hide","Follow"],refMarker:xt.withDefault(p.clickstreamRefMarker,""),timeRemaining:t})}},this.onUserSeek=function(){p.userSeeked=!0},this.onTimelineUpdate=function(e){if(p.contentType!==_P.ContentType.Ad){if(p.endPositionMs=e.endPositionMs,p.updateAutoplayState({titleDurationMs:e.endPositionMs-e.startPositionMs}),null!=p.transitionTimeMs&&p.transitionTimeMs>e.endPositionMs&&(p.transitionTimeMs=null),null==p.transitionTimeMs&&p.autoplayInfo.canAutoplay&&0!==e.endPositionMs&&e.endPositionMs>p.outroCreditsStartMs){var t=null!=p.outroCreditsStartMs?e.endPositionMs-p.outroCreditsStartMs:0;p.transitionTimeMs=e.endPositionMs,p.updateAutoplayInfo({autoplayTimerMs:t})}var n=e.positionMs,r=p.titleInfoStore.getTitleInfo(),i=p.uiConfigurationsStore.getUIConfigurations();p.requestedPlayerFeature!==ct.WebPlayerSDKFeatures.GCastPlayer&&!p.cardIsHidden&&!p.shouldAbortAutoplay&&p.shouldChangeAsin(r)&&!p.userSeeked&&p.currentPositionMs<p.transitionTimeMs&&n>=p.transitionTimeMs&&i.enableNextUp&&A.timer.setImmediate(function(){return p.changeAsin(HP.NextTitleTransition.Autoplay,r.nextTitle.titleId)}),p.currentPositionMs=n,p.userSeeked=!1}},this.player=e,this.nextUpInfoStore=t,this.timelineInfoStore=n,this.titleInfoStore=r,this.uiConfigurationsStore=i,this.marketplaceId=o,this.weblabs=a,this.borgClient=s,this.requestedPlayerFeature=l,this.diagnostics=c,this.storage=d,this.clickstreamReporter=u,this.autoplayInfoMulticastCallback=new Dt.MulticastCallback,this.timelineQuerier=new hP.TimelineQuerier(this.player)}return e.prototype.initialize=function(e){this.metricsReportingFeature=e,this.player.on("Seek",this.onUserSeek),this.nextUpInfoStore.onUpdate(this.onNextUpAutoplayUpdate),this.timelineInfoStore.onUpdate(this.onTimelineUpdate),this.titleInfoStore.onUpdate(this.onTitleInfoUpdate),null==this.storage.get(SP.StorageKeys.AutoplayEnabled)&&this.storage.set(SP.StorageKeys.AutoplayEnabled,""+!0),null==this.storage.get(SP.StorageKeys.ShowAutoplayCard)&&this.storage.set(SP.StorageKeys.ShowAutoplayCard,""+!0),this.autoplayEnabled="true"===this.storage.get(SP.StorageKeys.AutoplayEnabled),this.maxContinuousPlayEpisodes=5,this.showAutoplayCard="true"===this.storage.get(SP.StorageKeys.ShowAutoplayCard),this.autoplayStateReported=!1,this.updateAutoplayState({autoplayCapCounter:0,titleCounter:0,isInSameSeries:null},!0),this.autoplayInfo=F.clone(f)},e.prototype.destroy=function(){this.metricsReportingFeature=null,this.player.off("Seek",this.onUserSeek),this.autoplayInfoMulticastCallback.removeAll(),this.nextUpInfoStore.offUpdate(this.onNextUpAutoplayUpdate),this.timelineInfoStore.offUpdate(this.onTimelineUpdate),this.titleInfoStore.offUpdate(this.onTitleInfoUpdate),this.autoplayInfo=F.clone(f)},e.prototype.onAutoplayInfoChange=function(e){this.autoplayInfoMulticastCallback.add(e)},e.prototype.offAutoplayInfoChange=function(e){this.autoplayInfoMulticastCallback.remove(e)},e.prototype.getAutoplayInfo=function(){return this.autoplayInfo},e.prototype.nextTitleInitiated=function(e,t){void 0===t&&(t=null),e===HP.NextTitleTransition.Button?(this.metricsReportingFeature.reportInteraction("Player","Next","MouseClick"),null!=this.clickstreamReporter&&this.clickstreamReporter.setRefMarker(St.RefMarker[St.RefMarker.plr_nxt_ep])):e!==HP.NextTitleTransition.Card&&e!==HP.NextTitleTransition.Carousel||this.reportContinuousPlayInteraction(),this.resetAutoplayCounter(),this.changeAsin(e,t)},e.prototype.setClickstreamRefMarker=function(e){this.clickstreamRefMarker=e},e.prototype.resetAutoplayCounter=function(){this.updateAutoplayState({autoplayCapCounter:0})},e.prototype.nextUpHidden=function(e){this.cardIsHidden=e,this.cardIsHidden&&this.metricsReportingFeature.reportInteraction("ContinuousPlay","Navigation","MouseClick",{_type:"ContinuousPlay",input:"Hide",refMarker:xt.withDefault(this.clickstreamRefMarker,"")},null,null,"Customer")},e.prototype.abortAutoplay=function(){this.shouldAbortAutoplay=!0},e.prototype.getNextUpTitles=function(){this.weblabs[Y.Weblabs.HTML5_CAROUSEL]===Y.WeblabTreatment.T1&&this.callBorgClient()},e.prototype.updateAutoplayModelFromNextTitle=function(e){var t=e.autoplaySettings;if(null!=t){this.autoplayEnabled=t.autoplayEnabled,this.showAutoplayCard=t.showAutoplayCard,this.nextUpInfoStore.updateNextUpItems([e]);var n=xt.withDefault(t.inSameSeries,!0);this.storage.get(SP.StorageKeys.AutoplayEnabled)!==""+t.autoplayEnabled&&this.storage.set(SP.StorageKeys.AutoplayEnabled,""+t.autoplayEnabled),this.storage.get(SP.StorageKeys.ShowAutoplayCard)!==""+t.showAutoplayCard&&this.storage.set(SP.StorageKeys.ShowAutoplayCard,""+t.showAutoplayCard),this.updateAutoplayInfo({canAutoplay:this.canAutoplay(),showAutoplayCard:this.showAutoplayCard,isInSameSeries:n,preferredImageName:t.autoplayCardPreferredImage}),this.updateAutoplayState({autoplayCap:this.maxContinuousPlayEpisodes,serverAutoplaySetting:this.autoplayEnabled,isInSameSeries:n})}},e.prototype.updateAutoplayModelFromBorg=function(e){var t=xt.nestedValue(e,"collections.0.continuousPlayItemList.0"),n=xt.nestedValue(e,"collections.0.autoplayConfig"),r=null!=n,i=r?n.numTitlesToAutoplay:null;r&&(this.storage.set(SP.StorageKeys.AutoplayEnabled,""+n.autoplayEnabled),this.storage.set(SP.StorageKeys.ShowAutoplayCard,""+n.showAutoplayCard)),this.autoplayEnabled=r?n.autoplayEnabled:"true"===this.storage.get(SP.StorageKeys.AutoplayEnabled),this.showAutoplayCard=r?n.showAutoplayCard:"true"===this.storage.get(SP.StorageKeys.ShowAutoplayCard),this.maxContinuousPlayEpisodes=xt.withDefault(i,5),this.updateAutoplayInfo({canAutoplay:this.canAutoplay(),showAutoplayCard:this.showAutoplayCard,isInSameSeries:!r||t.isInSameSeries,preferredImageName:r?t.preferredImage:null}),this.updateAutoplayState({autoplayCap:this.maxContinuousPlayEpisodes,serverAutoplaySetting:this.autoplayEnabled,isInSameSeries:!r||t.isInSameSeries})},e.prototype.callBorgClient=function(){var s=this;if(null!==this.borgClient){var e={transformPath:"/dv-web-players/continuousPlay/continuousPlay.v2.js",pageId:this.titleInfoStore.getTitleInfo().titleId,decorationScheme:"player-carousel",presentationScheme:"borg-web-playback-carousel"};this.borgClient.invokeBorgTransform(e,function(e,t){if(Pt.metrics.putMetric(l,t),s.updateAutoplayModelFromBorg(e),null!=e){for(var n=[],r=0,i=e.collections;r<i.length;r++){var o=i[r];n=n.concat(o.continuousPlayItemList)}var a=n.map(function(e){return s.convertToTitleInfo(e)});s.nextUpInfoStore.updateNextUpItems(a)}},function(e,t){Pt.metrics.putMetric("BorgContinuousPlayError"),null!=t&&Pt.metrics.putMetric(l,t),s.updateAutoplayModelFromBorg()})}else n.warn("Attempted to get next title when borgClient does not exist.")},e.prototype.canAutoplay=function(){return(this.autoplayState.autoplayCapCounter<this.maxContinuousPlayEpisodes||this.diagnostics)&&this.autoplayEnabled},e.prototype.shouldChangeAsin=function(e){return null!=e.nextTitle&&e.nextTitle.isPlayable&&this.showAutoplayCard&&this.canAutoplay()},e.prototype.changeAsin=function(e,t){if(void 0===t&&(t=null),this.reportContinuousPlayInteraction(),this.updateAutoplayState({autoplayCapCounter:e===HP.NextTitleTransition.Autoplay?this.autoplayState.autoplayCapCounter+1:0,titleCounter:this.autoplayState.titleCounter+1,isInSameSeries:null},!0),this.autoplayStateReported=!1,this.nextUpInfoStore.clearNextUpInfo(),this.autoplayInfo=F.clone(f),null===t){var n=this.timelineQuerier.getItemForNextMainContentTitle(this.player.currentTime.currentTimelineItemIndex);null!==n&&(this.player.seek(0,n.timelineItemIndex),this.player.playbackState===Gd.PlaybackState.Paused&&this.player.play())}else this.player.start({titleId:t,videoMaterialType:"Feature"})},e.prototype.reportContinuousPlayInteraction=function(){this.metricsReportingFeature.reportInteraction("ContinuousPlay","Navigation","MouseClick",{_type:"ContinuousPlay",input:"Follow",refMarker:xt.withDefault(this.clickstreamRefMarker,"")},null,null,"Customer")},e.prototype.updateAutoplayInfo=function(e){F.extend(this.autoplayInfo,e),this.autoplayInfoMulticastCallback.invoke(this.autoplayInfo)},e.prototype.updateAutoplayState=function(e,t){void 0===t&&(t=!1),t?this.autoplayState=e:F.extend(this.autoplayState,e)},e}();t.NextTitleStore=r});e(KP);KP.NextTitleStore;var QP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Vn.createContext({});t.ReactContext=n});e(QP);QP.ReactContext;var YP=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({$nest:{"& > div":qS.ScaleNestedProperty("margin-bottom",10)}}),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onDontShowAgain=function(){e.context.stores.networkState.dontShowNetworkNotification(e.props.notification)},e}return n(e,t),e.prototype.render=function(){var e=this.context.stores.localization.getLocalization();return Vn.createElement("span",{className:i},Vn.createElement("div",null,e.InternetConnectionError),Vn.createElement("a",{onClick:this.onDontShowAgain},e.dontShowAgainShort))},e.contextType=QP.ReactContext,e}(Vn.Component);t.NetworkIssueNotification=o});e(YP);YP.NetworkIssueNotification;var JP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){void 0===t&&(t=5),void 0===n&&(n=!0),void 0===r&&(r=!1),this.contents=e,this.displayTimeSeconds=t,this.closable=n,this.showDuplicates=r,this.id=F.uniqueId()}return e.prototype.setContents=function(e){this.contents=e},e.prototype.getContents=function(){return this.contents},e.prototype.getDisplayTimeSeconds=function(){return this.displayTimeSeconds},e.prototype.isClosable=function(){return this.closable},e.prototype.shouldShowDuplicates=function(){return this.showDuplicates},e.prototype.getID=function(){return this.id},e}();t.Notification=n});e(JP);JP.Notification;var $P=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Buffering=0]="Buffering",r[r.Error=1]="Error",r[r.Loading=2]="Loading",r[r.Paused=3]="Paused",r[r.Playing=4]="Playing",r[r.Stopped=5]="Stopped",t.UIPlaybackState=n});e($P);$P.UIPlaybackState;var ZP=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("NetworkStateStore"),n=function(){function e(e,t){var n=this;this.hasNetworkIssue=!1,this.networkStatusTimer=null,this.dontShowMessage=!1,this.onUiStatusUpdate=function(e){e.state===$P.UIPlaybackState.Buffering?n.hasNetworkIssue||n.onBuffering():n.onBufferingFinished()},this.onNetworkTimerTimeout=function(){n.hasNetworkIssue=!0;var e=new JP.Notification("",10);e.setContents(Vn.createElement(YP.NetworkIssueNotification,{notification:e})),n.networkStatusTimer=null,n.notificationsStore.addNotification(e),n.eventEmitter.emit("NetworkIssue")},this.onBufferingFinished=function(){n.hasNetworkIssue&&(r.info("Network state had recovered."),n.eventEmitter.emit("NetworkIssueRecovered"),n.hasNetworkIssue=!1),clearTimeout(n.networkStatusTimer),n.networkStatusTimer=null},this.onBuffering=function(){n.dontShowMessage||(clearTimeout(n.networkStatusTimer),n.networkStatusTimer=A.timer.setTimeout(n.onNetworkTimerTimeout,3e4))},this.uiStatusStore=e,this.notificationsStore=t,this.eventEmitter=new Dt.EventEmitter}return e.prototype.initialize=function(){this.uiStatusStore.onUpdate(this.onUiStatusUpdate)},e.prototype.destroy=function(){this.eventEmitter.removeAllListeners(),this.uiStatusStore.offUpdate(this.onUiStatusUpdate)},e.prototype.disable=function(){this.uiStatusStore.offUpdate(this.onUiStatusUpdate),this.onBufferingFinished()},e.prototype.enable=function(e){void 0===e&&(e=!1),this.uiStatusStore.onUpdate(this.onUiStatusUpdate),e&&this.onBuffering()},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.dontShowNetworkNotification=function(e){this.dontShowMessage=!0,this.notificationsStore.cancelNotification(e)},e}();t.NetworkStateStore=n});e(ZP);ZP.NetworkStateStore;var ew=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.initialize=function(e,t,n){void 0===n&&(n=1),this.onShowNotification=e,this.onCloseNotification=t,this.maxNotificationsAtOnce=n,this.currentNotifications=[],this.queuedNotifications=[]},e.prototype.unload=function(){this.currentNotifications=[],this.queuedNotifications=[]},e.prototype.addNotification=function(e,t){void 0===t&&(t=!0),this.queuedNotifications.push(e),t&&this.runNotification()},e.prototype.hasQueuedNotifications=function(){return 0!==this.queuedNotifications.length},e.prototype.showQueuedNotifications=function(){this.runNotification()},e.prototype.cancelNotification=function(n){var r=this;F.some(this.currentNotifications,function(e){if(e.notification===n)return r.closeNotification(n),!0})||F.some(this.queuedNotifications,function(e,t){if(e===n)return r.queuedNotifications.splice(t,1),!0})},e.prototype.closeNotification=function(t){F.some(this.currentNotifications,function(e){if(e.notification===t&&!xt.isNullOrUndefined(e.timeoutID))return clearTimeout(e.timeoutID),!0}),this.runNextNotification(t)},e.prototype.runNotification=function(){var e=this;if(this.currentNotifications.length!==this.maxNotificationsAtOnce){var t={notification:this.queuedNotifications.shift()};xt.isNullOrUndefined(t.notification)||(this.currentNotifications.push(t),this.onShowNotification(t.notification),xt.exists(t.notification.getDisplayTimeSeconds())&&(t.timeoutID=A.timer.setTimeout(function(){e.runNextNotification(t.notification)},1e3*t.notification.getDisplayTimeSeconds())))}},e.prototype.runNextNotification=function(n){var r=this;this.onCloseNotification(n),F.some(this.currentNotifications,function(e,t){if(e.notification===n)return r.currentNotifications.splice(t,1),!0}),0<this.queuedNotifications.length&&this.runNotification()},e}();t.NotificationManager=n});e(ew);ew.NotificationManager;var tw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationManager=ew.NotificationManager});e(tw);tw.NotificationManager;var nw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var r=this;this.onShowNotification=function(e){r.notifications.unshift(e),r.multicastCallback.invoke(r.notifications)},this.onCloseNotification=function(n){r.notifications.some(function(e,t){return e===n&&(r.notifications.splice(t,1),!0)}),r.multicastCallback.invoke(r.notifications)},this.multicastCallback=new Dt.MulticastCallback,this.notificationManager=new tw.NotificationManager}return e.prototype.initialize=function(){this.notifications=[],this.notificationManager.initialize(this.onShowNotification,this.onCloseNotification,2)},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.notifications=[]},e.prototype.getNotifications=function(){return this.notifications},e.prototype.addNotification=function(t){var e=this.notifications.some(function(e){return e.getContents()===t.getContents()});!t.shouldShowDuplicates()&&e||this.notificationManager.addNotification(t)},e.prototype.cancelNotification=function(e){this.notificationManager.cancelNotification(e)},e.prototype.onNotifications=function(e){this.multicastCallback.add(e)},e.prototype.offNotifications=function(e){this.multicastCallback.remove(e)},e}();t.NotificationsStore=n});e(nw);nw.NotificationsStore;var rw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("PassiveViewingStore"),r=function(){function e(e,t,n){var r=this;this.passiveViewingEnabled=!1,this.volumeFeature=null,this.onVolumeChange=function(){var e=r.volumeFeature.volume;0===r.volume&&0<e&&(r.volumeFeature.offChange(r.onVolumeChange),r.disablePassiveViewing()),r.volume=e},this.player=e,this.clientId=t,this.volume=n,this.multicastCallback=new Dt.MulticastCallback,"511cc9af-3ecb-48fe-9825-886ebfbb6503"===this.clientId&&0===this.volume&&this.enablePassiveViewing()}return e.prototype.initialize=function(){var t=this;this.isPassiveViewingEnabled()&&this.player.getFeature(this.player.Features.Volume).then(function(e){t.volumeFeature=e,t.volumeFeature.onChange(t.onVolumeChange)}).catch(function(e){n.error("An error occurred while trying to acquire the VolumeFeature: "+e)})},e.prototype.destroy=function(){this.multicastCallback.removeAll(),null!==this.volumeFeature&&this.volumeFeature.offChange(this.onVolumeChange),this.volumeFeature=null,this.volume=null,this.passiveViewingEnabled=!1},e.prototype.onChange=function(e){this.multicastCallback.add(e)},e.prototype.offChange=function(e){this.multicastCallback.remove(e)},e.prototype.isPassiveViewingEnabled=function(){return this.passiveViewingEnabled},e.prototype.enablePassiveViewing=function(){n.info("Enabling passive viewing."),this.passiveViewingEnabled=!0,this.updatePassiveViewing(!1)},e.prototype.disablePassiveViewing=function(){n.info("Disabling passive viewing."),this.passiveViewingEnabled=!1,this.updatePassiveViewing()},e.prototype.updatePassiveViewing=function(e){void 0===e&&(e=!0),e&&this.multicastCallback.invoke(this.passiveViewingEnabled)},e}();t.PassiveViewingStore=r});e(rw);rw.PassiveViewingStore;var iw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("PictureInPictureStore"),n=function(){function e(e,t){var n=this;this.enterPictureInPicture=function(){n.pictureInPictureFeature.requestPictureInPicture().then(function(){Pt.metrics.putMetric("PictureInPictureEnter")}).catch(function(e){r.error(e,"Picture-in-Picture failed to enter"),Pt.metrics.putMetric("PictureInPictureEnterError")})},this.exitPictureInPicture=function(){n.pictureInPictureFeature.exitPictureInPicture().then(function(){Pt.metrics.putMetric("PictureInPictureClose")}).catch(function(e){r.error(e,"Picture-in-Picture failed to exit"),Pt.metrics.putMetric("PictureInPictureCloseError")})},this.onPictureInPictureChangeEvent=function(){var e=n.isPictureInPicture();if(n.multicastCallback.invoke(e),null!=n.config.metricsReportingFeature){var t=e?"PictureInPicture":"Embedded";n.config.metricsReportingFeature.setDisplayMode(t)}},this.config=t,this.player=e,this.multicastCallback=new Dt.MulticastCallback}return e.prototype.initialize=function(){var t=this;this.config.weblabs[ct.Weblabs.HTML5_PICTUREINPICTURE]===Y.WeblabTreatment.T1&&this.player.getFeature(this.player.Features.PictureInPicture).then(function(e){t.pictureInPictureFeature=e,t.addPictureInPictureListener(t.onPictureInPictureChangeEvent)}).catch(function(e){r.warn(e)})},e.prototype.destroy=function(){this.removePictureInPictureListener(this.onPictureInPictureChangeEvent)},e.prototype.togglePictureInPicture=function(){this.pictureInPictureFeature.isPictureInPicture()?this.exitPictureInPicture():this.enterPictureInPicture()},e.prototype.onChange=function(e){this.multicastCallback.add(e)},e.prototype.offChange=function(e){this.multicastCallback.remove(e)},e.prototype.isPictureInPicture=function(){return null!=this.pictureInPictureFeature&&this.pictureInPictureFeature.isPictureInPicture()},e.prototype.isSupported=function(){return null!=this.pictureInPictureFeature&&(this.pictureInPictureFeature.isSupported()&&Xh.getBrowser().getType()!==Xh.BrowserType.Safari&&this.config.weblabs[ct.Weblabs.HTML5_PICTUREINPICTURE]===Y.WeblabTreatment.T1)},e.prototype.onClosePlayer=function(){null!=this.pictureInPictureFeature&&this.pictureInPictureFeature.isPictureInPicture()&&this.exitPictureInPicture()},e.prototype.addPictureInPictureListener=function(e){null!=this.pictureInPictureFeature&&this.pictureInPictureFeature.onChange(e)},e.prototype.removePictureInPictureListener=function(e){null!=this.pictureInPictureFeature&&this.pictureInPictureFeature.offChange(e)},e}();t.PictureInPictureStore=n});e(iw);iw.PictureInPictureStore;var ow=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("PinClient"),u=[400,401,403],c=["CDP.Authorization","CDP.InvalidRequest.MissingRequiredParameter"],d="ValidatePinError",n=function(){function e(e,t){void 0===e&&(e=ze.HttpRequest),void 0===t&&(t=Op.ExponentialBackoffRetry),this.authContext=null,this.deviceId=null,this.deviceTypeId=null,this.isInitialized=!1,this.marketplaceId=null,this.url=null,this.httpRequest=e,this.retry=t}return e.prototype.initialize=function(e,t,n,r,i){void 0===i&&(i=null),this.deviceId=t,this.deviceTypeId=n,this.marketplaceId=r,this.authContext=xt.withDefault(i,this.authContext),this.url=e.replace(/\/$/,"")+"/cdp/link/ValidatePin",this.isInitialized=!0},e.prototype.validatePIN=function(i,t,n){var o=this;this.isInitialized?(new this.retry).withMaxAttempts(4).withInitialIntervalMs(500).withExponentialFactor(2).withRandomizationFactor(200).onSuccess(function(e){t(e)}).onError(function(e){n(e)}).onAttempt(function(e,t,n,r){o.sendRequest(i,e,t,n,r)}).execute():l.error("validatePin called before PINClient is initialized")},e.prototype.setAuthContext=function(e){this.authContext=e},e.prototype.sendRequest=function(e,t,r,n,i){var o=this;if(null!=this.deviceId&&null!=this.deviceTypeId&&null!=this.marketplaceId&&null!=this.url){var a={deviceID:this.deviceId,deviceTypeID:this.deviceTypeId,gascEnabled:!Y.MarketplaceID.isClassic(this.marketplaceId),marketplaceId:this.marketplaceId,pin:e,firmware:"1",version:"1"},s=this.httpRequest.get(this.url).headers({Accept:"application/json","x-retry-count":""+t,"x-request-priority":"CRITICAL"}).withCredentials().timeout(4e3).onLoad(function(e){o.processResponse(e.getText(),r,n,i)}).onError(function(e,t){var n="An error occurred while sending ValidatePin request: "+e;e=Ne.Errors.newError(d,n,e),xt.isNullOrUndefined(t)||!F.contains(u,t.getStatus())?r(e):i(e)});null!==this.authContext&&(s=s.headers(this.authContext.headers)),s.query(a).send()}else l.error(">> sendRequest, Must call initialize before calling sendRequest.")},e.prototype.processResponse=function(e,t,n,r){var i;try{i=JSON.parse(e)}catch(e){var o="An error occurred while parsing the ValidatePin JSON response: "+e;return void t(Ne.Errors.newError(d,o,e))}if("ERROR"!==xt.nestedValue(i,"message.statusCode")){var a=xt.nestedValue(i,"message.body");null!==a?n(a):t(Ne.Errors.newError(d,"ValidatePin response does not contain 'body'"))}else{var s=xt.nestedValue(i,"message.body.code",""),l=Ne.Errors.newError(d,"ValidatePin response has statusCode 'ERROR' and code '"+s+"'");F.contains(c,s)?r(l):t(l)}},e}();t.PINClient=n});e(ow);ow.PINClient;var aw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PINClient=ow.PINClient});e(aw);aw.PINClient;var sw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){var u=this;this.route=null,this.responseProcessor=function(e,t,n,r){var i=e.getText();if(null!==i){var o;try{o=JSON.parse(i)}catch(e){return void n(new Ne.XpError("parse",void 0,e.message,!1,e))}if("ERROR"!==xt.nestedValue(o,"message.statusCode")){var a=["customerConfig","deviceConfig","territoryConfig"].filter(function(e){return null==o[e]});0===a.length?t({baseUrl:u.createDeviceProxyUrl(o.customerConfig.baseUrl),marketplaceId:u.extractMarketplaceId(o),deviceConfig:o.deviceConfig.additionalConfig}):r(new Ne.XpError("invalid_response",void 0,"Missing required fields in response: "+a.join()+".",!0))}else{var s=xt.nestedValue(o,"message.body.code",""),l=xt.nestedValue(o,"message.body.message","");r(new Ne.XpError("error_status",void 0,"statusCode='ERROR', code='"+s+"', message='"+l+"'"))}}else n(new Ne.XpError("null_response"))},null!=r&&(this.route=r);var i=Yh.deviceCapabilities,o={deviceID:e,deviceTypeID:t,gascEnabled:null==i.gascEnabled||i.gascEnabled},a=Yh.deviceInformation.hardware.zipcode;null!=a&&(o["comcast-zipcode"]=a);var s=new Qp.ServiceClientFactory(this.createDeviceProxyUrl("api.amazonvideo.com"),o,n);this.disServiceClient=s.createServiceClient("/cdp/usage/GetAppStartupConfig",{firmware:"1",version:"1",format:"json"},this.responseProcessor,"dis")}return e.prototype.send=function(e){var t={timeoutMs:8e3};return this.disServiceClient.send(t,e,"CRITICAL")},e.prototype.createDeviceProxyUrl=function(e){return null!=Yh.deviceCapabilities.deviceProxyUrl?Yh.deviceCapabilities.deviceProxyUrl:null!=this.route?"https://"+this.route+"."+e:"https://"+this.createAffinityUrl()+"."+e},e.prototype.createAffinityUrl=function(){var e=Yh.deviceInformation.software,t=e.operatingSystem,n=e.middleware,r=["xp"];if(F.isEmpty(t.name)||r.push(t.name),null!=n){F.isEmpty(n.name)||r.push(n.name);var i=n.version.replace(/\./g,"-");F.isEmpty(i)||r.push(i)}return r.join("-").replace(/[^\w\-]/gi,"")},e.prototype.extractMarketplaceId=function(e){return null!=Yh.deviceCapabilities.marketplaceId?Yh.deviceCapabilities.marketplaceId:e.customerConfig.marketplaceId},e}();t.DeviceInitializationServiceClient=n});e(sw);sw.DeviceInitializationServiceClient;var lw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function t(){}return t.isClassic=function(e){switch(e){case t.DE:case t.JP:case t.UK:case t.US:return!0}return!1},t.ROE_EU="A3K6Y4MI8GDYMT",t.ROW_EU="A2MFUE2XK8ZSSY",t.ROW_FE="A15PK738MTQHSO",t.ROW_NA="ART4WZ8MWBX2Y",t.DE="A1PA6795UKMFR9",t.JP="A1VC38T7YXB528",t.UK="A1F83G8C2ARO7P",t.US="ATVPDKIKX0DER",t}();t.MarketplaceID=n});e(lw);lw.MarketplaceID;var uw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function r(){}return r.fromMarketplaceId=function(e){var t,n=r.getDomainFromMarketplaceId(e);switch(e){case lw.MarketplaceID.ROW_NA:case lw.MarketplaceID.US:t=r.US_REGION;break;case lw.MarketplaceID.ROE_EU:case lw.MarketplaceID.ROW_EU:case lw.MarketplaceID.UK:case lw.MarketplaceID.DE:t=r.EU_REGION;break;case lw.MarketplaceID.ROW_FE:case lw.MarketplaceID.JP:t=r.JP_REGION;break;default:throw new Error("Can't get PartnerServiceEndpoint for unknown MarketplaceId! Received: "+e)}return r.PROTOCOL+t+n},r.getDomainFromMarketplaceId=function(e){switch(e){case lw.MarketplaceID.ROW_NA:case lw.MarketplaceID.ROE_EU:case lw.MarketplaceID.ROW_EU:case lw.MarketplaceID.ROW_FE:return".primevideo.com";case lw.MarketplaceID.DE:return".amazon.de";case lw.MarketplaceID.JP:return".amazon.co.jp";case lw.MarketplaceID.UK:return".amazon.co.uk";default:return".amazon.com"}},r.EU_REGION="atv-ps-eu",r.JP_REGION="atv-ps-fe",r.US_REGION="atv-ps",r.DOMAIN_REGEX=/.*(\.(amazon|primevideo)\..*)/,r.DEFAULT_DOMAIN=".amazon.com",r.PROTOCOL="https://",r}();t.PartnerServiceEndpoint=n});e(uw);uw.PartnerServiceEndpoint;var cw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceInitializationServiceClient=sw.DeviceInitializationServiceClient,t.MarketplaceID=lw.MarketplaceID,t.PartnerServiceEndpoint=uw.PartnerServiceEndpoint});e(cw);cw.DeviceInitializationServiceClient,cw.MarketplaceID,cw.PartnerServiceEndpoint;var dw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.ErrorCodeTree={web:{pin_protection:{pin_age_verification:"web.pin_protection.pin_age_verification",pin_setup_required:"web.pin_protection.pin_setup_required",pin_validation_error:"web.pin_protection.pin_validation_error"},playback:{session_abandoned:"web.playback.session_abandoned",spinner_timeout_error:"web.playback.spinner_timeout_error"}}}});e(dw);dw.ErrorCodeTree;var pw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("PINStore"),n="ageVerificationRequired",r="pinSetupRequired",i=function(){function e(e,t,n,r,i,o,a,s){var l=this;this.clickstreamReporter=null,this.gCastFeature=null,this.metricsReportingFeature=null,this.alwaysRequirePIN=!1,this.currentTitleId=null,this.marketplaceId=null,this.pinLength=null,this.pinVerified=!1,this.onGCastPINRequiredChange=function(e){l.eventEmitter.emit("PINRequiredChange",e)},this.onTitleInfoUpdate=function(e){var t=l.modalStore.getModalInfo();if(!(null!==l.errorStore.getCurrentError()||null!=t&&t.modal===xP.Modal.PIN||l.modalStore.isModalInQueue(xP.Modal.PIN)||0===l.player.timeline.items.length)){var n=l.player.timeline.items[l.player.currentTime.currentTimelineItemIndex],r=l.timelineQuerier.getMainContentItems(n)[0],i=xt.nestedValue(r,"contentInfo.pinRestrictions"),o=xt.nestedValue(r,"contentInfo.metadata.playback.accessControls"),a=xt.nestedValue(r,"contentInfo.metadata.catalog.regulatoryRating");l.marketplaceId!==cw.MarketplaceID.DE||"18"!==a&&null!==a||(l.pinVerified=!1),null!=e.titleId&&l.currentTitleId!==e.titleId&&(l.resetPINVerified(),l.currentTitleId=e.titleId),null!=o?l.onRestriction(o):null!=i&&l.onRestriction(i),l.marketplaceId===cw.MarketplaceID.US&&("TV-G"===a||"G"===a)||l.marketplaceId===cw.MarketplaceID.DE&&"0"===a||l.marketplaceId===cw.MarketplaceID.UK&&"U"===a||(l.marketplaceId,cw.MarketplaceID.JP)}},this.onPINAccepted=function(){u.info("PIN on playback was accepted."),l.pinVerified=!0,l.closePINModal(),l.eventEmitter.emit("PINAccepted"),null!=l.clickstreamReporter&&l.clickstreamReporter.pinAccepted()},this.onPINDeclined=function(){u.warn("PIN on playback was declined."),l.eventEmitter.emit("PINDeclined"),null!=l.clickstreamReporter&&l.clickstreamReporter.pinDeclined()},this.player=e,this.fullscreenStore=t,this.modalStore=n,this.titleInfoStore=r,this.errorStore=i,this.playbackStore=o,this.isGCastPlayer=a,this.clickstreamReporter=s,this.eventEmitter=new Dt.EventEmitter,this.pinClient=new aw.PINClient,this.timelineQuerier=new hP.TimelineQuerier(this.player)}return e.prototype.initialize=function(e,t,n,r,i,o){var a=this;void 0===o&&(o=null),this.marketplaceId=r,this.metricsReportingFeature=i,this.pinClient.initialize(e,t,n,r,o),this.isGCastPlayer&&this.player.getFeature(this.player.Features.GCast).then(function(e){a.gCastFeature=e,a.gCastFeature.on("PINRequiredChange",a.onGCastPINRequiredChange)}).catch(function(e){u.warn(e)}),this.titleInfoStore.onUpdate(this.onTitleInfoUpdate)},e.prototype.destroy=function(){this.closePINModal(),this.eventEmitter.removeAllListeners(),this.alwaysRequirePIN=null,this.metricsReportingFeature=null,this.pinClient=null,this.pinLength=null,(this.pinVerified=null)!==this.gCastFeature&&this.gCastFeature.off("PINRequiredChange",this.onGCastPINRequiredChange),this.gCastFeature=null,this.titleInfoStore.offUpdate(this.onTitleInfoUpdate)},e.prototype.focus=function(){this.eventEmitter.emit("PINFocus")},e.prototype.validatePIN=function(e){var t=this;u.info("PIN on playback was submitted."),null!=this.clickstreamReporter&&this.clickstreamReporter.pinSubmitted(),this.pinClient.validatePIN(e,function(e){e?t.onPINAccepted():t.onPINDeclined()},function(e){u.error("Error returned by ValidatePin API. error message: "+e.message),t.onPINError(dw.ErrorCodeTree.web.pin_protection.pin_validation_error)})},e.prototype.getPINLength=function(){return this.pinLength},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.setContentType=function(e){this.alwaysRequirePIN=e===_P.ContentType.Live},e.prototype.setAuthContext=function(e){this.pinClient.setAuthContext(e)},e.prototype.onRestriction=function(e){var t=e.restrictions;xt.exists(t)&&this.isPINRequired(t)?this.onPINRequired(e.pinLength,this.isPINSetupRequired(t),this.isAgeVerificationRequired(t)):u.info("No playback restrictions found in the catalog metadata.")},e.prototype.isPINRequired=function(e){return e.some(function(e){return"pinRequired"===e.type||e.type===r||e.type===n})},e.prototype.isPINSetupRequired=function(e){return e.some(function(e){return e.type===r})},e.prototype.isAgeVerificationRequired=function(e){return e.some(function(e){return e.type===n})},e.prototype.onPINRequired=function(e,t,n){this.pinLength=e,t?this.onPINError(dw.ErrorCodeTree.web.pin_protection.pin_setup_required):n?this.onPINError(dw.ErrorCodeTree.web.pin_protection.pin_age_verification):this.pinVerified||(this.eventEmitter.emit("PINLengthChanged",this.pinLength),this.showPinModal())},e.prototype.onPINError=function(e){u.error("An error occurred. errorCode: "+e);var t=new Ne.XpError(e);this.errorStore.showError(tp.ErrorCodeTransformer.transformError(t)),this.playbackStore.pause()},e.prototype.showPinModal=function(){this.modalStore.showModal(xP.Modal.PIN,!0),this.fullscreenStore.fullscreenOff(),null!=this.clickstreamReporter&&this.clickstreamReporter.pinDialogDisplayed()},e.prototype.closePINModal=function(){this.modalStore.onCloseModal()},e.prototype.reportPINDisplay=function(e){},e.prototype.resetPINVerified=function(){this.pinVerified=this.pinVerified&&!this.alwaysRequirePIN},e}();t.PINStore=i});e(pw);pw.PINStore;var fw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("PlaybackStore"),n=function(){function e(e,t,n){var r=this;this.previousVolume=null,this.volumeFeature=null,this.onPlayerSeek=function(e){r.eventEmitter.emit("SeekChange",e)},this.onPlayerVolumeChange=function(){r.eventEmitter.emit("VolumeChange",r.volumeFeature.volume)},this.onPlayerMutedChange=function(){r.eventEmitter.emit("MuteChange",r.volumeFeature.muted)},this.player=e,this.uiConfigurationsStore=t,this.initialVolume=null!=n?n:null,this.eventEmitter=new Dt.EventEmitter,this.seekHelper=new hP.SeekHelper(e),this.storage=new Ce.LocalStorage}return e.prototype.initialize=function(){var t=this;this.player.getFeature(this.player.Features.Volume).then(function(e){t.volumeFeature=e,null===t.initialVolume&&(t.volumeFeature.volume=t.getVolumeFromStorage()),t.volumeFeature.onChange(t.onPlayerMutedChange),t.volumeFeature.onChange(t.onPlayerVolumeChange)}).catch(function(e){i.error("An error occurred while trying to acquire the VolumeFeature.",e)}),this.player.on("Seek",this.onPlayerSeek)},e.prototype.destroy=function(){this.eventEmitter.removeAllListeners(),this.player.off("Seek",this.onPlayerSeek),this.volumeFeature=null},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.onPlaybackStateChange=function(e){this.player.on(Gd.PlayerEvent.PlaybackStateChange,e)},e.prototype.offPlaybackStateChange=function(e){this.player.off(Gd.PlayerEvent.PlaybackStateChange,e)},e.prototype.onContentStateChange=function(e){this.player.on(Gd.PlayerEvent.ContentStateChange,e)},e.prototype.offContentStateChange=function(e){this.player.off(Gd.PlayerEvent.ContentStateChange,e)},e.prototype.pause=function(){this.player.pause()},e.prototype.play=function(){this.player.play()},e.prototype.seek=function(e,t){var n=this.uiConfigurationsStore.getUIConfigurations(),r=this.seekHelper.adjustSeekPosition(e,n.enableNextUp,t);null!=r?this.player.seek(r.positionMs,r.timelineItemIndex):i.warn("Failed to adjust seek position")},e.prototype.getContentState=function(){return this.player.contentState},e.prototype.getPlaybackState=function(){return this.player.playbackState},e.prototype.toggleMute=function(){null!==this.volumeFeature&&(0!==this.volumeFeature.volume?(this.previousVolume=this.volumeFeature.volume,this.volume=0):this.volume=null===this.previousVolume?1:this.previousVolume)},Object.defineProperty(e.prototype,"volume",{get:function(){return null!==this.volumeFeature?this.volumeFeature.volume:this.getVolumeFromStorage()},set:function(e){e=Math.min(Math.max(e,0),1),this.storage.set(SP.StorageKeys.Volume,""+e),null!==this.volumeFeature&&(0!==e&&this.volumeFeature.muted&&(this.volumeFeature.muted=!1),this.volumeFeature.volume=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return null!==this.volumeFeature?this.volumeFeature.muted:this.getMutedFromStorage()},set:function(e){this.storage.set(SP.StorageKeys.Muted,""+e),null!==this.volumeFeature&&(this.volumeFeature.muted=e)},enumerable:!0,configurable:!0}),e.prototype.getVolumeFromStorage=function(){var e=1;try{var t=this.storage.get(SP.StorageKeys.Volume);if(null!=t){var n=parseFloat(t);isNaN(n)||(e=n)}}catch(e){i.error("An error occurred while getting the volume value from local storage: "+e.name+": "+e.message,e)}return e},e.prototype.getMutedFromStorage=function(){var e=!1;try{var t=this.storage.get(SP.StorageKeys.Muted);null!=t&&"true"===t&&(e=!0)}catch(e){i.error("An error occurred while getting the muted value from local storage: "+e.name+": "+e.message,e)}return e},e}();t.PlaybackStore=n});e(fw);fw.PlaybackStore;var hw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o={fastSeekEnabled:!0,pauseEnabled:!0,seekBackwardEnabled:!0,seekForwardEnabled:!0},a={fastSeekEnabled:!1,pauseEnabled:!0,seekBackwardEnabled:!1,seekForwardEnabled:!1},n=function(){function e(e,t,n,r){void 0===r&&(r=new Dt.MulticastCallback);var i=this;this.isPlayingAd=!1,this.previousPolicy=null,this.policy=F.clone(o),this.enableFastSeek=!0,this.enableSeek=!0,this.enablePause=!0,this.onTimelineInfoUpdate=function(e){e.earliestPlayablePositionMs===e.lastPlayablePositionMs&&(i.policy.seekBackwardEnabled||i.policy.seekForwardEnabled)?(i.policy.fastSeekEnabled=!1,i.policy.seekBackwardEnabled=!1,i.policy.seekForwardEnabled=!1,i.policy.pauseEnabled=!1,i.emitPolicyChange()):e.earliestPlayablePositionMs===e.lastPlayablePositionMs||i.policy.seekBackwardEnabled&&i.policy.seekForwardEnabled||i.isPlayingAd||(i.policy.fastSeekEnabled=!0,i.policy.seekBackwardEnabled=!0,i.policy.seekForwardEnabled=!0,i.policy.pauseEnabled=!0,i.emitPolicyChange())},this.onTitleInfoUpdate=function(e){e.contentType===_P.ContentType.Ad?(null===i.previousPolicy&&(i.previousPolicy=i.policy),i.isPlayingAd=!0,i.policy=F.clone(a)):(i.isPlayingAd=!1,null!==i.previousPolicy&&(i.policy=i.previousPolicy,i.previousPolicy=null)),i.emitPolicyChange()},this.onUIConfigurationsChange=function(e){i.enableFastSeek=e.enableFastSeekButtons,i.enablePause=e.enablePause,i.enableSeek=e.enableSeek,i.emitPolicyChange()},this.titleInfoStore=e,this.timelineInfoStore=t,this.multicastCallback=r,this.uiConfigurationsStore=n}return e.prototype.initialize=function(){this.timelineInfoStore.onUpdate(this.onTimelineInfoUpdate),this.titleInfoStore.onUpdate(this.onTitleInfoUpdate),this.onUIConfigurationsChange(this.uiConfigurationsStore.getUIConfigurations())},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.previousPolicy=null,this.policy=F.clone(o),this.titleInfoStore.offUpdate(this.onTitleInfoUpdate)},e.prototype.onPolicyChange=function(e){this.multicastCallback.add(e)},e.prototype.offPolicyChange=function(e){this.multicastCallback.remove(e)},e.prototype.getPolicy=function(){return this.policy},e.prototype.emitPolicyChange=function(){this.updatePolicyWithUIConfigurations(),this.multicastCallback.invoke(this.policy)},e.prototype.updatePolicyWithUIConfigurations=function(){var e=this.policy.seekForwardEnabled&&this.enableSeek,t=this.policy.seekBackwardEnabled&&this.enableSeek,n=this.policy.fastSeekEnabled&&(e||t)&&this.enableFastSeek;this.policy={fastSeekEnabled:n,pauseEnabled:this.policy.pauseEnabled&&this.enablePause,seekForwardEnabled:e,seekBackwardEnabled:t}},e}();t.PlaybackControlsPolicyStore=n});e(hw);hw.PlaybackControlsPolicyStore;var mw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.parentContainer=e,this.multicastCallback=new Dt.MulticastCallback}return e.prototype.onScalingChange=function(e){this.multicastCallback.add(e)},e.prototype.offScalingChange=function(e){this.multicastCallback.remove(e)},e.prototype.setPlayerScaling=function(e){e?(this.parentContainer.classList.add("scale"),this.multicastCallback.invoke(!0)):(this.parentContainer.classList.remove("scale"),this.multicastCallback.invoke(!1))},e}();t.PlayerScalingStore=n});e(mw);mw.PlayerScalingStore;var yw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("PlayerStuckStore"),n="visibilitychange",r=function(){function e(e,t,n,r){void 0===r&&(r=document);var i=this;this.playerStuckTimer=null,this.isStuck=!1,this.onPlayerStuckTimerTimeout=function(){i.isStuck=!0,i.modalStore.showModal(xP.Modal.PlayerStuck),i.eventEmitter.emit("PlayerStuck")},this.clearPlayerStuckTimer=function(){clearTimeout(i.playerStuckTimer),i.playerStuckTimer=null},this.onPageVisibilityChangeDuringLoading=function(){i.isStuck||(i.isPageHidden?(o.info("Page hidden, stopping player stuck timer"),i.clearPlayerStuckTimer()):(o.info("Page visible, starting player stuck timer"),i.startPlayerStuckTimer()))},this.onPageVisibilityChange=function(){null!=i.metricsReportingFeature&&i.metricsReportingFeature.reportInterface(i.isPageHidden?"Show":"Hide","Player",{_type:"Background"})},this.onUiStatusChange=function(e){if(e.state===$P.UIPlaybackState.Loading){if(i.isStuck||!i.uiStatusStore.hasPlaybackInitiated)return;i.startPlayerStuckTimer()}else i.playerStuckRecovered()},this.onPlaybackInitiated=function(){i.uiStatusStore.getUserInterfaceStatus().state===$P.UIPlaybackState.Loading&&i.startPlayerStuckTimer()},this.player=e,this.modalStore=t,this.uiStatusStore=n,this.documentRef=r,this.eventEmitter=new Dt.EventEmitter}return e.prototype.initialize=function(){var t=this;this.player.getFeature(this.player.Features.MetricsReporting).then(function(e){t.metricsReportingFeature=e}).catch(function(e){o.error("Couldn't get MetricsReportingFeature: "+e)}),this.destroy(),this.bindEvents()},e.prototype.destroy=function(){clearTimeout(this.playerStuckTimer),this.playerStuckTimer=null,this.isStuck=!1,this.unbindEvents()},e.prototype.initiatingPlayback=function(){this.isPageHidden||this.uiStatusStore.getUserInterfaceStatus().state!==$P.UIPlaybackState.Loading||this.startPlayerStuckTimer()},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.startPlayerStuckTimer=function(){this.documentRef.addEventListener(n,this.onPageVisibilityChangeDuringLoading),this.isPageHidden||(null===this.playerStuckTimer?this.playerStuckTimer=A.timer.setTimeout(this.onPlayerStuckTimerTimeout,3e4):o.info("Not starting timer because timer is currently in progress;"))},e.prototype.closeModal=function(){this.modalStore.onCloseModal()},e.prototype.bindEvents=function(){this.uiStatusStore.onUpdate(this.onUiStatusChange),this.player.on("PlaybackInitiated",this.onPlaybackInitiated),this.documentRef.addEventListener(n,this.onPageVisibilityChangeDuringLoading),this.documentRef.addEventListener(n,this.onPageVisibilityChange)},e.prototype.unbindEvents=function(){this.uiStatusStore.offUpdate(this.onUiStatusChange),this.player.off("PlaybackInitiated",this.onPlaybackInitiated),this.documentRef.removeEventListener(n,this.onPageVisibilityChangeDuringLoading),this.documentRef.removeEventListener(n,this.onPageVisibilityChange)},Object.defineProperty(e.prototype,"isPageHidden",{get:function(){return this.documentRef.hidden},enumerable:!0,configurable:!0}),e.prototype.playerStuckRecovered=function(){this.documentRef.removeEventListener(n,this.onPageVisibilityChangeDuringLoading),this.clearPlayerStuckTimer(),this.isStuck&&(this.isStuck=!1,this.eventEmitter.emit("PlayerStuckRecovered"),this.closeModal())},e}();t.PlayerStuckStore=r});e(yw);yw.PlayerStuckStore;var gw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("SkipElementStore");var n=function(){function e(e,t){this.metricsReportingFeature=null,this.playbackStore=e,this.player=t}return e.prototype.initialize=function(e){this.metricsReportingFeature=e},e.prototype.destroy=function(){this.metricsReportingFeature=null},e.prototype.skipSceneClicked=function(e,t){this.playbackStore.seek(e),null!==this.metricsReportingFeature&&this.metricsReportingFeature.reportInteraction("Player","Navigation","MouseClick",{_type:"SkipCard",input:"Follow",cardType:this.fixTypeCasing(t)},null,null,"Customer")},e.prototype.skipCardShowingChanged=function(e,t){null!==this.metricsReportingFeature&&this.metricsReportingFeature.reportInterface(e?"Show":"Hide","Player",{_type:"SkipCard",cardType:this.fixTypeCasing(t)})},e.prototype.fixTypeCasing=function(e){return e.replace(/(.)(.*)/,function(e,t,n){return t+n.toLowerCase()})},e}();t.SkipElementStore=n});e(gw);gw.SkipElementStore;var vw=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(){var e=this.constructor,t=n.call(this,"Spinner timeout error")||this;return t.code=dw.ErrorCodeTree.web.playback.spinner_timeout_error,t.name="Spinner timeout error",Object.setPrototypeOf(t,e.prototype),t}return i(e,n),e}(Error);t.SpinnerTimeoutError=n});e(vw);vw.SpinnerTimeoutError;var Sw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("SpinnerTimeoutStore"),n=function(){function e(e,t,n,r){var i=this;this.spinnerReported=!1,this.onSpinnerTimeoutError=function(){i.spinnerReported||(o.warn(">> onSpinnerTimeoutError, Reporting SpinnerTimeoutError"),i.spinnerReported=!0,i.errorStore.reportError(new vw.SpinnerTimeoutError,!1))},this.onSpinnerTimeoutRecovered=function(){i.spinnerReported&&(i.spinnerReported=!1,i.uiStatusStore.getUserInterfaceStatus().state!==$P.UIPlaybackState.Stopped&&o.info("Recovered from SpinnerTimeoutError"))},this.playerStuckStore=e,this.networkStateStore=t,this.errorStore=n,this.uiStatusStore=r,this.playerStuckStore.on("PlayerStuck",this.onSpinnerTimeoutError),this.playerStuckStore.on("PlayerStuckRecovered",this.onSpinnerTimeoutRecovered),this.networkStateStore.on("NetworkIssue",this.onSpinnerTimeoutError),this.networkStateStore.on("NetworkIssueRecovered",this.onSpinnerTimeoutRecovered)}return e.prototype.destroy=function(){this.playerStuckStore.off("PlayerStuck",this.onSpinnerTimeoutError),this.playerStuckStore.off("PlayerStuckRecovered",this.onSpinnerTimeoutRecovered),this.networkStateStore.off("NetworkIssue",this.onSpinnerTimeoutError),this.networkStateStore.off("NetworkIssueRecovered",this.onSpinnerTimeoutRecovered)},e}();t.SpinnerTimeoutStore=n});e(Sw);Sw.SpinnerTimeoutStore;var bw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function n(e,t){var c=this;this.contentType=null,this.seekPositionMs=null,this.timelineInfo=F.clone(n.EMPTY_TIMELINE),this.onSeek=function(e){c.seekPositionMs=e},this.onContentStateChange=function(e){e===Gd.ContentState.Unloaded&&c.clearTimelineInfo()},this.onTimeDataChangeEvent=function(e){var t,n=c.player.timeline.items[e.currentTimelineItemIndex],r=c.player.timeline.contentInfos[n.contentId],i=c.timelineQuerier.getFirstMainContentTimelineItem(n),o=c.timelineQuerier.getLastMainContentTimelineItem(n);"Feature"===r.contentType?(t=e.currentPosition,c.seekPositionMs=null):t=null!==c.seekPositionMs?c.seekPositionMs:c.timelineQuerier.getMidrollPosition(n);var a=i.timelineItem.startTime,s=o.timelineItem.endTime,l=e.playableRanges[e.currentTimelineItemIndex];s===1/0&&null!=l&&(a=l.start,s=l.end);var u={startPositionMs:a,endPositionMs:s,earliestPlayablePositionMs:c.contentType!==_P.ContentType.Live?c.getMainContentEarliestPlayablePosition(n):c.getMainContentEarliestPlayablePositionLive(),lastPlayablePositionMs:c.contentType!==_P.ContentType.Live?c.getMainContentLastPlayablePosition(n):c.getMainContentLastPlayablePositionLive(),positionMs:t};c.timelineInfo=xt.deepExtend(c.timelineInfo,u),c.onTimelineInfoChanged()},this.player=e,this.playbackStore=t,this.multicastCallback=new Dt.MulticastCallback,this.timelineQuerier=new hP.TimelineQuerier(e)}return n.prototype.initialize=function(){this.playbackStore.on("SeekChange",this.onSeek),this.player.on(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange),this.player.on(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChangeEvent)},n.prototype.destroy=function(){this.multicastCallback.removeAll(),this.timelineInfo=F.clone(n.EMPTY_TIMELINE),this.playbackStore.off("SeekChange",this.onSeek),this.player.off(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange),this.player.off(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChangeEvent)},n.prototype.getTimelineInfo=function(){return this.timelineInfo},n.prototype.getTimelineItemIndex=function(e){for(var t=0,n=this.timelineQuerier.getAllItems();t<n.length;t++){var r=n[t],i=r.timelineItem;if(!(xt.withDefault(i.endTime,1/0)<e))return r.timelineItemIndex}return null},n.prototype.clearTimelineInfo=function(){this.timelineInfo=F.clone(n.EMPTY_TIMELINE),this.onTimelineInfoChanged()},n.prototype.onUpdate=function(e){this.multicastCallback.add(e)},n.prototype.offUpdate=function(e){this.multicastCallback.remove(e)},n.prototype.setContentType=function(e){this.contentType=e},n.prototype.onTimelineInfoChanged=function(){this.multicastCallback.invoke(this.timelineInfo)},n.prototype.getMainContentEarliestPlayablePosition=function(e){for(var t=this.timelineQuerier.getMainContentItems(e),n=this.player.currentTime,r=0,i=t;r<i.length;r++){var o=i[r],a=n.playableRanges[o.timelineItemIndex],s=null!=a?a.start:null;if(null!=s)return s}return null},n.prototype.getMainContentEarliestPlayablePositionLive=function(){for(var e=this.timelineQuerier.getAllItems(),t=this.player.currentTime,n=0;n<=e.length-1;n++){var r=e[n];if("Feature"===e[n].contentInfo.contentType){var i=t.playableRanges[r.timelineItemIndex],o=null!=i?i.start:null;if(null!=o)return o}}return null},n.prototype.getMainContentLastPlayablePosition=function(e){var t=this.timelineQuerier.getMainContentItems(e);t.reverse();for(var n=this.player.currentTime,r=0,i=t;r<i.length;r++){var o=i[r],a=n.playableRanges[o.timelineItemIndex],s=null!=a?a.end:null;if(null!=s)return s}return null},n.prototype.getMainContentLastPlayablePositionLive=function(){for(var e=this.timelineQuerier.getAllItems(),t=this.player.currentTime,n=e.length-1;0<=n;n--){var r=e[n];if("Feature"===e[n].contentInfo.contentType){var i=t.playableRanges[r.timelineItemIndex],o=null!=i?i.end:null;if(null!=o)return o}}return null},n.EMPTY_TIMELINE={earliestPlayablePositionMs:0,endPositionMs:0,lastPlayablePositionMs:0,positionMs:0,startPositionMs:0},n}();t.TimelineInfoStore=n});e(bw);bw.TimelineInfoStore;var Tw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("TitleInfoStore");var m={Advertisement:_P.ContentType.Ad,Feature:_P.ContentType.VOD},n=function(){function a(e,t,n,r,i){void 0===i&&(i=new Dt.MulticastCallback);var o=this;this.contentTypeOverride=null,this.streamFeature=null,this.watchedAdContentIds=[],this.titleInfo=F.clone(a.EMPTY_TITLE),this.onContentStateChange=function(e){e===Gd.ContentState.Unloaded?o.clearTitle():e===Gd.ContentState.Waiting&&o.tryUpdateTitleInfo(o.player.currentTime.currentTimelineItemIndex)},this.onTimeDataChange=function(e){o.tryUpdateTitleInfo(e.currentTimelineItemIndex)},this.player=e,this.marketplaceId=t,this.contentMetadataStore=n,this.uiConfigurationsStore=r,this.multicastCallback=i,this.timelineQuerier=new hP.TimelineQuerier(this.player)}return a.prototype.initialize=function(){var t=this;this.player.getFeature(this.player.Features.Stream).then(function(e){t.streamFeature=e}),this.player.on(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange),this.player.on(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChange)},a.prototype.destroy=function(){this.multicastCallback.removeAll(),this.player.off(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange),this.player.off(Gd.PlayerEvent.TimeDataChange,this.onTimeDataChange),this.streamFeature=null,this.titleInfo=F.clone(a.EMPTY_TITLE),this.watchedAdContentIds=[]},a.prototype.getTitleInfo=function(){return this.titleInfo},a.prototype.clearTitle=function(){this.titleInfo=F.clone(a.EMPTY_TITLE),this.onTitleInfoChanged()},a.prototype.onUpdate=function(e){this.multicastCallback.add(e)},a.prototype.offUpdate=function(e){this.multicastCallback.remove(e)},a.prototype.setContentType=function(e){this.contentTypeOverride=e===_P.ContentType.Live?e:null},a.prototype.shouldBlockFsk18=function(e){return this.marketplaceId===Y.MarketplaceID.DE&&"18"!==this.titleInfo.regulatoryRating&&"18"===e},a.prototype.tryUpdateTitleInfo=function(e){var t=this.player.timeline.items[e],n=this.getTitleInfoForTimelineItem(t),r=this.timelineQuerier.getItemForNextMainContentTitle(e),i=xt.nestedValue(r,"contentInfo.metadata.catalog.regulatoryRating");null===r||this.shouldBlockFsk18(i)||(n.nextTitle=this.getTitleInfoForTimelineItem(r.timelineItem)),F.isEqual(this.titleInfo,n)||(this.titleInfo=n,this.onTitleInfoChanged())},a.prototype.onTitleInfoChanged=function(){this.multicastCallback.invoke(this.titleInfo)},a.prototype.getHeroImageUrl=function(e){var t=new wb.ImageUrlBuilder(e).removeAllUrlSourceTags().addUpscaleToWidthTag(1920).create();return null===t?null:t.url},a.prototype.createSkipElements=function(e,t){var n=this.uiConfigurationsStore.getUIConfigurations();return!F.isEmpty(e)&&(null===t||1<t)&&n.enableSkipElement?e:null},a.prototype.getTitleInfoForTimelineItem=function(e){var t=this.timelineQuerier.getMainContentItems(e)[0],n=t.timelineItem,r=this.player.timeline.contentInfos[e.contentId],i=t.contentInfo,o=null,a=null,s=xt.nestedValue(i,"metadata.family.tvAncestors");if(xt.exists(s))for(var l=0,u=s;l<u.length;l++){var c=u[l];"SEASON"===c.catalog.type?o=c.catalog.seasonNumber:"SHOW"===c.catalog.type&&(a=c.catalog.title)}var d=m[r.contentType];d!==_P.ContentType.Ad&&null!==this.contentTypeOverride&&(d=this.contentTypeOverride),d!==_P.ContentType.Ad||F.contains(this.watchedAdContentIds,e.contentId)||this.watchedAdContentIds.push(e.contentId);var p=xt.nestedValue(i,"metadata.catalog.episodeNumber"),f=this.contentMetadataStore.getContentMetadataFromTitle(i.titleId),h=this.getTitleInfoFromContentMetadata(f);return{autoplaySettings:xt.nestedValue(i,"transitionTimecodes.autoplaySettings"),autoplayTimerMs:xt.nestedValue(i,"transitionTimecodes.autoPlayTimer"),clickThroughUrl:xt.nestedValue(r,"metadata.clickThroughUri"),contentType:d,entityType:xt.nestedValue(i,"metadata.catalog.entityType"),episodeImageUrl:xt.nestedValue(i,"metadata.images.imageUrls.episode"),gti:xt.nestedValue(i,"metadata.catalog.id"),hasCaptions:null!==this.streamFeature&&0<this.streamFeature.streamGroups.TimedText.streams.length,isPlayable:xt.nestedValue(i,"metadata.playback.summary.isPlayable"),midrollPositionsMs:this.timelineQuerier.getMidrollPositions(n.groupId,this.watchedAdContentIds),outroCreditsStartMs:xt.nestedValue(i,"transitionTimecodes.outroCreditsStart"),regulatoryRating:xt.nestedValue(i,"metadata.catalog.regulatoryRating"),skipElements:this.createSkipElements(xt.nestedValue(i,"transitionTimecodes.skipElements"),p),skipOffsetMs:xt.nestedValue(r,"metadata.skipOffset"),titleImageUrl:xt.nestedValue(i,"metadata.images.imageUrls.title"),titleId:i.titleId,type:xt.nestedValue(i,"metadata.catalog.type"),nextTitle:null,episodeNumber:xt.withDefault(h.episodeNumber,p),heroImageUrl:xt.withDefault(h.heroImageUrl,this.getHeroImageUrl(xt.nestedValue(i,"metadata.images.imageUrls.hero"))),seasonNumber:xt.withDefault(h.seasonNumber,o),seriesTitle:xt.withDefault(h.seriesTitle,a),title:xt.withDefault(h.title,xt.nestedValue(i,"metadata.catalog.title"))}},a.prototype.getTitleInfoFromContentMetadata=function(e){return{title:xt.withDefault(e.title,null),seriesTitle:xt.withDefault(e.seriesTitle,null),heroImageUrl:xt.withDefault(e.heroImageUrl,null),episodeNumber:xt.withDefault(e.episodeNumber,null),seasonNumber:xt.withDefault(e.seasonNumber,null)}},a.EMPTY_TITLE={clickThroughUrl:null,contentType:null,disclaimerText:null,episodeNumber:null,heroImageUrl:null,midrollPositionsMs:null,nextTitle:null,seasonNumber:null,seriesTitle:null,skipOffsetMs:null,skipElements:null,title:null},a}();t.TitleInfoStore=n});e(Tw);Tw.TitleInfoStore;var Pw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onPlayerTouched=function(){Pt.metrics.putMetric(e.TOUCH_METRIC)},e.TOUCH_METRIC="TouchEnabledSession",e}();t.TouchInputStore=n});e(Pw);Pw.TouchInputStore;var ww=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.bifFile=null,this.imageOffsets=[],this.imageUrlMap={},this.bifFile=e,this.imageOffsets=t}return e.prototype.clearCache=function(){F.values(this.imageUrlMap).forEach(function(e){URL.revokeObjectURL(e)})},e.prototype.getImageUrl=function(e){var t=F.sortedIndex(this.imageOffsets,{positionMillis:e},"positionMillis");t=Math.max(Math.min(t,this.imageOffsets.length-1),1);var n=Math.max(t-1,0),r=this.imageUrlMap[n];return xt.isNullOrUndefined(r)&&(r=URL.createObjectURL(this.getBlob(n,t)),this.imageUrlMap[n]=r),r},e.prototype.getBlob=function(e,t){var n=this.imageOffsets[e].offsetBytes,r=this.imageOffsets[t].offsetBytes,i=new Uint8Array(this.bifFile,n,r-n);return new Blob([i],{type:"image/jpeg"})},e}();t.BifFrameImageSource=n});e(ww);ww.BifFrameImageSource;var Cw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("BifParser"),n=function(){function e(){}return e.prototype.parse=function(e){var t=new DataView(e);if(!this.isValidBif(t))return u.error("Unable to parse invalid BIF file."),null;try{var n=t.getUint32(12,!0),r=t.getUint32(16,!0);r=0===r?1e3:r,u.info("Parsing BIF with "+n+" images and a timestamp multiplier of "+r);for(var i=[],o=64,a=1;a<=n;a++){var s=t.getUint32(o,!0)*r,l=t.getUint32(o+4,!0);i.push({positionMillis:s,offsetBytes:l}),o+=8}return 4294967295!==t.getUint32(o,!0)&&u.warn("Missing final entry indicator, there may be missing frames."),i.push({positionMillis:Number.MAX_VALUE,offsetBytes:t.getUint32(o+4,!0)}),new ww.BifFrameImageSource(e,i)}catch(e){return u.error("Unable to parse BIF file due to fatal error.",e),null}},e.prototype.isValidBif=function(e){for(var t=[137,66,73,70,13,10,26,10],n=0;n<t.length;n++){if(e.getUint8(n)!==t[n])return!1}return 0===e.getUint32(8,!0)},e}();t.BifParser=n});e(Cw);Cw.BifParser;var Mw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BifParser=Cw.BifParser});e(Mw);Mw.BifParser;var Iw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("TrickplayStore"),s=[400,401,403],n="TrickplayDownloadError",r=function(){function e(e){var i=this;this.metricsReportingFeature=null,this.trickplayRequest=null,this.trickplayRetry=null,this.currentContentId=null,this.enabled=!0,this.imageSource=null,this.onContentStateChange=function(e){e===Gd.ContentState.Ready&&(i.player.off("ContentStateChange",i.onContentStateChange),i.tryDownloadPreviewAsset())},this.onTimeDataChange=function(e){var t=i.player.timeline.items[e.currentTimelineItemIndex],n=i.player.timeline.contentInfos[t.contentId];if("Feature"===n.contentType&&i.currentContentId!==t.contentId){i.player.off("ContentStateChange",i.onContentStateChange),i.currentContentId=t.contentId,null!=i.imageSource&&(a.info("Prepared with new content, clearing old cache."),i.imageSource.clearCache(),i.imageSource=null),i.tryAbortRequest();var r=n.videoPreviewAssets;F.isEmpty(r)?a.info("No valid Trickplay URLs available for this content."):(i.selectedAsset=xt.withDefault(F.findWhere(r,{quality:"Medium"}),F.findWhere(r,{quality:"Low"})),i.player.contentState===Gd.ContentState.Ready?i.tryDownloadPreviewAsset():i.player.on("ContentStateChange",i.onContentStateChange))}},this.onBifReady=function(e){i.imageSource=i.bifParser.parse(e)},this.player=e,this.bifParser=new Mw.BifParser}return e.prototype.initialize=function(e){this.metricsReportingFeature=e,this.player.on("TimeDataChange",this.onTimeDataChange)},e.prototype.destroy=function(){this.player.off("ContentStateChange",this.onContentStateChange),this.player.off("TimeDataChange",this.onTimeDataChange),this.metricsReportingFeature=null,this.tryAbortRequest(),null!=this.imageSource&&(a.info("Clearing all cached Trickplay images."),this.imageSource.clearCache(),this.imageSource=null)},e.prototype.setContentType=function(e){this.enabled=e!==_P.ContentType.Trailer},e.prototype.trickplayShowingChanged=function(e){null!=this.metricsReportingFeature&&this.metricsReportingFeature.reportInterface(e?"Show":"Hide","Player",{_type:"TrickPlay"})},e.prototype.getTrickplayImageUrl=function(e){return e+=1e4,this.enabled&&null!=this.imageSource?this.imageSource.getImageUrl(e):null},e.prototype.tryDownloadPreviewAsset=function(){this.enabled&&null!=this.selectedAsset&&null==this.imageSource&&null==this.trickplayRetry&&this.downloadPreviewAsset(this.selectedAsset)},e.prototype.downloadPreviewAsset=function(e){var i=this;a.info("Acquiring trickplay urls.",e),Pt.metrics.putMetric(n,0);var o=e.urls[0];this.trickplayRetry=(new Op.ExponentialBackoffRetry).withMaxAttempts(4).withInitialIntervalMs(500).withExponentialFactor(2).withRandomizationFactor(200).onSuccess(function(e){i.trickplayRequest=null,i.trickplayRetry=null,i.onBifReady(e)}).onError(function(e){i.trickplayRequest=null,i.trickplayRetry=null;var t="Unable to acquire Trickplay urls. "+e;i.reportTrickplayError(t)}).onAttempt(function(e,t,n,r){i.sendRequest(o,e,t,n,r)}).execute()},e.prototype.sendRequest=function(e,t,n,r,i){var o=this;this.trickplayRequest=mp.HttpRequest.get(e).responseType("arraybuffer").onError(function(e,t){null!=t&&F.contains(s,t.getStatus())?i(e):n(e)}).onLoad(function(e){var t=e.getArrayBuffer();if(null==t||0===t.byteLength)return o.reportTrickplayError("Unable to download Trickplay BIF file (null or empty response)."),void n();Pt.metrics.putMetric("TrickplayDownloadTime",e.getDownloadMs()),r(t)}).onAbort(function(){o.trickplayRequest=null}).send()},e.prototype.tryAbortRequest=function(){null!=this.trickplayRequest&&(this.trickplayRequest.abort(),this.trickplayRequest=null),null!=this.trickplayRetry&&(this.trickplayRetry.abort(),this.trickplayRetry=null,a.info("Cancelled Trickplay download."))},e.prototype.reportTrickplayError=function(e){a.error(e),Pt.metrics.putMetric(n,1)},e}();t.TrickplayStore=r});e(Iw);Iw.TrickplayStore;var Ew=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.userActivityFeature=null,this.onFeatureUserActiveChange=function(e){n.multicastCallback.invoke(e)},this.multicastCallback=new Dt.MulticastCallback,this.player=e,this.webPlayerUIType=t}return e.prototype.initialize=function(){var t=this;this.webPlayerUIType===ct.WebPlayerSDKFeatures.GCastPlayer&&this.player.getFeature(this.player.Features.UserActivity).then(function(e){t.userActivityFeature=e,t.userActivityFeature.onUserActiveChange(t.onFeatureUserActiveChange)})},e.prototype.destroy=function(){this.multicastCallback.removeAll(),null!==this.userActivityFeature&&this.userActivityFeature.offUserActiveChange(this.onFeatureUserActiveChange),this.userActivityFeature=null},e.prototype.onUserActiveChange=function(e){this.multicastCallback.add(e)},e.prototype.offUserActiveChange=function(e){this.multicastCallback.remove(e)},e.prototype.getUserActive=function(){return null===this.userActivityFeature||this.userActivityFeature.userActive},e}();t.UserActivityStore=n});e(Ew);Ew.UserActivityStore;var _w=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return{alwaysDisplayAdCountdown:!1,alwaysDisplayPausedOverlay:!1,closePlayerOnBlockingModal:!1,enableAmazonBranding:!0,enableFastSeekButtons:!0,enableHdIndicator:!0,enableLiveContentWarning:!0,enableMta:!0,enableNextUp:!0,enableOptions:!0,enablePause:!0,enableSeek:!0,enableSeekbar:!0,enableSeekbarTrickplay:!0,enableSkipElement:!0,enableSubtitles:!0,enableXray:!0,playerCloseable:!0,enableAddToWatchlist:!0,enableDraperCaption:!1,enableFullscreen:!0,enableMainTitleDuringDraper:!0,enableNextUpCarousel:!1,enableRateYourExperience:!0,enableRateYourExperienceIcon:!1,enableVolume:!0}};t.GetDefaultUIConfigurations=n;var r=function(){function e(e,t){this.fullPlayerSizeElement=null,this.uiConfigurations={alwaysDisplayAdCountdown:!1,alwaysDisplayPausedOverlay:!1,closePlayerOnBlockingModal:!1,enableAmazonBranding:!0,enableFastSeekButtons:!0,enableHdIndicator:!0,enableLiveContentWarning:!0,enableMta:!0,enableNextUp:!0,enableOptions:!0,enablePause:!0,enableSeek:!0,enableSeekbar:!0,enableSeekbarTrickplay:!0,enableSkipElement:!0,enableSubtitles:!0,enableXray:!0,playerCloseable:!0,enableAddToWatchlist:!0,enableDraperCaption:!1,enableFullscreen:!0,enableMainTitleDuringDraper:!0,enableNextUpCarousel:!1,enableRateYourExperience:!0,enableRateYourExperienceIcon:!1,enableVolume:!0},this.player=e,this.multicastCallback=new Dt.MulticastCallback,this.requestedPlayerFeature=t}return e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.fullPlayerSizeElement=null,this.uiConfigurations={alwaysDisplayAdCountdown:!1,alwaysDisplayPausedOverlay:!1,closePlayerOnBlockingModal:!1,enableAmazonBranding:!0,enableFastSeekButtons:!0,enableHdIndicator:!0,enableLiveContentWarning:!0,enableMta:!0,enableNextUp:!0,enableOptions:!0,enablePause:!0,enableSeek:!0,enableSeekbar:!0,enableSeekbarTrickplay:!0,enableSkipElement:!0,enableSubtitles:!0,enableXray:!0,playerCloseable:!0,enableAddToWatchlist:!0,enableDraperCaption:!1,enableFullscreen:!0,enableMainTitleDuringDraper:!0,enableNextUpCarousel:!1,enableRateYourExperience:!0,enableRateYourExperienceIcon:!1,enableVolume:!0}},e.prototype.onUpdate=function(e){this.multicastCallback.add(e)},e.prototype.offUpdate=function(e){this.multicastCallback.remove(e)},e.prototype.updateUIConfigurations=function(e){F.extendOwn(this.uiConfigurations,F.omit(e,function(e){return null==e})),this.uiConfigurations.enableSeek||(this.uiConfigurations.enableFastSeekButtons=!1),this.multicastCallback.invoke(this.uiConfigurations)},e.prototype.getUIConfigurations=function(){return this.uiConfigurations},e.prototype.setFullPlayerSizeElement=function(e){this.fullPlayerSizeElement=e},e.prototype.useSmallPlayerUI=function(){return!(null===this.fullPlayerSizeElement||this.fullPlayerSizeElement.clientWidth<=1||this.fullPlayerSizeElement.clientHeight<=1)&&(this.fullPlayerSizeElement.clientWidth<=480||this.fullPlayerSizeElement.clientHeight<=270)},e.prototype.getRequestedPlayerFeature=function(){return this.requestedPlayerFeature},e}();t.UIConfigurationsStore=r});e(_w);_w.GetDefaultUIConfigurations,_w.UIConfigurationsStore;var xw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.uiIsShowing=!1,this.multicastCallback=new Dt.MulticastCallback}return e.prototype.initialize=function(){this.reset()},e.prototype.destroy=function(){this.reset()},e.prototype.onDisplayStatusChange=function(e){this.multicastCallback.add(e)},e.prototype.offDisplayStatusChange=function(e){this.multicastCallback.remove(e)},e.prototype.setDisplayStatus=function(e){e!==this.uiIsShowing&&(this.uiIsShowing=e,this.multicastCallback.invoke(this.uiIsShowing))},e.prototype.isShowing=function(){return this.uiIsShowing},e.prototype.reset=function(){this.uiIsShowing=!1,this.multicastCallback.removeAll()},e}();t.UIDisplayStatusStore=n});e(xw);xw.UIDisplayStatusStore;var kw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("UserInterfaceStatusStore");var n={state:$P.UIPlaybackState.Loading,userActive:!1},r=function(){function e(e,t,n,r){var i=this;this.uiStatus=this.createEmptyUiStatus(),this.metricsReportingFeature=null,this.playbackInitiated=!1,this.currentContentState=Gd.ContentState.Unloaded,this.onContentStateChange=function(e){if(e===Gd.ContentState.Unloaded)return i.uiStatus.state=i.getUIPlaybackState(e,i.player.playbackState),i.currentContentState=e,void i.clearUserInterfaceStatus();i.uiStatus.state===$P.UIPlaybackState.Error&&null!==e&&e!==Gd.ContentState.Waiting&&i.currentContentState===Gd.ContentState.Unloaded&&(e=Gd.ContentState.Error),i.uiStatus.state=i.getUIPlaybackState(e,i.player.playbackState),i.onUserInterfaceStatusChanged(),i.currentContentState=e},this.onPlaybackStateChange=function(e){e===Gd.PlaybackState.Paused&&i.alwaysDisplayPausedOverlayWhilePaused&&(i.uiStatus.userActive=!0),i.uiStatus.state=i.getUIPlaybackState(i.player.contentState,e),i.onUserInterfaceStatusChanged()},this.onError=function(e){i.uiStatus.state=$P.UIPlaybackState.Error,i.onUserInterfaceStatusChanged()},this.onPlaybackInitiated=function(){i.playbackInitiated=!0},this.onLockStoreStatusChanged=function(e){i.uiStatus.userActive=e,i.onUserInterfaceStatusChanged()},this.onUIConfigurations=function(e){i.alwaysDisplayPausedOverlayWhilePaused=e.alwaysDisplayPausedOverlay},this.alwaysDisplayPausedOverlayWhilePaused=r.getUIConfigurations().alwaysDisplayPausedOverlay,this.errorStore=n,this.lockStore=e,this.multicastCallback=new Dt.MulticastCallback,this.player=t,this.uiConfigurationsStore=r}return e.prototype.initialize=function(e){this.metricsReportingFeature=e,this.errorStore.onError(this.onError),this.lockStore.onChange(this.onLockStoreStatusChanged),this.uiConfigurationsStore.onUpdate(this.onUIConfigurations),this.player.on(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange),this.player.on(Gd.PlayerEvent.PlaybackStateChange,this.onPlaybackStateChange),this.player.on("PlaybackInitiated",this.onPlaybackInitiated)},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.errorStore.offError(this.onError),this.lockStore.offChange(this.onLockStoreStatusChanged),this.uiConfigurationsStore.offUpdate(this.onUIConfigurations),this.player.off(Gd.PlayerEvent.ContentStateChange,this.onContentStateChange),this.player.off(Gd.PlayerEvent.PlaybackStateChange,this.onPlaybackStateChange),this.player.off("PlaybackInitiated",this.onPlaybackInitiated),this.currentContentState=Gd.ContentState.Unloaded,this.uiStatus=this.createEmptyUiStatus(),this.metricsReportingFeature=null},e.prototype.getUserInterfaceStatus=function(){return this.uiStatus},e.prototype.onClosePlayer=function(){this.playbackInitiated=!1,this.clearUserInterfaceStatus()},e.prototype.reportSpinnerShowing=function(e){null!=this.metricsReportingFeature&&this.metricsReportingFeature.reportInterface(e?"Show":"Hide","Player",{_type:"Spinner"})},e.prototype.onUpdate=function(e){this.multicastCallback.add(e)},e.prototype.offUpdate=function(e){this.multicastCallback.remove(e)},Object.defineProperty(e.prototype,"hasPlaybackInitiated",{get:function(){return this.playbackInitiated},enumerable:!0,configurable:!0}),e.prototype.onUserInterfaceStatusChanged=function(){this.multicastCallback.invoke(this.uiStatus)},e.prototype.clearUserInterfaceStatus=function(){this.uiStatus=this.createEmptyUiStatus(),this.onUserInterfaceStatusChanged()},e.prototype.getUIPlaybackState=function(e,t){return"Error"===e?$P.UIPlaybackState.Error:"Waiting"===e&&"Ready"===this.currentContentState?$P.UIPlaybackState.Buffering:"Waiting"===e&&"Waiting"!==this.currentContentState?$P.UIPlaybackState.Loading:"Ready"===e&&"Playing"===t?$P.UIPlaybackState.Playing:"Ready"===e&&"Paused"===t?$P.UIPlaybackState.Paused:"Unloaded"===e?$P.UIPlaybackState.Stopped:this.uiStatus.state},e.prototype.createEmptyUiStatus=function(){var e=F.clone(n);return xt.exists(this.uiStatus)&&(e.state=this.uiStatus.state,e.userActive=this.uiStatus.userActive),e},e}();t.UserInterfaceStatusStore=r});e(kw);kw.UserInterfaceStatusStore;var Rw=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onDontShowAgain=function(){e.context.stores.videoStream.dontShowForceSdAssetNotification(e.props.notification)},e}return n(e,t),e.prototype.render=function(){var e=this.context.stores.localization.getLocalization(),t=e.ForceSdAssetError.replace("{{systemRequirementsUrl}}",this.context.amazonUrlCreator.createCSUrl("SYSTEM_REQUIREMENTS"));return Vn.createElement("span",null,Vn.createElement("div",{dangerouslySetInnerHTML:{__html:t}}),Vn.createElement("a",{onClick:this.onDontShowAgain},e.dontShowAgainShort))},e.contextType=QP.ReactContext,e}(Vn.Component);t.ForceSdAssetNotification=i});e(Rw);Rw.ForceSdAssetNotification;var Aw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("VideoStreamStore"),a={streams:[],activeStream:null,activeVariant:null},r=function(){function e(e,t,n,r,i){void 0===i&&(i=new Ce.LocalStorage);var o=this;this.forceSdAssetNotificationShown=!1,this.forceSdAssetNotification=null,this.streamFeature=null,this.verifiedSecurePipeline=null,this.videoStreamInfo=F.clone(a),this.onActiveStreamChange=function(e,t){"Video"===e&&((null===o.videoStreamInfo.activeStream?null:o.videoStreamInfo.activeStream.id)!==t&&o.generateVideoStreamInfo())},this.onActiveVariantChange=function(e,t,n){"Video"===e&&((null===o.videoStreamInfo.activeVariant?null:o.videoStreamInfo.activeVariant.id)!==n&&o.generateVideoStreamInfo())},this.onStreamGroupChange=function(e,t){"Video"===e&&o.generateVideoStreamInfo()},this.onStreamChange=function(e,t){"Video"===e&&o.generateVideoStreamInfo()},this.onVerifiedSecurePipelineChange=function(e){e||o.onForceSdAsset()},this.onUiStatusUpdate=function(e){e.state===$P.UIPlaybackState.Playing&&(o.tryShowForceSdAssetNotification(),o.uiStatusStore.offUpdate(o.onUiStatusUpdate))},this.player=e,this.storage=i,this.bandwidthCapperStore=t,this.notificationStore=n,this.uiStatusStore=r,this.multicastCallback=new Dt.MulticastCallback}return e.prototype.initialize=function(){var t=this;this.videoStreamInfo=F.clone(a),this.player.getFeature(this.player.Features.Stream).then(function(e){t.streamFeature=e,t.generateVideoStreamInfo(),t.streamFeature.on("ActiveStreamChange",t.onActiveStreamChange),t.streamFeature.on("ActiveVariantChange",t.onActiveVariantChange),t.streamFeature.on("StreamGroupChange",t.onStreamGroupChange),t.streamFeature.on("StreamChange",t.onStreamChange)}).catch(function(e){n.warn(e)}),this.player.getPlayerCapabilitiesFeature().getDeviceCapabilities().then(function(e){t.verifiedSecurePipeline=F.every(e,function(e){return e.verifiedSecurePipeline}),t.onVerifiedSecurePipelineChange(t.verifiedSecurePipeline),t.player.getPlayerCapabilitiesFeature().on("VerifiedSecurePipelineChange",t.onVerifiedSecurePipelineChange)})},e.prototype.destroy=function(){this.multicastCallback.removeAll(),this.videoStreamInfo=F.clone(a),null!==this.streamFeature&&(this.streamFeature.off("ActiveStreamChange",this.onActiveStreamChange),this.streamFeature.off("ActiveVariantChange",this.onActiveVariantChange),this.streamFeature.off("StreamGroupChange",this.onStreamGroupChange),this.streamFeature.off("StreamChange",this.onStreamChange)),this.streamFeature=null,this.player.getPlayerCapabilitiesFeature().off("VerifiedSecurePipelineChange",this.onVerifiedSecurePipelineChange)},e.prototype.onVideoStreamInfoChange=function(e){this.multicastCallback.add(e)},e.prototype.offVideoStreamInfoChange=function(e){this.multicastCallback.remove(e)},e.prototype.getVideoStreamInfo=function(){return this.videoStreamInfo},e.prototype.dontShowForceSdAssetNotification=function(e){this.storage.set(SP.StorageKeys.DontShowForceSDAssetWarning,"true"),this.notificationStore.cancelNotification(e)},e.prototype.generateVideoStreamInfo=function(){var e=this.streamFeature.streamGroups.Video;this.videoStreamInfo={streams:e.streams,activeStream:bP.StreamQuerier.getActiveStream(this.streamFeature,"Video"),activeVariant:bP.StreamQuerier.getActiveVariant(this.streamFeature,"Video")},this.bandwidthCapperStore.setVideoStream(this.videoStreamInfo.activeStream);var t=this.storage.get(SP.StorageKeys.DataSaverSetting);null!==t&&this.bandwidthCapperStore.setCapStrategy(PP.parse(t)),this.multicastCallback.invoke(this.videoStreamInfo)},e.prototype.onForceSdAsset=function(){"true"!==this.storage.get(SP.StorageKeys.DontShowForceSDAssetWarning)&&(this.uiStatusStore.getUserInterfaceStatus().state===$P.UIPlaybackState.Playing?this.tryShowForceSdAssetNotification():this.uiStatusStore.onUpdate(this.onUiStatusUpdate))},e.prototype.tryShowForceSdAssetNotification=function(){this.forceSdAssetNotificationShown||(this.forceSdAssetNotification=new JP.Notification("",10),this.forceSdAssetNotification.setContents(Vn.createElement(Rw.ForceSdAssetNotification,{notification:this.forceSdAssetNotification})),this.notificationStore.addNotification(this.forceSdAssetNotification),this.forceSdAssetNotificationShown=!0)},e}();t.VideoStreamStore=r});e(Aw);Aw.VideoStreamStore;var Ow=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.multicastCallback=new Dt.MulticastCallback}return e.prototype.onHighlightInfoChange=function(e){this.multicastCallback.add(e)},e.prototype.offHighlightInfoChange=function(e){this.multicastCallback.remove(e)},e.prototype.setXrayHighlight=function(e){this.multicastCallback.invoke(e)},e}();t.XrayHighlightModeStore=n});e(Ow);Ow.XrayHighlightModeStore;var Lw=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0});var o=[Y.MarketplaceID.ROE_EU,Y.MarketplaceID.ROW_EU,Y.MarketplaceID.ROW_FE,Y.MarketplaceID.ROW_NA,Y.AmazonFQDN.PRIME_VIDEO],a={contactUs:"/help/contact-us",hdcp:"/help?nodeId=GU85HKX66NVFNQ9Y",pin:"/settings/parental-controls",pvGoUpgrade:"/upgrade",settings:"/settings",termsOfUse:"/help?nodeId=G202095490",videoHelp:"/help",errors:"/help?nodeId=202065170",error1044:"/help?nodeId=GK8T53PJ3QEB47KP",error7031:"/help?nodeId=GU85HKX66NVFNQ9Y",error7135:"/help?nodeId=GU85HKX66NVFNQ9Y"};function i(t,e,n){n=xt.exists(n)?"?ref="+n:"",F.chain(t).keys().forEach(function(e){t[e]+=n});for(var r=0,i=o;r<i.length;r++){t[i[r]]=a[e]}return t}var s={VIDEO_HELP:i({"*":"/videohelp"},"videoHelp"),ORDERS:i((n={"*":"/digitalorders"},n[Y.MarketplaceID.JP]="/gp/css/order-history",n),"contactUs"),TERMS_OF_USE:i({"*":"/instantvideo/terms"},"termsOfUse"),CONTACT_US:i({"*":"/video/contactus"},"contactUs"),SETTINGS:i((r={"*":"/instantvideo/settings"},r[Y.MarketplaceID.DE]="/videoeinstellungen",r),"settings"),AV_SETTINGS:i({"*":"/pin"},"pin","dp_pct_pin_chg"),HDCP_HELP:i({"*":"/gp/help/customer/display.html?nodeId=201460980"},"hdcp"),PIN_SETUP:i({"*":"/pin"},"pin"),PVGO_UPGRADE:i({"*":"/instantvideo/settings"},"pvGoUpgrade"),RESET_PIN:i({"*":"/pin"},"pin","dp_pct_pin_forg"),SYSTEM_REQUIREMENTS:i({"*":"/gp/help/customer/display.html?nodeId=201422810"},"systemRequirements"),CONTACT_US_ORDERS:i({"*":"/gp/help/customer/contact-us"},"contactUs"),1044:i({"*":"/dv/error/1044"},"error1044"),7031:i({"*":"/dv/error/7031"},"error7031"),7135:i({"*":"/dv/error/7135"},"error7135")};t.CSUrlPathMap=s});e(Lw);Lw.CSUrlPathMap;var Fw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.PackageVersion="ATVWebPlayerUI-1.0.5069.0"});e(Fw);Fw.PackageVersion;var Dw={episodeShort:"Ep.",episodeLong:"Season {{seasonNumber}}, Ep. {{episodeNumber}}",gCastPinMessage:"Please use your mobile device to resume playing.",gCast:{idleScreen:{updateHeader:"Check for updates",updateWarning:"You're ready to cast, but the connection might experience interruptions.",updateMessage:"Check for TV firmware or Chromecast updates. For more help, contact the manufacturer."}},idleScreen:{header:"Ready to cast",paragraphOne:"It's going to be awesome."},season:"Season",userInactive:{header:"Are you still there?",text:"Please respond on your mobile device."},close:"Close",closePlayer:"Close Player",continue:"Continue",continueWaiting:"Continue Waiting",dontShowAgain:"Don't show this message again",dontShowAgainShort:"Don't show again",exitFullscreen:"Exit Fullscreen",disabledFullscreen:"Disabled while in Picture-in-Picture",fullscreen:"Fullscreen",pictureInPicture:"Enter Picture-in-Picture",playingPictureInPicture:"Playing Picture-in-Picture",exitPictureInPicture:"Exit Picture-in-Picture",disabledPictureInPicture:"Disabled while in Fullscreen",keepWatching:"Keep Watching",learnMore:"Learn more",options:"Options",submit:"Submit",why:"Why?",diagnostics:"Diagnostics",nextTitle:"Next Episode",rateStreamingQualityOption:"Rate streaming quality",audioSettings:"Audio Settings",audio:"Audio",subtitles:"Subtitles",subtitlesExampleText:"This is a subtitles example.",subtitlesPresetText:"Aa",language:"Language",presets:"Presets",size:"Size",subtitlesAndAudio:"Subtitles and Audio",subtitlesSettings:"Subtitles Settings",pinModal:{title:"Viewing Restrictions Enabled",description:"Please enter your Prime Video PIN:",notes:"<a href=\"//{{resetPinUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">Reset your PIN</a> or <a href=\"//{{avSettingsUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">change viewing restrictions</a>",incorrectPin:"We don't recognize the PIN you entered. Please try again or <a href=\"//{{resetPinUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">reset your PIN.</a>"},auto:"Auto",hdVideoUnavailable:"HD Video Unavailable",hdcpMessage:"Your video will play in Standard Definition because your computer hardware, HDMI cables, and display must all meet content protection (HDCP) requirements for HD video. For more information, go to our <a href=\"//{{hdcpHelpUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">help section</a>.",hdcpMessageUnbranded:"Your video will play in Standard Definition because your computer hardware, HDMI cables, and display must all meet content protection (HDCP) requirements for HD video.",videoQuality:"Video Quality",videoQualityLearnMoreMessage:"Your video plays at the highest quality possible for your device and its available bandwidth. If HD isn’t possible, Standard Definition is streamed. To restrict the quality and data used, select SD for Standard Definition.",sd:"SD",toggleOn:"On",toggleOff:"Off",settings:"Settings",closedCaptionsShort:"CC",sdh:"SDH",nextUp:"Next Up",nextForYou:"Next for You",nextUpIn:"Next up in {{seconds}}",hide:"Hide",live:{indicator:"LIVE",jumpToLive:"Jump to Live"},avod:{advertisement:"Ad",countdown:"Your program resumes in {{seconds}} sec",countdownShort:"Ad - {{seconds}}",draperCaption:"We have selected this preview for you.",skipTimer:"Skip in {{seconds}} seconds...",skipButton:"Skip",watchlist:"Watchlist"},dataSaver:{good:{name:"Good",description:{sd:{default:"Uses about 0.38 GB per hour",hevc:"Uses about 0.38 GB per hour"},hd:{default:"Uses about 0.38 GB per hour",hevc:"Uses about 0.38 GB per hour"}}},better:{name:"Better",description:{sd:{default:"Uses about 0.86 GB per hour",hevc:"Uses about 0.86 GB per hour"},hd:{default:"Uses about 1.40 GB per hour",hevc:"Uses about 1.40 GB per hour"}}},best:{name:"Best",description:{sd:{default:"Uses about 1.17 GB per hour",hevc:"Uses about 1.17 GB per hour"},hd:{default:"Uses about 6.84 GB per hour",hevc:"Uses about 6.84 GB per hour"}}}},unavailable:"Unavailable",fastForwardUnavailable:"Fast forward unavailable",skip:{intro:"Skip Intro",recap:"Skip Recap"},ForceSdAssetError:"Your browser does not support High-Definition playback due to content restrictions. Please <a href=\"//{{systemRequirementsUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">update your browser</a> to get the best Prime Video experience.",ForceSdAssetErrorUnbranded:"Your browser does not support High-Definition playback due to content restrictions.",maturityRating:{rated:"Rated {{rating}}"},GenericError:{title:"Video Unavailable",default:"We're experiencing a problem playing this video. For assistance, please go to <a href=\"//{{videoHelpUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{videoHelpUrl}}</a>.",defaultUnbranded:"We're experiencing a problem playing this video.",Chrome:"We're experiencing a problem playing this video. For assistance, please go to <a href=\"//{{error7031Url}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{error7031Url}}</a>.",ChromeUnbranded:"We're experiencing a problem playing this video."},InternetConnectionError:"Your device's available Internet bandwidth is too low for uninterrupted streaming, or is experiencing intermittent connectivity. The video might pause while buffering.",PlayerStuckError:{title:"Streaming Delay",description:"This video is taking longer than expected to load. Do you want to continue waiting? If this problem continues, please contact Amazon Customer Service at <a href=\"//{{contactUsUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{contactUsUrl}}</a> and refer to error 7017.",descriptionUnbranded:"This video is taking longer than expected to load. Do you want to continue waiting? Error Code 7017."},ContentWarning:{title:"Live Content Information",description:"Live video programming might contain mature themes. You can set <a href=\"//{{pin}}\" target=\"_blank\" rel=\"noopener noreferrer\">Parental Controls</a> to manage which content can be shown.",descriptionUnbranded:"Live video programming might contain mature themes."},errors:{unknown:{title:"Video Unavailable",default:"We're experiencing a problem playing this video. For assistance, please go to <a href=\"//{{videoHelpUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{videoHelpUrl}}</a>.",defaultUnbranded:"We're experiencing a problem playing this video.",Chrome:"We're experiencing a problem playing this video. For assistance, please go to <a href=\"//{{error7031Url}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{error7031Url}}</a>.",ChromeUnbranded:"We're experiencing a problem playing this video."},web:{pinProtection:{pinAgeVerification:{title:"Viewing Restrictions Enabled",description:"To view this video, age verification is required."},pinSetupRequired:{title:"Viewing Restrictions Enabled",description:"To view this video, a PIN is required. To update your PIN, go to the Prime Video <a href=\"//{{setupPinUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">Settings page</a>."},pinValidationError:{title:"PIN Validation Problem",description:"We're having a problem validating your PIN. Please try again. If this problem continues, please <a href=\"//{{contactUsOrdersUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">contact Amazon Customer Service</a> and refer to error 5014."}}},xp:{unknown:{title:"Video Unavailable",default:"We're experiencing a problem playing this video. For assistance, please go to <a href=\"//{{videoHelpUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{videoHelpUrl}}</a>.",defaultUnbranded:"We're experiencing a problem playing this video.",Chrome:"We're experiencing a problem playing this video. For assistance, please go to <a href=\"//{{error7031Url}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{error7031Url}}</a>.",ChromeUnbranded:"We're experiencing a problem playing this video."},content:{concurrencyLimit:{title:"Maximum Streams Playing",description:"The maximum number of videos is playing on your account. To watch this video now, stop watching one of the videos playing on your account. It might take 10 minutes before you can begin watching on this device."},noRights:{unknown:{title:"Video Unavailable",description:"You don't own this video or have an active rental. Review your orders at <a href=\"//{{ordersUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{ordersUrl}}</a>. If you recently purchased, the payment method might have been declined. For rentals, the rental period might have expired. For further assistance, please contact Amazon Customer Service at <a href=\"//{{contactUsUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{contactUsUrl}}</a> and refer to error 7035.",descriptionUnbranded:"You don't own this video or have an active rental. If you recently purchased, the payment method might have been declined. For rentals, the rental period might have expired. Error Code 5002."},invalidGeoIp:{title:"Service Area Restriction",description:"This video isn't available due to geographical licensing restrictions. For more details, please refer to <a href=\"//{{termsOfUseUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">Prime Video Terms of Use</a>. For further assistance, please contact Amazon Customer Service at <a href=\"//{{videoHelpUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{videoHelpUrl}}</a> and refer to error 4601.",descriptionUnbranded:"This video isn't available due to geographical licensing restrictions. Error Code 5006."},noAvailableStreams:{title:"Maximum Streams Playing",description:"The maximum number of videos is playing on your account. To watch this video now, stop watching one of the videos playing on your account. It might take 10 minutes before you can begin watching on this device."},pvLowerTierDeviceNotPermittedAccess:{title:"Casting not allowed",description:"Your current subscription only allows watching in the Prime Video mobile app. To cast on this device, upgrade your subscription at <a href=\"//{{pvGoUpgradeUrl}}\" target=\"_blank\" rel=\"noopener noreferrer\">{{pvGoUpgradeUrl}}</a>."}}}}},xray:{close:"Close X-Ray",exitFullscreen:"Exit Fullscreen",fullscreen:"Fullscreen",navbar:{logo:"X-Ray"},photoGallery:{count:"{{current}} of {{total}}",exit:"Exit Gallery"},backText:"Back",textViewSeeMore:"Read More",textViewSeeLess:"Read Less",swiftErrorMessage:"We're unable to show this content. Please try again later."}},Nw=t(function(e,t){var a=V&&V.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("WebPlayerUI"),r={LiveStreaming:_P.ContentType.Live,Trailer:_P.ContentType.Trailer,Feature:_P.ContentType.VOD},i=function(){function e(e,t,n,r){void 0===e&&(e=document),void 0===t&&(t=Vn),void 0===n&&(n=Ld),void 0===r&&(r=null);var i=this;this.authContext={headers:{}},this.container=null,this.player=null,this.context=null,this.uiComponent=null,this.uiContainer=null,this.xrayController=null,this.onFullscreenStateChange=function(e){i.eventEmitter.emit("FullscreenChange",e)},this.onUiDisplayStatusChange=function(e){i.eventEmitter.emit("UIDisplayStatusChange",e)},this.documentRef=e,this.reactRef=t,this.reactDOMRef=n,null===r&&(r=new Dt.EventEmitter).setMaxListeners(20),this.eventEmitter=r}return e.prototype.attach=function(e,t){n.info("ATVWebPlayerUI version "+Fw.PackageVersion),(null==e.uiConfig||null!=e.uiConfig&&null==e.uiConfig.enableAmazonBranding)&&(e.uiConfig=a({},e.uiConfig,{enableAmazonBranding:e.requestedPlayerFeature!==ct.WebPlayerSDKFeatures.Player})),xt.exists(this.player)&&this.detach(),this.loadFonts(e.assetRoots[0]),this.uiContainer=this.documentRef.createElement("div"),this.uiContainer.className="webPlayerUIContainer",this.uiContainer.style.height="100%",this.uiContainer.style.width="100%",this.container=e.container,this.container.tabIndex=-1,this.container.appendChild(this.uiContainer),this.container.focus(),this.player=e.webPlayer,this.deviceProxyUrl=e.deviceProxyUrl,this.context=this.createContext(this.player,e),this.uiComponent=xt.exists(t)?t:this.createUIComponent(this.context),this.reactDOMRef.render(this.uiComponent,this.uiContainer),this.attachStoreEventListeners(),e.metricsReportingFeature.setDisplayMode("Embedded")},e.prototype.detach=function(){null!=this.context&&(this.detachStoreEventListeners(),this.context.stores.adPlayback.destroy(),this.context.stores.audioStream.destroy(),this.context.stores.bandwidthCapper.destroy(),this.context.stores.captions.destroy(),this.context.stores.contentWarning.destroy(),this.context.stores.error.destroy(),this.context.stores.fullscreen.destroy(),this.context.stores.gCast.destroy(),this.context.stores.hdcp.destroy(),this.context.stores.keyInput.destroy(),this.context.stores.lifecycle.destroy(),this.context.stores.maturityRatingStore.destroy(),this.context.stores.nextUpInfo.destroy(),this.context.stores.networkState.destroy(),this.context.stores.nextTitle.destroy(),this.context.stores.nextUpInfo.destroy(),this.context.stores.notifications.destroy(),this.context.stores.pictureInPicture.destroy(),this.context.stores.pin.destroy(),this.context.stores.passiveViewing.destroy(),this.context.stores.playback.destroy(),this.context.stores.playbackControlsPolicy.destroy(),this.context.stores.playerStuck.destroy(),this.context.stores.skipElement.destroy(),this.context.stores.timeline.destroy(),this.context.stores.title.destroy(),this.context.stores.trickplay.destroy(),this.context.stores.uiConfigurations.destroy(),this.context.stores.uiDisplayStatus.destroy(),this.context.stores.uiStatus.destroy(),this.context.stores.userActivity.destroy(),this.context.stores.videoStream.destroy(),this.context.stores.spinnerTimeout.destroy(),this.context.stores.modal.destroy(),null!==this.xrayController&&this.xrayController.destroy(),this.xrayController=null,this.reactDOMRef.unmountComponentAtNode(this.container),this.container.removeChild(this.uiContainer),this.container=null,this.player=null,this.uiComponent=null,this.uiContainer=null,this.authContext={headers:{}},this.context=null)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.isBlockingModalShowing=function(){return this.context.stores.modal.isBlockingModalShowing()||null!==this.context.stores.error.getCurrentError()},e.prototype.setLocale=function(e){null!==this.context&&null!==(e=Qt.Locales.getClosestLocale(e))&&this.context.stores.localization.setLanguage(e)},e.prototype.setVideoMaterialType=function(e){var t=r[e="Live"===e?"LiveStreaming":e];this.context.stores.captions.setVideoMaterialType(e),this.context.stores.pin.setContentType(t),this.context.stores.title.setContentType(t),this.context.stores.timeline.setContentType(t),this.context.stores.trickplay.setContentType(t),null!==this.xrayController&&this.xrayController.setVideoMaterialType(e)},e.prototype.setAuthContext=function(e){this.authContext=e,null!==this.context&&this.context.stores.pin.setAuthContext(e)},e.prototype.setClickstreamRefMarker=function(e){this.context.stores.nextTitle.setClickstreamRefMarker(e)},e.prototype.setContentMetadata=function(e,t){null!=this.context&&this.context.stores.contentMetadata.addContentMetadata(e,t)},e.prototype.arePlaybackControlsShowing=function(){return null!=this.context&&this.context.stores.uiDisplayStatus.isShowing()},e.prototype.createContext=function(e,t){var n=this,r=t.weblabs;this.authContext=t.authContext;var i=new Ce.AmazonUrlCreator(t.marketplaceId,Lw.CSUrlPathMap),o=this.createLocalizationStore(t.assetRoots[0],t.locale,t.uiConfig.enableAmazonBranding),a=new OP.ContentMetadataStore,s=new _w.UIConfigurationsStore(e,t.requestedPlayerFeature);null!=t.uiConfig&&s.updateUIConfigurations(t.uiConfig);var l=new NP.FullscreenStore(e,t.parentContainer,s,this.documentRef,t.clickstreamReporter);l.initialize(t.metricsReportingFeature);var u=t.requestedPlayerFeature===ct.WebPlayerSDKFeatures.GCastPlayer,c=new BP.GCastStore(e,u);c.initialize();var d=u?Gd.ContentState.Waiting:Gd.ContentState.Unloaded,p=new FP.ErrorStore(e,d,t.requestedPlayerFeature);p.initialize(i,o);var f=new tp.LockStore,h=new WP.NextUpInfoStore;h.initialize();var m=new fw.PlaybackStore(e,s,t.initialVolume);m.initialize();var y=new bw.TimelineInfoStore(e,m);y.initialize();var g=new Tw.TitleInfoStore(e,t.marketplaceId,a,s);g.initialize();var v=new Iw.TrickplayStore(e),S=s.getUIConfigurations();(S.enableSeekbar&&S.enableSeekbarTrickplay||S.enableXray)&&v.initialize(t.metricsReportingFeature);var b=new hw.PlaybackControlsPolicyStore(g,y,s);b.initialize();var T=new Ew.UserActivityStore(e,t.requestedPlayerFeature);T.initialize();var P=new kw.UserInterfaceStatusStore(f,e,p,s);P.initialize(t.metricsReportingFeature);var w=new qP.ModalStore(e,f,b,m,g,s,t.requestedPlayerFeature),C=new pw.PINStore(e,l,w,g,p,m,u,t.clickstreamReporter),M=new VP.HDCPStatusStore(e,w);M.initialize();var I=u?new UP.GCastBandwidthCapperStore(e,o,M):new wP.BandwidthCapperStore(e,o,M,t.clickstreamReporter);I.initialize();var E=new nw.NotificationsStore;E.initialize();var _=new ZP.NetworkStateStore(P,E);_.initialize();var x=new yw.PlayerStuckStore(e,w,P,this.documentRef);x.initialize();var k=new gP.AdPlaybackStore(e,l,w,_,x);k.initialize();var R=new rw.PassiveViewingStore(e,t.clientId,t.initialVolume);R.initialize();var A=new mw.PlayerScalingStore(t.parentContainer),O=new Ow.XrayHighlightModeStore,L=new LP.ContentWarningStore(e,w,g,s);L.initialize();var F=new Sw.SpinnerTimeoutStore(x,_,p,P),D=new Fp.BorgClient(t.deviceId,t.deviceTypeId,t.marketplaceId,this.deviceProxyUrl,t.locale);C.initialize(this.deviceProxyUrl,t.deviceId,t.deviceTypeId,t.marketplaceId,t.metricsReportingFeature,this.authContext);var N=new Qp.ServiceClientFactory(this.deviceProxyUrl,{deviceID:t.deviceId,deviceTypeID:t.deviceTypeId,marketplaceID:t.marketplaceId,gascEnabled:!Y.MarketplaceID.isClassic(t.marketplaceId)},{getHeaders:function(){return n.authContext.headers}}),U=N.createBasicServiceClient("/cdp/catalog/GetPlaybackResources",{firmware:"1"});S.enableXray&&this.createXrayController(e,t,o,r,N,A,O);var B=new TP.AudioStreamStore(e);B.initialize(o,t.metricsReportingFeature);var V=new AP.CaptionsStore(e,w,C,o,U,g,u,B);V.initialize(),w.initialize(V,function(){null!=n.container&&n.container.focus()});var j=new KP.NextTitleStore(e,h,y,g,s,t.marketplaceId,r,D,t.requestedPlayerFeature,t.clickstreamReporter);j.initialize(t.metricsReportingFeature);var X=new Aw.VideoStreamStore(e,I,E,P);X.initialize();var z=new gw.SkipElementStore(m,e);z.initialize(t.metricsReportingFeature);var q=new iw.PictureInPictureStore(e,t);q.initialize();var W=new jP.KeyInputStore(this.container,e,w,b,m,V,y,l,s,B,q),H=new DP.FeatureFocusStore(W,m),G=new XP.LifecycleStore(e,k,l,W,w,h,y,g,P,q);G.initialize(t.metricsReportingFeature),W.initialize(G);var K=new xw.UIDisplayStatusStore;K.initialize(),K.onDisplayStatusChange(this.onUiDisplayStatusChange);var Q=new zP.MaturityRatingStore(D,g);return Q.initialize(t.metricsReportingFeature),{amazonUrlCreator:i,stores:{adPlayback:k,audioStream:B,bandwidthCapper:I,captions:V,contentMetadata:a,contentWarning:L,error:p,featureFocus:H,fullscreen:l,gCast:c,hdcp:M,keyInput:W,lifecycle:G,localization:o,lock:f,maturityRatingStore:Q,modal:w,nextTitle:j,nextUpInfo:h,networkState:_,notifications:E,passiveViewing:R,pictureInPicture:q,pin:C,playback:m,playbackControlsPolicy:b,playerScaling:A,playerStuck:x,skipElement:z,spinnerTimeout:F,timeline:y,title:g,touchInput:new Pw.TouchInputStore,trickplay:v,uiConfigurations:s,uiDisplayStatus:K,uiStatus:P,userActivity:T,videoStream:X,xrayHighlightModeStore:O},weblabs:r}},e.prototype.createXrayController=function(e,t,n,r,i,o,a){var s={authContext:this.authContext,deviceId:t.deviceId,deviceTypeId:t.deviceTypeId,marketplaceId:t.marketplaceId},l=this.documentRef.createElement("link");l.href=t.assetRoots[0]+"css/ATVWebXrayInterface.css",l.rel="stylesheet",this.documentRef.head.appendChild(l),this.xrayController=new dP.XrayController(e,t.metricsReportingFeature,n,r,i,s,o,a),this.xrayController.initialize()},e.prototype.createLocalizationStore=function(r,e,t){var n=xt.withDefault(sp.QueryString.getParameter("playerCache"),!0),i=Qt.Locales.AvailableLocales.reduce(function(e,t){var n;return a({},e,((n={})[t]=t===Qt.Locales.EN_US?Dw:r+"languages/"+t+".json",n))},{}),o=new Qt.LocalizationStore(Fw.PackageVersion,"ATVWebPlayerUI",i,Qt.Locales.EN_US,n,t);return o.setLanguage(e),o},e.prototype.loadFonts=function(e){Vd.fontFace({fontFamily:"\"ATVWebPlayerSDK Amazon Ember\"",fontStyle:"normal",fontWeight:100,src:"url(\""+e+"fonts/AmazonEmber_Lt.woff\") format(\"woff\")"}),Vd.fontFace({fontFamily:"\"ATVWebPlayerSDK Amazon Ember\"",fontStyle:"normal",fontWeight:400,src:"url(\""+e+"fonts/AmazonEmber_Rg.woff\") format(\"woff\")"}),Vd.fontFace({fontFamily:"\"ATVWebPlayerSDK Amazon Ember\"",fontStyle:"normal",fontWeight:700,src:"url(\""+e+"fonts/AmazonEmber_Bd.woff\") format(\"woff\")"}),Vd.fontFace({fontFamily:"\"ATVWebPlayerSDK Amazon Ember\"",fontStyle:"normal",fontWeight:900,src:"url(\""+e+"fonts/AmazonEmber_He.woff\") format(\"woff\")"})},e.prototype.attachStoreEventListeners=function(){this.context.stores.fullscreen.onFullscreenStateChange(this.onFullscreenStateChange)},e.prototype.detachStoreEventListeners=function(){this.context.stores.fullscreen.offFullscreenStateChange(this.onFullscreenStateChange)},e}();t.WebPlayerUI=i});e(Nw);Nw.WebPlayerUI;var Uw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HideWhenPlayerSmall=Vd.media({maxWidth:"960px"},{visibility:"hidden"})});e(Uw);Uw.HideWhenPlayerSmall;var Bw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IfScreenExtraSmall=function(e){return Vd.media({maxWidth:Y.Styling.EXTRA_SMALL_SCREEN_MAX_WIDTH+"px"},e)},t.IfScreenSmall=function(e){return Vd.media({minWidth:Y.Styling.SMALL_SCREEN_MIN_WIDTH+"px"},e)},t.IfScreenMedium=function(e){return Vd.media({minWidth:Y.Styling.MEDIUM_SCREEN_MIN_WIDTH+"px"},e)},t.IfScreenLarge=function(e){return Vd.media({minWidth:Y.Styling.LARGE_SCREEN_MIN_WIDTH+"px"},e)},t.IfScreenExtraLarge=function(e){return Vd.media({minWidth:Y.Styling.EXTRA_LARGE_SCREEN_MIN_WIDTH+"px"},e)}});e(Bw);Bw.IfScreenExtraSmall,Bw.IfScreenSmall,Bw.IfScreenMedium,Bw.IfScreenLarge,Bw.IfScreenExtraLarge;var Vw=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Overlay=qS.styler({width:"100%",height:"100%",position:"absolute",pointerEvents:"none"}),t.EnableChildPointerEvents=qS.styler({$nest:{"& *":{pointerEvents:"auto"}}}),t.EnablePointerEvents=qS.styler({pointerEvents:"auto !important"})});e(Vw);Vw.Overlay,Vw.EnableChildPointerEvents,Vw.EnablePointerEvents;var jw=function(){function e(e,t){void 0===e&&(e=Date),this.dateConstructor=e,this.performanceRef=void 0===t&&"undefined"!=typeof performance?performance:t}return e.prototype.getHighResRelativeTimeMs=function(){return void 0===this.performanceRef?(new this.dateConstructor).getTime():this.performanceRef.now()},e}(),Xw=S.of("Time"),zw={TimeProvider:jw,millisecondsToHoursMinutesSeconds:function(e){if(e<=0)return{hours:0,minutes:0,seconds:0};if(e<=1e3)return{hours:0,minutes:0,seconds:1};var t=Math.floor(e/36e5),n=Math.floor(e%36e5/6e4),r=Math.round(e%6e4/1e3);return 60===r&&(r=0,60===++n&&(n=0,t++)),{hours:t,minutes:n,seconds:r}},unixTimestampToHoursMinutesSeconds:function(e){if(e<=0)return{hours:0,minutes:0,seconds:0};var t=new Date(e);return{hours:t.getHours(),minutes:t.getMinutes(),seconds:t.getSeconds()}},isoToMillis:function(e){if(Xw(e,"isoString").exists(),Xw(e).is.a.string(),Xw(3<e.length,"length > 3").is.true(),!new RegExp("^PT([0-9]*H)*([0-9]*M)*((?!0\\d)\\d*(\\.\\d+)?S)*$").test(e))throw new Error("Invalid ISO Time String passed into isoToMillis");var t=(e=e.substring(2)).indexOf("H"),n=e.indexOf("M"),r=e.indexOf("S"),i=0<t?Number(e.substring(0,t)):0,o=0<n?Number(e.substring(t+1,n)):0,a=0<r?Number(e.substring(Math.max(t,n)+1,r)):0;return Math.round(1e3*(60*i*60+60*o+a))},formatTime:function(e,t){void 0===t&&(t=!1),Xw(e,"hms").exists();var n=e.minutes<10?"0"+e.minutes:e.minutes.toString(),r=e.seconds<10?"0"+e.seconds:e.seconds.toString();return 0<e.hours||!0===t?e.hours+":"+n+":"+r:n+":"+r},dateTimeToString:function(e){var t=function(e,t){return(t+e).slice(-t.length)};return t(e.getFullYear(),"0000")+"-"+t(e.getMonth()+1,"00")+"-"+t(e.getDate(),"00")+" "+t(e.getHours(),"00")+":"+t(e.getMinutes(),"00")+":"+t(e.getSeconds(),"00")+"."+t(e.getMilliseconds(),"000")},extendedLimitedIso8601TimeFormatToMilliseconds:function(e){var t=e.match(/^(\d{2}):(\d{2}):(\d{2})(?:\.(\d{3}))?$/);if(null===t)throw new Error("Unsupported timestamp: "+e);var n=parseInt(t[1]),r=parseInt(t[2]),i=parseInt(t[3]),o=0;return t[4]&&(o=parseInt(t[4])),o+1e3*(i+60*(r+60*n))}},qw=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({color:qS.PrimaryColor,opacity:.8,$nest:{"&:hover":{opacity:1}}}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.mounted=!1,t.onTitleInfoUpdate=function(e){t.mounted&&t.setState({clickThroughUrl:e.clickThroughUrl||null})},t.onClickThroughClicked=function(){t.context.stores.adPlayback.clickThroughURLClicked()},t.state={clickThroughUrl:null},t}return i(e,n),e.prototype.componentDidMount=function(){this.mounted=!0,this.onTitleInfoUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoUpdate)},e.prototype.componentWillUnmount=function(){this.mounted=!1,this.context.stores.title.offUpdate(this.onTitleInfoUpdate)},e.prototype.render=function(){return null===this.state.clickThroughUrl?null:Vn.createElement("a",{className:o,href:this.state.clickThroughUrl,target:"_blank",onClick:this.onClickThroughClicked},this.context.stores.localization.getLocalization().learnMore)},e.contextType=QP.ReactContext,e}(Vn.Component);t.AdClickThroughURL=n});e(qw);qw.AdClickThroughURL;var Ww=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){return"data:image/svg+xml;base64,"+tb.encodeString(e)},r=function(){function e(){}return e.Back10s=n("<svg width=\"80\" height=\"85\" viewBox=\"0 0 80 85\" xmlns=\"http://www.w3.org/2000/svg\"><title>10s back</title><path d=\"M15.197 14.478l3.268 1.753C9.495 22.79 3.662 33.387 3.662 45.352c0 19.913 16.143 36.056 36.056 36.056 19.914 0 36.057-16.143 36.057-36.056 0-18.24-13.547-33.308-31.127-35.713v4.868s.008.968-.305 1.103c-.425.183-1.04-.224-1.04-.224L31.428 9.049s-.818-.386-.818-.74c0-.422.816-.797.816-.797L43.6.898s.368-.264.772-.048c.29.154.276.823.276.823V6.24c19.451 2.427 34.507 19.004 34.507 39.113 0 21.78-17.656 39.437-39.437 39.437-21.78 0-39.436-17.657-39.436-39.437 0-12.51 5.83-23.65 14.915-30.874\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),e.Checkmark=n("<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 19.67 14.33\"><defs><style>.a{fill:#fff}</style></defs><title>checkmark</title><path class=\"a\" d=\"M7.108 14.18l-1.425-1.405L18.163.111l1.425 1.404z\"/><path class=\"a\" d=\"M8.483 12.788l-1.404 1.424L.134 7.37l1.404-1.425z\"/></svg>"),e.Close=n("<svg width=\"25\" height=\"25\" viewBox=\"0 0 25 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>close</title><path d=\"M24.805 2.318L22.682.197 12.5 10.379 2.318.197.197 2.318 10.379 12.5.197 22.682l2.121 2.121L12.5 14.621l10.182 10.182 2.121-2.121L14.621 12.5 24.805 2.318z\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),e.Error=n("<svg width=\"76\" height=\"76\" viewBox=\"0 0 76 76\" xmlns=\"http://www.w3.org/2000/svg\"><title>Artboard</title><path d=\"M71.804 59.668c2.474 4.37-.617 9.832-5.565 9.832H11.186c-4.948 0-8.039-5.462-5.565-9.832l27.526-48.64c2.473-4.37 8.658-4.37 11.13 0l27.527 48.64zM41.8 46.934V28.259a3.021 3.021 0 0 0-3.012-3.013h-.151a3.021 3.021 0 0 0-3.012 3.013v18.675a3.02 3.02 0 0 0 3.012 3.012h.151a3.02 3.02 0 0 0 3.012-3.012zm-6.175 7.129v6.299H41.8v-6.3h-6.175z\" fill=\"#F2F4F6\" fill-rule=\"evenodd\" opacity=\".7\"/></svg>"),e.ExitFullscreen=n("<svg width=\"29\" height=\"27\" viewBox=\"0 0 29 27\" xmlns=\"http://www.w3.org/2000/svg\"><title>browser copy</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M9.984 15h-6l.001 3h3.753L.867 24.871l2.122 2.121 6.995-6.996V24h3v-8.999l-3-.001zM21.262 9l6.871-6.871L26.012.008l-6.996 6.996V3h-3v8.999l3 .001h6V9h-3.754z\"/></g></svg>"),e.Forward10s=n("<svg width=\"80\" height=\"85\" viewBox=\"0 0 80 85\" xmlns=\"http://www.w3.org/2000/svg\"><title>10s forward</title><path d=\"M64.24 14.478l-3.269 1.753c8.972 6.559 14.804 17.156 14.804 29.121 0 19.913-16.143 36.056-36.057 36.056-19.913 0-36.056-16.143-36.056-36.056 0-18.24 13.547-33.308 31.127-35.713v4.868s-.008.968.305 1.103c.425.183 1.04-.224 1.04-.224L48.01 9.049s.818-.386.818-.74c0-.422-.817-.797-.817-.797L35.837.898s-.369-.264-.772-.048c-.29.154-.276.823-.276.823V6.24C15.337 8.666.282 25.243.282 45.352c0 21.78 17.656 39.437 39.436 39.437s39.437-17.657 39.437-39.437c0-12.51-5.831-23.65-14.915-30.874\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),e.Fullscreen=n("<svg width=\"25\" height=\"25\" viewBox=\"0 0 25 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>fullscreen</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M24.969.002V0h-3v.002l-6-.002v3h3.754l-5.871 5.871 2.121 2.121 5.996-5.996V9h3V.002zM9 22H5.246l5.871-5.871-2.121-2.121L3 20.004V16H0v9h9v-3z\"/></g></svg>"),e.ModalCloseOver=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 15 15\"><path opacity=\".8\" fill=\"#FFF\" d=\"M15 1.293L13.706 0 7.5 6.207 1.292 0 0 1.293 6.207 7.5 0 13.705l1.292 1.293L7.5 8.793l6.207 6.205L15 13.705 8.792 7.5 15 1.293z\"/></svg>"),e.ModalCloseUp=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 15 15\"><path opacity=\".8\" fill=\"#CDCCCC\" d=\"M15 1.293L13.706 0 7.5 6.207 1.292 0 0 1.293 6.207 7.5 0 13.705l1.292 1.293L7.5 8.793l6.207 6.205L15 13.705 8.792 7.5 15 1.293z\"/></svg>"),e.Options=n("<svg width=\"27\" height=\"27\" viewBox=\"0 0 27 27\" xmlns=\"http://www.w3.org/2000/svg\"><title>Group 5</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M13.5 24C19.299 24 24 19.299 24 13.5S19.299 3 13.5 3 3 7.701 3 13.5 7.701 24 13.5 24zm0-3a7.5 7.5 0 1 0 0-15 7.5 7.5 0 0 0 0 15z\"/><path d=\"M11.88 0h3.24l1.08 4.32h-5.4zM27 11.88v3.24l-4.32 1.08v-5.4zM0 11.88v3.24l4.32 1.08v-5.4zM5.512 2.734L3.26 5.064l2.357 3.779L9.37 4.958zM21.488 2.734l2.251 2.33-2.357 3.779-3.751-3.885zM5.512 24.266l-2.251-2.33 2.357-3.779 3.751 3.885zM21.488 24.266l2.251-2.33-2.357-3.779-3.751 3.885zM11.88 27h3.24l1.08-4.32h-5.4z\"/></g></svg>"),e.Pause=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"75\" height=\"95\" viewBox=\"0 0 75 95\"><path fill=\"#FFF\" d=\"M0 0h25v95H0zM50 0h25v95H50z\"/></svg>"),e.PauseGCast=n("<svg width=\"76\" height=\"76\" viewBox=\"0 0 76 76\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>Artboard</title><defs><path d=\"M33.25 0a4.75 4.75 0 0 0-4.75 4.75v53.833a4.752 4.752 0 0 0 4.75 4.75 4.752 4.752 0 0 0 4.75-4.75V4.75A4.75 4.75 0 0 0 33.25 0M9.5 4.75v53.833a4.75 4.75 0 1 1-9.5 0V4.75A4.748 4.748 0 0 1 4.75 0 4.748 4.748 0 0 1 9.5 4.75\" id=\"a\"/></defs><use fill=\"#F2F4F6\" xlink:href=\"#a\" transform=\"translate(19 6)\" fill-rule=\"evenodd\" opacity=\".7\"/></svg>"),e.PhoneToTV=n("<svg width=\"149\" height=\"50\" viewBox=\"0 0 149 50\" xmlns=\"http://www.w3.org/2000/svg\"><title>Group 3 Copy</title><g fill=\"none\" fill-rule=\"evenodd\"><path d=\"M.208 2.64c0-1.23.914-2.228 2.042-2.228h24.5c1.128 0 2.042.998 2.042 2.228v44.545c0 1.23-.914 2.227-2.042 2.227H2.25c-1.128 0-2.042-.997-2.042-2.227V2.64zM14.5 47.37a2.042 2.042 0 1 0 0-4.083 2.042 2.042 0 0 0 0 4.084zM24.708 4.497H4.292v36.75h20.416V4.496z\" opacity=\".7\" fill=\"#F2F4F6\"/><g transform=\"translate(37 22.56)\" fill=\"#D8D8D8\"><ellipse fill-opacity=\".2\" cx=\"3\" cy=\"3.02\" rx=\"3\" ry=\"3.02\"/><ellipse fill-opacity=\".4\" cx=\"13\" cy=\"3.02\" rx=\"3\" ry=\"3.02\"/><ellipse fill-opacity=\".6\" cx=\"23\" cy=\"3.02\" rx=\"3\" ry=\"3.02\"/><ellipse fill-opacity=\".8\" cx=\"33\" cy=\"3.02\" rx=\"3\" ry=\"3.02\"/></g><g opacity=\".7\" stroke=\"#F2F4F6\" stroke-width=\"4\"><path d=\"M107.739 42.056v4.85M123.261 42.056v4.85\"/><path d=\"M97.552 47.392h35.896\" stroke-linecap=\"round\"/><path stroke-linejoin=\"round\" d=\"M84.94 40.115h61.12V2.28H84.94z\"/></g></g></svg>"),e.PictureInPicture=n("<svg width=\"80\" height=\"80\" viewBox=\"0 0 80 80\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><rect opacity=\".5\" x=\"1\" y=\"11\" width=\"78\" height=\"58\" rx=\"5\" stroke=\"#F2F4F6\" stroke-width=\"2\"/><rect x=\"39\" y=\"38\" width=\"35\" height=\"26\" rx=\"3.333\" fill=\"#fff\"/></svg>"),e.PictureInPictureEnter=n("<svg width=\"29\" height=\"29\" viewBox=\"0 0 25 25\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><mask id=\"a\" maskUnits=\"userSpaceOnUse\" x=\"0\" y=\"0\" width=\"25\" height=\"25\"><path fill=\"#FFF\" d=\"M0 0h24v24H0V0z\"/></mask><g mask=\"url(#a)\"><path opacity=\".6\" stroke=\"#FFF\" stroke-width=\"2\" d=\"M2 4h20a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1z\"/><path fill=\"#FFF\" d=\"M13 11h6a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-6a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1z\"/></g></svg>"),e.PictureInPictureExit=n("<svg width=\"29\" height=\"29\" viewBox=\"0 0 25 25\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><mask id=\"a\" maskUnits=\"userSpaceOnUse\" x=\"0\" y=\"0\" width=\"25\" height=\"25\"><path fill=\"#FFF\" d=\"M0 0h24v24H0V0z\"/></mask><g mask=\"url(#a)\"><path stroke=\"#FFF\" stroke-width=\"2\" d=\"M2 4h20a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1z\"/><path opacity=\".6\" fill=\"#FFF\" d=\"M13 11h6a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-6a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1z\"/></g></svg>"),e.Play=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"90\" height=\"90\" viewBox=\"0 0 90 90\"><path fill=\"#FFF\" d=\"M88.164 42.761c2.447 1.237 2.447 3.241 0 4.478L4.434 89.514C1.985 90.75 0 89.547 0 86.83V3.169C0 .45 1.985-.751 4.434.486l83.73 42.275z\"/></svg>"),e.PlayGCast=n("<svg width=\"76\" height=\"76\" viewBox=\"0 0 76 76\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>Artboard</title><defs><path d=\"M5.575 1.43C2.83-.147.583 1.152.583 4.319v54.697c0 3.167 2.247 4.466 4.992 2.887l47.593-27.365c2.745-1.58 2.745-4.162 0-5.74L5.575 1.43z\" id=\"a\"/></defs><use fill=\"#F2F4F6\" xlink:href=\"#a\" transform=\"translate(10 7)\" fill-rule=\"evenodd\" opacity=\".7\"/></svg>"),e.Plus=n("<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\"><defs><style>.a{fill:#fff}</style></defs><title>plus</title><path class=\"a\" d=\"M9.23.13h1.8v20h-1.8z\"/><path class=\"a\" d=\"M.12 11.02v-1.8h20v1.8z\"/></svg>"),e.PrimeVideoLogo=n("<svg width=\"160\" height=\"50\" viewBox=\"0 0 160 50\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>Logos/prime-brand Copy 10</title><defs><path id=\"a\" d=\"M.134.167h5.129v22.685H.133z\"/><path id=\"c\" d=\"M.174.103h76.052v18.4H.174z\"/><path id=\"e\" d=\"M.102.167h5.129v22.685H.102z\"/></defs><g fill=\"none\" fill-rule=\"evenodd\"><path d=\"M138.287 11.755c0-1.483-1.05-1.908-2.343-1.908-.851 0-1.676.306-2.239.92-.549.598-.888 1.509-1.032 2.653 0 0 2.288.414 3.942.142.859-.142 1.672-.617 1.672-1.807M136.43 23.15c-2.487 0-4.38-.579-5.901-2.12-.998-1.012-1.939-2.89-1.939-6.108 0-2.595.825-4.578 2.169-6.017 1.343-1.44 3.394-2.115 5.333-2.115 2.421 0 3.857.548 4.956 1.643a4.543 4.543 0 0 1 1.285 3.143c0 .629.02 1.28-.413 2.193-.294.618-.738 1.005-.855 1.112-1.8 1.641-5.33 1.532-6.523 1.465l-1.933-.293c.127 1.334.502 2.381 1.322 2.977.771.56 1.617.795 3.345.795.866 0 2.022-.172 3.508-.558.08-.021.235-.06.29-.069a.705.705 0 0 1 .28.013c.164.055.347.21.347.65v1.399c0 .324-.036.552-.128.684s-.274.26-.539.36c-1.547.568-2.99.846-4.604.846M92.004 22.665a1.42 1.42 0 0 1-.504-.076.79.79 0 0 1-.336-.243 1.801 1.801 0 0 1-.26-.471l-5.22-13.532a11.718 11.718 0 0 1-.152-.426 1.047 1.047 0 0 1-.061-.335c0-.304.203-.456.61-.456h3.053c.325 0 .565.061.718.183.152.121.27.324.35.608l3.145 10.765 3.206-10.765c.08-.284.198-.487.35-.608.154-.122.392-.183.718-.183h2.961c.407 0 .611.152.611.456 0 .102-.02.213-.06.335-.042.121-.092.264-.154.426l-5.22 13.532c-.082.203-.168.36-.26.471a.814.814 0 0 1-.32.243c-.122.051-.295.076-.52.076h-2.655z\" fill=\"#F5F5F5\"/><g transform=\"translate(102.62 -.186)\"><mask id=\"b\" fill=\"#fff\"><use xlink:href=\"#a\"/></mask><path d=\"M1.233 22.852c-.265 0-.458-.061-.58-.183-.122-.121-.183-.314-.183-.577V8.072c0-.283.06-.48.183-.592.122-.111.315-.167.58-.167h2.93c.285 0 .484.056.596.167.112.111.168.31.168.593v14.019c0 .263-.056.456-.168.577-.112.122-.31.183-.595.183H1.233zM2.698 4.91c-.773 0-1.394-.213-1.862-.638C.368 3.846.134 3.268.134 2.538S.368 1.231.836.805C1.304.379 1.925.166 2.698.166c.774 0 1.394.213 1.863.639.467.426.702 1.004.702 1.733 0 .73-.235 1.308-.702 1.734-.469.425-1.09.638-1.863.638z\" fill=\"#F5F5F5\" mask=\"url(#b)\"/></g><path d=\"M118.348 19.655c.977 0 1.913-.284 2.809-.852v-8.028c-.875-.506-1.883-.76-3.022-.76-1.08 0-1.883.4-2.412 1.201-.53.801-.794 2.012-.794 3.634 0 1.622.28 2.828.84 3.619.56.79 1.42 1.186 2.58 1.186M116.882 23c-1.323 0-2.473-.34-3.45-1.019-.977-.679-1.725-1.621-2.244-2.828-.519-1.206-.778-2.6-.778-4.181 0-2.514.6-4.526 1.801-6.036 1.2-1.51 2.788-2.266 4.762-2.266 1.608 0 3.002.456 4.183 1.368V.923c0-.284.061-.482.183-.593.122-.112.315-.168.58-.168h2.93c.286 0 .484.056.596.168.112.111.168.309.168.593v20.982c0 .264-.056.456-.168.578-.112.122-.31.182-.595.182h-2.442c-.245 0-.433-.05-.565-.152-.133-.1-.23-.273-.29-.517l-.183-.699c-1.263 1.136-2.758 1.703-4.488 1.703M152.174 19.716c2.137 0 3.205-1.612 3.205-4.835 0-3.203-1.068-4.805-3.205-4.805s-3.206 1.602-3.206 4.805c0 3.223 1.069 4.835 3.206 4.835m0 3.406c-2.423 0-4.315-.725-5.679-2.175-1.363-1.449-2.045-3.471-2.045-6.066 0-2.575.682-4.587 2.045-6.037 1.364-1.449 3.256-2.174 5.679-2.174 2.421 0 4.314.725 5.678 2.174 1.363 1.45 2.045 3.462 2.045 6.037 0 2.595-.682 4.617-2.045 6.066-1.364 1.45-3.257 2.175-5.678 2.175\" fill=\"#F5F5F5\"/><g transform=\"translate(38.4 30.875)\"><mask id=\"d\" fill=\"#fff\"><use xlink:href=\"#c\"/></mask><path d=\"M.174.71v.25c.032.212.144.44.358.646 10.89 10.554 25.276 16.896 41.251 16.896 11.4 0 24.639-3.848 33.77-11.08 1.51-1.203.218-2.994-1.325-2.293-10.237 4.662-21.36 6.919-31.485 6.919-15.001 0-29.529-4.42-41.272-11.755a1.127 1.127 0 0 0-.59-.19.7.7 0 0 0-.707.607\" fill=\"#F5F5F5\" mask=\"url(#d)\"/></g><path d=\"M106.642 32.256c-.325.246-.496.525-.526.765v.15c.038.276.296.462.752.404 2.939-.378 9.493-1.217 10.66.385 1.169 1.6-1.298 8.195-2.4 11.133-.33.885.383 1.25 1.133.572 4.901-4.38 6.166-13.564 5.16-14.888-.479-.635-2.728-1.229-5.512-1.229-2.977 0-6.567.678-9.267 2.708M7.449 19.655c1.14 0 1.98-.385 2.518-1.156.54-.77.81-1.986.81-3.649 0-1.682-.265-2.909-.794-3.68-.53-.77-1.374-1.155-2.534-1.155a5.831 5.831 0 0 0-2.992.821v7.998c.896.547 1.893.82 2.992.82zM.763 28.93c-.265 0-.458-.056-.58-.168C.061 28.651 0 28.453 0 28.17V7.886c0-.283.061-.481.183-.593.122-.11.315-.167.58-.167h2.198c.468 0 .753.223.855.67l.214.79c.61-.588 1.348-1.054 2.213-1.399a7.083 7.083 0 0 1 2.64-.517c1.975 0 3.537.72 4.687 2.16 1.15 1.439 1.725 3.385 1.725 5.838 0 1.683-.285 3.152-.855 4.41-.57 1.256-1.343 2.224-2.32 2.903-.977.68-2.097 1.019-3.358 1.019a7.162 7.162 0 0 1-2.382-.395c-.753-.264-1.394-.629-1.923-1.095v6.66c0 .283-.056.48-.168.592-.112.112-.31.168-.595.168H.764zM18.989 22.665c-.265 0-.458-.06-.58-.182-.122-.122-.183-.314-.183-.578V7.886c0-.283.06-.481.183-.593.122-.11.315-.167.58-.167h2.198c.468 0 .752.223.855.67l.396 1.641c.814-.892 1.582-1.525 2.305-1.9a4.934 4.934 0 0 1 2.305-.563h.428c.284 0 .488.056.61.167.122.112.183.31.183.593v2.555c0 .263-.056.456-.168.578-.112.121-.31.182-.595.182-.142 0-.326-.01-.55-.03a9.933 9.933 0 0 0-.854-.03c-.469 0-1.038.065-1.71.197-.672.132-1.241.3-1.71.502v10.217c0 .264-.056.456-.167.578-.113.122-.311.182-.596.182h-2.93z\" fill=\"#F5F5F5\"/><g transform=\"translate(29.793 -.186)\"><mask id=\"f\" fill=\"#fff\"><use xlink:href=\"#e\"/></mask><path d=\"M1.201 22.852c-.264 0-.458-.061-.58-.183-.122-.121-.183-.314-.183-.577V8.072c0-.283.061-.48.183-.592.122-.111.316-.167.58-.167h2.931c.285 0 .483.056.595.167.112.111.168.31.168.593v14.019c0 .263-.056.456-.168.577-.112.122-.31.183-.595.183h-2.93zM2.667 4.91c-.774 0-1.395-.213-1.863-.638C.336 3.846.102 3.268.102 2.538S.336 1.231.804.805C1.272.379 1.893.166 2.667.166c.773 0 1.393.213 1.862.639.468.426.702 1.004.702 1.733 0 .73-.234 1.308-.702 1.734-.469.425-1.09.638-1.862.638z\" fill=\"#F5F5F5\" mask=\"url(#f)\"/></g><path d=\"M39.168 22.665c-.264 0-.458-.06-.58-.182-.122-.122-.183-.314-.183-.578V7.886c0-.283.061-.481.183-.593.122-.11.316-.167.58-.167h2.198c.468 0 .753.223.855.67l.244.82c1.079-.71 2.05-1.211 2.916-1.505a8.253 8.253 0 0 1 2.671-.441c1.832 0 3.124.65 3.877 1.946 1.038-.689 2.015-1.186 2.931-1.49a8.951 8.951 0 0 1 2.84-.456c1.424 0 2.528.395 3.312 1.186.783.79 1.175 1.896 1.175 3.315v10.734c0 .264-.056.456-.168.578-.112.122-.31.182-.595.182h-2.931c-.265 0-.458-.06-.58-.182-.122-.122-.183-.314-.183-.578v-9.761c0-1.379-.621-2.068-1.862-2.068-1.1 0-2.209.263-3.328.79v11.04c0 .263-.056.455-.168.577-.112.122-.31.182-.595.182h-2.931c-.265 0-.458-.06-.58-.182-.122-.122-.183-.314-.183-.578v-9.761c0-1.379-.621-2.068-1.863-2.068-1.14 0-2.259.274-3.358.82v11.01c0 .263-.056.455-.168.577-.112.122-.31.182-.595.182h-2.93zM74.519 11.755c0-1.483-1.05-1.908-2.343-1.908-.85 0-1.675.306-2.238.92-.55.598-.888 1.509-1.032 2.653 0 0 2.288.414 3.942.142.858-.142 1.671-.617 1.671-1.807M72.664 23.15c-2.488 0-4.38-.579-5.902-2.12-.998-1.012-1.938-2.89-1.938-6.108 0-2.595.825-4.578 2.168-6.017 1.343-1.44 3.395-2.115 5.333-2.115 2.422 0 3.857.548 4.956 1.643a4.544 4.544 0 0 1 1.285 3.143c0 .629.02 1.28-.413 2.193-.293.618-.737 1.005-.854 1.112-1.801 1.641-5.33 1.532-6.524 1.465l-1.932-.293c.126 1.334.502 2.381 1.321 2.977.772.56 1.617.795 3.345.795.867 0 2.022-.172 3.508-.558.08-.021.236-.06.29-.069a.704.704 0 0 1 .281.013c.163.055.347.21.347.65v1.399c0 .324-.037.552-.128.684-.092.132-.275.26-.539.36-1.547.568-2.991.846-4.604.846\" fill=\"#F5F5F5\"/></g></svg>"),e.RateYourExperienceIcon=n("<svg width=\"48\" height=\"48\" viewBox=\"0 0 48 48\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>emoji-good-up</title><defs><circle id=\"a\" cx=\"24\" cy=\"24\" r=\"24\"/><mask id=\"b\" x=\"0\" y=\"0\" width=\"48\" height=\"48\" fill=\"#fff\"><use xlink:href=\"#a\"/></mask></defs><g fill=\"none\" fill-rule=\"evenodd\"><use stroke=\"#F9F9F9\" mask=\"url(#b)\" stroke-width=\"4\" xlink:href=\"#a\"/><path d=\"M34.603 33.477C31.772 36.284 28.006 37.83 24 37.83c-4.005 0-7.77-1.545-10.602-4.352a1.162 1.162 0 0 0-1.631 0 1.134 1.134 0 0 0 0 1.616c3.267 3.238 7.612 5.022 12.233 5.022 4.622 0 8.966-1.784 12.234-5.022.45-.446.45-1.169 0-1.616a1.162 1.162 0 0 0-1.63 0\" fill=\"#FFF\"/><g transform=\"translate(13.714 17.143)\" fill=\"#FFF\"><circle cx=\"18.286\" cy=\"2.286\" r=\"2.286\"/><circle cx=\"2.286\" cy=\"2.286\" r=\"2.286\"/></g></g></svg>"),e.RightArrow=n("<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"8.484\" height=\"14.141\" viewBox=\"0 0 8.484 14.141\"><path fill=\"#FFF\" d=\"M7.07 5.656L1.414 0 0 1.414 5.656 7.07 0 12.727l1.414 1.414L7.07 8.484 8.484 7.07z\"/></svg>"),e.SubtitlesAndAudio=n("<svg width=\"30\" height=\"27\" viewBox=\"0 0 30 27\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>Page 1</title><defs><path d=\"M0 3c0-1.688 1.236-3 3-3h24c1.764 0 3 1.312 3 3v16c0 1.688-1.236 3-3 3H3c-1.764 0-3-1.312-3-3V3z\" id=\"a\"/><mask id=\"b\" x=\"0\" y=\"0\" width=\"30\" height=\"22\" fill=\"#fff\"><use xlink:href=\"#a\"/></mask></defs><g fill=\"none\" fill-rule=\"evenodd\"><use stroke=\"#FFF\" mask=\"url(#b)\" stroke-width=\"4\" stroke-linecap=\"square\" xlink:href=\"#a\"/><path fill=\"#FFF\" d=\"M23 27l-5-5h5zM5 13h20v1H5zM7 16h16v1H7z\"/></g></svg>"),e.SubtitlesAndAudioDark=n("<svg width=\"30\" height=\"28\" viewBox=\"0 0 30 28\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>Artboard Copy</title><defs><path d=\"M11.428 21.942h15.043c.974 0 1.764-.783 1.764-1.75V3.5c0-.966-.79-1.75-1.764-1.75H3.529c-.974 0-1.764.784-1.764 1.75v16.692c0 .967.79 1.75 1.764 1.75h4.236v2.63l3.663-2.63zM3.53 0h22.942C28.42 0 30 1.567 30 3.5v16.692c0 1.933-1.58 3.5-3.53 3.5H12L6 28v-4.308H3.53c-1.95 0-3.53-1.567-3.53-3.5V3.5C0 1.567 1.58 0 3.53 0z\" id=\"a\"/><path d=\"M7.059 13.125a.879.879 0 0 1-.883-.875c0-.483.396-.875.883-.875H22.94c.487 0 .883.392.883.875a.879.879 0 0 1-.883.875H7.06zm1.765 3.5a.879.879 0 0 1-.883-.875c0-.483.395-.875.883-.875h12.352c.488 0 .883.392.883.875a.879.879 0 0 1-.883.875H8.824z\" id=\"b\"/></defs><g fill=\"none\" fill-rule=\"evenodd\"><use fill=\"#8197A4\" fill-rule=\"nonzero\" xlink:href=\"#a\"/><mask id=\"c\" fill=\"#fff\"><use xlink:href=\"#b\"/></mask><circle fill=\"#8197A4\" mask=\"url(#c)\" cx=\"13.794\" cy=\"14\" r=\"12.5\"/></g></svg>"),e.Volume0Bars=n("<svg width=\"34\" height=\"25\" viewBox=\"0 0 34 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>volume_0bars</title><path d=\"M6.848 6.306H1.72C.211 6.306 0 6.511 0 7.977v9.045c0 1.466.211 1.672 1.72 1.672h5.13l8.702 6.006c.799.592 1.448.28 1.448-.697V.997c0-.977-.65-1.29-1.449-.697L6.848 6.306z\" fill=\"#FFF\" fill-rule=\"evenodd\"/></svg>"),e.Volume1Bar=n("<svg width=\"34\" height=\"25\" viewBox=\"0 0 34 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>volume_1bar</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M6.848 6.306H1.72C.211 6.306 0 6.511 0 7.977v9.045c0 1.466.211 1.672 1.72 1.672h5.13l8.702 6.006c.799.592 1.448.28 1.448-.697V.997c0-.977-.65-1.29-1.449-.697L6.848 6.306zM23.388 12.4a8.01 8.01 0 0 1-2.088 5.39l1.08.837a9.355 9.355 0 0 0 2.381-6.228 9.35 9.35 0 0 0-2.381-6.228l-1.08.837a8.02 8.02 0 0 1 2.088 5.391z\"/></g></svg>"),e.Volume2Bars=n("<svg width=\"34\" height=\"25\" viewBox=\"0 0 34 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>volume_2bars</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M6.848 6.306H1.72C.211 6.306 0 6.511 0 7.977v9.045c0 1.466.211 1.672 1.72 1.672h5.13l8.702 6.006c.799.592 1.448.28 1.448-.697V.997c0-.977-.65-1.29-1.449-.697L6.848 6.306zM23.388 12.4a8.01 8.01 0 0 1-2.088 5.39l1.08.837a9.355 9.355 0 0 0 2.381-6.228 9.35 9.35 0 0 0-2.381-6.228l-1.08.837a8.02 8.02 0 0 1 2.088 5.391z\"/><path d=\"M27.508 12.4c0 3.004-1.244 5.723-3.249 7.685l1.083.84c2.186-2.196 3.538-5.204 3.538-8.525 0-3.32-1.352-6.33-3.538-8.526l-1.083.842a10.714 10.714 0 0 1 3.25 7.684z\"/></g></svg>"),e.Volume3Bars=n("<svg width=\"34\" height=\"25\" viewBox=\"0 0 34 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>volume_3bars</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M6.848 6.306H1.72C.211 6.306 0 6.511 0 7.977v9.045c0 1.466.211 1.672 1.72 1.672h5.13l8.702 6.006c.799.592 1.448.28 1.448-.697V.997c0-.977-.65-1.29-1.449-.697L6.848 6.306zM31.627 12.4c0 3.941-1.718 7.477-4.446 9.953l1.095.846C31.178 20.485 33 16.657 33 12.4s-1.822-8.085-4.725-10.8l-1.095.848c2.728 2.475 4.447 6.011 4.447 9.952zM23.388 12.4a8.01 8.01 0 0 1-2.088 5.39l1.08.837a9.355 9.355 0 0 0 2.381-6.228 9.35 9.35 0 0 0-2.381-6.228l-1.08.837a8.02 8.02 0 0 1 2.088 5.391z\"/><path d=\"M27.508 12.4c0 3.004-1.244 5.723-3.249 7.685l1.083.84c2.186-2.196 3.538-5.204 3.538-8.525 0-3.32-1.352-6.33-3.538-8.526l-1.083.842a10.714 10.714 0 0 1 3.25 7.684z\"/></g></svg>"),e.VolumeMute=n("<svg width=\"34\" height=\"25\" viewBox=\"0 0 34 25\" xmlns=\"http://www.w3.org/2000/svg\"><title>volume_mute</title><g fill=\"#FFF\" fill-rule=\"evenodd\"><path d=\"M6.848 6.306H1.72C.211 6.306 0 6.511 0 7.977v9.045c0 1.466.211 1.672 1.72 1.672h5.13l8.702 6.006c.799.592 1.448.28 1.448-.697V.997c0-.977-.65-1.29-1.449-.697L6.848 6.306z\"/><path d=\"M33.084 7.88l-1.422-1.422-4.619 4.62-4.62-4.62L21 7.88l4.62 4.619-4.62 4.62 1.422 1.423 4.621-4.62 4.62 4.62 1.421-1.422-4.618-4.621 4.618-4.619z\" opacity=\".4\"/></g></svg>"),e}();t.SVG=r});e(Ww);Ww.SVG;var Hw=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({color:qS.PrimaryColor,opacity:.8,cursor:"pointer",$nest:{"&:hover":{opacity:1}}}),a=qS.styler({display:"inline-block",position:"relative"},qS.ScalableWidth(11),qS.ScalableHeight(11),qS.ScalableMarginRight(5)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onAddToWatchlistClicked=function(){t.state.addedToWatchlist||(t.setState({addedToWatchlist:!0}),t.context.stores.adPlayback.addToWatchlistClicked())},t.state={addedToWatchlist:!1},t}return i(e,n),e.prototype.render=function(){return Vn.createElement("div",{className:o,onClick:this.onAddToWatchlistClicked},Vn.createElement("div",{className:a},Vn.createElement(wb.SVGImage,{src:this.state.addedToWatchlist?Ww.SVG.Checkmark:Ww.SVG.Plus})),this.context.stores.localization.getLocalization().avod.watchlist)},e.contextType=QP.ReactContext,e}(Vn.Component);t.AddToWatchlist=n});e(Hw);Hw.AddToWatchlist;var Gw=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({color:qS.PrimaryColor,opacity:.5}),a=qS.styler({opacity:.8,cursor:"pointer",$nest:{"&:hover":{opacity:1}}}),s=qS.styler({display:"inline-block",position:"relative"},qS.ScalableWidth(5),qS.ScalableHeight(9),qS.ScalableMarginLeft(5)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onAdSkipButtonClicked=function(){t.state.isSkippable&&t.context.stores.adPlayback.skipClicked()},t.state={isSkippable:null,remainingDurationBeforeSkippableSeconds:null},t}return i(e,n),e.prototype.componentWillReceiveProps=function(e){var t=Math.max(e.skipOffsetMs-(e.adPositionMs-e.adStartPositionMs),0)/1e3;this.setState({isSkippable:t<=0,remainingDurationBeforeSkippableSeconds:t})},e.prototype.render=function(){var e;if(null===this.state.isSkippable||null===this.state.remainingDurationBeforeSkippableSeconds)return null;var t=PS(o,((e={})[a]=this.state.isSkippable,e)),n=this.state.isSkippable?"skipButton":"skipTimer",r=this.context.stores.localization.getLocalization().avod[n].replace("{{seconds}}",this.state.remainingDurationBeforeSkippableSeconds.toString());return Vn.createElement("div",{className:t,onClick:this.onAdSkipButtonClicked},r,this.state.isSkippable?Vn.createElement("div",{className:s},Vn.createElement(wb.SVGImage,{src:Ww.SVG.RightArrow})):null)},e.contextType=QP.ReactContext,e}(Vn.Component);t.AdSkipButton=n});e(Gw);Gw.AdSkipButton;var Kw=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler(wb.debugClassName("adtimeindicator-text"),{opacity:.5}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.state={requestedPlayerFeature:null,countdownString:null},t}return i(e,n),e.prototype.componentDidMount=function(){this.setState({requestedPlayerFeature:this.context.stores.uiConfigurations.getRequestedPlayerFeature()})},e.prototype.componentWillReceiveProps=function(e){if(xt.exists(e.adEndPositionMs)&&xt.exists(e.adPositionMs)){var t,n=e.adEndPositionMs-e.adPositionMs,r=this.context.stores.localization.getLocalization();if(e.disableLongCountdown){var i=zw.millisecondsToHoursMinutesSeconds(n),o=zw.formatTime(i,0<i.hours);t=this.state.requestedPlayerFeature==ct.WebPlayerSDKFeatures.Player?r.avod.countdownShort.replace("{{seconds}}",o):o}else t=r.avod.countdown.replace("{{seconds}}",Math.floor(n/1e3).toString());this.setState({countdownString:t})}},e.prototype.render=function(){return Vn.createElement("div",{className:o},F.isEmpty(this.state.countdownString)?null:this.state.countdownString)},e.contextType=QP.ReactContext,e}(Vn.Component);t.AdTimeIndicator=n});e(Kw);Kw.AdTimeIndicator;var Qw=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.context.stores.localization.getLocalization();return Vn.createElement("div",null,e.avod.draperCaption)},t.contextType=QP.ReactContext,t}(Vn.Component);t.DraperCaption=i});e(Qw);Qw.DraperCaption;var Yw=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler(qS.ScalableMarginRight(18),qS.ScalableLineHeight(18)),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:i},Vn.createElement("span",null,this.context.stores.localization.getLocalization().live.indicator))},t.contextType=QP.ReactContext,t}(Vn.Component);t.LiveIndicator=o});e(Yw);Yw.LiveIndicator;var Jw=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler(wb.debugClassName("nexttitle-button"),{display:"inline-flex",flexDirection:"row-reverse",alignItems:"center",position:"relative",opacity:.8,transition:"opacity 150ms ease-in",color:qS.PrimaryColor,backgroundColor:"transparent",boxShadow:"none",$nest:{"&:not(.disabled):hover":{opacity:1,backgroundColor:"transparent"}}},qS.ScalableHeight(16)),o=qS.styler(qS.ScalableFontSize(15),qS.ScalablePaddingRight(5)),a={padding:0,lineHeight:"normal"},s=qS.styler({position:"relative"},qS.ScalableTop(2),qS.ScalableHeight(16),qS.ScalableWidth(5)),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onNextTitleClick=function(){e.context.stores.nextTitle.nextTitleInitiated(HP.NextTitleTransition.Button)},e}return n(e,t),e.prototype.render=function(){return this.shouldRender()?Vn.createElement(wb.Button,{className:i,onClick:this.onNextTitleClick,icon:Ww.SVG.RightArrow,iconClassName:s,style:a},Vn.createElement("div",{className:o},this.context.stores.localization.getLocalization().nextTitle)):Vn.createElement("div",null," ")},e.prototype.shouldRender=function(){return xt.exists(this.props.nextTitle)&&"EPISODE"===this.props.nextTitle.type&&this.props.nextTitle.isPlayable&&!this.context.stores.nextUpInfo.getNextUpInfo().nextUpAutoplayShowing&&this.props.autoplay.showAutoplayCard&&this.props.autoplay.isInSameSeries},e.contextType=QP.ReactContext,e}(Vn.Component);t.NextTitleButton=l});e(Jw);Jw.NextTitleButton;var $w=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({transform:"rotate(90deg)",display:"inline-block",position:"relative"},qS.ScalableWidth(6),qS.ScalableHeight(11)),a=qS.styler({transform:"rotate(270deg)"}),s=qS.styler({display:"inline-block",cursor:"pointer",color:qS.PrimaryColor,opacity:.8,transition:"opacity 150ms ease-in",$nest:{"&:hover":{opacity:1}}}),l=qS.styler({display:"inline-block"},qS.ScalablePaddingRight(6)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onNextUpInfoUpdate=function(e){t.setState({isShowingNextUpCarousel:e.shouldShowNextUpCarousel})},t.onNextUpCarouselButtonClick=function(){t.context.stores.nextUpInfo.updateNextUpCarouselDisplayStatus(!t.state.isShowingNextUpCarousel)},t.state={isShowingNextUpCarousel:!1},t}return i(e,n),e.prototype.componentWillMount=function(){this.onNextUpInfoUpdate(this.context.stores.nextUpInfo.getNextUpInfo()),this.context.stores.nextUpInfo.onUpdate(this.onNextUpInfoUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.nextUpInfo.offUpdate(this.onNextUpInfoUpdate)},e.prototype.render=function(){var e,t=PS(o,((e={})[a]=this.state.isShowingNextUpCarousel,e));return Vn.createElement("div",{className:s,onClick:this.onNextUpCarouselButtonClick},Vn.createElement("div",{className:l},this.context.stores.localization.getLocalization().nextForYou),Vn.createElement("div",{className:t},Vn.createElement(wb.SVGImage,{src:Ww.SVG.RightArrow})))},e.contextType=QP.ReactContext,e}(Vn.Component);t.NextUpCarouselButton=n});e($w);$w.NextUpCarouselButton;var Zw=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({color:qS.PrimaryColor,opacity:.8}),o=qS.styler({fontWeight:"normal"}),a=qS.styler({fontWeight:"lighter"}),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){if(F.isEmpty(this.props.title))return null;var e=this.props.title,t=null!=e.seriesTitle?e.seriesTitle:e.title,n=this.context.stores.localization.getLocalization();if(xt.exists(e.seasonNumber)&&xt.exists(e.episodeNumber)){var r={seasonNumber:e.seasonNumber,episodeNumber:e.episodeNumber};t+=" "+this.context.stores.localization.mapReplace(n.episodeLong,r)}else xt.exists(e.seasonNumber)&&(t+=" "+n.season+" "+e.seasonNumber),xt.exists(e.episodeNumber)&&(t+=" "+n.episodeShort+" "+e.episodeNumber);return Vn.createElement("div",{className:i},Vn.createElement("span",{className:o},n.nextUp,": "),Vn.createElement("span",{className:a},t))},t.contextType=QP.ReactContext,t}(Vn.Component);t.NextUpIndicator=s});e(Zw);Zw.NextUpIndicator;var eC=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler(wb.debugClassName("timeindicator-text"),{whiteSpace:"nowrap"},qS.ScalableFontSize(15)),o=qS.styler({fontWeight:"lighter"}),a=function(t){function e(e){var l=t.call(this,e)||this;return l.mounted=!1,l.onTimelineStoreChange=function(e){if(l.mounted){var t=l.truncatePosition(e.endPositionMs)-e.startPositionMs,n=l.truncatePosition(e.positionMs)-e.startPositionMs;if(l.state.truncatedCurrentPositionMs!==n||l.state.truncatedDurationMs!==t){var r=zw.millisecondsToHoursMinutesSeconds(t),i=zw.millisecondsToHoursMinutesSeconds(t-n),o=zw.millisecondsToHoursMinutesSeconds(n),a=zw.formatTime(o,0<r.hours),s=zw.formatTime(i,0<r.hours);l.setState({position:t!==1/0?a:null,timeRemaining:t!==1/0?s:null,truncatedCurrentPositionMs:n,truncatedDurationMs:t})}}},l.state={position:"",timeRemaining:"",truncatedDurationMs:null,truncatedCurrentPositionMs:null},l}return n(e,t),e.prototype.componentDidMount=function(){this.mounted=!0,this.context.stores.timeline.onUpdate(this.onTimelineStoreChange)},e.prototype.componentWillUnmount=function(){this.mounted=!1,this.context.stores.timeline.offUpdate(this.onTimelineStoreChange)},e.prototype.render=function(){var e=Vn.createElement(Vn.Fragment,null," ");if(null!=this.state.position&&0<this.state.position.length&&null!=this.state.timeRemaining&&0<this.state.timeRemaining.length&&this.props.visible){var t=o;null!=this.props.timeRemainingClassName&&(t+=" "+this.props.timeRemainingClassName),e=Vn.createElement(Vn.Fragment,null,this.state.position," ",Vn.createElement("span",{className:t},"/ ",this.state.timeRemaining))}var n=i;return null!=this.props.className&&(n+=" "+this.props.className),Vn.createElement("div",{className:n,tabIndex:0},e)},e.prototype.truncatePosition=function(e){return null!=e?1e3*Math.floor(e/1e3):null},e.contextType=QP.ReactContext,e.defaultProps={visible:!0},e}(Vn.PureComponent);t.TimeIndicator=a});e(eC);eC.TimeIndicator;var tC=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var l=qS.styler({fontWeight:"normal",display:"flex"},qS.ScalableFontSize(15)),u=qS.styler(qS.ScalableFontSize(12)),c=qS.styler({display:"flex",alignItems:"center",flex:"1 1 0",flexGrow:1,$nest:{"& > *":{$nest:i({},qS.ScaleNestedProperty("margin-right",19).$nest,{"&:last-child":{marginRight:"0"}})}}},qS.ScalableHeight(18)),d=qS.styler({display:"flex",alignItems:"center",flex:"1 1 0",justifyContent:"center",flexGrow:2},qS.ScalableHeight(18)),p=qS.styler({display:"flex",alignItems:"center",flex:"1 1 0",justifyContent:"flex-end",flexGrow:1,textAlign:"right",$nest:{"& > *:not(:first-child)":qS.ScaleNestedProperty("margin-left",19)}}),f=qS.styler({opacity:.8}),h=qS.styler({opacity:.5}),o=function(t){function e(e){var f=t.call(this,e)||this;return f.mediaQuery=window.matchMedia("(min-width: 700px)"),f.onAdPlaybackInfo=function(e){var t=null,n=null,r=null,i=null;null!==e&&(t=f.truncatePosition(e.skipOffsetMs),n=f.truncatePosition(e.endPositionMs),r=f.truncatePosition(e.positionMs),i=f.truncatePosition(e.startPositionMs)),f.setState({adPlayback:e,truncatedAdEndPositionMs:n,truncatedAdPositionMs:r,truncatedAdStartPositionMs:i,truncatedSkipOffsetMs:t})},f.onAutoplayInfo=function(e){f.setState({autoplay:e})},f.onHDCPStatus=function(e){f.setState({downscalingToSd:e.downscalingToSd,isHDCPCompliant:e.isHDCPCompliant,isHDCPRequired:e.isHDCPRequired})},f.onUIConfigurationsChange=function(e){f.setState({enableAddToWatchlist:e.enableAddToWatchlist,enableDraperCaption:e.enableDraperCaption,enableHdIndicator:e.enableHdIndicator,enableNextUp:e.enableNextUp,enableNextUpCarousel:e.enableNextUpCarousel})},f.onMediaQueryChanged=function(e){f.setState({narrowWidth:!e.matches})},f.onTitleInfoUpdate=function(e){f.setState({entityType:e.entityType,seriesTitle:e.seriesTitle,contentTitle:e.title,contentType:e.contentType,nextTitle:e.nextTitle})},f.onTimelineInfoUpdate=function(e){var t=f.truncatePosition(e.endPositionMs),n=f.truncatePosition(e.positionMs),r=f.truncatePosition(e.startPositionMs),i=f.truncatePosition(e.lastPlayablePositionMs),o="",a="",s=t-r,l=n-r;if(f.state.contentType===_P.ContentType.Live&&(l=s=0,null!=e.startPositionMs&&null!=e.endPositionMs)){var u=f.truncatePosition(e.startPositionMs);s=f.truncatePosition(e.endPositionMs)-u,l=n-u}if(0<s){var c=zw.millisecondsToHoursMinutesSeconds(s),d=zw.millisecondsToHoursMinutesSeconds(s-l);a=zw.formatTime(d,0<c.hours);var p=zw.millisecondsToHoursMinutesSeconds(l);o=zw.formatTime(p,0<c.hours)}f.setState({position:o,truncatedLastPlayablePositionMs:i,truncatedEndPositionMs:t,truncatedPositionMs:n,timeRemaining:a})},f.onVideoStreamInfoChange=function(e){f.setState({videoStream:e.activeStream})},f.shouldShowAdSkipButton=function(){return f.state.contentType===_P.ContentType.Ad&&null!=xt.nestedValue(f.state,"adPlayback.skipOffsetMs")&&(f.state.truncatedAdPositionMs>=f.state.truncatedSkipOffsetMs||f.state.adPlayback.hasSkipTimeIndicator)},f.shouldShowAddToWatchlist=function(){return f.state.contentType===_P.ContentType.Ad&&xt.nestedValue(f.state,"adPlayback.hasAddToWatchlist")&&f.state.enableAddToWatchlist},f.shouldShowDraperCaption=function(){return f.state.contentType===_P.ContentType.Ad&&xt.nestedValue(f.state,"adPlayback.adType")&&f.state.adPlayback.adType===yP.AdType.Draper&&f.state.enableDraperCaption},f.shouldShowHDIndicator=function(){return f.state.contentType!==_P.ContentType.Live&&f.state.contentType!==_P.ContentType.Ad&&(f.state.isHDCPRequired?f.state.enableHdIndicator&&f.state.isHDCPCompliant:f.state.enableHdIndicator)},f.shouldShowLiveIndicator=function(){return f.state.contentType===_P.ContentType.Live&&"Live Sporting Event UX 1"===f.state.entityType},f.shouldShowNextUp=function(){return f.state.enableNextUp},f.shouldShowNextUpCarouselButton=function(){var e=f.context.stores.nextUpInfo.getNextUpInfo().nextUpItems;return!F.isEmpty(e)&&f.state.enableNextUpCarousel&&f.state.contentType!==_P.ContentType.Ad},f.state={},f}return n(e,t),e.prototype.componentDidMount=function(){this.onAdPlaybackInfo(this.context.stores.adPlayback.getAdPlaybackInfo()),this.context.stores.adPlayback.onAdPlaybackInfoChange(this.onAdPlaybackInfo),this.onAutoplayInfo(this.context.stores.nextTitle.getAutoplayInfo()),this.context.stores.nextTitle.onAutoplayInfoChange(this.onAutoplayInfo),this.onHDCPStatus(this.context.stores.hdcp.getHDCPStatus()),this.context.stores.hdcp.onHDCPStatusChange(this.onHDCPStatus),this.onTimelineInfoUpdate(this.context.stores.timeline.getTimelineInfo()),this.context.stores.timeline.onUpdate(this.onTimelineInfoUpdate),this.onTitleInfoUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoUpdate),this.onUIConfigurationsChange(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsChange),this.onVideoStreamInfoChange(this.context.stores.videoStream.getVideoStreamInfo()),this.context.stores.videoStream.onVideoStreamInfoChange(this.onVideoStreamInfoChange),this.onMediaQueryChanged(this.mediaQuery),this.mediaQuery.addListener(this.onMediaQueryChanged)},e.prototype.componentWillUnmount=function(){this.context.stores.adPlayback.offAdPlaybackInfoChange(this.onAdPlaybackInfo),this.context.stores.hdcp.offHDCPStatusChange(this.onHDCPStatus),this.context.stores.nextTitle.offAutoplayInfoChange(this.onAutoplayInfo),this.context.stores.timeline.offUpdate(this.onTimelineInfoUpdate),this.context.stores.title.offUpdate(this.onTitleInfoUpdate),this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsChange),this.context.stores.videoStream.offVideoStreamInfoChange(this.onVideoStreamInfoChange),this.mediaQuery.removeListener(this.onMediaQueryChanged)},e.prototype.render=function(){var e,t=xt.withDefault(this.state.seriesTitle,this.state.contentTitle),n=xt.nestedValue(this.state,["adPlayback","hasAdTimeIndicator"],!1),r=eC.TimeIndicator,i=l;this.state.contentType===_P.ContentType.Ad?(r=n?Kw.AdTimeIndicator:null,i=PS(i,((e={})[u]=this.props.useSmallPlayerAdUi(),e))):(F.isEmpty(this.state.position)||F.isEmpty(this.state.timeRemaining))&&(r=null);var o=this.shouldShowAdSkipButton(),a=F.isEmpty(t)||this.state.narrowWidth||o,s=null;return this.shouldShowNextUp()&&(s=this.state.contentType===_P.ContentType.Live?Vn.createElement(Zw.NextUpIndicator,{title:this.state.nextTitle}):this.state.contentType===_P.ContentType.Ad?Vn.createElement(qw.AdClickThroughURL,null):Vn.createElement(Jw.NextTitleButton,{autoplay:this.state.autoplay,nextTitle:this.state.nextTitle})),Vn.createElement("div",{className:i},Vn.createElement("div",{className:c},null!==r?Vn.createElement(r,{adEndPositionMs:this.state.truncatedAdEndPositionMs,adPositionMs:this.state.truncatedAdPositionMs,disableLongCountdown:a,positionString:this.state.position,timeRemaining:this.state.timeRemaining,className:f,timeRemainingClassName:h,title:t}):null,this.shouldShowDraperCaption()?Vn.createElement(Qw.DraperCaption,null):null,this.shouldShowLiveIndicator()?Vn.createElement(Yw.LiveIndicator,null):null,this.shouldShowHDIndicator()?Vn.createElement(wb.HDIndicator,{videoStream:this.state.videoStream,downscalingToSd:this.state.downscalingToSd}):null),Vn.createElement("div",{className:d},this.shouldShowNextUpCarouselButton()?Vn.createElement($w.NextUpCarouselButton,null):null),Vn.createElement("div",{className:p},this.shouldShowAddToWatchlist()?Vn.createElement(Hw.AddToWatchlist,null):null,s,o?Vn.createElement(Gw.AdSkipButton,{adPositionMs:this.state.truncatedAdPositionMs,adStartPositionMs:this.state.truncatedAdStartPositionMs,skipOffsetMs:this.state.truncatedSkipOffsetMs}):null))},e.prototype.truncatePosition=function(e){return null!=e?1e3*Math.floor(e/1e3):null},e.contextType=QP.ReactContext,e}(Vn.Component);t.InfoBar=o});e(tC);tC.InfoBar;var nC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=qS.styler(wb.debugClassName("trickplay-image"),{display:"block"},qS.ScalableMinWidth(300),qS.ScalableWidth(300)),u=qS.styler(wb.debugClassName("trickplay-time"),{fontWeight:"normal",boxSizing:"border-box !important",textAlign:"center",width:"100%"},qS.ScalableFontSize(15),qS.ScalablePadding(4)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.mediaQuery=window.matchMedia(Y.Styling.SCREEN_LARGE_MEDIA_QUERY),t.minWindowHeight=300,t.trickplayMarginPx="38px",t.trickplayMarginVw=38*Y.Styling.SCALE_FACTOR_LARGE+"vw",t.isTrickplayShowing=!1,t.onMediaQueryChanged=function(e){t.setState({trickplayMarginTop:e.matches?t.trickplayMarginVw:t.trickplayMarginPx})},t.onError=function(){t.setState({trickplayError:!0})},t.shouldGetTrickplayImage=function(){return t.props.contentType!==_P.ContentType.Ad&&t.props.contentType!==_P.ContentType.Trailer&&window.innerHeight>=t.minWindowHeight},t.state={trickplayMarginTop:t.trickplayMarginPx,trickplayError:!1},t}return i(e,n),e.prototype.shouldComponentUpdate=function(e,t){return e.show||this.props.show!==e.show||this.state.trickplayError!==t.trickplayError},e.prototype.componentDidMount=function(){this.onMediaQueryChanged(this.mediaQuery),this.mediaQuery.addListener(this.onMediaQueryChanged)},e.prototype.componentWillUnmount=function(){this.mediaQuery.removeListener(this.onMediaQueryChanged)},e.prototype.componentWillUpdate=function(e,t){e.show&&!this.isTrickplayShowing?(this.emitTrickplayShowingChangedEvent(!0),this.isTrickplayShowing=!0):!e.show&&this.isTrickplayShowing&&(this.emitTrickplayShowingChangedEvent(!1),this.isTrickplayShowing=!1)},e.prototype.render=function(){var e=zw.millisecondsToHoursMinutesSeconds(this.props.endPositionMs-this.props.startPositionMs),t=zw.millisecondsToHoursMinutesSeconds(this.props.positionMs-this.props.startPositionMs),n=zw.formatTime(t,0<e.hours),r=this.props.xPosition,i=this.state.trickplayMarginTop,o=this.shouldGetTrickplayImage()?this.context.stores.trickplay.getTrickplayImageUrl(this.props.positionMs):null,a={display:null};(null===o||this.state.trickplayError)&&(a.display="none");var s=null;return xt.exists(o)&&(s=Vn.createElement("img",{className:l,style:a,src:o,onError:this.onError})),Vn.createElement(wb.Tooltip,{x:r,y:i,show:this.props.show,forceLTR:!0},Vn.createElement("div",null,F.isEmpty(this.props.contentOverride)?s:null,Vn.createElement("div",{className:u},F.isEmpty(this.props.contentOverride)?n:this.props.contentOverride)))},e.prototype.emitTrickplayShowingChangedEvent=function(e){this.context.stores.trickplay.trickplayShowingChanged(e)},e.contextType=QP.ReactContext,e}(Vn.Component);t.TrickplayTooltip=n});e(nC);nC.TrickplayTooltip;var rC=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var h=qS.styler({width:"100%",position:"relative"}),l=qS.styler({pointerEvents:"none",position:"absolute",backgroundColor:qS.PrimaryColor,opacity:.75},qS.ScalableWidth(10),qS.ScalableHeight(3),qS.ScalableTop(10)),u=qS.styler({backgroundColor:"#000 !important",opacity:.5}),m=qS.styler({whiteSpace:"nowrap"},qS.ScalablePadding(6)),i=function(t){function e(e){var s=t.call(this,e)||this;return s.lock=null,s.seekBarElement=null,s.onTitleInfoStoreUpdate=function(e){s.setState(s.getStateFromTitleInfo(e))},s.onTimelineInfoStoreUpdate=function(e){s.setState(s.getStateFromTimelineInfo(e))},s.onPlaybackControlsPolicyChange=function(e){s.setState({playbackControlsPolicy:e})},s.onPercentSelect=function(e){var t=Math.round(Math.max((s.state.endPositionMs-s.state.startPositionMs)*e+s.state.startPositionMs,0));s.canSeekToPosition(t)&&s.context.stores.playback.seek(t)},s.onMouseEnterSeekbar=function(){s.setState({mouseInSeekbar:!0,showTrickplay:!0})},s.onMouseLeaveSeekbar=function(){s.setState({mouseInSeekbar:!1,showTrickplay:s.state.draggingSeekbar})},s.onMouseDownSeekbar=function(e){s.state.draggingSeekbar||(s.lock.lock(),s.setState({draggingSeekbar:!0,showTrickplay:!0,trickplayTimePercent:Math.min(Math.max(e,0),1)}))},s.onMouseUpSeekbar=function(){s.state.draggingSeekbar&&(s.lock.lock(wb.UITimeoutMS.Touch),s.setState({draggingSeekbar:!1,showTrickplay:s.state.mouseInSeekbar}))},s.onMouseMoveSeekbar=function(e){s.setState({trickplayTimePercent:Math.min(Math.max(e,0),1)})},s.onTouchEnd=function(){s.setState({mouseInSeekbar:!1})},s.getTickMarks=function(i,o,a){var e=null;return xt.exists(s.state.tickMarkPositionsMs)&&(e=s.state.tickMarkPositionsMs.map(function(e){var t,n=(e-i)/o;if(isNaN(n))return null;var r=PS(l,((t={})[u]=n<a,t),s.props.tickMarkClassName);return Vn.createElement("div",{className:r,key:e,style:{left:100*n+"%"}})})),e},s.state={contentType:_P.ContentType.VOD,draggingSeekbar:!1,endPositionMs:null,handlePositionMs:null,lastPlayablePositionMs:null,mouseInSeekbar:!1,playbackControlsPolicy:{fastSeekEnabled:!0,pauseEnabled:!0,seekBackwardEnabled:!0,seekForwardEnabled:!0},progressPositionMs:null,earliestPlayablePositionMs:null,showTrickplay:!1,startPositionMs:null,trickplayTimePercent:null},s}return n(e,t),e.prototype.componentDidMount=function(){var e=this.context.stores.title.getTitleInfo(),t=this.context.stores.timeline.getTimelineInfo();this.setState(F.extend(this.getStateFromTitleInfo(e),this.getStateFromTimelineInfo(t),{draggingSeekbar:!1,handlePositionMs:0,mouseInSeekbar:!1,progressPositionMs:0,showTrickplay:!1,trickplayTimePercent:0,playbackControlsPolicy:this.context.stores.playbackControlsPolicy.getPolicy()})),this.lock=this.context.stores.lock.newLock(),this.context.stores.playbackControlsPolicy.onPolicyChange(this.onPlaybackControlsPolicyChange),this.context.stores.timeline.onUpdate(this.onTimelineInfoStoreUpdate),this.context.stores.title.onUpdate(this.onTitleInfoStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.playbackControlsPolicy.offPolicyChange(this.onPlaybackControlsPolicyChange),this.context.stores.timeline.offUpdate(this.onTimelineInfoStoreUpdate),this.context.stores.title.offUpdate(this.onTitleInfoStoreUpdate),this.context.stores.lock.deleteLock(this.lock),this.lock=null},e.prototype.shouldComponentUpdate=function(e,t){return t.showTrickplay||t.showTrickplay!==this.state.showTrickplay||t.startPositionMs!==this.state.startPositionMs||t.endPositionMs!==this.state.endPositionMs||t.earliestPlayablePositionMs!==this.state.progressPositionMs||t.progressPositionMs!==this.state.earliestPlayablePositionMs||t.handlePositionMs!==this.state.handlePositionMs||t.lastPlayablePositionMs!==this.state.lastPlayablePositionMs||!F.isEqual(t.tickMarkPositionsMs,this.state.tickMarkPositionsMs)},e.prototype.render=function(){var t=this,e=this.state.playbackControlsPolicy.seekBackwardEnabled,n=this.state.playbackControlsPolicy.seekForwardEnabled,r=this.state.endPositionMs-this.state.startPositionMs,i=Math.min(1,(this.state.progressPositionMs-this.state.startPositionMs)/r),o=this.getTimeWindowStartPercent(r),a=Math.min(1,(this.state.lastPlayablePositionMs-this.state.startPositionMs)/r),s=(this.state.handlePositionMs-this.state.startPositionMs)/r,l=s,u=0,c=0;this.state.showTrickplay&&(c=Math.floor(this.state.trickplayTimePercent*this.seekBarElement.offsetWidth),u=this.state.trickplayTimePercent*r+this.state.startPositionMs);var d=null;if(!this.canSeekToPosition(u)){var p=this.context.stores.localization.getLocalization(),f=p.unavailable;!n&&e&&u>this.state.progressPositionMs&&(f=p.fastForwardUnavailable),d=Vn.createElement("div",{className:m},f)}return Vn.createElement("div",{className:h,ref:function(e){t.seekBarElement=e;
        if (e) {
          triggerEvent(e, 'page-elements', { name: 'seekBar' })
        }
      },onTouchEnd:this.onTouchEnd},Vn.createElement(nC.TrickplayTooltip,{show:this.state.showTrickplay,xPosition:c,startPositionMs:this.state.startPositionMs,positionMs:u,endPositionMs:this.state.endPositionMs,contentType:this.state.contentType,contentOverride:d}),Vn.createElement(wb.ProgressBar,{enabled:e||n,handlePercent:l,onMouseDown:this.onMouseDownSeekbar,onMouseEnter:this.onMouseEnterSeekbar,onMouseLeave:this.onMouseLeaveSeekbar,onMouseMove:this.onMouseMoveSeekbar,onMouseUp:this.onMouseUpSeekbar,onPercentSelect:this.onPercentSelect,showHandleOnHover:!0,progressBarContainerClassName:this.props.progressBarContainerClassName,progressBarClassName:this.props.progressBarClassName,handleWrapperClassName:this.props.handleWrapperClassName,handleClassName:this.props.handleClassName,ariaLabel:"Seek"},Vn.createElement(wb.ProgressBarSegment,{startPercent:e?o:0,endPercent:s,className:this.props.progressBarSegmentClassName}),e&&n&&this.state.contentType===_P.ContentType.Live?Vn.createElement(wb.ProgressBarSegment,{startPercent:o,endPercent:a,secondary:!0,className:this.props.secondaryProgressBarSegmentClassName}):null),this.getTickMarks(this.state.startPositionMs,r,i))},e.prototype.getTimeWindowStartPercent=function(e){return this.state.contentType!==_P.ContentType.Live?this.state.startPositionMs:Math.max(0,(this.state.earliestPlayablePositionMs-this.state.startPositionMs)/e)},e.prototype.getStateFromTimelineInfo=function(e){return{endPositionMs:e.endPositionMs,handlePositionMs:e.positionMs,lastPlayablePositionMs:e.lastPlayablePositionMs,progressPositionMs:e.positionMs,earliestPlayablePositionMs:e.earliestPlayablePositionMs,startPositionMs:e.startPositionMs}},e.prototype.getStateFromTitleInfo=function(e){return{contentType:e.contentType,tickMarkPositionsMs:e.midrollPositionsMs}},e.prototype.canSeekToPosition=function(e){return e>=this.state.progressPositionMs&&this.state.playbackControlsPolicy.seekForwardEnabled||e<this.state.progressPositionMs&&this.state.playbackControlsPolicy.seekBackwardEnabled},e.contextType=QP.ReactContext,e}(Vn.Component);t.SeekBar=i});e(rC);rC.SeekBar;var iC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var a=qS.styler(wb.debugClassName("bottompanel-container"),{order:3,height:"auto",width:"100%",boxSizing:"border-box !important",flex:"0 auto"},qS.ScalablePadding(0,50,25,50),Vw.EnableChildPointerEvents),s=qS.styler(qS.ScalablePadding(0,10,10,10)),l=qS.styler({transition:"opacity 150ms ease-in",opacity:0,$nest:{"&.show":{opacity:1}}}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.lock=null,t.touched=!1,t.hideOnTransitionEnd=!1,t.onAdPlaybackInfo=function(e){t.setState({adPlaybackInfo:e},function(){return t.updateShouldControlsBeDisplayed()})},t.onModalInfoChange=function(e){t.setState({prePlaybackModalShowing:null!=e&&e.isPrePlayback,modalShowing:null!=e},function(){return t.updateShouldControlsBeDisplayed()})},t.onUIConfigurationsStoreUpdate=function(e){t.setState({uiConfigurations:e})},t.onUIStatusStoreUpdate=function(e){t.setState({state:e.state,userActive:e.userActive},function(){return t.updateShouldControlsBeDisplayed()})},t.onTitleInfoStoreUpdate=function(e){t.setState({contentType:e.contentType},function(){return t.updateShouldControlsBeDisplayed()})},t.onTimelineInfoStoreUpdate=function(e){t.setState({endPositionMs:e.endPositionMs,positionMs:e.positionMs,startPositionMs:e.startPositionMs},function(){return t.updateShouldControlsBeDisplayed()})},t.onPlaybackControlsPolicyChange=function(e){t.setState({playbackControlsPolicy:e},function(){return t.updateShouldControlsBeDisplayed()})},t.onNextUpInfoStoreUpdate=function(e){t.setState({nextUpCarouselShowing:e.shouldShowNextUpCarousel},function(){return t.updateShouldControlsBeDisplayed()})},t.onTouchStart=function(){t.touched=!0},t.onMouseMove=function(){t.touched||t.lock.lock(wb.UITimeoutMS.Hover20s),t.touched=!1},t.onMouseLeave=function(){t.lock.unlock()},t.onBottomPanelShowChange=function(e){t.hideOnTransitionEnd=!1,t.shouldShowBottomPanel(t.state)?t.setState({displayBottomPanel:!0}):e.contentType!==t.state.contentType?t.setState({displayBottomPanel:!1}):t.hideOnTransitionEnd=!0},t.onTransitionEnd=function(){t.hideOnTransitionEnd&&(t.setState({displayBottomPanel:!1}),t.hideOnTransitionEnd=!1)},t.shouldUseSmallPlayerAdUi=function(e){return e.contentType===_P.ContentType.Ad&&t.context.stores.uiConfigurations.useSmallPlayerUI()},t.isLiveScheduleUnavailable=function(e){return!(e.contentType!==_P.ContentType.Live&&null!=e.contentType||null!=e.startPositionMs&&null!=e.endPositionMs)},t.shouldShowInfoBar=function(e){return(e.uiConfigurations.alwaysDisplayAdCountdown&&e.contentType===_P.ContentType.Ad||e.shouldDisplayControls)&&e.state!==$P.UIPlaybackState.Error&&!t.isLiveScheduleUnavailable(e)},t.shouldShowSeekBar=function(e){return e.uiConfigurations.enableSeekbar&&e.seekbarVisible&&e.shouldDisplayControls&&!t.isLiveScheduleUnavailable(e)},t.shouldShowBottomPanel=function(e){return e.canDisplayBottomPanel&&(t.shouldShowInfoBar(e)||t.shouldShowSeekBar(e))},t.state={adPlaybackInfo:null,canDisplayBottomPanel:!1,displayBottomPanel:!1,contentType:_P.ContentType.VOD,shouldDisplayControls:!1,endPositionMs:null,modalShowing:!1,playbackControlsPolicy:{fastSeekEnabled:!0,pauseEnabled:!0,seekBackwardEnabled:!0,seekForwardEnabled:!0},positionMs:null,prePlaybackModalShowing:!1,seekbarVisible:!0,startPositionMs:null,state:$P.UIPlaybackState.Stopped,touched:!1,userActive:!1,nextUpCarouselShowing:!1,uiConfigurations:_w.GetDefaultUIConfigurations()},t}return i(e,n),e.prototype.componentDidMount=function(){this.lock=this.context.stores.lock.newLock(),this.infoBarRef.addEventListener("transitionend",this.onTransitionEnd),this.infoBarRef.addEventListener("webkitTransitionEnd",this.onTransitionEnd),this.onAdPlaybackInfo(this.context.stores.adPlayback.getAdPlaybackInfo()),this.context.stores.adPlayback.onAdPlaybackInfoChange(this.onAdPlaybackInfo),this.onModalInfoChange(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalInfoChange),this.onNextUpInfoStoreUpdate(this.context.stores.nextUpInfo.getNextUpInfo()),this.context.stores.nextUpInfo.onUpdate(this.onNextUpInfoStoreUpdate),this.onPlaybackControlsPolicyChange(this.context.stores.playbackControlsPolicy.getPolicy()),this.context.stores.playbackControlsPolicy.onPolicyChange(this.onPlaybackControlsPolicyChange),this.onTitleInfoStoreUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoStoreUpdate),this.onTimelineInfoStoreUpdate(this.context.stores.timeline.getTimelineInfo()),this.context.stores.timeline.onUpdate(this.onTimelineInfoStoreUpdate),this.onUIStatusStoreUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.onUIConfigurationsStoreUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.lock.deleteLock(this.lock),this.lock=null,this.infoBarRef.removeEventListener("transitionend",this.onTransitionEnd),this.infoBarRef.removeEventListener("webkitTransitionEnd",this.onTransitionEnd),this.context.stores.adPlayback.offAdPlaybackInfoChange(this.onAdPlaybackInfo),this.context.stores.modal.offUpdate(this.onModalInfoChange),this.context.stores.nextUpInfo.offUpdate(this.onNextUpInfoStoreUpdate),this.context.stores.playbackControlsPolicy.offPolicyChange(this.onPlaybackControlsPolicyChange),this.context.stores.title.offUpdate(this.onTitleInfoStoreUpdate),this.context.stores.timeline.offUpdate(this.onTimelineInfoStoreUpdate),this.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsStoreUpdate)},e.prototype.shouldComponentUpdate=function(e,t){return t.shouldDisplayControls||this.state.displayBottomPanel!==t.displayBottomPanel||this.state.shouldDisplayControls!==t.shouldDisplayControls||this.state.canDisplayBottomPanel!==t.canDisplayBottomPanel||this.state.contentType!==t.contentType||this.state.nextUpCarouselShowing!==t.nextUpCarouselShowing||t.contentType===_P.ContentType.Ad},e.prototype.componentDidUpdate=function(e,t){this.shouldShowBottomPanel(t)!==this.shouldShowBottomPanel(this.state)&&this.onBottomPanelShowChange(t)},e.prototype.render=function(){var e,t=this,n={paddingBottom:this.state.displayBottomPanel?"":"0",height:this.state.displayBottomPanel?"":"0"},r=PS(a,((e={})[s]=this.shouldUseSmallPlayerAdUi(this.state),e)),i=PS(l,wb.debugClassName("infobar-container"),{show:this.shouldShowInfoBar(this.state)}),o=PS(l,wb.debugClassName("seekbar-container"),{show:this.shouldShowSeekBar(this.state)});return Vn.createElement("div",{className:r,style:n,onTouchStart:this.onTouchStart,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,dir:"ltr"},Vn.createElement("div",{className:o},Vn.createElement(rC.SeekBar,{progressBarClassName:wb.debugClassName("seekbar-range")})),Vn.createElement("div",{className:i,ref:function(e){t.infoBarRef=e}},Vn.createElement(tC.InfoBar,{useSmallPlayerAdUi:function(){return t.shouldUseSmallPlayerAdUi(t.state)}})))},e.prototype.updateShouldControlsBeDisplayed=function(){var e=this.state.state!==$P.UIPlaybackState.Loading&&this.state.state!==$P.UIPlaybackState.Error&&this.state.state!==$P.UIPlaybackState.Stopped&&!this.state.prePlaybackModalShowing&&!this.state.nextUpCarouselShowing,t=this.state.userActive&&e&&!this.state.modalShowing;t!==this.state.shouldDisplayControls&&this.context.stores.uiDisplayStatus.setDisplayStatus(t);var n=this.state.seekbarVisible;n=this.state.contentType===_P.ContentType.Live?null!=this.state.startPositionMs&&null!=this.state.endPositionMs:this.state.contentType!==_P.ContentType.Ad||xt.nestedValue(this.state,"adPlaybackInfo.showSeekBar",this.state.playbackControlsPolicy.seekBackwardEnabled||this.state.playbackControlsPolicy.seekForwardEnabled),this.setState({canDisplayBottomPanel:e,shouldDisplayControls:t,seekbarVisible:n})},e.contextType=QP.ReactContext,e}(Vn.Component);t.BottomPanel=n});e(iC);iC.BottomPanel;var oC=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){var i=t.call(this,e)||this;return i.didUnmount=!1,i.countdownPositionMs=null,i.previousTimestampMs=null,i.onAutoplayInfo=function(e,t){void 0===t&&(t=i.state.state);var n=Math.max(e.autoplayTimerMs-3e3,3e3),r={autoplayInfo:e,finalAutoplayTimerMs:n,countdownPercent:i.state.countdownPercent};(null===i.countdownPositionMs||1e3<Math.abs(i.countdownPositionMs-i.state.positionMs))&&(i.countdownPositionMs=i.state.positionMs,r.countdownPercent=100-(i.countdownPositionMs-i.state.outroCreditsStartMs)/n*100),i.setState(r),i.state.state===$P.UIPlaybackState.Playing&&i.state.state!==t?requestAnimationFrame(i.tickCountdown):i.previousTimestampMs=null},i.onTimelineInfoUpdated=function(e){i.didUnmount||i.setState({positionMs:e.positionMs})},i.onTitleInfoUpdated=function(e){i.didUnmount||i.setState({outroCreditsStartMs:e.outroCreditsStartMs})},i.onUiStatusUpdate=function(e){if(!i.didUnmount){var t=i.state.state;i.setState({state:e.state},function(){return i.onAutoplayInfo(i.state.autoplayInfo,t)})}},i.tickCountdown=function(e){if(i.state.state===$P.UIPlaybackState.Playing&&!i.didUnmount){null===i.previousTimestampMs&&(i.previousTimestampMs=e-15);var t=e-i.previousTimestampMs;i.previousTimestampMs=e,i.countdownPositionMs+=t;var n=t*(100/i.state.finalAutoplayTimerMs);A.timer.setImmediate(function(){i.setState({countdownPercent:i.state.countdownPercent-n},function(){return requestAnimationFrame(i.tickCountdown)})})}},i.state={autoplayInfo:{autoplayShowing:!1,autoplayTimerMs:null,canAutoplay:!1,isInSameSeries:!1,showAutoplayCard:!1,preferredImageName:null},countdownPercent:100,finalAutoplayTimerMs:0,outroCreditsStartMs:0,positionMs:0,state:$P.UIPlaybackState.Stopped},i}return n(e,t),e.prototype.componentDidMount=function(){this.onTitleInfoUpdated(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoUpdated),this.onAutoplayInfo(this.context.stores.nextTitle.getAutoplayInfo()),this.context.stores.nextTitle.onAutoplayInfoChange(this.onAutoplayInfo),this.onTimelineInfoUpdated(this.context.stores.timeline.getTimelineInfo()),this.context.stores.timeline.onUpdate(this.onTimelineInfoUpdated),this.onUiStatusUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUiStatusUpdate)},e.prototype.componentWillUnmount=function(){this.didUnmount=!0,this.context.stores.timeline.offUpdate(this.onTimelineInfoUpdated),this.context.stores.title.offUpdate(this.onTitleInfoUpdated),this.context.stores.uiStatus.offUpdate(this.onUiStatusUpdate)},e.prototype.render=function(){return Vn.createElement(wb.CountdownCircle,{className:this.props.countdownClassName,percent:this.state.countdownPercent})},e.contextType=QP.ReactContext,e}(Vn.PureComponent);t.NextUpCountdown=i});e(oC);oC.NextUpCountdown;var aC=t(function(e,t){var r,n,i,o,a=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var l=qS.styler(wb.debugClassName("nextupcard-wrapper"),{perspective:"400px"}),u=qS.styler({pointerEvents:"all",width:"100%",transformOrigin:"bottom",opacity:0,transform:"rotateX(30deg)",transition:"opacity 0.2s, transform 0.2s"}),c=qS.styler(wb.debugClassName("nextupcard-show"),{opacity:1,transform:"rotateX(0deg)"}),d=qS.styler({display:"flex",alignItems:"baseline"}),p=qS.styler(wb.debugClassName("nextupcard-title"),{flexGrow:1,fontWeight:"normal",textAlign:"left",$nest:s({},qS.RTLStyle({textAlign:"right"}))},qS.ScalableFontSize(17)),f=qS.styler({flexGrow:1,textAlign:"right",$nest:s({},qS.RTLStyle({textAlign:"left"}))}),h=qS.styler(wb.debugClassName("nextupcardhide-button"),{cursor:"pointer",opacity:.25,color:"#fff",fontWeight:"normal",backgroundColor:"transparent",boxShadow:"none",$nest:{"&:not(.disabled):hover":{opacity:1,backgroundColor:"transparent"}}},qS.ScalableHeight(18),qS.ScalableFontSize(15)),m={paddingRight:"0",lineHeight:"normal",minWidth:"0"},y=qS.styler({height:"100%"}),g=qS.styler({position:"absolute",bottom:"0",width:"100%",height:"50%",background:"linear-gradient(transparent, rgba(34,34,34,0.59))"}),v=qS.styler({position:"absolute",margin:"auto",left:"0",right:"0",top:"0",bottom:"0",borderRadius:"50%",backgroundColor:"rgba(0, 0, 0, 0.5)"},qS.ScalableWidth(60),qS.ScalableHeight(60)),S=qS.styler({position:"absolute",margin:"auto",left:"0",right:"0",top:"0",bottom:"0",opacity:.5}),b=qS.styler(S,qS.ScalableWidth(23),qS.ScalableHeight(23)),T=qS.styler({position:"absolute",margin:"auto",left:"0",right:"0",top:"0",bottom:"0"}),P=qS.styler(qS.ScalablePaddingLeft(2)),w=qS.styler(wb.debugClassName("nextupcard-episode"),{position:"absolute",fontWeight:"normal"},qS.ScalableBottom(5),qS.ScalableLeft(10),qS.ScalableFontSize(17)),C=qS.styler({float:"left",$nest:s({},qS.RTLStyle({float:"right"}))}),M=qS.styler({position:"absolute",$nest:s((n={},n["& > ."+C+":not(:first-child)"]=qS.ScaleNestedProperty("margin-left",5),n),qS.RTLStyle(s({},qS.ScaleNestedProperty("left",5),{$nest:(i={},i["& > ."+C+":not(:first-child)"]=qS.ScaleNestedProperty("margin-right",5),i)})))},qS.ScalableBottom(5),qS.ScalableRight(5)),I=qS.styler(wb.debugClassName("nextupcard-button"),{cursor:"pointer",width:"100%",position:"relative",$nest:(o={},o["&:hover > ."+T+" > svg > .background"]={fill:"rgba(0, 0, 0, 0.75)"},o["&:hover > ."+v]={backgroundColor:"rgba(0, 0, 0, 0.75)"},o["&:hover > ."+S]={opacity:1},o)},qS.ScalableMarginTop(7),qS.ScalableHeight(150)),E=function(t){function e(e){var n=t.call(this,e)||this;return n.currentAsin=null,n.hideTimeoutID=null,n.lock=null,n.onAutoplayInfoChange=function(e){n.setState({autoplay:e})},n.onModalInfoUpdate=function(e){n.setState({prePlaybackModalShowing:null!==e&&e.isPrePlayback})},n.onTimelineInfoUpdate=function(e){n.setState({endPositionMs:e.endPositionMs,positionMs:e.positionMs})},n.onTitleInfoUpdate=function(e){var t=xt.nestedValue(n.state,"hide",!1);e.titleId!==n.currentAsin&&!0===t&&(n.currentAsin=e.titleId,t=!1,n.context.stores.nextTitle.nextUpHidden(!1)),n.setState({contentType:e.contentType,nextTitle:e.nextTitle,outroCreditsStartMs:e.outroCreditsStartMs,hide:t})},n.onUIConfigurationsChange=function(e){n.setState({enableNextUp:e.enableNextUp})},n.onUiStatusUpdate=function(e){n.setState({state:e.state})},n.onNextUpInfoUpdate=function(e){n.setState({autoplayShowing:e.nextUpAutoplayShowing})},n.onClick=function(){var e=xt.nestedValue(n.state,'nextTitle.titleId',null);n.context.stores.nextTitle.nextTitleInitiated(HP.NextTitleTransition.Card,e),n.unlockUI()},n.onClickHide=function(){n.context.stores.nextTitle.nextUpHidden(!0),n.setState({hide:!0}),n.unlockUI()},n.positionIsCloseToEnd=function(e){return 0!==n.state.endPositionMs&&n.state.endPositionMs-e<=3e3},n.shouldShow=function(e){return!(xt.isNullOrUndefined(e.autoplay)||xt.isNullOrUndefined(e.nextTitle)||xt.isNullOrUndefined(e.state)||xt.isNullOrUndefined(e.positionMs)||xt.isNullOrUndefined(e.outroCreditsStartMs)||xt.isNullOrUndefined(e.contentType))&&(e.state!==$P.UIPlaybackState.Stopped&&e.state!==$P.UIPlaybackState.Loading&&e.state!==$P.UIPlaybackState.Error&&e.enableNextUp&&e.autoplay.showAutoplayCard&&e.nextTitle.isPlayable&&e.positionMs>=e.outroCreditsStartMs&&!e.prePlaybackModalShowing&&e.contentType!==_P.ContentType.Ad)},n.canRenderCard=function(e){return e=xt.withDefault(e,n.state),n.shouldShow(e)&&(!e.hide&&e.imageLoaded||n.positionIsCloseToEnd(e.positionMs))},n.onHideTimeout=function(){n.setState({closed:!0})},n.onMouseEnter=function(){null!==n.lock&&n.lock.lock(wb.UITimeoutMS.Hover20s)},n.onMouseLeave=function(){n.unlockUI()},n.unlockUI=function(){null!==n.lock&&n.lock.unlock()},n.onImageLoaded=function(){n.setState({imageLoaded:!0})},n.state={autoplay:{autoplayShowing:!1,autoplayTimerMs:null,canAutoplay:!1,isInSameSeries:!1,showAutoplayCard:!1,preferredImageName:null},closed:!0,contentType:_P.ContentType.VOD,countdownPercent:100,endPositionMs:null,hide:!1,imageLoaded:!1,nextTitle:null,positionMs:0,prePlaybackModalShowing:!1,state:$P.UIPlaybackState.Stopped},n}return a(e,t),e.prototype.componentDidMount=function(){this.lock=this.context.stores.lock.newLock(),this.imageLoaderRef.addEventListener("load",this.onImageLoaded),this.onAutoplayInfoChange(this.context.stores.nextTitle.getAutoplayInfo()),this.context.stores.nextTitle.onAutoplayInfoChange(this.onAutoplayInfoChange),this.onModalInfoUpdate(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalInfoUpdate),this.onNextUpInfoUpdate(this.context.stores.nextUpInfo.getNextUpInfo()),this.context.stores.nextUpInfo.onUpdate(this.onNextUpInfoUpdate),this.onTimelineInfoUpdate(this.context.stores.timeline.getTimelineInfo()),this.context.stores.timeline.onUpdate(this.onTimelineInfoUpdate),this.onTitleInfoUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoUpdate),this.onUIConfigurationsChange(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsChange),this.onUiStatusUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUiStatusUpdate)},e.prototype.componentWillUnmount=function(){this.imageLoaderRef.removeEventListener("load",this.onImageLoaded),this.context.stores.modal.offUpdate(this.onModalInfoUpdate),this.context.stores.nextTitle.offAutoplayInfoChange(this.onAutoplayInfoChange),this.context.stores.nextUpInfo.offUpdate(this.onNextUpInfoUpdate),this.context.stores.timeline.offUpdate(this.onTimelineInfoUpdate),this.context.stores.title.offUpdate(this.onTitleInfoUpdate),this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsChange),this.context.stores.uiStatus.offUpdate(this.onUiStatusUpdate),this.imageLoaderRef=null,this.nextUpRef=null,this.context.stores.lock.deleteLock(this.lock),this.lock=null},e.prototype.componentWillUpdate=function(e,t){var n={};this.shouldShow(t)||this.state.imageLoaded&&(n.imageLoaded=!1),this.canRenderCard(t)?(clearTimeout(this.hideTimeoutID),this.nextUpRef.style.opacity="",this.state.closed&&(n.closed=!1,this.state.autoplayShowing||this.context.stores.nextUpInfo.updateNextUpAutoplayStatus(!0))):(this.unlockUI(),clearTimeout(this.hideTimeoutID),this.state.closed||(this.hideTimeoutID=A.timer.setTimeout(this.onHideTimeout,200),this.state.autoplayShowing&&this.context.stores.nextUpInfo.updateNextUpAutoplayStatus(!1))),F.isEmpty(n)||this.setState(n)},e.prototype.render=function(){var e,t=this,n=PS(u,((e={})[c]=this.canRenderCard(),e)),r="";this.shouldShow(this.state)&&xt.exists(this.state.nextTitle)&&(r="episode"===this.state.autoplay.preferredImageName?xt.withDefault(this.state.nextTitle.episodeImageUrl,this.state.nextTitle.titleImageUrl):this.state.nextTitle.titleImageUrl);var i=null,o=this.context.stores.localization.getLocalization();return xt.exists(this.state.nextTitle)&&!this.state.closed&&(i=Vn.createElement("div",null,Vn.createElement("div",{className:d},Vn.createElement("div",{className:p},o.nextUp),this.positionIsCloseToEnd(this.state.positionMs)?null:Vn.createElement("div",{className:f},Vn.createElement(wb.Button,{className:h,onClick:this.onClickHide,style:m},o.hide))),Vn.createElement("div",{className:I,onClick:this.onClick},Vn.createElement("img",{className:y,src:r}),Vn.createElement("div",{className:g}),this.state.autoplay.canAutoplay?Vn.createElement(oC.NextUpCountdown,{countdownClassName:T}):Vn.createElement("div",{className:v}),Vn.createElement("div",{className:b},Vn.createElement(wb.SVGImage,{className:P,src:Ww.SVG.Play})),xt.exists(this.state.nextTitle.episodeNumber)?Vn.createElement("div",{className:w},o.episodeShort+" "+this.state.nextTitle.episodeNumber):null,Vn.createElement("div",{className:M},this.state.nextTitle.hasCaptions?Vn.createElement(wb.Label,{labelClassName:C},o.closedCaptionsShort):null,xt.exists(this.state.nextTitle.regulatoryRating)?Vn.createElement(wb.Label,{labelClassName:C},this.state.nextTitle.regulatoryRating):null)))),Vn.createElement("div",{className:l,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},Vn.createElement("div",{className:n,ref:function(e){t.nextUpRef=e}},i),Vn.createElement("img",{src:r,ref:function(e){t.imageLoaderRef=e},style:{display:"none"}}))},e.contextType=QP.ReactContext,e}(Vn.Component);t.NextUpCard=E});e(aC);aC.NextUpCard;var sC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,d=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,h=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116;function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case d:case o:case s:case a:case f:return e;default:switch(e=e&&e.$$typeof){case u:case p:case l:return e;default:return t}}case m:case h:case i:return t}}}function g(e){return y(e)===d}t.typeOf=y,t.AsyncMode=c,t.ConcurrentMode=d,t.ContextConsumer=u,t.ContextProvider=l,t.Element=r,t.ForwardRef=p,t.Fragment=o,t.Lazy=m,t.Memo=h,t.Portal=i,t.Profiler=s,t.StrictMode=a,t.Suspense=f,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===d||e===s||e===a||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===h||e.$$typeof===l||e.$$typeof===u||e.$$typeof===p)},t.isAsyncMode=function(e){return g(e)||y(e)===c},t.isConcurrentMode=g,t.isContextConsumer=function(e){return y(e)===u},t.isContextProvider=function(e){return y(e)===l},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return y(e)===p},t.isFragment=function(e){return y(e)===o},t.isLazy=function(e){return y(e)===m},t.isMemo=function(e){return y(e)===h},t.isPortal=function(e){return y(e)===i},t.isProfiler=function(e){return y(e)===s},t.isStrictMode=function(e){return y(e)===a},t.isSuspense=function(e){return y(e)===f}});e(sC);sC.typeOf,sC.AsyncMode,sC.ConcurrentMode,sC.ContextConsumer,sC.ContextProvider,sC.Element,sC.ForwardRef,sC.Fragment,sC.Lazy,sC.Memo,sC.Portal,sC.Profiler,sC.StrictMode,sC.Suspense,sC.isValidElementType,sC.isAsyncMode,sC.isConcurrentMode,sC.isContextConsumer,sC.isContextProvider,sC.isElement,sC.isForwardRef,sC.isFragment,sC.isLazy,sC.isMemo,sC.isPortal,sC.isProfiler,sC.isStrictMode,sC.isSuspense;var lC=t(function(e,t){});e(lC);lC.typeOf,lC.AsyncMode,lC.ConcurrentMode,lC.ContextConsumer,lC.ContextProvider,lC.Element,lC.ForwardRef,lC.Fragment,lC.Lazy,lC.Memo,lC.Portal,lC.Profiler,lC.StrictMode,lC.Suspense,lC.isValidElementType,lC.isAsyncMode,lC.isConcurrentMode,lC.isContextConsumer,lC.isContextProvider,lC.isElement,lC.isForwardRef,lC.isFragment,lC.isLazy,lC.isMemo,lC.isPortal,lC.isProfiler,lC.isStrictMode,lC.isSuspense,t(function(e){e.exports=sC}),Function.call.bind(Object.prototype.hasOwnProperty);function uC(){}function cC(){}cC.resetWarningCache=uC;var dC=t(function(e){e.exports=function(){function e(e,t,n,r,i,o){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==o){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name='Invariant Violation',a}}function t(){return e}var n={array:e.isRequired=e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:cC,resetWarningCache:uC};return n.PropTypes=n}()}),pC=t(function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}}});e(pC);var fC=t(function(e,t){t.__esModule=!0,t.default=function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")},e.exports=t.default});e(fC);var hC=t(function(e,t){t.__esModule=!0,t.default=function(e,t){e.classList?e.classList.add(t):(0,n.default)(e,t)||('string'==typeof e.className?e.className=e.className+' '+t:e.setAttribute('class',(e.className&&e.className.baseVal||'')+' '+t))};var n=pC(fC);e.exports=t.default});function mC(e,t){return e.replace(new RegExp('(^|\\s)'+t+'(?:\\s|$)','g'),'$1').replace(/\s+/g,' ').replace(/^\s*|\s*$/g,'')}e(hC);var yC=function(e,t){e.classList?e.classList.remove(t):'string'==typeof e.className?e.className=mC(e.className,t):e.setAttribute('class',mC(e.className&&e.className.baseVal||'',t))},gC=t(function(e,t){function l(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!=e&&this.setState(e)}function u(n){this.setState(function(e){var t=this.constructor.getDerivedStateFromProps(n,e);return null!=t?t:null}.bind(this))}function c(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}Object.defineProperty(t,'__esModule',{value:!0}),c.__suppressDeprecationWarning=u.__suppressDeprecationWarning=l.__suppressDeprecationWarning=!0,t.polyfill=function(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error('Can only polyfill class components');if('function'!=typeof e.getDerivedStateFromProps&&'function'!=typeof t.getSnapshotBeforeUpdate)return e;var n=null,r=null,i=null;if('function'==typeof t.componentWillMount?n='componentWillMount':'function'==typeof t.UNSAFE_componentWillMount&&(n='UNSAFE_componentWillMount'),'function'==typeof t.componentWillReceiveProps?r='componentWillReceiveProps':'function'==typeof t.UNSAFE_componentWillReceiveProps&&(r='UNSAFE_componentWillReceiveProps'),'function'==typeof t.componentWillUpdate?i='componentWillUpdate':'function'==typeof t.UNSAFE_componentWillUpdate&&(i='UNSAFE_componentWillUpdate'),null!==n||null!==r||null!==i){var o=e.displayName||e.name,a='function'==typeof e.getDerivedStateFromProps?'getDerivedStateFromProps()':'getSnapshotBeforeUpdate()';throw Error('Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n'+o+' uses '+a+' but also contains the following legacy lifecycles:'+(null!==n?'\n  '+n:'')+(null!==r?'\n  '+r:'')+(null!==i?'\n  '+i:'')+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if('function'==typeof e.getDerivedStateFromProps&&(t.componentWillMount=l,t.componentWillReceiveProps=u),'function'==typeof t.getSnapshotBeforeUpdate){if('function'!=typeof t.componentDidUpdate)throw new Error('Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype');t.componentWillUpdate=c;var s=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;s.call(this,e,t,r)}}return e}});e(gC);gC.polyfill;var vC=t(function(e,t){t.__esModule=!0,t.default=t.EXITING=t.ENTERED=t.ENTERING=t.EXITED=t.UNMOUNTED=void 0;var n=function(e){{if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}return t.default=e,t}}(dC),o=r(Vn),i=r(Ld);function r(e){return e&&e.__esModule?e:{default:e}}var s='unmounted';t.UNMOUNTED=s;var l='exited';t.EXITED=l;var u='entering';t.ENTERING=u;var c='entered';t.ENTERED=c;var d='exiting';t.EXITING=d;var a=function(a){var e,t;function n(e,t){var n;n=a.call(this,e,t)||this;var r,i=t.transitionGroup,o=i&&!i.isMounting?e.enter:e.appear;return n.appearStatus=null,e.in?o?(r=l,n.appearStatus=u):r=c:r=e.unmountOnExit||e.mountOnEnter?s:l,n.state={status:r},n.nextCallback=null,n}t=a,(e=n).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var r=n.prototype;return r.getChildContext=function(){return{transitionGroup:null}},n.getDerivedStateFromProps=function(e,t){return e.in&&t.status===s?{status:l}:null},r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==u&&n!==c&&(t=u):n!==u&&n!==c||(t=d)}this.updateStatus(!1,t)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,t,n,r=this.props.timeout;return e=t=n=r,null!=r&&'number'!=typeof r&&(e=r.exit,t=r.enter,n=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:n}},r.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){this.cancelNextCallback();var n=i.default.findDOMNode(this);t===u?this.performEnter(n,e):this.performExit(n)}else this.props.unmountOnExit&&this.state.status===l&&this.setState({status:s})},r.performEnter=function(e,t){var n=this,r=this.props.enter,i=this.context.transitionGroup?this.context.transitionGroup.isMounting:t,o=this.getTimeouts(),a=i?o.appear:o.enter;t||r?(this.props.onEnter(e,i),this.safeSetState({status:u},function(){n.props.onEntering(e,i),n.onTransitionEnd(e,a,function(){n.safeSetState({status:c},function(){n.props.onEntered(e,i)})})})):this.safeSetState({status:c},function(){n.props.onEntered(e)})},r.performExit=function(e){var t=this,n=this.props.exit,r=this.getTimeouts();n?(this.props.onExit(e),this.safeSetState({status:d},function(){t.props.onExiting(e),t.onTransitionEnd(e,r.exit,function(){t.safeSetState({status:l},function(){t.props.onExited(e)})})})):this.safeSetState({status:l},function(){t.props.onExited(e)})},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},r.setNextCallback=function(t){var n=this,r=!0;return this.nextCallback=function(e){r&&(r=!1,n.nextCallback=null,t(e))},this.nextCallback.cancel=function(){r=!1},this.nextCallback},r.onTransitionEnd=function(e,t,n){this.setNextCallback(n);var r=null==t&&!this.props.addEndListener;e&&!r?(this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback),null!=t&&setTimeout(this.nextCallback,t)):setTimeout(this.nextCallback,0)},r.render=function(){var e=this.state.status;if(e===s)return null;var t=this.props,n=t.children,r=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],0<=t.indexOf(n)||(i[n]=e[n]);return i}(t,["children"]);if(delete r.in,delete r.mountOnEnter,delete r.unmountOnExit,delete r.appear,delete r.enter,delete r.exit,delete r.timeout,delete r.addEndListener,delete r.onEnter,delete r.onEntering,delete r.onEntered,delete r.onExit,delete r.onExiting,delete r.onExited,'function'==typeof n)return n(e,r);var i=o.default.Children.only(n);return o.default.cloneElement(i,r)},n}(o.default.Component);function p(){}a.contextTypes={transitionGroup:n.object},a.childContextTypes={transitionGroup:function(){}},a.propTypes={},a.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:p,onEntering:p,onEntered:p,onExit:p,onExiting:p,onExited:p},a.UNMOUNTED=0,a.EXITED=1,a.ENTERING=2,a.ENTERED=3,a.EXITING=4;var f=(0,gC.polyfill)(a);t.default=f});e(vC);vC.EXITING,vC.ENTERED,vC.ENTERING,vC.EXITED,vC.UNMOUNTED;var SC=t(function(e,t){t.__esModule=!0,t.default=void 0;!function(e){{if(e&&e.__esModule)return;var t={};if(null!=e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,n):{};r.get||r.set?Object.defineProperty(t,n,r):t[n]=e[n]}t.default=e}}(dC);var n=i(hC),r=i(yC),o=i(Vn),a=i(vC);function i(e){return e&&e.__esModule?e:{default:e}}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=function(t,e){return t&&e&&e.split(' ').forEach(function(e){return(0,n.default)(t,e)})},u=function(t,e){return t&&e&&e.split(' ').forEach(function(e){return(0,r.default)(t,e)})},c=function(i){var e,t;function n(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=i.call.apply(i,[this].concat(t))||this).onEnter=function(e,t){var n=r.getClassNames(t?'appear':'enter').className;r.removeClasses(e,'exit'),l(e,n),r.props.onEnter&&r.props.onEnter(e,t)},r.onEntering=function(e,t){var n=r.getClassNames(t?'appear':'enter').activeClassName;r.reflowAndAddClass(e,n),r.props.onEntering&&r.props.onEntering(e,t)},r.onEntered=function(e,t){var n=r.getClassNames('enter').doneClassName;r.removeClasses(e,t?'appear':'enter'),l(e,n),r.props.onEntered&&r.props.onEntered(e,t)},r.onExit=function(e){var t=r.getClassNames('exit').className;r.removeClasses(e,'appear'),r.removeClasses(e,'enter'),l(e,t),r.props.onExit&&r.props.onExit(e)},r.onExiting=function(e){var t=r.getClassNames('exit').activeClassName;r.reflowAndAddClass(e,t),r.props.onExiting&&r.props.onExiting(e)},r.onExited=function(e){var t=r.getClassNames('exit').doneClassName;r.removeClasses(e,'exit'),l(e,t),r.props.onExited&&r.props.onExited(e)},r.getClassNames=function(e){var t=r.props.classNames,n='string'!=typeof t?t[e]:t+'-'+e;return{className:n,activeClassName:'string'!=typeof t?t[e+'Active']:n+'-active',doneClassName:'string'!=typeof t?t[e+'Done']:n+'-done'}},r}t=i,(e=n).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var r=n.prototype;return r.removeClasses=function(e,t){var n=this.getClassNames(t),r=n.className,i=n.activeClassName,o=n.doneClassName;r&&u(e,r),i&&u(e,i),o&&u(e,o)},r.reflowAndAddClass=function(e,t){t&&(e&&e.scrollTop,l(e,t))},r.render=function(){var e=s({},this.props);return delete e.classNames,o.default.createElement(a.default,s({},e,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},n}(o.default.Component);c.propTypes={};var d=c;t.default=d,e.exports=t.default});e(SC);var bC=t(function(e,t){function r(e,n){var r=Object.create(null);return e&&Vn.Children.map(e,function(e){return e}).forEach(function(e){var t;r[e.key]=(t=e,n&&(0,Vn.isValidElement)(t)?n(t):t)}),r}function n(t,n){function e(e){return e in n?n[e]:t[e]}t=t||{},n=n||{};var r,i=Object.create(null),o=[];for(var a in t)a in n?o.length&&(i[a]=o,o=[]):o.push(a);var s={};for(var l in n){if(i[l])for(r=0;r<i[l].length;r++){var u=i[l][r];s[i[l][r]]=e(u)}s[l]=e(l)}for(r=0;r<o.length;r++)s[o[r]]=e(o[r]);return s}function d(e,t,n){return null!=n[t]?n[t]:e.props[t]}t.__esModule=!0,t.getChildMapping=r,t.mergeChildMappings=n,t.getInitialChildMapping=function(t,n){return r(t.children,function(e){return(0,Vn.cloneElement)(e,{onExited:n.bind(null,e),in:!0,appear:d(e,'appear',t),enter:d(e,'enter',t),exit:d(e,'exit',t)})})},t.getNextChildMapping=function(a,s,l){var u=r(a.children),c=n(s,u);return Object.keys(c).forEach(function(e){var t=c[e];if((0,Vn.isValidElement)(t)){var n=e in s,r=e in u,i=s[e],o=(0,Vn.isValidElement)(i)&&!i.props.in;!r||n&&!o?r||!n||o?r&&n&&(0,Vn.isValidElement)(i)&&(c[e]=(0,Vn.cloneElement)(t,{onExited:l.bind(null,t),in:i.props.in,exit:d(t,'exit',a),enter:d(t,'enter',a)})):c[e]=(0,Vn.cloneElement)(t,{in:!1}):c[e]=(0,Vn.cloneElement)(t,{onExited:l.bind(null,t),in:!0,exit:d(t,'exit',a),enter:d(t,'enter',a)})}}),c}});e(bC);bC.getChildMapping,bC.mergeChildMappings,bC.getInitialChildMapping,bC.getNextChildMapping;var TC=t(function(e,t){t.__esModule=!0,t.default=void 0;var n=r(dC),o=r(Vn);function r(e){return e&&e.__esModule?e:{default:e}}function a(){return(a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var l=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},i=function(i){var e,t;function n(e,t){var n,r=(n=i.call(this,e,t)||this).handleExited.bind(s(s(n)));return n.state={handleExited:r,firstRender:!0},n}t=i,(e=n).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var r=n.prototype;return r.getChildContext=function(){return{transitionGroup:{isMounting:!this.appeared}}},r.componentDidMount=function(){this.appeared=!0,this.mounted=!0},r.componentWillUnmount=function(){this.mounted=!1},n.getDerivedStateFromProps=function(e,t){var n=t.children,r=t.handleExited;return{children:t.firstRender?(0,bC.getInitialChildMapping)(e,r):(0,bC.getNextChildMapping)(e,n,r),firstRender:!1}},r.handleExited=function(n,e){var t=(0,bC.getChildMapping)(this.props.children);n.key in t||(n.props.onExited&&n.props.onExited(e),this.mounted&&this.setState(function(e){var t=a({},e.children);return delete t[n.key],{children:t}}))},r.render=function(){var e=this.props,t=e.component,n=e.childFactory,r=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,["component","childFactory"]),i=l(this.state.children).map(n);return delete r.appear,delete r.enter,delete r.exit,null===t?i:o.default.createElement(t,r,i)},n}(o.default.Component);i.childContextTypes={transitionGroup:n.default.object.isRequired},i.propTypes={},i.defaultProps={component:'div',childFactory:function(e){return e}};var u=(0,gC.polyfill)(i);t.default=u,e.exports=t.default});e(TC);var PC=t(function(e,t){t.__esModule=!0,t.default=void 0;n(dC);var s=n(Vn),l=n(TC);function n(e){return e&&e.__esModule?e:{default:e}}var r=function(i){var e,t;function n(){for(var r,e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(r=i.call.apply(i,[this].concat(t))||this).handleEnter=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.handleLifecycle('onEnter',0,t)},r.handleEntering=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.handleLifecycle('onEntering',0,t)},r.handleEntered=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.handleLifecycle('onEntered',0,t)},r.handleExit=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.handleLifecycle('onExit',1,t)},r.handleExiting=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.handleLifecycle('onExiting',1,t)},r.handleExited=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.handleLifecycle('onExited',1,t)},r}t=i,(e=n).prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t;var r=n.prototype;return r.handleLifecycle=function(e,t,n){var r,i=this.props.children,o=s.default.Children.toArray(i)[t];o.props[e]&&(r=o.props)[e].apply(r,n),this.props[e]&&this.props[e]((0,Ld.findDOMNode)(this))},r.render=function(){var e=this.props,t=e.children,n=e.in,r=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,["children","in"]),i=s.default.Children.toArray(t),o=i[0],a=i[1];return delete r.onEnter,delete r.onEntering,delete r.onEntered,delete r.onExit,delete r.onExiting,delete r.onExited,s.default.createElement(l.default,r,n?s.default.cloneElement(o,{key:'first',onEnter:this.handleEnter,onEntering:this.handleEntering,onEntered:this.handleEntered}):s.default.cloneElement(a,{key:'second',onEnter:this.handleExit,onEntering:this.handleExiting,onEntered:this.handleExited}))},n}(s.default.Component);r.propTypes={};var i=r;t.default=i,e.exports=t.default});e(PC);var wC=t(function(e){var t=o(SC),n=o(PC),r=o(TC),i=o(vC);function o(e){return e&&e.__esModule?e:{default:e}}e.exports={Transition:i.default,TransitionGroup:r.default,ReplaceTransition:n.default,CSSTransition:t.default}});e(wC);wC.Transition,wC.TransitionGroup,wC.ReplaceTransition,wC.CSSTransition;var CC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({pointerEvents:"auto",boxSizing:"border-box !important",overflow:"auto",userSelect:"auto",width:"100%",backgroundColor:"#333",boxShadow:"2px 2px 3px rgba(0, 0, 0, .3)",textAlign:"left",color:qS.TextColor,fontWeight:"normal",transformOrigin:"bottom",$nest:{"&:not(:last-child)":qS.ScaleNestedProperty("margin-bottom",15)}},qS.ScaleProperty("border-radius",4),qS.ScalablePadding(10),qS.ScalableFontSize(17)),a=qS.styler({float:"right",cursor:"point",backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundImage:"url("+Ww.SVG.ModalCloseUp+")",$nest:{"&:hover":{backgroundImage:"url("+Ww.SVG.ModalCloseOver+")"},"& a":{userSelect:"none",cursor:"pointer"}}},qS.ScalableHeight(10),qS.ScalableWidth(10)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.lock=null,t.onMouseEnter=function(){t.lock.lock(),t.setState({mouseInNotification:!0})},t.onMouseLeave=function(){t.lock.unlock(),t.setState({mouseInNotification:!1})},t.onClickClose=function(){F.isFunction(t.props.onClickClose)&&t.props.onClickClose()},t.state={mouseInNotification:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.lock=this.context.stores.lock.newLock()},e.prototype.componentWillUnmount=function(){this.context.stores.lock.deleteLock(this.lock)},e.prototype.render=function(){var e=PS(o,{show:this.props.show});return Vn.createElement("div",{className:e,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},this.props.closable?Vn.createElement("div",{className:a,onClick:this.onClickClose}):null,this.props.children)},e.contextType=QP.ReactContext,e.defaultProps={closable:!0,onClickClose:null,show:!1,children:null},e}(Vn.PureComponent);t.NotificationView=n});e(CC);CC.NotificationView;var MC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n="opacity 0.2s, transform 0.2s",o=qS.styler({opacity:0,transform:"rotateX(30deg)",transition:n}),a=qS.styler({opacity:1,transform:"rotateX(0deg)",transition:n}),s=qS.styler({opacity:1,transform:"rotateX(0deg)",transition:n}),l=qS.styler({opacity:0,transform:"rotateX(30deg)",transition:n}),u={enter:o,enterActive:a,enterDone:a,exit:s,exitActive:l,exitDone:l},c=qS.styler({width:"100%",perspective:"400px"}),d=function(n){function e(e){var t=n.call(this,e)||this;return t.onNotificationsChange=function(e){t.setState({notifications:e})},t.onClickClose=function(e){t.context.stores.notifications.cancelNotification(e)},t.getNotifications=function(){return F.isEmpty(t.state.notifications)?null:t.state.notifications.map(function(e){return Vn.createElement(wC.CSSTransition,{key:e.getID(),classNames:u,timeout:{enter:500,exit:300}},Vn.createElement(CC.NotificationView,{onClickClose:function(){return t.onClickClose(e)},closable:e.isClosable()},e.getContents()))})},t.state={notifications:[]},t}return i(e,n),e.prototype.componentDidMount=function(){this.onNotificationsChange(this.context.stores.notifications.getNotifications()),this.context.stores.notifications.onNotifications(this.onNotificationsChange)},e.prototype.componentWillUnmount=function(){this.context.stores.notifications.offNotifications(this.onNotificationsChange)},e.prototype.render=function(){return Vn.createElement("div",{className:c},Vn.createElement(wC.TransitionGroup,null,this.getNotifications()))},e.contextType=QP.ReactContext,e}(Vn.Component);t.Notifications=d});e(MC);MC.Notifications;var IC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function r(){}return r.extractFontShear=function(e){var t=e.fontShear;return null==t?null:(delete e.fontShear,{fontShear:t})},r.hexAndAlphaToRgba=function(e,t){var n=r.hexToRgb(e);return null===n?null:(n[3]=t,"rgba("+n.join(", ")+")")},r.isVerticalWritingMode=function(e){if(null==e)return!1;var t=e.substr(0,2);return-1<e.indexOf("vertical")||"tb"===t||"bt"===t},r.hexToRgb=function(e){var t=e.match(/#([0-9a-fA-F]{1,2})([0-9a-fA-F]{1,2})([0-9a-fA-F]{1,2})/);if(null===t||4!==t.length)return null;for(var n=[],r=0;r<3;++r){var i=1===t[r+1].length;n[r]=i?parseInt("0x"+t[1+r]+t[1+r]):parseInt("0x"+t[1+r])}return n},r}();t.CssUtils=n});e(IC);IC.CssUtils;var EC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.FontEdgeMap={no:{textShadow:""},raised:{textShadow:"-1px 0 0 silver, 0 -1px 0 silver, 0 1px 0 #111111, 1px 0 0 #111111"},depressed:{textShadow:"1px 0 0 silver, 0 1px 0 silver, 0 -1px 0 #111111, -1px 0 0 #111111"},uniform:{textShadow:"2px 0 0 #000, 0 -2px 0 #000, 0 2px 0 #000, -2px 0 0 #000, 1px 1px 0 #000, -1px 1px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000"},shadow:{textShadow:"2px 2px 2px #000"}}});e(EC);EC.FontEdgeMap;var _C=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.FontMap={default:{},monospaceSerif:{fontFamily:"\"Courier New\",Courier,monospace,monospaced,mono,Serif"},proportionalSerif:{fontFamily:"\"Times New Roman\",Times,Serif"},monospaceSansSerif:{fontFamily:"\"Lucida Console\",Monaco,\"Helvetica Monospaced\",monospace,mono,sans-serif"},proportionalSansSerif:{fontFamily:"Arial,Helvetica,sans-serif"},casual:{fontFamily:"\"Comic Sans MS\",cursive,sans-serif"},cursive:{fontFamily:"\"Comic Sans MS\",cursive,sans-serif"},smallCapitals:{fontFamily:"\"Palatino Linotype\",\"engravers gothic\",serif",fontVariant:"small-caps"}}});e(_C);_C.FontMap;var xC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.displayAlignDecorator=function(e){switch(e.displayAlign){case"after":return{alignItems:"flex-end"};case"center":return{alignItems:"center"};case"before":return{alignItems:"flex-start"};default:return{}}}});e(xC);xC.displayAlignDecorator;var kC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("extentDecorator");t.extentDecorator=function(e){var t=e.extent;if(null==t)return{};var n=t.split(" ");return n.length<2?(r.warn("tts.extent '"+t+"' doesn't contain at least two values for width & height"),{}):{width:n[0],height:n[1]}}});e(kC);kC.extentDecorator;var RC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fontShearDecorator=function(e,t){void 0===t&&(t={});var n=e.fontShear;if(null==n)return{};var r=parseFloat(n)/100*-90,i="skewX";return IC.CssUtils.isVerticalWritingMode(t.writingMode)&&(i="skewY"),{transform:i+"("+r+"deg)"}}});e(RC);RC.fontShearDecorator;var AC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fontSizeDecorator=function(e){var t=e.fontSize;if(null==t)return{};var n=t.split(" ");return{fontSize:n[n.length-1]}}});e(AC);AC.fontSizeDecorator;var OC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("originDecorator");t.originDecorator=function(e){var t=e.origin;if(null==t||"auto"===t)return{};var n=t.split(" ");return n.length<2?(r.warn("tts.origin '"+t+"' doesn't contain at least two values for left & right"),{}):{left:n[0],top:n[1]}}});e(OC);OC.originDecorator;var LC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.positionDecorator=function(e){var t=e.position;if(null==t)return{};for(var n={left:"0",right:"0",marginLeft:"auto",marginRight:"auto"},r={top:"0",bottom:"0",marginTop:"auto",marginBottom:"auto"},i={},o=t.split(" "),a=0;a<o.length;a++){var s=o[a];if("center"===s)0===a?F.extend(i,n):F.extend(i,r);else if(isNaN(parseFloat(s))){var l=o[a+1],u=2<o.length&&!isNaN(parseFloat(l));i[s]=u?l:"0",u&&a++}else 0===a?i.left=s:i.top=s}return""===i.left&&""===i.right&&F.extend(i,n),""===i.top&&""===i.bottom&&F.extend(i,r),i}});e(LC);LC.positionDecorator;var FC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={over:"before",under:"after"};t.rubyPositionDecorator=function(e){var t=e.rubyPosition;if(null==t)return{};if("CSS"in window&&(CSS.supports("ruby-position","after")||CSS.supports("-webkit-ruby-position","after"))){var n=r[t];return{rubyPosition:n=null!=n?n:t,WebkitRubyPosition:n}}return{rubyPosition:t,WebkitRubyPosition:t}}});e(FC);FC.rubyPositionDecorator;var DC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.textCombineDecorator=function(e){var t=e.textCombine;return null==t?{}:{textCombineUpright:t,msTextCombineHorizontal:t,WebkitTextCombine:"all"===t?"horizontal":""}}});e(DC);DC.textCombineDecorator;var NC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.writingModeDecorator=function(e){var t=e.writingMode;if(null==t)return{};if(Xh.getBrowser().getType()===Xh.BrowserType.IE){var n=t;return 4===n.length&&(n=n.replace(/(.{2})(.{2})/,"$1-$2")),{writingMode:n,msWritingMode:n}}var r={lrtb:"horizontal-tb",rltb:"horizontal-tb",tbrl:"vertical-rl",tblr:"vertical-lr",lr:"horizontal-tb",rl:"horizontal-tb",tb:"vertical-rl"}[t];return{WebkitWritingMode:r,writingMode:r}}});e(NC);NC.writingModeDecorator;var UC=t(function(e,t){var i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=["background","backgroundColor","color","displayAlign","extent","fontFamily","fontShear","fontSize","origin","position","ruby","rubyPosition","showBackground","textCombine","textOutline","unicodeBidi","wrapOption"],r=function(){function e(){}return e.ttsObjectToCssObject=function(e,t){var n={};for(var r in e)this.attributeIsCss(r)&&(n[r]=e[r]);return i({},n,xC.displayAlignDecorator(e),kC.extentDecorator(e),RC.fontShearDecorator(e,t),AC.fontSizeDecorator(e),OC.originDecorator(e),LC.positionDecorator(e),FC.rubyPositionDecorator(e),DC.textCombineDecorator(e),NC.writingModeDecorator(e))},e.attributeIsCss=function(e){return!F.contains(n,e)},e}();t.TTSConverter=r});e(UC);UC.TTSConverter;var BC=t(function(e,l){function u(e,t){return e*("small"===t?l.SmallDisplayFactor:l.LargeDisplayFactor)+"vw"}Object.defineProperty(l,"__esModule",{value:!0}),l.SmallBreakpoint=1919,l.TargetBreakpoint=1920,l.LargeBreakpoint=1921,l.SmallDisplayFactor=100/l.SmallBreakpoint,l.LargeDisplayFactor=100/l.LargeBreakpoint,l.FontLight=function(){return qS.styler({fontWeight:100})},l.FontNormal=function(){return qS.styler({fontWeight:400})},l.FontBold=function(){return qS.styler({fontWeight:700})},l.FontHeavy=function(){return qS.styler({fontWeight:1e3})},l.ScaleProperty=function(e,t,n){var r,i,o,a,s;return void 0===n&&(n=!1),qS.styler(((r={})[e]=t+"px"+(n?" important":""),r),((i={})[e]=u(t,"small"),s=i,Vd.media({maxWidth:l.SmallBreakpoint},s)),((o={})[e]=u(t,"large"),a=o,Vd.media({minWidth:l.LargeBreakpoint},a)))}});e(BC);BC.SmallBreakpoint,BC.TargetBreakpoint,BC.LargeBreakpoint,BC.SmallDisplayFactor,BC.LargeDisplayFactor,BC.FontLight,BC.FontNormal,BC.FontBold,BC.FontHeavy,BC.ScaleProperty;var VC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),h=V&&V.__assign||function(){return(h=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s={position:"absolute",bottom:"30px",left:"0",right:"0",marginLeft:"auto",marginRight:"auto",width:"80%",height:"15%",textAlign:"center",display:"flex",alignItems:"flex-end"},o={backgroundColor:"rgba(0, 0, 0, 0)"},a={backgroundColor:"rgba(0, 0, 0, 0.5)",color:"rgb(255, 255, 255)",fontSize:"32px"},l=qS.styler({width:"100%",height:"100%",position:"relative",fontFamily:"Arial, sans-serif"}),m=qS.styler({display:"inline-block",padding:"10px"}),y=qS.styler(wb.debugClassName("captions-text"),{display:"inline-block",verticalAlign:"text-bottom",padding:"10px"}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onDisplayStatusChange=function(e){t.setState({showing:e})},t.onCaptionsSamples=function(e){F.isEqual(e,t.state.currentSamples)||t.setState({currentSamples:e})},t.onTimedTextStyleChange=function(e){t.setState({backgroundStyle:t.getBackgroundStyleFromTimedTextStyle(e),windowStyle:t.getWindowStyleFromTimedTextStyle(e)})},t.spacesRegex=/^\s+$/,t.state={backgroundStyle:a,currentSamples:null,fontScale:1,showing:!0,windowStyle:o},t}return i(e,n),e.prototype.componentDidMount=function(){var t=this;this.context.stores.gCast.getIsGCastPlayer()?(a.fontSize="42px",this.mediaQueryInfos=[{mediaQuery:window.matchMedia("(max-width: "+BC.SmallBreakpoint+"px)"),scaleFactor:BC.SmallDisplayFactor},{mediaQuery:window.matchMedia("(width: "+BC.TargetBreakpoint+"px)"),scaleFactor:null},{mediaQuery:window.matchMedia("(min-width: "+BC.LargeBreakpoint+"px)"),scaleFactor:BC.LargeDisplayFactor}]):this.mediaQueryInfos=[{mediaQuery:window.matchMedia("(max-width: 1199px)"),scaleFactor:null},{mediaQuery:window.matchMedia("(min-width: 1200px)"),scaleFactor:100/1200}];for(var e=0,n=this.mediaQueryInfos;e<n.length;e++){n[e].mediaQuery.addListener(function(e){e.matches&&t.setState({backgroundStyle:h({},t.state.backgroundStyle,{fontSize:t.getFontSize()})})})}this.domParser=new DOMParser,this.context.stores.captions.on("CaptionsSamples",this.onCaptionsSamples),this.context.stores.captions.on("DisplayStatusChange",this.onDisplayStatusChange),this.onTimedTextStyleChange(this.context.stores.captions.getTimedTextStyle()),this.context.stores.captions.on("TimedTextStyleChange",this.onTimedTextStyleChange)},e.prototype.componentWillUnmount=function(){this.context.stores.captions.off("CaptionsSamples",this.onCaptionsSamples),this.context.stores.captions.off("DisplayStatusChange",this.onDisplayStatusChange),this.context.stores.captions.off("TimedTextStyleChange",this.onTimedTextStyleChange)},e.prototype.render=function(){if(null==this.state.currentSamples||0===this.state.currentSamples.length||!this.state.showing)return null;for(var e=[],t=0,n=this.state.currentSamples;t<n.length;t++){var r=n[t],i=UC.TTSConverter.ttsObjectToCssObject(xt.nestedValue(r,"region.styles",s)),o=this.getParagraphStyle(r,i),a=this.getRegionStyles(i);e.push(Vn.createElement("div",{style:a},this.getCaptionsElements(r,o,i)))}return Vn.createElement("div",{className:l,dir:"auto"},e)},e.prototype.getRegionStyles=function(e){return h({},e,{display:"flex",position:"absolute"})},e.prototype.getParagraphStyle=function(e,t){var n={height:"",width:"100%",margin:"0px"};return null!=t&&IC.CssUtils.isVerticalWritingMode(t.writingMode)&&(n.height="100%",n.width=""),h({},n,e.element.styles,e.element.inlineStyles)},e.prototype.getCaptionsElements=function(e,t,n){return this.captionsElementToReactNode(e.element,t,n)},e.prototype.applyStyleToEachCharacter=function(e,t){for(var n=h({},t,{display:"inline-block"}),r=[],i=0,o=e;i<o.length;i++){var a=o[i];r.push(Vn.createElement("span",{style:n},a))}return r},e.prototype.tryApplyFontShear=function(e,t,n,r){var i=r.writingMode;return null==t||IC.CssUtils.isVerticalWritingMode(i)&&null!=n.textCombine?e:this.applyStyleToEachCharacter(e,t)},e.prototype.captionsElementToReactNode=function(e,t,n,r){var i=this;void 0===r&&(r=!0);var o=null==e.styles?{}:e.styles,a=null==e.inlineStyles?{}:e.inlineStyles,s=h({},o,a),l=t.fontShear,u=null;null!=l&&(u=UC.TTSConverter.ttsObjectToCssObject({fontShear:l},n));var c=[];if(F.isString(e.contents)){var d=this.tryApplyFontShear(e.contents,u,s,n);F.isString(d)?c.push(d):c.concat(d)}else{var p=e.contents.map(function(e){return F.isString(e)?"<br/>"===e||"<br>"===e?Vn.createElement("br",null):i.tryApplyFontShear(i.decodeHtml(e),u,s,n):i.captionsElementToReactNode(e,t,n,!1)});c=c.concat(p)}IC.CssUtils.extractFontShear(s);var f=UC.TTSConverter.ttsObjectToCssObject(s);return r?c=[Vn.createElement("p",{style:h({},t,f)},Vn.createElement("span",{className:m,style:this.state.windowStyle},Vn.createElement("span",{className:y,style:this.state.backgroundStyle},c)))]:"container"===s.ruby?c=[Vn.createElement("ruby",{style:f},c)]:"text"===s.ruby?c=[Vn.createElement("rp",null,"("),Vn.createElement("rt",{style:f},c),Vn.createElement("rp",null,")")]:"base"===s.ruby?c=[Vn.createElement("rb",{style:f},c)]:(null==f.textCombineUpright&&(f.display="inline-block",this.fixLineSpacing(c)),c=[Vn.createElement("span",{style:f},c)]),c},e.prototype.startsWithSpace=function(e){return/^\s/.test(e)},e.prototype.endsWithSpace=function(e){return/\s$/.test(e)},e.prototype.fixLineSpacing=function(e){var t=e[0],n=e.length,r=e[n-1];F.isString(t)&&this.fixLineItem(e,t,0),r!==t&&F.isString(r)&&this.fixLineItem(e,r,n-1)},e.prototype.fixLineItem=function(e,t,n){e[n]=t.replace(/(^\s|\s$)/g,""),this.startsWithSpace(t)&&e.splice(n,0,Vn.createElement(Vn.Fragment,null," ")),this.endsWithSpace(t)&&e.splice(n+1,0,Vn.createElement(Vn.Fragment,null," "))},e.prototype.decodeHtml=function(e){return this.spacesRegex.test(e)?" ":this.domParser.parseFromString(e,"text/html").documentElement.textContent},e.prototype.getBackgroundStyleFromTimedTextStyle=function(e){var t={};if(null!=e){if(null!=e.bgColor){var n=xt.withDefault(e.bgOpacity,1);t.backgroundColor=IC.CssUtils.hexAndAlphaToRgba(e.bgColor,n)}null!=e.txtColor&&(t.color=e.txtColor),null!=e.txtOpacity&&(t.color=IC.CssUtils.hexAndAlphaToRgba(xt.withDefault(t.color,a.color),e.txtOpacity)),null!=e.txtEdge&&(t=h({},t,EC.FontEdgeMap[e.txtEdge])),null!=e.txtFont&&(t=h({},t,_C.FontMap[e.txtFont])),t.fontSize=this.getFontSize(e)}return h({},a,t)},e.prototype.getWindowStyleFromTimedTextStyle=function(e){var t={};if(null!==e&&null!=e.winColor){var n=xt.withDefault(e.winOpacity,1);t.backgroundColor=IC.CssUtils.hexAndAlphaToRgba(e.winColor,n)}return h({},o,t)},e.prototype.getFontSize=function(e){void 0===e&&(e=null),e=e||this.context.stores.captions.getTimedTextStyle();for(var t=xt.nestedValue(e,"txtSize",1),n=parseInt(a.fontSize),r=0,i=this.mediaQueryInfos;r<i.length;r++){var o=i[r];if(o.mediaQuery.matches)return null===o.scaleFactor?n*t*e.fontScale+"px":n*o.scaleFactor*t*e.fontScale+"vw"}return n+"px"},e.contextType=QP.ReactContext,e}(Vn.Component);t.Captions=n});e(VC);VC.Captions;var jC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({height:"100%",width:"100%"}),a=qS.styler({position:"absolute",top:"0",left:"0",boxSizing:"border-box !important",width:"100%",height:"100%"}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onUIStatusStoreUpdate=function(e){t.setState({state:e.state,userActive:e.userActive})},t.onModalStoreUpdate=function(e){t.setState({isPrePlayback:null!=e&&e.isPrePlayback})},t.state={state:$P.UIPlaybackState.Loading,userActive:!0,isPrePlayback:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.onUIStatusStoreUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.onModalStoreUpdate(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.context.stores.modal.offUpdate(this.onModalStoreUpdate)},e.prototype.render=function(){var e={display:this.state.state!==$P.UIPlaybackState.Loading&&this.state.state!==$P.UIPlaybackState.Error&&this.state.state!==$P.UIPlaybackState.Stopped&&!this.state.isPrePlayback?"":"none"};return Vn.createElement("div",{className:a,style:e},Vn.createElement("div",{className:o},Vn.createElement(VC.Captions,null)))},e.contextType=QP.ReactContext,e}(Vn.Component);t.PersistentPanel=n});e(jC);jC.PersistentPanel;var XC=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var d=qS.styler(wb.debugClassName("skipelement-button"),{cursor:"pointer",pointerEvents:"all",color:"#fff",backgroundColor:"#4c4c4c",boxShadow:"2px 2px 3px rgba(0, 0, 0, 0.3)",fontWeight:"normal",transition:"opacity 0.2s",$nest:{"&:not(.disabled):hover":{backgroundColor:"#7f7f7f"}}},qS.ScalableFontSize(15),qS.ScalableHeight(30),qS.ScaleProperty("border-radius",2)),p={padding:"0px 22px",lineHeight:"normal",minWidth:"0"},f={enter:qS.styler({opacity:0,$unique:!0}),enterActive:qS.styler({opacity:1,$unique:!0}),exit:qS.styler({opacity:1,$unique:!0}),exitActive:qS.styler({opacity:0,$unique:!0})},i=function(t){function e(e){var c=t.call(this,e)||this;return c.mounted=!1,c.onTimelineInfoUpdate=function(e){if(c.mounted){var t=xt.nestedValue(c.state,"skipElements"),n=e.positionMs,r=F.find(t,function(e){return n>=e.startTimecodeMs&&n<=e.endTimecodeMs})||null,i=xt.nestedValue(c.state,"clicked",!1);xt.isNullOrUndefined(r)&&(i=!1);var o=xt.exists(r)&&n<=r.startTimecodeMs+r.buttonShowtimeMs,a=null;if(xt.exists(r)&&c.state.contentType!==_P.ContentType.Ad&&!i&&!c.context.stores.modal.isBlockingModalShowing()){var s=c.context.stores.localization.getLocalization(),l=r.elementType.toLowerCase(),u=null;"intro"!==l&&"recap"!==l||(u=s.skip[l]),xt.exists(u)&&(c.state.userActive||o)&&(a=Vn.createElement(wC.CSSTransition,{key:"skipElement",classNames:f,timeout:{enter:500,exit:300}},Vn.createElement(wb.Button,{className:d,onClick:c.onSkipElementClicked,style:p},u)))}xt.exists(c.state)&&!F.isEqual(a,c.state.button)&&xt.exists(r)&&c.context.stores.skipElement.skipCardShowingChanged(xt.exists(a),r.elementType),c.setState({button:a,clicked:i,currentElement:r,elementPinned:o,positionMs:n})}},c.onTitleInfoUpdate=function(e){c.setState({contentType:e.contentType,skipElements:e.skipElements})},c.onUiStatusUpdate=function(e){c.setState({userActive:e.userActive}),c.onTimelineInfoUpdate(c.context.stores.timeline.getTimelineInfo())},c.onSkipElementClicked=function(){xt.isNullOrUndefined(c.state.currentElement)||(c.context.stores.skipElement.skipSceneClicked(c.state.currentElement.endTimecodeMs,c.state.currentElement.elementType),c.setState({clicked:!0}))},c.state={button:null,clicked:!1,contentType:_P.ContentType.VOD,currentElement:null,elementPinned:!1,positionMs:0,skipElements:[],userActive:!1},c}return n(e,t),e.prototype.componentDidMount=function(){this.mounted=!0,this.onTimelineInfoUpdate(this.context.stores.timeline.getTimelineInfo()),this.context.stores.timeline.onUpdate(this.onTimelineInfoUpdate),this.onTitleInfoUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoUpdate),this.onUiStatusUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUiStatusUpdate)},e.prototype.componentWillUnmount=function(){this.mounted=!1,this.context.stores.timeline.offUpdate(this.onTimelineInfoUpdate),this.context.stores.title.offUpdate(this.onTitleInfoUpdate),this.context.stores.uiStatus.offUpdate(this.onUiStatusUpdate)},e.prototype.render=function(){return Vn.createElement(wC.TransitionGroup,null,this.state.button)},e.contextType=QP.ReactContext,e}(Vn.Component);t.SkipElement=i});e(XC);XC.SkipElement;var zC=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CloseButtonWrapperClassName=qS.styler({color:qS.PrimaryColor,opacity:.8,transition:"opacity 150ms ease-in",$nest:{"&.hide":{opacity:0},"&:hover":{opacity:1}}}),t.ClosePlayerTooltipClassName=qS.styler({},qS.ScalablePaddingRight(27))});e(zC);zC.CloseButtonWrapperClassName,zC.ClosePlayerTooltipClassName;var qC=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Divider=qS.styler({backgroundColor:qS.PrimaryColor,opacity:.25,$nest:n({},qS.RTLStyle(n({},qS.ScaleNestedProperty("margin-right",19))))},qS.ScalableMarginBottom(-1),qS.ScalableWidth(1),qS.ScalableHeight(25))});e(qC);qC.Divider;var WC=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.FullscreenButtonWrapperClassName=qS.styler({color:qS.PrimaryColor,opacity:.8,transition:"opacity 150ms ease-in",$nest:n({"&:not(:first-child)":qS.ScaleNestedProperty("margin-left",18),"&:hover":{opacity:1}},qS.RTLStyle(n({marginRight:"auto"},qS.ScaleNestedProperty("margin-left",19),{$nest:{"&:not(:first-child)":n({},qS.ScaleNestedProperty("margin-right",18))}})))},qS.ScalableMarginRight(19)),t.FullscreenButtonClassName=qS.styler({$nest:{"&.toggled":qS.ScaleNestedProperty("width",19)}},qS.ScalableHeight(17),qS.ScalableWidth(17))});e(WC);WC.FullscreenButtonWrapperClassName,WC.FullscreenButtonClassName;var HC=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PictureInPictureButtonWrapperClassName=qS.styler({color:qS.PrimaryColor,opacity:.8,transition:"opacity 150ms ease-in",$nest:n({"&:not(:first-child)":qS.ScaleNestedProperty("margin-left",18),"&:hover":{opacity:1}},qS.RTLStyle(n({},qS.ScaleNestedProperty("margin-left",19))))},qS.ScalableHeight(24),qS.ScalableWidth(24)),t.PictureInPictureButtonClassName=qS.styler(qS.ScalableHeight(24),qS.ScalableWidth(24))});e(HC);HC.PictureInPictureButtonWrapperClassName,HC.PictureInPictureButtonClassName;var GC=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=function(r){function e(e){var t,n=r.call(this,e)||this;return n.optionClassName=qS.styler({overflow:"auto",boxSizing:"border-box",textAlign:"left",$nest:i({"&:not(:last-of-type)":{borderBottom:"1px solid rgba(54, 54, 54, 0.5)"}},qS.RTLStyle({textAlign:"right"}))},qS.ScalablePadding(15)),n.titleClassName=qS.styler({whiteSpace:"nowrap"},qS.ScalableFontSize(17),qS.ScalableMarginBottom(8)),n.titleModalClassName=qS.styler({color:qS.PrimaryColor,fontWeight:"normal"},qS.ScalableFontSize(21)),n.textButtonClassName=qS.styler({whiteSpace:"nowrap",cursor:"pointer",color:"#999",$nest:{"&:hover":{color:qS.PrimaryColor}}}),n.optionModalClassName=qS.styler({$nest:(t={},t["&:not ."+n.textButtonClassName]=qS.ScaleNestedProperty("padding-bottom",20),t["&:not(:last-of-type)"]={borderBottom:"1px solid rgba(255, 255, 255, 0.1)"},t)}),n.dataSaverOptionModalTitleClassName=qS.styler(qS.ScalablePaddingBottom(0)),n.hdcpInfoButtonModalClassName=qS.styler({fontWeight:"normal",color:qS.LinkColor},qS.ScalableFontSize(15),qS.ScalablePadding(5,20,20,20)),n.textButtonModalClassName=qS.styler({fontWeight:"normal"},qS.ScalableFontSize(15)),n.textButtonOptionModalClassName=qS.styler(qS.ScalablePadding(20)),n}return n(e,r),e.prototype.shouldComponentUpdate=function(e,t){return!F.isEqual(this.props,e)||!F.isEqual(this.state,t)},e.prototype.componentWillReceiveProps=function(){var e=this.isVisible(this.props);e!==this.state.visible&&this.setState({visible:e})},e.prototype.componentWillUpdate=function(e,t){var n=this.isVisible(this.props);n!==this.state.visible&&this.props.onVisibilityChanged(n)},e}(Vn.Component);t.Option=o});e(GC);GC.Option;var KC=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=qS.styler(qS.ScalableFontSize(16)),s=qS.styler({opacity:.5},qS.ScalableFontSize(13),qS.ScalableMarginTop(1)),l=qS.styler({backgroundColor:"transparent",boxShadow:"none",border:"none"}),u=qS.styler({whiteSpace:"nowrap"}),c=qS.styler({color:qS.PrimaryColor}),d=qS.styler(wb.debugClassName("videoquality-checkbox"),{display:"flex",position:"relative",$nest:o((n={"&:not(:first-child)":o({},qS.ScaleNestedProperty("margin-top",10),{marginLeft:"0 !important"})},n["&:hover ."+l]={backgroundColor:"transparent"},n["&:hover ."+u]={color:qS.PrimaryColor},n),qS.RTLStyle({$nest:{"&:not(:first-child)":{marginLeft:"auto",marginRight:"0 !important"}}}))}),p=function(n){function e(e){var t=n.call(this,e)||this;return t.isVisible=function(){return t.state.contentType!==_P.ContentType.Live},t.onTitleInfoStoreUpdate=function(e){t.setState({contentType:e.contentType})},t.onQualityCapChanged=function(e){e=e.toString(),t.context.stores.bandwidthCapper.setCapStrategy(PP.parse(e)),t.setState({selectedQualityCapId:e})},t.onSelectedQualityCapIdUpdate=function(e){t.setState({selectedQualityCapId:e})},t.state={contentType:_P.ContentType.VOD,selectedQualityCapId:"best",videoQualityCaps:[],visible:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.onTitleInfoStoreUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoStoreUpdate),this.onSelectedQualityCapIdUpdate(this.context.stores.bandwidthCapper.getCurrentCapStrategy()),this.context.stores.bandwidthCapper.onCurrentCapStrategyUpdate(this.onSelectedQualityCapIdUpdate),this.setState({videoQualityCaps:this.context.stores.bandwidthCapper.getQualityCaps()})},e.prototype.componentWillUnmount=function(){this.context.stores.title.offUpdate(this.onTitleInfoStoreUpdate),this.context.stores.bandwidthCapper.offCurrentCapStrategyUpdate(this.onSelectedQualityCapIdUpdate)},e.prototype.render=function(){var e,t,r=this;if(!this.state.visible)return null;var n=PS(this.optionClassName,((e={})[this.optionModalClassName]=this.props.isInsideModal,e)),i=PS(this.titleClassName,((t={})[this.dataSaverOptionModalTitleClassName]=this.props.isInsideModal,t[this.titleModalClassName]=this.props.isInsideModal,t)),o=this.state.selectedQualityCapId;xt.isNullOrUndefined(o)&&(o=F.last(this.state.videoQualityCaps).id);return Vn.createElement("div",{className:n,style:{display:this.state.visible?"":"none"}},Vn.createElement("div",{className:i},this.context.stores.localization.getLocalization().videoQuality),Vn.createElement(wb.RadioButtonGroup,{onChange:this.onQualityCapChanged,selectedButton:o},this.state.videoQualityCaps.map(function(e){var t,n=PS(u,((t={})[c]=e.id===r.state.selectedQualityCapId,t));return Vn.createElement(wb.RadioButtonCheckbox,{key:e.id,value:e.id,checkboxClassName:d,checkmarkBoxClassName:l,textClassName:n,ariaLabel:"Video Quality "+e.name},Vn.createElement("div",{className:a},e.name),Vn.createElement("div",{className:s},e.description))})))},e.contextType=QP.ReactContext,e}(GC.Option);t.DataSaverOption=p});e(KC);KC.DataSaverOption;var QC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=F,s=qS.styler({display:"inline-block",color:qS.LinkColor,cursor:"pointer",$nest:{"&:hover":{color:qS.LinkHoverColor}}}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.isVisible=function(){return t.videoStreamHasHD(t.state.videoStream)&&!1===t.state.isHDCPCompliant},t.onHDCPStatusStoreUpdate=function(e){t.setState({isHDCPCompliant:e.isHDCPCompliant})},t.onVideoStreamStoreUpdate=function(e){t.setState({videoStream:e.activeStream})},t.onHDCPInfoClicked=function(e){t.context.stores.hdcp.hdcpInfoClicked(),o.isFunction(t.props.onClick)&&t.props.onClick(e)},t.videoStreamHasHD=function(e){return!xt.isNullOrUndefined(e)&&F.some(e.variants,function(e){return 720<=e.height||1280<=e.width})},t.state={visible:!1,isHDCPCompliant:!0,videoStream:null},t}return i(e,n),e.prototype.componentDidMount=function(){this.onHDCPStatusStoreUpdate(this.context.stores.hdcp.getHDCPStatus()),this.context.stores.hdcp.onHDCPStatusChange(this.onHDCPStatusStoreUpdate),this.onVideoStreamStoreUpdate(this.context.stores.videoStream.getVideoStreamInfo()),this.context.stores.videoStream.onVideoStreamInfoChange(this.onVideoStreamStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.hdcp.offHDCPStatusChange(this.onHDCPStatusStoreUpdate),this.context.stores.videoStream.offVideoStreamInfoChange(this.onVideoStreamStoreUpdate)},e.prototype.render=function(){var e,t,n;if(this.state.isHDCPCompliant)return null;var r=PS(this.optionClassName,((e={})[this.optionModalClassName]=this.props.isInsideModal,e)),i=PS(this.titleClassName,((t={})[this.titleModalClassName]=this.props.isInsideModal,t)),o=PS(s,((n={})[this.hdcpInfoButtonModalClassName]=this.props.isInsideModal,n)),a=this.context.stores.localization.getLocalization();return Vn.createElement("div",{className:r,style:{display:this.state.visible?"":"none"}},Vn.createElement("div",{className:i},a.hdVideoUnavailable),Vn.createElement("div",{className:o,onClick:this.onHDCPInfoClicked},a.why))},e.contextType=QP.ReactContext,e}(GC.Option);t.HDCPOption=n});e(QC);QC.HDCPOption;var YC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.isVisible=function(){return t.state.contentType===_P.ContentType.Live},t.onTitleInfoStoreUpdate=function(e){t.setState({contentType:e.contentType})},t.onClick=function(e){t.context.stores.playback.seek(1/0),F.isFunction(t.props.onClick)&&t.props.onClick(e)},t.state={contentType:_P.ContentType.VOD},t}return i(e,n),e.prototype.componentDidMount=function(){this.onTitleInfoStoreUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.title.offUpdate(this.onTitleInfoStoreUpdate)},e.prototype.render=function(){var e,t,n=PS(this.optionClassName,((e={})[this.optionModalClassName]=this.props.isInsideModal,e)),r=PS(this.textButtonClassName,((t={})[this.textButtonModalClassName]=this.props.isInsideModal,t[this.textButtonOptionModalClassName]=this.props.isInsideModal,t));return Vn.createElement("div",{className:n,style:{display:this.state.visible?"":"none"}},Vn.createElement("div",{className:r,onClick:this.onClick},this.context.stores.localization.getLocalization().live.jumpToLive))},e.contextType=QP.ReactContext,e}(GC.Option);t.JumpToLiveOption=n});e(YC);YC.JumpToLiveOption;var JC=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({fontWeight:"normal",maxHeight:"60vh"},qS.ScrollableVertical,qS.ScalableFontSize(15)),o=function(t){function e(e){var r=t.call(this,e)||this;return r.optionsMenuRef=null,r.visibleOptions=[],r.onOptionVisibilityChanged=function(e,t){var n=r.visibleOptions.slice();n[e]=t,r.visibleOptions=n,F.isFunction(r.props.onOptionVisibilityChanged)&&r.props.onOptionVisibilityChanged(n.some(function(e){return!0===e}))},r.state={options:[KC.DataSaverOption,QC.HDCPOption,YC.JumpToLiveOption]},r}return n(e,t),e.prototype.render=function(){var n=this;return Vn.createElement("div",{ref:function(e){n.optionsMenuRef=e},className:i},this.state.options.map(function(e,t){return Vn.createElement(e,{key:t,isInsideModal:!1,onVisibilityChanged:function(e){return n.onOptionVisibilityChanged(t,e)},onClick:n.props.onClose})}))},e.contextType=QP.ReactContext,e}(Vn.Component);t.OptionsMenu=o});e(JC);JC.OptionsMenu;var $C=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){var o=t.call(this,e)||this;return o.closeTooltipTimeoutId=null,o.lock=null,o.mediaQuery=window.matchMedia(Y.Styling.SCREEN_LARGE_MEDIA_QUERY),o.tooltipYpx="30px",o.tooltipYvw=30*Y.Styling.SCALE_FACTOR_LARGE+"vw",o.onUIStatusStoreUpdate=function(e){o.setState({userActive:e.userActive})},o.onKeyInputStoreUpdate=function(e){o.setState({isUsingKeyboard:e.keyboardFocus})},o.onMediaQueryChanged=function(e){o.setState({tooltipY:e.matches?o.tooltipYvw:o.tooltipYpx})},o.onBlur=function(){o.timeOutId=A.timer.setTimeout(function(){o.state.showTooltip&&o.state.isUsingKeyboard&&o.setState({showTooltip:!1})},0)},o.onFocus=function(){clearTimeout(o.timeOutId)},o.onClickButton=function(e){if("Enter"===e.key)e.preventDefault();else if(o.state.isUsingKeyboard)return;o.context.stores.uiConfigurations.useSmallPlayerUI()&&null!=o.props.onSmallPlayerModal?o.props.onSmallPlayerModal():!o.state.showTooltip?(window.addEventListener("click",o.onClickInWindow),window.addEventListener("touchstart",o.onClickInWindow),o.lock.lock(),o.setState({showTooltip:!0})):o.closeTooltip()},o.onClickInWindow=function(e){e=e.touches?e.touches[0]:e;var t=Ce.HTMLElementUtils.clickedInElement(Ld.findDOMNode(o.buttonRef),e),n=Ld.findDOMNode(o.tooltipRef).getElementsByClassName("tooltip")[0],r=Ld.findDOMNode(n),i=!!xt.exists(r)&&Ce.HTMLElementUtils.clickedInElement(r,e);!o.state.showTooltip||t||i||o.closeTooltip()},o.closeTooltip=function(){o.state.showTooltip&&!o.props.forceOpen&&(clearTimeout(o.closeTooltipTimeoutId),window.removeEventListener("click",o.onClickInWindow),window.removeEventListener("touchstart",o.onClickInWindow),o.setState({showTooltip:!1}),o.lock.unlock())},o.setCloseTooltipTimeout=function(e){clearTimeout(o.closeTooltipTimeoutId),o.closeTooltipTimeoutId=A.timer.setTimeout(o.closeTooltip,xt.withDefault(e,500))},o.onMouseMoveButton=function(){o.state.showTooltip&&o.setCloseTooltipTimeout(wb.UITimeoutMS.Standard)},o.onMouseMoveTooltip=function(){clearTimeout(o.closeTooltipTimeoutId)},o.onMouseLeaveTooltip=function(){o.setCloseTooltipTimeout()},o.timeOutId=null,o.state={isUsingKeyboard:!1,showTooltip:!1,tooltipY:"0",userActive:!1},o}return n(e,t),e.prototype.componentDidMount=function(){this.lock=this.context.stores.lock.newLock(),this.onUIStatusStoreUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.onKeyInputStoreUpdate(this.context.stores.keyInput.getKeyInputInfo()),this.context.stores.keyInput.onUpdate(this.onKeyInputStoreUpdate),this.onMediaQueryChanged(this.mediaQuery),this.mediaQuery.addListener(this.onMediaQueryChanged)},e.prototype.componentWillUnmount=function(){this.context.stores.lock.deleteLock(this.lock),this.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.context.stores.keyInput.offUpdate(this.onKeyInputStoreUpdate),this.mediaQuery.removeListener(this.onMediaQueryChanged),window.removeEventListener("click",this.onClickInWindow)},e.prototype.componentWillReceiveProps=function(e){!this.state.userActive&&this.state.showTooltip&&this.closeTooltip(),e.forceOpen!==this.props.forceOpen&&(e.forceOpen?clearTimeout(this.closeTooltipTimeoutId):this.setCloseTooltipTimeout(1e3))},e.prototype.componentDidUpdate=function(e,t){this.state.showTooltip!==t.showTooltip&&(this.state.showTooltip&&xt.exists(this.props.onOpen)?this.props.onOpen():!this.state.showTooltip&&xt.exists(this.props.onClose)&&this.props.onClose())},e.prototype.render=function(){var t=this,e=xt.withDefault(this.props.buttonWrapperClassName,""),n=xt.withDefault(this.props.buttonClassName,"");return Vn.createElement("span",{onBlur:this.onBlur,onFocus:this.onFocus},Vn.createElement(wb.ImageButton,{ref:function(e){return t.buttonRef=e},src:this.props.buttonSrc,onClick:this.onClickButton,onKeyDown:this.onClickButton,onMouseMove:this.onMouseMoveButton,wrapperClassName:e,className:n,ariaLabel:this.props.ariaLabel},this.props.hoverText),Vn.createElement(wb.Tooltip,{ref:function(e){return t.tooltipRef=e},x:"50%",y:this.state.tooltipY,below:this.props.below,show:this.state.showTooltip||this.props.forceOpen,updateWhenHidden:this.props.updateWhenHidden,onMouseMove:this.onMouseMoveTooltip,onMouseLeave:this.onMouseLeaveTooltip,xOffset:this.props.tooltipOffsetX},this.props.children))},e.contextType=QP.ReactContext,e.defaultProps={below:!0,buttonSrc:"",forceOpen:!1,tooltipOffsetX:null,updateWhenHidden:!1,children:null},e}(Vn.Component);t.TooltipButton=i});e($C);$C.TooltipButton;var ZC=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler(wb.debugClassName("options-wrapper"),{position:"relative",display:"inline-block",$nest:n({},qS.RTLStyle(n({marginRight:"auto"},qS.ScaleNestedProperty("margin-left",18))))},qS.ScalableMarginRight(18)),a=qS.styler(wb.debugClassName("optionsmenu-button"),{opacity:.8,transition:"opacity 150ms ease-in",color:qS.PrimaryColor,$nest:{"&:hover":{opacity:1}}},qS.ScalableWidth(20),qS.ScalableHeight(20)),s=qS.styler({display:"block"}),l=function(n){function e(e){var t=n.call(this,e)||this;return t.onTitleInfoStoreUpdate=function(e){t.setState({isTrailer:e.contentType===_P.ContentType.Trailer})},t.onSmallPlayerModal=function(){t.props.useSmallPlayerModals&&t.context.stores.modal.showModal(xP.Modal.Options)},t.onUIStatusStoreUpdate=function(e){t.setState({userActive:e.userActive})},t.onOptionVisibilityChanged=function(e){t.setState({hasVisibleOption:e})},t.state={hasVisibleOption:!1,isTrailer:!1,userActive:!0},t}return i(e,n),e.prototype.componentDidMount=function(){this.onUIStatusStoreUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.onTitleInfoStoreUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.context.stores.title.offUpdate(this.onTitleInfoStoreUpdate)},e.prototype.render=function(){var t=this,e=this.context.stores.localization.getLocalization(),n={display:this.state.hasVisibleOption?"":"none"};return Vn.createElement("div",{className:o,style:n},Vn.createElement($C.TooltipButton,{buttonSrc:Ww.SVG.Options,buttonClassName:a,buttonWrapperClassName:s,hoverText:e.options,onSmallPlayerModal:this.onSmallPlayerModal,updateWhenHidden:!0,ariaLabel:"Options Menu"},Vn.createElement(JC.OptionsMenu,{onOptionVisibilityChanged:function(e){return t.onOptionVisibilityChanged(e)}})))},e.contextType=QP.ReactContext,e}(Vn.Component);t.Options=l});e(ZC);ZC.Options;var eM=t(function(e,t){var n,r=V&&V.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.SubtitlesAndAudioMenuClassName=qS.styler({display:"flex"}),t.SubtitlesAndAudioMenuModalClassName=qS.styler({flex:1,flexWrap:"wrap",minHeight:"min-content"}),t.SubtitlesAndAudioClassName=qS.styler({textAlign:"left",flex:1,$nest:r({"&:first-child":r({borderRight:"1px solid rgb(50, 50, 50)"},qS.ScaleNestedProperty("padding-right",15)),"&:last-child":r({borderLeft:"1px solid rgb(85, 85, 85)"},qS.ScaleNestedProperty("padding-left",15))},qS.RTLStyle({textAlign:"right",$nest:{"&:first-child":{borderLeft:"1px solid rgb(50, 50, 50)",borderRight:"none"},"&:last-child":{borderRight:"1px solid rgb(85, 85, 85)",borderLeft:"none"}}}))},qS.ScalablePadding(15),qS.ScalableWidth(200),qS.ScalableMinWidth(200)),t.SubtitlesAndAudioModalClassName=qS.styler(qS.ScalableMaxWidth(280),qS.ScalableMinWidth(178)),t.SubtitlesAndAudioModalContentsClassName=qS.styler({display:"flex",flex:1,maxHeight:"none",overflowX:"hidden"}),t.SettingsClassName=qS.styler({borderTop:"1px solid rgb(85, 85, 85)"},qS.ScalablePaddingTop(12),qS.ScalableFontSize(15)),t.SettingsModalClassName=qS.styler({border:"none",$nest:r({},qS.RTLStyle(r({},qS.ScaleNestedProperty("margin-left",20),qS.ScaleNestedProperty("margin-right",0))))},qS.ScalableMargin(0,20,3,0),qS.ScalablePaddingTop(10)),t.SettingsSpanClassName=qS.styler({cursor:"pointer",color:qS.LinkColor,fontWeight:"normal",$nest:{"&:hover":{color:qS.LinkHoverColor}}}),t.LabelTextClassName=qS.styler({color:qS.TextColor,cursor:"pointer"},qS.ScalableFontSize(13)),t.LabelClassName=qS.styler({background:"none",borderColor:qS.TextColor,$nest:r({},qS.RTLStyle(r({marginLeft:"auto"},qS.ScaleNestedProperty("margin-right",1))))},qS.ScaleProperty("border-radius",2),qS.ScalablePadding(2,5),qS.ScalableMarginLeft(1)),t.CheckmarkBoxClassName=qS.styler({backgroundColor:"transparent !important",border:"none",boxShadow:"none"},qS.ScalableMinWidth(22),qS.ScalableMinHeight(22)),t.TextClassName=qS.styler({display:"inline-block",cursor:"pointer",$nest:r((n={"&:hover":{cursor:"pointer",color:qS.PrimaryColor}},n["&:hover ."+t.LabelClassName]={cursor:"pointer",color:qS.PrimaryColor,borderColor:qS.PrimaryColor},n["&:hover ."+t.LabelTextClassName]={cursor:"pointer",color:qS.PrimaryColor},n),qS.RTLStyle(r({},qS.ScaleNestedProperty("margin-left",4),qS.ScaleNestedProperty("margin-right",5))))},qS.ScalableMarginRight(4),qS.ScalableMarginBottom(3),qS.ScalableMarginLeft(5),qS.ScalableFontSize(15)),t.TextModalClassName=qS.styler({overflowWrap:"break-word"},qS.ScalableWidth(120)),t.TextSpanClassName=qS.styler({display:"inline-block",$nest:r({},qS.RTLStyle(r({marginRight:"auto"},qS.ScaleNestedProperty("margin-left",4))))},qS.ScalableMarginRight(4),qS.ScalableMarginBottom(3)),t.TitleClassName=qS.styler({fontWeight:"normal"},qS.ScalableFontSize(17)),t.TitleModalClassName=qS.styler({color:qS.PrimaryColor,fontWeight:"normal"},qS.ScalableFontSize(21),qS.ScalablePaddingTop(10),qS.ScalablePaddingBottom(10)),t.CheckboxClassName=qS.styler({display:"flex",marginLeft:"0 !important",position:"relative",$nest:r({"&:not(:first-child)":{marginLeft:"0px"}},qS.RTLStyle({marginLeft:"auto",marginRight:"0 !important",$nest:{"&:first-child":{marginLeft:"auto",marginRight:"0px"}}}))},qS.ScalableMarginTop(10)),t.CheckboxModalClassName=qS.styler({$nest:{"&:last-of-type":qS.ScaleNestedProperty("padding-bottom",20)}},qS.ScalableWidth(155)),t.CheckmarkBoxCheckedTextClassName=qS.styler({color:qS.PrimaryColor}),t.CheckmarkBoxCheckedLabelClassName=qS.styler({color:qS.PrimaryColor,borderColor:qS.PrimaryColor}),t.CheckmarkBoxCheckedLabelTextClassName=qS.styler({color:qS.PrimaryColor}),t.RadioButtonGroupClassName=qS.styler({display:"block"}),t.RadioButtonGroupModalClassName=qS.styler({display:"inline-block"}),t.AudioModalClassName=qS.styler({borderLeft:"1px solid rgba(255, 255, 255, 0.1)",$nest:r({"&:last-child":{borderRight:"none"}},qS.RTLStyle({borderLeft:"none",borderRight:"1px solid rgba(255, 255, 255, 0.1)",$nest:{"&:last-child":{borderLeft:"none"}}}))}),t.SubtitlesRadioButtonGroupWrapperClassName=qS.styler({position:"relative",borderBottom:"1px solid rgb(50, 50, 50)"},qS.ScalablePaddingBottom(15)),t.AudioRadioButtonGroupWrapperClassName=qS.styler({position:"relative"}),t.SubtitlesScrollableContainerClassName=qS.styler({maxHeight:"22vh"}),t.AudioScrollableContainerClassName=qS.styler({maxHeight:"29vh"})});e(eM);eM.SubtitlesAndAudioMenuClassName,eM.SubtitlesAndAudioMenuModalClassName,eM.SubtitlesAndAudioClassName,eM.SubtitlesAndAudioModalClassName,eM.SubtitlesAndAudioModalContentsClassName,eM.SettingsClassName,eM.SettingsModalClassName,eM.SettingsSpanClassName,eM.LabelTextClassName,eM.LabelClassName,eM.CheckmarkBoxClassName,eM.TextClassName,eM.TextModalClassName,eM.TextSpanClassName,eM.TitleClassName,eM.TitleModalClassName,eM.CheckboxClassName,eM.CheckboxModalClassName,eM.CheckmarkBoxCheckedTextClassName,eM.CheckmarkBoxCheckedLabelClassName,eM.CheckmarkBoxCheckedLabelTextClassName,eM.RadioButtonGroupClassName,eM.RadioButtonGroupModalClassName,eM.AudioModalClassName,eM.SubtitlesRadioButtonGroupWrapperClassName,eM.AudioRadioButtonGroupWrapperClassName,eM.SubtitlesScrollableContainerClassName,eM.AudioScrollableContainerClassName;var tM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){var u=t.call(this,e)||this;return u.trackTypeRegex=/\[(.*)\]/,u.captionsRadioButtonRef=null,u.audioRadioButtonRef=null,u.selectedAudioStream=null,u.selectedCaptionsId=null,u.onAudioStreamStoreUpdate=function(e){u.setState({audioStreamInfo:e})},u.onCaptionsStoreUpdate=function(e){u.setState({timedTextStreamInfo:e})},u.onUIConfigurationsUpdate=function(e){u.setState({uiConfigurations:e})},u.onAudioTrackChanged=function(e){u.context.stores.audioStream.changeAudioStream(e.toString())},u.onClickSettings=function(){u.context.stores.captions.onCaptionsSettingsClicked(u.props.isInsideModal)},u.onSubtitleTrackChanged=function(e){u.context.stores.captions.onCaptionsTrackChanged(e.toString())},u.getAudioStreamId=function(e){return null!=e?xt.withDefault(xt.withDefault(e.id,e.label),void 0):void 0},u.getLabelForCaptionsTrack=function(e){var t=u.getLabelFromString(e.label),n=u.context.stores.localization.getLocalization();return xt.exists(t)?t:"Caption"===e.type?n.closedCaptionsShort:"SDH"===e.type?n.sdh:null},u.getLabelFromString=function(e){if(null==e)return null;var t=u.trackTypeRegex.exec(e);return null!=t?t[t.length-1]:null},u.reformatDisplayName=function(e){return null==e?null:e.replace(u.trackTypeRegex,"").replace(/\s+/g," ").trim()},u.getAudioStream=function(e,s,l){return e.filter(function(e){return!F.isEmpty(e.label)}).map(function(e){var t,n,r=e.id,i=u.getLabelFromString(e.label),o=PS(eM.LabelClassName,((t={})[eM.CheckmarkBoxCheckedLabelClassName]=null!=u.selectedAudioStream&&u.selectedAudioStream.id===r,t)),a=PS(eM.LabelTextClassName,((n={})[eM.CheckmarkBoxCheckedLabelTextClassName]=null!=u.selectedAudioStream&&u.selectedAudioStream.id===r,n));return Vn.createElement(wb.RadioButtonCheckbox,{key:r,value:r,checkmarkBoxClassName:eM.CheckmarkBoxClassName,checkboxClassName:s,checkmarkBoxCheckedClassName:PS(eM.CheckmarkBoxCheckedTextClassName,wb.debugClassName("audiotrackoption-selected")),textClassName:PS(l,wb.debugClassName("audiotrackoption-text")),ariaLabel:e.label},u.reformatDisplayName(e.label),xt.exists(i)?Vn.createElement(wb.Label,{labelClassName:o,textClassName:a},i):null)})},u.getCaptionsTracks=function(e,a,s){return e.filter(function(e){return!F.isEmpty(e.label)}).map(function(e){var t,n,r=u.getLabelForCaptionsTrack(e),i=PS(eM.LabelClassName,((t={})[eM.CheckmarkBoxCheckedLabelClassName]=u.selectedCaptionsId===e.id,t)),o=PS(eM.LabelTextClassName,((n={})[eM.CheckmarkBoxCheckedLabelTextClassName]=u.selectedCaptionsId===e.id,n));return Vn.createElement(wb.RadioButtonCheckbox,{key:e.id,value:e.id,checkmarkBoxClassName:eM.CheckmarkBoxClassName,checkboxClassName:a,checkmarkBoxCheckedClassName:PS(eM.CheckmarkBoxCheckedTextClassName,wb.debugClassName("subtitleoption-selected")),textClassName:s,ariaLabel:e.label},Vn.createElement("span",{className:PS(eM.TextSpanClassName,wb.debugClassName("subtitleoption-text"))},u.reformatDisplayName(e.label)),xt.exists(r)?Vn.createElement(wb.Label,{labelClassName:i,textClassName:o},r):null)})},u.state={audioStreamInfo:{streams:[],activeStream:null,activeVariant:null},timedTextStreamInfo:{streams:[],activeStream:null,activeVariant:null},uiConfigurations:_w.GetDefaultUIConfigurations()},u}return n(e,t),e.prototype.componentDidMount=function(){this.onAudioStreamStoreUpdate(this.context.stores.audioStream.getAudioStreamInfo()),this.context.stores.audioStream.onAudioStreamInfoChange(this.onAudioStreamStoreUpdate),this.onCaptionsStoreUpdate(this.context.stores.captions.getTimedTextStreamInfo()),this.context.stores.captions.on("TimedTextStreamInfoChange",this.onCaptionsStoreUpdate),this.onUIConfigurationsUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.audioStream.offAudioStreamInfoChange(this.onAudioStreamStoreUpdate),this.context.stores.captions.off("TimedTextStreamInfoChange",this.onCaptionsStoreUpdate),this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsUpdate)},e.prototype.render=function(){var e,t,n,r,i,o,a,s,l,u=this,c=this.state.audioStreamInfo,d=this.state.timedTextStreamInfo,p=this.context.stores.localization.getLocalization(),f=PS(eM.SubtitlesAndAudioMenuClassName,((e={})[eM.SubtitlesAndAudioMenuModalClassName]=this.props.isInsideModal,e)),h=PS(eM.SubtitlesAndAudioClassName,wb.debugClassName("subtitleandaudiomenu-container"),((t={})[eM.SubtitlesAndAudioModalClassName]=this.props.isInsideModal,t)),m=PS(h,wb.debugClassName("audiomenu-container"),((n={})[eM.AudioModalClassName]=this.props.isInsideModal,n)),y=PS(eM.CheckboxClassName,((r={})[eM.CheckboxModalClassName]=this.props.isInsideModal,r)),g=PS(y,wb.debugClassName("subtitleoption-container")),v=PS(y,wb.debugClassName("audiotrackoption-container")),S=PS(eM.TextClassName,((i={})[eM.TextModalClassName]=this.props.isInsideModal,i)),b=PS(eM.SettingsClassName,((o={})[eM.SettingsModalClassName]=this.props.isInsideModal,o)),T=PS(eM.TitleClassName,((a={})[eM.TitleModalClassName]=this.props.isInsideModal,a)),P=PS(eM.RadioButtonGroupClassName,((s={})[eM.RadioButtonGroupModalClassName]=this.props.isInsideModal,s)),w=PS(((l={})[eM.SubtitlesAndAudioModalContentsClassName]=this.props.isInsideModal,l)),C=PS(eM.SubtitlesRadioButtonGroupWrapperClassName,P),M=PS(eM.AudioRadioButtonGroupWrapperClassName,P);if(null!=c.activeStream&&0<c.streams.length){var I=F.findWhere(c.streams,{id:c.activeStream.id});null==I&&(I=c.streams[0]),this.selectedAudioStream=null!=I?I:null}if(this.selectedCaptionsId=AP.CaptionsStore.OFF_ID,null!=d.activeStream){var E=F.findWhere(d.streams,{id:d.activeStream.id});null!=E&&(this.selectedCaptionsId=E.id)}var _=Vn.createElement("div",{className:b},Vn.createElement("span",{className:PS(eM.SettingsSpanClassName,wb.debugClassName("subtitleoptions-button")),onClick:this.onClickSettings},p.subtitlesSettings));return Vn.createElement("div",{className:w+" "+qS.ScrollableVertical},Vn.createElement("div",{className:f},this.state.uiConfigurations.enableSubtitles?Vn.createElement("div",{className:h},Vn.createElement("div",{className:T},p.subtitles),this.props.isInsideModal?_:null,Vn.createElement("div",{className:C},Vn.createElement(wb.RadioButtonGroup,{onChange:this.onSubtitleTrackChanged,selectedButton:this.selectedCaptionsId,scrollableContainerClassName:eM.SubtitlesScrollableContainerClassName,ref:function(e){u.captionsRadioButtonRef=e},scrollable:!this.props.isInsideModal},Vn.createElement(wb.RadioButtonCheckbox,{key:AP.CaptionsStore.OFF_ID,value:AP.CaptionsStore.OFF_ID,checkmarkBoxClassName:eM.CheckmarkBoxClassName,checkboxClassName:g,checkmarkBoxCheckedClassName:PS(eM.CheckmarkBoxCheckedTextClassName,wb.debugClassName("subtitleoption-selected")),textClassName:PS(S,wb.debugClassName("subtitleoption-text")),ariaLabel:p.toggleOff},p.toggleOff),this.getCaptionsTracks(d.streams,g,S))),this.props.isInsideModal?null:_):null,this.state.uiConfigurations.enableMta?Vn.createElement("div",{className:m},Vn.createElement("div",{className:T},p.audio),Vn.createElement("div",{className:M},Vn.createElement(wb.RadioButtonGroup,{onChange:this.onAudioTrackChanged,selectedButton:this.getAudioStreamId(this.selectedAudioStream),scrollableContainerClassName:eM.AudioScrollableContainerClassName,ref:function(e){u.audioRadioButtonRef=e},scrollable:!this.props.isInsideModal},this.getAudioStream(c.streams,v,S)))):null))},e.contextType=QP.ReactContext,e}(Vn.Component);t.SubtitlesAndAudioMenu=i});e(tM);tM.SubtitlesAndAudioMenu;var nM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({position:"relative",$nest:n({},qS.RTLStyle(n({marginRight:"auto"},qS.ScaleNestedProperty("margin-left",18))))},qS.ScalableMarginRight(18)),a=qS.styler({display:"block"}),s=qS.styler(wb.debugClassName("subtitleaudiomenu-button"),{opacity:.8,$nest:{"&:hover":{opacity:1}}},qS.ScalableMarginBottom(-1),qS.ScalableWidth(20),qS.ScalableHeight(20)),l=function(n){function e(e){var t=n.call(this,e)||this;return t.mediumMediaQuery=window.matchMedia(Y.Styling.SCREEN_MEDIUM_MEDIA_QUERY),t.largeMediaQuery=window.matchMedia(Y.Styling.SCREEN_LARGE_MEDIA_QUERY),t.tooltipOffsetXMediumPx="-5px",t.tooltipOffsetXPx="-50px",t.tooltipOffsetXVw=-50*Y.Styling.SCALE_FACTOR_LARGE+"vw",t.onLargeMediaQueryChanged=function(e){t.setState({tooltipOffsetX:e.matches?t.tooltipOffsetXVw:t.tooltipOffsetXPx})},t.onMediumMediaQueryChanged=function(e){t.setState({tooltipOffsetX:e.matches?t.tooltipOffsetXPx:t.tooltipOffsetXMediumPx})},t.onTitleInfoStoreUpdate=function(e){t.setState({contentType:e.contentType})},t.runInitialMediaQueryCheck=function(){t.largeMediaQuery.matches?t.onLargeMediaQueryChanged(t.largeMediaQuery):t.onMediumMediaQueryChanged(t.mediumMediaQuery)},t.onSmallPlayerModal=function(){t.props.useSmallPlayerModals&&t.context.stores.modal.showModal(xP.Modal.SubtitlesAndAudio)},t.state={contentType:_P.ContentType.VOD,isTrailer:!1,tooltipOffsetX:null},t}return i(e,n),e.prototype.componentDidMount=function(){this.runInitialMediaQueryCheck(),this.mediumMediaQuery.addListener(this.onMediumMediaQueryChanged),this.largeMediaQuery.addListener(this.onLargeMediaQueryChanged),this.onTitleInfoStoreUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoStoreUpdate)},e.prototype.componentWillUnmount=function(){this.mediumMediaQuery.removeListener(this.onMediumMediaQueryChanged),this.largeMediaQuery.removeListener(this.onLargeMediaQueryChanged),this.context.stores.title.offUpdate(this.onTitleInfoStoreUpdate)},e.prototype.render=function(){return this.state.contentType===_P.ContentType.Trailer||this.state.contentType===_P.ContentType.Ad?null:Vn.createElement("div",{className:o},Vn.createElement($C.TooltipButton,{buttonSrc:Ww.SVG.SubtitlesAndAudio,buttonClassName:s,buttonWrapperClassName:a,hoverText:this.context.stores.localization.getLocalization().subtitlesAndAudio,tooltipOffsetX:this.state.tooltipOffsetX,onSmallPlayerModal:this.onSmallPlayerModal,ariaLabel:"Subtitles and Audio Menu"},Vn.createElement(tM.SubtitlesAndAudioMenu,{isInsideModal:!1})))},e.contextType=QP.ReactContext,e}(Vn.Component);t.SubtitlesAndAudio=l});e(nM);nM.SubtitlesAndAudio;var rM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({height:"100%"}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onProgressBarChange=function(e){t.setState({volume:e}),t.context.stores.playback.volume=e},t.onMouseDown=function(e){t.onProgressBarChange(e),F.isFunction(t.props.onMouseDown)&&t.props.onMouseDown(e)},t.onMouseUp=function(e){F.isFunction(t.props.onMouseUp)&&t.props.onMouseUp(e)},t.getStateFromProps=function(e){return{volume:xt.withDefault(e.volume,0)}},t.state=t.getStateFromProps(e),t}return i(e,n),e.prototype.componentWillReceiveProps=function(e){e.volume!==this.state.volume&&this.setState(this.getStateFromProps(e))},e.prototype.render=function(){return Vn.createElement("div",{className:o},Vn.createElement(wb.ProgressBar,{onHandleDrag:this.onProgressBarChange,onPercentSelect:this.onProgressBarChange,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,handleClassName:wb.debugClassName("volume-handle"),handlePercent:this.state.volume,handleWrapperClassName:wb.debugClassName("volume"),vertical:!0},Vn.createElement(wb.ProgressBarSegment,{startPercent:0,endPercent:this.state.volume,vertical:!0})))},e.contextType=QP.ReactContext,e}(Vn.Component);t.VolumeBar=n});e(rM);rM.VolumeBar;var iM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({position:"relative"},qS.ScalableWidth(25),qS.ScalableHeight(18)),a=qS.styler({display:"block"}),s=qS.styler({cursor:"pointer",opacity:.8,$nest:{"&:hover":{opacity:1}}},qS.ScalableWidth(25),qS.ScalableHeight(18)),l=qS.styler({boxSizing:"border-box !important",maxHeight:"60vh"},qS.ScalableHeight(150),qS.ScalablePadding(12,10)),u=qS.styler({height:"100%"}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.forceTooltipOpenTimeoutMs=1e3,t.forceTooltipOpenTimeoutId=null,t.onMutedChange=function(e){t.state.muted!==e&&t.setState({muted:e})},t.onVolumeChange=function(e){t.state.volume!==e&&t.setState({volume:e})},t.onVolumeDragStart=function(){t.tryClearTimeout(),t.setState({forceTooltipOpen:!0})},t.onVolumeDragEnd=function(){t.tryClearTimeout(),t.forceTooltipOpenTimeoutId=A.timer.setTimeout(function(){t.setState({forceTooltipOpen:!1})},t.forceTooltipOpenTimeoutMs)},t.state={forceTooltipOpen:!1,volume:null,muted:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.onVolumeChange(this.context.stores.playback.volume),this.context.stores.playback.on("MuteChange",this.onMutedChange),this.context.stores.playback.on("VolumeChange",this.onVolumeChange)},e.prototype.componentWillUnmount=function(){this.context.stores.playback.off("MuteChange",this.onMutedChange),this.context.stores.playback.off("VolumeChange",this.onVolumeChange)},e.prototype.render=function(){var e,t=this.context.stores.playback.volume,n=this.context.stores.playback.muted;return 0===t||n?e=Ww.SVG.VolumeMute:0<t&&t<.25?e=Ww.SVG.Volume0Bars:.25<=t&&t<.5?e=Ww.SVG.Volume1Bar:.5<=t&&t<.75?e=Ww.SVG.Volume2Bars:.75<=t&&(e=Ww.SVG.Volume3Bars),Vn.createElement("div",{className:o},Vn.createElement($C.TooltipButton,{buttonSrc:e,buttonWrapperClassName:a,buttonClassName:s,forceOpen:this.state.forceTooltipOpen,ariaLabel:"Volume"},Vn.createElement("div",{className:l,ref:"volumeBarTooltip"},Vn.createElement("div",{className:u},Vn.createElement(rM.VolumeBar,{onMouseDown:this.onVolumeDragStart,onMouseUp:this.onVolumeDragEnd,volume:t})))))},e.prototype.tryClearTimeout=function(){null!==this.forceTooltipOpenTimeoutId&&clearTimeout(this.forceTooltipOpenTimeoutId)},e.contextType=QP.ReactContext,e}(Vn.PureComponent);t.VolumeControl=n});e(iM);iM.VolumeControl;var oM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=qS.styler({display:"inline-flex",alignItems:"center"},qS.ScalableMarginTop(30)),u=qS.styler(wb.debugClassName("hideabletopbuttons-container"),{display:"flex",alignItems:"center",transition:"opacity 0.15s linear, visibility 0.15s linear",opacity:1,$nest:{"&.hide":{opacity:0},"& > .hide":{opacity:0},"& > div:first-child":{display:"flex",alignItems:"center"}}}),i=function(t){function e(e){var n=t.call(this,e)||this;return n.lock=null,n.pointerEventsSupported=xt.exists(window.PointerEvent),n.touched=!1,n.topButtonsRef=null,n.updateShouldDisplayControls=function(){var e=(n.state.userActive&&n.state.state!==$P.UIPlaybackState.Error&&n.state.state!==$P.UIPlaybackState.Stopped&&!n.state.modalShowing||n.state.state===$P.UIPlaybackState.Loading)&&!n.state.prePlaybackModalShowing;n.state.shouldDisplayControls!==e&&n.setState({shouldDisplayControls:e})},n.onUIStatusStoreUpdate=function(e){n.setState({state:e.state,userActive:e.userActive},function(){return n.updateShouldDisplayControls()})},n.onFullscreenStoreUpdate=function(e){n.setState({isFullscreen:e})},n.onModalStoreUpdate=function(e){n.setState({prePlaybackModalShowing:null!=e&&e.isPrePlayback,modalShowing:null!=e},function(){return n.updateShouldDisplayControls()})},n.onPictureInPictureStoreUpdate=function(e){n.setState({isPictureInPicture:e})},n.onUIConfigurationsChange=function(e){n.setState({uiConfigurations:e})},n.onScalingChange=function(e){n.setState({scaleDown:e})},n.onClickClose=function(){n.context.stores.lifecycle.onClose("MouseClick")},n.onClickFullscreen=function(){return window.twoseven.postToParent({ action: 'fullscreen' });n.state.isPictureInPicture||n.context.stores.fullscreen.toggleFullscreen("MouseClick")},n.onClickPictureInPicture=function(){n.state.isFullscreen||n.context.stores.pictureInPicture.togglePictureInPicture()},n.onMouseEnter=function(){n.touched=!1,n.state.shouldDisplayControls&&window.addEventListener("touchstart",n.onTouchInWindow)},n.onMouseMove=function(){n.state.shouldDisplayControls&&!n.touched&&n.lock.lock(null!==wb.UITimeoutMS.Hover20s?wb.UITimeoutMS.Hover20s:wb.UITimeoutMS.Touch)},n.onMouseLeave=function(){n.touched||(n.lock.unlock(),window.removeEventListener("touchstart",n.onTouchInWindow))},n.onPointerDown=function(e){"touch"===e.pointerType&&(n.touched=!0,n.lock.lock(wb.UITimeoutMS.Touch))},n.onTouchStart=function(e){n.pointerEventsSupported||(n.touched=!0,n.lock.lock(wb.UITimeoutMS.Touch))},n.onTouchInWindow=function(e){var t=e.touches[0];Ce.HTMLElementUtils.clickedInElement(n.topButtonsRef,t)||n.onMouseLeave()},n.shouldShowClosePlayerButton=function(){return n.state.uiConfigurations.playerCloseable&&!n.state.scaleDown},n.shouldShowFullscreenButton=function(){return n.state.uiConfigurations.enableFullscreen&&!n.state.scaleDown},n.shouldShowOptions=function(){return n.state.uiConfigurations.enableOptions},n.shouldShowPictureInPictureButton=function(){return n.context.stores.pictureInPicture.isSupported()},n.shouldShowSubtitlesAndAudio=function(){return n.state.uiConfigurations.enableMta||n.state.uiConfigurations.enableSubtitles},n.shouldShowVolumeControl=function(){return n.state.uiConfigurations.enableVolume},n.shouldUseSmallPlayerModalsUi=function(){return(n.state.modalShowing||n.state.prePlaybackModalShowing)&&n.context.stores.uiConfigurations.useSmallPlayerUI()},n.getPictureInPictureLocalization=function(e){return n.state.isPictureInPicture?e.exitPictureInPicture:n.state.isFullscreen?e.disabledPictureInPicture:e.pictureInPicture},n.getFullscreenLocalization=function(e){return n.state.isFullscreen?e.exitFullscreen:n.state.isPictureInPicture?e.disabledFullscreen:e.fullscreen},n.state={isFullscreen:!1,isPictureInPicture:!1,modalShowing:!1,prePlaybackModalShowing:!1,scaleDown:!1,shouldDisplayControls:!1,state:$P.UIPlaybackState.Stopped,uiConfigurations:_w.GetDefaultUIConfigurations(),userActive:!0},n}return n(e,t),e.prototype.componentDidMount=function(){this.lock=this.context.stores.lock.newLock(),this.onUIConfigurationsChange(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsChange),this.onUIStatusStoreUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.onModalStoreUpdate(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalStoreUpdate),this.context.stores.pictureInPicture.onChange(this.onPictureInPictureStoreUpdate),this.onFullscreenStoreUpdate(this.context.stores.fullscreen.isFullscreen()),this.context.stores.fullscreen.onFullscreenStateChange(this.onFullscreenStoreUpdate),this.context.stores.playerScaling.onScalingChange(this.onScalingChange)},e.prototype.componentWillUnmount=function(){this.context.stores.lock.deleteLock(this.lock),this.lock=null,this.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsChange),this.context.stores.modal.offUpdate(this.onModalStoreUpdate),this.context.stores.fullscreen.offFullscreenStateChange(this.onFullscreenStoreUpdate),this.context.stores.playerScaling.offScalingChange(this.onScalingChange),this.context.stores.pictureInPicture.offChange(this.onPictureInPictureStoreUpdate)},e.prototype.render=function(){var t=this,e=this.state.isFullscreen?Ww.SVG.ExitFullscreen:Ww.SVG.Fullscreen,n=PS(WC.FullscreenButtonClassName,wb.debugClassName("fullscreen-button"),{toggled:this.state.isFullscreen,disabled:this.state.isPictureInPicture}),r=PS(HC.PictureInPictureButtonClassName,wb.debugClassName("pictureinpicture-button"),{toggled:this.state.isPictureInPicture,disabled:this.state.isFullscreen}),i=PS(zC.CloseButtonWrapperClassName,wb.debugClassName("closebutton-wrapper"),{hide:!this.state.shouldDisplayControls&&!this.state.prePlaybackModalShowing}),o=PS(u,{hide:!this.state.shouldDisplayControls}),a=PS({hide:this.state.state===$P.UIPlaybackState.Loading}),s=this.context.stores.localization.getLocalization();return Vn.createElement("div",{ref:function(e){t.topButtonsRef=e},className:l,onTouchStart:this.onTouchStart,onPointerDown:this.onPointerDown,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onMouseMove:this.onMouseMove},Vn.createElement("div",{className:o},Vn.createElement("div",{className:a},this.shouldShowSubtitlesAndAudio()?Vn.createElement(nM.SubtitlesAndAudio,{useSmallPlayerModals:this.shouldUseSmallPlayerModalsUi}):null,this.shouldShowOptions()?Vn.createElement(ZC.Options,{useSmallPlayerModals:this.shouldUseSmallPlayerModalsUi}):null,this.shouldShowVolumeControl()?Vn.createElement(iM.VolumeControl,null):null),this.shouldShowPictureInPictureButton()?Vn.createElement(wb.ImageButton,{wrapperClassName:HC.PictureInPictureButtonWrapperClassName,className:r,onClick:this.onClickPictureInPicture,src:this.state.isPictureInPicture?Ww.SVG.PictureInPictureExit:Ww.SVG.PictureInPictureEnter},this.getPictureInPictureLocalization(s)):null,this.shouldShowFullscreenButton()?Vn.createElement(wb.ImageButton,{wrapperClassName:WC.FullscreenButtonWrapperClassName,className:n,onClick:this.onClickFullscreen,src:e,ariaLabel:"Fullscreen"},this.getFullscreenLocalization(s)):null,this.shouldShowFullscreenButton()&&this.shouldShowClosePlayerButton()?Vn.createElement("div",{className:qC.Divider}):null),this.shouldShowClosePlayerButton()?Vn.createElement(wb.ImageButton,{tooltipClassName:zC.ClosePlayerTooltipClassName,wrapperClassName:i,className:wb.debugClassName("playerclose-button"),onClick:this.onClickClose,src:Ww.SVG.Close,ariaLabel:"Close Player"},s.closePlayer):null)},e.contextType=QP.ReactContext,e}(Vn.Component);t.TopButtons=i});e(oM);oM.TopButtons;var aM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({display:"flex",flexDirection:"column"},Vw.Overlay),a=qS.styler({position:"relative",display:"flex",flex:"1 0",minHeight:"0"},qS.ScalablePadding(0,50)),s=qS.styler({width:"100%",display:"flex",justifyContent:"space-between"}),l=qS.styler({display:"flex",flexDirection:"column",minWidth:"0",overflow:"hidden"},Uw.HideWhenPlayerSmall),u=qS.styler({alignSelf:"flex-start",boxSizing:"border-box !important",minWidth:"0"},Vw.EnablePointerEvents),c=qS.styler({position:"absolute",maxWidth:"33%"},Bw.IfScreenExtraSmall({maxWidth:"85%"}),qS.ScalableBottom(90),qS.ScalableRight(50)),d=qS.styler({position:"absolute",width:"96%",order:1},qS.ScalableHeight(220),qS.ScalableBottom(5),qS.ScalablePaddingLeft(50)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onModalStoreUpdate=function(e){t.setState({prePlaybackModalShowing:null!=e&&e.isPrePlayback,modalShowing:null!=e})},t.onNextUpInfoStoreUpdate=function(e){t.setState({nextUpCarouselShowing:e.shouldShowNextUpCarousel})},t.onUIConfigurationsStoreUpdate=function(e){t.setState({enableNextUpCarousel:e.enableNextUpCarousel,enableSkipElement:e.enableSkipElement,enableXray:e.enableXray})},t.onUIStatusStoreUpdate=function(e){t.setState({state:e.state,userActive:e.userActive})},t.onErrorStoreUpate=function(e){t.setState({errorModalShowing:null!=e})},t.onXrayHighlightStoreUpdate=function(e){t.setState({hideUI:e})},t.state={enableNextUpCarousel:!1,enableSkipElement:!0,enableXray:!0,errorModalShowing:!1,modalShowing:!1,nextUpCarouselShowing:!1,prePlaybackModalShowing:!1,state:$P.UIPlaybackState.Loading,userActive:!1,hideUI:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.onModalStoreUpdate(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalStoreUpdate),this.onNextUpInfoStoreUpdate(this.context.stores.nextUpInfo.getNextUpInfo()),this.context.stores.nextUpInfo.onUpdate(this.onNextUpInfoStoreUpdate),this.onUIConfigurationsStoreUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsStoreUpdate),this.onUIStatusStoreUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.onErrorStoreUpate(this.context.stores.error.getCurrentError()),this.context.stores.error.onError(this.onErrorStoreUpate),this.context.stores.xrayHighlightModeStore.onHighlightInfoChange(this.onXrayHighlightStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.modal.offUpdate(this.onModalStoreUpdate),this.context.stores.nextUpInfo.offUpdate(this.onNextUpInfoStoreUpdate),this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsStoreUpdate),this.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.context.stores.error.offError(this.onErrorStoreUpate),this.context.stores.xrayHighlightModeStore.offHighlightInfoChange(this.onXrayHighlightStoreUpdate)},e.prototype.render=function(){var t=this;if(this.state.errorModalShowing||this.state.hideUI)return null;var e=this.state.state,n=!(e!==$P.UIPlaybackState.Playing&&e!==$P.UIPlaybackState.Paused&&e!==$P.UIPlaybackState.Buffering||this.state.modalShowing||this.state.prePlaybackModalShowing||this.state.nextUpCarouselShowing),r=this.context.stores.localization.getLocalization();return Vn.createElement("div",{className:o},Vn.createElement("div",{className:a},Vn.createElement(jC.PersistentPanel,null),F.isEmpty(r)?null:Vn.createElement("div",{className:s},Vn.createElement("div",{className:l},this.state.enableXray?Vn.createElement(dP.XrayQuickView,{canShowXray:n,isUserActive:this.state.userActive,newLock:function(){return t.context.stores.lock.newLock()},deleteLock:function(e){return t.context.stores.lock.deleteLock(e)}}):null),Vn.createElement("div",{className:u},Vn.createElement(oM.TopButtons,null)))),F.isEmpty(r)?null:Vn.createElement(iC.BottomPanel,null),F.isEmpty(r)?null:Vn.createElement("div",{className:c},Vn.createElement(MC.Notifications,null),this.state.enableNextUpCarousel?null:Vn.createElement(aC.NextUpCard,null),this.state.enableSkipElement?Vn.createElement(XC.SkipElement,null):null),this.state.enableXray?Vn.createElement(dP.XrayPopUpView,{canShowXray:n,isUserActive:this.state.userActive,newLock:function(){return t.context.stores.lock.newLock()},deleteLock:function(e){return t.context.stores.lock.deleteLock(e)}}):null,!F.isEmpty(r)&&this.state.enableNextUpCarousel?Vn.createElement("div",{className:d}):null)},e.contextType=QP.ReactContext,e}(Vn.Component);t.ControlsOverlay=n});e(aM);aM.ControlsOverlay;var sM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({background:"rgba(0, 0, 0, 0.25)",transition:"opacity 150ms ease-in",opacity:1,$nest:{"&.hide":{opacity:0}}},Vw.Overlay),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onUIStatusStoreUpdate=function(e){t.setState({state:e.state,userActive:e.userActive})},t.onModalStoreUpdate=function(e){t.setState({isPrePlayback:null!=e&&e.isPrePlayback,isModalShowing:null!=e})},t.shouldShow=function(){return t.state.userActive||t.state.state===$P.UIPlaybackState.Loading||t.state.state===$P.UIPlaybackState.Error||t.state.isModalShowing||t.state.isPrePlayback},t.state={state:$P.UIPlaybackState.Loading,userActive:!0,isPrePlayback:!1,isModalShowing:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.onUIStatusStoreUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.onModalStoreUpdate(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.context.stores.modal.offUpdate(this.onModalStoreUpdate)},e.prototype.render=function(){var e=o+" "+(this.shouldShow()?"":" hide");return Vn.createElement("div",{className:e})},e.contextType=QP.ReactContext,e}(Vn.Component);t.GradientOverlay=n});e(sM);sM.GradientOverlay;var lM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({position:"absolute",top:"0",left:"0",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",backgroundColor:"black"}),a=qS.styler({width:"100%",opacity:0,transition:"opacity 0.2s linear"}),s=qS.styler({opacity:.5}),l=[dw.ErrorCodeTree.web.pin_protection.pin_setup_required,dw.ErrorCodeTree.web.pin_protection.pin_age_verification,dw.ErrorCodeTree.web.pin_protection.pin_validation_error],n=function(n){function e(e){var t=n.call(this,e)||this;return t.onModalInfoUpdate=function(e){t.setState({prePlaybackModalShowing:null!==e&&e.isPrePlayback})},t.onLoad=function(){t.setState({imageLoaded:!0})},t.onPictureInPictureUpdate=function(e){t.setState({isPictureInPicture:e})},t.onTitleInfo=function(e){t.setState({imageLoaded:e.heroImageUrl===t.state.imageUrl&&t.state.imageLoaded,imageUrl:e.heroImageUrl})},t.onUIStatusChange=function(e){t.setState({uiPlaybackState:e.state})},t.onPINRequiredChange=function(e){t.setState({pinRequired:e})},t.onErrorStoreUpdate=function(e){t.setState({pinErrorModalShowing:null!=e&&null!=e.code&&F.contains(l,e.code)})},t.state={imageLoaded:!1,imageUrl:null,isPictureInPicture:!1,pinErrorModalShowing:!1,pinRequired:!1,prePlaybackModalShowing:!1,uiPlaybackState:$P.UIPlaybackState.Stopped},t}return i(e,n),e.prototype.componentDidMount=function(){this.onPINRequiredChange(this.context.stores.gCast.getPINRequired()),this.context.stores.gCast.on("PINRequiredChange",this.onPINRequiredChange),this.onModalInfoUpdate(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalInfoUpdate),this.onTitleInfo(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfo),this.context.stores.uiStatus.onUpdate(this.onUIStatusChange),this.onErrorStoreUpdate(this.context.stores.error.getCurrentError()),this.context.stores.error.onError(this.onErrorStoreUpdate),this.context.stores.pictureInPicture.onChange(this.onPictureInPictureUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.gCast.off("PINRequiredChange",this.onPINRequiredChange),this.context.stores.modal.offUpdate(this.onModalInfoUpdate),this.context.stores.title.offUpdate(this.onTitleInfo),this.context.stores.uiStatus.offUpdate(this.onUIStatusChange),this.context.stores.error.offError(this.onErrorStoreUpdate),this.context.stores.pictureInPicture.offChange(this.onPictureInPictureUpdate)},e.prototype.render=function(){var e;if(!this.shouldShow())return null;var t=PS(a,((e={})[s]=this.state.imageLoaded,e));return Vn.createElement("div",{className:o},null===this.state.imageUrl?null:Vn.createElement("img",{className:t,src:this.state.imageUrl,onLoad:this.onLoad,alt:""}))},e.prototype.shouldShow=function(){return this.state.uiPlaybackState===$P.UIPlaybackState.Loading||this.state.uiPlaybackState===$P.UIPlaybackState.Error||this.state.pinRequired||this.state.prePlaybackModalShowing||this.state.pinErrorModalShowing||this.state.isPictureInPicture},e.contextType=QP.ReactContext,e}(Vn.Component);t.HeroImageOverlay=n});e(lM);lM.HeroImageOverlay;var uM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler(wb.debugClassName("loadingspinner-overlay"),{position:"absolute",top:"50%",left:"50%"},qS.ScalableMarginLeft(-40),qS.ScalableMarginTop(-40),qS.ScalableWidth(80),qS.ScalableHeight(80)),o=function(t){function e(e){var n=t.call(this,e)||this;return n.hasReportedInitialSpinner=!1,n.onUIStatusUpdate=function(e){var t=e.state===$P.UIPlaybackState.Buffering||e.state===$P.UIPlaybackState.Loading;(t!=n.state.canShow||t&&!n.hasReportedInitialSpinner)&&(n.hasReportedInitialSpinner=!0,n.context.stores.uiStatus.reportSpinnerShowing(t)),n.setState({canShow:t})},n.state={canShow:!0},n}return n(e,t),e.prototype.componentDidMount=function(){this.onUIStatusUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiStatus.offUpdate(this.onUIStatusUpdate)},e.prototype.render=function(){return Vn.createElement("div",{className:Vw.Overlay},Vn.createElement(wb.LoadingSpinner,{className:i,shouldShow:this.state.canShow}))},e.contextType=QP.ReactContext,e}(Vn.Component);t.LoadingOverlay=o});e(uM);uM.LoadingOverlay;var cM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l,i,o={maturityRatingOverlay:{enter:500,exit:500},illuminateGradientOpacity:{enter:1500,exit:3500},illuminateGradientScale:{enter:1e3,exit:3500}},a=qS.styler({opacity:0,transition:"opacity "+o.maturityRatingOverlay.enter+"ms ease-out"}),s=qS.styler({opacity:1,transition:"opacity "+o.maturityRatingOverlay.enter+"ms ease-out"}),u=qS.styler({opacity:1,transition:"opacity "+o.maturityRatingOverlay.exit+"ms ease-in"}),c=qS.styler({opacity:0,transition:"opacity "+o.maturityRatingOverlay.exit+"ms ease-in"}),d={enter:a,enterActive:s,enterDone:s,exit:u,exitActive:c,exitDone:c},p=qS.styler(d.exitDone,Vw.Overlay),f=qS.styler({opacity:1,transition:"opacity 50ms ease-out"}),h=qS.styler({opacity:0,transition:"opacity 50ms ease-out"}),m=qS.styler({opacity:0,transition:"opacity 50ms ease-out"}),y=qS.styler({opacity:1,transition:"opacity 50ms ease-out"}),g={enter:f,enterActive:h,enterDone:h,exit:m,exitActive:y,exitDone:y},v=qS.styler({opacity:0,transition:"opacity "+o.illuminateGradientOpacity.enter+"ms ease-out"}),S=qS.styler({opacity:1,transition:"opacity "+o.illuminateGradientOpacity.enter+"ms ease-out"}),b=qS.styler({opacity:1,transition:"opacity "+o.illuminateGradientOpacity.exit+"ms ease-in"}),T=qS.styler({opacity:0,transition:"opacity "+o.illuminateGradientOpacity.exit+"ms ease-in"}),P={enter:v,enterActive:S,enterDone:S,exit:b,exitActive:T,exitDone:T},w=qS.styler({transform:"scale(0.8)",transition:"transform "+o.illuminateGradientScale.enter+"ms ease-in-out"}),C=qS.styler({transform:"scale(1)",transition:"transform "+o.illuminateGradientScale.enter+"ms ease-in-out"}),M=qS.styler({transform:"scale(1)",transition:"transform "+o.illuminateGradientScale.exit+"ms ease-in"}),I=qS.styler({transform:"scale(0.8)",transition:"transform "+o.illuminateGradientScale.exit+"ms ease-in"}),E={enter:w,enterActive:C,enterDone:C,exit:M,exitActive:I,exitDone:I},_=qS.styler({position:"absolute",left:0,top:0,backgroundImage:"radial-gradient(ellipse 100% 100% at top left, rgba(0,124,166,0.6) 0%, rgba(76,182,193,0) 100%)",transformOrigin:"top left"},E.exitDone,qS.ScalableWidth(300),qS.ScalableHeight(300)),x=qS.styler({position:"absolute",left:0,top:0,width:"100%",backgroundImage:"linear-gradient(180deg, rgba(0,0,0,0.65) 0%, rgba(0,0,0,0.45) 45%, rgba(0,0,0,0) 90%)"},qS.ScalableHeight(240)),k=qS.styler({position:"relative",marginLeft:"5%",maxWidth:"50%"},qS.ScalableMarginTop(34)),R=qS.styler({display:"flex",alignItems:"center",marginBottom:"12px"}),A=qS.styler({verticalAlign:"middle"},qS.ScalableHeight(36),qS.ScalableMarginRight(10)),O=qS.styler({padding:0,margin:0,color:"#18BBE8",textShadow:"2px 2px 1px rgba(0,0,0,0.60)",fontWeight:"bold",textTransform:"uppercase"},qS.ScalableFontSize(24)),L=qS.styler({color:"#FFFFFF",fontWeight:"normal",lineHeight:1,margin:0,padding:0,textShadow:"2px 2px 1px rgba(0,0,0,0.60)",whiteSpace:"pre-line"},qS.ScalableFontSize(17));(i=l||(l={}))[i.OUT=0]="OUT",i[i.TRANSITIONING_IN=1]="TRANSITIONING_IN",i[i.IN=2]="IN",i[i.TRANSITIONING_OUT=3]="TRANSITIONING_OUT";var F=function(t){function e(e){var n=t.call(this,e)||this;return n.onLocalizationUpdate=function(e){var t=n.context.stores.localization.getLocalization();n.setState({localization:t.maturityRating})},n.onMaturityRatingUpdate=function(e){n.setState({maturityRating:e}),n.context.stores.maturityRatingStore.reportVisibleMaturityRating(n.isVisible(n.state),e)},n.onTimelineInfoUpdate=function(e){null!=e&&null!=e.startPositionMs&&null!=e.positionMs&&n.setState({startTimeOffset:e.positionMs-e.startPositionMs})},n.onUserInterfaceUpdate=function(e){n.setState({userActive:e.userActive})},n.state={localization:null,maturityRating:null,startTimeOffset:-1,userActive:!1,maturityRatingOverlayTransition:l.OUT,illuminateGradientOpacityTransition:l.OUT,illuminateGradientScaleTransition:l.OUT},n.animationKeyframes=[{triggerTimeMs:5e3,action:{maturityRatingOverlayTransition:l.TRANSITIONING_IN,illuminateGradientOpacityTransition:l.TRANSITIONING_IN}},{triggerTimeMs:6500,action:{illuminateGradientScaleTransition:l.TRANSITIONING_IN}},{triggerTimeMs:8500,action:{illuminateGradientOpacityTransition:l.TRANSITIONING_OUT,illuminateGradientScaleTransition:l.TRANSITIONING_OUT}},{triggerTimeMs:12500,action:{maturityRatingOverlayTransition:l.TRANSITIONING_OUT}}],n.animationKeyframeWindow=n.animationKeyframes.reduce(function(e,t){return{min:Math.min(e.min,t.triggerTimeMs),max:Math.max(e.max,t.triggerTimeMs)}},{min:1/0,max:-1/0}),n}return n(e,t),e.prototype.componentDidMount=function(){null!=this.context.stores.localization.getCurrentLanguage()&&this.onLocalizationUpdate(this.context.stores.localization.getCurrentLanguage()),this.context.stores.localization.onLanguageChanged(this.onLocalizationUpdate),this.onMaturityRatingUpdate(this.context.stores.maturityRatingStore.getMaturityRating()),this.context.stores.maturityRatingStore.onMaturityRatingChange(this.onMaturityRatingUpdate),this.onTimelineInfoUpdate(this.context.stores.timeline.getTimelineInfo()),this.context.stores.timeline.onUpdate(this.onTimelineInfoUpdate),this.onUserInterfaceUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUserInterfaceUpdate)},e.prototype.componentWillUpdate=function(e,i){var o=this,t=i.startTimeOffset>this.animationKeyframeWindow.max&&i.maturityRatingOverlayTransition===l.OUT,n=null!=i.maturityRating.rating||null!=i.maturityRating.ratingImageSrc||null!=i.maturityRating.description,r=null!=i.localization;if(i.startTimeOffset>=this.animationKeyframeWindow.min&&!t&&n&&r){var a=this.animationKeyframes.filter(function(e){return e.triggerTimeMs<=i.startTimeOffset}).reduce(function(e,t){var n=i.startTimeOffset-e.triggerTimeMs;return i.startTimeOffset-t.triggerTimeMs<=n?t:e});if(null!=a){var s=a.action;["illuminateGradientOpacityTransition","illuminateGradientScaleTransition","maturityRatingOverlayTransition"].forEach(function(e){var t,n=o.isIn(s[e])!==o.isIn(i[e]),r=o.isTransitioning(i[e]);null!=s[e]&&n&&!r&&o.setState(((t={})[e]=s[e],t))})}}else{["illuminateGradientOpacityTransition","illuminateGradientScaleTransition","maturityRatingOverlayTransition"].forEach(function(e){var t;o.isIn(i[e])&&o.setState(((t={})[e]=l.TRANSITIONING_OUT,t))})}this.isVisible(i)!==this.isVisible(this.state)&&this.context.stores.maturityRatingStore.reportVisibleMaturityRating(this.isVisible(i),i.maturityRating)},e.prototype.render=function(){var e=this,t=null,n=null,r=null;return null!=this.state.maturityRating&&null!=this.state.localization&&(null!=this.state.maturityRating.rating&&(n=this.state.localization.rated.replace("{{rating}}",this.state.maturityRating.rating)),t=this.state.maturityRating.ratingImageSrc,r=this.state.maturityRating.description),Vn.createElement("div",null,Vn.createElement(wC.CSSTransition,{in:this.isIn(this.state.maturityRatingOverlayTransition),timeout:o.maturityRatingOverlay,classNames:d,onEntered:function(){return e.setState({maturityRatingOverlayTransition:l.IN})},onExited:function(){return e.setState({maturityRatingOverlayTransition:l.OUT})}},Vn.createElement("div",{className:p},Vn.createElement(wC.CSSTransition,{in:this.state.userActive,timeout:50,classNames:g},Vn.createElement("div",{className:g.exitDone},Vn.createElement(wC.CSSTransition,{in:this.isIn(this.state.illuminateGradientOpacityTransition),timeout:o.illuminateGradientOpacity,classNames:P,onEntered:function(){return e.setState({illuminateGradientOpacityTransition:l.IN})},onExited:function(){return e.setState({illuminateGradientOpacityTransition:l.OUT})}},Vn.createElement("div",{className:P.exitDone},Vn.createElement(wC.CSSTransition,{in:this.isIn(this.state.illuminateGradientScaleTransition),timeout:o.illuminateGradientScale,classNames:E,onEntered:function(){return e.setState({illuminateGradientScaleTransition:l.IN})},onExited:function(){return e.setState({illuminateGradientScaleTransition:l.OUT})}},Vn.createElement("div",{className:_})))),Vn.createElement("div",{className:x}),Vn.createElement("div",{className:k},Vn.createElement("div",{className:R},null!=t?Vn.createElement("img",{src:t,className:A}):null,null!=n?Vn.createElement("span",{className:O},n):null),null!=r?Vn.createElement("div",{className:L},r):null))))))},e.prototype.isIn=function(e){return e===l.TRANSITIONING_IN||e===l.IN},e.prototype.isTransitioning=function(e){return e===l.TRANSITIONING_IN||e===l.TRANSITIONING_OUT},e.prototype.isVisible=function(e){return e.maturityRatingOverlayTransition!==l.OUT&&!e.userActive},e.contextType=QP.ReactContext,e}(Vn.Component);t.MaturityRatingOverlay=F});e(cM);cM.MaturityRatingOverlay;var dM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({boxSizing:"border-box !important",display:"inline-block",textAlign:"center",fontWeight:"normal",position:"relative",border:"solid transparent",$nest:i({"&:not(.disabled)":{cursor:"pointer"},"&:hover:not(.disabled), &.selected":i({border:"solid #fff"},qS.ScaleNestedProperty("border-width",1)),"&:not(:first-child)":qS.ScaleNestedProperty("margin-left",8)},qS.RTLStyle({$nest:{"&:not(:first-child)":i({marginLeft:"auto"},qS.ScaleNestedProperty("margin-right",8))}}))},qS.ScaleProperty("border-width",1),qS.ScalableWidth(30),qS.ScalableHeight(30)),a=qS.styler({width:"100%",height:"100%",position:"absolute",display:"flex",alignItems:"center",fontFamily:"\"Arial\", sans-serif",$nest:{"&.casual":_C.FontMap.casual,"&.cursive":_C.FontMap.cursive,"&.monospaceSansSerif":_C.FontMap.monospaceSansSerif,"&.monospaceSerif":_C.FontMap.monospaceSerif,"&.proportionalSansSerif":_C.FontMap.proportionalSansSerif,"&.proportionalSerif":_C.FontMap.proportionalSerif,"&.smallCapitals":_C.FontMap.smallCapitals,"&.raised":EC.FontEdgeMap.raised,"&.depressed":EC.FontEdgeMap.depressed,"&.uniform":EC.FontEdgeMap.uniform,"&.shadow":EC.FontEdgeMap.shadow}},qS.ScalableFontSize(15)),s=qS.styler({width:"100%",height:"100%",position:"absolute"}),l=qS.styler({width:"100%"}),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){!e.props.disabled&&F.isFunction(e.props.onClick)&&e.props.onClick(e)},e}return n(e,t),e.prototype.render=function(){var e=PS(o,{selected:this.props.isSelected,disabled:this.props.disabled}),t=this.props.timedTextStyle,n=a;xt.exists(t.txtEdge)&&"no"!==t.txtEdge&&(n+=" "+t.txtEdge),xt.exists(t.txtFont)&&"default"!==t.txtFont&&(n+=" "+t.txtFont);var r={opacity:xt.exists(t.bgOpacity)?t.bgOpacity:.5,backgroundColor:t.bgColor},i={color:t.txtColor,opacity:t.txtOpacity};return Vn.createElement("div",{className:e,onClick:this.onClick},Vn.createElement("div",{className:s,style:r}),Vn.createElement("div",{className:n,style:i},Vn.createElement("div",{className:l},this.props.children)))},e.defaultProps={disabled:!1,isSelected:!1,timedTextStyle:{},value:""},e}(Vn.PureComponent);t.CaptionsPresetButton=u});e(dM);dM.CaptionsPresetButton;var pM=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=qS.styler({}),s=qS.styler(qS.ScalableHeight(32),qS.ScalableWidth(39)),l=qS.styler({display:"inline-block",fontWeight:"normal",color:"#999",opacity:.75,$nest:o((n={"&:not(:first-child)":qS.ScaleNestedProperty("margin-left",10)},n[":not(."+s+")"]={marginTop:"-4px"},n[":not(."+a+")"]={cursor:"pointer"},n["&:hover:not(."+a+")"]={color:qS.PrimaryColor,opacity:1},n),qS.RTLStyle({$nest:{"&:not(:first-child)":o({marginLeft:"auto"},qS.ScaleNestedProperty("margin-right",10))}}))}),u=qS.styler({position:"absolute",bottom:"0",margin:"0"}),c=qS.styler({color:qS.PrimaryColor,opacity:1}),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClick=function(){!e.props.disabled&&F.isFunction(e.props.onClick)&&e.props.onClick(e)},e}return i(e,t),e.prototype.render=function(){var e,t=PS(l,this.props.fontSize,((e={})[c]=this.props.isSelected,e[a]=this.props.disabled,e[s]=this.props.isCollapsedButton,e)),n=this.props.isCollapsedButton?Vn.createElement("p",{className:u},this.props.children):this.props.children;return Vn.createElement("div",{className:t,onClick:this.onClick},n)},e.defaultProps={disabled:!1,isSelected:!1,isCollapsedButton:!1,fontSize:"",value:1},e}(Vn.Component);t.CaptionsSizeButton=d});e(pM);pM.CaptionsSizeButton;var fM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=V&&V.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler(qS.ScalableWidth(450)),a=qS.styler({display:"flex",alignItems:"baseline"}),s=qS.styler({$nest:{"&:hover":{cursor:"pointer"}}}),l=qS.styler(s,qS.ScalableFontSize(17)),u=qS.styler(s,qS.ScalableFontSize(21)),c=qS.styler(s,qS.ScalableFontSize(25)),d=qS.styler(s,qS.ScalableFontSize(29)),p=qS.styler(s,qS.ScalableFontSize(33)),f=qS.styler({float:"left",$nest:i({},qS.RTLStyle({float:"right"}))},qS.ScalableMinWidth(100)),h=qS.styler({boxSizing:"border-box",overflow:"visible",display:"flex",alignItems:"center",$nest:{"&:not(:last-child)":{borderBottom:"1px solid rgba(255, 255, 255, 0.1)"}}},qS.ScalableHeight(71)),m=qS.styler({$nest:i({},qS.RTLStyle(i({paddingRight:"0px"},qS.ScaleNestedProperty("padding-left",20))))},h,qS.ScalablePaddingRight(20)),y=qS.styler({color:"#fff",fontWeight:"normal"},h,qS.ScalableFontSize(17),qS.ScalablePadding(0,20)),g=function(t){function e(e){var i=t.call(this,e)||this;return i.onActivePresetChange=function(e){i.setState({selectedPresetName:e})},i.onCaptionsPresetsChange=function(e){i.setState({presets:e})},i.onCaptionsPresetChanged=function(e){i.context.stores.captions.setTimedTextStyle(i.state.presets[e],e.toString())},i.onCaptionsSizeChanged=function(e){"number"==typeof e&&i.context.stores.captions.onCaptionsSizeChanged(e)},i.getCaptionsPresets=function(){if(xt.isNullOrUndefined(i.state.presets))return null;var e=[],t=i.context.stores.localization.getLocalization();for(var n in i.state.presets)if(i.state.presets.hasOwnProperty(n)){var r=i.state.presets[n];e.push(Vn.createElement(dM.CaptionsPresetButton,{key:n,value:n,timedTextStyle:r},t.subtitlesPresetText))}return 0<e.length?Vn.createElement(wb.RadioButtonGroup,{onChange:i.onCaptionsPresetChanged,selectedButton:i.state.selectedPresetName},e):null},i.getCaptionsSizes=function(){var e=i.context.stores.localization.getLocalization();return xt.exists(i.context.stores.captions.getTimedTextStreamInfo().streams)&&xt.exists(i.context.stores.captions.getFontScale())?Vn.createElement(wb.RadioButtonGroup,{onChange:i.onCaptionsSizeChanged,selectedButton:i.context.stores.captions.getFontScale(),className:a},Vn.createElement(pM.CaptionsSizeButton,{value:.5,fontSize:l},e.subtitlesPresetText),Vn.createElement(pM.CaptionsSizeButton,{value:.75,fontSize:u},e.subtitlesPresetText),Vn.createElement(pM.CaptionsSizeButton,{value:1,fontSize:c},e.subtitlesPresetText),Vn.createElement(pM.CaptionsSizeButton,{value:1.25,fontSize:d},e.subtitlesPresetText),Vn.createElement(pM.CaptionsSizeButton,{value:1.5,fontSize:p},e.subtitlesPresetText)):null},i.onCloseClicked=function(){i.context.stores.captions.onCloseModal(),i.context.stores.modal.onCloseModal()},i.state={presets:{},selectedPresetName:""},i}return n(e,t),e.prototype.componentDidMount=function(){this.onCaptionsPresetsChange(this.context.stores.captions.getCaptionsPresets()),this.context.stores.captions.on("CaptionsPresetsChange",this.onCaptionsPresetsChange),this.onActivePresetChange(this.context.stores.captions.getActiveCaptionsPreset()),this.context.stores.captions.on("ActivePresetChange",this.onActivePresetChange)},e.prototype.componentWillUnmount=function(){this.context.stores.captions.off("CaptionsPresetsChange",this.onCaptionsPresetsChange),this.context.stores.captions.off("ActivePresetChange",this.onActivePresetChange)},e.prototype.render=function(){var e=this,t=function(){return e.context.stores.uiConfigurations.useSmallPlayerUI()},n=this.context.stores.localization.getLocalization(),r=PS("captionsModalContents flexColumn",{fullParentSize:t()});return Vn.createElement(wb.Modal,{className:o,useSmallPlayerModals:t},Vn.createElement("div",{className:r},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},n.subtitlesSettings,Vn.createElement("div",{className:wb.ModalStyles.ClosePlayerClassName,onClick:this.onCloseClicked})),Vn.createElement("div",{className:qS.ScrollableVertical},Vn.createElement("div",{className:f},Vn.createElement("div",{className:y},n.size),Vn.createElement("div",{className:y},n.presets)),Vn.createElement("div",null,Vn.createElement("div",{className:m},this.getCaptionsSizes()),Vn.createElement("div",{className:m},this.getCaptionsPresets())))))},e.contextType=QP.ReactContext,e}(Vn.Component);t.CaptionsModal=g});e(fM);fM.CaptionsModal;var hM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler(wb.debugClassName("contentwarningmodal-container"),{userSelect:"text",pointerEvents:"auto",display:"flex",flexDirection:"column"}),a=qS.styler(qS.ScalableMarginTop(20)),s=qS.styler({textAlign:"center",$nest:n({"& > *:not(:first-child)":qS.ScaleNestedProperty("margin-left",10),"& > *":qS.ScaleNestedProperty("min-width",120)},qS.RTLStyle({$nest:{"& > *:not(:first-child)":n({marginLeft:"auto"},qS.ScaleNestedProperty("margin-right",10))}}))},qS.ScalablePadding(10)),l=qS.styler({height:"100%",width:"100%"}),u=function(n){function e(e){var t=n.call(this,e)||this;return t.onUIConfigurationsUpdate=function(e){t.setState({uiConfigurations:e})},t.onClosePlayerClicked=function(){t.context.stores.contentWarning.onCloseContentWarning(),t.context.stores.lifecycle.onClose("MouseClick")},t.onContinueClicked=function(){t.context.stores.contentWarning.onContinueContentWarning(t.state.dontShowAgain),t.context.stores.modal.onCloseModal()},t.dontShowValueChanged=function(e){t.setState({dontShowAgain:e})},t.shouldShowClosePlayerButton=function(){return t.state.uiConfigurations.playerCloseable},t.state={dontShowAgain:!1,uiConfigurations:_w.GetDefaultUIConfigurations()},t}return i(e,n),e.prototype.componentDidMount=function(){this.onUIConfigurationsUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsUpdate)},e.prototype.render=function(){var e,t=this,n=this.context.stores.localization.getLocalization(),r=function(){return t.context.stores.uiConfigurations.useSmallPlayerUI()},i=PS(o,((e={})[l]=r(),e));return Vn.createElement(wb.Modal,{useSmallPlayerModals:r},Vn.createElement("div",{className:i},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},n.ContentWarning.title,this.shouldShowClosePlayerButton()?Vn.createElement("div",{className:wb.ModalStyles.ClosePlayerClassName,onClick:this.onClosePlayerClicked}):null),Vn.createElement("div",{className:wb.ModalStyles.DescriptionClassName+" "+qS.ScrollableVertical},Vn.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.text}}),Vn.createElement("div",{className:a},Vn.createElement(wb.Checkbox,{onChange:this.dontShowValueChanged,isChecked:this.state.dontShowAgain},n.dontShowAgain))),Vn.createElement("div",{className:wb.ModalStyles.FooterClassName+" "+s},this.shouldShowClosePlayerButton()?Vn.createElement(wb.Button,{onClick:this.onClosePlayerClicked},n.closePlayer):null,Vn.createElement(wb.Button,{className:wb.debugClassName("contentwarningmodalcontinue-button"),onClick:this.onContinueClicked},n.continue))))},e.contextType=QP.ReactContext,e}(Vn.PureComponent);t.ContentWarningModal=u});e(hM);hM.ContentWarningModal;var mM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({display:"flex",flexDirection:"column",overflow:"hidden",userSelect:"text",pointerEvents:"auto"}),a=qS.styler({textAlign:"center"},qS.ScalablePadding(10)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onCloseClicked=function(){t.context.stores.lifecycle.onClose("MouseClick")},t.onError=function(e){t.setState({error:e})},t.onUiConfigurationsUpdate=function(e){t.setState({uiConfigurations:e})},t.state={error:null,uiConfigurations:_w.GetDefaultUIConfigurations()},t}return i(e,n),e.prototype.componentDidMount=function(){this.onError(this.context.stores.error.getCurrentError()),this.context.stores.error.onError(this.onError),this.onUiConfigurationsUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUiConfigurationsUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.error.offError(this.onError),this.context.stores.uiConfigurations.offUpdate(this.onUiConfigurationsUpdate)},e.prototype.render=function(){var e=this;if(null===this.state.error)return null;var t=function(){return e.context.stores.uiConfigurations.useSmallPlayerUI()};return Vn.createElement(wb.Modal,{useSmallPlayerModals:t},Vn.createElement("div",{className:o},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},this.state.error.title,this.shouldShowClosePlayerButton()?Vn.createElement("div",{className:wb.ModalStyles.ClosePlayerClassName,onClick:this.onCloseClicked}):null),Vn.createElement("div",{className:wb.ModalStyles.DescriptionClassName+" "+qS.ScrollableVertical,dangerouslySetInnerHTML:{__html:this.state.error.description}}),!t()&&this.shouldShowClosePlayerButton()?Vn.createElement("div",{className:wb.ModalStyles.FooterClassName+" "+a},Vn.createElement(wb.Button,{onClick:this.onCloseClicked},this.context.stores.localization.getLocalization().closePlayer)):null))},e.prototype.shouldShowClosePlayerButton=function(){return this.state.uiConfigurations.playerCloseable},e.contextType=QP.ReactContext,e}(Vn.Component);t.ErrorModal=n});e(mM);mM.ErrorModal;var yM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({display:"flex",flexDirection:"column"}),a=qS.styler({textAlign:"center"},qS.ScalablePadding(10)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onUIConfigurationsUpdate=function(e){t.setState({uiConfigurations:e})},t.onCloseClicked=function(){t.context.stores.modal.onCloseModal()},t.state={uiConfigurations:_w.GetDefaultUIConfigurations()},t}return i(e,n),e.prototype.componentDidMount=function(){this.onUIConfigurationsUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsUpdate)},e.prototype.render=function(){var e=this,t=this.context.stores.localization.getLocalization(),n=t.hdcpMessage.replace("{{hdcpHelpUrl}}",this.context.amazonUrlCreator.createCSUrl("HDCP_HELP")),r=function(){return e.context.stores.uiConfigurations.useSmallPlayerUI()},i=PS(o,{fullParentSize:F.isFunction(r)&&r()});return Vn.createElement(wb.Modal,{useSmallPlayerModals:r},Vn.createElement("div",{className:i},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},t.hdVideoUnavailable),Vn.createElement("div",{className:wb.ModalStyles.DescriptionClassName+" "+qS.ScrollableVertical,dangerouslySetInnerHTML:{__html:n}}),Vn.createElement("div",{className:wb.ModalStyles.FooterClassName+" "+a},Vn.createElement(wb.Button,{onClick:this.onCloseClicked},t.close))))},e.contextType=QP.ReactContext,e}(Vn.Component);t.HDCPInfoModal=n});e(yM);yM.HDCPInfoModal;var gM=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FullParentSizeClassName=qS.styler({height:"100%",width:"100%"})});e(gM);gM.FullParentSizeClassName;var vM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({display:"flex",flexDirection:"column"}),o=qS.styler({maxHeight:"none",overflowX:"hidden"}),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onCloseClicked=function(){e.context.stores.modal.onCloseModal()},e}return n(e,t),e.prototype.componentDidMount=function(){this.forceUpdate()},e.prototype.render=function(){var e,t=this,n=function(){return t.context.stores.uiConfigurations.useSmallPlayerUI()},r=PS(i,((e={})[gM.FullParentSizeClassName]=n(),e));return Vn.createElement(wb.Modal,{useSmallPlayerModals:n},Vn.createElement("div",{className:r},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},Vn.createElement("div",{className:wb.ModalStyles.ClosePlayerClassName,onClick:this.onCloseClicked})),Vn.createElement("div",{className:o+" "+qS.ScrollableVertical},Vn.createElement(JC.OptionsMenu,{isInsideModal:!0}))))},e.contextType=QP.ReactContext,e}(Vn.Component);t.OptionsModal=a});e(vM);vM.OptionsModal;var SM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler(wb.debugClassName("pin-modal"),qS.ScalableWidth(400)),a=qS.styler({$nest:o({},qS.RTLStyle({display:"flex",justifyContent:"flex-start"}))},qS.ScalableMargin(20,0,5,0)),s=qS.styler(wb.debugClassName("pin-field"),{border:"1px solid #616161 !important",backgroundColor:"#212121 !important",color:"transparent",textShadow:"0 0 "+qS.TextColor,textAlign:"center",fontFamily:"monospace !important",boxSizing:"border-box !important",$nest:{"&:not(:first-child)":qS.ScaleNestedProperty("margin-left",10),"&:focus":{outline:"none",border:"1px solid #ccc !important"}}},qS.ScaleProperty("border-radius",4),qS.ScaleProperty("font-size",35),qS.ScaleProperty("line-height",50),qS.ScaleProperty("padding-top",5),qS.ScaleProperty("width",50,!0),qS.ScaleProperty("height",50,!0)),l=qS.styler(wb.debugClassName("incorrect-pin-label"),{color:"#ff706a"},qS.FontLight,qS.ScalableMarginBottom(5),qS.ScalableFontSize(19),qS.ScalableLineHeight(24)),u=qS.styler({display:"flex",justifyContent:"flex-start"}),c=qS.styler({}),d=qS.styler(wb.debugClassName("pin-notes"),qS.ScalableMarginTop(20)),p=function(t){function e(e){var r=t.call(this,e)||this;return r.keyUpActions=[{shouldAct:function(e){return e===Y.KeyCode.DELETE||e===Y.KeyCode.BACKSPACE},act:function(e){var t=r.state.pinFieldIndex;0<t&&""===r.state.pinValues[t]&&(t-=1,r.setState({pinFieldIndex:t})),r.updatePinValueAtIndex("",t)}},{shouldAct:function(e){return r.keyCodeIsNumber(e)},act:function(e){var t=r.state.pinFieldIndex,n=e;n-=Y.KeyCode.START_OF_NUMBER<=e&&e<=Y.KeyCode.END_OF_NUMBER?Y.KeyCode.START_OF_NUMBER:Y.KeyCode.START_OF_NUMPAD,r.updatePinValueAtIndex(n.toString(),t,function(){t!==r.state.pinLength-1?r.setState({pinFieldIndex:t+1}):r.submitPIN()})}},{shouldAct:function(e){return e===Y.KeyCode.ESC},act:function(e){return r.onCancelPIN()}},{shouldAct:function(e){return e!==Y.KeyCode.TAB&&e!==Y.KeyCode.SHIFT},act:function(e){return r.updatePinValueAtIndex("",r.state.pinFieldIndex)}}],r.setFocus=function(){r.setState({pinFieldIndex:0}),r.forceUpdate()},r.onPINAccepted=function(){r.setState({showIncorrectMessage:!1}),r.clearPINFields()},r.onPINDeclined=function(){r.setState({showIncorrectMessage:!0}),r.clearPINFields()},r.onPINLengthChanged=function(e){r.state.pinLength!==e&&(r.clearPINFields(),r.setState({pinLength:e}))},r.onCancelPIN=function(){r.context.stores.lifecycle.onClose("MouseClick")},r.onKeyUp=function(e){var t=r.getKeyCode(e);r.shouldFallbackToOnChange(t)||r.actOnKeyCode(t)},r.onKeyDown=function(e){var t=r.getKeyCode(e);r.shouldFallbackToOnChange(t)||r.preventDefault(e)},r.onChange=function(e){if(e.target.value){var t=e.target.value.charCodeAt(0);r.actOnKeyCode(t)}},r.state={pinLength:0,pinFieldIndex:0,pinValues:[],showIncorrectMessage:!1},r}return n(e,t),e.prototype.componentDidMount=function(){this.setFocus(),this.onPINLengthChanged(this.context.stores.pin.getPINLength()),this.context.stores.pin.on("PINFocus",this.setFocus),this.context.stores.pin.on("PINAccepted",this.onPINAccepted),this.context.stores.pin.on("PINDeclined",this.onPINDeclined),this.context.stores.pin.on("PINLengthChanged",this.onPINLengthChanged),this.clearPINFields()},e.prototype.componentWillUnmount=function(){this.context.stores.pin.off("PINFocus",this.setFocus),this.context.stores.pin.off("PINAccepted",this.onPINAccepted),this.context.stores.pin.off("PINDeclined",this.onPINDeclined),this.context.stores.pin.off("PINLengthChanged",this.onPINLengthChanged)},e.prototype.render=function(){var e=this,t=this.context.stores.localization.getLocalization(),n=t.pinModal.incorrectPin.replace("{{resetPinUrl}}",this.context.amazonUrlCreator.createCSUrl("RESET_PIN")),r=t.pinModal.notes.replace("{{resetPinUrl}}",this.context.amazonUrlCreator.createCSUrl("RESET_PIN")).replace("{{avSettingsUrl}}",this.context.amazonUrlCreator.createCSUrl("AV_SETTINGS"));return Vn.createElement(wb.Modal,{className:i,useSmallPlayerModals:function(){return e.context.stores.uiConfigurations.useSmallPlayerUI()}},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},t.pinModal.title,Vn.createElement("div",{className:wb.ModalStyles.ClosePlayerClassName,onClick:this.onCancelPIN})),Vn.createElement("div",{className:u},Vn.createElement("div",{className:wb.ModalStyles.DescriptionClassName+" "+qS.ScrollableVertical},t.pinModal.description,Vn.createElement("div",{className:a},Vn.createElement("div",{className:c,dir:"ltr"},this.getPinElements(this.state.pinLength,this.state.pinFieldIndex))),this.state.showIncorrectMessage?Vn.createElement("div",{className:l,dangerouslySetInnerHTML:{__html:n}}):null,Vn.createElement("div",{className:wb.ModalStyles.NotesClassName+" "+d,dangerouslySetInnerHTML:{__html:r}}))))},e.prototype.getPinElements=function(e,t){for(var n=[],r=0;r<e;r++){var i={className:s,key:r,maxLength:1,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onChange:this.onChange,type:"text",value:F.isEmpty(this.state.pinValues[r])?"":"•"};r===t&&(i.ref=function(e){return e&&e.focus()}),n.push(Vn.createElement("input",o({},i)))}return n},e.prototype.keyCodeIsNumber=function(e){return e>=Y.KeyCode.START_OF_NUMBER&&e<=Y.KeyCode.END_OF_NUMBER||e>=Y.KeyCode.START_OF_NUMPAD&&e<=Y.KeyCode.END_OF_NUMPAD},e.prototype.preventDefault=function(e){xt.exists(e.preventDefault)?e.preventDefault():e.returnValue=!1},e.prototype.submitPIN=function(){var e=this.state.pinValues.join("");this.context.stores.pin.validatePIN(e)},e.prototype.updatePinValueAtIndex=function(e,t,n){var r=this.state.pinValues.slice(0);r.splice(t,1,e),this.setState({pinValues:r},n)},e.prototype.getKeyCode=function(e){return window.event?e.keyCode:e.which},e.prototype.shouldFallbackToOnChange=function(e){return!e||229===e},e.prototype.actOnKeyCode=function(e){for(var t=0,n=this.keyUpActions;t<n.length;t++){var r=n[t];if(r.shouldAct(e))return void r.act(e)}},e.prototype.clearPINFields=function(){for(var e=[],t=this.state.pinLength,n=0;n<t;n++)e.push("");this.setState({pinFieldIndex:0,pinValues:e})},e.contextType=QP.ReactContext,e}(Vn.PureComponent);t.PINModal=p});e(SM);SM.PINModal;var bM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=qS.styler({display:"flex",flexDirection:"column"}),l=qS.styler({textAlign:"right",$nest:n({"& > *:not(:first-child)":qS.ScaleNestedProperty("margin-left",10)},qS.RTLStyle({textAlign:"left",$nest:{"& > *:not(:first-child)":n({marginLeft:"auto"},qS.ScaleNestedProperty("margin-right",10))}}))},qS.ScalablePadding(10)),u=qS.styler({height:"100%",width:"100%"}),o=function(n){function e(e){var t=n.call(this,e)||this;return t.onUIConfigurationsUpdate=function(e){t.setState({uiConfigurations:e})},t.onClosePlayerClicked=function(){t.context.stores.lifecycle.onClose("MouseClick")},t.onContinueWaiting=function(){t.context.stores.modal.onCloseModal()},t.state={uiConfigurations:_w.GetDefaultUIConfigurations()},t}return i(e,n),e.prototype.componentDidMount=function(){this.onUIConfigurationsUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsUpdate)},e.prototype.render=function(){var e,t=this,n=this.context.stores.localization.getLocalization(),r=n.PlayerStuckError,i=r.description.replace(/\{\{contactUsUrl}}/g,this.context.amazonUrlCreator.createCSUrl("CONTACT_US")),o=function(){return t.context.stores.uiConfigurations.useSmallPlayerUI()},a=PS(s,((e={})[u]=F.isFunction(o)&&o(),e));return Vn.createElement(wb.Modal,{useSmallPlayerModals:o},Vn.createElement("div",{className:a},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},r.title,this.shouldShowClosePlayerButton()?Vn.createElement("div",{className:wb.ModalStyles.ClosePlayerClassName,onClick:this.onContinueWaiting}):null),Vn.createElement("div",{className:wb.ModalStyles.DescriptionClassName+" "+qS.ScrollableVertical,dangerouslySetInnerHTML:{__html:i}}),Vn.createElement("div",{className:wb.ModalStyles.FooterClassName+" "+l},this.shouldShowClosePlayerButton()?Vn.createElement(wb.Button,{onClick:this.onClosePlayerClicked},n.closePlayer):null,Vn.createElement(wb.Button,{onClick:this.onContinueWaiting},n.continueWaiting))))},e.prototype.shouldShowClosePlayerButton=function(){return this.state.uiConfigurations.playerCloseable},e.contextType=QP.ReactContext,e}(Vn.Component);t.PlayerStuckModal=o});e(bM);bM.PlayerStuckModal;var TM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({display:"flex",flexDirection:"column"}),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onCloseClicked=function(){e.context.stores.modal.onCloseModal()},e}return n(e,t),e.prototype.render=function(){var e,t=this,n=function(){return t.context.stores.uiConfigurations.useSmallPlayerUI()},r=PS(i,((e={})[gM.FullParentSizeClassName]=n(),e));return Vn.createElement(wb.Modal,{useSmallPlayerModals:n},Vn.createElement("div",{className:r},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},Vn.createElement("div",{className:wb.ModalStyles.ClosePlayerClassName,onClick:this.onCloseClicked})),Vn.createElement(tM.SubtitlesAndAudioMenu,{isInsideModal:!0})))},e.contextType=QP.ReactContext,e}(Vn.Component);t.SubtitlesAndAudioModal=o});e(TM);TM.SubtitlesAndAudioModal;var PM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({display:"flex",flexDirection:"column"}),a=qS.styler({textAlign:"center"},qS.ScalablePadding(10)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onUIConfigurationsUpdate=function(e){t.setState({uiConfigurations:e})},t.onCloseClicked=function(){t.context.stores.modal.onCloseModal()},t.state={uiConfigurations:_w.GetDefaultUIConfigurations()},t}return i(e,n),e.prototype.componentDidMount=function(){this.onUIConfigurationsUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsUpdate)},e.prototype.render=function(){var e=this,t=this.context.stores.localization.getLocalization(),n=function(){return e.context.stores.uiConfigurations.useSmallPlayerUI()},r=PS(o,{fullParentSize:F.isFunction(n)&&n()});return Vn.createElement(wb.Modal,{useSmallPlayerModals:n},Vn.createElement("div",{className:r},Vn.createElement("div",{className:wb.ModalStyles.TitleClassName},t.videoQuality),Vn.createElement("div",{className:wb.ModalStyles.DescriptionClassName+" "+qS.ScrollableVertical},t.videoQualityLearnMoreMessage),Vn.createElement("div",{className:wb.ModalStyles.FooterClassName+" "+a},Vn.createElement(wb.Button,{onClick:this.onCloseClicked},t.close))))},e.contextType=QP.ReactContext,e}(Vn.Component);t.VideoQualityLearnMoreModal=n});e(PM);PM.VideoQualityLearnMoreModal;var wM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.onModalInfoUpdate=function(e){t.setState({modalInfo:e})},t.onUiStatusUpdate=function(e){t.setState({state:e.state})},t.state={modalInfo:null,state:$P.UIPlaybackState.Stopped},t}return i(e,n),e.prototype.componentDidMount=function(){this.onModalInfoUpdate(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalInfoUpdate),this.onUiStatusUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUiStatusUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.modal.offUpdate(this.onModalInfoUpdate),this.context.stores.uiStatus.offUpdate(this.onUiStatusUpdate)},e.prototype.shouldComponentUpdate=function(e,t){return this.state.modalInfo!==t.modalInfo&&(null===this.state.modalInfo||null===t.modalInfo)||null!=this.state.modalInfo&&null!=t.modalInfo&&this.state.modalInfo.modal!==t.modalInfo.modal||t.state===$P.UIPlaybackState.Error},e.prototype.render=function(){var e=this.context.stores.localization.getLocalization();if(F.isEmpty(e))return null;if(this.state.state===$P.UIPlaybackState.Error)return Vn.createElement(mM.ErrorModal,null);if(null==this.state.modalInfo)return null;switch(this.state.modalInfo.modal){case xP.Modal.Captions:return Vn.createElement(fM.CaptionsModal,null);case xP.Modal.ContentWarning:var t=e.ContentWarning.description.replace("{{pin}}",this.context.amazonUrlCreator.createCSUrl("PIN_SETUP"));return Vn.createElement(hM.ContentWarningModal,{text:t});case xP.Modal.Diagnostics:case xP.Modal.Disclaimer:return null;case xP.Modal.HDCPInfo:return Vn.createElement(yM.HDCPInfoModal,null);case xP.Modal.Options:return Vn.createElement(vM.OptionsModal,null);case xP.Modal.PIN:return Vn.createElement(SM.PINModal,null);case xP.Modal.PlayerStuck:return Vn.createElement(bM.PlayerStuckModal,null);case xP.Modal.SubtitlesAndAudio:return Vn.createElement(TM.SubtitlesAndAudioModal,null);case xP.Modal.VideoQualityLearnMore:return Vn.createElement(PM.VideoQualityLearnMoreModal,null);default:return null}},e.contextType=QP.ReactContext,e}(Vn.Component);t.ModalGroup=n});e(wM);wM.ModalGroup;var CM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({textAlign:"center",overflow:"hidden",opacity:1},qS.ScalableMarginTop(34)),n=qS.styler({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",margin:"auto"}),a=qS.styler(wb.debugClassName("title-text"),{fontWeight:"normal"},qS.ScalableFontSize(24),n),s=qS.styler(wb.debugClassName("subtitle-text"),{fontWeight:"lighter"},qS.ScalableFontSize(21),qS.ScalablePaddingTop(3),n),l=function(n){function e(e){var t=n.call(this,e)||this;return t.titleRef=null,t.onTitleInfoStoreUpdate=function(e){t.setState({contentTitle:e.title,episodeNumber:e.episodeNumber,seasonNumber:e.seasonNumber,seriesTitle:e.seriesTitle,isTrailer:e.contentType===_P.ContentType.Trailer})},t.titleRef=Vn.createRef(),t.state={contentTitle:null,episodeNumber:null,isTrailer:!1,seasonNumber:null,seriesTitle:null},t}return i(e,n),e.prototype.componentDidMount=function(){this.onTitleInfoStoreUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoStoreUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.title.offUpdate(this.onTitleInfoStoreUpdate)},e.prototype.hasEpisodeData=function(){return xt.exists(this.state.episodeNumber)&&xt.exists(this.state.seasonNumber)},e.prototype.getEpisodeString=function(){var e=this.context.stores.localization.getLocalization(),t={seasonNumber:this.state.seasonNumber,episodeNumber:this.state.episodeNumber};return this.context.stores.localization.mapReplace(e.episodeLong,t)},e.prototype.render=function(){if(this.state.isTrailer)return null;var e=this.hasEpisodeData(),t=xt.exists(this.state.seriesTitle);return Vn.createElement("div",{className:o,ref:this.titleRef,tabIndex:0},Vn.createElement("h1",{className:a},t?this.state.seriesTitle:this.state.contentTitle),Vn.createElement("h2",{className:s},e?this.getEpisodeString():null,e&&t?" ":null,t?this.state.contentTitle:null))},e.contextType=QP.ReactContext,e}(Vn.Component);t.TopTitle=l});e(CM);CM.TopTitle;var MM=t(function(e,t){var r,n,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var P=qS.styler({display:"flex",alignItems:"center",flexDirection:"column","-webkit-tap-highlight-color":"transparent"},Vw.Overlay,Vw.EnablePointerEvents),w=qS.styler({flex:"1 1",perspective:"400px"},qS.ScalableMarginTop(-70)),a=qS.styler({position:"relative",shapeRendering:"crispEdges",float:"left",opacity:.25},qS.ScalableWidth(50),qS.ScalableHeight(50)),s=qS.styler({display:"inline-block"},qS.BreakpointSizes("margin",{0:"0 20",1200:"0 90"})),l=qS.styler({borderStyle:"solid",borderColor:"transparent"},qS.ScaleProperty("border-width",10)),u=qS.styler({$nest:{"&.hide":{opacity:0}}}),C=qS.styler({$nest:{"&:hover:not(.hide)":{opacity:.75}}}),M=qS.styler({opacity:.25,$nest:{"&:not(:hover)":{visibility:"hidden"}}}),c=qS.styler({alignItems:"center",fontWeight:"normal"},qS.ScalableFontSize(19)),I=qS.styler({textAlign:"center",display:"block",marginLeft:"auto",$nest:o({},qS.RTLStyle(o({textAlign:"center",marginRight:"auto",paddingRight:"0px"},qS.ScaleNestedProperty("padding-left",10))))},c,qS.ScalablePaddingLeft(10),qS.ScalableMarginTop(16),qS.ScalableHeight(20),qS.ScalableWidth(49)),E=qS.styler(a,l,u,C,c),_=qS.styler(a,l,u,C,c),x=qS.styler({display:"inline-block",position:"relative",$nest:(n={},n["&:hover:not(.hide) ."+M]={opacity:.75},n)}),k=qS.styler({visibility:"visible"}),d=Vd.keyframes({"0%":{opacity:0,transform:"translateZ(-100px)"},"50%":{opacity:.75},"100%":{opacity:0,transform:"translateZ(100px)"}}),R=qS.styler({overflow:"hidden",flex:"1 1",opacity:1,transition:"opacity 150ms ease-in",$nest:{"&.hide":{opacity:0}}},Uw.HideWhenPlayerSmall,qS.ScalableMaxWidth(480)),A=qS.styler({opacity:0,animation:d+" 0.45s ease-out"},a,s),O=qS.styler(a,s,l,u),p={fastSeekEnabled:!0,pauseEnabled:!0,seekBackwardEnabled:!0,seekForwardEnabled:!0},f=function(t){function e(e){var c=t.call(this,e)||this;return c.pointerEventsSupported=xt.exists(window.PointerEvent),c.aggregatedSeekIntervalMs=0,c.fastSeekBackRef=null,c.fastSeekForwardRef=null,c.hideOnTouchEnd=!0,c.lock=null,c.pausedOverlayRef=null,c.pausePlayRef=null,c.touched=!1,c.canPause=function(){return(c.state.state===$P.UIPlaybackState.Buffering||c.state.state===$P.UIPlaybackState.Loading||c.state.state===$P.UIPlaybackState.Playing)&&!c.state.isModalShowing},c.canPlay=function(){return!(c.state.state!==$P.UIPlaybackState.Buffering&&c.state.state!==$P.UIPlaybackState.Loading&&c.state.state!==$P.UIPlaybackState.Paused||c.state.isModalShowing||c.state.errorModalShowing)},c.unlockUI=function(){c.lock.unlock()},c.setHideUITimeout=function(e,t){(void 0===e&&(e=!1),c.state.uiConfigurations.alwaysDisplayPausedOverlay)?(xt.exists(t)?t!==$P.UIPlaybackState.Paused:c.state.state!==$P.UIPlaybackState.Paused)&&c.lock.lock(e?wb.UITimeoutMS.Touch:wb.UITimeoutMS.Standard):c.lock.lock(e?wb.UITimeoutMS.Touch:wb.UITimeoutMS.Standard)},c.shouldPerformOverlayTouchAction=function(e){var t=Ce.HTMLElementUtils.clickedInElement(c.fastSeekBackRef,e),n=Ce.HTMLElementUtils.clickedInElement(c.fastSeekForwardRef,e),r=Ce.HTMLElementUtils.clickedInElement(c.pausePlayRef,e);return!(c.state.playbackControlsPolicy.seekBackwardEnabled&&t||c.state.playbackControlsPolicy.seekForwardEnabled&&n||c.state.playbackControlsPolicy.pauseEnabled&&r)},c.overlayOnPointerUp=function(e){if("touch"===e.pointerType)return c.shouldPerformOverlayTouchAction(e)&&(c.state.uiConfigurations.alwaysDisplayPausedOverlay&&c.state.state===$P.UIPlaybackState.Paused?c.setHideUITimeout(!0):c.hideOnTouchEnd?c.unlockUI():c.setHideUITimeout(!0)),void(c.touched=!0);c.touched?c.touched=!1:c.onOverlayClicked(e,e)},c.overlayOnTouchEnd=function(e){if(xt.exists(e.changedTouches)){var t=e.changedTouches[0];c.shouldPerformOverlayTouchAction(t)&&(c.state.uiConfigurations.alwaysDisplayPausedOverlay&&c.state.state===$P.UIPlaybackState.Paused?c.setHideUITimeout(!0):c.hideOnTouchEnd?c.unlockUI():c.setHideUITimeout(!0)),c.touched=!0}else c.touched&&(c.touched=!1)},c.overlayOnClick=function(e){c.onOverlayClicked(e,e)},c.pausePlayOnPointerUp=function(e){"touch"===e.pointerType&&(c.touched=!0),c.onPausePlayInteraction(e)},c.pointerEventTouchLock=function(e){"touch"===e.pointerType&&c.touchLock(e)},c.touchLock=function(e){c.lock.lock(),c.hideOnTouchEnd=!c.hideOnTouchEnd},c.onOverlayClicked=function(e,t){if(e.preventDefault(),!c.state.isPrePlayback)if(c.touched)c.touched=!1;else{var n=c.state.playbackControlsPolicy.pauseEnabled,r=c.state.userActive,i=c.state.playbackControlsPolicy.fastSeekEnabled,o=c.state.playbackControlsPolicy.seekForwardEnabled,a=c.state.playbackControlsPolicy.seekBackwardEnabled,s=null!=t&&o&&i&&Ce.HTMLElementUtils.clickedInElement(c.fastSeekForwardRef,t),l=null!=t&&a&&i&&Ce.HTMLElementUtils.clickedInElement(c.fastSeekBackRef,t),u=n&&(!r||!(s||l));u&&c.canPlay()?(c.state.uiConfigurations.alwaysDisplayPausedOverlay&&c.unlockUI(),c.context.stores.playback.play()):u&&c.canPause()&&c.state.playbackControlsPolicy.pauseEnabled?(c.state.uiConfigurations.alwaysDisplayPausedOverlay&&c.lock.lock(),c.context.stores.playback.pause()):c.state.isModalShowing&&c.context.stores.modal.onCloseModal()}},c.onPausePlayKeyDown=function(e){"Enter"===e.key&&c.onPausePlayInteraction(e)},c.onPausePlayInteraction=function(e){e.preventDefault(),e.stopPropagation();var t,n=c.state.playbackControlsPolicy.pauseEnabled;c.canPlay()&&n?(t=$P.UIPlaybackState.Playing,c.context.stores.playback.play()):c.canPause()&&n?(t=$P.UIPlaybackState.Paused,c.context.stores.playback.pause()):c.state.isModalShowing&&c.context.stores.modal.onCloseModal(),c.setHideUITimeout(!0,t)},c.fastSeekBackOnPointerUp=function(e){"touch"===e.pointerType&&(c.touched=!0),c.onFastSeekBackInteraction(e)},c.fastSeekForwardOnPointerUp=function(e){"touch"===e.pointerType&&(c.touched=!0),c.onFastSeekForwardInteraction(e)},c.onFastSeekBackKeyDown=function(e){"Enter"===e.key&&c.onFastSeekBackInteraction(e)},c.onFastSeekBackInteraction=function(e){if(c.state.playbackControlsPolicy.fastSeekEnabled&&c.state.playbackControlsPolicy.seekBackwardEnabled){e.preventDefault(),e.stopPropagation(),c.setHideUITimeout(),c.aggregatedSeekIntervalMs-=1e4;var t=Math.max(c.state.earliestPlayablePositionMs,Math.max(0,c.state.positionMs+c.aggregatedSeekIntervalMs));c.context.stores.playback.seek(t)}},c.onFastSeekForwardKeyDown=function(e){"Enter"===e.key&&c.onFastSeekForwardInteraction(e)},c.onFastSeekForwardInteraction=function(e){if(c.state.playbackControlsPolicy.fastSeekEnabled&&c.state.playbackControlsPolicy.seekForwardEnabled){e.preventDefault(),e.stopPropagation(),c.setHideUITimeout(),c.aggregatedSeekIntervalMs+=1e4;var t=Math.min(c.state.lastPlayablePositionMs,c.state.positionMs+c.aggregatedSeekIntervalMs);c.context.stores.playback.seek(t)}},c.onLockStatusUpdate=function(e){e||(c.hideOnTouchEnd=!0)},c.shouldShowAnimatedPauseIcon=function(){return c.state.animatePauseIcon&&!c.state.userActive},c.onAdPlaybackStoreUpdate=function(e){null!==e&&c.setState(c.getStateFromAdPlaybackInfo(e))},c.onTimelineInfoStoreUpdate=function(e){c.aggregatedSeekIntervalMs=0,c.setState(c.getStateFromTimelineInfo(e))},c.onKeyInputStoreUpdate=function(){c.setHideUITimeout(!0)},c.onTitleInfoStoreUpdate=function(e){c.setState(c.getStateFromTitleInfo(e))},c.onUIConfigurationsUpdate=function(e){c.setState({uiConfigurations:e})},c.onUIStatusStoreUpdate=function(e){c.setState(c.getStateFromUIStatus(e),function(){return c.calculateAnimatePauseIconState()})},c.onPlaybackControlsPolicyUpdate=function(e){c.setState({playbackControlsPolicy:e})},c.onModalStoreUpdate=function(e){c.setState(c.getStateFromModal(e))},c.onPlaybackStateChange=function(e){e===Gd.PlaybackState.Paused?c.onUserPause():e===Gd.PlaybackState.Playing&&c.onUserPlay()},c.onXrayHighlightStoreUpdate=function(e){c.setState({hideUI:e})},c.onScalingChange=function(e){c.setState({scaleDown:e})},c.calculateAnimatePauseIconState=function(){c.state.userActive&&c.state.animatePauseIcon&&c.setState({animatePauseIcon:!1})},c.onErrorStoreUpdate=function(e){c.setState({errorModalShowing:null!=e})},c.state={adType:null,animatePauseIcon:!1,contentTitle:null,contentType:_P.ContentType.VOD,earliestPlayablePositionMs:null,errorModalShowing:!1,isModalShowing:!1,isPrePlayback:!1,keyboardFocused:!1,lastPlayablePositionMs:null,playbackControlsPolicy:p,positionMs:null,seriesTitle:null,scaleDown:!1,state:$P.UIPlaybackState.Stopped,uiConfigurations:_w.GetDefaultUIConfigurations(),userActive:!0,hideUI:!1},c}return i(e,t),e.prototype.componentWillReceiveProps=function(e){this.calculateAnimatePauseIconState()},e.prototype.componentDidMount=function(){this.lock=this.context.stores.lock.newLock(),this.onAdPlaybackStoreUpdate(this.context.stores.adPlayback.getAdPlaybackInfo()),this.context.stores.adPlayback.onAdPlaybackInfoChange(this.onAdPlaybackStoreUpdate),this.onUIConfigurationsUpdate(this.context.stores.uiConfigurations.getUIConfigurations()),this.context.stores.uiConfigurations.onUpdate(this.onUIConfigurationsUpdate),this.onModalStoreUpdate(this.context.stores.modal.getModalInfo()),this.context.stores.modal.onUpdate(this.onModalStoreUpdate),this.onPlaybackControlsPolicyUpdate(this.context.stores.playbackControlsPolicy.getPolicy()),this.context.stores.playbackControlsPolicy.onPolicyChange(this.onPlaybackControlsPolicyUpdate),this.onTimelineInfoStoreUpdate(this.context.stores.timeline.getTimelineInfo()),this.context.stores.timeline.onUpdate(this.onTimelineInfoStoreUpdate),this.onTitleInfoStoreUpdate(this.context.stores.title.getTitleInfo()),this.context.stores.title.onUpdate(this.onTitleInfoStoreUpdate),this.onUIStatusStoreUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.context.stores.lock.onChange(this.onLockStatusUpdate),this.context.stores.playback.onPlaybackStateChange(this.onPlaybackStateChange),this.onErrorStoreUpdate(this.context.stores.error.getCurrentError()),this.context.stores.error.onError(this.onErrorStoreUpdate),this.context.stores.xrayHighlightModeStore.onHighlightInfoChange(this.onXrayHighlightStoreUpdate),this.context.stores.keyInput.onUpdate(this.onKeyInputStoreUpdate),this.context.stores.playerScaling.onScalingChange(this.onScalingChange)},e.prototype.componentWillUnmount=function(){this.lock.unlock(),this.context.stores.adPlayback.offAdPlaybackInfoChange(this.onAdPlaybackStoreUpdate),this.context.stores.keyInput.offUpdate(this.onKeyInputStoreUpdate),this.context.stores.modal.offUpdate(this.onModalStoreUpdate),this.context.stores.lock.offChange(this.onLockStatusUpdate),this.context.stores.playback.offPlaybackStateChange(this.onPlaybackStateChange),this.context.stores.playbackControlsPolicy.offPolicyChange(this.onPlaybackControlsPolicyUpdate),this.context.stores.timeline.offUpdate(this.onTimelineInfoStoreUpdate),this.context.stores.title.offUpdate(this.onTitleInfoStoreUpdate),this.context.stores.uiConfigurations.offUpdate(this.onUIConfigurationsUpdate),this.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.context.stores.error.offError(this.onErrorStoreUpdate),this.context.stores.xrayHighlightModeStore.offHighlightInfoChange(this.onXrayHighlightStoreUpdate),this.context.stores.playerScaling.offScalingChange(this.onScalingChange)},e.prototype.render=function(){var e,t,n=this;if(this.state.hideUI)return null;var r=PS(E,wb.debugClassName("fastseekback-button"),{hide:!this.state.playbackControlsPolicy.seekBackwardEnabled||!this.state.playbackControlsPolicy.fastSeekEnabled||!this.state.userActive}),i=PS(_,wb.debugClassName("fastseekforward-button"),{hide:!this.state.playbackControlsPolicy.seekForwardEnabled||!this.state.playbackControlsPolicy.fastSeekEnabled||!this.state.userActive}),o=PS(((e={})[k]=this.state.playbackControlsPolicy.fastSeekEnabled&&this.state.userActive,e)),a=this.state.playbackControlsPolicy.pauseEnabled,s=Ww.SVG.Pause,l=Ww.SVG.Play;this.state.userActive&&(s=a?Ww.SVG.Play:Ww.SVG.Pause,l=a?Ww.SVG.Pause:Ww.SVG.Play);var u=this.state.state===$P.UIPlaybackState.Paused?s:l,c=PS(O,wb.debugClassName("playpause-button"),((t={})[C]=a,t[A]=this.shouldShowAnimatedPauseIcon(),t.hide=!this.state.userActive&&!this.shouldShowAnimatedPauseIcon()||!a&&this.state.state!==$P.UIPlaybackState.Paused||this.state.state===$P.UIPlaybackState.Buffering,t)),d=u===s?"Play":"Pause",p={display:this.state.state!==$P.UIPlaybackState.Loading&&this.state.state!==$P.UIPlaybackState.Error&&this.state.state!==$P.UIPlaybackState.Stopped&&!this.state.isPrePlayback||this.state.isModalShowing&&this.state.playbackControlsPolicy.pauseEnabled?"":"none"},f={cursor:this.state.userActive?"pointer":"none"},h=this.state.state!==$P.UIPlaybackState.Error&&this.state.state!==$P.UIPlaybackState.Stopped&&!this.state.isModalShowing&&this.state.userActive&&!this.state.scaleDown||this.state.state===$P.UIPlaybackState.Loading||this.state.isPrePlayback&&this.state.state!==$P.UIPlaybackState.Error,m=!this.state.uiConfigurations.enableMainTitleDuringDraper&&this.state.contentType===_P.ContentType.Ad&&null!==this.state.adType&&this.state.adType===yP.AdType.Draper,y=null==this.state.contentTitle&&null==this.state.seriesTitle,g=PS(R,{hide:!h||m||y}),v={onPointerDown:this.pointerEventsSupported?this.pointerEventTouchLock:null,onPointerUp:this.pointerEventsSupported?this.overlayOnPointerUp:null,onTouchStart:this.pointerEventsSupported?null:this.touchLock,onTouchEnd:this.pointerEventsSupported?null:this.overlayOnTouchEnd,onClick:this.pointerEventsSupported?null:this.overlayOnClick},S={onPointerDown:this.pointerEventsSupported?this.pointerEventTouchLock:null,onPointerUp:this.pointerEventsSupported?this.pausePlayOnPointerUp:null,onTouchStart:this.pointerEventsSupported?null:this.touchLock,onTouchEnd:this.pointerEventsSupported?null:this.onPausePlayInteraction},b={onPointerDown:this.pointerEventsSupported?this.pointerEventTouchLock:null,onPointerUp:this.pointerEventsSupported?this.fastSeekBackOnPointerUp:null,onTouchStart:this.pointerEventsSupported?null:this.touchLock,onTouchEnd:this.pointerEventsSupported?null:this.onFastSeekBackInteraction,onClick:this.pointerEventsSupported?null:this.onFastSeekBackInteraction},T={onPointerDown:this.pointerEventsSupported?this.pointerEventTouchLock:null,onPointerUp:this.pointerEventsSupported?this.fastSeekForwardOnPointerUp:null,onTouchStart:this.pointerEventsSupported?null:this.touchLock,onTouchEnd:this.pointerEventsSupported?null:this.onFastSeekForwardInteraction,onClick:this.pointerEventsSupported?null:this.onFastSeekForwardInteraction};return Vn.createElement("div",{className:P,ref:function(e){n.pausedOverlayRef=e;
      if (e) {
        triggerEvent(e, 'page-elements', { name: 'pausedOverlay' })
      };},style:f,onPointerDown:v.onPointerDown,onPointerUp:v.onPointerUp,onTouchStart:v.onTouchStart,onTouchEnd:v.onTouchEnd,onClick:v.onClick},Vn.createElement("div",{className:g},Vn.createElement(CM.TopTitle,null)),Vn.createElement("div",{className:w,style:p,dir:"ltr"},Vn.createElement("div",{className:x,ref:function(e){n.fastSeekBackRef=e;
      if (e) {
        triggerEvent(e, 'page-elements', { name: 'fastSeekBack' })
      };}},Vn.createElement(wb.ImageButton,{className:r,ariaLabel:"Seek Back 10 seconds",tooltipClassName:I,tooltipWrapperClassName:M,onPointerDown:b.onPointerDown,onPointerUp:b.onPointerUp,onTouchStart:b.onTouchStart,onTouchEnd:b.onTouchEnd,onClick:b.onClick,onKeyDown:this.onFastSeekBackKeyDown,src:Ww.SVG.Back10s},Vn.createElement("div",{className:o},10))),Vn.createElement("div",{className:x,ref:function(e){n.pausePlayRef=e;
      if (e) {
        triggerEvent(e, 'page-elements', { name: 'playPauseBtn' })
      };}},Vn.createElement(wb.ImageButton,{className:c,ariaLabel:d,onPointerDown:S.onPointerDown,onPointerUp:S.onPointerUp,onTouchStart:S.onTouchStart,onTouchEnd:S.onTouchEnd,onKeyDown:this.onPausePlayKeyDown,src:u})),Vn.createElement("div",{className:x,ref:function(e){n.fastSeekForwardRef=e;
      if (e) {
        triggerEvent(e, 'page-elements', { name: 'fastSeekForward' })
      };}},Vn.createElement(wb.ImageButton,{className:i,ariaLabel:"Seek Forward 10 seconds",tooltipClassName:I,tooltipWrapperClassName:M,onPointerDown:T.onPointerDown,onPointerUp:T.onPointerUp,onTouchStart:T.onTouchStart,onTouchEnd:T.onTouchEnd,onClick:T.onClick,onKeyDown:this.onFastSeekForwardKeyDown,src:Ww.SVG.Forward10s},Vn.createElement("div",{className:o},10)))))},e.prototype.getStateFromAdPlaybackInfo=function(e){return{adType:e.adType}},e.prototype.getStateFromTimelineInfo=function(e){return{earliestPlayablePositionMs:e.earliestPlayablePositionMs,lastPlayablePositionMs:e.lastPlayablePositionMs,positionMs:e.positionMs}},e.prototype.getStateFromTitleInfo=function(e){return{contentTitle:e.title,contentType:e.contentType,seriesTitle:e.seriesTitle}},e.prototype.getStateFromUIStatus=function(e){return{state:e.state,userActive:e.userActive}},e.prototype.getStateFromModal=function(e){return{isPrePlayback:null!=e&&e.isPrePlayback,isModalShowing:null!=e}},e.prototype.onUserPause=function(){this.state.userActive||this.setState({animatePauseIcon:!0})},e.prototype.onUserPlay=function(){this.setState({animatePauseIcon:!1})},e.contextType=QP.ReactContext,e}(Vn.Component);t.PausedOverlay=f});e(MM);MM.PausedOverlay;var IM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=qS.styler({position:"relative",shapeRendering:"crispEdges"},qS.ScalableWidth(80),qS.ScalableHeight(80)),o=qS.styler({display:"block",margin:"auto"}),a=qS.styler({display:"block"},qS.ScalableFontSize(19)),s=qS.styler({display:"flex",alignItems:"center",flexDirection:"column"},Vw.Overlay),l=qS.styler({overflow:"hidden",flex:"1 1",opacity:1,transition:"opacity 150ms ease-in"},Uw.HideWhenPlayerSmall,qS.ScalableMaxWidth(480)),u=qS.styler({perspective:"400px",flex:"1 1"},qS.ScalableMarginTop(-70)),c=qS.styler({borderStyle:"solid",borderColor:"transparent"},qS.ScaleProperty("border-width",10)),d=qS.styler({$nest:{"&.hide":{opacity:0}}}),p=qS.styler({textAlign:"center",display:"inline-block",position:"relative",opacity:.5}),f=qS.styler(n,o,c,d),h=function(n){function e(e){var t=n.call(this,e)||this;return t.onUiDisplayStatusChange=function(e){t.setState({isUIShowing:e})},t.onPictureInPictureUpdate=function(e){t.setState({isPictureInPicture:e})},t.state={isPictureInPicture:!1,isUIShowing:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.context.stores.uiDisplayStatus.onDisplayStatusChange(this.onUiDisplayStatusChange),this.context.stores.pictureInPicture.onChange(this.onPictureInPictureUpdate)},e.prototype.componentWillUnmount=function(){this.context.stores.uiDisplayStatus.offDisplayStatusChange(this.onUiDisplayStatusChange),this.context.stores.pictureInPicture.offChange(this.onPictureInPictureUpdate)},e.prototype.render=function(){if(!this.shouldShow())return null;var e=this.context.stores.localization.getLocalization(),t=PS(f,{hide:this.state.isUIShowing});return Vn.createElement("div",{className:s},Vn.createElement("div",{className:l},this.state.isUIShowing?null:Vn.createElement(CM.TopTitle,null)),Vn.createElement("div",{className:u},Vn.createElement("div",{className:p},Vn.createElement(wb.SVGImage,{className:t,src:Ww.SVG.PictureInPicture}),Vn.createElement("span",{className:a},e.playingPictureInPicture))))},e.prototype.shouldShow=function(){return this.state.isPictureInPicture},e.contextType=QP.ReactContext,e}(Vn.Component);t.PictureInPictureOverlay=h});e(IM);IM.PictureInPictureOverlay;var EM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=qS.styler(wb.debugClassName("player-container"),{position:"relative",width:"100%",height:"100%",color:"#f2f4f6",fontFamily:"ATVWebPlayerSDK Amazon Ember, Helvetica, sans-serif",display:"block",alignItems:"center",userSelect:"none",$nest:{"& a":{color:qS.LinkColor,textDecoration:"none",$nest:{"&:hover":{color:qS.LinkHoverColor}}},"& *":{touchAction:"pan-y",boxSizing:"content-box"}}}),o={$nest:{"&:focus, &:focus-within":{outline:"-webkit-focus-ring-color auto 1px"}}},a={$nest:{"&:focus, &:focus-within":{outline:"none"}}},u=qS.styler({$nest:{"& button:not([disabled])":o,"& input[type=range]:not([disabled])":o,"& [tabIndex]:not([tabindex='-1'])":o}}),c=qS.styler({$nest:{"& button:not([disabled])":a,"& input[type=range]:not([disabled])":a,"& [tabIndex]:not([tabindex='-1'])":a}}),d=qS.styler({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),p=qS.styler({width:"100%",height:"0",transition:"height 0.2s linear"}),f=qS.styler({height:"65px"}),h=qS.styler({display:"flex",flexGrow:1,flexBasis:0}),m=qS.styler(wb.debugClassName("overlays-container"),{outline:"none",position:"relative",width:"100%",height:"100%",maxHeight:"100%",transition:"width 0.2s linear, height 0.2s linear"}),y=qS.styler({cursor:"none"}),g=qS.styler({maxHeight:"calc(100% - 65px)",height:"40.43vw",$nest:{"@media (max-width:1280px)":{width:"calc(100% - 360px)"},"@media (min-width:1281px)":{width:"calc(100% - 28.125vw)"}}}),v=qS.styler({flexGrow:1}),S=qS.styler({position:"absolute",width:"100%",height:"100%",pointerEvents:"none",top:0}),i=function(t){function e(e){var i=t.call(this,e)||this;return i.overlaysContainerRef=null,i.webPlayerRef=null,i.lock=null,i.mouseMoveIsFromTouchPointer=!1,i.onFullscreenChange=function(e){i.setState({isFullscreen:e})},i.onPictureInPictureChange=function(e){i.setState({isPictureInPicture:e})},i.onPassiveViewingChange=function(e){i.setState({passiveViewingEnabled:e})},i.onScalingChange=function(e){i.setState({scaleDown:e})},i.onUiConfigurationsUpdate=function(e){i.setState({enableXray:e.enableXray})},i.onUIStatusStoreUpdate=function(e){i.setState({userActive:e.userActive})},i.onLanguageChange=function(e){i.setState({xrayLocalizationReady:!F.isEmpty(e)})},i.onKeyInputStoreUpdate=function(e){i.setState({keyboardFocused:e.keyboardFocus}),i.onFocusChange()},i.onFocusChange=function(){var n=qS.styler(o),r=qS.styler(a);document.querySelectorAll('input[type="checkbox"]:not([disabled])').forEach(function(e){var t=e.parentElement;i.state.keyboardFocused?i.addFocusRing(t,n,r):i.removeFocusRing(t,n,r)})},i.onPointerMove=function(e){e instanceof PointerEvent&&"touch"===e.pointerType&&(i.mouseMoveIsFromTouchPointer=!0)},i.onMouseMove=function(e){var t=e.nativeEvent;i.mouseMoveIsFromTouchPointer||0===t.movementX&&0===t.movementY?i.mouseMoveIsFromTouchPointer=!1:i.lock.lock(wb.UITimeoutMS.Standard)},i.onTouchStart=function(e){i.onPlayerTouched()},i.onPointerDown=function(e){"touch"===e.pointerType&&i.onPlayerTouched()},i.state={enableXray:!0,isFullscreen:!1,isPictureInPicture:!1,keyboardFocused:!1,pictureInPictureWeblab:Y.WeblabTreatment.C,passiveViewingEnabled:!1,scaleDown:!1,userActive:!1,xrayLocalizationReady:!1},i}return n(e,t),e.prototype.componentDidMount=function(){this.lock=this.props.context.stores.lock.newLock(),this.onFullscreenChange(this.props.context.stores.fullscreen.isFullscreen()),this.props.context.stores.fullscreen.onFullscreenStateChange(this.onFullscreenChange),this.props.context.stores.pictureInPicture.onChange(this.onPictureInPictureChange),this.onPassiveViewingChange(this.props.context.stores.passiveViewing.isPassiveViewingEnabled()),this.props.context.stores.passiveViewing.onChange(this.onPassiveViewingChange),this.props.context.stores.playerScaling.onScalingChange(this.onScalingChange),this.onUiConfigurationsUpdate(this.props.context.stores.uiConfigurations.getUIConfigurations()),this.props.context.stores.uiConfigurations.onUpdate(this.onUiConfigurationsUpdate),this.onUIStatusStoreUpdate(this.props.context.stores.uiStatus.getUserInterfaceStatus()),this.props.context.stores.uiStatus.onUpdate(this.onUIStatusStoreUpdate),this.onLanguageChange(this.props.context.stores.localization.getCurrentLanguage()),this.props.context.stores.localization.onLanguageChanged(this.onLanguageChange),this.onKeyInputStoreUpdate(this.props.context.stores.keyInput.getKeyInputInfo()),this.props.context.stores.keyInput.onUpdate(this.onKeyInputStoreUpdate),this.props.context.stores.uiConfigurations.setFullPlayerSizeElement(Ld.findDOMNode(this.overlaysContainerRef)),this.setState({pictureInPictureWeblab:this.props.context.weblabs[ct.Weblabs.HTML5_PICTUREINPICTURE]});var e=Ld.findDOMNode(this.webPlayerRef);e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("touchstart",this.onTouchStart)},e.prototype.componentWillUnmount=function(){this.props.context.stores.lock.deleteLock(this.lock),this.props.context.stores.uiConfigurations.setFullPlayerSizeElement(null),this.props.context.stores.fullscreen.offFullscreenStateChange(this.onFullscreenChange),this.props.context.stores.pictureInPicture.offChange(this.onPictureInPictureChange),this.props.context.stores.passiveViewing.offChange(this.onPassiveViewingChange),this.props.context.stores.playerScaling.offScalingChange(this.onScalingChange),this.props.context.stores.uiConfigurations.offUpdate(this.onUiConfigurationsUpdate),this.props.context.stores.uiStatus.offUpdate(this.onUIStatusStoreUpdate),this.props.context.stores.keyInput.offUpdate(this.onKeyInputStoreUpdate);var e=Ld.findDOMNode(this.webPlayerRef);e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("touchstart",this.onTouchStart)},e.prototype.render=function(){var e,t,n,r=this,i=this.state.enableXray&&!this.state.passiveViewingEnabled&&this.state.xrayLocalizationReady,o=PS(p,((e={})[f]=this.state.scaleDown,e)),a=PS(m,((t={})[g]=this.state.scaleDown,t[y]=!this.state.userActive,t)),s=PS(l,((n={})[u]=this.state.keyboardFocused,n[c]=!this.state.keyboardFocused,n));return Vn.createElement(QP.ReactContext.Provider,{value:this.props.context},Vn.createElement("div",{ref:function(e){r.webPlayerRef=e},className:s},Vn.createElement("div",{className:d},Vn.createElement("div",{className:o}),Vn.createElement("div",{className:h},Vn.createElement("div",{ref:function(e){r.overlaysContainerRef=e},className:a,onMouseMove:this.onMouseMove,tabIndex:-1},Vn.createElement(lM.HeroImageOverlay,null),Vn.createElement(sM.GradientOverlay,null),Vn.createElement(uM.LoadingOverlay,null),Vn.createElement(MM.PausedOverlay,null),this.state.pictureInPictureWeblab===Y.WeblabTreatment.T1?Vn.createElement(IM.PictureInPictureOverlay,null):null,Vn.createElement(aM.ControlsOverlay,null),Vn.createElement(cM.MaturityRatingOverlay,null),Vn.createElement(wM.ModalGroup,null)),Vn.createElement("div",{className:v}))),i?Vn.createElement("span",{tabIndex:-1,className:S},Vn.createElement(dP.XrayFullView,{isFullscreen:this.state.isFullscreen,toggleFullscreen:function(e){r.state.isPictureInPicture||r.props.context.stores.fullscreen.toggleFullscreen(e)}})):null))},e.prototype.addFocusRing=function(e,t,n){e.classList.contains(n)?e.classList.replace(n,t):e.classList.add(t)},e.prototype.removeFocusRing=function(e,t,n){e.classList.contains(t)?e.classList.replace(t,n):e.classList.add(n)},e.prototype.onPlayerTouched=function(){var e=Ld.findDOMNode(this.webPlayerRef);e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("touchstart",this.onTouchStart),this.props.context.stores.touchInput.onPlayerTouched()},e}(Vn.Component);t.WebPlayer=i});e(EM);EM.WebPlayer;var _M=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===t&&(t=Vn),this.uiElementEnableMap={closeButtonEnabled:!1,playButtonEnabled:!1},this.context=e,this.reactRef=t}return e.prototype.withPlayButton=function(){return this.uiElementEnableMap.playButtonEnabled=!0,this},e.prototype.withCloseButton=function(){return this.uiElementEnableMap.closeButtonEnabled=!0,this},e.prototype.build=function(){return this.reactRef.createElement(EM.WebPlayer,{context:this.context,uiElementEnableMap:this.uiElementEnableMap})},e}();t.WebPlayerUIBuilder=n});e(_M);_M.WebPlayerUIBuilder;var xM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return n(t,e),t.prototype.createUIComponent=function(e){return new _M.WebPlayerUIBuilder(e).withCloseButton().withPlayButton().build()},t}(Nw.WebPlayerUI);t.AmazonVideoUI=i});e(xM);xM.AmazonVideoUI;var kM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({position:"absolute",overflow:"hidden",width:"100%",height:"100%",background:"linear-gradient(rgb(0,168,225), rgb(15,23,30))"}),o=qS.styler({position:"absolute",width:"100%",height:"100%",background:"radial-gradient(circle at top 0% right -30%, transparent, rgb(15,23,30))"}),a=qS.styler({position:"absolute",width:"100%",height:"100%",background:"radial-gradient(circle at top -30% right -30%, rgb(0, 255, 150), transparent 60%)",opacity:.27}),s=qS.styler({position:"absolute",width:"100%",height:"100%",background:"radial-gradient(circle at bottom -80% left 75%, rgb(255, 0, 0), transparent 60%)",opacity:.27}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:i},Vn.createElement("div",{className:o}),Vn.createElement("div",{className:a}),Vn.createElement("div",{className:s}))},t}(Vn.Component);t.IdleScreenBackground=l});e(kM);kM.IdleScreenBackground;var RM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({position:"relative"},BC.ScaleProperty("width",120),BC.ScaleProperty("height",38)),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:i},Vn.createElement(wb.SVGImage,{src:Ww.SVG.PrimeVideoLogo}))},t}(Vn.Component);t.PrimeVideoLogo=o});e(RM);RM.PrimeVideoLogo;var AM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({position:"relative",width:"100%",height:"100%",display:"flex"}),a=qS.styler({position:"relative",width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}),s=qS.styler({display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"flex-end",alignItems:"center"},BC.ScaleProperty("width",650),BC.ScaleProperty("padding-bottom",110)),l=qS.styler({position:"relative"},BC.ScaleProperty("width",72),BC.ScaleProperty("height",72)),u=qS.styler(BC.FontBold(),BC.ScaleProperty("font-size",48),BC.ScaleProperty("margin-top",24),BC.ScaleProperty("margin-bottom",24)),c=qS.styler({$nest:{"& a":{color:"#f2f4f6",textDecoration:"none"}}},BC.FontNormal(),BC.ScaleProperty("font-size",28),BC.ScaleProperty("line-height",36)),d=qS.styler({boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"flex-end"},BC.ScaleProperty("padding-bottom",60)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onError=function(e){t.setState({title:xt.nestedValue(e,"title"),description:xt.nestedValue(e,"description")})},t.state={title:null,description:null},t}return i(e,n),e.prototype.componentDidMount=function(){this.onError(this.context.stores.error.getCurrentError()),this.context.stores.error.onError(this.onError)},e.prototype.componentWillUnmount=function(){this.context.stores.error.offError(this.onError)},e.prototype.render=function(){return Vn.createElement("div",{className:o},Vn.createElement(kM.IdleScreenBackground,null),Vn.createElement("div",{className:a},Vn.createElement("div",{className:s},Vn.createElement("div",{className:l},Vn.createElement(wb.SVGImage,{src:Ww.SVG.Error})),Vn.createElement("h2",{className:u},this.state.title),Vn.createElement("div",{className:c,dangerouslySetInnerHTML:{__html:this.state.description}})),Vn.createElement("div",{className:d},Vn.createElement(RM.PrimeVideoLogo,null))))},e.contextType=QP.ReactContext,e}(Vn.Component);t.ErrorOverlay=n});e(AM);AM.ErrorOverlay;var OM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({position:"relative"},BC.ScaleProperty("width",198),BC.ScaleProperty("height",82)),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:i},Vn.createElement(wb.SVGImage,{src:Ww.SVG.PhoneToTV}))},t}(Vn.Component);t.PhoneToTVIcon=o});e(OM);OM.PhoneToTVIcon;var LM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end"}),o=qS.styler({display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center"}),a=qS.styler({textAlign:"center"},BC.ScaleProperty("width",198)),s=qS.styler({boxSizing:"border-box",paddingTop:"4%",display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center",textAlign:"center"},BC.ScaleProperty("padding-bottom",110)),l=qS.styler({height:"15%",display:"flex",justifyContent:"center",alignItems:"flex-end",boxSizing:"border-box"},BC.ScaleProperty("padding-bottom",60)),u=qS.styler(BC.FontHeavy(),BC.ScaleProperty("font-size",48)),c=qS.styler({marginTop:"0"},BC.FontLight(),BC.ScaleProperty("font-size",28),BC.ScaleProperty("line-height",36)),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.context.stores.localization.getLocalization();return Vn.createElement("div",{className:i},Vn.createElement("div",{className:o},Vn.createElement("div",{className:a},Vn.createElement(OM.PhoneToTVIcon,null))),Vn.createElement("div",{className:s},Vn.createElement("h1",{className:u},e.idleScreen.header),Vn.createElement("p",{className:c},e.idleScreen.paragraphOne)),Vn.createElement("div",{className:l},Vn.createElement(RM.PrimeVideoLogo,null)))},t.contextType=QP.ReactContext,t}(Vn.Component);t.ConnectedScreen=d});e(LM);LM.ConnectedScreen;var FM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end"}),o=qS.styler({display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center"}),a=qS.styler({textAlign:"center"},BC.ScaleProperty("width",198)),s=qS.styler({boxSizing:"border-box",paddingTop:"4%",display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center",textAlign:"center"},BC.ScaleProperty("padding-bottom",110)),l=qS.styler({height:"15%",display:"flex",justifyContent:"center",alignItems:"flex-end",boxSizing:"border-box"},BC.ScaleProperty("padding-bottom",60)),u=qS.styler(BC.FontHeavy(),BC.ScaleProperty("font-size",48)),c=qS.styler({marginTop:"0"},BC.FontLight(),BC.ScaleProperty("font-size",28),BC.ScaleProperty("line-height",36)),d=qS.styler({textAlign:"start"},BC.ScaleProperty("width",650)),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){var e=this.context.stores.localization.getLocalization();return Vn.createElement("div",{className:i},Vn.createElement("div",{className:o},Vn.createElement("div",{className:a},Vn.createElement(OM.PhoneToTVIcon,null))),Vn.createElement("div",{className:s},Vn.createElement("h1",{className:u},e.gCast.idleScreen.updateHeader),Vn.createElement("p",{className:c+" "+d},e.gCast.idleScreen.updateWarning),Vn.createElement("p",{className:c+" "+d},e.gCast.idleScreen.updateMessage)),Vn.createElement("div",{className:l},Vn.createElement(RM.PrimeVideoLogo,null)))},t.contextType=QP.ReactContext,t}(Vn.Component);t.DegradedConnectedScreen=p});e(FM);FM.DegradedConnectedScreen;var DM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({width:"100%",height:"100%"}),o=Vd.keyframes({"100%":{transform:"rotate(360deg)"}}),a=Vd.keyframes({"0%":{strokeDasharray:"1, 240",strokeDashoffset:"0"},"50%":{strokeDasharray:"109, 240",strokeDashoffset:"-40px"},"100%":{strokeDasharray:"109, 240",strokeDashoffset:"-148px"}}),s=qS.styler({animation:o+" 2s linear infinite",transformOrigin:"center center",height:"100%",width:"100%",position:"absolute"}),l=qS.styler({strokeDasharray:"1, 240",strokeDashoffset:"0",animation:a+" 1.5s ease-in-out infinite",strokeLinecap:"round"}),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return this.props.shouldShow?Vn.createElement("div",{className:i},Vn.createElement("svg",{className:s,viewBox:"25 25 50 50"},Vn.createElement("circle",{className:l,cx:"50",cy:"50",r:"24",stroke:"white",fill:"none",strokeWidth:"2",strokeMiterlimit:"10"}))):null},t}(Vn.Component);t.GCastLoadingSpinner=u});e(DM);DM.GCastLoadingSpinner;var NM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column"}),o=qS.styler({height:"35%"}),a=qS.styler({height:"30%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}),s=qS.styler({position:"relative"},BC.ScaleProperty("width",48),BC.ScaleProperty("height",48),BC.ScaleProperty("margin-top",28)),l=qS.styler({height:"35%",boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"flex-end"},BC.ScaleProperty("padding-bottom",60)),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:i},Vn.createElement("div",{className:o}),Vn.createElement("div",{className:a},Vn.createElement(OM.PhoneToTVIcon,null),Vn.createElement("div",{className:s},Vn.createElement(DM.GCastLoadingSpinner,{shouldShow:!0}))),Vn.createElement("div",{className:l},Vn.createElement(RM.PrimeVideoLogo,null)))},t}(Vn.Component);t.DisconnectedScreen=u});e(NM);NM.DisconnectedScreen;var UM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({position:"relative",width:"100%",height:"100%"}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onCastStateChange=function(e){t.setState(t.getStateFromCastState(e))},t.state={castState:ct.CastState.Disconnected,isFirmwareSupported:!0},t}return i(e,n),e.prototype.componentDidMount=function(){this.setState(this.getStateFromCastState(this.context.stores.gCast.getCurrentCastState())),this.context.stores.gCast.on("CastStateChange",this.onCastStateChange)},e.prototype.componentWillUnmount=function(){this.context.stores.gCast.off("CastStateChange",this.onCastStateChange)},e.prototype.render=function(){return Vn.createElement("div",{className:o},Vn.createElement(kM.IdleScreenBackground,null),this.state.castState===ct.CastState.Disconnected?Vn.createElement(NM.DisconnectedScreen,null):this.state.isFirmwareSupported?Vn.createElement(LM.ConnectedScreen,null):Vn.createElement(FM.DegradedConnectedScreen,null))},e.prototype.getStateFromCastState=function(e){return{castState:e,isFirmwareSupported:this.context.stores.gCast.getIsFirmwareSupported()}},e.contextType=QP.ReactContext,e}(Vn.Component);t.IdleScreen=n});e(UM);UM.IdleScreen;var BM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({height:"100%"}),o=qS.styler(BC.FontBold(),BC.ScaleProperty("font-size",48),BC.ScaleProperty("margin-top",39),BC.ScaleProperty("margin-bottom",24)),a=qS.styler(BC.FontNormal(),BC.ScaleProperty("font-size",24)),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){return Vn.createElement("div",{className:i},Vn.createElement("h2",{className:o},this.props.header),Vn.createElement("p",{className:a},this.props.text))},t}(Vn.Component);t.Message=s});e(BM);BM.Message;var VM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var l=qS.styler({display:"flex"}),u=qS.styler(BC.ScaleProperty("height",117),BC.ScaleProperty("margin-right",16)),c=qS.styler({display:"flex",flexDirection:"column",flexGrow:1}),d=qS.styler({textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},BC.FontBold(),BC.ScaleProperty("margin-left",-4),BC.ScaleProperty("margin-top",-8),BC.ScaleProperty("font-size",48)),p=qS.styler(BC.ScaleProperty("font-size",18)),f=qS.styler({display:"flex",flexDirection:"column"}),h=qS.styler({display:"flex",alignItems:"flex-end",flexGrow:1}),m=qS.styler(BC.ScaleProperty("margin-right",10)),y=qS.styler({position:"relative"},BC.ScaleProperty("width",30),BC.ScaleProperty("height",28)),g=qS.styler({borderColor:"#8197A4"},BC.ScaleProperty("padding-left",8),BC.ScaleProperty("padding-right",8)),v=qS.styler({color:"#8197A4"},BC.ScaleProperty("font-size",20)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onTitleInfo=function(e){t.setState(t.getStateFromTitleInfo(e))},t.state={episodeNumber:null,hasCaptions:!1,primaryTitle:null,regulatoryRating:null,seasonNumber:null,secondaryTitle:null,titleImageUrl:null},t}return i(e,n),e.prototype.componentDidMount=function(){this.setState(this.getStateFromTitleInfo(this.context.stores.title.getTitleInfo())),this.context.stores.title.onUpdate(this.onTitleInfo)},e.prototype.componentWillUnmount=function(){this.context.stores.title.offUpdate(this.onTitleInfo)},e.prototype.render=function(){var e=null;null!==this.state.titleImageUrl&&(e=Vn.createElement("img",{className:u,src:this.state.titleImageUrl,alt:""}));var t=null,n=null!==this.state.primaryTitle,r=null!==this.state.secondaryTitle;(n||r)&&(t=Vn.createElement("div",{className:c},n?Vn.createElement("div",{className:d},this.state.primaryTitle):null,r?Vn.createElement("div",{className:p},this.getFullSecondaryTitle()):null));var i=null,o=null!==this.state.regulatoryRating,a=this.state.hasCaptions;if(o||a){var s=this.state.hasCaptions?g+" "+m:g;i=Vn.createElement("div",{className:h},o?Vn.createElement(wb.Label,{labelClassName:s,textClassName:v},this.state.regulatoryRating):null,this.state.hasCaptions?Vn.createElement("div",{className:y},Vn.createElement(wb.SVGImage,{src:Ww.SVG.SubtitlesAndAudioDark})):null)}return Vn.createElement("div",{className:l},e,null===t&&null===i?null:Vn.createElement("div",{className:f},t,i))},e.prototype.getFullSecondaryTitle=function(){if(null===this.state.secondaryTitle||null===this.state.seasonNumber||null===this.state.episodeNumber)return"";var e=this.context.stores.localization.getLocalization(),t={seasonNumber:this.state.seasonNumber,episodeNumber:this.state.episodeNumber};return this.context.stores.localization.mapReplace(e.episodeLong,t)+" "+this.state.secondaryTitle},e.prototype.getStateFromTitleInfo=function(e){var t=xt.exists(e.seriesTitle),n=t?e.seriesTitle:e.title,r=t?e.title:null;return{episodeNumber:e.episodeNumber||null,hasCaptions:e.hasCaptions||null,primaryTitle:n||null,regulatoryRating:e.regulatoryRating||null,seasonNumber:e.seasonNumber||null,secondaryTitle:r||null,titleImageUrl:e.titleImageUrl||null}},e.contextType=QP.ReactContext,e}(Vn.Component);t.TitleInfo=n});e(VM);VM.TitleInfo;var jM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({position:"relative",width:"100%",height:"100%",display:"flex",backgroundImage:"linear-gradient(to bottom, rgba(15,23,30,0) 0%, rgba(15,23,30,0.82) 33%, rgba(15,23,30,1) 100%);"}),a=qS.styler({width:"10.625%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",paddingTop:"0.7%"}),s=qS.styler({height:"100%",width:"78.75%",display:"flex",flexDirection:"column",justifyContent:"center"}),l=qS.styler({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end"}),u=qS.styler({display:"flex",marginBottom:"10px"},BC.ScaleProperty("margin-bottom",6)),c=qS.styler({width:"75%"}),d=qS.styler({display:"flex",justifyContent:"flex-end",alignItems:"center",width:"25%"}),p=qS.styler(BC.ScaleProperty("margin-bottom",2)),f=qS.styler({width:"10.625%",height:"100%"}),h=qS.styler({display:"flex",justifyContent:"center",alignItems:"flex-end"},BC.ScaleProperty("padding-bottom",60)),m=qS.styler(BC.ScaleProperty("height",8),BC.ScaleProperty("padding-top",10),BC.ScaleProperty("padding-bottom",10)),y=qS.styler({backgroundColor:"rgba(242, 244, 246, 0.2)"},BC.ScaleProperty("height",8),BC.ScaleProperty("border-radius",8)),g=qS.styler(BC.ScaleProperty("margin-left",-9),BC.ScaleProperty("margin-top",-5)),v=qS.styler(BC.ScaleProperty("height",18),BC.ScaleProperty("width",18)),S=qS.styler({backgroundColor:"rgb(242, 244, 246)"},BC.ScaleProperty("height",8),BC.ScaleProperty("border-radius",8)),b=qS.styler({backgroundColor:"rgba(242, 244, 246, 0.33)"},S),T=qS.styler({visibility:"hidden"}),P=qS.styler({backgroundColor:"rgba(242, 244, 246, 0.3)"},BC.ScaleProperty("height",8),BC.ScaleProperty("width",20),BC.ScaleProperty("top",10)),w=qS.styler(BC.ScaleProperty("font-size",24)),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onPINRequiredChange=function(e){t.setState({pinRequired:e})},t.onUserActiveChange=function(e){t.setState({userActive:e})},t.state={pinRequired:!1,userActive:!0},t}return i(e,n),e.prototype.componentDidMount=function(){this.onPINRequiredChange(this.context.stores.gCast.getPINRequired()),this.context.stores.gCast.on("PINRequiredChange",this.onPINRequiredChange),this.onUserActiveChange(this.context.stores.userActivity.getUserActive()),this.context.stores.userActivity.onUserActiveChange(this.onUserActiveChange)},e.prototype.componentWillUnmount=function(){this.context.stores.gCast.off("PINRequiredChange",this.onPINRequiredChange),this.context.stores.userActivity.offUserActiveChange(this.onUserActiveChange)},e.prototype.render=function(){var e,t=null;if(!this.state.userActive){var n=this.context.stores.localization.getLocalization();t=Vn.createElement(BM.Message,{header:n.userInactive.header,text:n.userInactive.text})}var r=PS(S,((e={})[T]=this.state.pinRequired,e));return Vn.createElement("div",{className:o},Vn.createElement("div",{className:a}),Vn.createElement("div",{className:s},Vn.createElement("div",{className:l},null!==t?t:Vn.createElement(Vn.Fragment,null,Vn.createElement("div",{className:u},Vn.createElement("div",{className:c},Vn.createElement(VM.TitleInfo,null)),Vn.createElement("div",{className:d})),Vn.createElement("div",null,Vn.createElement("div",{className:p},Vn.createElement(rC.SeekBar,{progressBarContainerClassName:m,progressBarClassName:y,handleWrapperClassName:g,handleClassName:v,progressBarSegmentClassName:r,secondaryProgressBarSegmentClassName:b,tickMarkClassName:P})),Vn.createElement(eC.TimeIndicator,{className:w,visible:this.shouldShowTimeIndicator()})))),Vn.createElement("div",{className:h},Vn.createElement(RM.PrimeVideoLogo,null))),Vn.createElement("div",{className:f}))},e.prototype.shouldShowTimeIndicator=function(){return!this.state.pinRequired},e.contextType=QP.ReactContext,e}(Vn.Component);t.BottomPanel=n});e(jM);jM.BottomPanel;var XM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=qS.styler({position:"absolute"},BC.ScaleProperty("right",204),BC.ScaleProperty("bottom",164),BC.ScaleProperty("font-size",24)),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.render=function(){if(!this.props.show)return null;var e=this.context.stores.localization.getLocalization();return Vn.createElement("div",{className:i},e.gCastPinMessage)},t.contextType=QP.ReactContext,t}(Vn.Component);t.PINRequired=o});e(XM);XM.PINRequired;var zM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i,o,a=qS.styler({position:"absolute",opacity:0,transition:"opacity 200ms linear"},BC.ScaleProperty("width",76),BC.ScaleProperty("height",76),BC.ScaleProperty("right",204),BC.ScaleProperty("bottom",164)),s=qS.styler({opacity:1});(o=i||(i={})).Loading="Loading",o.Paused="Paused",o.Playing="Playing";var l=function(t){function e(e){var n=t.call(this,e)||this;return n.lock=null,n.mounted=!1,n.timeoutId=null,n.seeking=!1,n.onSeek=function(){n.seeking=!0},n.onLockStatusChange=function(e){n.setState({uiLocked:e})},n.onContentStateChange=function(e){n.mounted&&(e===Gd.ContentState.Waiting?null===n.timeoutId&&(n.setIcon(i.Loading),n.setShowingWithDelay(!0,n.seeking?null:500,function(){n.state.contentState!==Gd.ContentState.Waiting&&n.setShowingWithDelay(!1)})):(n.state.showing&&(n.cancelTimeout(),n.state.playbackState!==Gd.PlaybackState.Paused?n.setShowingWithDelay(!1):n.setIcon(i.Paused)),n.seeking=!1),n.setState({contentState:e}))},n.onPINRequiredChange=function(e){n.setState({pinRequired:e})},n.onPreloadStateChange=function(e){e||(n.lock.lock(3e3),n.setShowingWithDelay(!0))},n.onPlaybackStateChange=function(e){n.mounted&&(n.setIcon(e===Gd.PlaybackState.Paused?i.Paused:i.Playing),n.lock.lock(3e3),n.setShowingWithDelay(!0),e===Gd.PlaybackState.Playing&&n.setShowingWithDelay(!1,3e3),n.setState({playbackState:e}))},n.onUiStatusUpdate=function(e){if(n.mounted&&e.state!==n.state.uiPlaybackState){var t=n.state.uiPlaybackState;e.state===$P.UIPlaybackState.Loading?(n.lock.lock(),n.setIcon(i.Loading)):t===$P.UIPlaybackState.Loading&&n.onPlaybackStateChange(n.context.stores.playback.getPlaybackState()),n.setState({userActive:e.userActive,uiPlaybackState:e.state})}},n.state={contentState:Gd.ContentState.Unloaded,pinRequired:!1,playbackState:Gd.PlaybackState.Paused,showing:!1,icon:i.Loading,uiLocked:!1,uiPlaybackState:$P.UIPlaybackState.Stopped,userActive:!1},n}return n(e,t),e.prototype.componentDidMount=function(){this.mounted=!0,this.lock=this.context.stores.lock.newLock(),this.onContentStateChange(this.context.stores.playback.getContentState()),this.context.stores.playback.onContentStateChange(this.onContentStateChange),this.context.stores.lock.onChange(this.onLockStatusChange),this.onPINRequiredChange(this.context.stores.gCast.getPINRequired()),this.context.stores.gCast.on("PINRequiredChange",this.onPINRequiredChange),this.onPreloadStateChange(this.context.stores.gCast.getPreloadState()),this.context.stores.gCast.on("PreloadStateChange",this.onPreloadStateChange),this.onPlaybackStateChange(this.context.stores.playback.getPlaybackState()),this.context.stores.playback.onPlaybackStateChange(this.onPlaybackStateChange),this.context.stores.playback.on("SeekChange",this.onSeek),this.onUiStatusUpdate(this.context.stores.uiStatus.getUserInterfaceStatus()),this.context.stores.uiStatus.onUpdate(this.onUiStatusUpdate)},e.prototype.componentWillUnmount=function(){this.mounted=!1,this.context.stores.gCast.off("PINRequiredChange",this.onPINRequiredChange),this.context.stores.gCast.off("PreloadStateChange",this.onPreloadStateChange),this.context.stores.lock.offChange(this.onLockStatusChange),this.context.stores.playback.offContentStateChange(this.onContentStateChange),this.context.stores.playback.offPlaybackStateChange(this.onPlaybackStateChange),this.context.stores.playback.off("SeekChange",this.onSeek),this.context.stores.uiStatus.offUpdate(this.onUiStatusUpdate),this.context.stores.lock.deleteLock(this.lock),this.lock=null},e.prototype.render=function(){var e;if(this.state.pinRequired)return null;var t=PS(a,((e={})[s]=this.state.showing,e)),n=Vn.createElement(DM.GCastLoadingSpinner,{shouldShow:!0});return this.state.icon===i.Paused?n=Vn.createElement(wb.SVGImage,{src:Ww.SVG.PauseGCast}):this.state.icon===i.Playing&&(n=Vn.createElement(wb.SVGImage,{src:Ww.SVG.PlayGCast})),Vn.createElement("div",{className:t},n)},e.prototype.cancelTimeout=function(){A.timer.clearTimeout(this.timeoutId),this.timeoutId=null},e.prototype.setShowingWithDelay=function(e,t,n){var r=this;void 0===t&&(t=null),void 0===n&&(n=null),this.cancelTimeout(),null===t?this.setShowing(e):this.timeoutId=A.timer.setTimeout(function(){r.timeoutId=null,r.setShowing(e),null!==n&&n()},t)},e.prototype.setShowing=function(e){this.setState({showing:e}),this.seeking&&(e?this.lock.lock():this.lock.lock(3e3))},e.prototype.setIcon=function(e){this.setState({icon:e})},e.contextType=QP.ReactContext,e}(Vn.Component);t.PlaybackStateIndicator=l});e(zM);zM.PlaybackStateIndicator;var qM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end"}),a=qS.styler({width:"100%",height:"100%"}),s=qS.styler({width:"100%",display:"none"},BC.ScaleProperty("height",306)),n=qS.styler({display:"block",opacity:0}),l=qS.styler({display:"block",opacity:1,transition:"opacity 200ms linear"}),u={enter:n,enterActive:l,enterDone:l,exit:qS.styler({display:"block",opacity:1}),exitActive:qS.styler({display:"block",opacity:0,transition:"opacity 200ms linear"}),exitDone:qS.styler({display:"none"})},c=function(n){function e(e){var t=n.call(this,e)||this;return t.lock=null,t.locked=!1,t.onContentStateChange=function(e){t.setState({contentState:e})},t.onPlaybackStateChange=function(e){t.setState({playbackState:e})},t.onUserActiveChange=function(e){t.setState({userActive:e})},t.onLockStatusChange=function(e){t.setState({uiLocked:e})},t.onPreloadStateChange=function(e){e||(t.setState({preload:!0}),setTimeout(function(){t.setState({preload:!1})},3e3))},t.onPINRequiredChange=function(e){t.setState({pinRequired:e})},t.onClick=function(){t.state.playbackState===Gd.PlaybackState.Paused?t.context.stores.playback.play():t.context.stores.playback.pause()},t.onKeyUp=function(e){"l"===e.key&&(t.locked?t.lock.unlock():t.lock.lock(),t.locked=!t.locked)},t.state={contentState:Gd.ContentState.Unloaded,pinRequired:!1,playbackState:Gd.PlaybackState.Paused,uiLocked:!1,userActive:!0,preload:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.lock=this.context.stores.lock.newLock(),this.context.stores.lock.onChange(this.onLockStatusChange),this.onPINRequiredChange(this.context.stores.gCast.getPINRequired()),this.context.stores.gCast.on("PINRequiredChange",this.onPINRequiredChange),this.onPreloadStateChange(this.context.stores.gCast.getPreloadState()),this.context.stores.gCast.on("PreloadStateChange",this.onPreloadStateChange),this.onContentStateChange(this.context.stores.playback.getContentState()),this.context.stores.playback.onContentStateChange(this.onContentStateChange),this.onPlaybackStateChange(this.context.stores.playback.getPlaybackState()),this.context.stores.playback.onPlaybackStateChange(this.onPlaybackStateChange),this.onUserActiveChange(this.context.stores.userActivity.getUserActive()),this.context.stores.userActivity.onUserActiveChange(this.onUserActiveChange)},e.prototype.componentWillUnmount=function(){this.context.stores.lock.deleteLock(this.lock),this.lock=null,this.context.stores.lock.offChange(this.onLockStatusChange),this.context.stores.gCast.off("PINRequiredChange",this.onPINRequiredChange),this.context.stores.gCast.off("PreloadStateChange",this.onPreloadStateChange),this.context.stores.playback.offContentStateChange(this.onContentStateChange),this.context.stores.playback.offPlaybackStateChange(this.onPlaybackStateChange),this.context.stores.userActivity.offUserActiveChange(this.onUserActiveChange)},e.prototype.render=function(){return Vn.createElement("div",{className:o,onClick:this.onClick,onKeyUp:this.onKeyUp,tabIndex:0},Vn.createElement(lM.HeroImageOverlay,null),this.state.userActive?Vn.createElement("div",{className:a},Vn.createElement(VC.Captions,null)):null,Vn.createElement(wC.CSSTransition,{in:this.shouldShowBottomPanel(),timeout:200,classNames:u},Vn.createElement("div",{className:s},Vn.createElement(jM.BottomPanel,null))),Vn.createElement(XM.PINRequired,{show:this.shouldShowPINRequired()}),Vn.createElement(zM.PlaybackStateIndicator,null))},e.prototype.shouldShowBottomPanel=function(){return this.state.uiLocked||!this.state.userActive||this.state.pinRequired||this.state.preload},e.prototype.shouldShowPINRequired=function(){return this.state.pinRequired&&this.state.userActive},e.contextType=QP.ReactContext,e}(Vn.Component);t.PlaybackOverlay=c});e(qM);qM.PlaybackOverlay;var WM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=qS.styler({position:"relative",width:"100%",height:"100%",color:"#F2F4F6",fontFamily:"ATVWebPlayerSDK Amazon Ember, Helvetica, sans-serif"}),n=function(n){function e(e){var t=n.call(this,e)||this;return t.onLanguageChanged=function(e){t.setState(t.getStateFromLanguageChanged()),t.forceUpdate()},t.onContentStateChange=function(e){t.setState({contentState:e})},t.onError=function(e){t.setState({error:e})},t.onPreloadStateChange=function(e){t.setState({preloadState:e})},t.state={contentState:Gd.ContentState.Unloaded,error:null,localizationReady:!1,preloadState:!1},t}return i(e,n),e.prototype.componentDidMount=function(){this.setState(this.getStateFromLanguageChanged()),this.props.context.stores.localization.onLanguageChanged(this.onLanguageChanged),this.onContentStateChange(this.props.context.stores.playback.getContentState()),this.props.context.stores.playback.onContentStateChange(this.onContentStateChange),this.onError(this.props.context.stores.error.getCurrentError()),this.props.context.stores.error.onError(this.onError),this.props.context.stores.gCast.on("PreloadStateChange",this.onPreloadStateChange)},e.prototype.componentWillUnmount=function(){this.props.context.stores.localization.offLanguageChanged(this.onLanguageChanged),this.props.context.stores.playback.offContentStateChange(this.onContentStateChange),this.props.context.stores.error.offError(this.onError),this.props.context.stores.gCast.off("PreloadStateChange",this.onPreloadStateChange)},e.prototype.render=function(){var e=null;return this.state.localizationReady&&(e=null!==this.state.error?Vn.createElement("div",{className:o},Vn.createElement(AM.ErrorOverlay,null)):Vn.createElement("div",{className:o},this.state.preloadState||this.state.contentState===Gd.ContentState.Unloaded?Vn.createElement(UM.IdleScreen,null):Vn.createElement(qM.PlaybackOverlay,null))),Vn.createElement(QP.ReactContext.Provider,{value:this.props.context},e)},e.prototype.getStateFromLanguageChanged=function(){return{localizationReady:!F.isEmpty(this.props.context.stores.localization.getLocalization())}},e}(Vn.Component);t.GCastPlayer=n});e(WM);WM.GCastPlayer;var HM=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(){return n.call(this)||this}return i(e,n),e.prototype.attach=function(e,t){null==e.uiConfig&&(e.uiConfig={}),e.uiConfig.enableSeekbarTrickplay=!1,e.uiConfig.enableXray=!1,n.prototype.attach.call(this,e,t)},e.prototype.isBlockingModalShowing=function(){return!1},e.prototype.createUIComponent=function(e){return e.stores.uiConfigurations.updateUIConfigurations({enableLiveContentWarning:!1}),this.reactRef.createElement(WM.GCastPlayer,{context:e,uiElementEnableMap:{}})},e}(Nw.WebPlayerUI);t.GCastUI=n});e(HM);HM.GCastUI;var GM=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return n(t,e),t.prototype.createUIComponent=function(e){return new _M.WebPlayerUIBuilder(e).withPlayButton().build()},t}(Nw.WebPlayerUI);t.MinimalUI=i});e(GM);GM.MinimalUI;var KM=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AmazonVideoUI=xM.AmazonVideoUI,t.GCastUI=HM.GCastUI,t.MinimalUI=GM.MinimalUI,t.WebPlayerUI=Nw.WebPlayerUI});e(KM);KM.AmazonVideoUI,KM.GCastUI,KM.MinimalUI,KM.WebPlayerUI;var QM=t(function(e,t){function n(e){var t=[];for(var n in e)t.push(n);return t}(e.exports='function'==typeof Object.keys?Object.keys:n).shim=n}),YM=(QM.shim,t(function(e,t){var n='[object Arguments]'==function(){return Object.prototype.toString.call(arguments)}();function r(e){return'[object Arguments]'==Object.prototype.toString.call(e)}function i(e){return e&&'object'==typeof e&&'number'==typeof e.length&&Object.prototype.hasOwnProperty.call(e,'callee')&&!Object.prototype.propertyIsEnumerable.call(e,'callee')||!1}(t=e.exports=n?r:i).supported=r,t.unsupported=i})),JM=(YM.supported,YM.unsupported,t(function(e){var s=Array.prototype.slice,l=e.exports=function(e,t,n){return n||(n={}),e===t||(e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():!e||!t||'object'!=typeof e&&'object'!=typeof t?n.strict?e===t:e==t:function(e,t,n){var r,i;if(u(e)||u(t))return!1;if(e.prototype!==t.prototype)return!1;if(YM(e))return!!YM(t)&&(e=s.call(e),t=s.call(t),l(e,t,n));if(c(e)){if(!c(t))return!1;if(e.length!==t.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}try{var o=QM(e),a=QM(t)}catch(e){return!1}if(o.length!=a.length)return!1;for(o.sort(),a.sort(),r=o.length-1;0<=r;r--)if(o[r]!=a[r])return!1;for(r=o.length-1;0<=r;r--)if(i=o[r],!l(e[i],t[i],n))return!1;return typeof e==typeof t}(e,t,n))};function u(e){return null==e}function c(e){return!(!e||'object'!=typeof e||'number'!=typeof e.length)&&('function'==typeof e.copy&&'function'==typeof e.slice&&!(0<e.length&&'number'!=typeof e[0]))}})),$M=V&&V.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},ZM=Object.prototype.hasOwnProperty;function eI(e,t){return ZM.call(e,t)}function tI(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);t=[];for(var r in e)eI(e,r)&&t.push(r);return t}function nI(e){return-1===e.indexOf('/')&&-1===e.indexOf('~')?e:e.replace(/~/g,'~0').replace(/\//g,'~1')}function rI(e,t){var n;for(var r in e)if(eI(e,r)){if(e[r]===t)return nI(r)+'/';if('object'==typeof e[r]&&''!=(n=rI(e[r],t)))return nI(r)+'/'+n}return''}var iI={hasOwnProperty:eI,_objectKeys:tI,_deepClone:function(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}},isInteger:function(e){for(var t,n=0,r=e.length;n<r;){if(!(48<=(t=e.charCodeAt(n))&&t<=57))return!1;n++}return!0},escapePathComponent:nI,unescapePathComponent:function(e){return e.replace(/~1/g,'/').replace(/~0/g,'~')},_getPathRecursive:rI,getPath:function(e,t){if(e===t)return'/';var n=rI(e,t);if(''===n)throw new Error("Object not found in root");return'/'+n},hasUndefined:function e(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return!0}else if("object"==typeof t){var i=tI(t),o=i.length;for(n=0;n<o;n++)if(e(t[i[n]]))return!0}return!1},PatchError:function(o){function e(e,t,n,r,i){o.call(this,e),this.message=e,this.name=t,this.index=n,this.operation=r,this.tree=i}return $M(e,o),e}(Error)},oI=t(function(e,p){var n={strict:!0},f=function(e,t){return JM(e,t,n)};p.JsonPatchError=iI.PatchError,p.deepClone=iI._deepClone;var h={add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var r=y(n,this.path);r&&(r=iI._deepClone(r));var i=s(n,{op:"remove",path:this.from}).removed;return s(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(e,t,n){var r=y(n,this.from);return s(n,{op:"add",path:this.path,value:iI._deepClone(r)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:f(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}},m={add:function(e,t,n){return iI.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:h.move,copy:h.copy,test:h.test,_get:h._get};function y(e,t){if(''==t)return e;var n={op:"_get",path:t};return s(e,n),n.value}function s(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=!0),n&&('function'==typeof n?n(t,0,e,t.path):g(t,0)),""===t.path){var i={newDocument:e};if('add'===t.op)return i.newDocument=t.value,i;if('replace'===t.op)return i.newDocument=t.value,i.removed=e,i;if('move'===t.op||'copy'===t.op)return i.newDocument=y(e,t.from),'move'===t.op&&(i.removed=e),i;if('test'===t.op){if(i.test=f(e,t.value),!1===i.test)throw new p.JsonPatchError("Test operation failed",'TEST_OPERATION_FAILED',0,t,e);return i.newDocument=e,i}if('remove'===t.op)return i.removed=e,i.newDocument=null,i;if('_get'===t.op)return t.value=e,i;if(n)throw new p.JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902','OPERATION_OP_INVALID',0,t,e);return i}r||(e=iI._deepClone(e));var o=(t.path||"").split('/'),a=e,s=1,l=o.length,u=void 0,c=void 0,d=void 0;for(d='function'==typeof n?n:g;;){if(c=o[s],n&&void 0===u&&(void 0===a[c]?u=o.slice(0,s).join('/'):s==l-1&&(u=t.path),void 0!==u&&d(t,0,e,u)),s++,Array.isArray(a)){if('-'===c)c=a.length;else{if(n&&!iI.isInteger(c))throw new p.JsonPatchError("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",0,t.path,t);iI.isInteger(c)&&(c=~~c)}if(l<=s){if(n&&"add"===t.op&&c>a.length)throw new p.JsonPatchError("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",0,t.path,t);if(!1===(i=m[t.op].call(t,a,c,e)).test)throw new p.JsonPatchError("Test operation failed",'TEST_OPERATION_FAILED',0,t,e);return i}}else if(c&&-1!=c.indexOf('~')&&(c=iI.unescapePathComponent(c)),l<=s){if(!1===(i=h[t.op].call(t,a,c,e)).test)throw new p.JsonPatchError("Test operation failed",'TEST_OPERATION_FAILED',0,t,e);return i}a=a[c]}}function i(e,t,n,r){if(void 0===r&&(r=!0),n&&!Array.isArray(t))throw new p.JsonPatchError('Patch sequence must be an array','SEQUENCE_NOT_AN_ARRAY');r||(e=iI._deepClone(e));for(var i=new Array(t.length),o=0,a=t.length;o<a;o++)i[o]=s(e,t[o],n),e=i[o].newDocument;return i.newDocument=e,i}function g(e,t,n,r){if('object'!=typeof e||null===e||Array.isArray(e))throw new p.JsonPatchError('Operation is not an object','OPERATION_NOT_AN_OBJECT',t,e,n);if(!h[e.op])throw new p.JsonPatchError('Operation `op` property is not one of operations defined in RFC-6902','OPERATION_OP_INVALID',t,e,n);if('string'!=typeof e.path)throw new p.JsonPatchError('Operation `path` property is not a string','OPERATION_PATH_INVALID',t,e,n);if(0!==e.path.indexOf('/')&&0<e.path.length)throw new p.JsonPatchError('Operation `path` property must start with "/"','OPERATION_PATH_INVALID',t,e,n);if(('move'===e.op||'copy'===e.op)&&'string'!=typeof e.from)throw new p.JsonPatchError('Operation `from` property is not present (applicable in `move` and `copy` operations)','OPERATION_FROM_REQUIRED',t,e,n);if(('add'===e.op||'replace'===e.op||'test'===e.op)&&void 0===e.value)throw new p.JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)','OPERATION_VALUE_REQUIRED',t,e,n);if(('add'===e.op||'replace'===e.op||'test'===e.op)&&iI.hasUndefined(e.value))throw new p.JsonPatchError('Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)','OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED',t,e,n);if(n)if("add"==e.op){var i=e.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new p.JsonPatchError('Cannot perform an `add` operation at the desired path','OPERATION_PATH_CANNOT_ADD',t,e,n)}else if('replace'===e.op||'remove'===e.op||'_get'===e.op){if(e.path!==r)throw new p.JsonPatchError('Cannot perform the operation at a path that does not exist','OPERATION_PATH_UNRESOLVABLE',t,e,n)}else if('move'===e.op||'copy'===e.op){var a=l([{op:"_get",path:e.from,value:void 0}],n);if(a&&'OPERATION_PATH_UNRESOLVABLE'===a.name)throw new p.JsonPatchError('Cannot perform the operation from a path that does not exist','OPERATION_FROM_UNRESOLVABLE',t,e,n)}}function l(e,t,n){try{if(!Array.isArray(e))throw new p.JsonPatchError('Patch sequence must be an array','SEQUENCE_NOT_AN_ARRAY');if(t)i(iI._deepClone(t),iI._deepClone(e),n||!0);else{n=n||g;for(var r=0;r<e.length;r++)n(e[r],r,t,void 0)}}catch(e){if(e instanceof p.JsonPatchError)return e;throw e}}p.getValueByPointer=y,p.applyOperation=s,p.applyPatch=i,p.applyReducer=function(e,t){var n=s(e,t);if(!1===n.test)throw new p.JsonPatchError("Test operation failed",'TEST_OPERATION_FAILED',0,t,e);return n.newDocument},p.validator=g,p.validate=l}),aI=(oI.JsonPatchError,oI.deepClone,oI.getValueByPointer,oI.applyOperation,oI.applyPatch,oI.applyReducer,oI.validator,oI.validate,oI),sI=aI.applyOperation,lI=aI.applyPatch,uI=aI.applyReducer,cI=aI.getValueByPointer,dI=aI.validate,pI=aI.validator,fI=iI,hI=fI.PatchError,mI=fI._deepClone,yI=fI.escapePathComponent,gI=fI.unescapePathComponent,vI=[],SI=function(e){this.observers=[],this.obj=e},bI=function(e,t){this.callback=e,this.observer=t};function TI(e){for(var t,n=0,r=vI.length;n<r;n++)if(vI[n].obj===e.object){t=vI[n];break}PI(t.value,e.object,e.patches,""),e.patches.length&&oI.applyPatch(t.value,e.patches);var i=e.patches;return 0<i.length&&(e.patches=[],e.callback&&e.callback(i)),i}function PI(e,t,n,r){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var i=iI._objectKeys(t),o=iI._objectKeys(e),a=!1,s=o.length-1;0<=s;s--){var l=e[c=o[s]];if(!iI.hasOwnProperty(t,c)||void 0===t[c]&&void 0!==l&&!1===Array.isArray(t))n.push({op:"remove",path:r+"/"+iI.escapePathComponent(c)}),a=!0;else{var u=t[c];"object"==typeof l&&null!=l&&"object"==typeof u&&null!=u?PI(l,u,n,r+"/"+iI.escapePathComponent(c)):l!==u&&n.push({op:"replace",path:r+"/"+iI.escapePathComponent(c),value:iI._deepClone(u)})}}if(a||i.length!=o.length)for(s=0;s<i.length;s++){var c=i[s];iI.hasOwnProperty(e,c)||void 0===t[c]||n.push({op:"add",path:r+"/"+iI.escapePathComponent(c),value:iI._deepClone(t[c])})}}}var wI={applyOperation:sI,applyPatch:lI,applyReducer:uI,getValueByPointer:cI,validate:dI,validator:pI,JsonPatchError:hI,deepClone:mI,escapePathComponent:yI,unescapePathComponent:gI,unobserve:function(e,t){t.unobserve()},observe:function(e,t){var n,r=function(e){for(var t=0,n=vI.length;t<n;t++)if(vI[t].obj===e)return vI[t]}(e);if(r?n=function(e,t){for(var n=0,r=e.observers.length;n<r;n++)if(e.observers[n].callback===t)return e.observers[n].observer}(r,t):(r=new SI(e),vI.push(r)),n)return n;if(n={},r.value=iI._deepClone(e),t){n.callback=t,n.next=null;var i=function(){TI(n)},o=function(){clearTimeout(n.next),n.next=setTimeout(i)};'undefined'!=typeof window&&(window.addEventListener?(window.addEventListener('mouseup',o),window.addEventListener('keyup',o),window.addEventListener('mousedown',o),window.addEventListener('keydown',o),window.addEventListener('change',o)):(document.documentElement.attachEvent('onmouseup',o),document.documentElement.attachEvent('onkeyup',o),document.documentElement.attachEvent('onmousedown',o),document.documentElement.attachEvent('onkeydown',o),document.documentElement.attachEvent('onchange',o)))}return n.patches=[],n.object=e,n.unobserve=function(){TI(n),clearTimeout(n.next),function(e,t){for(var n=0,r=e.observers.length;n<r;n++)if(e.observers[n].observer===t)return e.observers.splice(n,1)}(r,n),'undefined'!=typeof window&&(window.removeEventListener?(window.removeEventListener('mouseup',o),window.removeEventListener('keyup',o),window.removeEventListener('mousedown',o),window.removeEventListener('keydown',o)):(document.documentElement.detachEvent('onmouseup',o),document.documentElement.detachEvent('onkeyup',o),document.documentElement.detachEvent('onmousedown',o),document.documentElement.detachEvent('onkeydown',o)))},r.observers.push(new bI(t,n)),n},generate:TI,compare:function(e,t){var n=[];return PI(e,t,n,''),n}},CI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i={"fls-eu.amazon.com":[cw.MarketplaceID.DE,cw.MarketplaceID.ROE_EU,cw.MarketplaceID.ROW_EU,cw.MarketplaceID.UK],"fls-fe.amazon.com":[cw.MarketplaceID.JP,cw.MarketplaceID.ROW_FE],"fls-na.amazon.com":[cw.MarketplaceID.ROW_NA,cw.MarketplaceID.US]},n=function(){function t(){}return t.hasEndpoint=function(e){return null!=t.getEndpointForMarketplace(e)},t.getEmptyResponseBaseUrl=function(e){return"https://"+t.getEndpointForMarketplace(e)+"/1/action-impressions/1/OE"},t.getEndpointForMarketplace=function(e){for(var t=0,n=Object.keys(i);t<n.length;t++){var r=n[t];if(0<=i[r].indexOf(e))return r}return null},t}();t.Endpoints=n});e(CI);CI.Endpoints;var MI=t(function(e,t){var n,r=V&&V.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=((n={})[cw.MarketplaceID.DE]="de",n[cw.MarketplaceID.JP]="jp",n[cw.MarketplaceID.ROE_EU]="roe_eu",n[cw.MarketplaceID.ROW_EU]="row_eu",n[cw.MarketplaceID.ROW_FE]="row_fe",n[cw.MarketplaceID.ROW_NA]="row_na",n[cw.MarketplaceID.UK]="uk",n[cw.MarketplaceID.US]="us",n),i=function(){function e(e,t,n,r,i,o,a){if(void 0===o&&(o=0),void 0===a&&(a=3e4),this.batchedMetrics=[],this.flushTimeoutId=null,!CI.Endpoints.hasEndpoint(n))throw new Error("No endpoint for marketplaceId="+n);this.programGroup=t,this.marketplaceId=n,this.baseMwsQueryParameters={marketplace:s[this.marketplaceId],marketplaceId:n,requestId:"1",service:e,session:r},this.reportingDimensions=i,this.batchSize=o,this.batchFlushTimeoutMs=a,this.baseUrl=CI.Endpoints.getEmptyResponseBaseUrl(n)+"/"+t+"/action/"}return e.prototype.updateSessionId=function(e){this.baseMwsQueryParameters.session=e},e.prototype.putMetric=function(e,t,n,r,i){var o=this;void 0===n&&(n=1),null!=i&&i!==this.marketplaceId&&this.updateMarketplaceId(i);var a=e+":"+t+"@v="+n;null!=r&&(a=a+":u="+r),this.batchedMetrics.push(a),this.batchedMetrics.length>=this.batchSize?this.flush():(null!==this.flushTimeoutId&&A.timer.clearTimeout(this.flushTimeoutId),this.flushTimeoutId=A.timer.setTimeout(function(){o.flush()},this.batchFlushTimeoutMs))},e.prototype.flush=function(){if(!(this.batchedMetrics.length<1)){null!==this.flushTimeoutId&&A.timer.clearTimeout(this.flushTimeoutId);for(var e=this.baseUrl+this.batchedMetrics.join("/"),t=0,n=this.reportingDimensions;t<n.length;t++){var r=n[t];this.putMetricXhr(e,this.createMetricParameters(r))}this.batchedMetrics=[]}},e.prototype.putMetricXhr=function(e,t){mp.HttpRequest.get(e).query(t).timeout(3e3).send()},e.prototype.createMetricParameters=function(e){return r({},this.baseMwsQueryParameters,e)},e.prototype.updateMarketplaceId=function(e){this.flush(),this.baseUrl=CI.Endpoints.getEmptyResponseBaseUrl(e)+"/"+this.programGroup+"/action/"},e}();t.MetricsPublisher=i});e(MI);MI.MetricsPublisher;var II=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsPublisher=MI.MetricsPublisher});e(II);II.MetricsPublisher;var EI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDownloadOperationMetadataKey=function(e){return"download_operation_"+e},t.createDownloadOperationStoragePrefixKey=function(e){return"segment_data_"+e},t.createPlaybackResourceResponseKey=function(e){return"prs_metadata_"+e}});e(EI);EI.createDownloadOperationMetadataKey,EI.createDownloadOperationStoragePrefixKey,EI.createPlaybackResourceResponseKey;var _I=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new Ne.XpError("localStorage.unsupported",void 0,"LocalStorage has not been implemented for this platform"),r={capabilities:{isSupported:!1},getText:function(){return Fe.Promise.reject(n)},getArrayBuffer:function(){return Fe.Promise.reject(n)},put:function(){return Fe.Promise.reject(n)},remove:function(){return Fe.Promise.reject(n)},removePrefix:function(){return Fe.Promise.reject(n)}};t.localStorage=r});e(_I);_I.localStorage;var xI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.localStorage=_I.localStorage});e(xI);xI.localStorage;var kI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new Ne.XpError("metadataStorage.unsupported",void 0,"MetadataStorage has not been implemented for this platform"),r={capabilities:{isSupported:!1},get:function(){return Fe.Promise.reject(n)},put:function(){return Fe.Promise.reject(n)},remove:function(){return Fe.Promise.reject(n)}};t.metadataStorage=r});e(kI);kI.metadataStorage;var RI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.metadataStorage=kI.metadataStorage});e(RI);RI.metadataStorage;var AI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDownloadOperationStoragePrefixKey=function(e){return"segment_data_"+e},t.createDownloadProgressMetadataKey=function(e){return"download_progress_metadata_"+e},t.createPersistentLicenseMetadataKey=function(e){return"persistent_license_metadata_"+e},t.createQualityLevelProgressMetadataKey=function(e,t,n,r){return"progress_metadata_"+e+"_"+t+"_"+n+"_"+r},t.createSelectionContextKey=function(e){return"selection_context_"+e}});e(AI);AI.createDownloadOperationStoragePrefixKey,AI.createDownloadProgressMetadataKey,AI.createPersistentLicenseMetadataKey,AI.createQualityLevelProgressMetadataKey,AI.createSelectionContextKey;var OI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.CRITICAL_STREAM_TYPES=["Audio","Video"]});e(OI);OI.CRITICAL_STREAM_TYPES;var LI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.cacheEntries={}}return e.prototype.get=function(e){var t=this.cacheEntries[e.toString()];return null!=t?t:null},e.prototype.getAll=function(){return F.values(this.cacheEntries)},e.prototype.getAllKeys=function(){return Object.keys(this.cacheEntries)},e.prototype.put=function(e,t){this.cacheEntries[e.toString()]=t},e.prototype.remove=function(e){delete this.cacheEntries[e.toString()]},e.prototype.findValue=function(e){for(var t=0,n=Object.keys(this.cacheEntries);t<n.length;t++){var r=n[t];if(e(this.cacheEntries[r]))return this.cacheEntries[r]}return null},e.prototype.trim=function(e){for(var t=[],n=0,r=Object.keys(this.cacheEntries);n<r.length;n++){var i=r[n];e(this.cacheEntries[i])||(t.push(this.cacheEntries[i]),delete this.cacheEntries[i])}return t},e.prototype.clear=function(){this.cacheEntries={}},e}();t.Cache=n});e(LI);LI.Cache;var FI=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var u=((n={})[4]=[237,239,139,169,121,214,74,206,163,200,39,220,213,29,33,237],n[3]=[154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149],n),w=M.get("InitializationDataGenerator"),r=function(){function P(e){this.initDatas=[];for(var t=[],n={},r=0,i=e.periods.contents;r<i.length;r++)for(var o=0,a=i[r].streams;o<a.length;o++){var s=a[o],l=[],u=0;if(null!=s.contentProtections&&0!==s.contentProtections.length){for(var c=[],d={},p=0,f=s.contentProtections;p<f.length;p++){var h=f[p];null!=h.keyId&&(n[h.keyId]=!0);var m=h.pssh;if(!(null==m||-1<t.indexOf(m)))null!=(b=P.createPsshRaw(h))&&(t.push(m),c.push(b),d[h.scheme]=!0)}var y=d[4],g=d[3];if(!0===y&&!0===g){for(var v=0,S=c;v<S.length;v++){var b=S[v];l.push(b),u+=b.byteLength}var T=P.aggregateData(l,u);null!=T&&this.initDatas.push(T)}else 0<Object.keys(d).length&&w.warn("Ignoring all ContentProtection headers. hasValidWidevinePssh:"+y+", hasValidPlayReadyPssh:"+g)}}this.keyIds=Object.keys(n)}return P.prototype.getInitializationData=function(){return this.initDatas},P.aggregateData=function(e,t){if(0===t)return null;t<0&&w.warn("[neguintarray] Creating a new Uint8Array for aggregateInitData of size: "+t);for(var n=new Uint8Array(t),r=0,i=0,o=e;i<o.length;i++){var a=o[i];n.set(a,r),r+=a.byteLength}return n},P.createPsshRaw=function(e){var t=e.pssh;if(null==t)return null;var n=tb.decode(t);try{var r=new DataView(n.buffer,n.byteOffset,n.byteLength),i=r.getUint32(0),o=r.getUint32(4);if(i===n.byteLength&&1886614376===o)return n}catch(e){w.error(e)}if(3===e.scheme&&!1===this.validateManifestPlayReadyPSSH(n))return null;var a=32+n.byteLength,s=new Uint8Array(a),l=new DataView(s.buffer,s.byteOffset,s.byteLength);return l.setUint32(0,a),l.setUint32(4,1886614376),s.set(u[e.scheme],12),l.setUint32(28,n.byteLength),s.set(n,32),s},P.validateManifestPlayReadyPSSH=function(e){try{var t=new DataView(e.buffer,e.byteOffset,e.byteLength),n=t.getUint32(0,!0);if(n!==e.byteLength)return w.warn("Manifest PSSH data size ("+e.byteLength+") does not match expected size ("+n+") for PlayReady Header Object. Ignoring."),!1;var r=t.getUint16(4,!0);if(r<=0)return w.warn("Manifest PSSH data has invalid record count ("+r+"). Ignoring."),!1;for(var i=6,o=0,a=!1,s=r;0<s;s--){if(i+4>e.byteLength)return w.warn("Manifest PSSH data is malformed. Need to read "+s+" more records, but not enough data left ("+(e.byteLength-i)+" bytes). Ignoring."),!1;var l=t.getUint16(i,!0);if(1===l&&(a=!0),1!==l&&3!==l)return w.warn("Manifest PSSH data has invalid record type ("+l+"), or the last record length ("+o+") is wrong. Ignoring."),!1;i+=4+(o=t.getUint16(i+2,!0))}return!1===a?(w.warn("Manifest PSSH data has no type 1 record. Ignoring."),!1):i===e.byteLength||(w.warn("Manifest PSSH data is malformed. Ignoring."),!1)}catch(e){return w.error(e),!1}},P}();t.InitializationDataGenerator=r});e(FI);FI.InitializationDataGenerator;var DI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.queue=[],this.hasOpenSlotsCallback=new Dt.MulticastCallback}return e.prototype.peekHead=function(){return xt.withDefault(this.queue[0],null)},e.prototype.peekTail=function(){return 0<this.queue.length?this.queue[this.queue.length-1]:null},e.prototype.clear=function(){this.queue=[]},e.prototype.take=function(){var e=xt.withDefault(this.queue.shift(),null);return 2===this.queue.length&&this.hasOpenSlotsCallback.invoke(),e},e.prototype.isFull=function(){return 3===this.queue.length},e.prototype.offer=function(e){return!(3<=this.queue.length)&&(this.queue.push(e),!0)},e.prototype.forEach=function(e){for(var t=0,n=this.queue;t<n.length;t++){e(n[t])}},e.prototype.onHasSlot=function(e){this.hasOpenSlotsCallback.add(e)},e.prototype.offHasSlot=function(e){this.hasOpenSlotsCallback.remove(e)},e}();t.Queue=n});e(DI);DI.Queue;var NI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i={66:"Baseline",77:"Main",100:"High"},n=function(){function e(){}return e.prototype.parseProfile=function(e){var t=0;if(1===e.length){var n=e[0],r=n.substring(0,2);n.substring(2,4),n.substring(4);t=parseInt(r,16)}else if(1<e.length){r=e[0],e[1],e.slice(2);t=parseInt(r)}return i[t]},e}();t.AvcProfileParser=n});e(NI);NI.AvcProfileParser;var UI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={dtr:"dvhe.dtr","04":"dvhe.dtr",stn:"dvhe.stn","05":"dvhe.stn",dtb:"dvhe.dtb","07":"dvhe.dtb",st:"dvhe.st","08":"dvhe.st",se:"dvav.se","09":"dvav.se"},r=function(){function e(){}return e.prototype.parseProfile=function(e){if(1<=e.length){var t=e[0];e[1],e.slice(2);return n[t]}},e}();t.DvheProfileParser=r});e(UI);UI.DvheProfileParser;var BI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.parseProfile=function(e){if(!(e.length<3)){var t=e[0],n=e[1],r=(e[2],e.slice(3),t),i=t.charAt(0);"A"!==i&&"B"!==i&&"C"!==i||(r=t.substring(1));var o,a=parseInt(r),s=parseInt(n,16);return 2!==a&&0==(4&s)||(o="Main10"),1!==a&&0==(2&s)||(o="Main"),null!=o?o:void 0}},e}();t.HevcProfileParser=n});e(BI);BI.HevcProfileParser;var VI=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var i={mp4a:"AACL","ec-3":"EAC3"},o={hev1:"HEVC",hvc1:"HEVC",avc1:"AVC",dvhe:"DVHE"},a=((n={}).AVC=new NI.AvcProfileParser,n.DVHE=new UI.DvheProfileParser,n.HEVC=new BI.HevcProfileParser,n),r=function(){function e(){}return e.parseAudioCodec=function(e){var t=e.split("."),n=t[0],r=(t.slice(1),i[n]);return null==r?null:{codec:r}},e.parseVideoCodec=function(e){var t=e.split("."),n=t[0],r=t.slice(1),i=o[n];return null==i?null:{codec:i,profile:a[i].parseProfile(r)}},e}();t.CodecParser=r});e(VI);VI.CodecParser;var jI=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodecParser=VI.CodecParser});e(jI);jI.CodecParser;var XI,zI,qI={headerAlignment:1,cellAlignment:0,columnSeparator:"|",headerSeparator:"-"},WI=function(){function e(e){void 0===e&&(e=qI),this.rows=[],this.maxColumnsWidth={},this.config=e}return e.prototype.renderString=function(){if(0===this.rows.length)return"";if(null==this.headers)throw new Error("this.headers is undefined");var e=[];this.renderHeader(e),this.renderLineSeparator(e,this.config.headerSeparator);for(var t=0,n=this.rows;t<n.length;t++){var r=n[t];this.renderRow(e,r),this.renderLineSeparator(e,this.config.rowSeparator)}return e.join("")},Object.defineProperty(e.prototype,"hasHeaders",{get:function(){return null!=this.headers},enumerable:!0,configurable:!0}),e.prototype.setHeaders=function(e){if(null!=this.headers)throw new Error("this.headers is already defined");this.headers=e;for(var t=0,n=this.headers;t<n.length;t++){var r=n[t];this.maxColumnsWidth[r]=r.length+2}},e.prototype.addRowString=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];null!=this.maxColumnsWidth[r]&&(this.maxColumnsWidth[r]=Math.max(this.maxColumnsWidth[r],e[r].length+2))}this.rows.push(e)},e.prototype.renderHeader=function(e){for(var t=0,n=this.headers;t<n.length;t++){var r=n[t],i=this.maxColumnsWidth[r]-(r.length+2),o=this.getLeftPadding(this.config.headerAlignment,i),a=this.getRightPadding(this.config.headerAlignment,i);e.push(this.repeat(" ",o)),e.push(r),e.push(this.repeat(" ",a))}e.push("\n")},e.prototype.renderRow=function(e,t){for(var n=0,r=this.headers;n<r.length;n++){var i=r[n],o=this.maxColumnsWidth[i]-(t[i].length+2),a=this.getLeftPadding(this.config.cellAlignment,o),s=this.getRightPadding(this.config.cellAlignment,o);e.push(this.repeat(" ",a)),e.push(t[i]),e.push(this.repeat(" ",s))}e.push("\n")},e.prototype.renderLineSeparator=function(e,t){if(null!=t){var n=F.values(this.maxColumnsWidth).reduce(function(e,t){return e+t},0);e.push(this.repeat(t,n)),e.push("\n")}},e.prototype.getLeftPadding=function(e,t){switch(e){case 1:return t/2+1;case 0:return 1;case 2:return t+1}},e.prototype.getRightPadding=function(e,t){switch(e){case 1:return t%2==0?t/2+1:t/2+2;case 0:return t+1;case 2:return 1}},e.prototype.repeat=function(e,t){return t=Math.floor(t),0===e.length?"":t<=0?"":1===t?e:new Array(t+1).join(e)},e}(),HI=V&&V.__extends||(XI=function(e,t){return(XI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}XI(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),GI=function(t){function e(e){return t.call(this,e)||this}return HI(e,t),e.prototype.addRow=function(e){for(var t={},n=Object.keys(e),r=0,i=n;r<i.length;r++){var o=i[r];"string"==typeof e[o]?t[o]=e[o]:t[o]=""+e[o]}this.hasHeaders||this.setHeaders(n),this.addRowString(t)},e}(WI),KI=V&&V.__extends||(zI=function(e,t){return(zI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}zI(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),QI={TableFormatterGeneric:GI,TableFormatterArray:function(r){function e(e,t){var n=r.call(this,t)||this;return n.setHeaders(e),n}return KI(e,r),e.prototype.addRow=function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];"string"==typeof e[i]?t[i]=e[i]:t[i]=""+e[i]}this.addRowString(t)},e}(WI)},YI=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("AudioStreamAlternator"),v=["EAC3","AACL"],r=function(){function e(e){void 0===e&&(e={}),this.allPeriodAudioStreams=[],this.isInitialized=!1,this.unsupportedCodecs=[],this.config=n({},e)}return e.prototype.initialize=function(e){var i=this;if(null==this.config.audio||F.isEmpty(this.config.audio)){for(var t=[],n=0,r=e;n<r.length;n++){var o=r[n];if(0!==o.length){var a=o.filter(function(e){for(var t=0,n=i.unsupportedCodecs;t<n.length;t++){var r=n[t];if(-1!==e.qualityLevels[0].codecs.indexOf(r))return!1}return!0});t.push(a)}}for(var s=t.map(function(e){return i.createPrioritizedMatchers(e)}),l=[],u=function(t){s.every(function(e){return e.some(function(e){return F.isEqual(t,e)})})&&l.push(t)},c=0,d=s[0];c<d.length;c++){u(d[c])}this.allPeriodAudioStreams=e,this.config.audio=l}},e.prototype.selectStream=function(e){var t=e;if(!this.isInitialized){var n=this.getStreamMatcher(t);null!=n&&(this.streamFilterFunction=this.getStreamFilterFunction(n)),this.isInitialized=!0}return null!=this.streamFilterFunction?this.streamFilterFunction(t):null},e.prototype.setUnsupportedCodecs=function(e){this.unsupportedCodecs=e,0!==this.allPeriodAudioStreams.length&&(this.uninitialize(),this.initialize(this.allPeriodAudioStreams))},e.prototype.uninitialize=function(){this.config.audio=void 0,this.isInitialized=!1},e.prototype.getStreamMatcher=function(r){for(var i=this.getAvailableCodecs(r),e=function(n){for(var e=0,t=r;e<t.length;e++){if(t[e].qualityLevels.some(function(e){if(null==e.samplingRate)return!1;var t=jI.CodecParser.parseAudioCodec(e.codecs);return null!=t&&(t.codec===n.codec&&e.samplingRate===n.samplingRate)}))return a.info("Audio matcher function was set with codec ["+n.codec+"] and sampling rate ["+n.samplingRate+"] out of "+JSON.stringify(i)),{value:n}}},t=0,n=this.config.audio;t<n.length;t++){var o=e(n[t]);if("object"==typeof o)return o.value}return null},e.prototype.createPrioritizedMatchers=function(e){for(var t=[],n=[],r=0,i=e;r<i.length;r++)for(var o=0,a=i[r].qualityLevels;o<a.length;o++){var s=a[o];if(null!=s.samplingRate){var l=jI.CodecParser.parseAudioCodec(s.codecs);null!=l&&(-1===t.indexOf(l.codec)&&t.push(l.codec),-1===n.indexOf(s.samplingRate)&&n.push(s.samplingRate))}}for(var u=F.intersection(v,t),c=F.sortBy(n).reverse(),d=[],p=0,f=u;p<f.length;p++)for(var h=f[p],m=0,y=c;m<y.length;m++){var g=y[m];d.push({codec:h,samplingRate:g})}return d},e.prototype.getAvailableCodecs=function(e){for(var r=[],t=0,n=e;t<n.length;t++)for(var i=function(t){if(null==t.samplingRate)return"continue";var n=jI.CodecParser.parseAudioCodec(t.codecs);if(null==n)return"continue";r.some(function(e){return e.codec===n.codec&&e.samplingRate===t.samplingRate})||r.push({codec:n.codec,samplingRate:t.samplingRate})},o=0,a=n[t].qualityLevels;o<a.length;o++){i(a[o])}return r},e.prototype.getStreamFilterFunction=function(i){return function(e){var t=new QI.TableFormatterGeneric,n=e.filter(function(e){return r=t,(n=e).qualityLevels.some(function(e){var t=jI.CodecParser.parseAudioCodec(e.codecs);return null!=t&&(r.addRow({streamId:n.id,language:n.language,streamCodecs:e.codecs,codec:t.codec,samplingRate:e.samplingRate,bandwidth:e.bandwidth}),t.codec===i.codec&&e.samplingRate===i.samplingRate)});var n,r});return F.isEmpty(n)?(a.warn("Could not find an Audio stream for codec ["+i.codec+"], sampling rate: ["+i.samplingRate+"]"),F.isEmpty(e)?a.warn("Empty AudioStreams!"):a.warn("Available streams:\n",t.renderString()),null):F.max(n,function(e){return F.max(e.qualityLevels,function(e){return e.bandwidth}).bandwidth})}},e}();t.AudioStreamAlternator=r});e(YI);YI.AudioStreamAlternator;var JI=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("TimedTextStreamAlternator"),r=function(){function e(e){void 0===e&&(e={}),this.isInitialized=!1,this.unsupportedCodecs=[],this.config=n({},e)}return e.prototype.initialize=function(e){},e.prototype.selectStream=function(e){if(F.isEmpty(e))return null;var t=e;if(!this.isInitialized){var n=this.getStreamMatcher(t);null!=n&&(this.streamFilterFunction=this.getStreamFilterFunction(n)),this.isInitialized=!0}return null!=this.streamFilterFunction?this.streamFilterFunction(t):null},e.prototype.setUnsupportedCodecs=function(e){this.unsupportedCodecs=e},e.prototype.uninitialize=function(){this.config.timedText=void 0,this.isInitialized=!1},e.prototype.getStreamMatcher=function(r){if(null==this.config.timedText)return{codecs:r[0].qualityLevels[0].codecs};for(var e=function(t){for(var e=0,n=r;e<n.length;e++){if(n[e].qualityLevels.some(function(e){return e.codecs===t.codec}))return{value:{codecs:t.codec}}}},t=0,n=this.config.timedText;t<n.length;t++){var i=e(n[t]);if("object"==typeof i)return i.value}return null},e.prototype.getStreamFilterFunction=function(n){var r=function(e){return e.qualityLevels.some(function(e){return F.isMatch(e,n)})};return i.info("TimedTextQualityLevelMatcher was set to: "+JSON.stringify(n)),function(e){var t=e.filter(r);return F.isEmpty(t)?(i.warn("Could not find an TimedText stream for codec ["+JSON.stringify(n.codecs)+"]"),null):t[0]}},e}();t.TimedTextStreamAlternator=r});e(JI);JI.TimedTextStreamAlternator;var $I=t(function(e,t){var n,s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("VideoStreamAlternator"),l=["DVHE","HEVC","AVC"],u=["dvhe.dtr","dvhe.stn","dvhe.dtb","dvhe.st","Main10","High","Main","Baseline"],c=((n={}).DVHE=["dvhe.dtr","dvhe.stn","dvhe.dtb","dvhe.st"],n.HEVC=["Main10","Main"],n.AVC=["High","Main","Baseline"],n),r=function(){function e(e){if(void 0===e&&(e={}),this.isInitialized=!1,this.unsupportedCodecs=[],this.config=s({},e),null==this.config.video){this.config.video=[];for(var t=0,n=l;t<n.length;t++)for(var r=n[t],i=0,o=u;i<o.length;i++){var a=o[i];F.contains(c[r],a)&&this.config.video.push({codec:r,codecProfile:a})}}}return e.prototype.initialize=function(e){},e.prototype.selectStream=function(e){var t=e;if(!this.isInitialized){var n=this.getStreamMatcher(t);null!=n&&(this.streamFilterFunction=this.getStreamFilterFunction(n)),this.isInitialized=!0}return null!=this.streamFilterFunction?this.streamFilterFunction(t):null},e.prototype.setUnsupportedCodecs=function(e){this.unsupportedCodecs=e},e.prototype.uninitialize=function(){this.isInitialized=!1},e.prototype.getStreamMatcher=function(r){for(var e=function(n){for(var e=0,t=r;e<t.length;e++){if(t[e].qualityLevels.some(function(e){var t=jI.CodecParser.parseVideoCodec(e.codecs);return null!=t&&null!=t.profile&&(t.codec===n.codec&&t.profile===n.codecProfile)}))return{value:n}}},t=0,n=this.config.video;t<n.length;t++){var i=e(n[t]);if("object"==typeof i)return i.value}return null},e.prototype.getStreamFilterFunction=function(n){i.info("Video matcher function was set with codec ["+n.codec+"] and codec profile ["+n.codecProfile+"]");var r=function(e){return e.qualityLevels.some(function(e){var t=jI.CodecParser.parseVideoCodec(e.codecs);return null==t||null==t.profile?(i.warn("Video stream doesn't match: videoCodecParserResult is ["+JSON.stringify(t)+"]"),!1):t.codec===n.codec&&t.profile===n.codecProfile})};return function(e){var t=e.filter(r);return F.isEmpty(t)?(i.warn("Could not find an Video stream for codec ["+n.codec+"], codec profile: ["+n.codecProfile+"]"),null):F.max(t,function(e){return F.max(e.qualityLevels,function(e){return e.bandwidth}).bandwidth})}},e}();t.VideoStreamAlternator=r});e($I);$I.VideoStreamAlternator;var ZI=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={}).Audio=YI.AudioStreamAlternator,n.TimedText=JI.TimedTextStreamAlternator,n.Video=$I.VideoStreamAlternator,n);t.streamAlternatorTypeMap=r});e(ZI);ZI.streamAlternatorTypeMap;var eE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=[{subtype:"Dialog"},{subtype:"Descriptive"},{subtype:"Commentary"}],n=(M.get("AudioStreamSelector"),function(){function e(e){void 0===e&&(e=[]),this.fallbackLanguageStreamMatchers=e}return e.prototype.selectStreams=function(e,t){if(void 0===t&&(t=[]),F.isEmpty(e))return[];var n=this.filterByMatchers(e,t);if(F.isEmpty(n)&&(n=this.filterByMatchers(e,this.fallbackLanguageStreamMatchers)),F.isEmpty(n)&&(n=e),n=this.filterByMatchers(n,i),!F.isEmpty(n)){var r=[{language:n[0].language}];n=this.filterByMatchers(n,r)}return n},e.prototype.filterByMatchers=function(n,e){var r=this;if(F.isEmpty(e))return[];for(var t=function(t){var e=n.filter(function(e){return r.isMatch(e,t)});if(!F.isEmpty(e))return{value:e}},i=0,o=e;i<o.length;i++){var a=t(o[i]);if("object"==typeof a)return a.value}return[]},e.prototype.isMatch=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];if(e[i]!==t[i]){if("language"!==i)return!1;if(F.isString(e[i])&&F.isString(t[i])){var o=e[i],a=t[i];if(!(0===o.toLowerCase().indexOf(a)))return!1}}}return!0},e}());t.AudioStreamSelector=n});e(eE);eE.AudioStreamSelector;var tE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=[{textType:"Subtitle"},{textType:"Mandatory"}],n=(M.get("TimedTextStreamSelector"),function(){function e(e){void 0===e&&(e=[]),this.fallbackLanguageStreamMatchers=e}return e.prototype.selectStreams=function(e,t){if(void 0===t&&(t=[]),F.isEmpty(e))return[];var n=this.filterByMatchers(e,t);if(!F.isEmpty(n)){var r=this.filterByMatchers(n,d);F.isEmpty(r)||(n=r)}if(!F.isEmpty(n)){var i=this.filterByMatchers(n,this.fallbackLanguageStreamMatchers);F.isEmpty(i)||(n=i)}if(F.isEmpty(n)){for(var o=[],a=0,s=this.fallbackLanguageStreamMatchers;a<s.length;a++){var l=s[a],u=F.extend({},l,{textType:"Mandatory"});o.push(u)}o.push({textType:"Mandatory"}),n=this.filterByMatchers(e,o)}if(!F.isEmpty(n)){var c=[{language:n[0].language}];n=this.filterByMatchers(n,c)}return n},e.prototype.filterByMatchers=function(n,e){var r=this;if(F.isEmpty(e))return[];for(var t=function(t){var e=n.filter(function(e){return r.isMatch(e,t)});if(!F.isEmpty(e))return{value:e}},i=0,o=e;i<o.length;i++){var a=t(o[i]);if("object"==typeof a)return a.value}return[]},e.prototype.isMatch=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];if(e[i]!==t[i]){if("language"!==i)return!1;if(F.isString(e[i])&&F.isString(t[i])){var o=e[i],a=t[i];if(!(0===o.toLowerCase().indexOf(a)))return!1}}}return!0},e}());t.TimedTextStreamSelector=n});e(tE);tE.TimedTextStreamSelector;var nE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("VideoStreamSelector");var n=function(){function e(){}return e.prototype.selectStreams=function(e,t){if(void 0===t&&(t=[]),F.isEmpty(e))return[];var n=this.filterByMatchers(e,t);return F.isEmpty(n)&&(n=e),n},e.prototype.filterByMatchers=function(n,e){var r=this;if(F.isEmpty(e))return[];for(var t=function(t){var e=n.filter(function(e){return r.isMatch(e,t)});if(!F.isEmpty(e))return{value:e}},i=0,o=e;i<o.length;i++){var a=t(o[i]);if("object"==typeof a)return a.value}return[]},e.prototype.isMatch=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];if(e[i]!==t[i])return!1}return!0},e}();t.VideoStreamSelector=n});e(nE);nE.VideoStreamSelector;var rE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.eventEmitter=new Dt.EventEmitter,this.matchers=e,this.audioStreamSelector=new eE.AudioStreamSelector(t.Audio),this.timedTextStreamSelector=new tE.TimedTextStreamSelector(t.TimedText),this.videoStreamSelector=new nE.VideoStreamSelector}return e.prototype.setMatchers=function(e,t){this.matchers[e]=t,this.eventEmitter.emit(e)},e.prototype.onMatcherChange=function(e,t){this.eventEmitter.on(e,t)},e.prototype.offMatcherChange=function(e,t){this.eventEmitter.off(e,t)},e.prototype.selectStreams=function(e,t){var n=e.streams.filter(function(e){return e.type===t});if(F.isEmpty(n))return[];switch(t){case"Audio":return this.audioStreamSelector.selectStreams(n,this.matchers[t]);case"TimedText":return this.timedTextStreamSelector.selectStreams(n,this.matchers[t]);case"Video":return this.videoStreamSelector.selectStreams(n,this.matchers[t])}},e}();t.StreamSelector=n});e(rE);rE.StreamSelector;var iE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CRITICAL_STREAM_TYPES=OI.CRITICAL_STREAM_TYPES,t.Cache=LI.Cache,t.InitializationDataGenerator=FI.InitializationDataGenerator,t.Queue=DI.Queue,t.streamAlternatorTypeMap=ZI.streamAlternatorTypeMap,t.StreamSelector=rE.StreamSelector});e(iE);iE.CRITICAL_STREAM_TYPES,iE.Cache,iE.InitializationDataGenerator,iE.Queue,iE.streamAlternatorTypeMap,iE.StreamSelector;var oE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.MAX_AUDIO_BANDWIDTH_BPS=449e3}return e.prototype.isQualityLevelSupported=function(e,t){if("Audio"===e.type){var n=jI.CodecParser.parseAudioCodec(t.codecs);if(192e3===t.bandwidth&&null!=n&&"AACL"===n.codec)return!1;if(t.bandwidth>=this.MAX_AUDIO_BANDWIDTH_BPS)return!1}return!0},e}();t.AudioQualityLevelFilter=n});e(oE);oE.AudioQualityLevelFilter;var aE=t(function(e,t){function o(e,t,n,r,i,o){return void 0===o&&(o=""),"segment_data_"+e+"_"+t+"_"+n+"_"+r+(null!=i?"_"+i.start+"-"+i.end:"")+o}Object.defineProperty(t,"__esModule",{value:!0}),t.createLocalStorageSegmentId=function(e,t,n,r,i){return null!=i.byteRange?o(e,t,n,r,i.byteRange):"segment_data_"+e+"_"+t+"_"+n+"_"+r+(i.isInitSegment?"_init":"_"+i.index)},t.createLocalStorageSegmentIdWithByteRange=o});e(aE);aE.createLocalStorageSegmentId,aE.createLocalStorageSegmentIdWithByteRange;var sE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=["Chrome","Firefox","Firefox64"],n=function(){function n(){}return n.createW3CNativeMediaDecodingConfiguration=function(e){return F.extend({type:"media-source"},e,null!=e.video?{video:F.extend(e.video,{framerate:Rp.stringToNumber(e.video.framerate)})}:{})},n.prototype.decodingInfo=function(e){var t=navigator.mediaCapabilities;return this.resolutionSupported(e)&&this.framerateSupported(e)?null!=t?t.decodingInfo(n.createW3CNativeMediaDecodingConfiguration(e)).then(function(e){return e.supported&&e.smooth}):Fe.Promise.resolve(this.isConfigurationSupportedByMediaSource(e)):Fe.Promise.resolve(!1)},n.prototype.isConfigurationSupportedByMediaSource=function(e){if(null!=e.video&&30<Rp.stringToNumber(e.video.framerate))return!1;var t=null==e.video||MediaSource.isTypeSupported(e.video.contentType),n=null==e.audio||MediaSource.isTypeSupported(e.audio.contentType);return t&&n},n.prototype.resolutionSupported=function(e){return null==e.video||e.video.height<=1080&&e.video.width<=1920},n.prototype.framerateSupported=function(e){if(null==e.video)return!0;var t=Rp.stringToNumber(e.video.framerate);if(null==t||isNaN(t)||t<=30)return!0;var n=Yh.deviceInformation.software,r=n.operatingSystem;return"Windows"===r.name&&"10.0"===r.version&&null!=n.middleware&&F.contains(i,n.middleware.name)},n}();t.MediaCapabilitiesWeb=n});e(sE);sE.MediaCapabilitiesWeb;var lE,uE,cE=M.get("MimeTypeParser");(uE=lE||(lE={}))[uE.ParsingType=0]="ParsingType",uE[uE.ParsingSubtype=1]="ParsingSubtype",uE[uE.ParsingParameterName=2]="ParsingParameterName",uE[uE.StartParsingParameterValue=3]="StartParsingParameterValue",uE[uE.ParsingUnquotedParameterValue=4]="ParsingUnquotedParameterValue",uE[uE.ParsingQuotedParameterValue=5]="ParsingQuotedParameterValue",uE[uE.CompleteParsingParameterValue=6]="CompleteParsingParameterValue",uE[uE.FinishParsingNoPendingParameter=7]="FinishParsingNoPendingParameter";var dE={MimeTypeParser:function(){function e(){}return e.prototype.parse=function(e){var t={text:e,index:0,parameterName:"",parameterValue:"",mimeTypeObject:{type:"",subtype:"",parameters:{}}};return this.parseMimeType(t)},e.prototype.parseMimeType=function(e){for(var t=lE.ParsingType;e.index<e.text.length;)switch(t){case lE.ParsingType:t=this.parseType(e);break;case lE.ParsingSubtype:t=this.parseSubtype(e);break;case lE.ParsingParameterName:t=this.parseParameterName(e);break;case lE.StartParsingParameterValue:t=this.handleStartParsingParameterValue(e);break;case lE.CompleteParsingParameterValue:t=this.handleCompleteParsingParameterValue(e)}return this.handleEndParsing(e,t),e.mimeTypeObject},e.prototype.parseType=function(e){var t=e.text.indexOf("/");if(0<t)return e.mimeTypeObject.type=e.text.substring(e.index,t).trim(),e.index=t+1,lE.ParsingSubtype;throw new Error("Encountered malformed top type while parsing \""+e.text.substring(e.index)+"\".")},e.prototype.parseSubtype=function(e){var t=e.text.indexOf(";",e.index);return 0<t?(e.mimeTypeObject.subtype=this.extractSubtype(e,t),e.index=t+1,lE.ParsingParameterName):(e.mimeTypeObject.subtype=this.extractSubtype(e),e.index=e.text.length,lE.FinishParsingNoPendingParameter)},e.prototype.extractSubtype=function(e,t){var n=e.text.substring(e.index,t).trim();if(0===n.length)throw new Error("Encountered empty subtype while parsing \""+e.text.substring(e.index)+"\".");return n},e.prototype.parseParameterName=function(e){var t=e.text.indexOf("=",e.index);return t>e.index?(e.parameterName=this.extractParameterName(e,t),0===e.parameterName.length?(e.index=e.text.length,lE.FinishParsingNoPendingParameter):(e.index=t+1,lE.StartParsingParameterValue)):(cE.warn("Encountered malformed parameter name while parsing \""+e.text.substring(e.index)+"\"."),e.index=e.text.length,lE.FinishParsingNoPendingParameter)},e.prototype.extractParameterName=function(e,t){var n=e.text.substring(e.index,t).trim();return 0===n.length?(cE.warn("Encountered empty parameter name while parsing \""+e.text.substring(e.index)+"\"."),n):-1!==n.indexOf(";")?(cE.warn("Encountered malformed parameter name while parsing \""+e.text.substring(e.index)+"\"."),""):n},e.prototype.handleStartParsingParameterValue=function(e){if("\""===e.text[e.index]){e.index++;var t=e.text.indexOf("\"",e.index);return t>=e.index?(e.parameterValue=e.text.substring(e.index,t),e.index=t+1,lE.CompleteParsingParameterValue):(cE.warn("Encountered unbalanced quotation when parsing \""+e.text.substring(e.index)+"\"."),lE.StartParsingParameterValue)}var n=e.text.indexOf(";",e.index);return n<0&&(n=e.text.length),e.parameterValue=this.extractUnquotedParameterValue(e,n),e.index=n,lE.CompleteParsingParameterValue},e.prototype.extractUnquotedParameterValue=function(e,t){var n=e.text.substring(e.index,t).trim();return 0===n.length&&(cE.warn("Encountered empty parameter value while parsing \""+e.text.substring(e.index)+"\"."),n=""),n},e.prototype.handleCompleteParsingParameterValue=function(e){var t=e.text.indexOf(";",e.index);if(t===e.index)return this.commitNameValuePair(e),e.index++,lE.ParsingParameterName;if(t<0&&0===e.text.substring(e.index).trim().length)return this.commitNameValuePair(e),e.index=e.text.length,lE.FinishParsingNoPendingParameter;throw new Error("Expected character: \";\", but encountered: \""+e.text[e.index]+"\", when completing parsing of a parameter value of text \""+e.text+"\".")},e.prototype.handleEndParsing=function(e,t){switch(t){case lE.CompleteParsingParameterValue:this.commitNameValuePair(e);break;case lE.StartParsingParameterValue:e.parameterValue="",this.commitNameValuePair(e);break;case lE.FinishParsingNoPendingParameter:case lE.ParsingParameterName:break;default:throw new Error("Ended in an invalid state: "+lE[t]+", when parsing MIME type \""+e.text+"\".")}},e.prototype.commitNameValuePair=function(e){e.mimeTypeObject.parameters[e.parameterName]=e.parameterValue},e}()},pE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.mediaCapabilitiesWeb=new sE.MediaCapabilitiesWeb}return e.prototype.decodingInfo=function(n){var r=this;return Fe.Promise.resolve().then(function(){if(xt.exists(n.video)){var e=(new dE.MimeTypeParser).parse(n.video.contentType).parameters.codecs,t=jI.CodecParser.parseVideoCodec(e);if(null!==t&&"HEVC"===t.codec)return!1}return r.mediaCapabilitiesWeb.decodingInfo(n)})},e}();t.HevcBlockingMediaCapabilities=n});e(pE);pE.HevcBlockingMediaCapabilities;var fE=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.decodingInfo=function(t){var e=navigator.mediaCapabilities;return this.resolutionSupported(t)&&this.framerateSupported(t)?null!=e?e.decodingInfo(sE.MediaCapabilitiesWeb.createW3CNativeMediaDecodingConfiguration(t)).then(function(e){return e.supported&&(null!=t.audio||e.smooth)}):Fe.Promise.resolve(this.isConfigurationSupportedByMediaSource(t)):Fe.Promise.resolve(!1)},t}(sE.MediaCapabilitiesWeb);t.SafariMediaCapabilities=i});e(fE);fE.SafariMediaCapabilities;var hE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=Xh.getBrowser().getType();t.mediaCapabilities=n,r===Xh.BrowserType.Edge||r===Xh.BrowserType.EdgeNext?t.mediaCapabilities=n=!0===sp.QueryString.getParameter("enableHevc")?new sE.MediaCapabilitiesWeb:new pE.HevcBlockingMediaCapabilities:r===Xh.BrowserType.Safari?t.mediaCapabilities=n=new fE.SafariMediaCapabilities:t.mediaCapabilities=n=new sE.MediaCapabilitiesWeb});e(hE);hE.mediaCapabilities;var mE=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={}).AACL="AAC",n.EAC3="EC3",n),i={buildMediaDecodingConfiguration:function(e,t){return{audio:{contentType:e+"; codecs=\""+t.codecs+"\"",bitrate:t.bandwidth,samplerate:t.samplingRate}}},buildBlocklistItem:function(e){return{bandwidth:e.bandwidth,codecs:e.codecs,samplingRate:e.samplingRate}},isQualityLevelBlocklisted:function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i.bandwidth===e.bandwidth&&i.codecs===e.codecs&&i.samplingRate===e.samplingRate)return!0}return!1},generateKey:function(e,t){return[e,t.codecs,t.bandwidth,t.samplingRate].join("_")},getConfigurationStoreBlocklist:function(e){if(null==up.configurationStore.configuration||null==up.configurationStore.configuration.capabilities||null==up.configurationStore.configuration.capabilities.codecBlocklist||F.isEmpty(up.configurationStore.configuration.capabilities.codecBlocklist.Audio))return[];var n=up.configurationStore.configuration.capabilities.codecBlocklist.Audio;return e.qualityLevels.filter(function(e){var t=jI.CodecParser.parseAudioCodec(e.codecs);return null!=t&&F.contains(n,r[t.codec])}).map(function(e){return{codecs:e.codecs,bandwidth:e.bandwidth,samplingRate:e.samplingRate}})}};t.AudioStreamFilterHelper=i});e(mE);mE.AudioStreamFilterHelper;var yE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=90,r=160,i="24",o={buildMediaDecodingConfiguration:function(e,t){return{video:{contentType:e+"; codecs=\""+t.codecs+"\"",width:xt.withDefault(t.width,n),height:xt.withDefault(t.height,r),framerate:xt.withDefault(t.frameRate,i),bitrate:t.bandwidth}}},buildBlocklistItem:function(e){return{bandwidth:e.bandwidth,codecs:e.codecs,height:e.height,width:e.width,frameRate:e.frameRate}},isQualityLevelBlocklisted:function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i.bandwidth===e.bandwidth&&i.codecs===e.codecs&&i.height===e.height&&i.width===e.width&&i.frameRate===e.frameRate)return!0}return!1},generateKey:function(e,t){return[e,t.codecs,t.bandwidth,t.height,t.width,t.frameRate].join("_")},getConfigurationStoreBlocklist:function(e){return[]}};t.VideoStreamFilterHelper=o});e(yE);yE.VideoStreamFilterHelper;var gE=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={}).Audio=mE.AudioStreamFilterHelper,n.Video=yE.VideoStreamFilterHelper,n.TimedText=null,n);t.STREAM_FILTER_HELPER_MAP=r});e(gE);gE.STREAM_FILTER_HELPER_MAP;var vE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=M.get("MediaCapabilitiesFilter");function u(e){for(var t=0,n=Object.keys(e);t<n.length;t++){if(0!==e[n[t]].length)return!1}return!0}var n=function(){function n(){var e,i=this;this.blocklists=((e={}).Audio={},e.Video={},e.TimedText={},e),this.requestedChecks={},this.isQualityLevelSupported=function(e,t){var n=i.blocklists[e.type][e.mimeType],r=gE.STREAM_FILTER_HELPER_MAP[e.type];return!(null!=n&&!F.isEmpty(n)&&null!=r)||!r.isQualityLevelBlocklisted(t,n)}}return n.create=function(e){var t=new n;return t.initialize(e).then(function(){return t})},n.prototype.initialize=function(e){for(var n=this,r=Date.now(),t=[],i=0,o=e.periods.contents;i<o.length;i++)for(var a=0,s=o[i].streams;a<s.length;a++){var l=s[a];t.push(this.checkStream(l))}return Fe.Promise.all(t).then(function(){var e,t=Date.now()-r;MT.metrics.putMetric("Filter.MediaCapabilities.Time",t,"ms"),250<t&&d.warn("Excessive filter time: "+t+"ms"),u((e=n.blocklists).Audio)&&u(e.Video)&&u(e.TimedText)||d.warn("Blocklists: "+JSON.stringify(n.blocklists))})},n.prototype.checkStream=function(l){var u=this,c=gE.STREAM_FILTER_HELPER_MAP[l.type];if(null==c)return Fe.Promise.resolve();for(var r=[],e=function(t){var e=c.generateKey(l.mimeType,t);if(null==i.requestedChecks[e]){var n=hE.mediaCapabilities.decodingInfo(c.buildMediaDecodingConfiguration(l.mimeType,t));i.requestedChecks[e]=n,r.push(n.then(function(e){return e?null:c.buildBlocklistItem(t)}))}},i=this,t=0,n=l.qualityLevels;t<n.length;t++){e(n[t])}return Fe.Promise.all(r).then(function(e){for(var t=u.getBlocklist(l),n=0,r=e;n<r.length;n++){null!==(s=r[n])&&t.push(s)}var i=c.getConfigurationStoreBlocklist(l);0<i.length&&d.info(i.length+" "+l.type+" quality levels have been blocklisted by configurationStore.");for(var o=0,a=i;o<a.length;o++){var s=a[o];t.push(s)}})},n.prototype.getBlocklist=function(e){var t=this.blocklists[e.type];return null==t[e.mimeType]&&(t[e.mimeType]=[]),t[e.mimeType]},n}();t.MediaCapabilitiesFilter=n});e(vE);vE.MediaCapabilitiesFilter;var SE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function i(e){this.currentValue=e}return i.for=function(e){return new i(e)},i.prototype.itemById=function(t){if(null===this.currentValue)return new i(null);var e=F.find(this.currentValue.periods.contents,function(e){return e.id===t});return new i(xt.withDefault(e,null))},i.prototype.itemByPosition=function(e){if(null===this.currentValue)return new i(null);if(F.isEmpty(this.currentValue.periods.contents)||e<this.currentValue.periods.contents[0].startMs)return new i(null);for(var t=0,n=this.currentValue.periods.contents;t<n.length;t++){var r=n[t];if(e<r.endMs)return new i(r)}return new i(null)},i.prototype.nextItem=function(t){if(null===this.currentValue)return new i(null);var e=F.findIndex(this.currentValue.periods.contents,function(e){return t.id===e.id});return new i(-1<e?xt.withDefault(this.currentValue.periods.contents[e+1],null):null)},i.prototype.previousItem=function(t){if(null===this.currentValue)return new i(null);var e=F.findIndex(this.currentValue.periods.contents,function(e){return t.id===e.id});return new i(-1<e?xt.withDefault(this.currentValue.periods.contents[e-1],null):null)},i.prototype.streamsByType=function(t){return null==this.currentValue?new i([]):(e=null==this.currentValue||F.isArray(this.currentValue)?this.currentValue:this.currentValue.streams,new i(F.filter(e,function(e){return e.type===t})));var e},i.prototype.streamById=function(t){if(null==this.currentValue)return new i(null);var e;e=null==this.currentValue||F.isArray(this.currentValue)?this.currentValue:this.currentValue.streams;var n=F.find(e,function(e){return e.id===t});return new i(xt.withDefault(n,null))},i.prototype.qualityLevelById=function(t){if(null==this.currentValue)return new i(null);var e=F.find(this.currentValue.qualityLevels,function(e){return e.id===t});return new i(xt.withDefault(e,null))},i.prototype.qualityLevelByBandwidth=function(t){if(null==this.currentValue)return new i(null);var e=F.find(this.currentValue.qualityLevels,function(e){return e.bandwidth===t});return new i(xt.withDefault(e,null))},i.prototype.first=function(){return null==this.currentValue||0===this.currentValue.length?new i(null):new i(this.currentValue[0])},i.prototype.value=function(){return xt.withDefault(this.currentValue,null)},i}();t.MediaRepresentationQuerier=n});e(SE);SE.MediaRepresentationQuerier;var bE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.contains=function(e,t){return t>=e.startTimeMs-.1&&t<e.endTimeMs},e}();t.SegmentPosition=n});e(bE);bE.SegmentPosition;var TE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AudioQualityLevelFilter=oE.AudioQualityLevelFilter,t.createLocalStorageSegmentId=aE.createLocalStorageSegmentId,t.createLocalStorageSegmentIdWithByteRange=aE.createLocalStorageSegmentIdWithByteRange,t.MediaCapabilitiesFilter=vE.MediaCapabilitiesFilter,t.MediaRepresentationQuerier=SE.MediaRepresentationQuerier,t.SegmentPosition=bE.SegmentPosition});e(TE);TE.AudioQualityLevelFilter,TE.createLocalStorageSegmentId,TE.createLocalStorageSegmentIdWithByteRange,TE.MediaCapabilitiesFilter,TE.MediaRepresentationQuerier,TE.SegmentPosition;var PE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.FragmentRequestConstants={SEGMENT_TIMEOUT_MS:4e3}});e(PE);PE.FragmentRequestConstants;var wE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=!1;try{var i=new URL("b","http://a");i.pathname="c%20d",r="http://a/c%20d"===i.href}catch(e){}if(t.URL=n,r)t.URL=n=URL;else{var y=void 0,g=/[a-zA-Z]/,v=/[a-zA-Z0-9\+\-\.]/,S={ftp:21,file:0,gopher:70,http:80,https:443,ws:80,wss:443},b={"%2e":".",".%2e":"..","%2e.":"..","%2e%2e":".."},o=function(){function r(e,t){this._isInvalid=!1,this._scheme="",this._isRelative=!1,this._query="",this._fragment="",this._schemeData="",this._host="",this._port="",this._path=[],this._username="",this._password="",this._url="",void 0===t||t instanceof r||(t=new r(String(t))),this._url=e,this.clear();var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");this.parse(n,null,t)}return r.prototype.isRelativeScheme=function(e){return void 0!==S[e]},r.prototype.invalid=function(){this.clear(),this._isInvalid=!0},r.prototype.IDNAToASCII=function(e){return""==e&&this.invalid(),e.toLowerCase()},r.prototype.percentEscape=function(e){var t=e.charCodeAt(0);return 32<t&&t<127&&-1==[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)},r.prototype.percentEscapeQuery=function(e){var t=e.charCodeAt(0);return 32<t&&t<127&&-1==[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)},r.prototype.parse=function(e,t,n){var r=t||"scheme start",i=0,o="",a=!1,s=!1;e:for(;(e[i-1]!=y||0==i)&&!this._isInvalid;){var l=e[i];switch(r){case"scheme start":if(!l||!g.test(l)){if(t)break e;o="",r="no scheme";continue}o+=l.toLowerCase(),r="scheme";break;case"scheme":if(l&&v.test(l))o+=l.toLowerCase();else{if(':'!=l){if(t){if(y==l)break e;break e}o='',i=0,r='no scheme';continue}if(this._scheme=o,o='',t)break e;this.isRelativeScheme(this._scheme)&&(this._isRelative=!0),r='file'==this._scheme?'relative':this._isRelative&&n&&n._scheme==this._scheme?'relative or authority':this._isRelative?'authority first slash':'scheme data'}break;case'scheme data':'?'==l?(this._query='?',r='query'):'#'==l?(this._fragment='#',r='fragment'):y!=l&&'\t'!=l&&'\n'!=l&&'\r'!=l&&(this._schemeData+=this.percentEscape(l));break;case'no scheme':if(n&&this.isRelativeScheme(n._scheme)){r='relative';continue}this.invalid();break;case'relative or authority':if('/'!=l||'/'!=e[i+1]){r='relative';continue}r='authority ignore slashes';break;case'relative':if(this._isRelative=!0,'file'!=this._scheme&&(this._scheme=n._scheme),y==l){this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._username=n._username,this._password=n._password;break e}if('/'==l||'\\'==l)r='relative slash';else if('?'==l)this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query='?',this._username=n._username,this._password=n._password,r='query';else{if('#'!=l){var u=e[i+1],c=e[i+2];('file'!=this._scheme||!g.test(l)||':'!=u&&'|'!=u||y!=c&&'/'!=c&&'\\'!=c&&'?'!=c&&'#'!=c)&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password,this._path=n._path.slice(),this._path.pop()),r='relative path';continue}this._host=n._host,this._port=n._port,this._path=n._path.slice(),this._query=n._query,this._fragment='#',this._username=n._username,this._password=n._password,r='fragment'}break;case'relative slash':if('/'!=l&&'\\'!=l){'file'!=this._scheme&&(this._host=n._host,this._port=n._port,this._username=n._username,this._password=n._password),r='relative path';continue}r='file'==this._scheme?'file host':'authority ignore slashes';break;case'authority first slash':if('/'!=l){r='authority ignore slashes';continue}r='authority second slash';break;case'authority second slash':if(r='authority ignore slashes','/'!=l)continue;break;case'authority ignore slashes':if('/'!=l&&'\\'!=l){r='authority';continue}break;case'authority':if('@'==l){a&&(o+='%40'),a=!0;for(var d=0;d<o.length;d++){var p=o[d];if('\t'!=p&&'\n'!=p&&'\r'!=p)if(':'!=p||null!==this._password){var f=this.percentEscape(p);null!==this._password?this._password+=f:this._username+=f}else this._password=''}o=''}else{if(y==l||'/'==l||'\\'==l||'?'==l||'#'==l){i-=o.length,o='',r='host';continue}o+=l}break;case'file host':if(y==l||'/'==l||'\\'==l||'?'==l||'#'==l){2!=o.length||!g.test(o[0])||':'!=o[1]&&'|'!=o[1]?(0==o.length||(this._host=this.IDNAToASCII(o),o=''),r='relative path start'):r='relative path';continue}'\t'==l||'\n'==l||'\r'==l||(o+=l);break;case'host':case'hostname':if(':'!=l||s){if(y==l||'/'==l||'\\'==l||'?'==l||'#'==l){if(this._host=this.IDNAToASCII(o),o='',r='relative path start',t)break e;continue}'\t'!=l&&'\n'!=l&&'\r'!=l&&('['==l?s=!0:']'==l&&(s=!1),o+=l)}else if(this._host=this.IDNAToASCII(o),o='',r='port','hostname'==t)break e;break;case'port':if(/[0-9]/.test(l))o+=l;else{if(y==l||'/'==l||'\\'==l||'?'==l||'#'==l||t){if(''!=o){var h=parseInt(o,10);h!=S[this._scheme]&&(this._port=h+''),o=''}if(t)break e;r='relative path start';continue}'\t'==l||'\n'==l||'\r'==l||this.invalid()}break;case'relative path start':if(r='relative path','/'!=l&&'\\'!=l)continue;break;case'relative path':if(y!=l&&'/'!=l&&'\\'!=l&&(t||'?'!=l&&'#'!=l))'\t'!=l&&'\n'!=l&&'\r'!=l&&(o+=this.percentEscape(l));else{var m;(m=b[o.toLowerCase()])&&(o=m),'..'==o?(this._path.pop(),'/'!=l&&'\\'!=l&&this._path.push('')):'.'==o&&'/'!=l&&'\\'!=l?this._path.push(''):'.'!=o&&('file'==this._scheme&&0==this._path.length&&2==o.length&&g.test(o[0])&&'|'==o[1]&&(o=o[0]+':'),this._path.push(o)),o='','?'==l?(this._query='?',r='query'):'#'==l&&(this._fragment='#',r='fragment')}break;case'query':t||'#'!=l?y!=l&&'\t'!=l&&'\n'!=l&&'\r'!=l&&(this._query+=this.percentEscapeQuery(l)):(this._fragment='#',r='fragment');break;case'fragment':y!=l&&'\t'!=l&&'\n'!=l&&'\r'!=l&&(this._fragment+=l)}i++}},r.prototype.clear=function(){this._scheme="",this._schemeData="",this._username="",this._password="",this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1},r.prototype.toString=function(){return this.href},r.prototype.toJSON=function(){return this.href},Object.defineProperty(r.prototype,"href",{get:function(){if(this._isInvalid)return this._url;var e="";return""==this._username&&""==this._password||(e=this._username+(""!=this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set:function(e){this.clear(),this.parse(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"protocol",{get:function(){return this._scheme+":"},set:function(e){this._isInvalid||this.parse(e+":","scheme start")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"host",{get:function(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set:function(e){!this._isInvalid&&this._isRelative&&this.parse(e,"host")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hostname",{get:function(){return this._host},set:function(e){!this._isInvalid&&this._isRelative&&this.parse(e,"hostname")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"port",{get:function(){return this._port},set:function(e){!this._isInvalid&&this._isRelative&&this.parse(e,"port")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pathname",{get:function(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set:function(e){!this._isInvalid&&this._isRelative&&(this._path=[],this.parse(e,"relative path start"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"search",{get:function(){return this._isInvalid||!this._query||"?"==this._query?"":this._query},set:function(e){!this._isInvalid&&this._isRelative&&((this._query="?")==e[0]&&(e=e.slice(1)),this.parse(e,"query"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"hash",{get:function(){return this._isInvalid||!this._fragment||"#"==this._fragment?"":this._fragment},set:function(e){this._isInvalid||((this._fragment="#")==e[0]&&(e=e.slice(1)),this.parse(e,"fragment"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"username",{get:function(){return this._username},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"password",{get:function(){return this._password},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"origin",{get:function(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return(e=this.host)?this._scheme+"://"+e:""},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"searchParams",{get:function(){return null},enumerable:!0,configurable:!0}),r.createObjectURL=function(e){return""},r.revokeObjectURL=function(e){},r}();if(t.URL=n=o,"undefined"!=typeof URL){var a=URL;a&&(n.createObjectURL=function(e){return a.createObjectURL.apply(a,arguments)},n.revokeObjectURL=function(e){a.revokeObjectURL(e)})}}});e(wE);wE.URL;var CE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.wwwFormUrlEncode=function(e){return F.pairs(e).map(function(e){return e.map(function(e){return encodeURIComponent(e).replace(/%20/g,"+")}).join("=")}).join("&")},e.appendQueryParams=function(e,t){var n=e.search,r=F.pairs(t).reduce(function(e,t){return e+(""===e?"?":"&")+t[0]+"="+t[1]},n);e.search=r},e.removeQueryParams=function(e,t){var n=e.search;"?"===n[0]&&(n=n.slice(1));for(var r=n.split("&"),i=0;i<r.length;i++){var o=t[r[i].split("=")[0]];null!=o&&(r.splice(i,1),i--)}e.search=r.join("&")},e}();t.URLUtils=n});e(CE);CE.URLUtils;var ME=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.URL=wE.URL,t.URLUtils=CE.URLUtils});e(ME);ME.URL,ME.URLUtils;var IE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.createInitFragmentRequestBuilder=function(e,t){return this.createRequestBuilder(e.sourceUrl.url,t,e.byteRange)},e.prototype.createMediaFragmentRequestBuilder=function(e,t){return this.createRequestBuilder(e.sourceUrl.url,t,e.byteRange)},e.prototype.createRequestBuilder=function(e,t,n){var r=new ME.URL(e);r.search+=(""===r.search?"?":"&")+"amznDtid="+Yh.deviceInformation.hardware.deviceTypeId;var i=r.toString(),o=new mp.HttpRequestBuilder("GET",i).responseType("arraybuffer");return null!=n&&o.header("Range","bytes="+n.start+"-"+n.end),null!=t&&o.timeout(t),o},e}();t.FragmentRequestFactory=n});e(IE);IE.FragmentRequestFactory;var EE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.convertBufferSourceToUint8Array=function(e){return ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)},e}();t.BinaryUtils=n});e(EE);EE.BinaryUtils;var _E=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function a(e){void 0===e&&(e=[]),this.buffers=[];for(var t=this.byteLength=0,n=e;t<n.length;t++){var r=n[t];this.appendBuffer(r)}}return a.create=function(e){return e instanceof a?e:new a([new Uint8Array(e)])},a.prototype.appendBuffer=function(e){if(e instanceof a)for(var t=0,n=e.buffers;t<n.length;t++){var r=n[t];this.buffers.push(r),this.byteLength+=r.byteLength}else this.buffers.push(e),this.byteLength+=e.byteLength},Object.defineProperty(a.prototype,"length",{get:function(){return this.byteLength},enumerable:!0,configurable:!0}),a.prototype.getByte=function(e){if(e>=this.length)throw new Error("Index out of bounds");for(var t=0;e>=this.buffers[t].byteLength;)e-=this.buffers[t].byteLength,t++;return this.buffers[t][e]},a.prototype.setByte=function(e,t){if(e>=this.length)throw new Error("Index out of bounds");for(var n=0;e>=this.buffers[n].byteLength;)e-=this.buffers[n].byteLength,n++;this.buffers[n][e]=t},a.prototype.subarray=function(e,t){void 0===e&&(e=0),void 0===t&&(t=1/0);var n=0;for(t--;n<this.buffers.length&&e>=this.buffers[n].byteLength;)e-=this.buffers[n].byteLength,t-=this.buffers[n].byteLength,n++;if(n>=this.buffers.length)return new a;for(var r=n;r<this.buffers.length-1&&t>=this.buffers[r].byteLength;)t-=this.buffers[r].byteLength,r++;t>=this.buffers[r].byteLength&&(t=this.buffers[r].byteLength-1);var i=new a;if(n===r)return i.appendBuffer(this.buffers[n].subarray(e,t+1)),i;i.appendBuffer(this.buffers[n].subarray(e));for(var o=n+1;o<r;o++)i.appendBuffer(this.buffers[o]);return i.appendBuffer(this.buffers[r].subarray(0,t+1)),i},a.prototype.coalesce=function(){if(1===this.buffers.length)return this.buffers[0];for(var e=new Uint8Array(this.length),t=0,n=0,r=this.buffers;n<r.length;n++){var i=r[n];e.set(i,t),t+=i.length}return e},a}();t.MultiBuffer=n});e(_E);_E.MultiBuffer;var xE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function r(e,t,n){void 0===t&&(t=0),this.backingBuffer=e,this.offset=t,this.length=n,this.scratchArea=new Uint8Array(8),this.scratchView=new DataView(this.scratchArea.buffer)}return r.createFor=function(e,t,n){return e instanceof ArrayBuffer?new DataView(e,t,n):new r(e,t,n)},Object.defineProperty(r.prototype,"byteOffset",{get:function(){return this.offset},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"byteLength",{get:function(){return null!=this.length?this.length:this.backingBuffer.length-this.offset},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"buffer",{get:function(){return this.backingBuffer},enumerable:!0,configurable:!0}),r.prototype.getInt8=function(e){return this.read(e,1),this.scratchView.getInt8(0)},r.prototype.getUint8=function(e){return this.backingBuffer.getByte(this.byteOffset+e)},r.prototype.getInt16=function(e,t){return this.read(e,2),this.scratchView.getInt16(0,t)},r.prototype.getUint16=function(e,t){return this.read(e,2),this.scratchView.getUint16(0,t)},r.prototype.getInt32=function(e,t){return this.read(e,4),this.scratchView.getInt32(0,t)},r.prototype.getUint32=function(e,t){return this.read(e,4),this.scratchView.getUint32(0,t)},r.prototype.getFloat32=function(e,t){return this.read(e,4),this.scratchView.getFloat32(0,t)},r.prototype.getFloat64=function(e,t){return this.read(e,8),this.scratchView.getFloat64(0,t)},r.prototype.setInt8=function(e,t){this.scratchView.setInt8(0,t),this.write(e,1)},r.prototype.setUint8=function(e,t){this.scratchView.setUint8(0,t),this.write(e,1)},r.prototype.setInt16=function(e,t,n){this.scratchView.setInt16(0,t,n),this.write(e,2)},r.prototype.setUint16=function(e,t,n){this.scratchView.setUint16(0,t,n),this.write(e,2)},r.prototype.setInt32=function(e,t,n){this.scratchView.setInt32(0,t,n),this.write(e,4)},r.prototype.setUint32=function(e,t,n){this.scratchView.setUint32(0,t,n),this.write(e,4)},r.prototype.setFloat32=function(e,t,n){this.scratchView.setFloat32(0,t,n),this.write(e,4)},r.prototype.setFloat64=function(e,t,n){this.scratchView.setFloat64(0,t,n),this.write(e,8)},r.prototype.read=function(e,t){var n=0;switch(t){case 8:this.scratchArea[n++]=this.backingBuffer.getByte(this.offset+e++);case 7:this.scratchArea[n++]=this.backingBuffer.getByte(this.offset+e++);case 6:this.scratchArea[n++]=this.backingBuffer.getByte(this.offset+e++);case 5:this.scratchArea[n++]=this.backingBuffer.getByte(this.offset+e++);case 4:this.scratchArea[n++]=this.backingBuffer.getByte(this.offset+e++);case 3:this.scratchArea[n++]=this.backingBuffer.getByte(this.offset+e++);case 2:this.scratchArea[n++]=this.backingBuffer.getByte(this.offset+e++);case 1:this.scratchArea[n++]=this.backingBuffer.getByte(this.offset+e++)}},r.prototype.write=function(e,t){var n=0;switch(t){case 8:this.backingBuffer.setByte(this.offset+e++,this.scratchArea[n++]);case 7:this.backingBuffer.setByte(this.offset+e++,this.scratchArea[n++]);case 6:this.backingBuffer.setByte(this.offset+e++,this.scratchArea[n++]);case 5:this.backingBuffer.setByte(this.offset+e++,this.scratchArea[n++]);case 4:this.backingBuffer.setByte(this.offset+e++,this.scratchArea[n++]);case 3:this.backingBuffer.setByte(this.offset+e++,this.scratchArea[n++]);case 2:this.backingBuffer.setByte(this.offset+e++,this.scratchArea[n++]);case 1:this.backingBuffer.setByte(this.offset+e++,this.scratchArea[n++])}},r}();t.MultiBufferDataView=n});e(xE);xE.MultiBufferDataView;var kE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function n(e){this.view=e,this.position=0}return n.prototype.size=function(){return this.view.byteLength},n.prototype.hasData=function(){return 0<this.remaining()},n.prototype.remaining=function(){return this.view.byteLength-this.position},n.prototype.readu8=function(){var e=this.view.getUint8(this.position);return this.position++,e},n.prototype.readu16=function(){var e=this.view.getUint16(this.position);return this.position+=2,e},n.prototype.readu24=function(){var e=this.view.getUint16(this.position);return e=e<<8|this.view.getUint8(this.position+2),this.position+=3,e},n.prototype.readu32=function(){var e=this.view.getUint32(this.position);return this.position+=4,e},n.prototype.reads32=function(){var e=this.view.getInt32(this.position);return this.position+=4,e},n.prototype.readu64=function(){return 4294967296*this.readu32()+this.readu32()},n.prototype.readString=function(e){var t=[];t.length=e;for(var n=0;n<e;n++)t[n]=String.fromCharCode(this.view.getUint8(this.position++));return t.join("")},n.prototype.readCString=function(){for(var e=[],t=this.readu8();0!==t;)e.push(String.fromCharCode(t)),t=this.readu8();return e.join("")},n.prototype.readUUID=function(){return this.pad(this.readu32(),"00000000")+"-"+this.pad(this.readu16(),"0000")+"-"+this.pad(this.readu16(),"0000")+"-"+this.pad(this.readu16(),"0000")+"-"+this.pad(this.readu24(),"000000")+this.pad(this.readu24(),"000000")},n.prototype.skip=function(e){return this.position+=e,this},n.prototype.readBuffer=function(e){null==e&&(e=this.view.byteLength-this.position);var t=new n(xE.MultiBufferDataView.createFor(this.view.buffer,this.view.byteOffset+this.position,e));return this.position+=e,t},n.prototype.readUint8Array=function(e){return this.readChunk(e).coalesce()},n.prototype.readChunk=function(e){null==e&&(e=this.view.byteLength-this.position);var t=_E.MultiBuffer.create(this.view.buffer).subarray(this.view.byteOffset+this.position,this.view.byteOffset+this.position+e);return this.position+=e,t},n.prototype.getAbsolutePosition=function(){return this.view.byteOffset+this.position},n.prototype.pad=function(e,t,n){return void 0===n&&(n=16),(t+e.toString(n)).slice(-t.length)},n}();t.DataReader=n});e(kE);kE.DataReader;var RE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function u(){}return u.parse=function(e){for(var t=new kE.DataReader(new DataView(e.buffer,e.byteOffset,e.byteLength)),n={};t.hasData();){var r=u.readVarint(t),i=r>>3,o=7&r,a=void 0;switch(o){case 0:a=u.readVarint(t);break;case 1:a=t.readUint8Array(8);break;case 5:a=t.readUint8Array(4);break;case 2:var s=u.readVarint(t);a=t.readUint8Array(s);break;default:throw new Error("Unrecognized wireType: "+o)}var l=n[i];null==l?n[i]=a:Array.isArray(l)?l.push(a):n[i]=[l,a]}return n},u.readVarint=function(e){for(var t,n=0,r=0;n|=(127&(t=e.readu8()))<<r,r+=7,0!=(128&t););return n},u}();t.ProtobufDecoder=n});e(RE);RE.ProtobufDecoder;var AE=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryUtils=EE.BinaryUtils,t.DataReader=kE.DataReader,t.MultiBuffer=_E.MultiBuffer,t.MultiBufferDataView=xE.MultiBufferDataView,t.ProtobufDecoder=RE.ProtobufDecoder});e(AE);AE.BinaryUtils,AE.DataReader,AE.MultiBuffer,AE.MultiBufferDataView,AE.ProtobufDecoder;var OE=function(){function e(){}return e.prototype.parseBoxes=function(e,t,n){for(var r=[];e.hasData();){var i=this.parseBox(e,t,n);r.push(i)}return r},e.prototype.parseBox=function(e,t,n){var r=this.readBox(e,n),i=r;if(null!=t[r.type]){var o=t[r.type].parser;null!=o&&(i=o(r)),F.isEmpty(t[r.type].children)||(i.boxes=this.parseBoxes(r.reader,t[r.type].children,n+"/"+r.type));var a=t[r.type].postProcessor;null!=a&&a(r)}return i},e.prototype.readBox=function(e,t){var n=e.getAbsolutePosition();if(e.size()<8)throw new Error("Need at least 8 bytes, but have only "+e.size()+" bytes left. Path: "+t);var r=8,i=e.readu32(),o=e.readString(4);if(1===i){if(e.remaining()<8)throw new Error("Not enough data to read extended size for box "+o+". Need 8 bytes, but have only "+e.remaining()+". Path: "+t);i=e.readu64(),r+=8}if(e.size()<i)throw new Error("Box "+o+" size is "+i+" bytes, but have only "+e.size()+" bytes left. Path: "+t);if("uuid"===o&&(o=e.readUUID(),r+=16),i-r<=0)throw new Error("Inconsistency detected: Remaining size in reader for box "+o+" is "+(i-r)+". Path: "+t);return{type:o,size:i,boxContentsSize:i-r,absoluteStartPosition:n,reader:e.readBuffer(i-r)}},e}(),LE=V&&V.__assign||function(){return(LE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},FE=function(){function h(){}return h.parseMVHD=function(e){var t=e.reader.readu8();e.reader.skip(3);var n=LE({creationTime:0===t?e.reader.readu32():e.reader.readu64(),modificationTime:0===t?e.reader.readu32():e.reader.readu64(),timescale:e.reader.readu32(),duration:0===t?e.reader.readu32():e.reader.readu64(),rate:e.reader.readu32(),volume:e.reader.readu16(),matrix:[],nextTrackId:0},e);e.reader.skip(2),e.reader.skip(8);for(var r=0;r<9;r++)n.matrix[r]=e.reader.readu32();return e.reader.skip(24),n.nextTrackId=e.reader.readu32(),n},h.parseMDAT=function(e){return LE({data:e.reader.readUint8Array(e.boxContentsSize)},e)},h.parseTFDT=function(e){var t=e.reader.readu8();return e.reader.skip(3),LE({baseMediaDecodeTime:0===t?e.reader.readu32():e.reader.readu64()},e)},h.parseMFHD=function(e){return e.reader.skip(1),e.reader.skip(3),LE({sequenceNumber:e.reader.readu32()},e)},h.parseTFHD=function(e){e.reader.skip(1);var t=e.reader.readu24();return LE({baseDataOffsetPresent:h.isSet(t,1),sampleDescriptionIndexPresent:h.isSet(t,2),defaultSampleDurationPresent:h.isSet(t,8),defaultSampleSizePresent:h.isSet(t,16),defaultSampleFlagsPresent:h.isSet(t,32),durationIsEmpty:h.isSet(t,65536),defaultBaseIsMoof:h.isSet(t,131072),trackId:e.reader.readu32(),baseDataOffset:h.isSet(t,1)?e.reader.readu32():void 0,sampleDescriptionIndex:h.isSet(t,2)?e.reader.readu32():void 0,defaultSampleDuration:h.isSet(t,8)?e.reader.readu32():void 0,defaultSampleSize:h.isSet(t,16)?e.reader.readu32():void 0,defaultSampleFlags:h.isSet(t,32)?e.reader.readu32():void 0},e)},h.parseTRUN=function(e){for(var t=e.reader.readu8(),n=e.reader.readu24(),r=e.reader.readu32(),i=LE({sampleCount:r,dataOffset:h.isSet(n,1)?e.reader.reads32():void 0,firstSampleFlags:h.isSet(n,4)?e.reader.readu32():void 0,samples:[]},e),o=h.isSet(n,256),a=h.isSet(n,512),s=h.isSet(n,1024),l=h.isSet(n,2048),u=e.reader.readUint8Array(),c=new DataView(u.buffer,u.byteOffset,u.byteLength),d=0,p=0;p<i.sampleCount;p++){var f={};i.samples[p]=f,o&&(f.duration=c.getUint32(d),d+=4),a&&(f.size=c.getUint32(d),d+=4),s&&(f.flags=c.getUint32(d),d+=4),l&&(f.compositionTimeOffset=0===t?c.getUint32(d):c.getInt32(d),d+=4)}return i},h.parseSIDX=function(e){var t=e.reader.readu8();e.reader.skip(3);for(var n=LE({referenceId:e.reader.readu32(),timescale:e.reader.readu32(),earliestPresentationTime:0===t?e.reader.readu32():e.reader.readu64(),firstOffset:0===t?e.reader.readu32():e.reader.readu64(),referenceCount:e.reader.skip(2).readu16(),references:[]},e),r=0,i=0,o=0;o<n.referenceCount;o++){var a=e.reader.readu32(),s=e.reader.readu32(),l=e.reader.readu32();n.references[o]={referenceType:a>>31,referencedSize:a&~(1<<31),subsegmentDuration:s,startsWithSAP:l>>31!=0,sapType:l>>28&7,sapDeltaTime:268435455&l,subsegmentPosition:r,referencedOffset:i},r+=n.references[o].subsegmentDuration,i+=n.references[o].referencedSize}return n},h.parseTKHD=function(e){var t=e.reader.readu8(),n=e.reader.readu24();return LE({enabled:h.isSet(n,1),inMovie:h.isSet(n,2),inPreview:h.isSet(n,4),creationTime:0===t?e.reader.readu32():e.reader.readu64(),modificationTime:0===t?e.reader.readu32():e.reader.readu64(),trackId:e.reader.readu32(),duration:(e.reader.skip(4),0===t?e.reader.readu32():e.reader.readu64()),layer:(e.reader.skip(8),e.reader.readu16()),alternateGroup:e.reader.readu16(),volume:e.reader.readu16(),matrix:[e.reader.readu32(),e.reader.readu32(),e.reader.readu32(),e.reader.readu32(),e.reader.readu32(),e.reader.readu32(),e.reader.readu32(),e.reader.readu32(),e.reader.readu32()],width:e.reader.readu32(),height:e.reader.readu32()},e)},h.parseMDHD=function(e){var t=e.reader.readu8();e.reader.skip(3);var n,r=LE({creationTime:0===t?e.reader.readu32():e.reader.readu64(),modificationTime:0===t?e.reader.readu32():e.reader.readu64(),timescale:e.reader.readu32(),duration:0===t?e.reader.readu32():e.reader.readu64(),language:(n=e.reader.readu16(),String.fromCharCode(96+(n>>10&31),96+(n>>5&31),96+(31&n)))},e);return e.reader.skip(2),r},h.parseMEHD=function(e){var t=e.reader.readu8();return e.reader.skip(3),LE({fragmentDuration:1===t?e.reader.readu64():e.reader.readu32()},e)},h.parseTREX=function(e){return e.reader.skip(1),e.reader.skip(3),LE({trackId:e.reader.readu32(),defaultSampleDescriptionIndex:e.reader.readu32(),defaultSampleDuration:e.reader.readu32(),defaultSampleSize:e.reader.readu32(),defaultSampleFlags:e.reader.readu32()},e)},h.parseHDLR=function(e){return e.reader.skip(1),e.reader.skip(3),e.reader.skip(4),LE({handlerType:e.reader.readu32(),name:(e.reader.skip(12),e.reader.readCString())},e)},h.parseSTSD=function(e){for(var t=LE({version:e.reader.readu8(),entryCount:(e.reader.skip(3),e.reader.readu32()),entries:[]},e),n=new OE,r=0;r<t.entryCount;r++){var i=n.readBox(e.reader,"stsd");i.reader.skip(6),i.dataReferenceIndex=i.reader.readu16(),t.entries[r]=i}return t},h.parseSCHM=function(e){e.reader.skip(1);var t=e.reader.readu24();return LE({schemeType:e.reader.readu32(),schemeVersion:e.reader.readu32(),schemeUri:h.isSet(t,1)?e.reader.readCString():void 0},e)},h.parseEMSG=function(e){return e.reader.skip(1),e.reader.skip(3),LE({schemeIdUri:e.reader.readCString(),value:e.reader.readCString(),timescale:e.reader.readu32(),presentationTimeDelta:e.reader.readu32(),eventDuration:e.reader.readu32(),id:e.reader.readu32(),messageData:e.reader.readUint8Array()},e)},h.parseSAIZ=function(e){e.reader.skip(1);for(var t=e.reader.readu24(),n=LE({flags:t,auxInfoType:h.isSet(t,1)?e.reader.readu32():void 0,auxInfoTypeParameter:h.isSet(t,1)?e.reader.readu32():void 0,defaultSampleInfoSize:e.reader.readu8(),sampleCount:e.reader.readu32(),sampleInfoSize:[]},e),r=0;r<n.sampleCount;r++)n.sampleInfoSize[r]=0===n.defaultSampleInfoSize?e.reader.readu8():n.defaultSampleInfoSize;return n},h.parseSAIO=function(e){for(var t=e.reader.readu8(),n=e.reader.readu24(),r=LE({version:t,flags:n,auxInfoType:h.isSet(n,1)?e.reader.readu32():void 0,auxInfoTypeParameter:h.isSet(n,1)?e.reader.readu32():void 0,entryCount:e.reader.readu32(),offset:[]},e),i=0;i<r.entryCount;i++)r.offset[i]=0===r.version?e.reader.readu32():e.reader.readu64();return r},h.parseSBGP=function(e){for(var t=e.reader.readu8(),n=LE({version:t,groupingType:(e.reader.skip(3),e.reader.readu32()),groupingTypeParameters:1===t?e.reader.readu32():0,entries:[]},e),r=e.reader.readu32(),i=0;i<r;i++)n.entries[i]={sampleCount:e.reader.readu32(),groupDescriptionIndex:e.reader.readu32()};return n},h.parseFRMA=function(e){return LE({dataFormat:e.reader.readu32()},e)},h.isSet=function(e,t){return 0!=(e&t)},h}(),DE=function(){function e(){}return e.fourCCToNumber=function(e){return((e.charCodeAt(0)<<8|e.charCodeAt(1))<<8|e.charCodeAt(2))<<8|e.charCodeAt(3)},e.numberToFourCC=function(e){return String.fromCharCode(e>>>24,e>>>16&255,e>>>8&255,255&e)},e.ofType=function(t){return function(e){return e.type===t}},e.all=function(e,t){return e.boxes.filter(t)},e.find=function(e,t){var n=F.find(e.boxes,t);return xt.withDefault(n,null)},e.getPath=function(o,a){var s=/^([0-9a-zA-Z]{4,})\[([0-9]+)\]$/,l=a.split("/"),u=0;F.isEmpty(l[u])&&u++;for(var e=function(){var e=s.exec(l[u++]);if(null==e)throw new Error("path "+a+" is invalid: \""+l[u-1]+"\" is not valid");var t=e[1],n=e[2],r=parseInt(n),i=o.boxes.filter(function(e){return e.type===t});if(null===i||i.length<=r)return{value:null};o=i[r]};u<l.length;){var t=e();if("object"==typeof t)return t.value}return o},e}(),NE=function(){function a(){}return a.registerSampleSubBox=function(e,t,n){if(null==a.sampleEntryBoxParsers[e])throw new Error("Unrecognized sample type: "+e);for(var r=t.split("/"),i={parser:null,children:a.sampleEntryBoxParsers[e]},o=0;o<r.length-1;o++){if(null==i.children[r[o]])throw new Error("Unable to register parser for path "+t+": no parser for "+r[o]);i=i.children[r[o]]}if(null!=i.children[r[r.length-1]])throw new Error("Unable to register parser for path "+t+": Already have a parser for "+F.last(r));i.children[r[r.length-1]]=n},a.process=function(e){var t=DE.getPath(e,"mdia[0]/hdlr[0]");if(null==t)throw new Error("Missing required `hdlr' box in track");t.handlerType===DE.fourCCToNumber("soun")?a.postProcessAudioTrack(e):t.handlerType===DE.fourCCToNumber("vide")&&a.postProcessVideoTrack(e)},a.postProcessAudioTrack=function(e){var t=DE.getPath(e,"mdia[0]/minf[0]/stbl[0]/stsd[0]");if(null==t)throw new Error("Missing required 'stsd' box in track");for(var n=0,r=t.entries;n<r.length;n++){var i=r[n];a.postProcessAudioSampleDescriptionEntry(i)}},a.postProcessVideoTrack=function(e){var t=DE.getPath(e,"mdia[0]/minf[0]/stbl[0]/stsd[0]");if(null==t)throw new Error("Missing required 'stsd' box in track");for(var n=0,r=t.entries;n<r.length;n++){var i=r[n];a.postProcessVisualSampleDescriptionEntry(i)}},a.postProcessVisualSampleDescriptionEntry=function(e){var t=e;e.reader.skip(2),e.reader.skip(2),e.reader.skip(12),t.width=e.reader.readu16(),t.height=e.reader.readu16(),t.horizontalResolution=e.reader.reads32(),t.verticalResolution=e.reader.reads32(),e.reader.skip(4),t.frameCount=e.reader.readu16(),t.compressorName=e.reader.readString(32),t.depth=e.reader.readu16(),e.reader.skip(2);var n=new OE;t.boxes=n.parseBoxes(e.reader,a.sampleEntryBoxParsers.vide,"stsd/vide")},a.postProcessAudioSampleDescriptionEntry=function(e){var t=e;e.reader.readu16();e.reader.skip(6),t.channelCount=e.reader.readu16(),t.sampleSize=e.reader.readu16(),e.reader.skip(2),e.reader.skip(2),t.sampleRate=e.reader.readu32();var n=new OE;t.boxes=n.parseBoxes(e.reader,a.sampleEntryBoxParsers.soun,"stsd/soun")},a.sampleEntryBoxParsers={soun:{sinf:{parser:null,children:{frma:{parser:FE.parseFRMA,children:{}},schm:{parser:FE.parseSCHM,children:{}},schi:{parser:null,children:{}}}}},vide:{sinf:{parser:null,children:{frma:{parser:FE.parseFRMA,children:{}},schm:{parser:FE.parseSCHM,children:{}},schi:{parser:null,children:{}}}}}},a}(),UE=V&&V.__assign||function(){return(UE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},BE=[32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,576,640],VE=function(){function e(){}return e.register=function(){NE.registerSampleSubBox("soun","dac3",{parser:e.parseDAC3,children:{}}),NE.registerSampleSubBox("soun","dec3",{parser:e.parseDEC3,children:{}})},e.parseDAC3=function(e){var t=e.reader.readu24();return UE({fscod:t>>22&3,bsid:t>>17&31,bsmod:t>>14&7,acmod:t>>11&7,lfeon:1==(t>>10&1),bitRate:BE[t>>5&31]},e)},e.parseDEC3=function(e){var t=UE({dataRate:-1,independentSubstreams:[]},e),n=e.reader.readu16();t.dataRate=n>>3&8191;var r=1+(7&n);t.independentSubstreams.length=r;for(var i=0;i<r;i++){n=e.reader.readu16();var o=e.reader.readu8();t.independentSubstreams[i]={fscod:n>>14&3,bsid:n>>9&31,asvc:1==(n>>7&1),bsmod:n>>4&7,acmod:n>>1&7,lfeon:1==(1&n),numDepSub:o>>1&15,chanLoc:0},0<t.independentSubstreams[i].numDepSub&&(t.independentSubstreams[i].chanLoc=(1&o)<<8|e.reader.readu8())}return t},e}(),jE=V&&V.__assign||function(){return(jE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},XE=function(){function e(){}return e.register=function(){NE.registerSampleSubBox("vide","avcC",{parser:e.parseAVCC,children:{}})},e.parseAVCC=function(e){e.reader.readu8();for(var t=jE({profileIndication:e.reader.readu8(),profileCompatibility:e.reader.readu8(),levelIndication:e.reader.readu8(),lengthSizeMinusOne:3&e.reader.readu8(),SPSs:[],PPSs:[]},e),n=31&e.reader.readu8(),r=0;r<n;r++){var i=e.reader.readu16();t.SPSs.push(e.reader.readUint8Array(i))}var o=e.reader.readu8();for(r=0;r<o;r++){var a=e.reader.readu16();t.PPSs.push(e.reader.readUint8Array(a))}return t},e}(),zE=V&&V.__assign||function(){return(zE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},qE=function(){function e(){}return e.register=function(){NE.registerSampleSubBox("vide","hvcC",{parser:e.parseHVCC,children:{}})},e.parseHVCC=function(e){e.reader.readu8();var t=e.reader.readu8(),n=t>>6,r=32==(32&t),i=31&t,o=e.reader.readu32(),a=e.reader.readu16(),s=e.reader.readu32(),l=e.reader.readu8(),u=4095&e.reader.readu16(),c=3&e.reader.readu8(),d=3&e.reader.readu8(),p=7&e.reader.readu8(),f=7&e.reader.readu8(),h=e.reader.readu16(),m=(t=e.reader.readu8())>>6,y=t>>3&7,g=4==(4&t),v=3&t,S=e.reader.readu8(),b=[];b.length=S;for(var T=0;T<S;T++){var P={arrayCompleteness:128==(128&(t=e.reader.readu8())),nalUnitType:63&t,nals:[]};b[T]=P;var w=e.reader.readu16();P.nals.length=w;for(var C=0;C<w;C++){var M=e.reader.readu16();P.nals[C]=e.reader.readUint8Array(M)}}return zE({generalProfileSpace:n,generalTierFlag:r,generalProfileIdc:i,generalProfileCompatibilityFlag:o,generalConstraintIndicatorFlagsLo:s,generalConstraintIndicatorFlagsHi:a,generalLevelIdc:l,minSpatialSegmentationIdc:u,parallelismType:c,chromaFormat:d,bitDepthLumaMinus8:p,bitDepthChromaMinus8:f,avgFrameRate:h,constantFrameRate:m,numTemporalLayers:y,temporalIdNested:g,lengthSizeMinusOne:v,arrays:b},e)},e}(),WE=V&&V.__assign||function(){return(WE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},HE=function(){function e(){}return e.register=function(){NE.registerSampleSubBox("vide","dvcC",{parser:e.parseDVCC,children:{}}),NE.registerSampleSubBox("vide","dvvC",{parser:e.parseDVCC,children:{}})},e.parseDVCC=function(e){var t=e.reader.readu8(),n=e.reader.readu8(),r=e.reader.readu16(),i=e.reader.readu32();return WE({versionMajor:t,versionMinor:n,profile:(65024&r)>>9,level:(504&r)>>3,rpuPresentFlag:(4&r)>>2==1,elPresentFlag:(2&r)>>1==1,blPresentFlag:1==(1&r),blSignalCompatibilityId:(4026531840&i)>>28},e)},e}(),GE=V&&V.__assign||function(){return(GE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},KE=function(){function s(){}return s.registerSampleGroupType=function(e,t){s.groupingTypeParsers[e]=t},s.rawSampleParser=function(e){return{reader:e.readBuffer()}},s.parse=function(e){var t=e.reader.readu8(),n=GE({version:t,flags:e.reader.readu24(),groupingType:e.reader.readu32(),defaultLength:1===t?e.reader.readu32():0,defaultSampleDescriptionIndex:2<=t?e.reader.readu32():0,entryCount:e.reader.readu32(),entries:[]},e),r=xt.withDefault(s.groupingTypeParsers[n.groupingType],s.rawSampleParser);if(1===t)for(var i=0;i<n.entryCount;i++){var o=0===n.defaultLength?e.reader.readu32():n.defaultLength,a=e.reader.readBuffer(o);n.entries.push(r(a))}else for(;e.reader.hasData();)n.entries.push(r(e.reader));return n},s.groupingTypeParsers={},s}(),QE=function(){function o(){}return o.getBoxStructure=function(){return this.boxStructure},o.registerBox=function(e,t){for(var n=e.split("/"),r={parser:null,children:o.boxStructure},i=0;i<n.length-1;i++){if(null==r.children[n[i]])throw new Error("Unable to register parser for path "+e+": no parser for "+n[i]);r=r.children[n[i]]}if(null!=r.children[n[n.length-1]])throw new Error("Unable to register parser for path "+e+": Already have a parser for "+n[n.length-1]);r.children[n[n.length-1]]=t},o.boxStructure={moov:{parser:null,children:{mvhd:{parser:FE.parseMVHD,children:{}},trak:{parser:null,postProcessor:NE.process,children:{tkhd:{parser:FE.parseTKHD,children:{}},mdia:{parser:null,children:{mdhd:{parser:FE.parseMDHD,children:{}},hdlr:{parser:FE.parseHDLR,children:{}},minf:{parser:null,children:{stbl:{parser:null,children:{stsd:{parser:FE.parseSTSD,children:{}},sgpd:{parser:KE.parse,children:{}}}}}}}}}},mvex:{parser:null,children:{mehd:{parser:FE.parseMEHD,children:{}},trex:{parser:FE.parseTREX,children:{}}}}}},moof:{parser:null,children:{mfhd:{parser:FE.parseMFHD,children:{}},traf:{parser:null,children:{tfhd:{parser:FE.parseTFHD,children:{}},trun:{parser:FE.parseTRUN,children:{}},tfdt:{parser:FE.parseTFDT,children:{}},sgpd:{parser:KE.parse,children:{}},sbgp:{parser:FE.parseSBGP,children:{}},saio:{parser:FE.parseSAIO,children:{}},saiz:{parser:FE.parseSAIZ,children:{}}}}}},mdat:{parser:FE.parseMDAT,children:{}},sidx:{parser:FE.parseSIDX,children:{}},emsg:{parser:FE.parseEMSG,children:{}}},o}(),YE=V&&V.__assign||function(){return(YE=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},JE=function(){function e(){}return e.register=function(){QE.registerBox("pssh",{parser:e.parsePSSH,children:{}}),QE.registerBox("moof/pssh",{parser:e.parsePSSH,children:{}}),QE.registerBox("moov/pssh",{parser:e.parsePSSH,children:{}}),NE.registerSampleSubBox("vide","sinf/schi/tenc",{parser:e.parseTENC,children:{}}),NE.registerSampleSubBox("soun","sinf/schi/tenc",{parser:e.parseTENC,children:{}}),KE.registerSampleGroupType(DE.fourCCToNumber("seig"),e.parseCencSampleEncryptionInformationGroupEntry)},e.parseTENC=function(e){return e.reader.skip(1),e.reader.skip(3),YE({defaultIsEncrypted:0!==e.reader.readu24(),defaultIvSize:e.reader.readu8(),defaultKID:e.reader.readUint8Array(16)},e)},e.parseCencSampleEncryptionInformationGroupEntry=function(e){return{isEncrypted:0!==e.readu24(),ivSize:e.readu8(),KID:e.readUint8Array(16)}},e.parsePSSH=function(e){var t=e.reader.readu8();e.reader.skip(3);var n=YE({systemId:e.reader.readUUID(),dataSize:-1,data:null},e);if(0<t){n.kidCount=e.reader.readu32(),n.kids=[];for(var r=0;r<n.kidCount;r++)n.kids[r]=e.reader.readUint8Array(16)}return n.dataSize=e.reader.readu32(),n.data=e.reader.readUint8Array(n.dataSize),n},e}(),$E=AE.DataReader,ZE=S.of("BmffParser"),e_=function(){function a(){this.boxParsers=QE.getBoxStructure(),this.boxParser=new OE}return a.prototype.parseFragment=function(e,t){var n;if(ZE(e,"data").exists(),ArrayBuffer.isView(e)){var r=e;n=new DataView(r.buffer,r.byteOffset,r.byteLength)}else n=new DataView(e);var i=new $E(n),o=null!=t?F.pick(this.boxParsers,t):this.boxParsers;return{type:a.ROOT_BOX_TYPE,size:n.byteLength,boxContentsSize:n.byteLength,absoluteStartPosition:0,boxes:this.boxParser.parseBoxes(i,o,"")}},a.prototype.parse=function(e){ZE(e,"view").exists();var t=new $E(e);return this.boxParser.parseBox(t,this.boxParsers,"")},a.ROOT_BOX_TYPE="root",a}();JE.register(),VE.register(),XE.register(),qE.register(),HE.register();var t_=e_,n_=M.get("CencParser"),r_=function(){function e(){}return e.prototype.parseSampleAuxiliaryInfo=function(e,t){t<0&&n_.warn("[neguintarray] SampleAuxiliaryInfo has a negative ivSize of: "+t);var n={initializationVector:new Uint8Array(e.buffer,e.byteOffset,t),entries:[]};if(e.byteLength>t){var r=0,i=new DataView(e.buffer,e.byteOffset+t,e.byteLength-t),o=i.getUint16(r);r+=2;for(var a=0;a<o;a++){var s={bytesOfClearData:i.getUint16(r),bytesOfProtectedData:i.getUint32(r+2)};r+=6,n.entries.push(s)}}return n},e}(),i_={BmffParser:t_,Boxes:DE,CencParser:r_},o_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=new i_.BmffParser,n=function(){function i(){}return i.getSegmentSizeBytes=function(e,t){var n=i.getSegmentSizeFromByteRange(t.byteRange);return null!=n?n:Math.max(e.bandwidth/8*(t.position.durationMs/1e3),1)},i.getSegmentSizeFromByteRange=function(e){return null==e?null:e.end-e.start+1},i.validateDownloadedSegmentData=function(e,t){if(0===e.byteLength){var n={type:"ParseError",cause:new Error("Response buffer is "+(null==e?"null/undefined":"empty"))};throw new lh.AcquisitionError(n)}var r=i.getSegmentSizeFromByteRange(t.byteRange);if(null!=r&&e.byteLength!==r){n={type:"ParseError",cause:new Error("Expected response buffer to contain "+r+" bytes, but actual response buffer contains "+e.byteLength+" bytes instead")};throw new lh.AcquisitionError(n)}try{o.parseFragment(e,[])}catch(e){n={type:"ParseError",cause:new Error("Top level boxes parsing error: "+e.message)};throw new lh.AcquisitionError(n)}},i}();t.FragmentUtilities=n});e(o_);o_.FragmentUtilities;var a_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var f=M.get("InitFragmentAcquirer"),n=function(){function e(e,t){this.networkRequestManager=lh.getInstance(),this.pendingInitFragments={},this.reportStateChangeCallback=e,this.failedFragmentDiagnosticsRetentionLimit=t,this.completedInitFragmentsWithFailure=[],this.fragmentRequestFactory=new IE.FragmentRequestFactory}return e.prototype.isInitFragmentPending=function(e,t){var n=e.id+"_"+t.id;return null!=this.pendingInitFragments[n]},e.prototype.getDiagnostics=function(){var t=this,e=Object.keys(this.pendingInitFragments).map(function(e){return F.pick(t.pendingInitFragments[e],"initialQueuedTime","queuedTime","priorityWhenQueued","failureCount","requestStartedTime","priorityWhenRequested","timeoutMs","lastFailureReason","lastFailedTime")});return{completedInitFragmentsWithFailure:this.completedInitFragmentsWithFailure.map(function(e){return F.pick(e,"initialQueuedTime","queuedTime","priorityWhenQueued","failureCount","requestStartedTime","priorityWhenRequested","timeoutMs","lastFailureReason","lastFailedTime")}),initFragments:e}},e.prototype.isInitFragmentPendingThat=function(t){return F.values(this.pendingInitFragments).some(function(e){return t(e.periodId,e.streamId)})},e.prototype.getInitSegmentInfo=function(t,n,r,i){var e=i.segmentTimeline.getInitSegment();return"Unavailable"===e.type?(f.warn(t+" init segment for quality "+i.id+" of period "+r.id+" is no longer available! Ignoring it."),Fe.Promise.resolve(null)):("RefreshMe"===e.type?e.load():Fe.Promise.resolve(e)).then(function(e){return n.requested?(f.info("Request for "+t+" init segment for quality "+i.id+" of period "+r.id+" was cancelled."),null):"Unavailable"===e.type?(f.warn(t+" init segment for quality "+i.id+" of period "+r.id+" is not available! Ignoring request"),null):e})},e.prototype.downloadInitFragment=function(n,r,i,o,e,a,t){var s=this,l=n+"|"+o.id+"|"+e.id+"|"+a.id+"|init",u=o.id+"_"+a.id,c=null!=this.pendingInitFragments[u]?this.pendingInitFragments[u]:{periodId:o.id,streamId:e.id,qualityLevelId:a.id,priorityWhenQueued:null,initialQueuedTime:null,queuedTime:null,priorityWhenRequested:null,requestStartedTime:null,failureCount:0};this.pendingInitFragments[u]=c;var d={getRequestBuilder:function(e){return c.timeoutMs=PE.FragmentRequestConstants.SEGMENT_TIMEOUT_MS,c.requestStartedTime=Date.now(),c.priorityWhenRequested=t(),s.reportStateChangeCallback(),s.fragmentRequestFactory.createInitFragmentRequestBuilder(i.segment,PE.FragmentRequestConstants.SEGMENT_TIMEOUT_MS)},getPriority:t,onCancelled:function(e){},description:l},p=Date.now();return 0===c.failureCount&&(c.initialQueuedTime=p),c.queuedTime=p,c.priorityWhenQueued=t(),this.reportStateChangeCallback(),this.networkRequestManager.requestDownload(d,r).then(function(e){r.throwIfRequested();var t=e.getArrayBuffer();return o_.FragmentUtilities.validateDownloadedSegmentData(t,i.segment),0<c.failureCount&&(s.completedInitFragmentsWithFailure.length>=s.failedFragmentDiagnosticsRetentionLimit&&s.completedInitFragmentsWithFailure.shift(),s.completedInitFragmentsWithFailure.push(c)),delete s.pendingInitFragments[u],e}).catch(function(e){var t="Failed to acquire "+n+" init fragment for quality "+a.id+" on period "+o.id+": "+e;if(f.error(t),e instanceof Fe.CancelError&&(f.info("Acquisition canceled for "+n+" init fragment for quality "+a.id),r.requested))return delete s.pendingInitFragments[u],s.reportStateChangeCallback(),null;throw c.lastFailedTime=Date.now(),c.lastFailureReason=t,c.failureCount++,s.reportStateChangeCallback(),e})},e.prototype.stop=function(){this.pendingInitFragments={},this.completedInitFragmentsWithFailure=[]},e}();t.InitFragmentAcquirer=n});e(a_);a_.InitFragmentAcquirer;var s_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentRequestConstants=PE.FragmentRequestConstants,t.FragmentRequestFactory=IE.FragmentRequestFactory,t.FragmentUtilities=o_.FragmentUtilities,t.InitFragmentAcquirer=a_.InitFragmentAcquirer});e(s_);s_.FragmentRequestConstants,s_.FragmentRequestFactory,s_.FragmentUtilities,s_.InitFragmentAcquirer;var l_=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Manifest=0]="Manifest",r[r.Fragment=1]="Fragment",t.AcquisitionResourceType=n});e(l_);l_.AcquisitionResourceType;var u_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.networkRequestManager=lh.getInstance()}return e.prototype.acquire=function(n,r,i,e,o,a,t){var s={getRequestBuilder:function(e){if(o.requested)return null;var t=new ME.URL(r.url);return null!=a&&ME.URLUtils.appendQueryParams(t,a),new mp.HttpRequestBuilder("GET",t.toString()).responseType("text"===n?"text":"arraybuffer").timeout(i).headers(r.headers)},getPriority:function(){return e},onCancelled:function(e){},description:t};return this.networkRequestManager.requestDownload(s,o).then(function(e){o.throwIfRequested();var t="text"===n?e.getText():e.getArrayBuffer();return{sourceUrl:r,body:t,headers:e.getHeaders(),timing:{latencyMs:e.getLatencyMs(),downloadMs:e.getDownloadMs(),totalMs:e.getTotalMs(),parseMs:null},status:e.getStatus(),totalBytes:e.getMetrics().totalBytes}})},e}();t.ResourceAcquirer=n});e(u_);u_.ResourceAcquirer;var c_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AcquisitionResourceType=l_.AcquisitionResourceType,t.ResourceAcquirer=u_.ResourceAcquirer});e(c_);c_.AcquisitionResourceType,c_.ResourceAcquirer;var d_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("DiskStorageQueue"),r=function(){function e(){if(!xI.localStorage.capabilities.isSupported)throw new Ne.XpError("storage_queue.not_supported",void 0,"Local storage is not supported");this.storagePromise=Fe.Promise.resolve()}return e.prototype.addFragment=function(t,e){this.storagePromise=this.storagePromise.then(function(){return xI.localStorage.put(t,e)}).then(function(){}).catch(function(e){n.error("Storing segment data fails: "+t,e)})},e.prototype.flush=function(){return this.storagePromise},e}();t.DiskStorageQueue=r});e(d_);d_.DiskStorageQueue;var p_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.Constants={CIRCA_ONE_FRAME_MS:50}});e(p_);p_.Constants;var f_=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={}).Video=3*p_.Constants.CIRCA_ONE_FRAME_MS,n.Audio=0,n.TimedText=0,n);t.STREAM_TYPE_TO_ACCEPTABLE_SEGMENT_POSITION_ERROR_MS=r});e(f_);f_.STREAM_TYPE_TO_ACCEPTABLE_SEGMENT_POSITION_ERROR_MS;var h_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=lh,p=M.get("StreamDownloader"),n=function(){function e(e,t){var n=this;this.cancelDownloading=null,this.completedMediaFragmentsWithFailure=[],this.downloadContext=null,this.networkRequestManager=lh.getInstance(),this.pendingMediaFragments={},this.reportStateChange=function(){var e=n.initFragmentAcquirer.getDiagnostics();n.diagnostics.report("state",{pendingMediaFragments:Object.keys(n.pendingMediaFragments).map(function(e){return n.convertMediaFragment(n.pendingMediaFragments[e])}),initFragment:e.initFragments,completedInitFragmentsWithFailure:e.completedInitFragmentsWithFailure,completedMediaFragmentsWithFailure:n.completedMediaFragmentsWithFailure.map(n.convertMediaFragment),timestamp:Date.now()})},this.convertMediaFragment=function(e){return{segment:{periodId:e.periodId,streamId:e.streamId,index:e.segment.index},qualityLevelId:e.qualityLevelId,initialQueuedTime:e.initialQueuedTime,queuedTime:e.queuedTime,failureCount:e.failureCount,requestStartedTime:e.requestStartedTime,timeoutMs:e.timeoutMs,lastFailureReason:e.lastFailureReason,lastFailedTime:e.lastFailedTime}},this.sourceUrlStore=e,this.updateProgressCallback=t,this.diagnostics=pp.Diagnostics.create("StreamDownloader"),this.diskStorageQueue=new d_.DiskStorageQueue,this.fragmentRequestFactory=new s_.FragmentRequestFactory,this.initFragmentAcquirer=new s_.InitFragmentAcquirer(this.reportStateChange,4)}return e.prototype.start=function(o){var a=this;this.downloadContext=o;var e=Fe.CancelToken.source(),s=e.token,t=e.cancel;this.cancelDownloading=t,this.getProgressMetadata(s).then(function(e){s.throwIfRequested();var t=a.downloadContext.qualityLevel.segmentTimeline,n=(null==e||!e.isInitSegmentStored)&&"Unavailable"!==t.getInitSegment().type,r=n?a.registerInitFragmentRequest(o.streamType,s):Fe.Promise.resolve(),i=null!=e?e.storageHeadPositionMs:0;if(null==e||(!e.isFinalSegmentStored||n))return r.then(function(){s.throwIfRequested(),a.registerMediaFragmentAt(s,i)});p.warn("This task has been completed, should not have been scheduled.")}).catch(function(e){e instanceof Fe.CancelError||p.error("StreamDownloader failed with error:",e)})},e.prototype.stop=function(){return null!=this.cancelDownloading&&(this.cancelDownloading(),this.cancelDownloading=null),this.initFragmentAcquirer.stop(),this.cancelDownloading=null,this.completedMediaFragmentsWithFailure=[],this.downloadContext=null,this.pendingMediaFragments={},this.diskStorageQueue.flush()},e.prototype.registerMediaFragmentAt=function(t,n){var r=this;if(null!=this.downloadContext){var e=this.downloadContext.streamType,i=this.downloadContext.qualityLevel.segmentTimeline.getSegmentAt(n,f_.STREAM_TYPE_TO_ACCEPTABLE_SEGMENT_POSITION_ERROR_MS[e]);this.registerMediaFragment(e,t,i).catch(function(e){if(!(e instanceof Fe.CancelError))return p.error("Failed to acquire media fragment.",e),r.delay(500,t).then(function(){t.throwIfRequested(),r.registerMediaFragmentAt(t,n)})})}},e.prototype.registerNextMediaFragment=function(t,n){var r=this;if(null!=this.downloadContext){var e=this.downloadContext.streamType,i=this.downloadContext.qualityLevel.segmentTimeline.getNext(n.segment);this.registerMediaFragment(e,t,i).catch(function(e){t.requested||r.registerNextMediaFragment(t,n)})}},e.prototype.registerMediaFragment=function(i,o,e){var a=this;return this.getMediaSegmentInfo(o,e).then(function(r){if(o.throwIfRequested(),null!=r)return a.downloadMediaSegment(o,r).then(function(e){if(o.throwIfRequested(),null!=e){a.diskStorageQueue.addFragment(a.createSegmentId(r.segment),e.getArrayBuffer()),a.onRequestSucceed(e,r.segment.sourceUrl),a.reportStateChange();var t={isInitSegmentStored:!0,isFinalSegmentStored:r.segment.isFinalSegment,storageHeadPositionMs:r.segment.position.endTimeMs};return a.storeQualityLevelProgress(t)}}).then(function(){o.throwIfRequested();var e=a.downloadContext.period,t=a.downloadContext.qualityLevel,n=a.downloadContext.stream;a.updateProgressCallback({period:e,qualityLevel:t,stream:n,segmentInfo:r.segment}),r.segment.isFinalSegment?p.info(i+" Stream with qualityLevel: "+t.id+" has completed download for period "+e.id):a.registerNextMediaFragment(o,r)}).catch(function(e){throw e instanceof l.AcquisitionError&&a.onRequestFailed(e,r.segment.sourceUrl),e})})},e.prototype.getMediaSegmentInfo=function(t,e){var n=this.downloadContext.period,r=this.downloadContext.qualityLevel,i=this.downloadContext.streamType;return"Unavailable"===e.type?(p.warn(i+" media segment for quality "+r.id+" of period "+n.id+" is no longer available with reason: "+e.reason+". Ignoring it."),Fe.Promise.resolve(null)):("RefreshMe"===e.type?e.load():Fe.Promise.resolve(e)).then(function(e){return t.throwIfRequested(),"Unavailable"===e.type?(p.warn(i+" media segment for quality "+r.id+" of period "+n.id+" with reason: "+e.reason+". Ignoring request"),null):e})},e.prototype.downloadMediaSegment=function(n,t){var r=this;if(null==this.downloadContext)return Fe.Promise.resolve(null);var i=this.downloadContext.period,o=this.downloadContext.qualityLevel,e=this.downloadContext.stream,a=this.downloadContext.streamType,s=t.segment,l=a+"|"+i.id+"|"+e.id+"|"+o.id+"|"+s.index,u=null!=this.pendingMediaFragments[s.index]?this.pendingMediaFragments[s.index]:{periodId:i.id,streamId:e.id,qualityLevelId:o.id,segment:s,initialQueuedTime:null,queuedTime:null,requestStartedTime:null,failureCount:0};this.pendingMediaFragments[s.index]=u;var c={getRequestBuilder:function(e){return u.timeoutMs=s_.FragmentRequestConstants.SEGMENT_TIMEOUT_MS,u.requestStartedTime=Date.now(),r.reportStateChange(),r.fragmentRequestFactory.createMediaFragmentRequestBuilder(t.segment,s_.FragmentRequestConstants.SEGMENT_TIMEOUT_MS)},getPriority:function(){return 120},onCancelled:function(e){},description:l},d=Date.now();return 0===u.failureCount&&(u.initialQueuedTime=d),u.queuedTime=d,this.reportStateChange(),this.networkRequestManager.requestDownload(c,n).then(function(e){n.throwIfRequested();var t=e.getArrayBuffer();return s_.FragmentUtilities.validateDownloadedSegmentData(t,s),0<u.failureCount&&(4<=r.completedMediaFragmentsWithFailure.length&&r.completedMediaFragmentsWithFailure.shift(),r.completedMediaFragmentsWithFailure.push(u)),delete r.pendingMediaFragments[s.index],e}).catch(function(e){var t="Failed to acquire "+a+" init fragment for quality "+o.id+" on period "+i.id+": "+e;if(e instanceof Fe.CancelError&&(p.info("Acquisition canceled for "+a+" init fragment for quality "+o.id),n.requested))return delete r.pendingMediaFragments[s.index],r.reportStateChange(),null;throw p.error(t),u.lastFailedTime=Date.now(),u.lastFailureReason=t,u.failureCount++,r.reportStateChange(),e})},e.prototype.registerInitFragmentRequest=function(n,r){var i=this,e=this.downloadContext.period,o=this.downloadContext.qualityLevel,a=this.downloadContext.stream,s=function(){return 120};return this.initFragmentAcquirer.getInitSegmentInfo(n,r,e,o).then(function(t){if(r.throwIfRequested(),null!=t)return i.initFragmentAcquirer.downloadInitFragment(n,r,t,e,a,o,s).then(function(e){if(r.throwIfRequested(),null!=e){i.diskStorageQueue.addFragment(i.createSegmentId(t.segment),e.getArrayBuffer()),i.onRequestSucceed(e,t.segment.sourceUrl),i.reportStateChange();return i.storeQualityLevelProgress({isInitSegmentStored:!0,isFinalSegmentStored:!1,storageHeadPositionMs:0})}}).then(function(){r.throwIfRequested(),i.updateProgressCallback({period:e,qualityLevel:o,segmentInfo:t.segment,stream:a})}).catch(function(e){if(!(e instanceof Fe.CancelError))return e instanceof l.AcquisitionError&&i.onRequestFailed(e,t.segment.sourceUrl),i.delay(500,r).then(function(){return r.throwIfRequested(),i.registerInitFragmentRequest(n,r)})});p.warn("Init segment info was not found")})},e.prototype.onRequestFailed=function(e,t){"UnknownError"!==e.reason.type&&this.sourceUrlStore.resourceAcquisitionFailed(e.reason,c_.AcquisitionResourceType.Fragment,t.urlId)},e.prototype.onRequestSucceed=function(e,t){var n={body:"",headers:e.getHeaders(),timing:{latencyMs:e.getLatencyMs(),downloadMs:e.getDownloadMs(),totalMs:e.getTotalMs(),parseMs:null},status:e.getStatus(),sourceUrl:t};this.sourceUrlStore.resourceAcquired(n)},e.prototype.getProgressMetadata=function(t){return RI.metadataStorage.get(this.createQualityLevelKey()).then(function(e){return t.throwIfRequested(),e})},e.prototype.storeQualityLevelProgress=function(e){return RI.metadataStorage.put(this.createQualityLevelKey(),e)},e.prototype.createQualityLevelKey=function(){var e=this.downloadContext.downloadOperationId,t=this.downloadContext.period.id,n=this.downloadContext.stream.id,r=this.downloadContext.qualityLevel.id;return AI.createQualityLevelProgressMetadataKey(e,t,n,r)},e.prototype.createSegmentId=function(e){var t=this.downloadContext.downloadOperationId,n=this.downloadContext.period.id,r=this.downloadContext.stream.id,i=this.downloadContext.qualityLevel.id;return TE.createLocalStorageSegmentId(t,n,r,i,e)},e.prototype.delay=function(r,i){return new Fe.Promise(function(e,t){var n=A.timer.setTimeout(e,r);i.promise.then(function(e){A.timer.clearTimeout(n),t(e)})})},e}();t.StreamDownloader=n});e(h_);h_.StreamDownloader;var m_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.mediaRepresentation=e,this.mediaRepresentationQuerier=TE.MediaRepresentationQuerier.for(e)}return e.prototype.orderStreams=function(e,t){for(var n=[],r=0,i=this.mediaRepresentation.periods.contents;r<i.length;r++)for(var o=i[r],a=t[o.id],s=0,l=e;s<l.length;s++)for(var u=l[s],c=0,d=a[u];c<d.length;c++){var p=d[c];if(null!=p){var f=this.mediaRepresentationQuerier.itemById(o.id).streamById(p.streamId),h=f.value(),m=f.qualityLevelById(p.qualityLevelId).value();if(null!=h&&null!=m){n.push({periodId:o.id,qualityLevel:m,stream:h,type:u});break}}}return n},e}();t.BasicStreamDownloadOrderStrategy=n});e(m_);m_.BasicStreamDownloadOrderStrategy;var y_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=M.get("DownloadScheduler"),n=function(){function e(e,t,n,r,i){var o=this;this.availableStreamDownloaders=[],this.downloadProgressMetadata=null,this.remainingStreamsToDownload=[],this.streamTypes=["Video","Audio"],this.usedStreamDownloaders={},this.updateProgress=function(e){if(!e.segmentInfo.isInitSegment){var t=e.segmentInfo,n=AI.createQualityLevelProgressMetadataKey(o.downloadOperationId,e.period.id,e.stream.id,e.qualityLevel.id);if(t.isFinalSegment){if(null==o.usedStreamDownloaders[n])return;o.availableStreamDownloaders.push(o.usedStreamDownloaders[n]),delete o.usedStreamDownloaders[n],o.queueTasksForDownload(),0===o.remainingStreamsToDownload.length&&0===Object.keys(o.usedStreamDownloaders).length&&o.completionCallback()}else null==o.downloadProgressMetadata||F.contains(o.downloadProgressMetadata.qualityLevelKeys,n)||(o.downloadProgressMetadata.qualityLevelKeys.push(n),o.storeDownloadProgressMetadata(o.downloadProgressMetadata))}},this.contentConfig=e,this.downloadOperationId=t,this.mediaRepresentation=n,this.sourceUrlStore=r,this.completionCallback=i,this.streamDownloadOrderStrategy=new m_.BasicStreamDownloadOrderStrategy(n)}return e.prototype.initialize=function(e){var t=this;p.info(">> initialize");for(var n=0;n<1;n++)this.availableStreamDownloaders.push(new h_.StreamDownloader(this.sourceUrlStore,this.updateProgress));return this.acquireDownloadProgressMetadata().then(function(){return t.filterSelectionContext(e)}).then(function(e){p.info(">>> filtered selection context:",JSON.stringify(e)),t.remainingStreamsToDownload=t.streamDownloadOrderStrategy.orderStreams(t.streamTypes,e)})},e.prototype.start=function(){0!==this.remainingStreamsToDownload.length?this.queueTasksForDownload():p.error("There are not streams to be downloaded")},e.prototype.stop=function(){for(var e=[],t=0,n=Object.keys(this.usedStreamDownloaders);t<n.length;t++){var r=n[t];e.push(this.usedStreamDownloaders[r].stop()),delete this.usedStreamDownloaders[r]}return null!=this.downloadProgressMetadata&&e.push(this.storeDownloadProgressMetadata(this.downloadProgressMetadata)),this.availableStreamDownloaders=[],this.streamTypes=["Video","Audio"],this.downloadProgressMetadata=null,this.remainingStreamsToDownload=[],Fe.Promise.all(e).then(function(){})},e.prototype.acquireDownloadProgressMetadata=function(){var t=this;return RI.metadataStorage.get(AI.createDownloadProgressMetadataKey(this.downloadOperationId)).then(function(e){t.downloadProgressMetadata=null==e?{qualityLevelKeys:[]}:e})},e.prototype.filterSelectionContext=function(l){for(var u=[],c=!1,e=function(i){if(null==l[i.id])return p.error("Period "+i.id+" doesn't have streams to download"),{value:Fe.Promise.reject(new Ne.XpError("download_scheduler.no_period_streams",void 0,"Unable to find a streams to download for period "+i.id))};for(var o=l[i.id],e=0,t=iE.CRITICAL_STREAM_TYPES;e<t.length;e++){var n=t[e];if(null==o[n])return{value:Fe.Promise.reject(new Ne.XpError("download_scheduler.no_critical_stream_download",void 0,"Unable to find a critical stream to download for type "+n))}}for(var r=function(r){"TimedText"===r&&(c=!0);for(var e=function(t){var n=AI.createQualityLevelProgressMetadataKey(d.downloadOperationId,i.id,t.streamId,t.qualityLevelId),e=RI.metadataStorage.get(n).then(function(e){p.info("Retrieved persistent single task progress metadata:",n,JSON.stringify(e));return{completedDownload:null!=e&&e.isFinalSegmentStored,periodId:i.id,qualityLevelId:t.qualityLevelId,streamId:t.streamId,streamType:r}});u.push(e)},t=0,n=o[r];t<n.length;t++){e(n[t])}},a=0,s=Object.keys(o);a<s.length;a++){r(n=s[a])}},d=this,t=0,n=this.mediaRepresentation.periods.contents;t<n.length;t++){var r=e(n[t]);if("object"==typeof r)return r.value}return c&&this.streamTypes.push("TimedText"),Fe.Promise.all(u).then(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],o=i.completedDownload,a=i.periodId,s=i.qualityLevelId,l=i.streamId,u=i.streamType;null==t[a]&&(t[a]={}),null==t[a][u]&&(t[a][u]=[]),o?t[a][u].push(null):t[a][u].push({qualityLevelId:s,streamId:l})}return t})},e.prototype.queueTasksForDownload=function(){for(;0!==this.availableStreamDownloaders.length&&0!==this.remainingStreamsToDownload.length;){var e=this.remainingStreamsToDownload.shift(),t=this.availableStreamDownloaders.shift(),n=AI.createQualityLevelProgressMetadataKey(this.downloadOperationId,e.periodId,e.stream.id,e.qualityLevel.id);this.usedStreamDownloaders[n]=t;var r=TE.MediaRepresentationQuerier.for(this.mediaRepresentation).itemById(e.periodId).value();if(null==r)throw p.error("Period "+e.periodId+" doesn't exist within the media representation"),new Ne.XpError("download_scheduler.no_period",void 0,"Unable to find a matching period in representation for period "+e.periodId);t.start({downloadOperationId:this.downloadOperationId,period:r,qualityLevel:e.qualityLevel,stream:e.stream,streamType:e.type})}},e.prototype.storeDownloadProgressMetadata=function(e){return RI.metadataStorage.put(AI.createDownloadProgressMetadataKey(this.downloadOperationId),e)},e}();t.DownloadScheduler=n});e(y_);y_.DownloadScheduler;var g_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("LicenseManager"),n=function(){function e(e,t,n,r){var i=this;this.cancelTokenPair=null,this.deferredLicenseRequests=null,this.expectedLicenseRefreshRequests=0,this.licenseRefreshRequestCount=0,this.onLicenseAcquired=function(e){if(o.info("Successfully acquired license"),i.updateLicenseMetadataItems(e.keyId,e.keyMetadata)){var t=i.createPersistentLicenseMetadata();null!=t&&RI.metadataStorage.put(AI.createPersistentLicenseMetadataKey(i.downloadOperationId),t)}},this.onMediaKeysManagerError=function(e){i.handleFatalError(e)},this.onRefreshLicenseAcquired=function(e){o.info("Successfully refreshed license"),i.licenseRefreshRequestCount++,i.updateLicenseMetadataItems(e.keyId,e.keyMetadata),null!=i.deferredLicenseRequests&&i.licenseRefreshRequestCount===i.expectedLicenseRefreshRequests&&(i.deferredLicenseRequests.resolve(),i.deferredLicenseRequests=null)},this.onRefreshLicenseError=function(e){var t=i.convertError(e);null!=i.deferredLicenseRequests&&(i.deferredLicenseRequests.reject(t),i.deferredLicenseRequests=null),i.unload()},this.getLicense=e,this.mediaKeysManager=t,this.deferredLoad=new Fe.Deferred,this.initializationDataGenerator=new iE.InitializationDataGenerator(n),this.licenseMetadataItems=[],this.downloadOperationId=r}return e.prototype.load=function(){var e=this;if(!RI.metadataStorage.capabilities.isSupported)return Fe.Promise.reject(new Ne.XpError("download.drm.not_supported"));if(null!=this.cancelTokenPair)return o.info("Another load already initiated, ignore."),Fe.Promise.resolve();this.cancelTokenPair=Fe.CancelToken.source();var t=this.cancelTokenPair.token;return this.mediaKeysManager.on("licenseAcquired",this.onLicenseAcquired),this.mediaKeysManager.on("error",this.onMediaKeysManagerError),this.loadPersistentLicenseMetadata(t).then(function(){return t.throwIfRequested(),e.createMediaKeySessions(t)}).then(function(){t.throwIfRequested(),e.deferredLoad.resolve()}),this.deferredLoad.promise},e.prototype.refresh=function(){var t=this;if(!RI.metadataStorage.capabilities.isSupported)return Fe.Promise.reject(new Ne.XpError("download.drm.not_supported"));null!=this.cancelTokenPair&&(this.cancelTokenPair.cancel(),null!=this.deferredLicenseRequests&&this.deferredLicenseRequests.reject(new Fe.CancelError),this.cancelTokenPair=null),this.cancelTokenPair=Fe.CancelToken.source();var n=this.cancelTokenPair.token;return this.deferredLicenseRequests=new Fe.Deferred,this.mediaKeysManager.on("licenseAcquired",this.onRefreshLicenseAcquired),this.mediaKeysManager.on("error",this.onRefreshLicenseError),this.loadPersistentLicenseMetadata(n).then(function(){return n.throwIfRequested(),t.createMediaKeySessions(n,!0)}).then(function(){n.throwIfRequested();var e=t.getOldDuplicateLicenseMetadata();return 0===e.length?t.deferredLicenseRequests.resolve():t.expectedLicenseRefreshRequests=e.length,t.deferredLicenseRequests.promise.then(function(){return e})}).then(function(e){return n.throwIfRequested(),t.mediaKeysManager.off("licenseAcquired",t.onRefreshLicenseAcquired),t.mediaKeysManager.off("error",t.onRefreshLicenseError),t.removeTrackedOldLicenses(e)})},e.prototype.unload=function(){null!=this.cancelTokenPair&&(this.cancelTokenPair.cancel(),this.cancelTokenPair=null),this.deferredLoad=new Fe.Deferred,this.mediaKeysManager.off("licenseAcquired",this.onLicenseAcquired),this.mediaKeysManager.off("error",this.onMediaKeysManagerError),this.mediaKeysManager.reset(),this.licenseMetadataItems=[]},e.prototype.applyInitData=function(e,t,n){var r=this,i=[this.mediaKeysManager.applyInitData(e,t,function(e,t){return n.requested?Fe.Promise.reject(new Fe.CancelError):r.getLicense(e,t,n)},!0),this.mediaKeysManager.extractKeyId(t)];return Fe.Promise.all(i).then(function(e){var t=e[0],n=e[1];null!=t&&null!=n?r.licenseMetadataItems.push({sessionId:t,keyId:n}):o.error("Failed to create sessionId or keyId")}).catch(function(e){if(e instanceof Fe.CancelError)throw e;o.error("Failed to apply initialization data",e),r.handleFatalError(e)})},e.prototype.convertError=function(e){return e instanceof Ne.XpError&&-1!==e.code.indexOf("xp.system")?e:Ne.XpError.generatePrefixedError(e,"download.drm")},e.prototype.createMediaKeySessions=function(n,r){var i=this;void 0===r&&(r=!1);for(var o=[],e=function(t){if(null!=a.mediaKeysManager.getKeyMetadata(t.data)&&!r)return"continue";var e=(r?Fe.Promise.resolve(!0):a.shouldApplyInitData(t.data,n)).then(function(e){if(n.throwIfRequested(),e)return i.applyInitData(t.type,t.data,n)});o.push(e)},a=this,t=0,s=this.getInitializationData();t<s.length;t++){e(s[t])}return Fe.Promise.all(o)},e.prototype.getInitializationData=function(){return this.initializationDataGenerator.getInitializationData().map(function(e){return{type:"cenc",data:e}})},e.prototype.getOldDuplicateLicenseMetadata=function(){for(var n=[],e=function(e){var t=r.licenseMetadataItems[e];e!==F.findLastIndex(r.licenseMetadataItems,function(e){return e.keyId===t.keyId})&&null!=t.sessionId&&n.push(t)},r=this,t=0;t<this.licenseMetadataItems.length;t++)e(t);return n},e.prototype.handleFatalError=function(e){var t=this.convertError(e);this.deferredLoad.reject(t),this.unload()},e.prototype.loadPersistentLicenseMetadata=function(n){var r=this;return RI.metadataStorage.get(AI.createPersistentLicenseMetadataKey(this.downloadOperationId)).then(function(e){if(n.throwIfRequested(),null!=e){var t=e;r.licenseMetadataItems=t.metadataList}}).catch(function(e){if(!(e instanceof Fe.CancelError))throw o.error("Failed to load persistent license metadata",e),e})},e.prototype.removeTrackedOldLicenses=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.push(this.mediaKeysManager.removeLicense(i.sessionId))}for(var o=[],a=function(t){-1===F.findIndex(e,function(e){return e.sessionId===t.sessionId})&&o.push(t)},s=0,l=this.licenseMetadataItems;s<l.length;s++){a(l[s])}this.licenseMetadataItems=o;var u=this.createPersistentLicenseMetadata();return null!=u&&t.push(RI.metadataStorage.put(AI.createPersistentLicenseMetadataKey(this.downloadOperationId),u)),Fe.Promise.all(t).then(function(){})},e.prototype.shouldApplyInitData=function(e,n){var r=this;return this.mediaKeysManager.extractKeyId(e).then(function(t){return n.throwIfRequested(),F.findIndex(r.licenseMetadataItems,function(e){return e.keyId===t})<0}).catch(function(e){if(e instanceof Fe.CancelError)throw e;return!0})},e.prototype.updateLicenseMetadataItems=function(t,e){var n=F.findLastIndex(this.licenseMetadataItems,function(e){return e.keyId===t});return n<0?(o.info("None of existing license metadata items match the keyId:",t),!1):!!e.some(function(e){return"CONTENT"===e.keyType})&&(this.licenseMetadataItems[n].keyMetadata=e,!0)},e.prototype.createPersistentLicenseMetadata=function(){for(var e={metadataList:[]},t=0,n=this.licenseMetadataItems;t<n.length;t++){var r=n[t];null!=r.keyMetadata&&e.metadataList.push(r)}return 0===e.metadataList.length?null:e},e}();t.LicenseManager=n});e(g_);g_.LicenseManager;var v_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.streamAlternators={},this.mediaRepresentation=e,this.streamSelector=new iE.StreamSelector,this.streamTypes=this.extractStreamTypes();for(var t=0,n=this.streamTypes;t<n.length;t++){var r=n[t];this.streamAlternators[r]=new iE.streamAlternatorTypeMap[r]}}return e.prototype.selectDownloadableStreams=function(e,t,n){for(var r={},i=0,o=this.streamTypes;i<o.length;i++){var a=o[i],s=[];"Audio"===a?s=t:"TimedText"===a&&(s=n),this.selectMultipleStreamsForType(a,r,s,e)}return r},e.prototype.selectMultipleStreamsForType=function(e,t,n,r){if(0===n.length)this.streamSelector.setMatchers(e,[]),this.streamAlternators[e].uninitialize(),this.initializeStreamAlternator(e),this.addSelectionContextForMatcher(e,t,r);else for(var i=0,o=n;i<o.length;i++){var a=o[i];this.streamSelector.setMatchers(e,a),this.streamAlternators[e].uninitialize(),this.initializeStreamAlternator(e),this.addSelectionContextForMatcher(e,t,r)}},e.prototype.addSelectionContextForMatcher=function(e,t,n){for(var r=0,i=this.mediaRepresentation.periods.contents;r<i.length;r++){var o=i[r];null==t[o.id]&&(t[o.id]={});var a=this.streamSelector.selectStreams(o,e),s=this.streamAlternators[e].selectStream(a);if(null!=s&&0!==s.qualityLevels.length){var l=s.qualityLevels[0];if("Video"===e)for(var u=s.qualityLevels.length-1;0<=u;u--){var c=s.qualityLevels[u];if(c.bandwidth<=n){l=c;break}}else l=s.qualityLevels[s.qualityLevels.length-1];null==t[o.id][e]&&(t[o.id][e]=[]),t[o.id][e].push({qualityLevelId:l.id,streamId:s.id})}}},e.prototype.extractStreamTypes=function(){for(var e={},t=0,n=this.mediaRepresentation.periods.contents;t<n.length;t++)for(var r=0,i=n[t].streams;r<i.length;r++){e[i[r].type]=!0}return Object.keys(e)},e.prototype.initializeStreamAlternator=function(t){var n=this,e=this.mediaRepresentation.periods.contents.map(function(e){return n.streamSelector.selectStreams(e,t)});this.streamAlternators[t].initialize(e)},e}();t.DownloadableStreamsSelector=n});e(v_);v_.DownloadableStreamsSelector;var S_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("ContentDownloaderFragment"),n=function(){function a(e,t,n,r,i,o,a,s,l){var u=this;this.onDownloadCompleted=function(){u.eventEmitter.emit("Completed")},this.maxVideoBitrate=o,this.audioStreamMatchers=s,this.timedTextStreamMatchers=l,this.downloadScheduler=new y_.DownloadScheduler(e,t,i,a,this.onDownloadCompleted),this.downloadableStreamsSelector=new v_.DownloadableStreamsSelector(i),this.eventEmitter=new Dt.EventEmitter,this.licenseManager=new g_.LicenseManager(n,r,i,t),this.selectionContextMetadataKey=AI.createSelectionContextKey(t)}return a.delete=function(t){return xI.localStorage.removePrefix(AI.createDownloadOperationStoragePrefixKey(t)).then(function(){return a.deleteSelectionContext(t)}).then(function(){return RI.metadataStorage.get(AI.createDownloadProgressMetadataKey(t))}).then(function(e){if(null!=e)return a.deleteProgressMetadata(t,e);r.warn("No progress metadata found for downloadOperationId",t)}).then(function(){return a.removeLicense(t)})},a.prototype.refresh=function(){return r.info(">> refresh"),this.licenseManager.refresh()},a.prototype.start=function(){var e=this;r.info(">> start");var t=this.downloadableStreamsSelector.selectDownloadableStreams(this.maxVideoBitrate,this.audioStreamMatchers,this.timedTextStreamMatchers);return this.storeSelectionContext(t).then(function(){return e.downloadScheduler.initialize(t)}).then(function(){return Fe.Promise.all([e.licenseManager.load(),e.downloadScheduler.start()])}).then(function(){})},a.prototype.stop=function(){return r.info(">> stop"),this.licenseManager.unload(),this.downloadScheduler.stop()},a.prototype.on=function(e,t){this.eventEmitter.on(e,t)},a.prototype.off=function(e,t){this.eventEmitter.off(e,t)},a.deleteProgressMetadata=function(e,t){r.info("Deleting quality level progress metadata",JSON.stringify(t.qualityLevelKeys));var n=t.qualityLevelKeys.map(function(e){return RI.metadataStorage.remove(e)});return Fe.Promise.all(n).then(function(){return RI.metadataStorage.remove(AI.createDownloadProgressMetadataKey(e))})},a.deleteSelectionContext=function(e){return RI.metadataStorage.remove(AI.createSelectionContextKey(e))},a.removeLicense=function(t){var o=AI.createPersistentLicenseMetadataKey(t);return RI.metadataStorage.get(o).then(function(e){if(null!=e&&null!=a.mediaKeysManager){for(var t=[],n=0,r=e.metadataList;n<r.length;n++){var i=r[n].sessionId;t.push(a.mediaKeysManager.removeLicense(i))}return Fe.Promise.all(t).then(function(){return RI.metadataStorage.remove(o)})}}).catch(function(e){r.error("Fail to remove license of "+t,e)})},a.prototype.storeSelectionContext=function(e){return RI.metadataStorage.put(this.selectionContextMetadataKey,e)},a.mediaKeysManager=null,a}();t.ContentDownloaderFragment=n});e(S_);S_.ContentDownloaderFragment;var b_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ContentDownloaderFragment=S_.ContentDownloaderFragment,t.createDownloadOperationStoragePrefixKey=AI.createDownloadOperationStoragePrefixKey,t.createDownloadProgressMetadataKey=AI.createDownloadProgressMetadataKey,t.createPersistentLicenseMetadataKey=AI.createPersistentLicenseMetadataKey,t.createQualityLevelProgressMetadataKey=AI.createQualityLevelProgressMetadataKey,t.createSelectionContextKey=AI.createSelectionContextKey,t.DownloadableStreamsSelector=v_.DownloadableStreamsSelector});e(b_);b_.ContentDownloaderFragment,b_.createDownloadOperationStoragePrefixKey,b_.createDownloadProgressMetadataKey,b_.createPersistentLicenseMetadataKey,b_.createQualityLevelProgressMetadataKey,b_.createSelectionContextKey,b_.DownloadableStreamsSelector;var T_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("MediaKeySessionManager");var n=function(){function e(e,t,n){var r=this;this.onMessageEvent=function(e){try{switch(e.messageType){case"license-request":var t=e.message;r.requestLicense(new Uint8Array(t));break;case"certificate-request":i.warn("'certificate-request' received. Not handled");break;case"key-id-request":i.warn("'key-id-request' received. Not handled");break;case"license-renewal":case"license-release":case"individualization-request":i.warn("Unexpected media key message:",e);break;default:!function(e){throw new Ne.XpError("media_key_session.invalid_message_type",void 0,"Reached code that should not be reachable")}(e.messageType)}}catch(e){i.error("MediaKeySession 'message' handler error:",e),r.onSessionError(e)}},this.onKeyStatusesChange=function(){try{r.mediaKeySession.keyStatuses.forEach(function(e,t){var n="[keystatuschange] sessionId:"+r.mediaKeySession.sessionId+"; keyId:"+tb.encode(t)+"; keyStatus:"+e;"internal-error"===e?(i.error(n),r.onSessionError(new Ne.XpError("internal_error"))):i.info(n)})}catch(e){i.error("MediaKeySession 'keystatuseschange' handler error:",e),r.onSessionError(e)}},this.mediaKeySession=e,this.getLicenseData=null,this.onSessionError=t,this.hdcpStore=n}return Object.defineProperty(e.prototype,"expiration",{get:function(){return this.mediaKeySession.expiration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.mediaKeySession.sessionId},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){this.mediaKeySession.on("message",this.onMessageEvent),this.mediaKeySession.on("keystatuseschange",this.onKeyStatusesChange),this.mediaKeySession.on("keystatuseschange",this.hdcpStore.updateHdcpStatus)},e.prototype.terminate=function(){this.mediaKeySession.off("message",this.onMessageEvent),this.mediaKeySession.off("keystatuseschange",this.onKeyStatusesChange),this.mediaKeySession.off("keystatuseschange",this.hdcpStore.updateHdcpStatus),this.mediaKeySession.close().then(function(){i.info("MediaKeySession closed")}).catch(function(e){i.warn("MediaKeySession failed while closing.",e)})},e.prototype.applyInitData=function(e,t,n){return this.getLicenseData=n,this.mediaKeySession.generateRequest(e,t)},e.prototype.load=function(t){var n=this;return this.mediaKeySession.load(t).catch(function(e){return i.error("Error when loading mediaKeySession, sessionId: "+t+", Error:",e),n.onSessionError(e,!1),!1})},e.prototype.remove=function(){var t=this;return this.mediaKeySession.remove().catch(function(e){i.error("Error when removing mediaKeySession, sessionId: "+t.sessionId+". Error:",e),t.onSessionError(e)})},e.prototype.requestLicense=function(e){var t=this,n=this.mediaKeySession;if(null==this.getLicenseData){var r=new Ne.XpError("media_key_session.invalid_state",void 0,"About to send license acquisiton request, but license data acquisition callback is missing");return i.error("Unable to make license request for sessionId: "+n.sessionId+". Error:",r),void this.onSessionError(r)}i.info("Start to acquire license for sessionId: "+n.sessionId+"."),this.getLicenseData(e).then(function(e){return n.update(e)}).then(function(){i.info("Successfully set license for sessionId: "+n.sessionId+".")}).catch(function(e){e instanceof Fe.CancelError||(i.error("Failed to set license",e),t.onSessionError(e))})},e}();t.MediaKeySessionManager=n});e(T_);T_.MediaKeySessionManager;var P_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.session=e}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.session.sessionId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"expiration",{get:function(){return this.session.expiration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closed",{get:function(){return this.session.closed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyStatuses",{get:function(){return this.session.keyStatuses},enumerable:!0,configurable:!0}),e.prototype.generateRequest=function(e,t){return this.session.generateRequest(e,AE.BinaryUtils.convertBufferSourceToUint8Array(t))},e.prototype.load=function(e){return this.session.load(e)},e.prototype.update=function(e){return this.session.update(AE.BinaryUtils.convertBufferSourceToUint8Array(e))},e.prototype.close=function(){return this.session.close()},e.prototype.remove=function(){return this.session.remove()},e.prototype.on=function(e,t){this.session.addEventListener(e,t)},e.prototype.off=function(e,t){this.session.removeEventListener(e,t)},e}();t.MediaKeySessionW3C=n});e(P_);P_.MediaKeySessionW3C;var w_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("MediaKeysW3C"),r=function(){function e(e){this.hdcpTestKeyId=null,this.hdcpTestKeySession=null,this.supportsGetStatusForPolicy=!0,this.mediaKeys=e}return e.prototype.createSession=function(e){return new P_.MediaKeySessionW3C(this.mediaKeys.createSession(e))},Object.defineProperty(e.prototype,"mediaKeysW3C",{get:function(){return this.mediaKeys},enumerable:!0,configurable:!0}),e.prototype.setServerCertificate=function(e){return this.mediaKeys.setServerCertificate(AE.BinaryUtils.convertBufferSourceToUint8Array(e)).then(function(e){return xt.withDefault(e,!0)})},e.prototype.getStatusForPolicy=function(e){var t=this;return null!=this.mediaKeys.getStatusForPolicy?this.supportsGetStatusForPolicy?Fe.Promise.resolve().then(function(){return t.mediaKeys.getStatusForPolicy(e)}).catch(function(e){return t.supportsGetStatusForPolicy=!1,n.warn("mediaKeys.getStatusForPolicy failed with",e),"output-restricted"}):Fe.Promise.resolve("output-restricted"):null!=this.hdcpTestKeySession&&null!=this.hdcpTestKeyId&&"1.4"===e.minHdcpVersion&&"usable"===this.hdcpTestKeySession.keyStatuses.get(this.hdcpTestKeyId)?Fe.Promise.resolve("usable"):Fe.Promise.resolve("output-restricted")},e.prototype.setHdcpTestKeyId=function(e,t){this.hdcpTestKeyId=t,this.hdcpTestKeySession=e},e.prototype.onError=function(e){},e.prototype.offError=function(e){},e}();t.MediaKeysW3C=r});e(w_);w_.MediaKeysW3C;var C_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i={"com.widevine.alpha":[[{initDataTypes:["cenc"],audioCapabilities:[{contentType:"audio/mp4; codecs=\"mp4a.40.2\"",robustness:"HW_SECURE_CRYPTO"},{contentType:"audio/mp4; codecs=\"mp4a.40.2\"",robustness:"SW_SECURE_CRYPTO"}],videoCapabilities:[{contentType:"video/mp4; codecs=\"avc1.4D401E\"",robustness:"HW_SECURE_ALL"},{contentType:"video/mp4; codecs=\"avc1.4D401E\"",robustness:"SW_SECURE_DECODE"}]}],[{initDataTypes:["cenc"],videoCapabilities:[{contentType:"video/mp4; codecs=\"avc1.4D401E\"",robustness:"HW_SECURE_DECODE"},{contentType:"video/mp4; codecs=\"avc1.4D401E\"",robustness:"SW_SECURE_DECODE"}]}],[{initDataTypes:["cenc"],videoCapabilities:[{contentType:"video/mp4; codecs=\"avc1.640028\""}]}]],"com.microsoft.playready":[[{initDataTypes:["cenc"],audioCapabilities:[{contentType:"audio/mp4; codecs=\"mp4a.40.2\""}],videoCapabilities:[{contentType:"video/mp4; codecs=\"avc1.4D401E\""}]}]]};t.configurations=i;var n=function(){function r(){}return r.tryCreate=function(e,t){return navigator.requestMediaKeySystemAccess(e,t).then(function(e){return e.createMediaKeys()}).then(function(e){return new w_.MediaKeysW3C(e)})},r.create=function(n){return i[n].reduce(function(e,t){return null===e?r.tryCreate(n,t):e.catch(function(e){return r.tryCreate(n,t)})},null)},r}();t.MediaKeyFactoryW3C=n});e(C_);C_.configurations,C_.MediaKeyFactoryW3C;var M_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeyFactory=C_.MediaKeyFactoryW3C,t.MediaKeySession=P_.MediaKeySessionW3C,t.MediaKeys=w_.MediaKeysW3C});e(M_);M_.MediaKeyFactory,M_.MediaKeySession,M_.MediaKeys;var I_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.hdcpTestKeyId=null,this.hdcpTestKeySession=null,this.internalMediaKeysW3C=e}return e.prototype.createSession=function(e){return this.internalMediaKeysW3C.createSession(e)},Object.defineProperty(e.prototype,"mediaKeysW3C",{get:function(){return this.internalMediaKeysW3C.mediaKeysW3C},enumerable:!0,configurable:!0}),e.prototype.setServerCertificate=function(e){return this.internalMediaKeysW3C.setServerCertificate(e)},e.prototype.getStatusForPolicy=function(e){return null!==this.hdcpTestKeySession&&null!==this.hdcpTestKeyId&&"1.4"===e.minHdcpVersion&&"usable"===this.hdcpTestKeySession.keyStatuses.get(this.hdcpTestKeyId)?Fe.Promise.resolve("usable"):this.internalMediaKeysW3C.getStatusForPolicy(e)},e.prototype.setHdcpTestKeyId=function(e,t){this.hdcpTestKeyId=t,this.hdcpTestKeySession=e,this.internalMediaKeysW3C.setHdcpTestKeyId(e,t)},e.prototype.onError=function(e){this.internalMediaKeysW3C.onError(e)},e.prototype.offError=function(e){this.internalMediaKeysW3C.offError(e)},e}();t.MediaKeysChromium=n});e(I_);I_.MediaKeysChromium;var E_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.create=function(e){return M_.MediaKeyFactory.create(e).then(function(e){return new I_.MediaKeysChromium(e)})},e}();t.MediaKeyFactoryChromium=n});e(E_);E_.MediaKeyFactoryChromium;var __=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeyFactory=E_.MediaKeyFactoryChromium,t.MediaKeys=I_.MediaKeysChromium,t.MediaKeySession=M_.MediaKeySession});e(__);__.MediaKeyFactory,__.MediaKeys,__.MediaKeySession;var x_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.mediaKeyStatusMap=e}return Object.defineProperty(e.prototype,"size",{get:function(){return this.mediaKeyStatusMap.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this.mediaKeyStatusMap.has(e)},e.prototype.get=function(e){return this.mediaKeyStatusMap.get(e)},e.prototype.forEach=function(n){this.mediaKeyStatusMap.forEach(function(e,t){"string"==typeof t?n(t,e):n(e,t)})},e}();t.MediaKeyStatusMapEdge=n});e(x_);x_.MediaKeyStatusMapEdge;var k_=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this,e)||this;return t.mediaKeyStatuses=new x_.MediaKeyStatusMapEdge(e.keyStatuses),t}return i(e,n),Object.defineProperty(e.prototype,"keyStatuses",{get:function(){return this.mediaKeyStatuses},enumerable:!0,configurable:!0}),e}(M_.MediaKeySession);t.MediaKeySessionEdge=n});e(k_);k_.MediaKeySessionEdge;var R_=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentSession=null,e.msGraphicsTrust=null,e}return n(e,t),e.prototype.createSession=function(e){var t=this.mediaKeysW3C.createSession(e),n=new k_.MediaKeySessionEdge(t);return this.currentSession=n},Object.defineProperty(e.prototype,"session",{get:function(){return this.currentSession},enumerable:!0,configurable:!0}),e.prototype.clearCurrentSession=function(){this.currentSession=null},e.prototype.getStatusForPolicy=function(e){return Number(e.minHdcpVersion)<=1.4&&(null==this.msGraphicsTrust||!this.msGraphicsTrust.constrictionActive)?Fe.Promise.resolve("usable"):Fe.Promise.resolve("output-restricted")},e.prototype.setMsGraphicsTrust=function(e){this.msGraphicsTrust=e},e}(M_.MediaKeys);t.MediaKeysEdge=i});e(R_);R_.MediaKeysEdge;var A_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={"com.microsoft.playready":[{initDataTypes:["cenc"],audioCapabilities:[{contentType:"audio/mp4; codecs=\"mp4a.40.2\""}],videoCapabilities:[{contentType:"video/mp4; codecs=\"avc1.4D401E\""}]}]},r=function(){function t(){}return t.requestAccess=function(e){return navigator.requestMediaKeySystemAccess(e,n[e])},t.create=function(e){return t.requestAccess(e).then(function(e){return e.createMediaKeys()}).then(function(e){return new R_.MediaKeysEdge(e)})},t}();t.MediaKeyFactoryEdge=r});e(A_);A_.MediaKeyFactoryEdge;var O_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeys=R_.MediaKeysEdge,t.MediaKeyFactory=A_.MediaKeyFactoryEdge,t.MediaKeySession=k_.MediaKeySessionEdge});e(O_);O_.MediaKeys,O_.MediaKeyFactory,O_.MediaKeySession;var L_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.internalMediaKeysChromium=e}return e.prototype.createSession=function(e){return this.internalMediaKeysChromium.createSession(e)},Object.defineProperty(e.prototype,"mediaKeysW3C",{get:function(){return this.internalMediaKeysChromium.mediaKeysW3C},enumerable:!0,configurable:!0}),e.prototype.setServerCertificate=function(e){return this.internalMediaKeysChromium.setServerCertificate(e)},e.prototype.getStatusForPolicy=function(e){return this.shouldRejectGetStatusForPolicy(e)?Fe.Promise.resolve("output-restricted"):this.internalMediaKeysChromium.getStatusForPolicy(e)},e.prototype.setHdcpTestKeyId=function(e,t){this.internalMediaKeysChromium.setHdcpTestKeyId(e,t)},e.prototype.onError=function(e){this.internalMediaKeysChromium.onError(e)},e.prototype.offError=function(e){this.internalMediaKeysChromium.offError(e)},e.prototype.shouldRejectGetStatusForPolicy=function(e){return Xh.getOperatingSystem().getFamily()===Xh.OperatingSystemFamily.Windows&&Xh.getBrowser().getType()===Xh.BrowserType.EdgeNext&&"2.2"===e.minHdcpVersion},e}();t.MediaKeysEdgeNext=n});e(L_);L_.MediaKeysEdgeNext;var F_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="com.widevine.alpha",r="com.microsoft.playready",i=function(){function e(){}return e.create=function(e){return Xh.getOperatingSystem().getFamily()===Xh.OperatingSystemFamily.Mac?e===n?__.MediaKeyFactory.create(n).then(function(e){return new L_.MediaKeysEdgeNext(e)}):Fe.Promise.reject(new Error("Unsupported key system: '"+e+"'")):e===n?__.MediaKeyFactory.create(r).then(function(){return Fe.Promise.reject(new Error("'"+r+"' is supported, abandoning request on '"+n+"'"))},function(){return __.MediaKeyFactory.create(n).then(function(e){return new L_.MediaKeysEdgeNext(e)})}):e===r?__.MediaKeyFactory.create(r).then(function(e){return new L_.MediaKeysEdgeNext(e)}):Fe.Promise.reject(new Error("Unsupported key system: '"+e+"'"))},e}();t.MediaKeyFactoryEdgeNext=i});e(F_);F_.MediaKeyFactoryEdgeNext;var D_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeyFactory=F_.MediaKeyFactoryEdgeNext,t.MediaKeys=L_.MediaKeysEdgeNext,t.MediaKeySession=__.MediaKeySession});e(D_);D_.MediaKeyFactory,D_.MediaKeys,D_.MediaKeySession;var N_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new ArrayBuffer(1),r=function(){function e(){this.hasLicense=!1}return Object.defineProperty(e.prototype,"size",{get:function(){return this.hasLicense?1:0},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return!(1<e.byteLength)&&(0===AE.BinaryUtils.convertBufferSourceToUint8Array(e)[0]&&this.hasLicense)},e.prototype.get=function(e){if(this.has(e))return"usable"},e.prototype.forEach=function(e){this.hasLicense&&e("usable",n.slice(0))},e.prototype.licenseLoaded=function(){this.hasLicense=!0},e.prototype.clear=function(){this.hasLicense=!1},e}();t.SimpleMediaKeyStatusMap=r});e(N_);N_.SimpleMediaKeyStatusMap;var U_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="mskeymessage",r=function(){function e(e){var n=this;this.sessionIdValue="",this.msKeyMessageHandler=function(e){var t={message:e.message,messageType:"license-request"};n.eventEmitter.emit("message",t)},this.mediaKeys=e,this.session=null,this.eventEmitter=new Dt.EventEmitter,this.deferredClose=new Fe.Deferred,this.mediaKeyStatusMap=new N_.SimpleMediaKeyStatusMap}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.sessionIdValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"expiration",{get:function(){return NaN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closed",{get:function(){return this.deferredClose.promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyStatuses",{get:function(){return this.mediaKeyStatusMap},enumerable:!0,configurable:!0}),e.prototype.generateRequest=function(e,t){try{return this.session=this.mediaKeys.createSession("video/mp4",AE.BinaryUtils.convertBufferSourceToUint8Array(t)),this.session.addEventListener(n,this.msKeyMessageHandler),this.sessionIdValue=this.session.sessionId,Fe.Promise.resolve()}catch(e){return Fe.Promise.reject(new Error("Failed to create MediaKeySessionIE"))}},e.prototype.update=function(e){if(null===this.session)return Fe.Promise.reject(new Error("'update' is called before session is created."));try{return this.session.update(AE.BinaryUtils.convertBufferSourceToUint8Array(e)),this.mediaKeyStatusMap.licenseLoaded(),Fe.Promise.resolve()}catch(e){return Fe.Promise.reject(new Error("Failed to update MediaKeySessionIE"))}},e.prototype.close=function(){if(null===this.session)return Fe.Promise.reject(new Error("'close' is called before session is created."));try{return this.session.close(),this.session.removeEventListener(n,this.msKeyMessageHandler),this.mediaKeyStatusMap.clear(),this.deferredClose.resolve(),Fe.Promise.resolve()}catch(e){return Fe.Promise.reject(new Error("Failed to close MediaKeySessionIE"))}},e.prototype.load=function(e){return Fe.Promise.resolve(!1)},e.prototype.remove=function(){return Fe.Promise.reject(new Error("'remove' is not available on MediaKeySessionIE"))},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e}();t.MediaKeySessionIE=r});e(U_);U_.MediaKeySessionIE;var B_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.currentSession=null,this.msGraphicsTrust=null,this.mediaKeys=e}return e.prototype.createSession=function(e){return null!==this.currentSession&&this.currentSession.close(),this.currentSession=new U_.MediaKeySessionIE(this.mediaKeys),this.currentSession},Object.defineProperty(e.prototype,"mediaKeysIE",{get:function(){return this.mediaKeys},enumerable:!0,configurable:!0}),e.prototype.setServerCertificate=function(e){return Fe.Promise.resolve(!1)},e.prototype.getStatusForPolicy=function(e){return Number(e.minHdcpVersion)<=1.4&&(null==this.msGraphicsTrust||!this.msGraphicsTrust.constrictionActive)?Fe.Promise.resolve("usable"):Fe.Promise.resolve("output-restricted")},e.prototype.setMsGraphicsTrust=function(e){this.msGraphicsTrust=e},e.prototype.setHdcpTestKeyId=function(e,t){},e.prototype.onError=function(e){},e.prototype.offError=function(e){},e}();t.MediaKeysIE=n});e(B_);B_.MediaKeysIE;var V_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.create=function(e){if("com.microsoft.playready"!==e)return Fe.Promise.reject(new Error("Invalid key system "+e));try{return Fe.Promise.resolve(new B_.MediaKeysIE(new MSMediaKeys(e)))}catch(e){return Fe.Promise.reject(e)}},e}();t.MediaKeyFactoryIE=n});e(V_);V_.MediaKeyFactoryIE;var j_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeyFactory=V_.MediaKeyFactoryIE});e(j_);j_.MediaKeyFactory;var X_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"expiration",{get:function(){return NaN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"closed",{get:function(){return Fe.Promise.reject(new Error("'closed' is not available on MediaKeySessionWebkit"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyStatuses",{get:function(){return{}},enumerable:!0,configurable:!0}),e.prototype.generateRequest=function(e,t){return Fe.Promise.reject(new Error("'generateRequest' is not available on MediaKeySessionWebkit"))},e.prototype.update=function(e){return Fe.Promise.reject(new Error("'update' is not available on MediaKeySessionWebkit"))},e.prototype.close=function(){return Fe.Promise.reject(new Error("'close' is not available on MediaKeySessionWebkit"))},e.prototype.load=function(e){return Fe.Promise.reject(new Error("'load' is not available on MediaKeySessionWebkit"))},e.prototype.remove=function(){return Fe.Promise.reject(new Error("'remove' is not available on MediaKeySessionIE"))},e.prototype.on=function(e,t){},e.prototype.off=function(e,t){},e}();t.MediaKeySessionWebkit=n});e(X_);X_.MediaKeySessionWebkit;var z_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.createSession=function(e){return new X_.MediaKeySessionWebkit},e.prototype.setServerCertificate=function(e){return Fe.Promise.reject(new Error("'setServerCertificate' is not available on MediaKeysWebkit"))},e.prototype.getStatusForPolicy=function(e){return Fe.Promise.resolve("output-restricted")},e.prototype.setHdcpTestKeyId=function(e,t){},e.prototype.onError=function(e){},e.prototype.offError=function(e){},e}();t.MediaKeysWebkit=n});e(z_);z_.MediaKeysWebkit;var q_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.create=function(e){return Fe.Promise.resolve(new z_.MediaKeysWebkit)},e}();t.MediaKeyFactoryWebkit=n});e(q_);q_.MediaKeyFactoryWebkit;var W_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeyFactory=q_.MediaKeyFactoryWebkit});e(W_);W_.MediaKeyFactory;var H_=t(function(e,t){var n;switch(Object.defineProperty(t,"__esModule",{value:!0}),t.MediaKeyFactory=n,Xh.getBrowser().getType()){case Xh.BrowserType.IE:t.MediaKeyFactory=n=j_.MediaKeyFactory;break;case Xh.BrowserType.Edge:t.MediaKeyFactory=n=O_.MediaKeyFactory;break;case Xh.BrowserType.EdgeNext:t.MediaKeyFactory=n=D_.MediaKeyFactory;break;case Xh.BrowserType.Chrome:case Xh.BrowserType.Opera:t.MediaKeyFactory=n=__.MediaKeyFactory;break;case Xh.BrowserType.Safari:t.MediaKeyFactory=n=W_.MediaKeyFactory;break;default:t.MediaKeyFactory=n=M_.MediaKeyFactory}});e(H_);H_.MediaKeyFactory;var G_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("MediaKeysAccessor"),s=["com.widevine.alpha","com.microsoft.playready"],n=function(){function o(){}return o.getSupportedKeySystem=function(){return null==o.supportedKeySystemPromise&&(o.supportedKeySystemPromise=o.createSupportedKeySystemPromise(o.getMediaKeys())),o.supportedKeySystemPromise},o.getMediaKeys=function(){if(null!=o.cachedFactoryResult)return o.cachedFactoryResult;var e=s;null!=H_.MediaKeyFactory.supportedKeySystems&&0<H_.MediaKeyFactory.supportedKeySystems.length&&(e=H_.MediaKeyFactory.supportedKeySystems);for(var t=null,n=function(e){t=null==t?o.tryCreateMediaKeys(e):t.catch(function(){return o.tryCreateMediaKeys(e)})},r=0,i=e;r<i.length;r++){n(i[r])}return o.cachedFactoryResult=t.catch(function(e){throw a.error("Could not create a Widevine or PlayReady MediaKeys instance. Error:",e),e}),null==o.supportedKeySystemPromise&&(o.supportedKeySystemPromise=o.createSupportedKeySystemPromise(o.cachedFactoryResult)),o.cachedFactoryResult},o.tryCreateMediaKeys=function(t){return H_.MediaKeyFactory.create(t).then(function(e){return{system:t,mediaKeys:e}})},o.createSupportedKeySystemPromise=function(e){return e.then(function(e){return e.system}).catch(function(){a.error("Could not create a MediaKeys instance of ANY type. Attempting to play encrypted media WILL fail!")})},o}();t.MediaKeysAccessor=n});e(G_);G_.MediaKeysAccessor;var K_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("BinaryConverter"),n=function(){function t(){}return t.arrayBufferToString=function(e){return i(e,"arrayBuffer").exists(),String.fromCharCode.apply(null,new Uint8Array(e))},t.uint8ArrayToString=function(e){return i(e,"array").exists(),String.fromCharCode.apply(null,e)},t.uint16ArrayToString=function(e){return i(e,"array").exists(),String.fromCharCode.apply(null,e)},t.toUTF16LE=function(e){i(e,"text").exists();for(var t=new ArrayBuffer(2*e.length),n=new DataView(t),r=0;r<e.length;r++)n.setUint16(2*r,e.charCodeAt(r),!0);return new Uint8Array(t)},t.stringToArrayBuffer=function(e){return t.stringToUint8Array(e).buffer},t.stringToUint8Array=function(e){i(e,"text").exists();for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r<e.length;++r)n[r]=e.charCodeAt(r);return n},t}();t.BinaryConverter=n});e(K_);K_.BinaryConverter;var Q_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("CENCKeyIdExtractor"),n=function(){function e(e,t){void 0===t&&(t=new i_.BmffParser),this.systemId=e,this.bmffParser=t}return e.prototype.extractFromInitData=function(e){try{var t=this.bmffParser.parseFragment(e),n=i_.Boxes.all(t,i_.Boxes.ofType("pssh"));return this.extractFromPSSH(n)}catch(e){return o.error("Failed to extract keyId from initData",e),null}},e.prototype.extractFromPSSH=function(e){var t=this,n=e.filter(function(e){return e.systemId===t.systemId});return null==n||0===n.length?(o.error("Could not find a PSSH box for system id "+this.systemId),null):this.extractFromPrivateData(n[0].data)},e.prototype.extractFromContentProtectionHeader=function(e){var t=this,n=e.filter(function(e){return e.systemId===t.systemId});if(null==n||0===n.length)return o.error("Could not find a ContentProtection header for system id "+this.systemId),null;var r=atob(n[0].value),i=K_.BinaryConverter.stringToUint8Array(r);return this.extractFromPrivateData(i)},e}();t.CencKeyIdExtractor=n});e(Q_);Q_.CencKeyIdExtractor;var Y_=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("WidevineCencKeyIdExtractor"),n=function(t){function n(e){return t.call(this,n.WIDEVINE_SYSTEM_ID,e)||this}return i(n,t),n.prototype.extractFromPrivateData=function(e){try{var t=AE.ProtobufDecoder.parse(e)[2];return tb.encodeString(K_.BinaryConverter.uint8ArrayToString(t))}catch(e){return o.error("Failed to extract keyId from initData.",e),null}},n.WIDEVINE_SYSTEM_ID="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",n}(Q_.CencKeyIdExtractor);t.WidevineCencKeyIdExtractor=n});e(Y_);Y_.WidevineCencKeyIdExtractor;var J_=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("PlayReadyCencKeyIdExtractor"),i=function(t){function a(e){return t.call(this,a.PLAYREADY_SYSTEM_ID,e)||this}return n(a,t),a.prototype.extractFromPrivateData=function(e){var t=e.byteOffset+10,n=e.byteOffset+(e.byteLength-e.byteLength%2),r=e.buffer.slice(t,n),i=String.fromCharCode.apply(null,new Uint16Array(r)),o=a.KID_REGEX.exec(i);return null==o||o.length<2?(s.warn("Unable to find key id in Rights Management Header \""+i+"\""),null):o[1]},a.PLAYREADY_SYSTEM_ID="9a04f079-9840-4286-ab92-e65be0885f95",a.KID_REGEX=/<KID>([^<]*)<\/KID>/,a}(Q_.CencKeyIdExtractor);t.PlayReadyCencKeyIdExtractor=i});e(J_);J_.PlayReadyCencKeyIdExtractor;var $_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.create=function(e){if(0===e.indexOf("com.microsoft.playready"))return new J_.PlayReadyCencKeyIdExtractor;if("com.widevine.alpha"===e)return new Y_.WidevineCencKeyIdExtractor;throw new Error("Cannot create a key id extractor for system "+e+": Unknown systemId")},e}();t.CencKeyIdExtractorFactory=n});e($_);$_.CencKeyIdExtractorFactory;var Z_=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var m=M.get("MediaKeysManager");function r(t){return function(e){return e.sessionId===t}}var n=function(){function l(e){var t=this;this.mediaKeySessions=[],this.keyIdExtractor=null,this.keyIdToSessionIdMap={},this.diagnostics=pp.Diagnostics.create("MediaKeysManager"),this.eventEmitter=new Dt.EventEmitter,this.hdcpStore=e,this.state={mediaKeys:{status:"pending"},sessions:{}},this.reportDiagnostics(),G_.MediaKeysAccessor.getMediaKeys().then(function(e){e.mediaKeys.onError(function(e){t.eventEmitter.emit("error",e)}),t.state.mediaKeys.status="ok",t.reportDiagnostics()}).catch(function(e){t.state.mediaKeys={status:"error",reason:e.toString()},t.reportDiagnostics()})}return l.getSupportedKeySystem=function(){return G_.MediaKeysAccessor.getSupportedKeySystem()},l.prototype.reset=function(){for(var e=0,t=this.mediaKeySessions;e<t.length;e++){var n=t[e];null!=n.mediaKeySessionManager&&n.mediaKeySessionManager.terminate()}this.mediaKeySessions=[],this.keyIdToSessionIdMap={},this.state.sessions={},this.reportDiagnostics()},l.getMediaKeys=function(){return G_.MediaKeysAccessor.getMediaKeys()},l.prototype.applyInitData=function(c,d,p,f){var h=this;return void 0===f&&(f=!1),G_.MediaKeysAccessor.getMediaKeys().then(function(e){var t=e.system,n=e.mediaKeys;null===h.keyIdExtractor&&(h.keyIdExtractor=$_.CencKeyIdExtractorFactory.create(t));var r=h.keyIdExtractor.extractFromInitData(d);if(null===r)return m.warn("InitData is missing a CENC KeyId with key system "+t),null;var i="PENDING_SESSIONID_"+r,o=h.findMediaKeySessionItemByKeyId(r);if(null==o&&(o=h.createMediaKeySessionItem(e,i,f,r)),null!=o.applyInitDataPromise)return o.applyInitDataPromise;var a=o.mediaKeySessionManager,s=a.mediaKeySession,l=h.createLicenseDataAcquireCallback(t,n,s,r,p),u=a.applyInitData(c,d,l).then(function(){var e=a.sessionId;return 0<e.length?(o.sessionId=e,h.formalizeSessionId(i,e,r),e):null});return o.applyInitDataPromise=u}).catch(function(e){return m.error("Attempted to acquire a license but MediaKeys is not available",e),h.eventEmitter.emit("error",e),null})},l.prototype.getKeyMetadata=function(e){var t=null!=this.keyIdExtractor?this.keyIdExtractor.extractFromInitData(e):null,n=this.findMediaKeySessionItemByKeyId(t);return null!=n&&null!=n.keyMetadata?n.keyMetadata:null},l.prototype.loadLicense=function(t){var n=this;return this.internalLoad(t,"load").then(function(e){return e?n.updateSessionState("loaded",t):(n.removeCachedSession(t),n.updateSessionStateError(new Error("Failed to load"),t)),e})},l.prototype.removeLicense=function(n){var r=this;return this.internalLoad(n,"remove").then(function(e){if(e){var t=r.findMediaKeySessionItemBySessionId(n);if(null!=t)return t.mediaKeySessionManager.remove().then(function(){r.removeCachedSession(n),r.updateSessionState("deleted",n)})}else r.removeCachedSession(n),r.updateSessionStateError(new Error("Failed to load for removal"),n)})},l.prototype.extractKeyId=function(n){var r=this;return null!=this.keyIdExtractor?Fe.Promise.resolve(this.keyIdExtractor.extractFromInitData(n)):G_.MediaKeysAccessor.getMediaKeys().then(function(e){var t=e.system;return null===r.keyIdExtractor&&(r.keyIdExtractor=$_.CencKeyIdExtractorFactory.create(t)),r.keyIdExtractor.extractFromInitData(n)}).catch(function(e){return m.error("Attempted to extractKeyId but MediaKeys is not available",e),r.eventEmitter.emit("error",e),null})},l.prototype.on=function(e,t){this.eventEmitter.on(e,t)},l.prototype.off=function(e,t){this.eventEmitter.off(e,t)},l.prototype.internalLoad=function(r,i){var o=this;return G_.MediaKeysAccessor.getMediaKeys().then(function(e){if(null==e)return!1;var t=o.findMediaKeySessionItemBySessionId(r);if(null==t&&(t=o.createMediaKeySessionItem(e,r,!0)),null!=t.loadPromise)return t.loadPromise;if(null!=t.applyInitDataPromise)return null!=t.keyMetadata||(m.warn("applyInitData was initiated but not completed for session "+r+". Not proceeding "+i+"."),!1);var n=t.mediaKeySessionManager.load(r);return t.loadPromise=n}).catch(function(e){return m.error("Attempted to "+i+" persistent license "+r+" but MediaKeys is not available",e),o.eventEmitter.emit("error",e),!1})},l.prototype.findMediaKeySessionItemByKeyId=function(t){return F.find(this.mediaKeySessions,function(e){return e.keyId===t})},l.prototype.findMediaKeySessionItemBySessionId=function(e){return F.find(this.mediaKeySessions,r(e))},l.prototype.limitMediaKeySessionInstances=function(){if(!(this.mediaKeySessions.length+1<=xt.nestedValue(Yh.deviceInformation,"encryptedMedia.maxSupportedMediaKeySessions",11))){var e=this.mediaKeySessions.shift();null!=e&&(null!=e.mediaKeySessionManager&&e.mediaKeySessionManager.terminate(),null!=e.sessionId&&delete this.state.sessions[e.sessionId],null!=e.keyId&&(delete this.state.sessions[e.keyId],delete this.keyIdToSessionIdMap[e.keyId]))}},l.prototype.getMediaKeySessionItemKeyingSessionId=function(e,t){var n=e;return null!=t&&null!=this.keyIdToSessionIdMap[t]&&(n=this.keyIdToSessionIdMap[t]),n},l.prototype.createMediaKeySessionItem=function(e,i,t,o){var a=this;void 0===t&&(t=!1),this.limitMediaKeySessionInstances();var n=t?"persistent-license":"temporary",r=e.mediaKeys.createSession(n);m.info("created mediaKeySession with type:",n);var s=new T_.MediaKeySessionManager(r,function(e,t){void 0===t&&(t=!0);var n=a.getMediaKeySessionItemKeyingSessionId(i,o),r=a.removeCachedSession(n);null!=r&&a.updateSessionStateError(e,r.sessionId),t&&a.eventEmitter.emit("error",e)},this.hdcpStore);s.initialize();var l={mediaKeySessionManager:s,sessionId:i};return r.closed.then(function(){var e=a.getMediaKeySessionItemKeyingSessionId(i,o);null!=a.findMediaKeySessionItemBySessionId(e)&&(m.warn("MediaKeySession for sessionId '"+e+"' unexpectedly closed. Removing MediaKeySessionItem"),a.removeCachedSession(e))}),null!=o&&(l.keyId=o,this.keyIdToSessionIdMap[o]=i),this.mediaKeySessions.push(l),this.updateSessionState("pending",i),l},l.prototype.createLicenseDataAcquireCallback=function(t,i,o,a,n){var s=this;return function(e){return n(t,e).then(function(e){var t=l.extractHdcpTestKeyId(e);null!==t&&i.setHdcpTestKeyId(o,tb.decode(t));var n=s.findMediaKeySessionItemByKeyId(a);null!=n&&(n.keyMetadata=e.keyMetadata);var r=e;return r.keyId=a,s.eventEmitter.emit("licenseAcquired",r),null!=s.keyIdToSessionIdMap[a]&&s.updateSessionState("loaded",s.keyIdToSessionIdMap[a]),e.cdmLicenseData}).catch(function(e){var t=s.keyIdToSessionIdMap[a];throw null!=t&&(s.removeCachedSession(t),s.updateSessionStateError(e,t)),e instanceof Fe.CancelError||s.eventEmitter.emit("error",e),e})}},l.extractHdcpTestKeyId=function(e){for(var t=0,n=e.keyMetadata;t<n.length;t++){var r=n[t];if("HDCP_TEST"===r.keyType)return r.id}return null},l.prototype.removeCachedSession=function(e){var t=F.findIndex(this.mediaKeySessions,r(e));if(-1<t){var n=this.mediaKeySessions[t];return this.mediaKeySessions.splice(t,1),null!=n.mediaKeySessionManager&&n.mediaKeySessionManager.terminate(),null!=n.keyId&&delete this.keyIdToSessionIdMap[n.keyId],n}return null},l.prototype.formalizeSessionId=function(e,t,n){this.keyIdToSessionIdMap[n]=t,this.state.sessions[t]=this.state.sessions[e],delete this.state.sessions[e],this.reportDiagnostics()},l.prototype.updateSessionState=function(e,t){this.state.sessions[t]={status:e},this.reportDiagnostics()},l.prototype.updateSessionStateError=function(e,t){var n=this.state.sessions[t];null!=n&&"error"===n.status||(this.state.sessions[t]={status:"error",reason:e.toString()},this.reportDiagnostics())},l.prototype.reportDiagnostics=function(){this.diagnostics.report("state",this.state)},l}();t.MediaKeysManager=n});e(Z_);Z_.MediaKeysManager;var ex=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("HdcpStore"),n=function(){function e(e){var n=this;this.currentHdcpStatus=null,this.hdcpStoreDestroyed=!1,this.updateHdcpStatus=function(){return Z_.MediaKeysManager.getMediaKeys().then(function(e){var t=e.mediaKeys,n=t.getStatusForPolicy({minHdcpVersion:"2.2"}),r=t.getStatusForPolicy({minHdcpVersion:"1.4"});return Fe.Promise.all([n,r])}).then(function(e){var t="0";"usable"===e[0]?t="2.2":"usable"===e[1]&&(t="1.4"),null!=n.currentHdcpStatus&&n.currentHdcpStatus===t||(n.notifyHdcpStatusChange(n.currentHdcpStatus,t),n.currentHdcpStatus=t)})},this.pollHdcpStatus=function(){n.updateHdcpStatus().catch(function(e){r.error("Error querying HDCP status: ",e)}).then(function(){n.hdcpStoreDestroyed||(n.pollingHandle=A.timer.setTimeout(n.pollHdcpStatus,5e3))})},this.eventEmitter=new Dt.EventEmitter,this.pollingHandle=A.timer.setTimeout(this.pollHdcpStatus,5e3),this.useCachedHdcpStatus=e}return e.prototype.destroy=function(){this.hdcpStoreDestroyed=!0,null!=this.pollingHandle&&(A.timer.clearTimeout(this.pollingHandle),this.pollingHandle=null)},e.compareHdcpStatuses=function(e,t){return Number(e)>=Number(t)},e.prototype.getHdcpStatus=function(){var e=this;return null!=this.currentHdcpStatus&&this.useCachedHdcpStatus?Fe.Promise.resolve(this.currentHdcpStatus):this.updateHdcpStatus().then(function(){return e.currentHdcpStatus})},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.notifyHdcpStatusChange=function(e,t){r.info("HDCP status change detected, previous HDCP status: "+e+", new HDCP status: "+t),this.eventEmitter.emit("hdcpStatusChange")},e}();t.HdcpStore=n});e(ex);ex.HdcpStore;var tx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HdcpStore=ex.HdcpStore,t.MediaKeysManager=Z_.MediaKeysManager});e(tx);tx.HdcpStore,tx.MediaKeysManager;var nx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.PlaybackUrls=function(e){return void 0===e&&(e={}),{resourceName:"PlaybackUrls",queryParams:{audioTrackId:e.audioTrackId,languageFeature:e.languageFeature,liveManifestType:null!=e.liveManifestType&&0<e.liveManifestType.length?e.liveManifestType.join(","):void 0,videoMinBitrate:e.videoMinBitrateBps,videoMaxBitrate:e.videoMaxBitrateBps,supportedDRMKeyScheme:e.drmKeyScheme}}},e.PlayReadyLicense=function(e,t){return{resourceName:"PlayReadyLicense",postParams:{playReadyChallenge:e,playReadyKeyId:t}}},e.FairPlayLicense=function(e,t){return{resourceName:"FairPlayLicense",postParams:{fairPlayChallenge:e,fairPlayKeyId:t}}},e.FairPlayApplicationCertificate=function(){return{resourceName:"FairPlayApplicationCertificate"}},e.Widevine2License=function(e,t){return{resourceName:"Widevine2License",postParams:{widevine2Challenge:e,includeHdcpTestKeyInLicense:t}}},e.SubtitleUrls=function(e){return{resourceName:"SubtitleUrls",queryParams:{subtitleFormat:e}}},e.ForcedNarratives=function(){return{resourceName:"ForcedNarratives"}},e.WhisperSyncBookmark=function(){return{resourceName:"WhisperSyncBookmark"}},e.CatalogMetadata=function(e){return{resourceName:"CatalogMetadata",queryParams:{titleDecorationScheme:e}}},e.TransitionTimecodes=function(){return{resourceName:"TransitionTimecodes"}},e.CuepointPlaylist=function(e,t){return{resourceName:"CuepointPlaylist",queryParams:{siteSectionId:e,optOutAdTracking:t}}},e.LiveSchedule=function(e){return{resourceName:"LiveSchedule",queryParams:{liveScheduleConfigToken:e}}},e.SubtitlePresets=function(){return{resourceName:"SubtitlePresets"}},e.XRayMetadata=function(e,t,n){return{resourceName:"XRayMetadata",queryParams:{xrayToken:e,xrayPlaybackMode:t,xrayDeviceClass:n}}},e.TrickplayUrls=function(){return{resourceName:"TrickplayUrls"}},e.PlaybackSettings=function(e){return{resourceName:"PlaybackSettings",queryParams:{playbackSettingsFormatVersion:e}}},e.LinearRestrictions=function(e,t){return{resourceName:"LinearRestrictions",queryParams:{linearRestrictionStart:e,linearRestrictionEnd:t}}},e.SyeUrls=function(){return{resourceName:"SyeUrlsV2"}},e}();t.PlaybackResource=n});e(nx);nx.PlaybackResource;var rx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("PlaybackResourceErrorHandler"),s={PRS:"prs.general","PRS.Dependency":"prs.dependency","PRS.Dependency.DRM.Widevine.UnsupportedCdmVersion":"prs.unsupported_cdm_version","PRS.InvalidRequest":"prs.invalid_request","PRS.NoRights":"prs.no_rights","PRS.NoRights.AnonymizerIP":"prs.no_rights.anonymizer_ip","PRS.NoRights.DownloadLimitExceeded":"prs.no_rights.download_limit_exceeded","PRS.NoRights.InvalidGeoIP":"prs.no_rights.invalid_geo_ip","PRS.NoRights.NoAvailableStreams":"prs.no_rights.no_available_streams","PRS.NoRights.NotAcceptedTermsAndConditions":"prs.no_rights.not_accepted_terms","PRS.NoRights.NotOwned":"prs.no_rights.not_owned","PRS.NoRights.PVLowerTierDeviceNotPermittedAccess":"prs.no_rights.pv_lower_tier_device_not_permitted_access"},l={"PRS.Dependency.DRM.Widevine.HdContentNotAllowed":"prs.hd_content_not_allowed"},n=function(){function t(){}return t.createError=function(e){if(null==e.errorCode){var t="PRSWidevine2LicenseDeniedException"===e.type?"prs.widevine_license_denied":"prs.unknown_codeless_exception";return new Ne.XpError(t,void 0,e.message)}var n=s[e.errorCode];if(null!=n)return new Ne.XpError(n,void 0,e.message);for(var r=0,i=Object.keys(l);r<i.length;r++){var o=i[r];if(e.errorCode===o||0===e.errorCode.indexOf(o+"."))return a.warn(JSON.stringify(e)),new Ne.XpError(l[o],e.type,e.message)}return new Ne.XpError("prs.unknown",void 0,e.message)},t.convertResourceExceptions=function(e){if(void 0!==e)return F.mapObject(e,function(e){return t.createError(e)})},t}();t.PlaybackResourceErrorHandler=n});e(rx);rx.PlaybackResourceErrorHandler;var ix=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var f=M.get("PlaybackResourceClient"),h={drm:"deviceDrmOverride",videoQuality:"deviceVideoQualityOverride",audioQuality:"deviceAudioQualityOverride",protocol:"deviceProtocolOverride",streamingTechnology:"deviceStreamingTechnologyOverride",hdrFormat:"deviceHdrFormatsOverride",videoCodec:"deviceVideoCodecOverride",bitrateAdaptation:"deviceBitrateAdaptationsOverride"},o=["PRSDependencyException"],a=Qp.createCDPResponseProcessor(function(e,t,n,r){if(null==e.error)e.errorsByResource=rx.PlaybackResourceErrorHandler.convertResourceExceptions(e.errorsByResource),t(e);else{var i=rx.PlaybackResourceErrorHandler.createError(e.error);F.contains(o,e.error.type)?n(i):r(i)}}),n=function(){function e(e,t,n){this.deviceInformation=Yh.deviceInformation;var r=xt.nestedValue(this.deviceInformation,"software.advertisingId"),i={firmware:"1",clientId:t,deviceApplicationName:n,playerType:"xp",operatingSystemName:xt.nestedValue(this.deviceInformation,"software.operatingSystem.name"),operatingSystemVersion:xt.nestedValue(this.deviceInformation,"software.operatingSystem.version"),deviceModel:xt.nestedValue(this.deviceInformation,"hardware.model.name"),deviceChipset:xt.nestedValue(this.deviceInformation,"hardware.chipset"),manufacturer:xt.nestedValue(this.deviceInformation,"hardware.manufacturer"),advertisingId:null==r||F.isEmpty(r.trim())?void 0:r};xt.sanitize(i,!0),this.serviceClient=e.createServiceClient("/cdp/catalog/GetPlaybackResources",i,a,"prs")}return e.prototype.send=function(e,t){var n="ImmediateConsumption"===e.resourceUsage?"CRITICAL":"BACKGROUND",r={asin:e.titleId,consumptionType:e.consumptionType,desiredResources:e.resources.map(function(e){return e.resourceName}).join(","),resourceUsage:e.resourceUsage,videoMaterialType:e.videoMaterialType};null!=e.userWatchSessionId&&(r.userWatchSessionId=e.userWatchSessionId);for(var i=0,o=Object.keys(e.capabilityOverrides);i<o.length;i++){var a=o[i],s=e.capabilityOverrides[a];null==s?f.warn("Capability override:"+a+" is "+s+"."):r[h[a]]=s.toString()}var l={};null!=e.playbackToken&&(l={playbackToken:e.playbackToken});for(var u=0,c=e.resources;u<c.length;u++){var d=c[u];r=F.extend(r,d.queryParams),l=F.extend(l,d.postParams)}F.isEmpty(e.playerAttributes)||(r.playerAttributes=JSON.stringify(e.playerAttributes)),F.isEmpty(e.weblabTreatments)||(r.weblabTreatments=JSON.stringify(e.weblabTreatments));var p={method:"POST",queryParams:r,headers:{},body:null,timeoutMs:6e3};return xt.sanitize(l),F.isEmpty(l)||(p.headers["Content-Type"]="application/x-www-form-urlencoded",p.body=ME.URLUtils.wwwFormUrlEncode(l)),xt.sanitize(p),this.serviceClient.send(p,t,n,!1)},e}();t.PlaybackResourceClient=n});e(ix);ix.PlaybackResourceClient;var ox=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.deviceCapabilitiesNames={supportedDynamicRangeFormat:"output.video.display.dynamicRangeFormatSupport"}});e(ox);ox.deviceCapabilitiesNames;var ax=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.deviceInformationNames={middlewareName:"software.middleware.name",middlewareVersion:"software.middleware.version",scriptEngineName:"software.scriptEngine.name",scriptEngineVersion:"software.scriptEngine.version",nativeApplicationName:"software.nativeApplication.name",nativeApplicationVersion:"software.nativeApplication.version",nativeRuntimeName:"software.nativeRuntime.name",nativeRuntimeVersion:"software.nativeRuntime.version",firmwareName:"software.firmware.name",firmwareVersion:"software.firmware.version"}});e(ax);ax.deviceInformationNames;var sx=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=S.of("PlaybackResourceRequestBuilder"),m=M.get("PlaybackResourceRequestBuilder"),i=function(){function h(){this.capabilityOverrides={},this.playerAttributes={},this.weblabTreatments={},this.resources=[]}return h.prototype.content=function(e,t,n,r){return this.titleId=e,this.videoMaterialType=t,this.consumptionType=n,this.playbackToken=r,this},h.prototype.resource=function(e){return this.resources.push(e),this},h.prototype.overrideDeviceCapability=function(e,t){return this.capabilityOverrides[e]=t,this},h.prototype.playerAttribute=function(e,t){return r(e,"name").not.empty(),r(t,"playerAttributesValue").not.empty(),Array.isArray(t)&&(t=t.join()),this.playerAttributes[e]=t,this},h.prototype.weblabTreatment=function(e,t){return r(e,"weblabName").not.empty(),r(t,"weblabTreatment").not.empty(),this.weblabTreatments[e]=t,this},h.prototype.userWatchSessionId=function(e){return this._userWatchSessionId=e,this},h.prototype.build=function(e){return r(this.titleId,"titleId").exists(),r(this.resources,"resources").not.empty(),{titleId:this.titleId,videoMaterialType:this.videoMaterialType,consumptionType:this.consumptionType,playbackToken:this.playbackToken,userWatchSessionId:this._userWatchSessionId,capabilityOverrides:n({},this.capabilityOverrides),resources:this.resources.slice(),resourceUsage:e,playerAttributes:n({},this.playerAttributesFromDeviceInformation(Yh.deviceInformation,ax.deviceInformationNames),this.playerAttributesFromDeviceInformation(Yh.deviceCapabilities,ox.deviceCapabilitiesNames),this.playerAttributes),weblabTreatments:n({},this.weblabTreatments)}},h.prototype.playerAttributesFromDeviceInformation=function(e,t){for(var n={},r=0,i=Object.keys(t);r<i.length;r++){var o=i[r],a=xt.nestedValue(e,t[o]);if(null!=a){var s=Array.isArray(a)?a.join():a.toString();F.isEmpty(s)||(n[o]=s)}}return n},h.prototype.clone=function(){for(var e=(new h).content(this.titleId,this.videoMaterialType,this.consumptionType,this.playbackToken).userWatchSessionId(this._userWatchSessionId),t=0,n=this.resources;t<n.length;t++){var r=n[t];e.resource(r)}for(var i=0,o=Object.keys(this.capabilityOverrides);i<o.length;i++){var a=o[i],s=this.capabilityOverrides[a];void 0===s?m.warn("Capability override:"+a+" is undefined, hence won't be included in the clone."):e.overrideDeviceCapability(a,s)}for(var l=0,u=Object.keys(this.playerAttributes);l<u.length;l++){var c=u[l];e.playerAttribute(c,this.playerAttributes[c])}for(var d=0,p=Object.keys(this.weblabTreatments);d<p.length;d++){var f=p[d];e.weblabTreatment(f,this.weblabTreatments[f])}return e},h}();t.PlaybackResourceRequestBuilder=i});e(sx);sx.PlaybackResourceRequestBuilder;var lx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("PRSResponseValidator"),n=function(){function e(){}return e.prototype.validateResponse=function(e){var t=this.validatePlaybackUrls(e);if(null!==t)return t;var n=this.validateTitleRendition(e);return null!==n?n:null},e.prototype.validateTitleRendition=function(e){var t=xt.nestedValue(e,"returnedTitleRendition.selectedEntitlement");if(null===t)return o.error("No returnedTitleRendition.selectedEntitlement"),new Ne.XpError("prs.no_selected_entitlement");var n=t.rightsException;return null!=n?"PAYMENT_FAILURE"===n.downstreamReason?(o.error("Rights Exception due to PaymentFailure"),new Ne.XpError("prs.payment_failure")):rx.PlaybackResourceErrorHandler.createError(n):null},e.prototype.validatePlaybackUrls=function(e){var t=xt.nestedValue(e,"errorsByResource.PlaybackUrls",null);if(null!==t)return t;if(null===xt.nestedValue(e,"playbackUrls.urlSets"))return o.error("No playbackUrls.urlSets"),new Ne.XpError("prs.no_playback_url_sets");var n=e.playbackUrls,r=n.defaultUrlSetId,i=n.urlSets[r].urls.manifest;return o.info("Frame rate for manifest URL "+i.url+" is "+i.frameRate),null},e}();t.PRSResponseValidator=n});e(lx);lx.PRSResponseValidator;var ux=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackResource=nx.PlaybackResource,t.PlaybackResourceClient=ix.PlaybackResourceClient,t.PlaybackResourceRequestBuilder=sx.PlaybackResourceRequestBuilder,t.PRSResponseValidator=lx.PRSResponseValidator});e(ux);ux.PlaybackResource,ux.PlaybackResourceClient,ux.PlaybackResourceRequestBuilder,ux.PRSResponseValidator;var cx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createTimedTextDataKey=function(e,t){return"timed_text_data_"+e+"_"+t},t.createTimedTextDataPrefixKey=function(e){return"timed_text_data_"+e}});e(cx);cx.createTimedTextDataKey,cx.createTimedTextDataPrefixKey;var dx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("StaticTimedTextDataStore"),r=function(){function e(){this.assetCache=[],this.eventEmitter=new Dt.EventEmitter}return e.deleteContentsFromStorage=function(e){return xI.localStorage.removePrefix(cx.createTimedTextDataPrefixKey(e))},e.prototype.getContents=function(t,e){var n=this;if(null==t.activeVariantId)return Fe.Promise.reject(new Error("Can't get TimedText contents because there's no active variant on "+t.id+"."));var r=this.tryGetCachedContents(t);return null!==r?Fe.Promise.resolve(r.contents):null!=e&&xI.localStorage.capabilities.isSupported?this.getContentsFromStorage(e,t.id).then(function(e){return null!=e?(n.addToCache(t,e),e):n.downloadContents(t)}):this.downloadContents(t)},e.prototype.storeContents=function(t,n){return this.downloadContents(n).then(function(e){return xI.localStorage.put(cx.createTimedTextDataKey(t,n.id),e)})},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.flushCache=function(){this.assetCache=[]},e.prototype.getContentsFromStorage=function(e,t){return xI.localStorage.getText(cx.createTimedTextDataKey(e,t)).catch(function(e){return n.info("Couldn't get static TimedText contents from LocalStorage with error: "+e),null})},e.prototype.downloadContents=function(i){var o=this,a=F.findWhere(i.variants,{id:i.activeVariantId});return null==a?Fe.Promise.reject(new Error("Couldn't find variant for activeVariantId "+i.activeVariantId)):new Fe.Promise(function(e,t){(new Op.ExponentialBackoffRetry).withMaxAttempts(4).withRandomizationFactor(1e3).onAttempt(function(e,t,n,r){o.tryAcquireTimedText(i,a.url,t,n)}).onSuccess(e).onError(t).execute()})},e.prototype.tryAcquireTimedText=function(n,r,i,o){var a=this;new mp.HttpRequest("GET",r).onLoad(function(e){a.eventEmitter.emit("timedTextDownloaded",{url:r,status:e.getStatus(),totalBytes:e.getMetrics().totalBytes,latencyMs:e.getLatencyMs(),totalMs:e.getTotalMs(),headers:e.getHeaders()});var t=e.getText();a.addToCache(n,t),o(t)}).onError(function(e,t){var n={url:r,error:e};null!=t&&F.extend(n,{status:t.getStatus(),totalBytes:t.getMetrics().totalBytes,latencyMs:t.getLatencyMs(),totalMs:t.getTotalMs(),headers:t.getHeaders()}),a.eventEmitter.emit("timedTextDownloadFailed",n),i(e)}).send()},e.prototype.tryGetCachedContents=function(e){var t=F.findWhere(this.assetCache,{streamId:e.id,variantId:e.activeVariantId});return null!=t?t:null},e.prototype.addToCache=function(e,t){2===this.assetCache.length&&this.assetCache.shift(),this.assetCache.push({streamId:e.id,variantId:e.activeVariantId,contents:t})},e}();t.StaticTimedTextDataStore=r});e(dx);dx.StaticTimedTextDataStore;var px=t(function(e,t){var n,r=V&&V.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i={sdh:"SDH",caption:"Caption",subtitle:"Subtitle",narrative:"Mandatory"},o={commentary:"Commentary",descriptive:"Descriptive",dialog:"Dialog"},a=((n={}).DFXP="TTMLv1",n.HLS="WebVTT",n.TTMLv2="TTMLv2",n),s=M.get("SubtitleUrlTransformer"),l={index:"0",type:"subtitle",subtype:"dialog"},u=function(){function e(){}return e.toTimedTextStreams=function(n,e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),0===e.length&&0===t.length?[]:(e=e.concat(t)).map(function(e){if(null==(e=r({},l,e)).timedTextTrackId&&(e.timedTextTrackId=e.languageCode+"_"+e.type+"_"+e.subtype+"_"+e.index),null==e.format){var t=e.url.split("."),n=t[t.length-1];"dfxp"===n?e.format="DFXP":"ttml"===n?e.format="TTMLv2":"vtt"===n&&(e.format="HLS")}return e}).filter(function(e){var t=null==i[e.type]||null==o[e.subtype]||null==e.format||null==a[e.format];return t&&s.warn("Filtering out subtitle track "+e.timedTextTrackId+" because we don't recognize one of these: type ("+e.type+"), subtype ("+e.subtype+"), or format ("+e.format+")."),!t}).map(function(e){var t=e.timedTextTrackId+"_"+e.format+"_"+n;return{id:e.timedTextTrackId,language:e.languageCode.toLowerCase(),type:null!=e.type?i[e.type]:"Subtitle",subtype:null!=e.subtype?o[e.subtype]:"Dialog",label:e.displayName,activeVariantId:t,variants:[{id:t,format:a[e.format],url:e.url,restrictions:[]}]}})},e}();t.SubtitleUrlTransformer=u});e(px);px.SubtitleUrlTransformer;var fx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.StaticTimedTextDataStore=dx.StaticTimedTextDataStore,t.SubtitleUrlTransformer=px.SubtitleUrlTransformer});e(fx);fx.StaticTimedTextDataStore,fx.SubtitleUrlTransformer;var hx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.generateLookupFallbackTags=function(e){for(var t=[e],n=e,r=n.lastIndexOf("-");-1!==r;)n=n.substring(0,r),t.push(n),r=n.lastIndexOf("-");return t}});e(hx);hx.generateLookupFallbackTags;var mx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isBasicLanguageRangeMatch=function(e,t){var n=e.toLowerCase(),r=t.toLowerCase();return n===r||0===n.indexOf(r+"-")}});e(mx);mx.isBasicLanguageRangeMatch;var yx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.ISO_639_2T_TO_ISO639_1={aar:"aa",abk:"ab",afr:"af",aka:"ak",amh:"am",ara:"ar",arg:"an",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",cat:"ca",ces:"cs",cha:"ch",che:"ce",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",dan:"da",deu:"de",div:"dv",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fry:"fy",ful:"ff",gla:"gd",gle:"ga",glg:"gl",glv:"gv",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",lug:"lg",mah:"mh",mal:"ml",mar:"mr",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"}});e(yx);yx.ISO_639_2T_TO_ISO639_1;var gx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.toExpectedIso639_1LanguageCode=function(e){if(null==e||3!==e.length)return e;if("enm"===e)return"en-gb";if("eng"===e)return"en-us";var t=yx.ISO_639_2T_TO_ISO639_1[e];return null!=t?t:e}});e(gx);gx.toExpectedIso639_1LanguageCode;var vx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.generateLookupFallbackTags=hx.generateLookupFallbackTags,t.isBasicLanguageRangeMatch=mx.isBasicLanguageRangeMatch,t.toExpectedIso639_1LanguageCode=gx.toExpectedIso639_1LanguageCode});e(vx);vx.generateLookupFallbackTags,vx.isBasicLanguageRangeMatch,vx.toExpectedIso639_1LanguageCode;var Sx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.urlResolver=e,this.segmentBases=null,this.indexElement=null,this.byteRangeOffsetValue=0}return e.prototype.reset=function(e){this.segmentBases=e,this.indexElement=null,this.byteRangeOffsetValue=0},Object.defineProperty(e.prototype,"index",{get:function(){return null===this.indexElement&&this.rebuildSegmentBaseInformation(),this.indexElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"byteRangeOffset",{get:function(){return null===this.indexElement&&this.rebuildSegmentBaseInformation(),this.byteRangeOffsetValue},enumerable:!0,configurable:!0}),e.prototype.rebuildSegmentBaseInformation=function(){if(null===this.segmentBases)throw new Error("No SegmentBases have been provided yet");for(var e=0,t=this.segmentBases;e<t.length;e++){var n=t[e];if(null!=n.representationIndex){this.indexElement=n.representationIndex,this.byteRangeOffsetValue=0,this.urlResolver.resolve(n.representationIndex.sourceUrl)===this.urlResolver.resolve()&&(this.byteRangeOffsetValue=this.indexElement.range.end+1);break}if(null!=n.indexRange){this.indexElement={range:n.indexRange},this.byteRangeOffsetValue=this.indexElement.range.end+1;break}}if(null==this.indexElement)throw new Error("Cannot use a SegmentBase without an index!")},e}();t.SegmentBaseInformation=n});e(Sx);Sx.SegmentBaseInformation;var bx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("LocalSegmentIndexAccessor"),n=function(){function e(e,t,n){this.representationInfo=e,this.storageContext=t,this.parseSIDXCallback=n;var r=xI.localStorage.capabilities.isSupported&&RI.metadataStorage.capabilities.isSupported;this.shouldReadStorage=1==(1&t.storageAccess)&&r,this.shouldWriteStorage=2==(2&t.storageAccess)&&r}return e.prototype.retrieveLocalSegmentIndex=function(e,t){var n=this;if(!this.shouldReadStorage||null==this.storageContext.downloadOperationId)return Fe.Promise.resolve(null);var r=this.convertToMediaRepresentationByteRange(t),i=TE.createLocalStorageSegmentIdWithByteRange(this.storageContext.downloadOperationId,this.representationInfo.periodId,this.representationInfo.adaptationSetId,this.representationInfo.representation.id,r,"_sidx");return this.verifyDataAvailability().then(function(e){return e?xI.localStorage.getArrayBuffer(i):null}).then(function(e){return null==e?null:n.parseSIDXCallback(e)}).catch(function(e){return o.error("Fail to retrieve segment index for "+i+", with error:",e),null})},e.prototype.verifyDataAvailability=function(){if(!this.shouldReadStorage||null==this.storageContext.downloadOperationId)return Fe.Promise.resolve(!1);var t=b_.createQualityLevelProgressMetadataKey(this.storageContext.downloadOperationId,this.representationInfo.periodId,this.representationInfo.adaptationSetId,this.representationInfo.representation.id);return RI.metadataStorage.get(t).then(function(e){return null!=e}).catch(function(e){return o.error("Fail to retrieve quality level metadata "+t+", with error:",e),!1})},e.prototype.storeLocalSegmentIndexBinary=function(e,t,n){if(!this.shouldWriteStorage||null==this.storageContext.downloadOperationId)return Fe.Promise.resolve();var r=this.convertToMediaRepresentationByteRange(n),i=TE.createLocalStorageSegmentIdWithByteRange(this.storageContext.downloadOperationId,this.representationInfo.periodId,this.representationInfo.adaptationSetId,this.representationInfo.representation.id,r,"_sidx");return xI.localStorage.put(i,e).catch(function(e){var t="Fail to store segment index binary data "+i;throw o.error(t,e),new Ne.XpError("storage.manifest.sidx",void 0,t,!1,e)})},e.prototype.reset=function(e){this.representationInfo=e},e.prototype.convertToMediaRepresentationByteRange=function(e){return null!=e?{start:e.start,end:null!=e.end?e.end:1/0}:void 0},e}();t.LocalSegmentIndexAccessor=n});e(bx);bx.LocalSegmentIndexAccessor;var Tx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("SegmentIndexTimeoutCalculator"),n=function(){function e(){this.networkRequestManager=lh.getInstance()}return e.prototype.calculateTimeoutMs=function(e){if(null==e)return 6e3;if(null==e.start||null==e.end)return 6e3;var t=this.networkRequestManager.getNetworkStatistics(),n=t.bandwidthAvgKbps,r=t.latencyAvgMs;if(null===n||null===r)return o.info("Empty network statistics: bandwidthAvgKbps="+n+", latencyAvgMs="+r+". Using SIDX default timeout"),6e3;if(0===n)return o.info("bandwidthAvgKbps=0, Using SIDX default timeout"),6e3;var i=e.end-e.start+1;return Math.round(8*i/n)+r+2e3},e}();t.SegmentIndexTimeoutCalculator=n});e(Tx);Tx.SegmentIndexTimeoutCalculator;var Px=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.delay=function(r,i){return new Fe.Promise(function(e,t){var n=A.timer.setTimeout(e,r);i.promise.then(function(e){A.timer.clearTimeout(n),t(e)})})}});e(Px);Px.delay;var wx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("SegmentIndexAcquirer");var n=function(){function e(e,t,n,r){var i=this;this.refreshIndex=function(){if(null!=i.acquisitionPromise)return i.acquisitionPromise;var e=Fe.CancelToken.source(),t=e.token,n=e.cancel;return i.acquisitionPromise=i.acquireIndex(t),i.acquisitionCancel=n,i.acquisitionPromise},this.acquireIndex=function(t){var n=i.urlResolver.resolveSourceUrl(i.segmentBaseInformation.index.sourceUrl),r=i.segmentBaseInformation.index.range;return null!=r&&(n.headers.Range="bytes="+r.start+"-"+r.end),i.localSegmentIndexAccessor.retrieveLocalSegmentIndex(t,r).then(function(e){return t.throwIfRequested(),null!=e?e:i.acquireRemoteSegmentIndexAndProcess(n,t,r)}).then(function(e){return t.throwIfRequested(),i.element={valid:!0,onChange:function(){},contents:e},delete i.acquisitionPromise,e}).catch(function(e){return t.throwIfRequested(),e instanceof lh.AcquisitionError&&i.sourceUrlStore.resourceAcquisitionFailed(e.reason,c_.AcquisitionResourceType.Manifest,n.urlId),Px.delay(500,t).then(function(){return t.throwIfRequested(),i.acquireIndex(t)})})},this.parseSIDX=function(e){var t,n=new i_.BmffParser;try{t=n.parseFragment(e)}catch(e){throw new lh.AcquisitionError({type:"ParseError",cause:e})}var r=i_.Boxes.find(t,i_.Boxes.ofType("sidx"));if(null==r)throw new lh.AcquisitionError({type:"ParseError",cause:new Error("Acquired data does not contain an SIDX box")});return r},this.resourceAcquirer=e.resourceAcquirer,this.sourceUrlStore=e.sourceUrlStore,this.urlResolver=t,this.segmentBaseInformation=n,this.representationInfo=r,this.acquisitionPromise=null,this.acquisitionCancel=null,this.localSegmentIndexAccessor=new bx.LocalSegmentIndexAccessor(r,e.storageContext,this.parseSIDX),this.element={valid:!1,onChange:function(){},refresh:this.refreshIndex},this.segmentIndexTimeoutCalculator=new Tx.SegmentIndexTimeoutCalculator}return e.prototype.get=function(){return this.element},e.prototype.clear=function(){null!=this.acquisitionCancel&&this.acquisitionCancel(),this.element={valid:!1,onChange:function(){},refresh:this.refreshIndex},this.acquisitionPromise=null,this.acquisitionCancel=null},e.prototype.acquireRemoteSegmentIndexAndProcess=function(e,r,i){var t,o,a=this,n=this.segmentIndexTimeoutCalculator.calculateTimeoutMs(i),s=((t={}).amznDtid=Yh.deviceInformation.hardware.deviceTypeId,t),l=this.representationInfo.periodId+"."+this.representationInfo.adaptationSetId+"."+this.representationInfo.representation.id+".sidx";return this.resourceAcquirer.acquire("binary",e,n,0,r,s,l).then(function(e){r.throwIfRequested();var t=e.body,n=a.parseSIDXResource(e);return o=n.body,a.sourceUrlStore.resourceAcquired(n),a.localSegmentIndexAccessor.storeLocalSegmentIndexBinary(t,r,i)}).then(function(){return o})},e.prototype.parseSIDXResource=function(e){var t=this.parseSIDX(e.body),n=e;return n.body=t,n},e.prototype.isRetriableError=function(e){return!0},e}();t.SegmentIndexAcquirer=n});e(wx);wx.SegmentIndexAcquirer;var Cx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.waitForSegmentInTimeline=function(e){var t=this;return function(){return e.load().then(function(e){return"RefreshMe"===e.type?{type:"Unavailable",reason:"Loop of refreshes found!"}:t.resolveSegment(e)})}},e}();t.SegmentResponder=n});e(Cx);Cx.SegmentResponder;var Mx=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){function e(e,t,n,r){var i=o.call(this)||this;return i.type="SegmentBase",i.segmentBases=[],i.segmentBaseInformation=new Sx.SegmentBaseInformation(n),i.segmentIndexAcquirer=new wx.SegmentIndexAcquirer(t,n,i.segmentBaseInformation,r),i.parentSegmentTimeline=e,i.urlResolver=n,i.representationInfo=r,i.reset(r),i}return n(e,o),e.prototype.getInitSegment=function(){for(var e=void 0,t=0,n=this.segmentBases;t<n.length;t++){var r=n[t];if(null!=r.initialization){e=r.initialization;break}}return null==e?{type:"Unavailable",reason:"No SegmentList had any Initialization element"}:{type:"WellKnown",segment:{isInitSegment:!0,sourceUrl:this.urlResolver.resolveSourceUrl(e.sourceUrl),byteRange:e.range}}},e.prototype.resolveSegment=function(e){if("Unavailable"===e.type)return{type:"Unavailable",reason:"No segment found in index!"};if("RefreshMe"===e.type)return{type:"RefreshMe",load:this.waitForSegmentInTimeline(e)};var t=this.segmentIndexAcquirer.get();if(!t.valid)throw new Error("Segment index disappeared!");var n=t.contents,r=n.references[e.index],i={isInitSegment:!1,index:e.segmentNumber,isFinalSegment:e.isFinalSegment,position:{startTimeMs:e.startMs,durationMs:e.durationMs,endTimeMs:e.endMs},sourceUrl:this.urlResolver.resolveSourceUrl(),byteRange:{start:this.segmentBaseInformation.byteRangeOffset+n.firstOffset+r.referencedOffset,end:this.segmentBaseInformation.byteRangeOffset+n.firstOffset+r.referencedOffset+r.referencedSize-1},origin:this.parentSegmentTimeline};return{type:e.type,segment:i}},e.prototype.reset=function(e){this.representationInfo=e,this.segmentBases=[];for(var t=0,n=[e.period,e.adaptationSet,e.representation];t<n.length;t++){var r=n[t];null!=r.segmentBase&&this.segmentBases.unshift(r.segmentBase)}this.segmentBaseInformation.reset(this.segmentBases),this.segmentIndexAcquirer.clear()},e}(Cx.SegmentResponder);t.SegmentBaseSegmentResponder=i});e(Mx);Mx.SegmentBaseSegmentResponder;var Ix=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e,t,n){var r=i.call(this)||this;return r.type="SegmentList",r.segmentLists=[],r.parentSegmentTimeline=e,r.urlResolver=t,r.representationInfo=n,r.reset(n),r}return n(e,i),e.prototype.reset=function(e){this.representationInfo=e,this.segmentLists=[];for(var t=0,n=[e.period,e.adaptationSet,e.representation];t<n.length;t++){var r=n[t];null!=r.segmentList&&this.segmentLists.push(r.segmentList)}},e.prototype.getInitSegment=function(){for(var e=void 0,t=0,n=this.segmentLists;t<n.length;t++){var r=n[t];null!=r.initialization&&(e=r.initialization)}return null==e?{type:"Unavailable",reason:"No SegmentList had any Initialization element"}:{type:"WellKnown",segment:{isInitSegment:!0,sourceUrl:this.urlResolver.resolveSourceUrl(e.sourceUrl),byteRange:e.range}}},e.prototype.resolveSegment=function(e){if("Unavailable"===e.type)return{type:"Unavailable",reason:"No segment found in timeline!"};if("RefreshMe"===e.type)return{type:"RefreshMe",load:this.waitForSegmentInTimeline(e)};for(var t=void 0,n=0,r=this.segmentLists;n<r.length;n++){var i=r[n];0<i.segmentURLs.length&&(t=i.segmentURLs)}if(null==t)return{type:"Unavailable",reason:"No SegmentList had any SegmentURL elements"};var o=t[e.index],a={isInitSegment:!1,index:e.segmentNumber,isFinalSegment:e.isFinalSegment,position:{startTimeMs:e.startMs,durationMs:e.durationMs,endTimeMs:e.endMs},sourceUrl:this.urlResolver.resolveSourceUrl(o.media),byteRange:o.mediaRange,origin:this.parentSegmentTimeline};return{type:e.type,segment:a}},e}(Cx.SegmentResponder);t.SegmentListSegmentResponder=i});e(Ix);Ix.SegmentListSegmentResponder;var Ex=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.isInitSegment=!1,this.index=e.segmentNumber,this.isFinalSegment=e.isFinalSegment,this.position={startTimeMs:e.startMs,durationMs:e.durationMs,endTimeMs:e.endMs},this.origin=t,this.resolveSourceUrl=n,this.cachedSourceUrl=null}return Object.defineProperty(e.prototype,"sourceUrl",{get:function(){return null==this.cachedSourceUrl&&(this.cachedSourceUrl=this.resolveSourceUrl()),this.cachedSourceUrl},enumerable:!0,configurable:!0}),e}();t.DashMediaSegmentInfoDeferredSourceUrl=n});e(Ex);Ex.DashMediaSegmentInfoDeferredSourceUrl;var _x=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function u(){}return u.resolve=function(e,t){for(var n=[],r=0;;){var i=e.indexOf("$",r);if(-1===i){n.push(e.substring(r));break}n.push(e.substring(r,i));var o=e.indexOf("$",i+1),a=e.substring(i+1,o),s=0,l=a.indexOf("%");-1!==l&&(s=parseInt(a.substring(l+2,a.length-1)),a=a.substring(0,l)),""===a?n.push("$"):n.push(u.leftPadWithZero(""+t[a],s)),r=o+1}return n.join("")},u.leftPadWithZero=function(e,t){for(var n=Math.max(0,t-e.length),r=[];0<n;n--)r.push("0");return r.join("")+e},u}();t.TemplateUrlResolver=n});e(_x);_x.TemplateUrlResolver;var xx=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(i){function e(e,t,n){var r=i.call(this)||this;return r.type="SegmentTemplate",r.segmentTemplates=[],r.parentSegmentTimeline=e,r.urlResolver=t,r.representationInfo=n,r.reset(n),r}return n(e,i),e.prototype.reset=function(e){this.representationInfo=e,this.segmentTemplates=[];for(var t=0,n=[e.period,e.adaptationSet,e.representation];t<n.length;t++){var r=n[t];null!=r.segmentTemplate&&this.segmentTemplates.push(r.segmentTemplate)}},e.prototype.getInitSegment=function(){for(var e=void 0,t=0,n=this.segmentTemplates;t<n.length;t++){var r=n[t];null!=r.initializationTemplate&&(e=r.initializationTemplate)}if(null==e)return{type:"Unavailable",reason:"No SegmentTemplate had an init template attribute"};var i=_x.TemplateUrlResolver.resolve(e,{RepresentationID:this.representationInfo.representation.id,Bandwidth:this.representationInfo.representation.bandwidth});return{type:"WellKnown",segment:{isInitSegment:!0,sourceUrl:this.urlResolver.resolveSourceUrl(i)}}},e.prototype.resolveSegment=function(e){if("Unavailable"===e.type)return{type:"Unavailable",reason:xt.withDefault(e.reason,"No segment found in timeline!"),etaMs:e.etaMs};if("RefreshMe"===e.type)return{type:"RefreshMe",load:this.waitForSegmentInTimeline(e)};for(var t=void 0,n=0,r=this.segmentTemplates;n<r.length;n++){var i=r[n];null!=i.mediaTemplate&&(t=i.mediaTemplate)}if(null==t)return{type:"Unavailable",reason:"No SegmentTemplate had a media template attribute"};var o=_x.TemplateUrlResolver.resolve(t,{Number:e.segmentNumber,RepresentationID:this.representationInfo.representation.id,Bandwidth:this.representationInfo.representation.bandwidth,Time:e.startTicks}),a=this.urlResolver,s=new Ex.DashMediaSegmentInfoDeferredSourceUrl(e,this.parentSegmentTimeline,function(){return a.resolveSourceUrl(o)});return{type:e.type,segment:s}},e}(Cx.SegmentResponder);t.SegmentTemplateSegmentResponder=i});e(xx);xx.SegmentTemplateSegmentResponder;var kx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.create=function(e,t,n,r){for(var i=0,o=[r.period,r.adaptationSet,r.representation];i<o.length;i++){var a=o[i];if(null!=a.segmentList)return new Ix.SegmentListSegmentResponder(e,n,r);if(null!=a.segmentTemplate)return new xx.SegmentTemplateSegmentResponder(e,n,r);if(null!=a.segmentBase)return new Mx.SegmentBaseSegmentResponder(e,t,n,r)}throw new Error("Invalid MPD found. Does not contain SegmentBase, SegmentList or SegmentTemplate at any level")},e}();t.SegmentResponderFactory=n});e(kx);kx.SegmentResponderFactory;var Rx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.segmentInfos=[],this.presentationTimeOffsetTicks=0,this.segmentDurationTicks=0,this.timescale=1,this.startNumber=1,this.timeWindow=e,this.representationInfo=t,this.reset(t)}return Object.defineProperty(e.prototype,"presentationTimeOffsetMs",{get:function(){return this.presentationTimeOffsetTicks/this.timescale*1e3},enumerable:!0,configurable:!0}),e.prototype.reset=function(e){this.representationInfo=e,this.segmentInfos=[];for(var t=0,n=[e.period,e.adaptationSet,e.representation];t<n.length;t++){var r=n[t];null!=r.segmentList?this.segmentInfos.push(r.segmentList):null!=r.segmentTemplate&&this.segmentInfos.push(r.segmentTemplate)}this.timescale=1,this.presentationTimeOffsetTicks=0,this.startNumber=1;for(var i=0,o=this.segmentInfos;i<o.length;i++){var a=o[i];null!=a.presentationTimeOffset&&(this.presentationTimeOffsetTicks=a.presentationTimeOffset),null!=a.timescale&&(this.timescale=a.timescale),null!=a.startNumber&&(this.startNumber=a.startNumber),null!=a.duration&&(this.segmentDurationTicks=a.duration)}},e.prototype.querySegment=function(e){var t=Math.floor(e/1e3*this.timescale/this.segmentDurationTicks);return this.resolveSegment(t)},e.prototype.querySegmentBySequence=function(e){return this.resolveSegment(e)},e.prototype.queryNextSegment=function(e){return this.resolveSegment(e.index+1)},e.prototype.resolveSegment=function(e){var t=e*this.segmentDurationTicks,n=1e3*t/this.timescale,r=1e3*(t+this.segmentDurationTicks)/this.timescale,i=this.representationInfo.period.startMs+r;return i<=this.timeWindow.startMs||i>this.timeWindow.endMs?{type:"Unavailable"}:{type:"Inferred",segmentNumber:this.startNumber+e,startMs:n,durationMs:1e3*this.segmentDurationTicks/this.timescale,endMs:r,isFinalSegment:!1,startTicks:t,index:e}},e}();t.InterpolatedTimelineResponder=n});e(Rx);Rx.InterpolatedTimelineResponder;var Ax=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.presentationTimeOffsetTicks=0,this.timescale=1,this.indexAcquirer=e,this.representationInfo=t,this.reset(t)}return Object.defineProperty(e.prototype,"presentationTimeOffsetMs",{get:function(){return this.presentationTimeOffsetTicks/this.timescale*1e3},enumerable:!0,configurable:!0}),e.prototype.querySegment=function(t,n){var r=this;if(void 0===n&&(n=0),t<0||t>this.representationInfo.period.durationMs)return{type:"Unavailable"};var e=this.indexAcquirer.get();return e.valid?this.querySegmentOnIndex(e.contents,t,n):{type:"RefreshMe",load:function(){return e.refresh().then(function(e){return r.querySegmentOnIndex(e,t,n)})}}},e.prototype.querySegmentBySequence=function(t){var n=this;if(t<0)return{type:"Unavailable"};var e=this.indexAcquirer.get();return e.valid?this.querySegmentBySequenceOnIndex(e.contents,t):{type:"RefreshMe",load:function(){return e.refresh().then(function(e){return n.querySegmentBySequenceOnIndex(e,t)})}}},e.prototype.queryNextSegment=function(t){var n=this,e=this.indexAcquirer.get();return e.valid?this.queryNextSegmentOnIndex(e.contents,t):{type:"RefreshMe",load:function(){return e.refresh().then(function(e){return n.queryNextSegmentOnIndex(e,t)})}}},e.prototype.querySegmentBySequenceOnIndex=function(e,t){return t>=e.references.length?{type:"Unavailable"}:this.convertReference(e,t)},e.prototype.querySegmentOnIndex=function(e,t,n){n=Math.min(n,this.representationInfo.period.durationMs-t);var r=Math.floor(t*this.timescale/1e3+this.presentationTimeOffsetTicks-e.earliestPresentationTime),i=Math.floor((t+n)*this.timescale/1e3+this.presentationTimeOffsetTicks-e.earliestPresentationTime),o=Mp.binarySearchIndexOf(e.references,function(e){return e.subsegmentPosition>i?-1:e.subsegmentPosition+e.subsegmentDuration<=i?1:0});if(0<=o)return this.convertReference(e,o);var a=e.references.length-1,s=e.references[a];return r<=s.subsegmentPosition+s.subsegmentDuration?this.convertReference(e,a):{type:"Unavailable"}},e.prototype.queryNextSegmentOnIndex=function(e,t){return t.index+1>=e.referenceCount?{type:"Unavailable"}:this.convertReference(e,t.index+1)},e.prototype.convertReference=function(e,t){var n=e.references[t],r=e.earliestPresentationTime+n.subsegmentPosition,i=1e3*(r-this.presentationTimeOffsetTicks)/this.timescale,o=1e3*(r+n.subsegmentDuration-this.presentationTimeOffsetTicks)/this.timescale;return o<0||i>this.representationInfo.period.durationMs?{type:"Unavailable"}:{type:"WellKnown",segmentNumber:t,startMs:i,durationMs:1e3*n.subsegmentDuration/this.timescale,endMs:o,isFinalSegment:t===e.referenceCount-1||o>this.representationInfo.period.durationMs,startTicks:r,index:t}},e.prototype.reset=function(e){for(var t=0,n=[(this.representationInfo=e).period,e.adaptationSet,e.representation];t<n.length;t++){var r=n[t];if(null!=r.segmentBase){var i=r.segmentBase;null!=i.presentationTimeOffset&&(this.presentationTimeOffsetTicks=i.presentationTimeOffset),null!=i.timescale&&(this.timescale=i.timescale)}}},e}();t.SegmentBaseTimelineResponder=n});e(Ax);Ax.SegmentBaseTimelineResponder;var Ox=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.segmentTimelines=[],this.segmentInfos=[],this.presentationTimeOffsetTicks=0,this.timescale=1,this.startNumber=1,this.lastSegmentSequence=-1,this.earliestSegmentStartTicks=-1,this.lastSegmentEndTicks=-1,this.maxSegmentDurationMs=2e3,this.timeWindow=t,this.representationInfo=n,this.mpdRefresher=e,this.reset(n)}return Object.defineProperty(e.prototype,"presentationTimeOffsetMs",{get:function(){return this.presentationTimeOffsetTicks/this.timescale*1e3},enumerable:!0,configurable:!0}),e.prototype.reset=function(e){this.representationInfo=e,this.segmentInfos=[];for(var t=0,n=[e.period,e.adaptationSet,e.representation];t<n.length;t++){var r=n[t];null!=r.segmentList?this.segmentInfos.push(r.segmentList):null!=r.segmentTemplate&&this.segmentInfos.push(r.segmentTemplate)}this.segmentTimelines=[],this.timescale=1,this.presentationTimeOffsetTicks=0,this.startNumber=1;for(var i=0,o=this.segmentInfos;i<o.length;i++){var a=o[i];null!=a.segmentTimeline&&this.segmentTimelines.unshift(a.segmentTimeline),null!=a.presentationTimeOffset&&(this.presentationTimeOffsetTicks=a.presentationTimeOffset),null!=a.timescale&&(this.timescale=a.timescale),null!=a.startNumber&&(this.startNumber=a.startNumber)}var s=this.segmentTimelines[0].entries[0],l=this.segmentTimelines[0].entries[this.segmentTimelines[0].entries.length-1];this.lastSegmentSequence=this.startNumber+l.seq+("Pattern"===l.type?l.numSegments:1)*(l.r+1)-1,this.earliestSegmentStartTicks=s.t,this.lastSegmentEndTicks=l.t+(l.r+1)*l.d},e.prototype.queryNextSegment=function(e){if(e.isFinalSegment)return{type:"Unavailable",reason:"Segment "+e.index+" is the final segment of period "+this.representationInfo.period.id};var t=e.index+1;return this.querySegmentBySequence(t)},e.prototype.querySegmentBySequence=function(e){var t=this,n=this.segmentTimelines[0];if(e<this.startNumber)return{type:"Unavailable",reason:"Segment "+e+" is outside the range of available sequences (["+this.startNumber+", "+this.lastSegmentSequence+"]) in period "+this.representationInfo.period.id};if(e>this.lastSegmentSequence){var r=(this.lastSegmentEndTicks-this.presentationTimeOffsetTicks)/this.timescale*1e3+(e-this.lastSegmentSequence-1)*this.maxSegmentDurationMs,i=null!=this.representationInfo.period.durationMs&&isFinite(this.representationInfo.period.durationMs)?void 0:this.timeWindow.getSegmentEtaMs(this.representationInfo.period.startMs+r,this.maxSegmentDurationMs);return 0===i?{type:"RefreshMe",load:function(){return t.mpdRefresher.waitRefresh().then(function(){return t.querySegmentBySequence(e)})}}:{type:"Unavailable",etaMs:i,reason:"Segment "+e+" is outside the range of available sequences (["+this.startNumber+", "+this.lastSegmentSequence+"]) in period "+this.representationInfo.period.id}}var o,a=e-this.startNumber,s=Mp.binarySearchIndexOfClosestBelow(n.entries,function(e){return a-e.seq}),l=n.entries[s],u=0,c=0;if("S"===l.type)o=l;else{var d=Math.floor((a-l.seq)/l.numSegments);u=l.seq+d*l.numSegments,c=l.t+d*l.d;var p=a-u,f=Mp.binarySearchIndexOfClosestBelow(l.S,function(e){return p-e.seq});o=l.S[f]}var h=a-(u+o.seq),m=c+o.t+h*o.d,y=m-this.presentationTimeOffsetTicks;return{type:"WellKnown",index:e-this.startNumber,segmentNumber:e,startTicks:m,startMs:y/this.timescale*1e3,durationMs:o.d/this.timescale*1e3,endMs:(y+o.d)/this.timescale*1e3,isFinalSegment:e===this.lastSegmentSequence&&null!=this.representationInfo.period.durationMs&&isFinite(this.representationInfo.period.durationMs)}},e.prototype.querySegment=function(e,t){var n=this;void 0===t&&(t=0);var r=this.segmentTimelines[0];if(e<0||e>this.representationInfo.period.durationMs)return{type:"Unavailable",reason:"Position "+e+"ms is out of bounds for period "+this.representationInfo.period.id+": [0,"+this.representationInfo.period.durationMs+"]"};var i=this.representationInfo.period.startMs+e;if(i<this.timeWindow.startMs||i>this.timeWindow.endMs)return 0===(o=i>this.timeWindow.endMs?this.timeWindow.getSegmentEtaMs(this.representationInfo.period.startMs+e,this.maxSegmentDurationMs):void 0)?{type:"RefreshMe",load:function(){return n.mpdRefresher.waitRefresh().then(function(){return n.querySegment(e,t)})}}:{type:"Unavailable",etaMs:o,reason:"MPD position "+i+"ms (for period-relative position "+e+"ms on period "+this.representationInfo.period.id+") is outside of the time window ["+this.timeWindow.startMs+", "+this.timeWindow.endMs+"]"};var o,a=Math.floor(this.presentationTimeOffsetTicks+e*this.timescale/1e3),s=Math.floor(this.presentationTimeOffsetTicks+(e+t)*this.timescale/1e3);if(a>this.lastSegmentEndTicks)return 0===(o=isFinite(this.representationInfo.period.durationMs)?void 0:this.timeWindow.getSegmentEtaMs(this.representationInfo.period.startMs+e,this.maxSegmentDurationMs))?{type:"RefreshMe",load:function(){return n.mpdRefresher.waitRefresh().then(function(){return n.querySegment(e,t)})}}:{type:"Unavailable",etaMs:o,reason:"Position "+e+"ms ("+a+" ticks) is outside of the segment timeline in period "+this.representationInfo.period.id+". Available times: ["+this.earliestSegmentStartTicks+", "+this.lastSegmentEndTicks+"] ticks"};var l,u=Mp.binarySearchIndexOfClosestBelow(r.entries,function(e){return s-e.t}),c=r.entries[u],d=c.t+(1+c.r)*c.d<s?a:s,p=0,f=0;if("S"===c.type)l=c;else{var h=Math.floor((d-c.t)/c.d);p=c.seq+h*c.numSegments;var m=d-(f=c.t+h*c.d),y=Mp.binarySearchIndexOfClosestBelow(c.S,function(e){return m-e.t});l=c.S[y]}var g=Math.floor((d-f-l.t)/l.d),v=f+l.t+g*l.d,S=v-this.presentationTimeOffsetTicks,b=this.startNumber+p+l.seq+g;return{type:"WellKnown",index:b-this.startNumber,segmentNumber:b,startTicks:v,startMs:S/this.timescale*1e3,durationMs:l.d/this.timescale*1e3,endMs:(S+l.d)/this.timescale*1e3,isFinalSegment:b===this.lastSegmentSequence&&null!=this.representationInfo.period.durationMs&&isFinite(this.representationInfo.period.durationMs)}},e}();t.SegmentTimelineTimelineResponder=n});e(Ox);Ox.SegmentTimelineTimelineResponder;var Lx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function o(){}return o.create=function(e,t,n,r){if("SegmentList"===t.type||"SegmentTemplate"===t.type){if(o.hasSegmentTimeline(r))return new Ox.SegmentTimelineTimelineResponder(n,e,r)}else if("SegmentBase"===t.type){var i=t;return new Ax.SegmentBaseTimelineResponder(i.segmentIndexAcquirer,r)}return new Rx.InterpolatedTimelineResponder(e,r)},o.hasSegmentTimeline=function(e){for(var t=0,n=[e.representation,e.adaptationSet,e.period];t<n.length;t++){var r=n[t];if(null!=r)for(var i=0,o=[r.segmentList,r.segmentTemplate];i<o.length;i++){var a=o[i];if(null!=a&&null!=a.segmentTimeline)return!0}}return!1},o}();t.TimelineResponderFactory=n});e(Lx);Lx.TimelineResponderFactory;var Fx=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.sourceUrlStore=e,this.representationInfo=t,this.currentSourceUrl="",this.baseUrl=null}return e.prototype.reset=function(e){this.representationInfo=e,this.baseUrl=null},e.prototype.resolveSourceUrl=function(e){var t=this.resolve(e);return n({},this.sourceUrlStore.get(),{url:t})},e.prototype.resolve=function(e){var t=this.getBaseUrl();return null!=e?new ME.URL(e,t).toString():this.baseUrl},e.prototype.getBaseUrl=function(){var e=this.sourceUrlStore.get().url;if(null===this.baseUrl||e!==this.currentSourceUrl){var t=new ME.URL(e);this.currentSourceUrl=e;for(var n=0,r=[this.representationInfo.representation,this.representationInfo.adaptationSet,this.representationInfo.period,this.representationInfo.mpd];n<r.length;n++){var i=r[n];if(null!=i.baseUrl&&0<i.baseUrl.length){t=new ME.URL(i.baseUrl[0].baseUrl,t);break}}this.baseUrl=t.toString()}return this.baseUrl},e}();t.UrlResolver=r});e(Fx);Fx.UrlResolver;var Dx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){this.representationInfo=r,this.urlResolver=new Fx.UrlResolver(e.sourceUrlStore,r),this.segmentResponder=kx.SegmentResponderFactory.create(this,e,this.urlResolver,r),this.timelineResponder=Lx.TimelineResponderFactory.create(t,this.segmentResponder,n,r)}return e.prototype.reset=function(e){this.representationInfo=e,this.urlResolver.reset(e),this.segmentResponder.reset(e),this.timelineResponder.reset(e)},Object.defineProperty(e.prototype,"presentationTimeOffsetMs",{get:function(){return this.timelineResponder.presentationTimeOffsetMs},enumerable:!0,configurable:!0}),e.prototype.getNext=function(e){var t=e;if(null==t.origin||null==t.origin.representationInfo)return{type:"Unavailable",reason:"Reference segment does not come from a valid segment timeline"};var n=this.timelineResponder.queryNextSegment(t);return this.segmentResponder.resolveSegment(n)},e.prototype.getEquivalentSegment=function(e){var t=e;if(null==t.origin||null==t.origin.representationInfo)return{type:"Unavailable",reason:"Reference segment does not come from a valid segment timeline"};if(t.origin.representationInfo.period.id!==this.representationInfo.period.id)return{type:"Unavailable",reason:"Reference segment does not come from the same period of the same content"};var n=this.timelineResponder.querySegmentBySequence(t.index);return this.segmentResponder.resolveSegment(n)},e.prototype.getInitSegment=function(){return this.segmentResponder.getInitSegment()},e.prototype.getSegmentAt=function(e,t){var n=this.timelineResponder.querySegment(e,t);return this.segmentResponder.resolveSegment(n)},e.prototype.toJSON=function(){return{}},e}();t.DashSegmentTimeline=n});e(Dx);Dx.DashSegmentTimeline;var Nx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i,o,a,s,l){var u;this.adaptationSet=a,this.adaptationSetId=s,this.mpd=r,this.period=i,this.periodId=o,this.representation=l,this.bandwidth=l.bandwidth,this.codecPrivateData="",this.supported=!0,u=null!=l.codecs?l.codecs:null!=a.codecs?a.codecs:[""],this.codecs=u.join(","),this.id=l.id,this.segmentTimeline=new Dx.DashSegmentTimeline(e,n,t,{mpd:this.mpd,period:this.period,periodId:this.periodId,adaptationSet:this.adaptationSet,adaptationSetId:this.adaptationSetId,representation:this.representation})}return e.prototype.reset=function(e){this.segmentTimeline.reset(e),this.mpd=e.mpd,this.period=e.period,this.periodId=e.periodId,this.adaptationSet=e.adaptationSet,this.adaptationSetId=e.adaptationSetId,this.representation=e.representation},e.prototype.toJSON=function(){return F.omit(this,["adaptationSet","mpd","period","representation"])},e}();t.DashQualityLevel=n});e(Nx);Nx.DashQualityLevel;var Ux=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){function e(e,t,n,r,i,o,a,s,l){var u=c.call(this,e,t,n,r,i,o,a,s,l)||this;return null!=l.audioSamplingRate&&(u.samplingRate=F.isNumber(l.audioSamplingRate)?l.audioSamplingRate:l.audioSamplingRate.max),u}return n(e,c),e}(Nx.DashQualityLevel);t.DashAudioQualityLevel=i});e(Ux);Ux.DashAudioQualityLevel;var Bx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("DashStream");var d={"urn:mpeg:dash:mp4protection:2011":0,"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":3,"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":4},n=function(){function l(e,t,n,r,i,o,a){this.mediaRepresentationFilters=[],this.adaptationSet=a,this.mpd=r,this.period=i,this.context=e,this.baseId=l.getStreamBaseId(a),this.id=l.getStreamId(a);var s=l.getMimeType(a);if(null==s)throw new Error("Unable to extract mime type for AdaptationSet");this.mimeType=s,this.type=l.getStreamType(a),this.segmentAlignment=!1!==a.segmentAlignment,this.supported=!0,this.contentProtections=this.transformContentProtection(),this.originalQualityLevels=F.sortBy(this.createQualityLevels(t,n,o),function(e){return e.bandwidth}),this.qualityLevels=this.originalQualityLevels}return l.prototype.reset=function(n,r,i,o){this.mpd=n,this.period=r,this.adaptationSet=o;for(var e=function(t){var e=F.find(o.representation,function(e){return e.id===t.id});if(null==e)throw new Error("IncompatibleManifest - "+a.type+"Stream@id="+a.id+" did not find quality "+t.id+" on compatible representations?!?");t.reset({mpd:n,period:r,periodId:i,adaptationSet:o,adaptationSetId:a.id,representation:e})},a=this,t=0,s=this.originalQualityLevels;t<s.length;t++){e(s[t])}this.filterQualityLevels()},l.prototype.applyFilters=function(e){this.mediaRepresentationFilters=e,this.filterQualityLevels()},l.getStreamId=function(e){var t=e.representation[0].codecs;return l.getStreamBaseId(e)+"_"+t},l.getStreamType=function(e){if(null!=e.contentType){if("audio"===e.contentType)return"Audio";if("application"===e.contentType)return"TimedText";if("video"===e.contentType)return"Video";throw new Error("Unrecognized content type "+e.contentType)}var t=l.getMimeType(e);if("audio/mp4"===t)return"Audio";if("application/mp4"===t)return"TimedText";if("video/mp4"===t)return"Video";throw new Error("Unrecognized mimeType "+t)},l.getMimeType=function(e){return xt.withDefault(e.representation[0].mimeType,e.mimeType)},l.prototype.transformContentProtection=function(){for(var e=[],t=0,n=this.adaptationSet.representation;t<n.length;t++){var r=n[t];if(null!=r.contentProtection){e=r.contentProtection;break}}if(0===e.length&&null!=this.adaptationSet.contentProtection)e=this.adaptationSet.contentProtection;else if(0===e.length)return;for(var i=[],o=0,a=e;o<a.length;o++){var s=a[o],l=d[s.schemeIdUri];if(null!=l){var u={scheme:l};if(0===l)u.keyId=s.defaultKID;else if(3===l||4===l){var c=s;null!=c.pssh&&(u.pssh=c.pssh[0])}i.push(u)}}return i},l.getStreamBaseId=function(e){return null!=e.audioTrackId?""+e.audioTrackId:null!=e.lang?e.lang+"_dialog_0":null!=e.id?""+e.id:""},l.prototype.filterQualityLevels=function(){var i=this;0===this.mediaRepresentationFilters.length?this.qualityLevels=this.originalQualityLevels:this.qualityLevels=this.originalQualityLevels.filter(function(e){for(var t=!0,n=0,r=i.mediaRepresentationFilters;n<r.length;n++){if(!r[n].isQualityLevelSupported(i,e)){t=!1;break}}return e.supported=t})},l.prototype.toJSON=function(){return F.omit(this,["adaptationSet","contentProtections","context","mediaRepresentationFilter","mpd","period","qualityLevels","representation"])},l}();t.DashStream=n});e(Bx);Bx.DashStream;var Vx=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(u){function e(e,t,n,r,i,o,a,s){var l=u.call(this,e,t,n,r,i,o,a)||this;return l.language=vx.toExpectedIso639_1LanguageCode(a.lang),l.subtype=l.getAudioSubtype(s),l.label=l.getAudioLabel(s),l.audioTrackId=a.audioTrackId,l}return n(e,u),e.prototype.createQualityLevels=function(t,n,r){var i=this;return this.adaptationSet.representation.map(function(e){return new Ux.DashAudioQualityLevel(i.context,t,n,i.mpd,i.period,r,i.adaptationSet,i.id,e)})},e.prototype.getAudioSubtype=function(e){var t="Dialog";1===Object.keys(e).length&&(t=e[Object.keys(e)[0]].subtype);var n=t;return null!=e[this.baseId]&&(n=e[this.baseId].subtype),n},e.prototype.getAudioLabel=function(e){return 1===Object.keys(e).length?e[Object.keys(e)[0]].label:null!=e[this.baseId]?e[this.baseId].label:void 0},e}(Bx.DashStream);t.DashAudioStream=i});e(Vx);Vx.DashAudioStream;var jx=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(l){function e(e,t,n,r,i,o,a){var s=l.call(this,e,t,n,r,i,o,a)||this;return s.language=vx.toExpectedIso639_1LanguageCode(a.lang),s.textType="Subtitle",s.subtype="Dialog",s}return n(e,l),e.prototype.createQualityLevels=function(t,n,r){var i=this;return this.adaptationSet.representation.map(function(e){return new Nx.DashQualityLevel(i.context,t,n,i.mpd,i.period,r,i.adaptationSet,i.id,e)})},e}(Bx.DashStream);t.DashTimedTextStream=i});e(jx);jx.DashTimedTextStream;var Xx=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(c){function e(e,t,n,r,i,o,a,s,l){var u=c.call(this,e,t,n,r,i,o,a,s,l)||this;return u.frameRate=xt.withDefault(l.frameRate,a.frameRate),u.height=l.height,u.width=l.width,u}return n(e,c),e}(Nx.DashQualityLevel);t.DashVideoQualityLevel=i});e(Xx);Xx.DashVideoQualityLevel;var zx=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(l){function e(e,t,n,r,i,o,a){var s=l.call(this,e,t,n,r,i,o,a)||this;return s.pictureAspectRatio=a.par,s}return n(e,l),e.prototype.createQualityLevels=function(t,n,r){var i=this;return this.adaptationSet.representation.map(function(e){return new Xx.DashVideoQualityLevel(i.context,t,n,i.mpd,i.period,r,i.adaptationSet,i.id,e)})},e}(Bx.DashStream);t.DashVideoStream=i});e(zx);zx.DashVideoStream;var qx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var g=M.get("DashPeriod"),n=function(){function e(e,t,n,r,i,o,a,s,l){this.mediaRepresentationFilters=[],this.isFirstOccurrenceOfTypeId=function(t,e,n){return F.findIndex(n,function(e){return t.id===e.id&&t.type===e.type})===e},this.context=e,this.mpd=r,this.period=i,this.audioTrackMetadata=l,this.startMs=o,this.durationMs=a,this.mediaWallClockUtcStartMs=this.extractMediaWallClockUtcStartMs(i),this.originalStreams=this.createStreams(t,n),this.streams=this.originalStreams,this.isFinalPeriod=s}return e.prototype.reset=function(n,r,e,t){this.mpd=n,this.period=r,this.durationMs=e,this.isFinalPeriod=t;var i=this.originalStreams.map(function(e){return{type:e.type,id:e.id}});i=i.filter(this.isFirstOccurrenceOfTypeId);for(var o=function(t){var e=r.adaptationSet.filter(function(e){return Bx.DashStream.getStreamType(e)===t.type&&Bx.DashStream.getStreamId(e)===t.id});if(F.isEmpty(e))throw new Error("IncompatibleManifest - Period@id="+a.id+" did not find matching "+t.type+" AdaptationSets "+t.id+" on compatible representations?!?")},a=this,s=0,l=i;s<l.length;s++){o(l[s])}for(var u=function(t){var e=F.find(r.adaptationSet,function(e){return Bx.DashStream.getStreamType(e)===t.type&&Bx.DashStream.getStreamId(e)===t.id});if(null==e)throw new Error("IncompatibleManifest - Period@id="+c.id+" did not find matching "+t.type+" AdaptationSets "+t.id+" on compatible representations?!?");t.reset(n,r,c.id,e)},c=this,d=0,p=this.originalStreams;d<p.length;d++){u(p[d])}for(var f=function(e){var t=Bx.DashStream.getStreamType(e),n=Bx.DashStream.getStreamId(e);h.originalStreams.some(function(e){return t===e.type&&n===e.id})||g.warn("New adaptationSet added with streamType: "+t+", streamId: "+n+", periodId: "+r.id+".")},h=this,m=0,y=r.adaptationSet;m<y.length;m++){f(y[m])}this.filterStreams()},e.prototype.applyFilters=function(e){this.mediaRepresentationFilters=e;for(var t=0,n=this.originalStreams;t<n.length;t++){n[t].applyFilters(e)}this.filterStreams()},Object.defineProperty(e.prototype,"id",{get:function(){return null!=this.period.id?this.period.id:"@@id@@"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endMs",{get:function(){return this.startMs+this.durationMs},enumerable:!0,configurable:!0}),e.prototype.createStreams=function(t,n){var r=this;return this.period.adaptationSet.map(function(e){switch(Bx.DashStream.getStreamType(e)){case"Audio":return new Vx.DashAudioStream(r.context,t,n,r.mpd,r.period,r.id,e,r.audioTrackMetadata);case"TimedText":return new jx.DashTimedTextStream(r.context,t,n,r.mpd,r.period,r.id,e);case"Video":return new zx.DashVideoStream(r.context,t,n,r.mpd,r.period,r.id,e)}})},e.prototype.extractMediaWallClockUtcStartMs=function(e){if(null!=e.supplementalProperty)for(var t=0,n=e.supplementalProperty;t<n.length;t++){var r=n[t];if("urn:scte:dash:utc-time"===r.schemeIdUri&&null!=r.value)return new Date(r.value).getTime()}},e.prototype.filterStreams=function(){0===this.mediaRepresentationFilters.length?this.streams=this.originalStreams:this.streams=this.originalStreams.filter(function(e){var t=0<e.qualityLevels.length;return e.supported=t})},e.prototype.toJSON=function(){return F.omit(this,["adaptationSet","context","mediaRepresentationFilter","mpd","period","representation","streams"])},e}();t.DashPeriod=n});e(qx);qx.DashPeriod;var Wx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("DashManifestUtility");var n=function(){function e(){}return e.extractEarliestAvailableMPDTime=function(e,t,n){for(var r=e.period[0],i=0,o=0,a=r.adaptationSet;o<a.length;o++)for(var s=a[o],l=0,u=s.representation;l<u.length;l++){for(var c=u[l],d=0,p=1,f=null,h=0,m=[r.segmentTemplate,s.segmentTemplate,c.segmentTemplate];h<m.length;h++){var y=m[h];null!=y&&null!=y.timescale&&(p=y.timescale),null!=y&&null!=y.presentationTimeOffset&&(d=y.presentationTimeOffset),null!=y&&null!=y.segmentTimeline&&(f=y.segmentTimeline)}if(null!=f){var g=1e3*(f.entries[0].t-d)/p;i<g&&(i=g)}}return r.startMs+i},e.extractLatestAvailableMPDTime=function(e,t,n){for(var r=e.period[e.period.length-1],i=1/0,o=0,a=r.adaptationSet;o<a.length;o++)for(var s=a[o],l=0,u=s.representation;l<u.length;l++){for(var c=u[l],d=0,p=1,f=null,h=0,m=[r.segmentTemplate,s.segmentTemplate,c.segmentTemplate];h<m.length;h++){var y=m[h];null!=y&&null!=y.timescale&&(p=y.timescale),null!=y&&null!=y.presentationTimeOffset&&(d=y.presentationTimeOffset),null!=y&&null!=y.segmentTimeline&&(f=y.segmentTimeline)}if(null!=f){var g=f.entries[f.entries.length-1],v=1e3*(g.t+(g.r+1)*g.d-d)/p;v<i&&(i=v)}}return isFinite(i)?r.startMs+i:t-n},e}();t.DashManifestUtility=n});e(Wx);Wx.DashManifestUtility;var Hx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.timeShiftBufferDepthMs=0,this.latestAvailableMPDTimeMs=0,this.earliestAvailableMPDTimeMs=0,this.fetchTime=0,this.availabilityStartTimeMs=0,this.updatePeriodMs=-1}return Object.defineProperty(e.prototype,"startMs",{get:function(){return Math.max(this.endMs-this.timeShiftBufferDepthMs,this.earliestAvailableMPDTimeMs,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endMs",{get:function(){return this.latestAvailableMPDTimeMs+(Date.now()-this.fetchTime)},enumerable:!0,configurable:!0}),e.prototype.reset=function(e){null==e.minimumUpdatePeriodMs?this.updatePeriodMs=null:-1===this.updatePeriodMs&&(this.updatePeriodMs=xt.withDefault(e.minimumUpdatePeriodMs,0));var t=this.timeShiftBufferDepthMs;this.timeShiftBufferDepthMs=xt.withDefault(e.timeShiftBufferDepthMs,1/0),this.availabilityStartTimeMs=e.availabilityStartTimeMs,this.fetchTime=Date.now(),this.latestAvailableMPDTimeMs=Wx.DashManifestUtility.extractLatestAvailableMPDTime(e,this.fetchTime,this.availabilityStartTimeMs),this.earliestAvailableMPDTimeMs=Wx.DashManifestUtility.extractEarliestAvailableMPDTime(e,this.endMs,xt.withDefault(e.timeShiftBufferDepthMs,t))},e.prototype.getSegmentEtaMs=function(e,t){if(!(e+t<this.startMs))return null===this.updatePeriodMs?0:Math.max(0,e+t-this.endMs)},e.prototype.setUpdatePeriod=function(e){this.updatePeriodMs=e},e}();t.DynamicTimeWindow=n});e(Hx);Hx.DynamicTimeWindow;var Gx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("MPDRefresher"),n=function(){function e(e,t,n){var r=this;this.timer=A.timer,this.refresh=function(){r.acquireMPD().then(function(e){if(null!=r.waitDeferred){try{r.validateMPD(e)}catch(e){throw r.refreshIntervalId=r.timer.setTimeout(r.refresh,500),new Fe.CancelError}null==e.minimumUpdatePeriodMs?r.actualUpdatePeriodMs=void 0:r.actualUpdatePeriodMs=Math.max(e.minimumUpdatePeriodMs,r.expectedTimeBehindLiveMs-1e4),r.processMPD(e),r.mpd=e,r.waitDeferred.resolve(),null!=r.actualUpdatePeriodMs?(r.waitDeferred=new Fe.Deferred,r.refreshIntervalId=r.timer.setTimeout(r.refresh,r.actualUpdatePeriodMs)):r.waitDeferred=null}}).catch(function(e){e instanceof Fe.CancelError||i.error("An error occurred while updating the manifest:",e)})},this.validateMPD=function(e){},this.mpd=e,this.acquireMPD=t,this.processMPD=n,this.waitDeferred=null}return Object.defineProperty(e.prototype,"updatePeriodMs",{get:function(){return xt.withDefault(this.actualUpdatePeriodMs,this.mpd.minimumUpdatePeriodMs)},enumerable:!0,configurable:!0}),e.prototype.waitRefresh=function(){return null==this.waitDeferred?Fe.Promise.reject(new Error("Not refreshing the manifest")):this.waitDeferred.promise},e.prototype.start=function(e){if("static"!==this.mpd.type&&null!=this.mpd.minimumUpdatePeriodMs){if(null!=this.refreshIntervalId)throw new Error("Attempted to restart MPD refreshing while already refreshing");this.expectedTimeBehindLiveMs=e,this.actualUpdatePeriodMs=Math.max(this.mpd.minimumUpdatePeriodMs,this.expectedTimeBehindLiveMs-1e4),this.refreshIntervalId=this.timer.setTimeout(this.refresh,this.actualUpdatePeriodMs),this.waitDeferred=new Fe.Deferred}},e.prototype.stop=function(){null!=this.refreshIntervalId&&(this.timer.clearTimeout(this.refreshIntervalId),this.refreshIntervalId=void 0),this.actualUpdatePeriodMs=void 0,null!=this.waitDeferred&&(this.waitDeferred.reject(new Fe.CancelError),this.waitDeferred=null)},e}();t.MPDRefresher=n});e(Gx);Gx.MPDRefresher;var Kx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.durationMs=0,this.earliestAvailableMPDTimeMs=0}return Object.defineProperty(e.prototype,"startMs",{get:function(){return Math.max(this.earliestAvailableMPDTimeMs,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endMs",{get:function(){return this.durationMs},enumerable:!0,configurable:!0}),e.prototype.reset=function(e){this.durationMs=xt.withDefault(e.mediaPresentationDurationMs,1/0),this.earliestAvailableMPDTimeMs=Wx.DashManifestUtility.extractEarliestAvailableMPDTime(e)},e.prototype.getSegmentEtaMs=function(e,t){return 0<=e&&e<this.endMs?0:void 0},e.prototype.setUpdatePeriod=function(e){},e}();t.StaticTimeWindow=n});e(Kx);Kx.StaticTimeWindow;var Qx=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("DashMediaRepresentation"),n=function(){function e(e,t,n,r){var i=this;this.mediaRepresentationFilters=[],this.reset=function(e){i.mpd=e,i.denormalizePeriods(i.mpd.period),i.timeWindow.reset(e),null!=i.mpdRefresher.updatePeriodMs&&i.timeWindow.setUpdatePeriod(i.mpdRefresher.updatePeriodMs),i.updateDashPeriods(i.dashPeriods.contents),i.periodChangedCallback.invoke()},this.dashMediaRepresentationContext=e,this.mpd=t,this.audioTrackMetadata=r,this.mpdRefresher=new Gx.MPDRefresher(t,n,this.reset),"static"===this.mpd.type?this.timeWindow=new Kx.StaticTimeWindow:this.timeWindow=new Hx.DynamicTimeWindow,this.denormalizePeriods(this.mpd.period),this.timeWindow.reset(t),this.dashPeriods={contents:this.updateDashPeriods([]),onChange:function(e){return i.periodChangedCallback.add(e)}},this.periodChangedCallback=new Dt.MulticastCallback}return Object.defineProperty(e.prototype,"periods",{get:function(){return this.dashPeriods},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"durationMs",{get:function(){return xt.withDefault(this.mpd.mediaPresentationDurationMs,1/0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"suggestedPresentationDelayMs",{get:function(){return this.mpd.suggestedPresentationDelayMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updatePeriodMs",{get:function(){return this.mpdRefresher.updatePeriodMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utcMsAtZero",{get:function(){return this.mpd.availabilityStartTimeMs},enumerable:!0,configurable:!0}),e.prototype.start=function(e){this.mpdRefresher.start(e),null!=this.mpdRefresher.updatePeriodMs&&this.timeWindow.setUpdatePeriod(this.mpdRefresher.updatePeriodMs)},e.prototype.stop=function(){this.mpdRefresher.stop()},e.prototype.applyFilters=function(e){this.mediaRepresentationFilters=e;for(var t=0,n=this.dashPeriods.contents;t<n.length;t++){n[t].applyFilters(e)}},e.prototype.denormalizePeriod=function(e,t,n){if(null!=t.startMs&&(e=t.startMs),isNaN(e))throw new Error("Early Available Periods are not supported!");var r=NaN;if(null!=t.durationMs)r=t.durationMs;else if(null!=n){if(null==n.startMs)throw new Error("Unable to determine duration of period "+t.id);r=n.startMs-e}else r=xt.withDefault(this.mpd.mediaPresentationDurationMs,1/0)-e;if(null!=n&&null!=n.startMs){var i=n.startMs-e-r;.1<Math.abs(i)&&(o.warn("Found a "+i+"ms gap between periods "+t.id+" and "+n.id),r=n.startMs-e)}return t.startMs=e,t.durationMs=r,t},e.prototype.denormalizePeriods=function(e){for(var t="static"===this.mpd.type?0:NaN,n=0;n<e.length;n++)this.denormalizePeriod(t,e[n],e[n+1]),t=e[n].startMs+e[n].durationMs},e.prototype.isFiniteMPD=function(){return"static"===this.mpd.type||null==this.mpd.minimumUpdatePeriodMs},e.prototype.updateDashPeriods=function(e){for(var t=0;0!==e.length&&e[t].id!==this.mpd.period[t].id;)e.splice(t,1);if(e.length>this.mpd.period.length)throw new Error("New MediaRepresentation has removed periods from the leading edge!");for(var n=!1;t<e.length&&t<this.mpd.period.length&&e[t].id===this.mpd.period[t].id;){var r=this.isFiniteMPD()&&t===this.mpd.period.length-1;try{e[t].reset(this.mpd,this.mpd.period[t],this.mpd.period[t].durationMs,r)}catch(e){var i=this.mpd.period[t].startMs+this.mpd.period[t].durationMs-this.timeWindow.startMs;if(!(0===t&&i<100))throw e;n=!0}t++}if(t<e.length)throw new Error("New MediaRepresentation has replaced period "+e[t].id+" with "+this.mpd.period[t].id);for(;t<this.mpd.period.length;){r=this.isFiniteMPD()&&t===this.mpd.period.length-1;var o=new qx.DashPeriod(this.dashMediaRepresentationContext,this.mpdRefresher,this.timeWindow,this.mpd,this.mpd.period[t],this.mpd.period[t].startMs,this.mpd.period[t].durationMs,r,this.audioTrackMetadata);e.push(o),0!==this.mediaRepresentationFilters.length&&o.applyFilters(this.mediaRepresentationFilters),t++}return n&&e.splice(0,1),e},e.prototype.toJSON=function(){return F.omit(this,["adaptationSet","dashMediaRepresentationContext","mediaRepresentationFilter","mpd","period","representation"])},e}();t.DashMediaRepresentation=n});e(Qx);Qx.DashMediaRepresentation;var Yx,Jx,$x=function(){function e(){}return e.prototype.onElementStart=function(e,t){this.parseContext=t},e.prototype.onChildElementStart=function(e,t){return null},e.prototype.onChildElementEnd=function(e){},e}(),Zx=function(){function e(e){void 0===e&&(e=[]),this.childHandlers={};for(var t=0,n=e;t<n.length;t++){var r=n[t];this.childHandlers[r.getElementName()]=r}}return e.prototype.addHandler=function(e){var t=e.getElementName();if(null!=this.childHandlers[t])throw new Error("Already have handler: "+t);this.childHandlers[t]=e},e.prototype.removeHandler=function(e){var t=e.getElementName();this.childHandlers[t]===e&&(this.childHandlers[t]=null)},e.prototype.onElementStart=function(e,t){this.parseContext=t},e.prototype.onChildElementStart=function(e,t){var n=this.childHandlers[e];return null!=n?(n.onElementStart(t,this.parseContext),n):null},e.prototype.onChildElementEnd=function(e){},e}();(Jx=Yx||(Yx={}))[Jx.ELEMENT=0]="ELEMENT",Jx[Jx.CLOSE_ELEMENT=1]="CLOSE_ELEMENT",Jx[Jx.COMMENT=2]="COMMENT",Jx[Jx.CDATA=3]="CDATA";var ek="[:A-Z_a-z][:A-Z_a-z.0-9-]*",tk=function(){},nk=function(){function d(){this.nameRegExp=new RegExp("("+ek+")","gm"),this.attributeRegExp=new RegExp("[ \\r\\n\\t]*([:A-Z_a-z][:A-Z_a-z.0-9-]*)[ \\r\\n\\t]*=[ \\r\\n\\t]*[\"']([^\"']*)[\"'][ \\r\\n\\t]*","gm"),this.onText=tk,this.onElementStart=tk,this.onElementEnd=tk,this.onCData=tk,this.onComment=tk}return d.prototype.parse=function(e){for(var t=this,n=null,r="\ufeff"===e.charAt(0)?1:0,i=r,o=r;o<e.length;o++)if(null!==n){if(n===Yx.ELEMENT){if(-1===(l=e.indexOf(d.ELEMENT_SUFFIX,o)))break;var a=null;this.nameRegExp.lastIndex=o;var s=this.nameRegExp.exec(e);null!==s&&(a=s[1],o=this.nameRegExp.lastIndex),null===a&&(a=e.substring(o,l)),a&&(this.onElementStart(a,function(){return t.extractAttributes(e,o,l)}),e[l-1]===d.FORWARD_SLASH&&this.onElementEnd(a)),o=l}else if(n===Yx.CLOSE_ELEMENT){if(-1===(l=e.indexOf(d.ELEMENT_SUFFIX,o)))break;this.onElementEnd(e.substring(o,l)),o=l}else if(n===Yx.CDATA){if(-1===(l=e.indexOf(d.CDATA_SUFFIX,o)))break;this.onCData(function(){return e.substring(o,l)}),o=l+2}else if(n===Yx.COMMENT){var l;if(-1===(l=e.indexOf(d.COMMENT_SUFFIX,o)))break;this.onComment(function(){return e.substring(o,l)}),o=l+2}i=o+1,n=null}else if(e[o]===d.OPEN_BRACKET){0<o-i&&this.onText(function(){return e.substring(i,o)});var u=e[o+1];u===d.FORWARD_SLASH?(n=Yx.CLOSE_ELEMENT,o+=1):u===d.EXCLAMATION_POINT?d.startsWith(e,o+2,d.CDATA_PREFIX)?(n=Yx.CDATA,o+=8):d.startsWith(e,o+2,d.COMMENT_PREFIX)&&(n=Yx.COMMENT,o+=3):n=Yx.ELEMENT}else{var c=e.indexOf(d.OPEN_BRACKET,o);o=0<c?c-1:e.length-1}},d.prototype.extractAttributes=function(e,t,n){var r=e.substring(t,n);t=0,n=r.length;var i={};for(this.attributeRegExp.lastIndex=t;this.attributeRegExp.lastIndex<n;){var o=this.attributeRegExp.exec(r);if(null===o)break;var a=o[1],s=o[2];i[a]=s}return i},d.startsWith=function(e,t,n){return e.startsWith?e.startsWith(n,t):e.substr(t,n.length)===n},d.OPEN_BRACKET="<",d.FORWARD_SLASH="/",d.EXCLAMATION_POINT="!",d.EQUALS="=",d.SPACE=" ",d.TAB="\t",d.NEW_LINE="\n",d.CARRIAGE_RETURN="\r",d.SINGLE_QUOTE="'",d.DOUBLE_QUOTE="\"",d.CDATA_PREFIX="[CDATA[",d.CDATA_SUFFIX="]]>",d.ELEMENT_SUFFIX=">",d.COMMENT_PREFIX="--",d.COMMENT_SUFFIX="--\x3e",d}(),rk={LeafElementHandler:$x,ParentElementHandler:Zx,Parser:function(){function e(e){void 0===e&&(e=new nk);var i=this;this.handlerStack=[],this.result=null,this.onElementStart=function(e,t){var n=i.stackPeek();if(null!=n){var r=n.onChildElementStart(e,t);null!=r&&i.handlerStack.push(r)}else e===i.rootHandler.getElementName()&&(i.rootHandler.onElementStart(t,{}),i.handlerStack.push(i.rootHandler))},this.onElementEnd=function(e){var t=i.stackPeek();if(null!=t&&t.getElementName()===e){var n=i.handlerStack.pop(),r=i.stackPeek();null!=r?r.onChildElementEnd(n):i.result=n.onElementEnd()}},this.onText=function(e){var t=i.stackPeek();null!=t&&null!=t.onText&&t.onText(e)},this.onCData=function(e){var t=i.stackPeek();null!=t&&null!=t.onCData&&t.onCData(e)},this.fastSaxParser=e}return e.prototype.parse=function(e,t){this.rootHandler=e,this.fastSaxParser.onElementStart=this.onElementStart,this.fastSaxParser.onElementEnd=this.onElementEnd,this.fastSaxParser.onText=this.onText,this.fastSaxParser.onCData=this.onCData,this.fastSaxParser.parse(t);var n=this.result;return this.result=null,n},e.prototype.stackPeek=function(){var e=this.handlerStack[this.handlerStack.length-1];return null!=e?e:null},e}(),TextOnlyLeafHandler:function(){function e(e){this.elementName=e}return e.prototype.getElementName=function(){return this.elementName},e.prototype.onElementStart=function(e,t){},e.prototype.onChildElementStart=function(e,t){return null},e.prototype.onChildElementEnd=function(e){},e.prototype.onText=function(e){this.result=e()},e.prototype.onElementEnd=function(){return this.result},e}(),Utilities:function(){function e(){}return e.optionallyCopyNumber=function(e,t,n){"string"==typeof e[n]&&(t[n]=Number(e[n]))},e.optionallyCopyBoolean=function(e,t,n){if("string"==typeof e[n]){var r=e[n].toLowerCase();"true"===r?t[n]=!0:"false"===r&&(t[n]=!1)}},e.optionallyCopyString=function(e,t,n){"string"==typeof e[n]&&(t[n]=e[n])},e}()},ik=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="([0-9]+(?:\\.[0-9]+)?)",r=new RegExp("^P(?:"+n+"D)?(T(?:"+n+"H)?(?:"+n+"M)?(?:"+n+"S)?)?$");t.isoToMillis=function(e){var t=e.match(r);if(null==t||"PT"===t[0]||"T"===t[2])throw new Error("Invalid ISO Duration String "+e+" passed into isoToMillis");return 1e3*(86400*(null!=t[1]?Number(t[1]):0)+3600*(null!=t[3]?Number(t[3]):0)+60*(null!=t[4]?Number(t[4]):0)+(null!=t[5]?Number(t[5]):0))},t.extendedLimitedIso8601TimeFormatToMilliseconds=function(e){var t=e.match(/^(\d{2}):(\d{2}):(\d{2})(?:\.(\d{3}))?$/);if(null===t)throw new Error("Unsupported timestamp: "+e);var n=parseInt(t[1]),r=parseInt(t[2]),i=parseInt(t[3]),o=0;return t[4]&&(o=parseInt(t[4])),o+1e3*(i+60*(r+60*n))}});e(ik);ik.isoToMillis,ik.extendedLimitedIso8601TimeFormatToMilliseconds;var ok=t(function(e,n){Object.defineProperty(n,"__esModule",{value:!0}),function(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}(ik)});e(ok);var ak=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.requiredStringList=function(e,t){if(t in e)return e[t].split(",").map(function(e){return e.trim()});throw new Error("Missing \""+t+"\" attribute!")},e.optionalStringList=function(e,t,n){return t in e?e[t].split(",").map(function(e){return e.trim()}):n},e.optionalDateTime=function(e,t,n){if(t in e){var r=e[t].indexOf("T");return-1!==r&&-1===e[t].indexOf("Z",r)&&-1===e[t].indexOf("-",r)&&-1===e[t].indexOf("+",r)&&(e[t]+="Z"),new Date(e[t]).getTime()}return n},e.requiredISODuration=function(e,t){if(t in e)return ok.isoToMillis(e[t]);throw new Error("Missing \""+t+"\" attribute!")},e.optionalISODuration=function(e,t,n){return t in e?ok.isoToMillis(e[t]):n},e.optionalBoolean=function(e,t,n){return t in e?"true"===e[t]:n},e.requiredNumber=function(e,t){if(t in e)return parseFloat(e[t]);throw new Error("Missing \""+t+"\" attribute!")},e.optionalNumber=function(e,t,n){return t in e?parseFloat(e[t]):n},e.optionalIntOrBoolean=function(e,t,n){return t in e?"true"===e[t]||"false"!==e[t]&&parseInt(e[t]):n},e.optionalNumberOrRange=function(e,t,n){if(t in e){var r=e[t].trim();if(-1!==r.indexOf(" ")){var i=r.split(" ");return{min:parseInt(i[0]),max:parseInt(i[1])}}return parseInt(r)}return n},e.optionalByteRange=function(e,t){if(t in e){var n=e[t].split("-");return{start:parseInt(n[0]),end:2===n.length?parseInt(n[1]):void 0}}},e.extractXLink=function(e){if("xlink:href"in e)return{href:e["xlink:href"],actuate:"onLoad"===e["xlink:actuate"]?"onLoad":"onRequest"}},e}();t.ParseUtils=n});e(ak);ak.ParseUtils;var sk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.baseUrl=null,e}return n(e,r),e.prototype.getElementName=function(){return"BaseURL"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.baseUrl={serviceLocation:n.serviceLocation,byteRangeTemplate:n.byteRange,availabilityTimeOffsetMs:ak.ParseUtils.optionalNumber(n,"availabilityTimeOffset"),availabilityTimeComplete:ak.ParseUtils.optionalBoolean(n,"availabilityTimeComplete"),baseUrl:""}},e.prototype.onText=function(e){this.baseUrl.baseUrl=e()},e.prototype.onElementEnd=function(){return this.baseUrl},e}(rk.LeafElementHandler);t.BaseURLHandler=i});e(sk);sk.BaseURLHandler;var lk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(s){function e(e,t){void 0===t&&(t={});var n=s.call(this,[])||this;return n.descriptor=null,n.handlers=t,n.elementName=e,n}return n(e,s),e.prototype.getElementName=function(){return this.elementName},e.prototype.onElementStart=function(e,t){s.prototype.onElementStart.call(this,e,t);var n=e();this.descriptor={schemeIdUri:n.schemeIdUri,id:n.id,value:n.value};var r=this.descriptor.schemeIdUri.toLowerCase();if(0===r.indexOf("urn:uuid:")&&(this.descriptor.schemeIdUri=r),null!=this.handlers[this.descriptor.schemeIdUri]){this.handlers[this.descriptor.schemeIdUri].processAttributes(this.descriptor,n);for(var i=0,o=this.handlers[this.descriptor.schemeIdUri].childHandlers;i<o.length;i++){var a=o[i];this.addHandler(a)}}},e.prototype.onChildElementEnd=function(e){null!=this.handlers[this.descriptor.schemeIdUri]&&this.handlers[this.descriptor.schemeIdUri].childElementEnd(this.descriptor,e)},e.prototype.onElementEnd=function(){if(null!=this.handlers[this.descriptor.schemeIdUri])for(var e=0,t=this.handlers[this.descriptor.schemeIdUri].childHandlers;e<t.length;e++){var n=t[e];this.removeHandler(n)}return{name:this.elementName,descriptor:this.descriptor}},e}(rk.ParentElementHandler);t.DescriptorHandler=i});e(lk);lk.DescriptorHandler;var uk=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(e){var t=n.call(this)||this;return t.text=null,t.elementName=e,t}return i(e,n),e.prototype.getElementName=function(){return this.elementName},e.prototype.onText=function(e){this.text=e()},e.prototype.onElementEnd=function(){return{name:this.elementName,text:this.text}},e}(rk.LeafElementHandler);t.SimpleElementHandler=n});e(uk);uk.SimpleElementHandler;var ck=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.childHandlers=[new uk.SimpleElementHandler("cenc:pssh")]}return e.prototype.processAttributes=function(e,t){e.defaultKID=t["cenc:default_KID"]},e.prototype.childElementEnd=function(e,t){var n=e;"cenc:pssh"===t.getElementName()&&(null==n.pssh&&(n.pssh=[]),n.pssh.push(t.onElementEnd().text))},e}();t.CencContentProtectionDescriptorHandler=n});e(ck);ck.CencContentProtectionDescriptorHandler;var dk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={"urn:mpeg:dash:mp4protection:2011":new ck.CencContentProtectionDescriptorHandler,"urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":new ck.CencContentProtectionDescriptorHandler,"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":new ck.CencContentProtectionDescriptorHandler};t.ContentProtectionDescriptors=n});e(dk);dk.ContentProtectionDescriptors;var pk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.segmentDurations=null,e.segmentTimeline=null,e}return n(e,r),e.prototype.getElementName=function(){return"EncodedSegmentDurations"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.segmentTimeline={entries:[]},this.segmentDurations={timescale:ak.ParseUtils.requiredNumber(n,"timescale"),segmentTimeline:this.segmentTimeline,segmentURLs:[],indexRangeExact:!1}},e.prototype.onText=function(e){for(var t,n=e(),r=n.length,i=0,o=0;o<r;){var a=this.readNumber(n,o);if(o+=9,null!=t&&t.d===a)t.r++,i+=a;else{var s={type:"S",seq:o,t:i,r:0,d:a};this.segmentTimeline.entries.push(s),i=s.t+(s.r+1)*s.d,t=s}}},e.prototype.onElementEnd=function(){return this.segmentDurations},e.prototype.readNumber=function(e,t){for(var n=0,r=0;r<8;t++,r++)n=n<<4|parseInt(e[t],16);return n},e}(rk.LeafElementHandler);t.EncodedSegmentDurationsHandler=i});e(pk);pk.EncodedSegmentDurationsHandler;var fk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.segmentList=null,e}return n(e,r),e.prototype.getElementName=function(){return"EncodedSegmentList"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.segmentList={segmentURLs:[],duration:ak.ParseUtils.optionalNumber(n,"duration"),timescale:ak.ParseUtils.optionalNumber(n,"timescale"),indexRangeExact:!1}},e.prototype.onText=function(e){var t=this.segmentList.segmentURLs,n=e(),r=n.length,i=0,o=this.readNumber(n,i);i+=17;var a=this.readNumber(n,i);for(i+=17,this.segmentList.initialization={range:{start:o,end:a}};i<r;){var s=this.readNumber(n,i);i+=17;var l=this.readNumber(n,i);i+=17,t.push({mediaRange:{start:s,end:l}})}},e.prototype.onElementEnd=function(){return this.segmentList},e.prototype.readNumber=function(e,t){for(var n=0,r=0;r<16;t++,r++)n=n<<4|parseInt(e[t],16);return n},e}(rk.LeafElementHandler);t.EncodedSegmentListHandler=i});e(fk);fk.EncodedSegmentListHandler;var hk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(e){var t=r.call(this)||this;return t.url=null,t.elementName=e,t}return n(e,r),e.prototype.getElementName=function(){return this.elementName},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.url={sourceUrl:n.sourceURL,range:ak.ParseUtils.optionalByteRange(n,"range")}},e.prototype.onElementEnd=function(){return{name:this.elementName,url:this.url}},e}(rk.LeafElementHandler);t.URLTypeHandler=i});e(hk);hk.URLTypeHandler;var mk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[new hk.URLTypeHandler("Initialization"),new hk.URLTypeHandler("RepresentationIndex")])||this;return e.segmentBase=null,e}return n(e,r),e.prototype.getElementName=function(){return"SegmentBase"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.segmentBase={timescale:ak.ParseUtils.optionalNumber(n,"timescale"),presentationTimeOffset:ak.ParseUtils.optionalNumber(n,"presentationTimeOffset"),timeShiftBufferDepthMs:ak.ParseUtils.optionalISODuration(n,"timeShiftBufferDepth"),indexRange:ak.ParseUtils.optionalByteRange(n,"indexRange"),indexRangeExact:ak.ParseUtils.optionalBoolean(n,"indexRangeExact",!1),availabilityTimeOffsetMs:ak.ParseUtils.optionalNumber(n,"availabilityTimeOffset"),availabilityTimeComplete:ak.ParseUtils.optionalBoolean(n,"availabilityTimeComplete")}},e.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"Initialization":this.segmentBase.initialization=e.onElementEnd().url;break;case"RepresentationIndex":this.segmentBase.representationIndex=e.onElementEnd().url}},e.prototype.onElementEnd=function(){return this.segmentBase},e}(rk.ParentElementHandler);t.SegmentBaseHandler=i});e(mk);mk.SegmentBaseHandler;var yk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.element=null,e.nextT=0,e.nextSeq=0,e}return n(e,r),e.prototype.getElementName=function(){return"Pattern"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.element={type:"Pattern",seq:-1,t:ak.ParseUtils.optionalNumber(n,"t",-1),d:0,r:ak.ParseUtils.optionalNumber(n,"r",0),numSegments:0,S:[]},this.nextSeq=0,this.nextT=0},e.prototype.onChildElementStart=function(e,t){if("S"===e){var n=t(),r={type:"S",seq:this.nextSeq,t:this.nextT,d:ak.ParseUtils.requiredNumber(n,"d"),r:ak.ParseUtils.optionalNumber(n,"r",0)};this.element.S.push(r),this.nextSeq+=r.r+1,this.nextT+=(r.r+1)*r.d}return null},e.prototype.onElementEnd=function(){return this.element.numSegments=this.nextSeq,this.element.d=this.nextT,this.element},e}(rk.LeafElementHandler);t.PatternHandler=i});e(yk);yk.PatternHandler;var gk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){function e(){var e=o.call(this,[new yk.PatternHandler])||this;return e.segmentTimeline=null,e.nextT=0,e.nextSeq=0,e}return n(e,o),e.prototype.getElementName=function(){return"SegmentTimeline"},e.prototype.onElementStart=function(e,t){o.prototype.onElementStart.call(this,e,t),this.segmentTimeline={entries:[]},this.nextT=0,this.nextSeq=0},e.prototype.onChildElementStart=function(e,t){if("S"===e){var n=t(),r=ak.ParseUtils.optionalNumber(n,"t",this.nextT),i={type:"S",seq:this.nextSeq,t:r,d:ak.ParseUtils.requiredNumber(n,"d"),r:ak.ParseUtils.optionalNumber(n,"r",0)};return this.segmentTimeline.entries.push(i),this.nextT=i.t+(i.r+1)*i.d,this.nextSeq+=i.r+1,null}return o.prototype.onChildElementStart.call(this,e,t)},e.prototype.onChildElementEnd=function(e){if("Pattern"===e.getElementName()){var t=e.onElementEnd();-1===t.t&&(t.t=this.nextT),t.seq=this.nextSeq,this.nextT=t.t+t.d*(t.r+1),this.nextSeq+=t.numSegments*(t.r+1),this.segmentTimeline.entries.push(t)}},e.prototype.onElementEnd=function(){return this.segmentTimeline},e}(rk.ParentElementHandler);t.SegmentTimelineHandler=i});e(gk);gk.SegmentTimelineHandler;var vk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[new gk.SegmentTimelineHandler,new hk.URLTypeHandler("BitstreamSwitching"),new hk.URLTypeHandler("Initialization"),new hk.URLTypeHandler("RepresentationIndex")])||this;return e.segmentList=null,e}return n(e,r),e.prototype.getElementName=function(){return"SegmentList"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.segmentList={xlink:ak.ParseUtils.extractXLink(n),segmentURLs:[],duration:ak.ParseUtils.optionalNumber(n,"duration"),startNumber:ak.ParseUtils.optionalNumber(n,"startNumber"),timescale:ak.ParseUtils.optionalNumber(n,"timescale"),presentationTimeOffset:ak.ParseUtils.optionalNumber(n,"presentationTimeOffset"),timeShiftBufferDepthMs:ak.ParseUtils.optionalISODuration(n,"timeShiftBufferDepth"),indexRange:ak.ParseUtils.optionalByteRange(n,"indexRange"),indexRangeExact:ak.ParseUtils.optionalBoolean(n,"indexRangeExact",!1),availabilityTimeOffsetMs:ak.ParseUtils.optionalNumber(n,"availabilityTimeOffset"),availabilityTimeComplete:ak.ParseUtils.optionalBoolean(n,"availabilityTimeComplete")}},e.prototype.onChildElementStart=function(e,t){if("SegmentURL"===e){var n=t();return this.segmentList.segmentURLs.push({media:n.media,mediaRange:ak.ParseUtils.optionalByteRange(n,"mediaRange"),index:n.index,indexRange:ak.ParseUtils.optionalByteRange(n,"indexRange")}),null}return r.prototype.onChildElementStart.call(this,e,t)},e.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"Initialization":this.segmentList.initialization=e.onElementEnd().url;break;case"RepresentationIndex":this.segmentList.representationIndex=e.onElementEnd().url;break;case"BitstreamSwitching":this.segmentList.bitstreamSwitching=e.onElementEnd().url;break;case"SegmentTimeline":this.segmentList.segmentTimeline=e.onElementEnd()}},e.prototype.onElementEnd=function(){return this.segmentList},e}(rk.ParentElementHandler);t.SegmentListHandler=i});e(vk);vk.SegmentListHandler;var Sk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[new gk.SegmentTimelineHandler,new hk.URLTypeHandler("BitstreamSwitching"),new hk.URLTypeHandler("Initialization"),new hk.URLTypeHandler("RepresentationIndex")])||this;return e.segmentTemplate=null,e}return n(e,r),e.prototype.getElementName=function(){return"SegmentTemplate"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.segmentTemplate={mediaTemplate:n.media,indexTemplate:n.index,initializationTemplate:n.initialization,bitstreamSwitchingTemplate:n.bistreamSwitching,duration:ak.ParseUtils.optionalNumber(n,"duration"),startNumber:ak.ParseUtils.optionalNumber(n,"startNumber"),timescale:ak.ParseUtils.optionalNumber(n,"timescale"),presentationTimeOffset:ak.ParseUtils.optionalNumber(n,"presentationTimeOffset"),timeShiftBufferDepthMs:ak.ParseUtils.optionalISODuration(n,"timeShiftBufferDepth"),indexRange:ak.ParseUtils.optionalByteRange(n,"indexRange"),indexRangeExact:ak.ParseUtils.optionalBoolean(n,"indexRangeExact",!1),availabilityTimeOffsetMs:ak.ParseUtils.optionalNumber(n,"availabilityTimeOffset"),availabilityTimeComplete:ak.ParseUtils.optionalBoolean(n,"availabilityTimeComplete")}},e.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"Initialization":this.segmentTemplate.initialization=e.onElementEnd().url;break;case"RepresentationIndex":this.segmentTemplate.representationIndex=e.onElementEnd().url;break;case"BitstreamSwitching":this.segmentTemplate.bitstreamSwitching=e.onElementEnd().url;break;case"SegmentTimeline":this.segmentTemplate.segmentTimeline=e.onElementEnd()}},e.prototype.onElementEnd=function(){return this.segmentTemplate},e}(rk.ParentElementHandler);t.SegmentTemplateHandler=i});e(Sk);Sk.SegmentTemplateHandler;var bk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[new sk.BaseURLHandler,new mk.SegmentBaseHandler,new vk.SegmentListHandler,new Sk.SegmentTemplateHandler,new fk.EncodedSegmentListHandler,new lk.DescriptorHandler("FramePacking"),new lk.DescriptorHandler("AudioChannelConfiguration"),new lk.DescriptorHandler("ContentProtection",dk.ContentProtectionDescriptors),new lk.DescriptorHandler("EssentialProperty"),new lk.DescriptorHandler("SupplementalProperty"),new lk.DescriptorHandler("InbandEventStream")])||this;return e.representation=null,e}return n(e,r),e.prototype.getElementName=function(){return"Representation"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.representation={id:n.id,bandwidth:ak.ParseUtils.requiredNumber(n,"bandwidth"),qualityRanking:ak.ParseUtils.optionalNumber(n,"qualityRanking"),dependencyId:ak.ParseUtils.optionalStringList(n,"dependencyId"),mediaStreamStructureId:ak.ParseUtils.optionalStringList(n,"mediaStreamStructureId"),profiles:ak.ParseUtils.optionalStringList(n,"profiles",[]),width:ak.ParseUtils.optionalNumber(n,"width"),height:ak.ParseUtils.optionalNumber(n,"height"),sar:n.sar,frameRate:n.frameRate,audioSamplingRate:ak.ParseUtils.optionalNumberOrRange(n,"audioSamplingRate"),mimeType:n.mimeType,segmentProfiles:ak.ParseUtils.optionalStringList(n,"segmentProfiles"),codecs:ak.ParseUtils.optionalStringList(n,"codecs"),maximumSAPPeriod:ak.ParseUtils.optionalNumber(n,"maximumSAPPeriod"),startWithSAP:ak.ParseUtils.optionalNumber(n,"startWithSAP"),maxPlayoutRate:ak.ParseUtils.optionalNumber(n,"maxPlayoutRate"),codingDependency:ak.ParseUtils.optionalBoolean(n,"codingDependency"),scanType:n.scanType}},e.prototype.onChildElementEnd=function(e){var t=this.representation;switch(e.getElementName()){case"BaseURL":null==t.baseUrl&&(t.baseUrl=[]),t.baseUrl.push(e.onElementEnd());break;case"FramePacking":null==t.framePacking&&(t.framePacking=[]),t.framePacking.push(e.onElementEnd().descriptor);break;case"AudioChannelConfiguration":null==t.audioChannelConfiguration&&(t.audioChannelConfiguration=[]),t.audioChannelConfiguration.push(e.onElementEnd().descriptor);break;case"ContentProtection":null==t.contentProtection&&(t.contentProtection=[]),t.contentProtection.push(e.onElementEnd().descriptor);break;case"EssentialProperty":null==t.essentialProperty&&(t.essentialProperty=[]),t.essentialProperty.push(e.onElementEnd().descriptor);break;case"SupplementalProperty":null==t.supplementalProperty&&(t.supplementalProperty=[]),t.supplementalProperty.push(e.onElementEnd().descriptor);break;case"InbandEventStream":null==t.inbandEventStream&&(t.inbandEventStream=[]),t.inbandEventStream.push(e.onElementEnd().descriptor);break;case"SegmentBase":t.segmentBase=e.onElementEnd();break;case"SegmentTemplate":t.segmentTemplate=e.onElementEnd();break;case"EncodedSegmentList":case"SegmentList":t.segmentList=e.onElementEnd()}},e.prototype.onElementEnd=function(){return this.representation},e}(rk.ParentElementHandler);t.RepresentationHandler=i});e(bk);bk.RepresentationHandler;var Tk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[])||this;return e.segmentDurations=null,e.segmentTimeline=null,e.nextT=0,e.nextSeq=0,e}return n(e,r),e.prototype.getElementName=function(){return"SegmentDurations"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.segmentTimeline={entries:[]},this.segmentDurations={timescale:ak.ParseUtils.requiredNumber(n,"timescale"),segmentTimeline:this.segmentTimeline,segmentURLs:[],indexRangeExact:!1},this.nextT=0,this.nextSeq=0},e.prototype.onChildElementStart=function(e,t){if("S"===e){var n=t(),r=ak.ParseUtils.requiredNumber(n,"d"),i=this.segmentTimeline.entries[this.segmentTimeline.entries.length-1];if(null!=i&&i.d===r)i.r++,this.nextT+=r;else{var o={type:"S",seq:this.nextSeq,t:this.nextT,r:0,d:r};this.segmentTimeline.entries.push(o),this.nextT=o.t+(o.r+1)*o.d}this.nextSeq++}return null},e.prototype.onElementEnd=function(){return this.segmentDurations},e}(rk.ParentElementHandler);t.SegmentDurationsHandler=i});e(Tk);Tk.SegmentDurationsHandler;var Pk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[new lk.DescriptorHandler("Accessibility"),new lk.DescriptorHandler("Role"),new lk.DescriptorHandler("Rating"),new lk.DescriptorHandler("Viewpoint"),new sk.BaseURLHandler,new mk.SegmentBaseHandler,new vk.SegmentListHandler,new Sk.SegmentTemplateHandler,new Tk.SegmentDurationsHandler,new pk.EncodedSegmentDurationsHandler,new bk.RepresentationHandler,new lk.DescriptorHandler("FramePacking"),new lk.DescriptorHandler("AudioChannelConfiguration"),new lk.DescriptorHandler("ContentProtection",dk.ContentProtectionDescriptors),new lk.DescriptorHandler("EssentialProperty"),new lk.DescriptorHandler("SupplementalProperty"),new lk.DescriptorHandler("InbandEventStream")])||this;return e.adaptationSet=null,e}return n(e,r),e.prototype.getElementName=function(){return"AdaptationSet"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.adaptationSet={xlink:ak.ParseUtils.extractXLink(n),id:ak.ParseUtils.optionalNumber(n,"id"),audioTrackId:n.audioTrackId,group:ak.ParseUtils.optionalNumber(n,"group"),lang:n.lang,contentType:n.contentType,par:n.par,minBandwidth:ak.ParseUtils.optionalNumber(n,"minBandwidth"),maxBandwidth:ak.ParseUtils.optionalNumber(n,"maxBandwidth"),minWidth:ak.ParseUtils.optionalNumber(n,"minWidth"),maxWidth:ak.ParseUtils.optionalNumber(n,"maxWidth"),minHeight:ak.ParseUtils.optionalNumber(n,"minHeight"),maxHeight:ak.ParseUtils.optionalNumber(n,"maxHeight"),minFramerate:n.minFramerate,maxFramerate:n.maxFramerate,segmentAlignment:ak.ParseUtils.optionalIntOrBoolean(n,"segmentAlignment",!1),bitstreamSwitching:ak.ParseUtils.optionalBoolean(n,"bitstreamSwitching"),subsegmentAlignment:ak.ParseUtils.optionalIntOrBoolean(n,"subsegmentAlignment",!1),subsegmentStartsWithSAP:ak.ParseUtils.optionalNumber(n,"subsegmentStartsWithSAP",0),representation:[],profiles:ak.ParseUtils.optionalStringList(n,"profiles",[]),width:ak.ParseUtils.optionalNumber(n,"width"),height:ak.ParseUtils.optionalNumber(n,"height"),sar:n.sar,frameRate:n.frameRate,audioSamplingRate:ak.ParseUtils.optionalNumberOrRange(n,"audioSamplingRate"),mimeType:n.mimeType,segmentProfiles:ak.ParseUtils.optionalStringList(n,"segmentProfiles"),codecs:ak.ParseUtils.optionalStringList(n,"codecs"),maximumSAPPeriod:ak.ParseUtils.optionalNumber(n,"maximumSAPPeriod"),startWithSAP:ak.ParseUtils.optionalNumber(n,"startWithSAP"),maxPlayoutRate:ak.ParseUtils.optionalNumber(n,"maxPlayoutRate"),codingDependency:ak.ParseUtils.optionalBoolean(n,"codingDependency"),scanType:n.scanType}},e.prototype.onChildElementEnd=function(e){var t=this.adaptationSet;switch(e.getElementName()){case"BaseURL":null==t.baseUrl&&(t.baseUrl=[]),t.baseUrl.push(e.onElementEnd());break;case"Accessibility":null==t.accessibility&&(t.accessibility=[]),t.accessibility.push(e.onElementEnd().descriptor);break;case"Role":null==t.role&&(t.role=[]),t.role.push(e.onElementEnd().descriptor);break;case"Rating":null==t.rating&&(t.rating=[]),t.rating.push(e.onElementEnd().descriptor);break;case"Viewpoint":null==t.viewpoint&&(t.viewpoint=[]),t.viewpoint.push(e.onElementEnd().descriptor);break;case"FramePacking":null==t.framePacking&&(t.framePacking=[]),t.framePacking.push(e.onElementEnd().descriptor);break;case"AudioChannelConfiguration":null==t.audioChannelConfiguration&&(t.audioChannelConfiguration=[]),t.audioChannelConfiguration.push(e.onElementEnd().descriptor);break;case"ContentProtection":null==t.contentProtection&&(t.contentProtection=[]),t.contentProtection.push(e.onElementEnd().descriptor);break;case"EssentialProperty":null==t.essentialProperty&&(t.essentialProperty=[]),t.essentialProperty.push(e.onElementEnd().descriptor);break;case"SupplementalProperty":null==t.supplementalProperty&&(t.supplementalProperty=[]),t.supplementalProperty.push(e.onElementEnd().descriptor);break;case"InbandEventStream":null==t.inbandEventStream&&(t.inbandEventStream=[]),t.inbandEventStream.push(e.onElementEnd().descriptor);break;case"SegmentBase":t.segmentBase=e.onElementEnd();break;case"SegmentList":case"SegmentDurations":case"EncodedSegmentDurations":t.segmentList=e.onElementEnd();break;case"SegmentTemplate":t.segmentTemplate=e.onElementEnd();break;case"Representation":t.representation.push(e.onElementEnd())}},e.prototype.onElementEnd=function(){return this.adaptationSet},e}(rk.ParentElementHandler);t.AdaptationSetHandler=i});e(Pk);Pk.AdaptationSetHandler;var wk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[new sk.BaseURLHandler,new mk.SegmentBaseHandler,new vk.SegmentListHandler,new Sk.SegmentTemplateHandler,new lk.DescriptorHandler("AssetIdentifier"),new lk.DescriptorHandler("SupplementalProperty"),new Pk.AdaptationSetHandler])||this;return e.period=null,e}return n(e,r),e.prototype.getElementName=function(){return"Period"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.period={xlink:ak.ParseUtils.extractXLink(n),id:n.id,startMs:ak.ParseUtils.optionalISODuration(n,"start"),durationMs:ak.ParseUtils.optionalISODuration(n,"duration"),bitstreamSwitching:ak.ParseUtils.optionalBoolean(n,"bitstreamSwitching",!1),adaptationSet:[]}},e.prototype.onChildElementEnd=function(e){var t=this.period;switch(e.getElementName()){case"AdaptationSet":t.adaptationSet.push(e.onElementEnd());break;case"BaseURL":null==t.baseUrl&&(t.baseUrl=[]),t.baseUrl.push(e.onElementEnd());break;case"SegmentBase":t.segmentBase=e.onElementEnd();break;case"SegmentList":t.segmentList=e.onElementEnd();break;case"SegmentTemplate":t.segmentTemplate=e.onElementEnd();break;case"AssetIdentifier":t.assetIdentifier=e.onElementEnd().descriptor;break;case"SupplementalProperty":null==t.supplementalProperty&&(t.supplementalProperty=[]),t.supplementalProperty.push(e.onElementEnd().descriptor)}},e.prototype.onElementEnd=function(){return this.period},e}(rk.ParentElementHandler);t.PeriodHandler=i});e(wk);wk.PeriodHandler;var Ck=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[new uk.SimpleElementHandler("Title"),new uk.SimpleElementHandler("Source"),new uk.SimpleElementHandler("Copyright")])||this;return e.programInformation=null,e}return n(e,r),e.prototype.getElementName=function(){return"ProgramInformation"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.programInformation={lang:n.lang,moreInformationUrl:n.moreInformationURL}},e.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"Title":this.programInformation.title=e.onElementEnd().text;break;case"Source":this.programInformation.source=e.onElementEnd().text;break;case"Copyright":this.programInformation.copyright=e.onElementEnd().text}},e.prototype.onElementEnd=function(){return this.programInformation},e}(rk.ParentElementHandler);t.ProgramInformationHandler=i});e(Ck);Ck.ProgramInformationHandler;var Mk=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=r.call(this,[new Ck.ProgramInformationHandler,new sk.BaseURLHandler,new uk.SimpleElementHandler("Location"),new wk.PeriodHandler,new lk.DescriptorHandler("UTCTiming")])||this;return e.mpd=null,e}return n(e,r),e.prototype.getElementName=function(){return"MPD"},e.prototype.onElementStart=function(e,t){r.prototype.onElementStart.call(this,e,t);var n=e();this.mpd={id:n.id,profiles:ak.ParseUtils.requiredStringList(n,"profiles"),type:xt.withDefault(n.type,"static"),availabilityStartTimeMs:ak.ParseUtils.optionalDateTime(n,"availabilityStartTime"),availabilityEndTimeMs:ak.ParseUtils.optionalDateTime(n,"availabilityEndTime"),publishTimeMs:ak.ParseUtils.optionalDateTime(n,"publishTime"),mediaPresentationDurationMs:ak.ParseUtils.optionalISODuration(n,"mediaPresentationDuration"),minimumUpdatePeriodMs:ak.ParseUtils.optionalISODuration(n,"minimumUpdatePeriod"),minBufferTimeMs:ak.ParseUtils.requiredISODuration(n,"minBufferTime"),timeShiftBufferDepthMs:ak.ParseUtils.optionalISODuration(n,"timeShiftBufferDepth"),suggestedPresentationDelayMs:ak.ParseUtils.optionalISODuration(n,"suggestedPresentationDelay"),maxSegmentDurationMs:ak.ParseUtils.optionalISODuration(n,"maxSegmentDuration"),maxSubsegmentDurationMs:ak.ParseUtils.optionalISODuration(n,"maxSubsegmentDuration"),period:[]}},e.prototype.onChildElementEnd=function(e){var t=this.mpd;switch(e.getElementName()){case"BaseURL":null==t.baseUrl&&(t.baseUrl=[]),t.baseUrl.push(e.onElementEnd());break;case"Period":t.period.push(e.onElementEnd());break;case"ProgramInformation":null==t.programInformation&&(t.programInformation=[]),t.programInformation.push(e.onElementEnd());break;case"UTCTiming":null==t.utcTiming&&(t.utcTiming=[]),t.utcTiming.push(e.onElementEnd().descriptor)}},e.prototype.onElementEnd=function(){return this.mpd},e}(rk.ParentElementHandler);t.MPDElementHandler=i});e(Mk);Mk.MPDElementHandler;var Ik=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.xmlParser=new rk.Parser,this.mpdHandler=new Mk.MPDElementHandler}return e.prototype.parse=function(e){var t=this;return Fe.Promise.resolve().then(function(){return t.xmlParser.parse(t.mpdHandler,e)})},e}();t.DashParser=n});e(Ik);Ik.DashParser;var Ek=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DashParser=Ik.DashParser});e(Ek);Ek.DashParser;var _k=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.refreshImpl=e,this.changeCallback=new Dt.MulticastCallback}return Object.defineProperty(e.prototype,"valid",{get:function(){return null!=this.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contents",{get:function(){if(null==this.value)throw new Error("Attempted to read contents of a stale element!");return this.value},enumerable:!0,configurable:!0}),e.prototype.onChange=function(e){this.changeCallback.add(e)},e.prototype.offChange=function(e){this.changeCallback.remove(e)},e.prototype.refresh=function(){return this.refreshImpl()},e.prototype.setValue=function(e){this.value=e,this.changeCallback.invoke()},e.prototype.clear=function(){delete this.value},e}();t.DynamicElementImpl=n});e(_k);_k.DynamicElementImpl;var xk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createManifestKey=function(e){return"manifest_"+e}});e(xk);xk.createManifestKey;var kk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("DashMediaRepresentationSource"),l="manifest.acquisition",n=function(){function e(e,t,n,r,i){void 0===n&&(n=null),void 0===r&&(r=0),void 0===i&&(i=null);var o=this;this.manifestStorageKey=null,this.eventEmitter=new Dt.EventEmitter,this.manifestParser=new Ek.DashParser,this.timer=A.timer,this.shouldReadStorage=!1,this.shouldWriteStorage=!1,this.doRefresh=function(){var e=Fe.CancelToken.source(),t=e.token,n=e.cancel;return o.cancel=n,o.eventEmitter.emit("start"),o.promise=o.acquire(t),o.promise},this.refreshAndUpdateMpd=function(){if(null==o.acquireMpdPromise){var e=Fe.CancelToken.source(),t=e.token,n=e.cancel;o.cancelMpdPromise=n,o.acquireMpdPromise=o.acquireAndParseMpd(t)}return o.acquireMpdPromise},this.acquireAndParseMpd=function(t){var n={};return o.acquireManifest(t,n).then(function(e){return t.throwIfRequested(),delete o.acquireMpdPromise,o.eventEmitter.emit("complete",o.holder.contents),e}).catch(function(e){if(delete o.acquireMpdPromise,t.throwIfRequested(),MT.metrics.putMetric("Manifest.DASH.Error"),e instanceof lh.AcquisitionError&&"UnknownError"!==e.reason.type){if(o.shouldRetryAcquisition(e,n.sourceUrl))return Px.delay(500,t).then(function(){return t.throwIfRequested(),o.acquireAndParseMpd(t)});throw o.internalStop(),new Fe.CancelError}throw o.internalStop(),Ne.XpError.generatePrefixedError(e,l)})},this.audioTrackMetadata=n,this.resourceAcquirer=e,this.holder=new _k.DynamicElementImpl(this.doRefresh),this.storageContext={downloadOperationId:i,storageAccess:r},this.manifestStorageKey=null!=i?xk.createManifestKey(i):null;var a=xI.localStorage.capabilities.isSupported;this.shouldReadStorage=1==(1&r)&&a,this.shouldWriteStorage=2==(2&r)&&a,s.info("Local storage supported:",a),this.queryParams=null!=t?{encoding:t}:{},this.queryParams.amznDtid=Yh.deviceInformation.hardware.deviceTypeId,this.lastParseStatus="Healthy"}return e.delete=function(e){return xI.localStorage.remove(xk.createManifestKey(e))},e.prototype.prepare=function(e,t){this.timeoutMs=t,this.sourceUrlStore=e},e.prototype.stop=function(){this.internalStop(),delete this.sourceUrlStore,this.lastParseStatus="Healthy"},Object.defineProperty(e.prototype,"mediaRepresentation",{get:function(){return this.holder},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.acquire=function(t){var n=this,r={};return this.acquireManifest(t,r).then(function(e){return t.throwIfRequested(),n.createMediaRepresentation(e)}).then(function(e){return t.throwIfRequested(),n.eventEmitter.emit("complete",e),n.holder.setValue(e),e}).catch(function(e){if(t.throwIfRequested(),MT.metrics.putMetric("Manifest.DASH.Error"),e instanceof lh.AcquisitionError&&"UnknownError"!==e.reason.type){if(n.shouldRetryAcquisition(e,r.sourceUrl))return Px.delay(500,t).then(function(){return t.throwIfRequested(),n.acquire(t)});throw n.internalStop(),new Fe.CancelError}throw n.internalStop(),Ne.XpError.generatePrefixedError(e,l)})},e.prototype.acquireManifest=function(i,t){var n=this;if(null==this.timeoutMs||i.requested)return Fe.Promise.reject(new Error("Attempting to acquire manifest on stopped acquirer"));var e=Fe.Promise.resolve(null);return this.shouldReadStorage&&(e=this.tryRetrieveManifestTextFromStorage(i).then(function(e){if(i.throwIfRequested(),null==e)return null;var t=Date.now(),n=JSON.parse(e),r=Date.now()-t;return MT.metrics.putMetric("Manifest.DASH.Parse.Storage.Time",r,"ms"),n}).catch(function(e){return i.throwIfRequested(),s.error("An error happened when parsing manifest from storage: "+e),MT.metrics.putMetric("Manifest.DASH.Storage.Read.Error"),null})),e.then(function(e){return i.throwIfRequested(),null!=e?Fe.Promise.resolve(e):n.makeManifestRequest(i,t).then(function(e){return i.throwIfRequested(),n.parseToMpd(e.body,i)})})},e.prototype.createMediaRepresentation=function(e){var t=xt.withDefault(this.audioTrackMetadata,{}),n={resourceAcquirer:this.resourceAcquirer,sourceUrlStore:this.sourceUrlStore,storageContext:this.storageContext};return new Qx.DashMediaRepresentation(n,e,this.refreshAndUpdateMpd,t)},e.prototype.makeManifestRequest=function(t,e){var n=this;if(null==this.sourceUrlStore||null==this.timeoutMs||t.requested)return Fe.Promise.reject(new Error("Attempting to acquire manifest on stopped acquirer"));var r=this.sourceUrlStore.get();e.sourceUrl=r,this.eventEmitter.emit("downloadStart",r);return this.resourceAcquirer.acquire("text",r,this.timeoutMs,0,t,this.queryParams,"manifest.dash").then(function(e){if(t.throwIfRequested(),n.sourceUrlStore.resourceAcquired(e),F.isEmpty(e.body))throw new lh.AcquisitionError({type:"ParseError",cause:new Error("Response body is empty!")});return n.eventEmitter.emit("downloadComplete",F.omit(e,"body")),MT.metrics.putMetric("Manifest.DASH.Download.TransferTime",e.timing.downloadMs,"ms"),MT.metrics.putMetric("Manifest.DASH.Download.Latency",e.timing.latencyMs,"ms"),null!=e.totalBytes&&MT.metrics.putMetric("Manifest.DASH.Download.Throughput",8*e.totalBytes/e.timing.totalMs*1e3),e}).catch(function(e){throw t.throwIfRequested(),s.error("An error happened when acquiring manifest: "+e),e instanceof lh.AcquisitionError&&n.eventEmitter.emit("failure",{sourceUrl:r,error:e}),e})},e.prototype.tryUpdateAudioTrackLanguages=function(e){var t=xt.withDefault(this.audioTrackMetadata,{}),n=null;1===Object.keys(t).length&&(n=t[Object.keys(t)[0]].languageCode);for(var r=0,i=e.period;r<i.length;r++)for(var o=0,a=i[r].adaptationSet;o<a.length;o++){var s=a[o];if("Audio"===Bx.DashStream.getStreamType(s)){var l=s.lang;null!=s.audioTrackId&&null!=t[s.audioTrackId]?l=t[s.audioTrackId].languageCode:null!==n&&(l=n),null!=l&&(s.lang=l.toLowerCase())}}},e.prototype.parseToMpd=function(e,n){var r=this,i=Date.now();return this.manifestParser.parse(e).then(function(e){n.throwIfRequested();var t=Date.now()-i;return MT.metrics.putMetric("Manifest.DASH.Parse.Time",t,"ms"),r.lastParseStatus="Healthy",r.tryUpdateAudioTrackLanguages(e),"static"!==e.type&&(r.shouldReadStorage=!1,r.shouldWriteStorage=!1),(r.shouldWriteStorage?r.storeMPDTextToStorage(JSON.stringify(e)):Fe.Promise.resolve()).then(function(){return e})}).catch(function(e){if(e instanceof Fe.CancelError)throw e;throw MT.metrics.putMetric("Manifest.DASH.Parse.Error"),new lh.AcquisitionError({type:"ParseError",cause:e})})},e.prototype.shouldRetryAcquisition=function(e,t){if("ParseError"===e.reason.type){if("ParseError"===this.lastParseStatus)return this.lastParseStatus="SourceError",this.sourceUrlStore.resourceAcquisitionFailed({type:"SourceError",cause:e},c_.AcquisitionResourceType.Manifest,t.urlId);if("SourceError"===this.lastParseStatus)throw Ne.XpError.generatePrefixedError(e,l);return this.lastParseStatus="ParseError",this.sourceUrlStore.resourceAcquisitionFailed(e.reason,c_.AcquisitionResourceType.Manifest,t.urlId)}return this.sourceUrlStore.resourceAcquisitionFailed(e.reason,c_.AcquisitionResourceType.Manifest,t.urlId)},e.prototype.tryRetrieveManifestTextFromStorage=function(t){var n=this;return null==this.storageContext.downloadOperationId||null==this.manifestStorageKey?(s.info("No valid download operation id found for manifest retrieval, ignore"),Fe.Promise.resolve(null)):xI.localStorage.getText(this.manifestStorageKey).then(function(e){return t.throwIfRequested(),s.info("Retrieving manifest "+n.storageContext.downloadOperationId+" from local storage completed. Result exists: "+(null!=e)),e}).catch(function(e){return s.warn("Fail to read manifest "+n.storageContext.downloadOperationId+" from storage. Ignore. Error:",e),null})},e.prototype.storeMPDTextToStorage=function(e){var t=this;return null==this.storageContext.downloadOperationId||null==this.manifestStorageKey?(s.warn("Manifest is expected to be persistent, but there is no valid download operation id"),Fe.Promise.resolve()):xI.localStorage.put(this.manifestStorageKey,e).catch(function(e){throw s.error("Fail to store manifest "+t.storageContext.downloadOperationId+". Error:",e),MT.metrics.putMetric("Manifest.DASH.Download.Storage.Write.Error"),e})},e.prototype.internalStop=function(){null!=this.cancel&&this.cancel(),this.holder.clear(),delete this.promise,delete this.cancel,delete this.timeoutMs},e}();t.DashMediaRepresentationSource=n});e(kk);kk.DashMediaRepresentationSource;var Rk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DashMediaRepresentation=Qx.DashMediaRepresentation,t.DashMediaRepresentationSource=kk.DashMediaRepresentationSource,t.createManifestKey=xk.createManifestKey});e(Rk);Rk.DashMediaRepresentation,Rk.DashMediaRepresentationSource,Rk.createManifestKey;var Ak=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("PlayReadyLicenseTransformer"),n=function(){function t(){}return t.transform=function(e){return{cdmLicenseData:tb.decode(e.encodedLicenseResponse),keyMetadata:t.createPlayReadyKeyMetadata(e.metadata.licenses)}},t.createPlayReadyKeyMetadata=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n],o=void 0;if(null!=i.outputProtection){var a=i.outputProtection.uncompressedDigitalVideoOpl;a<=250||251<=a&&a<=270&&(o={hdcp:"HDCP_V1",hdcpEnforcementResolutionPixels:52e4})}var s=o=void 0;null!=i.rightsWindow&&(s={startTimeMs:Date.parse(i.rightsWindow.startTime),endTimeMs:Date.parse(i.rightsWindow.endTime)},(isNaN(s.startTimeMs)||isNaN(s.endTimeMs))&&u.warn("Received non standard ISO 8601 timestamp in rights window:",JSON.stringify(i.rightsWindow)));var l=void 0;if(null!=i.consumptionDuration)try{l=ok.isoToMillis(i.consumptionDuration)}catch(e){u.warn("Received non standard ISO 8601 duration as consumption duration:",i.consumptionDuration)}t.push({id:i.keyId?i.keyId:"",keyType:"CONTENT",hdcp:o,rightsWindow:s,consumptionDurationMs:l})}return t},t}();t.PlayReadyLicenseTransformer=n});e(Ak);Ak.PlayReadyLicenseTransformer;var Ok=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("LicenseAcquirer"),n=function(){function e(e,t){this.prsClient=e,this.requestBuilder=t,this.eventEmitter=new Dt.EventEmitter}return e.prototype.acquireLicense=function(e,t,n){if(-1!==e.indexOf("widevine"))return this.acquireWVLicense(t,n);if(-1!==e.indexOf("playready"))return this.acquirePRLicense(t,n);var r="Unexpected key system \""+e+"\"";return o.error(r),Fe.Promise.reject(new Ne.XpError("drm.unexpected_key_system",void 0,r))},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.acquireWVLicense=function(e,t){var n=this.requestBuilder.clone().resource(ux.PlaybackResource.Widevine2License(tb.encode(e),!0)).build("ImmediateConsumption");return this.triggerRequest(n,t).then(function(e){if(null==e.widevine2License){var t=e.errorsByResource;if(null!=t&&null!=t.Widevine2License){if("SD"===e.returnedTitleRendition.videoQuality&&"prs.hd_content_not_allowed"===t.Widevine2License.code)throw new Ne.XpError("prs.invalid_hd_content_downgrade",void 0,"Widevine2License request error: service returned hd not allowed error even when sd asset was requested");throw t.Widevine2License}throw new Ne.XpError("prs.absent_resource",void 0,"Widevine2License request error without errorsByResource")}var n=e.widevine2License;return{cdmLicenseData:tb.decode(n.license),keyMetadata:n.metadata.keyMetadata}}).catch(function(e){throw MT.metrics.putMetric("ServiceRequest.PRS.License.Error"),Ne.XpError.generatePrefixedError(e,"license")})},e.prototype.acquirePRLicense=function(e,t){var n=null;if(e.byteLength%2==0){var r=String.fromCharCode.apply(null,new Uint16Array(e.buffer));if(-1!==r.indexOf("PlayReadyKeyMessage")){var i=r.indexOf("<Challenge"),o=r.indexOf(">",i),a=r.indexOf("</Challenge");n=r.substring(o+1,a),this.validatePRClientTime(n,!0)}}null===n&&(this.validatePRClientTime(e,!1),n=tb.encode(e));var s=this.requestBuilder.clone().resource(ux.PlaybackResource.PlayReadyLicense(n)).build("ImmediateConsumption");return this.triggerRequest(s,t).then(function(e){if(null==e.playReadyLicense){var t=e.errorsByResource;throw null!=t&&null!=t.PlayReadyLicense?t.PlayReadyLicense:new Ne.XpError("prs.absent_resource",void 0,"PlayReadyLicense request error without errorsByResource")}return Ak.PlayReadyLicenseTransformer.transform(e.playReadyLicense)}).catch(function(e){throw MT.metrics.putMetric("ServiceRequest.PRS.License.Error"),Ne.XpError.generatePrefixedError(e,"license")})},e.prototype.validatePRClientTime=function(e,t){try{var n=void 0;n=t?tb.decode(e):e;var r=String.fromCharCode.apply(null,n).match(/<clienttime>([0-9]*)<\/clienttime>/i);if(null!=r){var i=1e3*parseInt(r[1]);864e5<Math.abs(i-Date.now())&&o.error("Clock skew detected between clienttime in PlayReady challenge and local clock! Challenge clientTime=["+new Date(i)+"] and local time=["+new Date+"]")}else o.info("No clienttime found on PlayReady challenge")}catch(e){o.warn("Failed to extract clienttime from PlayReady challenge!")}},e.prototype.triggerRequest=function(e,t){var n=this;return this.prsClient.send(e,t).then(function(e){return e.on("latency",function(e){MT.metrics.putMetric("ServiceRequest.PRS.License.RequestLatencyTime",e,"ms")}),e.on("success",function(e){n.eventEmitter.emit("licenseAcquired",e)}),e.on("fail",function(e){n.eventEmitter.emit("licenseAcquisitionFailed",e)}),e.response()})},e}();t.LicenseAcquirer=n});e(Ok);Ok.LicenseAcquirer;var Lk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={video:{"avc1.4D4016":"H264","hev1.1.6.L63.90":"H265"},audio:{"mp4a.40.2":"AAC","ac-3":"AC3","ec-3":"EC3"}};t.playerAttributesCodecs=n});e(Lk);Lk.playerAttributesCodecs;var Fk=t(function(e,t){var o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i={video:{contentType:"video/mp4; codecs=",width:90,height:160,bitrate:1e5,framerate:"24"}},a={audio:{contentType:"audio/mp4; codecs=",channels:"2.0",bitrate:1e5,samplerate:44100}},n=function(){function r(){}return r.querySupportedCodecs=function(){var t={},e=r.queryMediaTypeCodecs(Object.keys(Lk.playerAttributesCodecs.video),i,"video").then(function(e){F.isEmpty(e)||(t.supportedVideoCodecs=e.map(function(e){return Lk.playerAttributesCodecs.video[e]}))}),n=r.queryMediaTypeCodecs(Object.keys(Lk.playerAttributesCodecs.audio),a,"audio").then(function(e){F.isEmpty(e)||(t.supportedAudioCodecs=e.map(function(e){return Lk.playerAttributesCodecs.audio[e]}))});return Fe.Promise.all([e,n]).then(function(){return t})},r.queryMediaTypeCodecs=function(e,r,i){var t=e.map(function(e){var t,n=((t={})[i]=o({},r[i],{contentType:r[i].contentType+"\""+e+"\""}),t);return hE.mediaCapabilities.decodingInfo(n)});return Fe.Promise.all(t).then(function(n){return e.filter(function(e,t){return n[t]})})},r}();t.CodecsQuerier=n});e(Fk);Fk.CodecsQuerier;var Dk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.AVC_CODEC_LADDER={codecStrings:["avc1.640034","avc1.640033","avc1.64002A","avc1.64001F","avc1.64001E","avc1.640016"],codecLevels:[5.2,5.1,4.2,3.1,3,2.2]}});e(Dk);Dk.AVC_CODEC_LADDER;var Nk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.DVHE_CODEC_LADDER={codecStrings:["dvhe.05.08","dvhe.05.06","dvhe.05.05","dvhe.05.01","dvhe.05.01","dvhe.05.01"],codecLevels:[8,6,5,1,1,1]}});e(Nk);Nk.DVHE_CODEC_LADDER;var Uk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.HEVC_MAIN_CODEC_LADDER={codecStrings:["hev1.1.6.L153.90","hev1.1.6.L150.90","hev1.1.6.L120.90","hev1.1.6.L93.90","hev1.1.6.L90.90","hev1.1.6.L63.90"],codecLevels:[5.1,5,4,3.1,3,2.1]}});e(Uk);Uk.HEVC_MAIN_CODEC_LADDER;var Bk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.HEVC_MAIN_10_CODEC_LADDER={codecStrings:["hev1.2.4.L153.90","hev1.2.4.L150.90","hev1.2.4.L120.90","hev1.2.4.L93.90","hev1.2.4.L90.90","hev1.2.4.L63.90"],codecLevels:[5.1,5,4,3.1,3,2.1]}});e(Bk);Bk.HEVC_MAIN_10_CODEC_LADDER;var Vk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={codecStrings:[],codecLevels:[]},r={H264:{sdr:Dk.AVC_CODEC_LADDER,hdr:{HDR10:n,DolbyVision:n}},H265:{sdr:Uk.HEVC_MAIN_CODEC_LADDER,hdr:{HDR10:Bk.HEVC_MAIN_10_CODEC_LADDER,DolbyVision:Nk.DVHE_CODEC_LADDER}}};t.VIDEO_CODEC_LADDER=r});e(Vk);Vk.VIDEO_CODEC_LADDER;var jk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=[{videoQuality:"UHD",frameRate:"HFR"},{videoQuality:"UHD",frameRate:"HFR"},{videoQuality:"HD",frameRate:"HFR"},{videoQuality:"HD",frameRate:"SFR"},{videoQuality:"SD",frameRate:"HFR"},{videoQuality:"SD",frameRate:"SFR"}],f={H264:"H264",H265:"H265"},h={HDR10:"Hdr10",DolbyVision:"DolbyVision"},n=["V2_2","NoDigitalOutput"],s=["V2_2","NoDigitalOutput"],m=M.get("VideoCapabilityParameterConverter"),r=function(){function e(){this.deviceCapabilities=Yh.deviceCapabilities}return e.prototype.convert=function(i){for(var o={H264:{codecLevel:0,hdrFormats:[]},H265:{codecLevel:0,hdrFormats:[]}},a=null,s=[],l=null,e=Object.keys(i),t=function(e){var t=u.calculateSdrCodecIndex(e,i);null!=t&&(o[e].codecLevel=Vk.VIDEO_CODEC_LADDER[e].sdr.codecLevels[t]),null!=t&&(null==a||t<a)&&(a=t);var n=F.mapObject(i[e].hdr,function(e){return null!=e&&null!=t&&e<=t});if(u.populateSupportedDynamicRange(n,o[e].hdrFormats),"H265"===e&&null!=t&&a===t){s.push(f[e]);var r=o[e].hdrFormats.map(function(e){return h[e]});0<r.length&&(l=[]).push.apply(l,r)}},u=this,n=0,r=e;n<r.length;n++){t(r[n])}var c=null!=a?p[a].videoQuality:"SD",d=null!=a?p[a].frameRate:"SFR";return null===l&&(l=["None"]),null===a&&m.error("No Video codec indicated support. Setting H264 as supported."),s.push("H264"),{videoQuality:c,frameRate:d,hdrFormats:l,videoCodec:s,videoDecodeCapabilities:this.flattenVideoDecodeCapabilities(o)}},e.prototype.populateSupportedDynamicRange=function(e,t){var n=this.deviceCapabilities.output.video.display.dynamicRangeFormatSupport,r=this.deviceCapabilities.output.video.display.hdcpStatus;if(0<n.length&&-1<s.indexOf(r))for(var i=0,o=Object.keys(e);i<o.length;i++){var a=o[i];e[a]&&-1<n.indexOf(a)&&t.push(a)}},e.prototype.flattenVideoDecodeCapabilities=function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],o=e[i];t[i+".codecLevel"]=o.codecLevel.toFixed(1),0<o.hdrFormats.length&&(t[i+".hdrFormats"]=o.hdrFormats)}return t},e.prototype.calculateSdrCodecIndex=function(e,t){var n=t[e].sdr;null!=n&&"H264"===e&&n<2&&(n=2);var r=this.displayCapabilityToCodecLadderIndex();return null!=n&&n<r&&(n=r),n},e.prototype.displayCapabilityToCodecLadderIndex=function(){var e=this.deviceCapabilities.output.video.display.height,t=this.deviceCapabilities.output.video.display.hdcpStatus;return 1080<e&&-1<n.indexOf(t)?0:480<e?2:4},e}();t.VideoCapabilityParameterConverter=r});e(jk);jk.VideoCapabilityParameterConverter;var Xk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("VideoCodecsQuerier"),r=[{video:{contentType:"",width:3840,height:2160,bitrate:12e5,framerate:"50"}},{video:{contentType:"",width:3840,height:2160,bitrate:1e6,framerate:"24"}},{video:{contentType:"",width:1280,height:720,bitrate:5e5,framerate:"50"}},{video:{contentType:"",width:1280,height:720,bitrate:3e5,framerate:"24"}},{video:{contentType:"",width:720,height:480,bitrate:25e4,framerate:"50"}},{video:{contentType:"",width:720,height:480,bitrate:2e5,framerate:"24"}}],n={DolbyVision:null,HDR10:null},u={H264:{sdr:null,hdr:F.clone(n)},H265:{sdr:null,hdr:F.clone(n)}};function c(e){return F.mapObject(e,function(e){return{sdr:e.sdr,hdr:F.mapObject(e.hdr,function(e){return e})}})}var o=function(){function e(){this.cachedCodecIndex=null}return e.prototype.querySupportedCapabilities=function(){var o=this;if(null!==this.cachedCodecIndex)return Fe.Promise.resolve(c(this.cachedCodecIndex));for(var a=c(u),s=[],e=Date.now(),t=function(r){for(var i=l.queryConfigs(Vk.VIDEO_CODEC_LADDER[r].sdr.codecStrings),e=function(t){var n=Vk.VIDEO_CODEC_LADDER[r].hdr[t].codecStrings,e=void 0;e=0!==n.length?i.then(function(e){return a[r].sdr=e,o.querySingleConfig(e,n)}).then(function(e){e&&(a[r].hdr[t]=a[r].sdr)}).catch(function(){}):i.then(function(e){a[r].sdr=e}),s.push(e)},t=0,n=Object.keys(Vk.VIDEO_CODEC_LADDER[r].hdr);t<n.length;t++){e(n[t])}},l=this,n=0,r=Object.keys(Vk.VIDEO_CODEC_LADDER);n<r.length;n++){t(r[n])}return Fe.Promise.all(s).then(function(){return i.info("Query duration: "+(Date.now()-e)+" ms"),o.cachedCodecIndex=a,c(o.cachedCodecIndex)})},e.prototype.clearCache=function(){this.cachedCodecIndex=null},e.prototype.queryConfigs=function(e){return this.queryConfigIndexStartingAt(0,e)},e.prototype.queryConfigIndexStartingAt=function(t,n){var r=this;return 5<t?Fe.Promise.resolve(null):this.querySingleConfig(t,n).then(function(e){return e?t:r.queryConfigIndexStartingAt(t+1,n)})},e.prototype.querySingleConfig=function(e,t){if(null==e)return Fe.Promise.resolve(!1);var n={video:F.clone(r[e].video)};return n.video.contentType="video/mp4; codecs=\""+t[e]+"\"",hE.mediaCapabilities.decodingInfo(n)},e}();t.VideoCodecsQuerier=o});e(Xk);Xk.VideoCodecsQuerier;var zk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.CodecsQuerier=Fk.CodecsQuerier,t.VideoCapabilityParameterConverter=jk.VideoCapabilityParameterConverter,t.VideoCodecsQuerier=Xk.VideoCodecsQuerier});e(zk);zk.CodecsQuerier,zk.VideoCapabilityParameterConverter,zk.VideoCodecsQuerier;var qk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("PlaybackResourceRequestBuilderFactory"),n=function(){function c(){null==c.baseBuilder&&(c.baseBuilder=c.createBaseRequest()),this.videoCodecsQuerier=new zk.VideoCodecsQuerier,this.videoCapabilityParameterConverter=new zk.VideoCapabilityParameterConverter}return c.prototype.createDeviceCompliantBuilder=function(u,n){var t=this,e=zk.CodecsQuerier.querySupportedCodecs().then(function(e){if(n.throwIfRequested(),null==e.supportedAudioCodecs)return null;if(null==up.configurationStore.configuration||null==up.configurationStore.configuration.capabilities||null==up.configurationStore.configuration.capabilities.codecBlocklist||null==up.configurationStore.configuration.capabilities.codecBlocklist.Audio||F.isEmpty(up.configurationStore.configuration.capabilities.codecBlocklist.Audio))return e.supportedAudioCodecs;var t=up.configurationStore.configuration.capabilities.codecBlocklist.Audio;return i.info("The following audio codecs have been blocklisted:",JSON.stringify(t)),e.supportedAudioCodecs.filter(function(e){return!F.contains(t,e)})}),r=this.videoCodecsQuerier.querySupportedCapabilities().then(function(e){return n.throwIfRequested(),t.videoCapabilityParameterConverter.convert(e)});return Fe.Promise.all([e,r]).then(function(e){var t=e[0],n=e[1],r=c.baseBuilder.clone(),i=t,o=n;null!=t&&r.playerAttribute("supportedAudioCodecs",i),r.playerAttribute("frameRate",o.frameRate);for(var a=0,s=Object.keys(o.videoDecodeCapabilities);a<s.length;a++){var l=s[a];r.playerAttribute(l,o.videoDecodeCapabilities[l])}return r.overrideDeviceCapability("hdrFormat",o.hdrFormats).overrideDeviceCapability("videoCodec",o.videoCodec).overrideDeviceCapability("videoQuality",null===u?o.videoQuality:u),r})},c.createBaseRequest=function(){var e=null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.prs&&"HTTP"===up.configurationStore.configuration.prs.protocol?"Http":"Https";return(new ux.PlaybackResourceRequestBuilder).overrideDeviceCapability("protocol",e).overrideDeviceCapability("streamingTechnology","DASH").overrideDeviceCapability("drm","CENC").overrideDeviceCapability("bitrateAdaptation",["CVBR","CBR"])},c.baseBuilder=null,c}();t.PlaybackResourceRequestBuilderFactory=n});e(qk);qk.PlaybackResourceRequestBuilderFactory;var Wk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("PlaybackUrlsOptionsFactory"),n=function(){function e(){}return e.create=function(){var e=Yh.deviceInformation.hardware.isHighPerformance,t={audioTrackId:"all",languageFeature:"MLFv2",liveManifestType:null!=e&&!0===e?["patternTemplate","accumulating","live"]:["patternTemplate","live"]},n=this.computeVideoMaxBitrateBps();return null!==n&&(t.videoMaxBitrateBps=n),tx.MediaKeysManager.getSupportedKeySystem().then(function(e){return null==e?r.warn("No keySystem is available"):"com.widevine.alpha"===e?t.drmKeyScheme="DUAL_KEY":0===e.indexOf("com.microsoft.playready")?t.drmKeyScheme="SINGLE_KEY":r.warn("Unexpected supported keySystem '"+e+"'"),t})},e.computeVideoMaxBitrateBps=function(){var e=xt.nestedValue(Yh.deviceInformation,"mediaSource.maxVideoBitrate");return null!==e&&this.isSaneBitrate(e)?Math.floor(e):null},e.isSaneBitrate=function(e){return e<1e12},e}();t.PlaybackUrlsOptionsFactory=n});e(Wk);Wk.PlaybackUrlsOptionsFactory;var Hk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseAcquirer=Ok.LicenseAcquirer,t.PlaybackResourceRequestBuilderFactory=qk.PlaybackResourceRequestBuilderFactory,t.PlaybackUrlsOptionsFactory=Wk.PlaybackUrlsOptionsFactory});e(Hk);Hk.LicenseAcquirer,Hk.PlaybackResourceRequestBuilderFactory,Hk.PlaybackUrlsOptionsFactory;var Gk=t(function(e,t){var l=V&&V.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.expandMatcherLanguages=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(null==i.language)t.push(i);else for(var o=0,a=vx.generateLookupFallbackTags(i.language.toLowerCase());o<a.length;o++){var s=a[o];t.push(l({},i,{language:s}))}}return t},t.isMatch=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];if(e[i]!==t[i]){if("language"!==i)return!1;var o=e.language;if(null==o)return!1;if(null!=t.language&&!vx.isBasicLanguageRangeMatch(o,t.language))return!1}}return!0}});e(Gk);Gk.expandMatcherLanguages,Gk.isMatch;var Kk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.expandMatcherLanguages=Gk.expandMatcherLanguages,t.isMatch=Gk.isMatch});e(Kk);Kk.expandMatcherLanguages,Kk.isMatch;var Qk=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={}).Completed="Completed",n.Deleted="Deleted",n.Deleting="Deleting",n.Disabled="Disabled",n.Downloading="Downloading",n.Error="Error",n.Paused="Paused",n.Pausing="Pausing",n.Pending="Pending",n);t.INTERNAL_DOWNLOAD_OPERATION_STATE_TO_PUBLIC_STATE_MAP=r});e(Qk);Qk.INTERNAL_DOWNLOAD_OPERATION_STATE_TO_PUBLIC_STATE_MAP;var Yk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._downloadedSizeBytes=0,this._totalSizeBytes=0}return Object.defineProperty(e.prototype,"downloadedSizeBytes",{get:function(){return this._downloadedSizeBytes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalSizeBytes",{get:function(){return this._totalSizeBytes},enumerable:!0,configurable:!0}),e}();t.LocalContent=n});e(Yk);Yk.LocalContent;var Jk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var y=M.get("FiniteStateMachine"),n=function(){function e(e){var m=this;this.illegalTransitionCallbacks=[],this.handlingUncaughtException=!1,this.actionMap=[],this.stateEnterHandlers=[],this.stateLeaveHandlers=[],this.stateReenterHandlers=[],this.executeAction=function(e,t){var n=m.findTransition(m.currentState,e);if(null!=n){m.currentState=n.toState;var r=void 0,i=void 0;n.fromState!==n.toState?(r=m.stateLeaveHandlers.filter(function(e){return e.state===n.fromState}),i=m.stateEnterHandlers.filter(function(e){return e.state===n.toState})):i=m.stateReenterHandlers.filter(function(e){return e.state===n.fromState});try{if(null!=r)for(var o=0,a=r;o<a.length;o++){a[o].handler()}for(var s=0,l=n.handlers;s<l.length;s++){(0,l[s])(t)}if(null!=i)for(var u=0,c=i;u<c.length;u++){c[u].handler()}n.fromState!==n.toState&&m.stateChangeHandlers.invokeSync(m.currentState)}catch(e){if(m.handlingUncaughtException)return y.error("Unhandled exception while handling exception:",e),void(m.handlingUncaughtException=!1);m.handlingUncaughtException=!0;var d=m.uncaughtExceptionHandler(e);return void(null!=d&&m.act(d,e))}m.handlingUncaughtException=!1}else for(var p=0,f=m.illegalTransitionCallbacks;p<f.length;p++){var h=f[p];try{h(m.currentState,e,t)}catch(e){y.error("Error when calling an illegal transition callback",e)}}},this.currentState=e,this.uncaughtExceptionHandler=function(e){throw e},this.stateChangeHandlers=new Dt.MulticastCallback,this.timer=A.timer}return e.prototype.onIllegalTransition=function(e){this.illegalTransitionCallbacks.push(e)},e.prototype.onUncaughtException=function(e){this.uncaughtExceptionHandler=e},e.prototype.addTransition=function(e,t,n){if(null!=this.findTransition(e,t))throw new Error("Transition already exists from state "+e+" with action "+t);this.actionMap.push({fromState:e,action:t,toState:n,handlers:[]})},e.prototype.onEnterState=function(e,t){this.stateEnterHandlers.push({state:e,handler:t})},e.prototype.onLeaveState=function(e,t){this.stateLeaveHandlers.push({state:e,handler:t})},e.prototype.onReenterState=function(e,t){this.stateReenterHandlers.push({state:e,handler:t})},e.prototype.onTransition=function(e,t,n){var r=this.findTransition(e,t);if(null==r)throw new Error("No transition exists from state "+e+" with action "+t);r.handlers.push(n)},e.prototype.onStateChange=function(e){this.stateChangeHandlers.add(e),e(this.currentState)},Object.defineProperty(e.prototype,"state",{get:function(){return this.currentState},enumerable:!0,configurable:!0}),e.prototype.act=function(e,t){var n=this;this.timer.setImmediate(function(){n.executeAction(e,t)})},e.prototype.actNow=function(e,t){this.executeAction(e,t)},e.prototype.findTransition=function(t,n){return F.find(this.actionMap,function(e){return e.fromState===t&&e.action===n})},e}();t.FiniteStateMachine=n});e(Jk);Jk.FiniteStateMachine;var $k=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FiniteStateMachine=Jk.FiniteStateMachine});e($k);$k.FiniteStateMachine;var Zk=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.playbackUrls=e,this.currentUrlSet=this.playbackUrls.urlSets[this.playbackUrls.defaultUrlSetId],this.multicastCallback=new Dt.MulticastCallback}return e.prototype.get=function(){return this.toSourceUrl(this.currentUrlSet)},e.prototype.getCurrentManifestData=function(){return this.currentUrlSet.urls.manifest},e.prototype.resourceAcquired=function(e){},e.prototype.resourceAcquisitionFailed=function(e,t,n){return!0},e.prototype.onChange=function(e){this.multicastCallback.add(e)},e.prototype.offChange=function(e){this.multicastCallback.remove(e)},e.prototype.toSourceUrl=function(e){return{url:e.urls.manifest.url,urlId:e.urlSetId,headers:{}}},e}();t.DownloadPlaybackUrlsSourceUrlStore=n});e(Zk);Zk.DownloadPlaybackUrlsSourceUrlStore;var eR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var f=M.get("PlaybackUrlsContentDownloaderSource"),h={dialog:"Dialog",descriptive:"Descriptive",commentary:"Commentary"},n=function(){function e(e,t,n,r,i,o,a,s){var l=this;if(this.audioTrackMetadata=null,this.deferredContentDownloaderFragmentPromise=null,this.internalOperationCancelFunction=null,this.internalOperationCancelToken=null,this.mediaRepresentation=null,this.representationSource=null,this.resourceAcquirer=new c_.ResourceAcquirer,this.acquireManifest=function(){var e=l.createRepresentationSource();l.representationSource=e,Fe.Promise.resolve().then(function(){return l.checkOperationCanceled(),l.acquireMediaRepresentation(e)}).then(function(t){return l.checkOperationCanceled(),TE.MediaCapabilitiesFilter.create(t).then(function(e){l.checkOperationCanceled(),t.applyFilters([e,new TE.AudioQualityLevelFilter]),l.mediaRepresentation=t,l.stateMachine.act("Ready")})}).catch(function(e){e instanceof Fe.CancelError||l.stateMachine.act("Cancel")})},this.handleInitialManifestAcquired=function(){if(null!=l.mediaRepresentation){l.mediaRepresentation.start(0);var e=l.createContentDownloader(l.mediaRepresentation);null!=l.deferredContentDownloaderFragmentPromise&&(l.deferredContentDownloaderFragmentPromise.resolve(e),l.deferredContentDownloaderFragmentPromise=null)}else l.stateMachine.act("Cancel")},this.shutdownSource=function(){null!=l.internalOperationCancelFunction&&(l.internalOperationCancelFunction(),l.internalOperationCancelFunction=null),null!=l.deferredContentDownloaderFragmentPromise&&null!=l.internalOperationCancelToken&&l.deferredContentDownloaderFragmentPromise.reject(l.internalOperationCancelToken.promise),null!=l.mediaRepresentation&&(l.mediaRepresentation.stop(),l.mediaRepresentation=null),null!=l.representationSource&&(l.representationSource.stop(),l.representationSource=null)},this.onStateChangeError=function(e){null!=l.deferredContentDownloaderFragmentPromise&&l.deferredContentDownloaderFragmentPromise.reject(e),f.error(e)},this.contentConfig=e,this.downloadOperationId=t,this.getLicenseCallback=n,this.mediaKeysManager=r,this.maxVideoBitrate=o,this.audioStreamMatchers=a,this.timedTextStreamMatchers=s,!F.isEmpty(i.audioTracks)){this.audioTrackMetadata={};for(var u=0,c=i.audioTracks;u<c.length;u++){var d=c[u],p=null!=d.audioTrackId?d.audioTrackId:d.languageCode+"_"+d.audioSubtype+"_"+d.index;this.audioTrackMetadata[p]={languageCode:d.languageCode,subtype:h[d.audioSubtype],label:d.displayName}}}this.sourceUrlStore=new Zk.DownloadPlaybackUrlsSourceUrlStore(i),this.stateMachine=new $k.FiniteStateMachine("Uninitialized"),this.setupStateMachine()}return e.prototype.start=function(){if(null!=this.deferredContentDownloaderFragmentPromise)return this.deferredContentDownloaderFragmentPromise.promise;this.deferredContentDownloaderFragmentPromise=new Fe.Deferred;var e=Fe.CancelToken.source(),t=e.token,n=e.cancel;return this.internalOperationCancelFunction=n,this.internalOperationCancelToken=t,f.info("Manifest URL:",this.sourceUrlStore.get().url),this.stateMachine.act("Initialize"),this.deferredContentDownloaderFragmentPromise.promise},e.prototype.stop=function(){this.stateMachine.act("Cancel")},e.prototype.acquireMediaRepresentation=function(e){e.prepare(this.sourceUrlStore,1e4);var t=e.mediaRepresentation;return!0===t.valid?t.contents:t.refresh()},e.prototype.checkOperationCanceled=function(){null!=this.internalOperationCancelToken&&this.internalOperationCancelToken.throwIfRequested()},e.prototype.createContentDownloader=function(e){return new b_.ContentDownloaderFragment(this.contentConfig,this.downloadOperationId,this.getLicenseCallback,this.mediaKeysManager,e,this.maxVideoBitrate,this.sourceUrlStore,this.audioStreamMatchers,this.timedTextStreamMatchers)},e.prototype.createRepresentationSource=function(){return new Rk.DashMediaRepresentationSource(this.resourceAcquirer,"segmentBase",this.audioTrackMetadata,3,this.downloadOperationId)},e.prototype.setupStateMachine=function(){this.stateMachine.addTransition("Uninitialized","Initialize","Initializing"),this.stateMachine.addTransition("Initializing","Cancel","Uninitialized"),this.stateMachine.addTransition("Initializing","Ready","Ready"),this.stateMachine.addTransition("Ready","Cancel","Uninitialized"),this.stateMachine.onEnterState("Initializing",this.acquireManifest),this.stateMachine.onEnterState("Uninitialized",this.shutdownSource),this.stateMachine.onTransition("Initializing","Ready",this.handleInitialManifestAcquired),this.stateMachine.onIllegalTransition(function(e,t,n){f.error("IllegalTransitionError from action ["+t+"] while in state ["+e+"]")}),this.stateMachine.onUncaughtException(this.onStateChangeError)},e}();t.PlaybackUrlsContentDownloaderSource=n});e(eR);eR.PlaybackUrlsContentDownloaderSource;var tR=t(function(e,t){var n,r,i,s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});M.get("StreamMatcherTransformer"),(n={}).Audio="Audio",n.TimedText="TimedText",n.Video="Video";var o=((r={}).Dialog="Dialog",r.Commentary="Commentary",r.Descriptive="Descriptive",r),a=((i={}).Mandatory="Mandatory",i.Subtitle="Subtitle",i.Caption="Subtitle",i.SDH="Subtitle",i),l=function(){function e(){}return e.expandMatcherLanguages=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(t.push(i),null!=i.language){i.language=i.language.toLowerCase();for(var o=i.language,a=o.lastIndexOf("-");-1!==a;)a=(o=o.substring(0,a)).lastIndexOf("-"),t.push(s({},i,{language:o}))}}return t},e.convertStreamMatcherToTypeMatcher=function(e,t){if("Audio"===e){var n=t;return{type:"Audio",language:n.language,subtype:null!=n.type?o[n.type]:void 0}}if("TimedText"===e){var r=t,i=null!=r.type?a[r.type]:"Subtitle";return{type:"TimedText",language:t.language,textType:i}}return{type:"Video"}},e}();t.StreamMatcherTransformer=l});e(tR);tR.StreamMatcherTransformer;var nR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var h=M.get("DownloadOperation"),n=function(){function e(e,t,n,r,i,o,a,s,l){var u=this;this.contentConfig=null,this.downloadError=null,this.needRefresh=!1,this.audioStreamMatchers=[],this.cancelCurrentOperation=null,this.contentDownloaderFragment=null,this.contentDownloaderSource=null,this.licenseAcquirer=null,this.staticTimedTextStreams=[],this.timedTextStreamMatchers=[],this._downloadOperationState="Pending",this.eventEmitter=new Dt.EventEmitter,this.reportLicenseAcquisitionSuccess=function(e){},this.reportLicenseAcquisitionFailure=function(e){},this.downloadCompleted=function(){u.internalPause().then(function(){return u.onStateChange("Completed")})},this.onStateChange=function(e){return h.info(">>> Storing download operation "+u.id+" metadata on state change to "+e),u._downloadOperationState=e,RI.metadataStorage.put(u.downloadOperationMetadataKey,u.createDownloadOperationMetadata()).then(function(){return u.emitStateChange()})},this.id=e,this.downloadOperationMetadataKey=EI.createDownloadOperationMetadataKey(this.id),this.mediaKeysManager=t,this.playbackResourceAcquirer=n,this.prsClient=r,this.staticTimedTextDataStore=i,this.localContent=new Yk.LocalContent,null!=o&&(this.contentConfig=o),this.maxVideoBitrateBitPerSec=null!=a?a:Number.MAX_VALUE,null!=s&&(this.audioStreamMatchers=s),null!=l&&(this.timedTextStreamMatchers=l)}return Object.defineProperty(e.prototype,"downloadOperationState",{get:function(){return this._downloadOperationState},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){var n=this;return h.info(">> initialize,",this.id),RI.metadataStorage.get(this.downloadOperationMetadataKey).then(function(e){if(null==e){if(null==n.contentConfig)throw n._downloadOperationState="Error",new Ne.XpError("downloader.initialization.invalid_state",void 0,"DownloadOperation "+n.id+" doesn't have persistent metadata nor ContentConfig");return h.info(">>> download operation "+n.id+" is newly requested. Storing its metadata now."),RI.metadataStorage.put(n.downloadOperationMetadataKey,n.createDownloadOperationMetadata())}if(null!=n.contentConfig)return h.warn("DownloadOperation "+n.id+" is constructed with ContentConfig AND has persistent metadata. Potentially metadata was not properly removed. Ignore stale metadata and overwrite."),RI.metadataStorage.put(n.downloadOperationMetadataKey,n.createDownloadOperationMetadata());var t=e;n._downloadOperationState=t.state,n.contentConfig=t.contentConfig,n.maxVideoBitrateBitPerSec=t.maxVideoBitrateBitPerSec,n.audioStreamMatchers=t.audioStreamMatchers,n.timedTextStreamMatchers=t.timedTextStreamMatchers,h.info(">>> download operation "+n.id+" recovered its metadata: "+JSON.stringify(t))}).then(function(){h.info("<< initialize succeed",n.id)}).catch(function(e){throw h.error("<< initialize fail, Download operation "+n.id+", with error:",e),e})},e.prototype.disable=function(){return h.info(">> disable",this.id),this.internalPause()},e.prototype.enable=function(){return h.info(">> enable",this.id),Fe.Promise.resolve()},e.prototype.pause=function(){var e=this;return h.info(">> pause",this.id),"Pending"!==this._downloadOperationState&&"Downloading"!==this._downloadOperationState||this.onStateChange("Pausing"),this.internalPause().then(function(){return e.onStateChange("Paused")})},e.prototype.internalPause=function(){var e=this;return h.info(">> internalPause",this.id),null==this.contentDownloaderFragment||null==this.contentDownloaderSource?Fe.Promise.resolve():(null!=this.licenseAcquirer&&this.deregisterLicenseAcquisitionReporterCallbacks(this.licenseAcquirer),this.contentDownloaderFragment.off("Completed",this.downloadCompleted),this.contentDownloaderFragment.stop().then(function(){e.contentDownloaderSource.stop()}))},e.prototype.refresh=function(){h.info(">> refresh",this.id);var e,t=Fe.CancelToken.source(),n=t.token,r=t.cancel;return null==this.contentDownloaderFragment?(e=this.createContentDownloaderFragment(n),this.cancelCurrentOperation=r):e=Fe.Promise.resolve(this.contentDownloaderFragment),e.then(function(e){return e.refresh()})},e.prototype.remove=function(){var e=this;return null==this.contentConfig?Fe.Promise.resolve():(null!=this.cancelCurrentOperation&&this.cancelCurrentOperation(),null!=this.licenseAcquirer&&this.deregisterLicenseAcquisitionReporterCallbacks(this.licenseAcquirer),this.onStateChange("Deleting"),this.pause().then(function(){return fx.StaticTimedTextDataStore.deleteContentsFromStorage(e.id)}).then(function(){return b_.ContentDownloaderFragment.delete(e.id)}).then(function(){return Rk.DashMediaRepresentationSource.delete(e.id)}).then(function(){return e.playbackResourceAcquirer.remove(e.id)}).then(function(){return RI.metadataStorage.remove(e.downloadOperationMetadataKey)}).then(function(){e._downloadOperationState="Deleted",e.emitStateChange()}))},e.prototype.resume=function(){return h.info(">> resume",this.id),"Paused"===this._downloadOperationState?this.onStateChange("Pending"):Fe.Promise.resolve()},e.prototype.retry=function(){return h.info(">> retry",this.id),Fe.Promise.resolve()},e.prototype.start=function(){var t=this;h.info(">> start",this.id);var e=Fe.CancelToken.source(),n=e.token,r=e.cancel;return this.cancelCurrentOperation=r,this.createContentDownloaderFragment(n).then(function(e){return n.throwIfRequested(),t.contentDownloaderFragment=e,t.contentDownloaderFragment.on("Completed",t.downloadCompleted),Fe.Promise.all([e.start(),t.downloadStaticTimedText()])}).then(function(){})},e.prototype.createContentDownloaderFragment=function(p){var f=this;return this.playbackResourceAcquirer.acquire(this.id,this.contentConfig.titleId,this.contentConfig.videoMaterialType,p).then(function(e){p.throwIfRequested();var t=e.prsResponse.playbackUrls;h.info("Default URL SET ID: ",t.defaultUrlSetId);var r=f.licenseAcquirer=new Hk.LicenseAcquirer(f.prsClient,e.baseBuilder);f.registerLicenseAcquisitionReporterCallbacks(f.licenseAcquirer);for(var n=[],i=0,o=f.audioStreamMatchers;i<o.length;i++){var a=o[i],s=tR.StreamMatcherTransformer.expandMatcherLanguages(a).map(function(e){return tR.StreamMatcherTransformer.convertStreamMatcherToTypeMatcher("Audio",e)});n.push(s)}for(var l=[],u=0,c=f.timedTextStreamMatchers;u<c.length;u++){var d=c[u];s=tR.StreamMatcherTransformer.expandMatcherLanguages(d).map(function(e){return tR.StreamMatcherTransformer.convertStreamMatcherToTypeMatcher("TimedText",e)});l.push(s)}return null==f.contentDownloaderSource&&(f.contentDownloaderSource=new eR.PlaybackUrlsContentDownloaderSource(f.contentConfig,f.id,function(e,t,n){return r.acquireLicense(e,t,n)},f.mediaKeysManager,t,f.maxVideoBitrateBitPerSec,n,l)),f.staticTimedTextStreams=fx.SubtitleUrlTransformer.toTimedTextStreams(f.contentConfig.titleId,e.prsResponse.subtitleUrls,e.prsResponse.forcedNarratives),"Pending"===f._downloadOperationState&&f.onStateChange("Downloading"),f.contentDownloaderSource.start()})},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.createDownloadOperationMetadata=function(){if(null==this.contentConfig||null==this.maxVideoBitrateBitPerSec||null==this.audioStreamMatchers||null==this.timedTextStreamMatchers)throw new Ne.XpError("downloader.invalid_state",void 0,"Download operation has missing metadata attributes for storage.");return{contentConfig:this.contentConfig,state:this._downloadOperationState,maxVideoBitrateBitPerSec:this.maxVideoBitrateBitPerSec,audioStreamMatchers:this.audioStreamMatchers,timedTextStreamMatchers:this.timedTextStreamMatchers}},e.prototype.downloadStaticTimedText=function(){if(0===this.timedTextStreamMatchers.length)return Fe.Promise.resolve();for(var e={},t=[],n=0,r=this.timedTextStreamMatchers;n<r.length;n++){var i=r[n],o=this.findMatchingStaticTimedTextStream(i);null==o||e[o.id]||(e[o.id]=!0,t.push(this.staticTimedTextDataStore.storeContents(this.id,o)))}return Fe.Promise.all(t).then(function(){})},e.prototype.findMatchingStaticTimedTextStream=function(e){for(var t=0,n=e;t<n.length;t++)for(var r=n[t],i=0,o=this.staticTimedTextStreams;i<o.length;i++){var a=o[i];if(Kk.isMatch(a,r))return a}return null},e.prototype.registerLicenseAcquisitionReporterCallbacks=function(e){e.on("licenseAcquired",this.reportLicenseAcquisitionSuccess),e.on("licenseAcquisitionFailed",this.reportLicenseAcquisitionFailure)},e.prototype.deregisterLicenseAcquisitionReporterCallbacks=function(e){e.off("licenseAcquired",this.reportLicenseAcquisitionSuccess),e.off("licenseAcquisitionFailed",this.reportLicenseAcquisitionFailure)},e.prototype.emitStateChange=function(){var e={downloadOperationId:this.id,downloadOperationState:Qk.INTERNAL_DOWNLOAD_OPERATION_STATE_TO_PUBLIC_STATE_MAP[this._downloadOperationState]};this.eventEmitter.emit("DownloadStateChange",e)},e}();t.DownloadOperation=n});e(nR);nR.DownloadOperation;var rR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.validate=function(e){var t="Malformed DownloadOperationQueue metadata";if(!Array.isArray(e))throw new Ne.XpError("metadata.malformed",void 0,t);var n=e;if(0<n.length&&"string"!=typeof n[0])throw t+=", not strings",new Ne.XpError("metadata.malformed",void 0,t)},e}();t.DownloadOperationQueueMetadataValidator=n});e(rR);rR.DownloadOperationQueueMetadataValidator;var iR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("PRSResponseHandler");var u=["DASH"];t.validatePRSResponse=function(e){var t=(new ux.PRSResponseValidator).validateResponse(e);if(null!=t)throw t;if(null!=(t=function(e){var t=e.urlSets,n=e.defaultUrlSetId,r=t[n].urls.manifest.streamingTechnology;if(!F.includes(u,r))return new Error("PRS response contains unsupported "+r+" Url Sets");for(var i=0,o=Object.keys(t);i<o.length;i++){var a=o[i],s=t[a],l=s.urls.manifest.streamingTechnology;if(l!==r)return new Error("PRS response contains "+l+" streaming technology, which is different from the default ("+r+")")}return null}(e.playbackUrls)))throw t}});e(iR);iR.validatePRSResponse;var oR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("PlaybackResourceAcquirer"),n=function(){function e(e,t){this.prsClient=e,this.clientPrsParameters=t}return e.prototype.acquire=function(r,t,n,i){var o=this,e=new Hk.PlaybackResourceRequestBuilderFactory,a=null;return e.createDeviceCompliantBuilder(null,i).then(function(e){return i.throwIfRequested(),a=e.content(t,n,"Download"),Hk.PlaybackUrlsOptionsFactory.create()}).then(function(e){i.throwIfRequested();var t=a.clone().resource(ux.PlaybackResource.PlaybackUrls(e)).resource(ux.PlaybackResource.CatalogMetadata(o.clientPrsParameters.titleDecorationScheme)).resource(ux.PlaybackResource.SubtitleUrls("TTMLv2")).resource(ux.PlaybackResource.ForcedNarratives()).resource(ux.PlaybackResource.TrickplayUrls()).resource(ux.PlaybackResource.TransitionTimecodes()).resource(ux.PlaybackResource.PlaybackSettings("1.0.0"));return o.prsClient.send(t.build("ImmediateConsumption"),i)}).then(function(e){return i.throwIfRequested(),e.on("latency",function(e){MT.metrics.putMetric("ServiceRequest.PRS.Download.PrimaryResources.RequestLatencyTime",e,"ms")}),Fe.Promise.all([e.response(),o.getCurrentCachedPRSResponse(i,r)])}).catch(function(e){throw i.throwIfRequested(),MT.metrics.putMetric("ServiceRequest.PRS.Download.PrimaryResources.Error"),e}).then(function(e){var t=e[0],n=e[1];return i.throwIfRequested(),iR.validatePRSResponse(t),null!=n&&null!=n.playbackUrls.cacheKey&&n.playbackUrls.cacheKey!==t.playbackUrls.cacheKey&&s.warn("Cache key is different between cached PRS Response and recently acquired PRS Response"),RI.metadataStorage.put(EI.createPlaybackResourceResponseKey(r),t).then(function(){return i.throwIfRequested(),{baseBuilder:a,prsResponse:t}})})},e.prototype.remove=function(e){return RI.metadataStorage.remove(EI.createPlaybackResourceResponseKey(e))},e.prototype.getCurrentCachedPRSResponse=function(t,e){return RI.metadataStorage.get(EI.createPlaybackResourceResponseKey(e)).catch(function(e){return s.error("Acquiring PRSResponse from MetadataStorage resulted in error: "+e),null}).then(function(e){return t.throwIfRequested(),e})},e}();t.PlaybackResourceAcquirer=n});e(oR);oR.PlaybackResourceAcquirer;var aR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="download_operation_queue",m=M.get("DownloadOperationQueue"),r={queueCategory:"None",downloadOperation:null,index:-1},i=function(){function e(e,t,n){var r=this;this.activeDownloadOperations=[],this.completedDownloadOperations={},this.idleDownloadOperations={},this.maxDownloadingOperations=1,this.maxDownloadOperationQueueSize=50,this.queueState="Uninitialized",this.queueStoragePromise=Fe.Promise.resolve(),this.startNextPendingPromise=Fe.Promise.resolve(),this.onDownloadOperationStateChange=function(t){var e=r.findDownloadOperation(t.downloadOperationId);"None"!==e.queueCategory&&("Completed"===t.downloadOperationState?r.handleCompletedState(e,t).catch(function(e){m.error("Fail to handle Completed state of download operation "+t.downloadOperationId,e)}):"Error"===t.downloadOperationState&&r.handleErrorState(e,t).catch(function(e){m.error("Fail to handle Error state of download operation "+t.downloadOperationId,e)}),r.localContentManagerEventEmitter.emit("DownloadStateChange",t))},this.onDownloadOperationProgress=function(e){"None"!==r.findDownloadOperation(e.downloadOperationId).queueCategory&&r.localContentManagerEventEmitter.emit("DownloadProgress",e)},this.onDownloadOperationError=function(e){r.localContentManagerEventEmitter.emit("DownloadError",{downloadOperationId:e.downloadOperationId,error:e.error})},this.localContentManagerEventEmitter=e;var i,o=Yh.deviceInformation;null!=n.applicationIdentity?i=n.applicationIdentity.name:null!=o.software&&null!=o.software.nativeApplication&&(i=o.software.nativeApplication.name);var a=new tx.HdcpStore(!1);this.mediaKeysManager=new tx.MediaKeysManager(a),this.prsClient=new ux.PlaybackResourceClient(t,n.clientId,i),this.playbackResourceAcquirer=new oR.PlaybackResourceAcquirer(this.prsClient,n),this.staticTimedTextDataStore=new fx.StaticTimedTextDataStore,b_.ContentDownloaderFragment.mediaKeysManager=this.mediaKeysManager}return e.prototype.initialize=function(){var h=this;if(m.info(">> initialize"),"Uninitialized"!==this.queueState){var e="Download operation queue already initialized or is initializing";return m.error(e),Fe.Promise.reject(new Ne.XpError("downloader.initialization.invalid_state",void 0,e,!0))}return this.queueState="Initializing",RI.metadataStorage.get(n).then(function(e){if(m.info(">>> Retrieved queue metadata from storage. Metadata:",JSON.stringify(e)),null==e)return Fe.Promise.resolve([]);(new rR.DownloadOperationQueueMetadataValidator).validate(e);var t=e.map(function(e){var t=new nR.DownloadOperation(e,h.mediaKeysManager,h.playbackResourceAcquirer,h.prsClient,h.staticTimedTextDataStore);return t.initialize().then(function(){return t})});return Fe.Promise.all(t)}).then(function(e){var t;if(0===e.length)return h.queueState="Initialized",void m.info("<< initialize succeed, current queue size: 0");for(var n=[],r=[],i=0,o=e;i<o.length;i++){var a=o[i];switch(a.downloadOperationState){case"Downloading":n.push(a);break;case"Pending":r.push(a);break;case"Disabled":case"Paused":case"Error":h.idleDownloadOperations[a.id]=a;break;case"Deleted":m.warn("Unexpected persistent download operation "+a.id+" state "+a.downloadOperationState+", Ignored.");break;case"Completed":h.completedDownloadOperations[a.id]=a;break;case"Pausing":case"Deleting":m.warn("Unexpected persistent download operation "+a.id+" state "+a.downloadOperationState+". Treat it as if \"Paused\"."),h.idleDownloadOperations[a.id]=a;break;default:m.warn("Unexpected persistent download operation "+a.id+" state "+a.downloadOperationState+", Ignored.")}a.on("DownloadStateChange",h.onDownloadOperationStateChange),a.on("DownloadError",h.onDownloadOperationError)}n.length>h.maxDownloadingOperations&&m.error("Persistent queue metadata contains "+n.length+" \"Downloading\" operations, more than the capacity "+h.maxDownloadingOperations),(t=h.activeDownloadOperations).push.apply(t,n.concat(r));for(var s=[],l=0,u=n;l<u.length;l++){var c=u[l];s.length<h.maxDownloadingOperations&&s.push(h.tryStartDownloadOperation(c))}for(var d=0,p=r;d<p.length;d++){var f=p[d];if(s.length>=h.maxDownloadingOperations)break;s.push(h.tryStartDownloadOperation(f))}return Fe.Promise.all(s).then(function(){h.queueState="Initialized",m.info("<< initialize succeed, current queue size:",h.getQueueSize())})}).catch(function(e){throw h.queueState="Uninitialized",m.error("<< initialize fail with error:",e),e instanceof Ne.XpError?Ne.XpError.generatePrefixedError(e,"downloader.initialization"):new Ne.XpError("downloader.initialization",void 0,"Fail to initialize",!0,e)})},e.prototype.register=function(e,o,a,s){var l=this;if(this.getQueueSize()+e.length>this.maxDownloadOperationQueueSize)throw new Ne.XpError("downloader.download_limit_exceeded");for(var u=[],t=function(e){m.info(">> register. (contentConfig:"+JSON.stringify(e)+", maxVideoBitrateBitsPerSec:"+o+")");var t=e.titleId+"_"+e.videoMaterialType,n=c.findDownloadOperation(t);if(null!=n.downloadOperation)return m.warn("DownloadOperation "+t+" already exists. Don't create duplication."),u.push(n.downloadOperation),"continue";var r=new nR.DownloadOperation(t,c.mediaKeysManager,c.playbackResourceAcquirer,c.prsClient,c.staticTimedTextDataStore,e,o,a,s),i=r.initialize();c.activeDownloadOperations.push(r),r.on("DownloadStateChange",c.onDownloadOperationStateChange),r.on("DownloadError",c.onDownloadOperationError),c.activeDownloadOperations.length<=c.maxDownloadingOperations&&i.then(function(){return r.on("DownloadProgress",l.onDownloadOperationProgress),r.start()}).catch(function(e){m.error("Fail to start newly created download operation "+t,e)}),c.storeQueue().catch(function(e){m.error("Fail to store queue metadata when newly registering a download operation "+t)}),u.push(r)},c=this,n=0,r=e;n<r.length;n++){t(r[n])}return u},e.prototype.refresh=function(e){var t=this.findDownloadOperation(e);return"None"===t.queueCategory?Fe.Promise.reject(new Ne.XpError("downloader.operation_not_found")):t.downloadOperation.refresh()},e.prototype.resume=function(i){var o=this,e=this.findDownloadOperation(i);return"None"===e.queueCategory?Fe.Promise.reject(new Ne.XpError("downloader.operation_not_found",void 0,"Download operation not found")):e.downloadOperation.resume().then(function(){var e=o.findDownloadOperation(i);if("None"!==e.queueCategory){var t=e.downloadOperation;if("Pending"===t.downloadOperationState||"Downloading"===t.downloadOperationState){var n=!0,r=[];return"Idle"===e.queueCategory?(delete o.idleDownloadOperations[i],o.activeDownloadOperations.push(t),r.push(o.tryStartNextPending())):"Complete"===e.queueCategory?(delete o.completedDownloadOperations[i],o.activeDownloadOperations.push(t)):n=!1,n&&r.push(o.storeQueue()),Fe.Promise.all(r).then(function(){})}}else m.warn(">>> Download operation "+i+" doesn't exist after resume call, ignore.")})},e.prototype.retry=function(i){var o=this,e=this.findDownloadOperation(i);return"None"===e.queueCategory?Fe.Promise.reject(new Ne.XpError("downloader.operation_not_found")):e.downloadOperation.retry().then(function(){var e=o.findDownloadOperation(i);if("None"!==e.queueCategory){var t=e.downloadOperation;if("Pending"===t.downloadOperationState||"Downloading"===t.downloadOperationState){var n=!0,r=[];return"Idle"===e.queueCategory?(delete o.idleDownloadOperations[i],o.activeDownloadOperations.push(t),r.push(o.tryStartNextPending())):"Complete"===e.queueCategory?(delete o.completedDownloadOperations[i],o.activeDownloadOperations.push(t)):n=!1,n&&r.push(o.storeQueue()),Fe.Promise.all(r).then(function(){})}}else m.warn(">>> Download operation "+i+" doesn't exist after retry call, ignore.")})},e.prototype.pause=function(e){return this.internalPause(e)},e.prototype.enable=function(r){var i=this,e=this.findDownloadOperation(r);return"None"===e.queueCategory?Fe.Promise.reject(new Ne.XpError("downloader.operation_not_found",void 0,"Download operation not found")):e.downloadOperation.enable().then(function(){var e=i.findDownloadOperation(r);if("None"!==e.queueCategory){var t=e.downloadOperation;if("Paused"===t.downloadOperationState)i.idleDownloadOperations[r]=t;else{if("Completed"!==t.downloadOperationState)return;i.completedDownloadOperations[r]=t}var n=!0;return"Active"===e.queueCategory?i.activeDownloadOperations.splice(e.index,1):"Idle"===e.queueCategory&&"Completed"===t.downloadOperationState?delete i.idleDownloadOperations[r]:"Complete"===e.queueCategory&&"Paused"===t.downloadOperationState?delete i.completedDownloadOperations[r]:n=!1,n?i.storeQueue():void 0}m.warn(">>> Download operation "+r+" doesn't exist after enable call, ignore.")})},e.prototype.disable=function(i){var o=this;return this.internalPause(i).then(function(){var e=o.findDownloadOperation(i);if("None"!==e.queueCategory)return e.downloadOperation.disable();m.warn(">>> Download operation "+i+" doesn't exist after internalPause process, ignore.")}).then(function(){var e=o.findDownloadOperation(i);if("None"!==e.queueCategory){var t=e.downloadOperation;if("Disabled"===t.downloadOperationState){var n=!0,r=[];return"Active"===e.queueCategory?(o.activeDownloadOperations.splice(e.index,1),o.idleDownloadOperations[i]=t):"Complete"===e.queueCategory?(delete o.completedDownloadOperations[i],o.idleDownloadOperations[i]=t):n=!1,n&&r.push(o.storeQueue()),Fe.Promise.all(r).then(function(){})}}else m.warn(">>> Download operation "+i+" doesn't exist after disable call, ignore.")})},e.prototype.remove=function(n){var r=this;return this.internalPause(n).then(function(){var e=r.findDownloadOperation(n);if("None"!==e.queueCategory)return e.downloadOperation.remove();m.warn(">>> Download operation "+n+" doesn't exist after internalPause process, ignore.")}).then(function(){var e=r.findDownloadOperation(n);if("None"!==e.queueCategory){var t=e.downloadOperation;return"Deleted"!==t.downloadOperationState&&m.error("Unexpected download operation state of "+n+" after remove call: "+t.downloadOperationState),t.off("DownloadStateChange",r.onDownloadOperationStateChange),t.off("DownloadError",r.onDownloadOperationError),"Active"===e.queueCategory?r.activeDownloadOperations.splice(e.index,1):"Idle"===e.queueCategory?delete r.idleDownloadOperations[n]:delete r.completedDownloadOperations[n],r.storeQueue()}m.warn(">>> Download operation "+n+" doesn't exist after remove call, ignore.")})},e.prototype.getAllDownloadOperations=function(){for(var e=this.activeDownloadOperations.slice(),t=0,n=Object.keys(this.idleDownloadOperations);t<n.length;t++){var r=n[t];"Deleted"!==this.idleDownloadOperations[r].downloadOperationState&&e.push(this.idleDownloadOperations[r])}for(var i=0,o=Object.keys(this.completedDownloadOperations);i<o.length;i++){r=o[i];"Deleted"!==this.completedDownloadOperations[r].downloadOperationState&&e.push(this.completedDownloadOperations[r])}return e},e.prototype.getCurrentDownloadOperation=function(){return 0===this.activeDownloadOperations.length||"Downloading"!==this.activeDownloadOperations[0].downloadOperationState?Fe.Promise.resolve(null):Fe.Promise.resolve(this.activeDownloadOperations[0])},e.prototype.findDownloadOperation=function(e){var t=this.completedDownloadOperations[e];if(null!=t)return{queueCategory:"Complete",downloadOperation:t,index:-1};if(null!=(t=this.idleDownloadOperations[e]))return{queueCategory:"Idle",downloadOperation:t,index:-1};for(var n=0;n<this.activeDownloadOperations.length;n++)if(this.activeDownloadOperations[n].id===e)return{queueCategory:"Active",downloadOperation:this.activeDownloadOperations[n],index:n};return r},e.prototype.internalPause=function(i){var o=this,e=this.findDownloadOperation(i);return"None"===e.queueCategory?Fe.Promise.reject(new Ne.XpError("downloader.operation_not_found",void 0,"Download operation not found")):e.downloadOperation.pause().then(function(){var e=o.findDownloadOperation(i);if("None"!==e.queueCategory){var t=e.downloadOperation;if("Paused"===t.downloadOperationState){t.off("DownloadProgress",o.onDownloadOperationProgress);var n=[],r=!0;return"Active"===e.queueCategory?(o.activeDownloadOperations.splice(e.index,1),o.idleDownloadOperations[i]=t,n.push(o.tryStartNextPending())):"Complete"===e.queueCategory?m.warn("Unexpected behavior: a Complete download operation is in paused state. Ignore"):r=!1,r&&n.push(o.storeQueue()),Fe.Promise.all(n).then(function(){})}}else m.warn(">>> Download operation "+i+" doesn't exist after pause call, ignore.")})},e.prototype.tryStartNextPending=function(){var i=this;return this.startNextPendingPromise=this.startNextPendingPromise.catch(function(e){m.error("Fail to start next Pending download operation previously. Ignore error and continue.",e)}).then(function(){for(var e=0,t=0,n=i.activeDownloadOperations;t<n.length;t++){var r=n[t];if("Downloading"===r.downloadOperationState)e++;else{if("Pending"===r.downloadOperationState)break;"Error"===r.downloadOperationState&&e++}}if(e<i.activeDownloadOperations.length&&e<i.maxDownloadingOperations&&"Pending"===i.activeDownloadOperations[e].downloadOperationState)return i.activeDownloadOperations[e].off("DownloadProgress",i.onDownloadOperationProgress),i.activeDownloadOperations[e].on("DownloadProgress",i.onDownloadOperationProgress),i.activeDownloadOperations[e].start()}),this.startNextPendingPromise},e.prototype.storeQueue=function(){var t=this;return this.queueStoragePromise=this.queueStoragePromise.catch(function(e){m.error("Previously fail to store the queue. Ignoring the error and continue.",e)}).then(function(){var e=t.activeDownloadOperations.map(function(e){return e.id});return e.push.apply(e,Object.keys(t.idleDownloadOperations)),e.push.apply(e,Object.keys(t.completedDownloadOperations)),RI.metadataStorage.put(n,e)}),this.queueStoragePromise},e.prototype.getQueueSize=function(){return this.activeDownloadOperations.length+Object.keys(this.idleDownloadOperations).length+Object.keys(this.completedDownloadOperations).length},e.prototype.handleCompletedState=function(e,t){var n=e.downloadOperation,r=!0,i=[];return"Active"===e.queueCategory?(this.activeDownloadOperations.splice(e.index,1),this.completedDownloadOperations[t.downloadOperationId]=n,i.push(this.tryStartNextPending())):"Idle"===e.queueCategory?(delete this.idleDownloadOperations[t.downloadOperationId],this.completedDownloadOperations[t.downloadOperationId]=n):r=!1,r&&i.push(this.storeQueue()),Fe.Promise.all(i).then(function(){})},e.prototype.handleErrorState=function(e,t){return e.queueCategory,Fe.Promise.resolve()},e.prototype.tryStartDownloadOperation=function(t){var n=this;return t.on("DownloadProgress",this.onDownloadOperationProgress),t.start().catch(function(e){m.error("Failed to start download operation "+t.id,e),t.off("DownloadProgress",n.onDownloadOperationProgress)})},e}();t.DownloadOperationQueue=i});e(aR);aR.DownloadOperationQueue;var sR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.transformToPublicDownloadOperation=function(e){return e.downloadOperationState,{id:e.id,contentConfig:e.contentConfig,downloadError:e.downloadError,downloadedSizeBytes:e.localContent.downloadedSizeBytes,downloadState:Qk.INTERNAL_DOWNLOAD_OPERATION_STATE_TO_PUBLIC_STATE_MAP[e.downloadOperationState],needRefresh:e.needRefresh,totalSizeBytes:e.localContent.totalSizeBytes}},e}();t.DownloadOperationTransformer=n});e(sR);sR.DownloadOperationTransformer;var lR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("XpLocalContentManagerFeature"),n=function(){function e(e,t){this.version="0.0.1",this.objectId="XpPlayerSDK-Local-Content-Manager-Feature-"+Math.random(),this.eventEmitter=new Dt.EventEmitter;var n={titleDecorationScheme:t.titleDecorationScheme,applicationIdentity:t.applicationIdentity,clientId:t.clientId};this.queue=new aR.DownloadOperationQueue(this.eventEmitter,e,n)}return e.prototype.initialize=function(){return this.queue.initialize()},e.prototype.createDownload=function(e,t,n,r){return i.info(">> createDownload, contentConfig: "+JSON.stringify(e)+", maxVideoBitrateBitsPerSec: "+t+", audioStreamMatchers: "+JSON.stringify(n)+", timedTextStreamMatchers: "+JSON.stringify(r)),this.queue.register(e,t,n,r).map(function(e){return sR.DownloadOperationTransformer.transformToPublicDownloadOperation(e)})},e.prototype.resume=function(e){return i.info(">> resume, id:",e),this.queue.resume(e)},e.prototype.retry=function(e){return i.info(">> retry, id:",e),this.queue.retry(e)},e.prototype.pause=function(e){return i.info(">> pause, id:",e),this.queue.pause(e)},e.prototype.disable=function(e){return i.info(">> disable, id:",e),this.queue.disable(e)},e.prototype.enable=function(e){return i.info(">> enable, id:",e),this.queue.enable(e)},e.prototype.refresh=function(e){return i.info(">> refresh, id:",e),this.queue.refresh(e)},e.prototype.remove=function(e){return i.info(">> remove, id:",e),this.queue.remove(e)},e.prototype.getAllDownloadOperations=function(){i.info(">> getAllDownloadOperations");var e=this.queue.getAllDownloadOperations().map(function(e){return sR.DownloadOperationTransformer.transformToPublicDownloadOperation(e)});return Fe.Promise.resolve(e)},e.prototype.getCurrentDownloadOperation=function(){return i.info(">> getCurrentDownloadOperation"),this.queue.getCurrentDownloadOperation().then(function(e){return null==e?null:sR.DownloadOperationTransformer.transformToPublicDownloadOperation(e)})},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId}},e}();t.XpLocalContentManagerFeature=n});e(lR);lR.XpLocalContentManagerFeature;var uR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.createDownloadOperationMetadataKey=EI.createDownloadOperationMetadataKey,t.createDownloadOperationStoragePrefixKey=EI.createDownloadOperationStoragePrefixKey,t.createPlaybackResourceResponseKey=EI.createPlaybackResourceResponseKey,t.XpLocalContentManagerFeature=lR.XpLocalContentManagerFeature});e(uR);uR.createDownloadOperationMetadataKey,uR.createDownloadOperationStoragePrefixKey,uR.createPlaybackResourceResponseKey,uR.XpLocalContentManagerFeature;var cR,dR,pR,fR,hR=function(){function e(){var i=this;this.sources=[],this.sinks=[],this.onSourceLog=function(e,t){for(var n=0,r=i.sinks;n<r.length;n++){r[n].write(e,t)}}}return e.prototype.addSources=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=F.difference(e,this.sources),r=0,i=n;r<i.length;r++){i[r].onLog(this.onSourceLog)}this.sources=this.sources.concat(n)},e.prototype.removeSources=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){r[n].offLog(this.onSourceLog)}this.sources=F.difference(this.sources,e)},e.prototype.addSinks=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.sinks=F.union(this.sinks,e)},e.prototype.removeSinks=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.sinks=F.difference(this.sinks,e)},e}(),mR=function(){function e(e){this.ephemeralId="",this.logger=M.get(e)}return e.prototype.log=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.logger).log.apply(e,[this.ephemeralId].concat(t))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.info=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.logger).info.apply(e,[this.ephemeralId].concat(t))},e.prototype.warn=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.logger).warn.apply(e,[this.ephemeralId].concat(t))},e.prototype.error=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.logger).error.apply(e,[this.ephemeralId].concat(t))},e.prototype.setId=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ephemeralId=e.map(function(e){return"["+e+"]"}).join(" ")},e.prototype.enabledFor=function(e){return this.logger.enabledFor(e)},e}(),yR=((cR={})[M.DEBUG.value]=0,cR[M.INFO.value]=1,cR[M.TIME.value]=1,cR[M.WARN.value]=3,cR[M.ERROR.value]=4,cR),gR=((dR={})[0]=M.DEBUG,dR[1]=M.INFO,dR[2]=M.INFO,dR[3]=M.WARN,dR[4]=M.ERROR,dR),vR=Dt.EventEmitter,SR=function(){function e(){var i=this;this.eventEmitter=new vR,this.onJSLog=function(e,t){var n=t.name?"["+t.name+"] ":"";n+=Array.prototype.slice.call(e).join(" ");var r=yR[t.level.value];i.eventEmitter.emitSync("log",r,n)},M.setHandler(this.onJSLog)}return e.prototype.onLog=function(e){this.eventEmitter.on("log",e)},e.prototype.offLog=function(e){this.eventEmitter.off("log",e)},e.prototype.setLevel=function(e){M.setLevel(gR[e])},e.prototype.getLevel=function(){return yR[M.getLevel().value]},e}(),bR={platformConsole:new(function(){function e(e){void 0===e&&(e=console),this.webConsole=e}return e.prototype.log=function(e,t){switch(e){case 0:this.webConsole.debug(t);break;case 1:this.webConsole.info(t);break;case 2:this.webConsole.warn(t);break;case 3:this.webConsole.error(t)}},e}())},TR=((pR={})[0]=0,pR[1]=1,pR[2]=1,pR[3]=2,pR[4]=3,pR),PR=function(){function e(e){void 0===e&&(e=0),this.logLevel=e}return e.prototype.setLevel=function(e){this.logLevel=e},e.prototype.getLevel=function(){return this.logLevel},e.prototype.write=function(e,t){if(!(e<this.logLevel)){var n=TR[e];bR.platformConsole.log(n,t)}},e}(),wR=((fR={})[0]=0,fR[1]=1,fR[2]=3,fR[3]=4,fR),CR=Dt.EventEmitter,MR=function(){function e(){var r=this;this.eventEmitter=new CR,this.onPlatformLog=function(e){var t=wR[e.level],n=(e.timestamp?e.timestamp:"")+" ["+e.logger+"] "+e.message;r.eventEmitter.emitSync("log",t,n)},bR&&bR.platformLogsManager&&(this.logsManager=bR.platformLogsManager,this.logsManager.onLog(this.onPlatformLog)),this.currentLevel=0}return e.prototype.setLevel=function(e){this.currentLevel=e,this.logsManager&&this.logsManager.configureLogLevel(TR[e])},e.prototype.getLevel=function(){return this.currentLevel},e.prototype.onLog=function(e){this.eventEmitter.on("log",e)},e.prototype.offLog=function(e){this.eventEmitter.off("log",e)},e}(),IR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LogRouter=hR,t.EphemeralJSLogger=mR,t.JSLoggerLogSource=SR,t.PlatformLogSink=PR,t.PlatformLogSource=MR});e(IR);IR.LogRouter,IR.EphemeralJSLogger,IR.JSLoggerLogSource,IR.PlatformLogSink,IR.PlatformLogSource;var ER=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.getReportingServiceUrlFromMarketplaceId=function(e){var t;switch(e){case cw.MarketplaceID.ROW_NA:case cw.MarketplaceID.US:t="api.us-east-1";break;case cw.MarketplaceID.ROE_EU:case cw.MarketplaceID.ROW_EU:case cw.MarketplaceID.UK:case cw.MarketplaceID.DE:t="api.eu-west-1";break;case cw.MarketplaceID.ROW_FE:case cw.MarketplaceID.JP:t="api.us-west-2";break;default:throw new Error("Can't get ReportingServiceUrl for unknown MarketplaceId! Received: "+e)}return"https://"+t+".aiv-delivery.net"},e.SCHEMA_VERSION="AV20180601",e.UNRETRIABLE_HTTP_ERROR_CODES=[400,404,410],e}();t.MediaEventConstants=n});e(ER);ER.MediaEventConstants;var _R=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="/Bootstrap/"+ER.MediaEventConstants.SCHEMA_VERSION,r=function(){function e(e,t){this.retry=null,this.request=null,this.url=e.replace(/\/$/,"")+n,this.authContext=t}return e.prototype.send=function(e,t){var i=this;this.retry=(new Op.ExponentialBackoffRetry).withMaxAttempts(4).withInitialIntervalMs(500).withExponentialFactor(2).withRandomizationFactor(200).onSuccess(e).onError(t).onAttempt(function(e,t,n,r){i.sendRequest(e,t,n,r)}).execute()},e.prototype.abort=function(){null!==this.retry&&(this.retry.abort(),this.retry=null),null!==this.request&&(this.request.abort(),this.request=null)},e.prototype.sendRequest=function(e,r,i,n){var o=this;this.request=mp.HttpRequest.get(this.url).headers(this.authContext.getHeaders()).accept("application/json").timeout(6e3).onError(function(e,t){null!=t&&F.contains(ER.MediaEventConstants.UNRETRIABLE_HTTP_ERROR_CODES,t.getStatus())?n(e):r(e)}).onLoad(function(e){o.request=null;var t,n=e.getText();try{t=JSON.parse(n)}catch(e){return void r(new Error("JSON parsing error in bootstrapping response."))}i(t)}),this.request.send()},e}();t.BootstrappingRequest=r});e(_R);_R.BootstrappingRequest;var xR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.request=null,this.requestPromise=null,this.url=e,this.authContext=t,this.configuration=null}return e.prototype.getBootstrappingConfiguration=function(){return null==this.requestPromise&&this.sendRequest(),this.requestPromise},e.prototype.sendRequest=function(){var n=this;this.request=new _R.BootstrappingRequest(this.url,this.authContext),this.requestPromise=new Fe.Promise(function(t,e){n.request.send(function(e){n.onSuccess(e),t(n.configuration)},function(e){n.onFail(e),t(n.configuration)})})},e.prototype.onSuccess=function(e){this.configuration=e,this.request=null},e.prototype.onFail=function(e){this.configuration={appInstanceId:fh.UUID.v4(),batching:{period:3e4,depth:300},events:{},retry:{modifier:1.5,max:3e5,jitter:5e3}},this.request=null},e}();t.Bootstrapper=n});e(xR);xR.Bootstrapper;var kR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e=Date),this.dateConstructor=e,this.performanceRef=void 0===t&&"undefined"!=typeof performance?performance:t}return e.prototype.getHighResRelativeTimeMs=function(){return void 0===this.performanceRef?(new this.dateConstructor).getTime():this.performanceRef.now()},e}();t.TimeProvider=n});e(kR);kR.TimeProvider;var RR=t(function(e,t){var l=V&&V.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("MediaEventReporter"),r="/Events/"+ER.MediaEventConstants.SCHEMA_VERSION,n=function(){function e(){var r=this;this.bootstrapper=null,this.bootstrappingConfiguration=null,this.dispatchInterval=null,this.getContextualMediaEvents=function(){return[]},this.dispatchMediaEvents=function(){F.isEmpty(r.mediaEvents)||null==r.bootstrappingConfiguration||r.sendRetriableRequest(r.bootstrappingConfiguration,function(e){try{var t=e.getText(),n=JSON.parse(t);F.extend(r.bootstrappingConfiguration,n),r.eventEmitter.emit("bootstrappingConfigurationFetched",r.bootstrappingConfiguration),null!=r.dispatchInterval&&r.startDispatchInterval()}catch(e){u.error("Error occurred when updating bootstrapping configuration: "+e)}},function(e){u.error("An error occurred while reporting media events: "+e)})},this.eventEmitter=new Dt.EventEmitter,this.timeProvider=new kR.TimeProvider,this.timer=A.timer,this.masterSequence=0,this.mediaEvents=[],this.pendingMediaEvents=[]}return e.prototype.initialize=function(e,t){var n=this;this.url=e.replace(/\/$/,"")+r,this.authContext=t,this.bootstrapper=new xR.Bootstrapper(e,this.authContext),this.bootstrapper.getBootstrappingConfiguration().then(function(e){n.bootstrappingConfiguration=e,u.info("Media Event Reporting App Instance ID: "+n.bootstrappingConfiguration.appInstanceId),n.eventEmitter.emit("bootstrappingConfigurationFetched",e),n.enqueueMediaEvents(n.pendingMediaEvents),n.pendingMediaEvents=[],n.startDispatchInterval()})},e.prototype.prepare=function(e){this.getContextualMediaEvents=e,null!=this.bootstrappingConfiguration&&null==this.dispatchInterval&&this.startDispatchInterval()},e.prototype.stop=function(){this.dispatchMediaEvents(),null!=this.dispatchInterval&&(this.timer.clearInterval(this.dispatchInterval),this.dispatchInterval=null)},e.prototype.enqueueMediaEvents=function(e){if(null!=this.bootstrappingConfiguration){for(var t=!1,n=0,r=0===this.mediaEvents.length?this.getContextualMediaEvents().concat(e):e;n<r.length;n++){var i=r[n],o=i._type,a=this.bootstrappingConfiguration.events[o];if(null==a||!1!==a.enabled){var s=l({enabled:!0,forceDispatch:!1},xt.withDefault(a,{}));t=t||s.forceDispatch,this.addMetadataToMediaEvent(i),this.mediaEvents.push(i)}}(null!=this.bootstrappingConfiguration&&this.mediaEvents.length>=this.bootstrappingConfiguration.batching.depth||t)&&this.dispatchMediaEvents()}else this.pendingMediaEvents=this.pendingMediaEvents.concat(e)},e.prototype.getAppInstanceId=function(){return xt.nestedValue(this.bootstrappingConfiguration,"appInstanceId",null)},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.addMetadataToMediaEvent=function(e){F.extend(e,{timestamp:Date.now(),reltime:Math.round(this.timeProvider.getHighResRelativeTimeMs()),sequence:this.masterSequence++})},e.prototype.sendRetriableRequest=function(e,t,n){var i=this,o=this.mediaEvents;this.mediaEvents=[],(new Op.ExponentialBackoffRetry).withInitialIntervalMs(e.batching.period).withExponentialFactor(e.retry.modifier).withMaxElapsedTimeMs(e.retry.max).withRandomizationFactor(e.retry.jitter).onSuccess(t).onError(n).onAttempt(function(e,t,n,r){o=o.concat(i.mediaEvents),i.mediaEvents=[],i.sendMediaEventReportingRequest(o,e,t,n,r)}).execute()},e.prototype.sendMediaEventReportingRequest=function(n,r,i,o,a){var s=this;null!=this.dispatchInterval&&this.timer.clearInterval(this.dispatchInterval),mp.HttpRequest.post(this.url).headers(this.authContext.getHeaders()).json({clientPublishTimestamp:Date.now(),clientPublishRelativeTime:Math.round(this.timeProvider.getHighResRelativeTimeMs()),appInstanceId:this.bootstrappingConfiguration.appInstanceId,events:n}).onLoad(function(e){if(null!=s.dispatchInterval&&s.startDispatchInterval(),u.enabledFor(M.DEBUG)){var t=n.map(function(e){return e.sequence+" ("+e._type+")"}).join(", ");u.info("Successfully sent events for "+s.bootstrappingConfiguration.appInstanceId+": "+t)}o(e)}).onError(function(e,t){null!=s.dispatchInterval&&s.startDispatchInterval(),null!=t&&F.contains(ER.MediaEventConstants.UNRETRIABLE_HTTP_ERROR_CODES,t.getStatus())?a(e):(u.error("Request attempt #"+r+" to report media events has failed: "+e),i(e))}).send()},e.prototype.startDispatchInterval=function(){null!=this.dispatchInterval&&this.timer.clearInterval(this.dispatchInterval),this.dispatchInterval=this.timer.setInterval(this.dispatchMediaEvents,this.bootstrappingConfiguration.batching.period)},e}();t.MediaEventReporter=n});e(RR);RR.MediaEventReporter;var AR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.validate=function(e,t){if(null!=e&&null!=t)for(var n=t,r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];null!=e[o]&&("object"!=typeof e[o]||Array.isArray(e[o])?"string"!=typeof e[o]&&"number"!=typeof e[o]&&!Array.isArray(e[o])||null==n[o]||(e[o]=n[o].constrain(e[o])):this.validate(e[o],n[o]))}},e}();t.ValidationUtils=n});e(AR);AR.ValidationUtils;var OR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e=Number.MIN_VALUE),void 0===t&&(t=Number.MAX_VALUE),this.minValue=e,this.maxValue=t}return e.prototype.constrain=function(e){return this.minValue>this.maxValue?e:e>this.maxValue?this.maxValue:e<this.minValue?this.minValue:e},e}();t.NumberValidator=n});e(OR);OR.NumberValidator;var LR=t(function(e,t){var r,n,o=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});function a(e){return e<0?Math.ceil(e):Math.floor(e)}var s=((n={})[0]=a,n[1]=function(e){return Math.floor(e)},n[2]=function(e){return Math.ceil(e)},n[3]=function(e){return Math.round(e)},n),i=function(i){function e(e,t,n){void 0===e&&(e=-9007199254740991),void 0===t&&(t=9007199254740991),void 0===n&&(n=0);var r=i.call(this,a(e),a(t))||this;return r.round=s[n],r}return o(e,i),e.prototype.constrain=function(e){var t=this.round(e);return i.prototype.constrain.call(this,t)},e}(OR.NumberValidator);t.IntegerValidator=i});e(LR);LR.IntegerValidator;var FR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{volume:new LR.IntegerValidator(0,100)}};t.AudioEventValidatable=n});e(FR);FR.AudioEventValidatable;var DR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.maxLength=xt.withDefault(t,e)}return e.prototype.constrain=function(e){return e.substring(0,this.maxLength)},e}();t.StringValidator=n});e(DR);DR.StringValidator;var NR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={consumptionId:new DR.StringValidator(20,60),trackId:new DR.StringValidator(1,30),language:new DR.StringValidator(2,10)};t.AudioTrackValidatable=n});e(NR);NR.AudioTrackValidatable;var UR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{hardware:{classTypeId:new DR.StringValidator(15),manufacturer:new DR.StringValidator(40),modelName:new DR.StringValidator(50),chipset:new DR.StringValidator(40)},software:{application:{name:new DR.StringValidator(60),version:new DR.StringValidator(60)},operatingSystem:{name:new DR.StringValidator(30),version:new DR.StringValidator(50)},firmware:{name:new DR.StringValidator(100),version:new DR.StringValidator(100)},middleware:{name:new DR.StringValidator(60),version:new DR.StringValidator(60),userAgent:new DR.StringValidator(512)},runtime:{name:new DR.StringValidator(20),version:new DR.StringValidator(60)},browser:{name:new DR.StringValidator(60),version:new DR.StringValidator(60),userAgent:new DR.StringValidator(512)},scriptEngine:{name:new DR.StringValidator(20),version:new DR.StringValidator(60)},player:{name:new DR.StringValidator(20),version:new DR.StringValidator(60)},attributionTag:new DR.StringValidator(60)}}};t.DeviceEventValidatable=n});e(UR);UR.DeviceEventValidatable;var BR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{display:{width:new LR.IntegerValidator(0),height:new LR.IntegerValidator(0)},player:{width:new LR.IntegerValidator(0),height:new LR.IntegerValidator(0)},visible:{pixelsTotal:new LR.IntegerValidator(0),pixelsVisible:new LR.IntegerValidator(0)}}};t.DisplayEventValidatable=n});e(BR);BR.DisplayEventValidatable;var VR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{signal:{dbm:new LR.IntegerValidator(-500,0)}}};t.NetworkEventValidatable=n});e(VR);VR.NetworkEventValidatable;var jR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{treatment:new DR.StringValidator(1,200)}};t.PlayerHeuristicEventValidatable=n});e(jR);jR.PlayerHeuristicEventValidatable;var XR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{language:new DR.StringValidator(2,10)}};t.TimedTextEventValidatable=n});e(XR);XR.TimedTextEventValidatable;var zR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{track:{consumptionId:new DR.StringValidator(20,60)}}};t.TrackEventValidatable=n});e(zR);zR.TrackEventValidatable;var qR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{name:new DR.StringValidator(1,50),treatment:new DR.StringValidator(1,2)}};t.WeblabEventValidatable=n});e(qR);qR.WeblabEventValidatable;var WR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createDeviceEvent=function(e,t){var n={_type:"Device",body:{hardware:e,software:t}};return AR.ValidationUtils.validate(n,UR.DeviceEventValidatable),n},e.createNetworkEvent=function(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var o={_type:"Network",body:{category:{type:e,subtype:r},connected:t,active:n,signal:i}};return AR.ValidationUtils.validate(o,VR.NetworkEventValidatable),o},e.createDisplayEvent=function(e,t,n,r,i){void 0===i&&(i=null);var o={_type:"Display",body:{connected:e,display:t,mode:n,player:r,visible:i}};return AR.ValidationUtils.validate(o,BR.DisplayEventValidatable),o},e.createAudioEvent=function(e){var t={_type:"Audio",body:{volume:e}};return AR.ValidationUtils.validate(t,FR.AudioEventValidatable),t},e.createWeblabEvent=function(e,t){var n={_type:"Weblab",body:{name:e,treatment:t}};return AR.ValidationUtils.validate(n,qR.WeblabEventValidatable),n},e.createPlayerHeuristicEvent=function(e,t){var n={_type:"PlayerHeuristic",body:{platform:e,treatment:t}};return AR.ValidationUtils.validate(n,jR.PlayerHeuristicEventValidatable),n},e.createTimedTextEvent=function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=null);var i={_type:"TimedText",body:{enabled:e,language:t,textType:n,textSubtype:r}};return AR.ValidationUtils.validate(i,XR.TimedTextEventValidatable),i},e.createTrackEvent=function(e){var t={_type:"Track",body:{track:e}};return AR.ValidationUtils.validate(t,zR.TrackEventValidatable),t},e.createAudioTrack=function(e,t,n){void 0===n&&(n=null);var r={_type:"Audio",consumptionId:n,trackId:t,language:e};return AR.ValidationUtils.validate(r,NR.AudioTrackValidatable),r},e}();t.ContextualEventFactory=n});e(WR);WR.ContextualEventFactory;var HR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{asset:{consumptionId:new DR.StringValidator(20,60)},request:{bitrate:new LR.IntegerValidator(1),fragmentIndex:new LR.IntegerValidator(0),fragmentDuration:new LR.IntegerValidator(0),fragmentResolution:{width:new LR.IntegerValidator(0),height:new LR.IntegerValidator(0)},url:new DR.StringValidator(1e3),bytesExpected:new LR.IntegerValidator(0),server:{hostname:new DR.StringValidator(100),ipv4:new DR.StringValidator(7,15),ipv6:new DR.StringValidator(11,45)}},response:{responseCode:new LR.IntegerValidator(100,599),bytesAcquired:new LR.IntegerValidator(0)},performance:{timeToFirstByte:new LR.IntegerValidator(0),timeToLastByte:new LR.IntegerValidator(0)}}};t.AcquisitionEventValidatable=n});e(HR);HR.AcquisitionEventValidatable;var GR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createAcquisitionEvent=function(e,t,n,r,i,o){var a={_type:"Acquisition",body:{asset:{type:e,consumptionId:i,caching:o},request:t,response:n,performance:r}};return AR.ValidationUtils.validate(a,HR.AcquisitionEventValidatable),a},e}();t.AcquisitionEventFactory=n});e(GR);GR.AcquisitionEventFactory;var KR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{consumptionId:new DR.StringValidator(20,60)}};t.AdIdentifierEventValidatable=n});e(KR);KR.AdIdentifierEventValidatable;var QR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={sessionId:new DR.StringValidator(36,36),streamId:new DR.StringValidator(36,36)};t.NielsenAdIdentifierValidatable=n});e(QR);QR.NielsenAdIdentifierValidatable;var YR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createAdIdentifierEvent=function(e,t){var n={_type:"AdIdentifier",body:{consumptionId:e,adId:t}};return AR.ValidationUtils.validate(n,KR.AdIdentifierEventValidatable),n},e.createNielsenAdIdentifier=function(e,t){var n={_type:"Nielsen",sessionId:e,streamId:t};return AR.ValidationUtils.validate(n,QR.NielsenAdIdentifierValidatable),n},e}();t.AdIdentifierEventFactory=n});e(YR);YR.AdIdentifierEventFactory;var JR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{asset:{consumptionId:new DR.StringValidator(20,60)},update:{url:new DR.StringValidator(1e3),server:{hostname:new DR.StringValidator(100),ipv4:new DR.StringValidator(7,15),ipv6:new DR.StringValidator(11,45)},bitrate:new LR.IntegerValidator(1),roundtrip:new LR.IntegerValidator(1),bytes:{received:new LR.IntegerValidator(0)},packets:{received:new LR.IntegerValidator(0),lost:new LR.IntegerValidator(0),retransmitted:new LR.IntegerValidator(0)},frames:{received:new LR.IntegerValidator(0),damagedVideo:new LR.IntegerValidator(0),damagedAudio:new LR.IntegerValidator(0),divergentVideoTime:new LR.IntegerValidator(0),divergentAudioTime:new LR.IntegerValidator(0),decrypted:new LR.IntegerValidator(0)}}}};t.BitstreamEventValidatable=n});e(JR);JR.BitstreamEventValidatable;var $R=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createBitstreamEvent=function(e,t,n,r,i,o,a,s,l,u){var c={_type:"Bitstream",body:{asset:{consumptionId:t,types:e},update:{url:n,server:r,bitrate:i,roundtrip:o,bytes:a,packets:s,frames:l,errors:u}}};return AR.ValidationUtils.validate(c,JR.BitstreamEventValidatable),c},e}();t.BitstreamEventFactory=n});e($R);$R.BitstreamEventFactory;var ZR=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{label:new DR.StringValidator(20,60),value:new DR.StringValidator(0,200)}};t.DiagnosticEventValidatable=n});e(ZR);ZR.DiagnosticEventValidatable;var eA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createDiagnosticEvent=function(e,t,n){void 0===n&&(n=null);var r={_type:"Diagnostic",body:{label:e,value:n,state:t}};return AR.ValidationUtils.validate(r,ZR.DiagnosticEventValidatable),r},e}();t.DiagnosticEventFactory=n});e(eA);eA.DiagnosticEventFactory;var tA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.maxLength=xt.withDefault(n,t),this.elementValidator=e}return e.prototype.constrain=function(e){var t=this;return(null==this.maxLength?e:e.slice(0,this.maxLength)).map(function(e){return"object"==typeof e?(AR.ValidationUtils.validate(e,t.elementValidator),e):t.elementValidator.constrain(e)})},e}();t.ListValidator=n});e(tA);tA.ListValidator;var nA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{details:{message:{generic:new DR.StringValidator(50),specific:new DR.StringValidator(500)},stackTrace:new tA.ListValidator(new DR.StringValidator(300))}}};t.ErrorEventValidatable=n});e(nA);nA.ErrorEventValidatable;var rA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createErrorEvent=function(e,t,n,r,i){void 0===i&&(i=null);var o={_type:"Error",body:{context:{source:e,type:t},fatal:n,details:r,consumptionId:i}};return AR.ValidationUtils.validate(o,nA.ErrorEventValidatable),o},e.createErrorDetails=function(e){var t={message:{generic:e.name,specific:e.message},stackTrace:null};return xt.exists(e.stack)&&(t.stackTrace=e.stack.split("\n")),t},e}();t.ErrorEventFactory=n});e(rA);rA.ErrorEventFactory;var iA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{ruleId:new DR.StringValidator(1,36),fromConsumptionId:new DR.StringValidator(20,60),toConsumptionId:new DR.StringValidator(20,60)}};t.FailoverEventValidatable=n});e(iA);iA.FailoverEventValidatable;var oA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createFailoverEvent=function(e,t,n){var r={_type:"Failover",body:{ruleId:e,fromConsumptionId:t,toConsumptionId:n}};return AR.ValidationUtils.validate(r,iA.FailoverEventValidatable),r},e}();t.FailoverEventFactory=n});e(oA);oA.FailoverEventFactory;var aA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{coordinates:new DR.StringValidator(8,18)}};t.GeoLocationEventValidatable=n});e(aA);aA.GeoLocationEventValidatable;var sA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createGeoLocationEvent=function(e){var t={_type:"GeoLocation",body:{coordinates:e}};return AR.ValidationUtils.validate(t,aA.GeoLocationEventValidatable),t},e}();t.GeoLocationEventFactory=n});e(sA);sA.GeoLocationEventFactory;var lA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{targetDeviceId:new DR.StringValidator(60),sourceDeviceId:new DR.StringValidator(60)}};t.InteractionEventValidatable=n});e(lA);lA.InteractionEventValidatable;var uA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createInteractionEvent=function(e,t,n,r,i,o,a){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null);var s={_type:"Interaction",body:{context:{source:e,type:t,input:n,cause:r,navigation:i},targetDeviceId:o,sourceDeviceId:a}};return AR.ValidationUtils.validate(s,lA.InteractionEventValidatable),s},e}();t.InteractionEventFactory=n});e(uA);uA.InteractionEventFactory;var cA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createInterfaceEvent=function(e,t,n){return{_type:"Interface",body:{state:e,source:t,component:n}}},e}();t.InterfaceEventFactory=n});e(cA);cA.InterfaceEventFactory;var dA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={timeAvailable:new LR.IntegerValidator(0),timeCapacity:new LR.IntegerValidator(1),bytesAvailable:new LR.IntegerValidator(0),bytesCapacity:new LR.IntegerValidator(1)},r={body:{playhead:new LR.IntegerValidator(0),consumptionId:new DR.StringValidator(20,60),buffers:{front:new tA.ListValidator(n),back:new tA.ListValidator(n),renderer:new tA.ListValidator(n)},livehead:new LR.IntegerValidator(1),clientId:new DR.StringValidator(36,36),droppedFrames:new LR.IntegerValidator(0),averageFrameRate:new OR.NumberValidator(0)}};t.PlaybackEventValidatable=r});e(dA);dA.PlaybackEventValidatable;var pA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createPlaybackEvent=function(e,t,n,r,i,o,a,s,l,u){void 0===l&&(l=null),void 0===u&&(u=null);var c={_type:"Playback",body:{action:t,playhead:n,consumptionId:e,contentContext:r,buffers:{front:i,back:o,renderer:null},livehead:l,clientId:u,droppedFrames:a,averageFrameRate:s}};return AR.ValidationUtils.validate(c,dA.PlaybackEventValidatable),c},e}();t.PlaybackEventFactory=n});e(pA);pA.PlaybackEventFactory;var fA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{scale:new LR.IntegerValidator(2),score:new LR.IntegerValidator(0)}};t.RatingEventValidatable=n});e(fA);fA.RatingEventValidatable;var hA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createRatingEvent=function(e,t,n){var r={_type:"Rating",body:{type:e,scale:t,score:n}};return AR.ValidationUtils.validate(r,fA.RatingEventValidatable),r},e}();t.RatingEventFactory=n});e(hA);hA.RatingEventFactory;var mA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={body:{remoteDeviceId:new DR.StringValidator(60)}};t.RemoteEventValidatable=n});e(mA);mA.RemoteEventValidatable;var yA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.createRemoteEvent=function(e,t,n){var r={_type:"Remote",body:{action:e,transport:t,remoteDeviceId:n}};return AR.ValidationUtils.validate(r,mA.RemoteEventValidatable),r},e}();t.RemoteEventFactory=n});e(yA);yA.RemoteEventFactory;var gA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaEventConstants=ER.MediaEventConstants,t.MediaEventReporter=RR.MediaEventReporter,t.ContextualEventFactory=WR.ContextualEventFactory,t.AcquisitionEventFactory=GR.AcquisitionEventFactory,t.AdIdentifierEventFactory=YR.AdIdentifierEventFactory,t.BitstreamEventFactory=$R.BitstreamEventFactory,t.DiagnosticEventFactory=eA.DiagnosticEventFactory,t.ErrorEventFactory=rA.ErrorEventFactory,t.FailoverEventFactory=oA.FailoverEventFactory,t.GeoLocationEventFactory=sA.GeoLocationEventFactory,t.InteractionEventFactory=uA.InteractionEventFactory,t.InterfaceEventFactory=cA.InterfaceEventFactory,t.PlaybackEventFactory=pA.PlaybackEventFactory,t.RatingEventFactory=hA.RatingEventFactory,t.RemoteEventFactory=yA.RemoteEventFactory});e(gA);gA.MediaEventConstants,gA.MediaEventReporter,gA.ContextualEventFactory,gA.AcquisitionEventFactory,gA.AdIdentifierEventFactory,gA.BitstreamEventFactory,gA.DiagnosticEventFactory,gA.ErrorEventFactory,gA.FailoverEventFactory,gA.GeoLocationEventFactory,gA.InteractionEventFactory,gA.InterfaceEventFactory,gA.PlaybackEventFactory,gA.RatingEventFactory,gA.RemoteEventFactory;var vA=function(){function e(){}return e.MAX_FRONT_BUFFER_MS=12e4,e.MIN_FRONT_BUFFER_MS=1e4,e.MAX_BACK_BUFFER_MS=32e3,e}(),SA=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.B=0]="B",r[r.KB=1]="KB",r[r.MB=2]="MB",r[r.GB=3]="GB",r[r.TB=4]="TB",r[r.KiB=5]="KiB",r[r.MiB=6]="MiB",r[r.GiB=7]="GiB",r[r.TiB=8]="TiB",r[r.bit=9]="bit",r[r.Kibit=10]="Kibit",r[r.Mibit=11]="Mibit",r[r.Gibit=12]="Gibit",r[r.Tibit=13]="Tibit",t.MemoryUnits=n;var i={};i[n.B]={nominator:1,denominator:1},i[n.KB]={nominator:1e3,denominator:1},i[n.MB]={nominator:Math.pow(1e3,2),denominator:1},i[n.GB]={nominator:Math.pow(1e3,3),denominator:1},i[n.TB]={nominator:Math.pow(1e3,4),denominator:1},i[n.KiB]={nominator:1024,denominator:1},i[n.MiB]={nominator:Math.pow(1024,2),denominator:1},i[n.GiB]={nominator:Math.pow(1024,3),denominator:1},i[n.TiB]={nominator:Math.pow(1024,4),denominator:1},i[n.bit]={nominator:1,denominator:8},i[n.Kibit]={nominator:1024,denominator:8},i[n.Mibit]={nominator:Math.pow(1024,2),denominator:8},i[n.Gibit]={nominator:Math.pow(1024,3),denominator:8},i[n.Tibit]={nominator:Math.pow(1024,4),denominator:8};var o=function(){function r(e,t){this.size=e,this.units=t}return r.prototype.toUnits=function(e){var t=i[this.units],n=i[e];return new r(this.size*(t.nominator*n.denominator)/(t.denominator*n.nominator),e)},r}();t.MemorySize=o});e(SA);SA.MemoryUnits,SA.MemorySize;var bA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("PlayerPrioritizationSystem"),n=function(){function e(e){var t=this;this.absolutePlaylistItems=[],this.onPlaylistUpdated=function(){t.absolutePlaylistItems=t.getAbsolutePlaylistItems()},this.playlistEngine=e,this.playlistEngine.on("PlaylistUpdate",this.onPlaylistUpdated)}return e.prototype.getDistanceFromPlayhead=function(e,t){var n=this.getAbsoluteCurrentPosition();return null==n?1/0:this.getAbsolutePosition(e,t)-n},e.prototype.getPriority=function(e,t){var n=this.getAbsoluteCurrentPosition();if(null==n)return 1/0;var r=this.getAbsolutePosition(e,t);return r-n+t.durationMs<-6e3?1/0:r},e.prototype.getAbsoluteCurrentPosition=function(){var e=this.playlistEngine.getCurrentItemIndex(),t=this.playlistEngine.getCurrentPosition();if(null==e||e>=this.absolutePlaylistItems.length||null==t)return i.error("Unable to retrieve current position."),null;var n=this.absolutePlaylistItems[e];return n.absoluteStartMs+(t-n.item.start)},e.prototype.getAbsolutePosition=function(n,r){var e=F.find(this.absolutePlaylistItems,function(e){var t=r.startTimeMs+e.item.contentTimeToPlaylistTimeOffsetMs;return e.item.contentSource===n&&e.item.start<=t&&(null==e.item.end||e.item.end>=t)});if(null!=e){var t=e.item.start-e.item.contentTimeToPlaylistTimeOffsetMs;return e.absoluteStartMs+(r.startTimeMs-t)}if(null!=(e=F.find(this.absolutePlaylistItems,function(e){var t=r.endTimeMs+e.item.contentTimeToPlaylistTimeOffsetMs;return e.item.contentSource===n&&e.item.start<=t&&(null==e.item.end||e.item.end>=t)}))){t=e.item.start-e.item.contentTimeToPlaylistTimeOffsetMs;return Math.max(0,e.absoluteStartMs+(r.startTimeMs-t))}return i.error("Couldn't find Playlist Item for position "+JSON.stringify(r)),1/0},e.prototype.getAbsolutePlaylistItems=function(){for(var e=[],t=0,n=0,r=this.playlistEngine.getItems();n<r.length;n++){var i=r[n],o=(null!=i.end?i.end:1/0)-i.start;e.push({item:i,absoluteStartMs:t,absoluteEndMs:t+o}),t+=o}return e},e}();t.PlayerPrioritizationSystem=n});e(bA);bA.PlayerPrioritizationSystem;var TA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerPrioritizationSystem=bA.PlayerPrioritizationSystem});e(TA);TA.PlayerPrioritizationSystem;var PA=pp.Diagnostics,wA=TA.PlayerPrioritizationSystem,CA=SA.MemoryUnits,MA=M.get("PlayerBufferManager"),IA=function(){function e(e,t){var n=this;if(this.diagnostics=PA.create("PlayerBufferManager"),this.errorState={},this.onPlaylistUpdated=function(){var e=n.playlistEngine.getItems().filter(function(e){return null!=e.contentSource}).map(function(e){return e.contentSource}),t=F.unique(e);n.compareContentSourcesMaps(n.sources,t)},this.onContentSourceAdded=function(e){MA.info("ContentSource added"),n.sources.push(e)},this.onContentSourceRemoved=function(e){MA.info("ContentSource removed");var t=n.sources.indexOf(e);-1!==t&&n.sources.splice(t,1),e.flush()},this.availableBytes=e.memorySize.toUnits(CA.B).size,this.availableBytes<=0)throw new Error("Expected this.availableBytes ["+this.availableBytes+"] > 0");this.maxAvailableBytes=this.availableBytes,this.playlistEngine=t,this.sources=[],this.playlistEngine.on("PlaylistUpdate",this.onPlaylistUpdated),this.allocated=[],this.playerPrioritizationSystem=new wA(this.playlistEngine),this.pendingReservations=[],this.maxAllowedBps=8*this.availableBytes/(vA.MIN_FRONT_BUFFER_MS/1e3),MA.info("PlayerBufferManager was initialized with bufferSize: "+this.availableBytes+", max allowed bitrate is "+this.maxAllowedBps)}return e.prototype.reserve=function(e){if(e.sizeBytes<=0){var t=new Error("Expected request.sizeBytes ["+e.sizeBytes+"] > 0");throw this.emitState(t),t}var n=e.getPriority();return n===1/0?(A.timer.setImmediate(function(){null!=e.onRetry&&e.onRetry.retry(!0)}),{fulfilled:!1}):this.availableBytes>=e.sizeBytes?this.fulfillRequest(e):this.tryDeallocate(e)?this.fulfillRequest(e):(null!=e.onRetry&&(this.pendingReservations.push({getPriority:e.getPriority,cachedPriority:n,requestedSizeBytes:e.sizeBytes,cancelToken:e.onRetry.cancelToken,retry:e.onRetry.retry}),this.emitState()),{fulfilled:!1})},e.prototype.getMaxAllowedBps=function(){return this.maxAllowedBps},e.prototype.getPlayerPrioritizationSystem=function(){return this.playerPrioritizationSystem},e.prototype.onPosition=function(e){if(0!==this.pendingReservations.length){var t=this.pendingReservations.length,n=this.allocated.length;if(this.pendingReservations=this.pendingReservations.filter(function(e){e.cachedPriority=e.getPriority();var t=!e.cancelToken.requested&&isFinite(e.cachedPriority);return t||e.retry(!0),t}),0<this.pendingReservations.length)for(var r=this.pendingReservations.slice().sort(function(e,t){return e.cachedPriority-t.cachedPriority});0<r.length;){var i=r[0];if(!(this.availableBytes>=i.requestedSizeBytes||this.tryDeallocateBackBuffer(i.requestedSizeBytes)))break;r.shift();var o=this.pendingReservations.indexOf(i);-1!==o&&this.pendingReservations.splice(o,1),i.retry(!1)}this.pendingReservations.length===t&&this.allocated.length===n||this.emitState()}},e.prototype.fulfillRequest=function(e){var t=this;return this.availableBytes-=e.sizeBytes,this.allocated.push(e),this.emitState(),{fulfilled:!0,onFreed:function(){return t.onFreed(e)}}},e.prototype.onFreed=function(e){var t=this.allocated.indexOf(e);-1!==t&&(this.allocated.splice(t,1),this.availableBytes+=e.sizeBytes)},e.prototype.tryDeallocate=function(e){var t=e.sizeBytes;return!!this.tryDeallocateBackBuffer(t)||this.tryDeallocateFrontBuffer(t,e.getPriority())},e.prototype.tryDeallocateBackBuffer=function(e){for(var t=this.allocated.map(function(e){return{request:e,priority:e.getPriority()}}).filter(function(e){return e.priority===1/0}).sort(function(e,t){return e.request.position-t.request.position});0<t.length;){var n=t.shift();if(this.flushAllocation(n.request),this.availableBytes>=e)return!0}return!1},e.prototype.tryDeallocateFrontBuffer=function(e,t){for(var n=this.allocated.map(function(e){return{request:e,priority:e.getPriority()}}).filter(function(e){return isFinite(e.priority)&&e.priority>t+vA.MIN_FRONT_BUFFER_MS}).sort(function(e,t){return e.priority-t.priority}).reverse();0<n.length;){var r=n.shift();if(this.flushAllocation(r.request),this.availableBytes>=e)return!0}return!1},e.prototype.flushAllocation=function(e){e.flush()||(MA.warn("Flush call failed, releasing the request to sync with available buffer"),this.onFreed(e))},e.prototype.compareContentSourcesMaps=function(t,n){n.filter(function(e){return!F.contains(t,e)}).forEach(this.onContentSourceAdded),t.filter(function(e){return!F.contains(n,e)}).forEach(this.onContentSourceRemoved)},e.prototype.emitState=function(e){var t=Date.now();null!=e&&(this.errorState.lastThrownError=e,this.errorState.lastThrownErrorTimestamp=t);for(var n={maxPosition:-1/0,minPosition:1/0,allocatedBytes:0},r=0,i=this.allocated;r<i.length;r++){var o=i[r];n.maxPosition=Math.max(o.position,n.maxPosition),n.minPosition=Math.min(o.position,n.minPosition),n.allocatedBytes=o.sizeBytes+n.allocatedBytes}var a={allocated:n,availableBytes:this.availableBytes,maxAllowedBps:this.maxAllowedBps,pendingReservations:this.pendingReservations.map(function(e){return{cachedPriority:e.cachedPriority,requestedSizeBytes:e.requestedSizeBytes}}),timestamp:t};null!=this.errorState.lastThrownError&&(a.lastThrownError=this.errorState.lastThrownError,a.lastThrownErrorTimestamp=this.errorState.lastThrownErrorTimestamp),this.diagnostics.report("state",a)},e.prototype.getMaxAvailableBytes=function(){return this.maxAvailableBytes},e}(),EA=SA.MemorySize,_A=SA.MemoryUnits,xA={BufferConstants:vA,MemorySize:EA,MemoryUnits:_A,PlayerBufferManager:IA},kA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=Object.keys({EnterView:null,ExitView:null}),n=function(){function e(e,t){var n=this;this.isViewItem=function(e){return null!==e&&F.isMatch(e,n.id)},this.currentItem=null,this.onEnterItem=function(e){n.isViewItem(e.item)&&!n.isViewItem(n.currentItem)?n.eventEmitter.emit("EnterView"):!n.isViewItem(e.item)&&n.isViewItem(n.currentItem)&&n.eventEmitter.emit("ExitView"),n.currentItem=e.item},this.playlistEngine=e,this.id=t,this.eventEmitter=new Dt.EventEmitter}return e.prototype.isActive=function(){return this.isViewItem(this.playlistEngine.getCurrentItem())},e.prototype.createItem=function(e){return F.extend({},this.id,e)},e.prototype.appendItem=function(){for(var e,t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var i=n.map(function(e){return F.extend(e,t.id)});(e=this.playlistEngine).appendItem.apply(e,i)},e.prototype.getItems=function(){return this.playlistEngine.getItems().filter(this.isViewItem)},e.prototype.awaitItems=function(e){this.playlistEngine.onMatch(this.isViewItem,e)},e.prototype.on=function(e,t){0===this.getTotalEventEmitterListenerCount()&&(this.currentItem=this.playlistEngine.getCurrentItem(),this.playlistEngine.on("EnterItem",this.onEnterItem)),this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t),0===this.getTotalEventEmitterListenerCount()&&this.playlistEngine.off("EnterItem",this.onEnterItem)},e.prototype.getTotalEventEmitterListenerCount=function(){for(var e=0,t=0,n=i;t<n.length;t++){var r=n[t];e+=this.eventEmitter.listeners(r).length}return e},e.prototype.createViewRangeError=function(e){for(var t=[],n=0,r=this.playlistEngine.getItems();n<r.length;n++){var i=r[n];this.isViewItem(i)&&t.push({start:i.start,end:i.end})}return new Error("Position "+e+" not in View: "+JSON.stringify(t))},e}();t.View=n});e(kA);kA.View;var RA=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.fromView=function(e,t){return new n(e.playlistEngine,F.extend({},e.id,t))},n.prototype.update=function(e,t,n){this.playlistEngine.update(this.getItemIndex(e),e,this.getItemIndex(t),t,n)},n.prototype.splice=function(e,t,n){this.playlistEngine.splice(this.getItemIndex(e),e,this.getItemIndex(t),t,n)},n.prototype.getItemIndex=function(e){for(var t=this.playlistEngine.getItems(),n=0;n<t.length;n++){var r=t[n];if(this.isViewItem(r)&&(r.start<=e&&(null===r.end||e<=r.end)))return n}throw this.createViewRangeError(e)},n}(kA.View);t.PlaylistRelativeView=n});e(RA);RA.PlaylistRelativeView;var AA=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return i(n,e),n.fromView=function(e,t){return new n(e.playlistEngine,F.extend({},e.id,t))},n.prototype.update=function(e,t,n){var r=this.getItemLocation(e),i=this.getItemLocation(t);this.playlistEngine.update(r.index,r.position,i.index,i.position,n)},n.prototype.splice=function(e,t,n){var r=this.getItemLocation(e),i=this.getItemLocation(t);this.playlistEngine.splice(r.index,r.position,i.index,i.position,n)},n.prototype.getItemLocation=function(e){for(var t=this.playlistEngine.getItems(),n=0,r=0;r<t.length;r++){var i=t[r];if(this.isViewItem(i)){var o=void 0;o=null===i.end?1/0:i.end-i.start;var a=e-n;if(0<=a&&a<=o)return{index:r,position:i.start+a};n+=o}}throw this.createViewRangeError(e)},n}(kA.View);t.ItemRelativeView=n});e(AA);AA.ItemRelativeView;var OA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.items=[]}return e.prototype.getItems=function(){return this.items},e.prototype.appendItem=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.items).push.apply(e,t)},e.prototype.split=function(e,t,n,r,i){for(var o=this.splitsies(e,t,n,r),a=o.fromIndex,s=o.toIndex,l=a;l<=s;l++)F.extend(this.items[l],i)},e.prototype.splice=function(e,t,n,r,i){var o,a=this.splitsies(e,t,n,r),s=a.fromIndex,l=a.toIndex,u=0;s===l&&t===r||(u=l-s+1),(o=this.items).splice.apply(o,[s,u].concat(i))},e.prototype.removeAllItems=function(){var e=this.items;return this.items=[],e},e.prototype.splitsies=function(e,t,n,r){var i,o,a=this.splitItemAt(this.items[e],t);return(i=this.items).splice.apply(i,[e,1].concat(a)),this.items[e].start!==t&&e++,n+=a.length-1,a=this.splitItemAt(this.items[n],r),(o=this.items).splice.apply(o,[n,1].concat(a)),this.items[n].start===r&&n--,{fromIndex:e,toIndex:n}},e.prototype.splitItemAt=function(e,t){return isFinite(t)&&e.start<t&&(null===e.end||t<e.end)?[F.extend({},e,{end:t}),F.extend({},e,{start:t})]:[e]},e}();t.Playlist=n});e(OA);OA.Playlist;var LA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("PlaylistEngine"),n=function(){function e(){this.deferredExecutors=[],this.playlist=new OA.Playlist,this.currentItemIndex=null,this.currentPosition=null,this.isPlaylistEnded=!1,this.seekInterceptors=[],this.onPositionInterceptors=[],this.autoplayBarriers=[],this.diagnostics=pp.Diagnostics.create("PlaylistEngine"),this.state={currentItemIndex:null,currentPosition:null,isPlaylistEnded:!1,itemCount:this.getItems().length,timestamp:Date.now()},this.eventEmitter=new Dt.EventEmitter,this.eventEmitter.setMaxListeners(1e3)}return e.prototype.getItems=function(){return this.playlist.getItems()},e.prototype.getCurrentItem=function(){return null===this.currentItemIndex?null:this.playlist.getItems()[this.currentItemIndex]},e.prototype.getCurrentPosition=function(){return this.currentPosition},e.prototype.getCurrentItemIndex=function(){return this.currentItemIndex},e.prototype.registerSeekInterceptor=function(e){this.seekInterceptors.push(e)},e.prototype.deregisterSeekInterceptor=function(t){this.seekInterceptors=this.seekInterceptors.filter(function(e){return e!==t})},e.prototype.registerOnPositionInterceptor=function(e){this.onPositionInterceptors.push(e)},e.prototype.deregisterOnPositionInterceptor=function(t){this.onPositionInterceptors=this.onPositionInterceptors.filter(function(e){return e!==t})},e.prototype.registerAutoplayBarrier=function(e){this.autoplayBarriers.push(e)},e.prototype.appendItem=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.playlist).appendItem.apply(e,t),this.checkDeferredExecutors(),this.emitIdempotent("PlaylistUpdate"),this.reportDiagnostics()},e.prototype.removeAllItems=function(){var e=this.playlist.removeAllItems();return this.currentItemIndex=null,this.currentPosition=null,0<e.length&&(this.checkDeferredExecutors(),this.emitIdempotent("PlaylistUpdate")),this.reportDiagnostics(),e},e.prototype.update=function(e,t,n,r,i){null!==this.currentItemIndex&&null!==this.currentPosition&&(this.currentItemIndex+=this.calculatePrePlayheadItemIncrease(e,t,n,r)),this.playlist.split(e,t,n,r,i),this.checkDeferredExecutors(),this.emitIdempotent("PlaylistUpdate"),null!==this.currentItemIndex&&null!==this.currentPosition&&(null==this.getCurrentItem()&&s.warn(">>> update: No current PlaylistItem of Playlist:",this.stringifyCurrentPlaylistItems()),this.emit("EnterItem",{item:this.getCurrentItem(),position:this.currentPosition})),this.reportDiagnostics()},e.prototype.splice=function(e,t,n,r,i){if(null!==this.currentItemIndex&&null!==this.currentPosition&&e<=this.currentItemIndex&&this.currentItemIndex<=n&&t<=this.currentPosition&&this.currentPosition<=r){var o=new Error("Invalid splice over current position");throw this.reportDiagnostics(o),o}null!==this.currentItemIndex&&null!==this.currentPosition&&(this.currentItemIndex+=this.calculatePrePlayheadItemIncrease(e,t,n,r),this.isBeforeCurrentLocation(n,r)&&(this.currentItemIndex+=i.length,this.currentItemIndex-=this.calculateDeleteCount(e,t,n,r))),this.playlist.splice(e,t,n,r,i),this.checkDeferredExecutors(),this.emitIdempotent("PlaylistUpdate"),null!==this.currentItemIndex&&null!==this.currentPosition&&(null==this.getCurrentItem()&&s.warn(">>> splice: No current PlaylistItem of Playlist:",this.stringifyCurrentPlaylistItems()),this.emit("EnterItem",{item:this.getCurrentItem(),position:this.currentPosition})),this.reportDiagnostics()},e.prototype.onMatch=function(e,t){var n=this.playlist.getItems().filter(e);0<n.length?t(n):this.deferredExecutors.push({matcher:e,executor:t})},e.prototype.seek=function(e,t){if(s.info(">> seek with position "+e+" and playlistItemIndex "+t),null==t){if(null===this.currentItemIndex){var n=new Error("Invalid seek without a playlistItemIndex");throw this.reportDiagnostics(n),n}t=this.currentItemIndex}var r=this.playlist.getItems()[t];null!=r.start&&e<r.start?e=r.start:null!=r.end&&e>r.end&&(e=r.end);for(var i=0,o=this.seekInterceptors;i<o.length;i++){var a=o[i].getNewSeekTarget(e,t);if(null===a)return;e=a.newPosition,t=a.newItemIndex}this.internalSeek(e,t)},e.prototype.internalSeek=function(e,t){if(s.info(">> internalSeek with position "+e+" and playlistItemIndex "+t),this.isPlaylistEnded=!1,this.currentPosition=e,t!==this.currentItemIndex){var n=this.getItems()[this.currentItemIndex=t];null==n&&s.warn(">>> internalSeek: No current PlaylistItem of Playlist:",this.stringifyCurrentPlaylistItems()),this.eventEmitter.emitSync("EnterItem",{item:n,position:e})}this.eventEmitter.emitSync("Seek",e),this.reportDiagnostics()},e.prototype.onPosition=function(e){if(null===this.currentItemIndex){var t=new Error("Invalid position change without a playlistItemIndex");throw this.reportDiagnostics(t),t}for(var n=e,r=this.currentItemIndex,i=0,o=this.onPositionInterceptors;i<o.length;i++){var a=o[i].getNewPositionTarget(e);if(null===a)return;"number"==typeof a?e=a:(e=a.newPosition,r=a.newItemIndex)}if(r===this.currentItemIndex&&e===n){this.currentPosition=e;var s=this.getItems(),l=s[this.currentItemIndex];if(null!==l.end&&this.currentPosition>=l.end&&!this.isPlaylistEnded){var u=s.length-1;if(this.currentItemIndex+1>u)return this.currentPosition=l.end,this.isPlaylistEnded=!0,this.eventEmitter.emitSync("PlaylistEnd"),void this.reportDiagnostics();if(!this.canAutoplayBetween(l,s[this.currentItemIndex+1]))return this.currentPosition=l.end,this.isPlaylistEnded=!0,this.eventEmitter.emitSync("PlaylistEnd"),void this.reportDiagnostics();this.currentItemIndex++,l=s[this.currentItemIndex],this.currentPosition=l.start,this.eventEmitter.emitSync("EnterItem",{item:l,position:0})}this.reportDiagnostics()}else this.internalSeek(e,r)},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.emit=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];(t=this.eventEmitter).emit.apply(t,[e].concat(n))},e.prototype.emitIdempotent=function(e){this.eventEmitter.emitIdempotent(e)},e.prototype.checkDeferredExecutors=function(){var e=this.deferredExecutors;this.deferredExecutors=[];for(var t=0,n=e;t<n.length;t++){var r=n[t];this.onMatch(r.matcher,r.executor)}},e.prototype.calculatePrePlayheadItemIncrease=function(e,t,n,r){if(null===this.currentItemIndex||null===this.currentPosition)return 0;var i=0,o=this.playlist.getItems(),a=o[e];this.isBeforeCurrentLocation(e,t)&&a.start<t&&t<a.end&&i++;var s=o[n];return this.isBeforeCurrentLocation(n,r)&&s.start<r&&r<s.end&&i++,e===n&&t===r&&2===i&&i--,i},e.prototype.calculateDeleteCount=function(e,t,n,r){if(null===this.currentItemIndex||null===this.currentPosition)return 0;if(e===n&&t===r)return 0;if(n===e)return 1;var i=n-e-1,o=this.playlist.getItems();return o[e].end!==t&&i++,o[n].start!==r&&i++,i},e.prototype.isBeforeCurrentLocation=function(e,t){return null!==this.currentItemIndex&&null!==this.currentPosition&&(e<this.currentItemIndex||this.currentItemIndex===e&&t<this.currentPosition)},e.prototype.canAutoplayBetween=function(t,n){return this.autoplayBarriers.every(function(e){return e.canAutoplayBetween(t,n)})},e.prototype.reportDiagnostics=function(e){this.state.currentItemIndex=this.currentItemIndex,this.state.currentPosition=this.currentPosition,this.state.isPlaylistEnded=this.isPlaylistEnded,this.state.itemCount=this.getItems().length;var t=Date.now();this.state.timestamp=t,null!=e&&(this.state.lastThrownError=e,this.state.lastThrownErrorTimestamp=t),this.diagnostics.report("state",this.state)},e.prototype.stringifyCurrentPlaylistItems=function(){return JSON.stringify(this.playlist.getItems().map(function(e){return{start:e.start,end:e.end}}))},e.prototype.tracePlaylistItems=function(e){if(M.enabledFor(M.INFO)){var t=this.getItems();if(0===t.length)return;for(var n=new QI.TableFormatterGeneric,r=0,i=e(t);r<i.length;r++){var o=i[r];n.addRow(o)}s.info("Playlist updated, items:\n"+n.renderString())}},e}();t.PlaylistEngine=n});e(LA);LA.PlaylistEngine;var FA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistRelativeView=RA.PlaylistRelativeView,t.ItemRelativeView=AA.ItemRelativeView,t.PlaylistEngine=LA.PlaylistEngine,t.View=kA.View});e(FA);FA.PlaylistRelativeView,FA.ItemRelativeView,FA.PlaylistEngine,FA.View;var DA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={backoffBaseMs:100,backoffMaxMs:5e3,backoffModifier:2,jitterMs:60},n=function(){function e(){this.documentRef=document,this.browser=Xh.getBrowser(),this.createIframes()}return e.prototype.send=function(e,t){var n=this;void 0===t&&(t=r),null!=this.beaconFrame?this.fireBeacons(e,t):this.createIframes(function(){n.fireBeacons(e,t)})},e.prototype.createIframes=function(r){var i=this;null==this.beaconFrame?(this.beaconFrame=this.documentRef.createElement("iframe"),this.beaconFrame.style.display="none",this.beaconFrame.onload=function(){var e=i.beaconFrame.contentWindow.document.createElement("meta");e.name="referrer",e.content="no-referrer",i.beaconFrame.contentWindow.document.head.appendChild(e);var t=i.beaconFrame.contentWindow.document.createElement("script");t.text="window.addEventListener('message', function(e) { document.getElementById('post-frame').contentWindow.postMessage(e.data, '*'); });",i.beaconFrame.contentWindow.document.body.appendChild(t);var n=i.beaconFrame.contentWindow.document.createElement("iframe");n.id="post-frame",n.srcdoc="<!DOCTYPE html><html><head><title>x</title></head><body></body></html>",n.onload=function(){var e=n.contentWindow.document.createElement("script");e.text="function sendRequest(e,t){var a=new XMLHttpRequest;a.open(e.method,e.url,!0),a.setRequestHeader(\"Content-Type\",\"application/json\"),t>=e.backoffMax||(a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE&&(500===a.status||503===a.status)){var n=0;n=0===t?e.backoffBase:Math.min(e.backoffMax,t*e.backoffModifier),sendRequest(e,n)}},setTimeout(function(){a.send(e.data)},t+e.jitterMs))}window.addEventListener(\"message\",function(e){var t=JSON.parse(e.data);sendRequest(t,0)});",n.contentWindow.document.body.appendChild(e),null!=r&&r()},i.beaconFrame.contentWindow.document.body.appendChild(n)},this.documentRef.body.appendChild(this.beaconFrame)):null!=r&&r()},e.prototype.fireBeacons=function(e,t){for(var n=this,r=function(e){"POST"===e.method?i.beaconFrame.contentWindow.postMessage(JSON.stringify({method:e.method,data:e.data,url:e.url,jitterMs:t.jitterMs,backoffBase:t.backoffBaseMs,backoffMax:t.backoffMaxMs,backoffModifier:t.backoffModifier}),"*"):A.timer.setTimeout(function(){n.beaconFrame.contentWindow.document.createElement("img").src=e.url},t.jitterMs)},i=this,o=0,a=e;o<a.length;o++){r(a[o])}},e.prototype.sendAuditPing=function(e,t,n,r){var i,o=!1,a=function(e){o||(A.timer.clearTimeout(i),o=!0,n(e))},s=document.createElement("img");s.onload=function(){o||(A.timer.clearTimeout(i),o=!0,t())},s.onerror=function(){return a(new Error("Image tag raised an error event"))},i=A.timer.setTimeout(function(){return a(new Error("Timed out waiting for image tag"))},5e3),s.src=e},e}();t.BeaconServiceClientWeb=n});e(DA);DA.BeaconServiceClientWeb;var NA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BeaconServiceClient=DA.BeaconServiceClientWeb});e(NA);NA.BeaconServiceClient;var UA=t(function(e,t){function a(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n],o="["+i+"]";e=e.replace(o,t[i]).replace(encodeURIComponent(o),t[i])}return e}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.beaconServiceClient=new NA.BeaconServiceClient,this.enableEventReporting=!0}return e.prototype.toggleReporting=function(e){this.enableEventReporting=e},e.prototype.send=function(e,t,n){if(void 0===t&&(t={}),this.enableEventReporting){for(var r=0,i=e;r<i.length;r++){var o=i[r];o.url=a(o.url,t)}this.beaconServiceClient.send(e,n)}},e}();t.AdEventReporter=n});e(UA);UA.AdEventReporter;var BA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.AllCodes=["xp.unknown","xp.content.no_rights.anonymizer_ip","xp.content.no_rights.download_limit_exceeded","xp.content.no_rights.hd_content_not_allowed","xp.content.no_rights.invalid_geo_ip","xp.content.no_rights.no_available_streams","xp.content.no_rights.not_accepted_terms_and_conditions","xp.content.no_rights.not_owned","xp.content.no_rights.pv_lower_tier_device_not_permitted_access","xp.content.no_rights.unknown","xp.content.concurrency_limit","xp.content.service.null_response","xp.content.service.parse","xp.content.service.unknown","xp.network.ipv6_unsupported_marketplace","xp.system.display_disconnected","xp.system.hdcp_insufficient","xp.system.unsupported_cdm_version"]});e(BA);BA.AllCodes;var VA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.CodeTree={xp:{unknown:"xp.unknown",content:{no_rights:{anonymizer_ip:"xp.content.no_rights.anonymizer_ip",download_limit_exceeded:"xp.content.no_rights.download_limit_exceeded",hd_content_not_allowed:"xp.content.no_rights.hd_content_not_allowed",invalid_geo_ip:"xp.content.no_rights.invalid_geo_ip",no_available_streams:"xp.content.no_rights.no_available_streams",not_accepted_terms_and_conditions:"xp.content.no_rights.not_accepted_terms_and_conditions",not_owned:"xp.content.no_rights.not_owned",pv_lower_tier_device_not_permitted_access:"xp.content.no_rights.pv_lower_tier_device_not_permitted_access",unknown:"xp.content.no_rights.unknown"},concurrency_limit:"xp.content.concurrency_limit",service:{null_response:"xp.content.service.null_response",parse:"xp.content.service.parse",unknown:"xp.content.service.unknown"}},network:{ipv6_unsupported_marketplace:"xp.network.ipv6_unsupported_marketplace"},system:{display_disconnected:"xp.system.display_disconnected",hdcp_insufficient:"xp.system.hdcp_insufficient",unsupported_cdm_version:"xp.system.unsupported_cdm_version"}}}});e(VA);VA.CodeTree;var jA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.allCodes=BA.AllCodes,t.codes=VA.CodeTree});e(jA);jA.allCodes,jA.codes;var XA=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var i=((n={})["prs.hd_content_not_allowed"]=jA.codes.xp.content.no_rights.hd_content_not_allowed,n["prs.unsupported_cdm_version"]=jA.codes.xp.system.unsupported_cdm_version,n["prs.no_rights.anonymizer_ip"]=jA.codes.xp.content.no_rights.anonymizer_ip,n["prs.no_rights.download_limit_exceeded"]=jA.codes.xp.content.no_rights.download_limit_exceeded,n["prs.no_rights.invalid_geo_ip"]=jA.codes.xp.content.no_rights.invalid_geo_ip,n["prs.no_rights.no_available_streams"]=jA.codes.xp.content.no_rights.no_available_streams,n["prs.no_rights.not_accepted_terms"]=jA.codes.xp.content.no_rights.not_accepted_terms_and_conditions,n["prs.no_rights.not_owned"]=jA.codes.xp.content.no_rights.not_owned,n["prs.no_rights.pv_lower_tier_device_not_permitted_access"]=jA.codes.xp.content.no_rights.pv_lower_tier_device_not_permitted_access,n["prs.no_rights"]=jA.codes.xp.content.no_rights.unknown,n),r=function(){function e(){}return e.convertCode=function(e){if(e instanceof Ne.XpError){if(F.contains(jA.allCodes,e.code))return e;for(var t=0,n=Object.keys(i);t<n.length;t++){var r=n[t];if(-1!==e.code.indexOf(r))return new Ne.XpError(i[r])}}return new Ne.XpError(jA.codes.xp.unknown,void 0,void 0,void 0,e)},e}();t.InternalToExternalCodeConverter=r});e(XA);XA.InternalToExternalCodeConverter;var zA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="(\\d|[1-9]\\d|1\\d\\d|2([0-4]\\d|5[0-5]))",r=new RegExp("^"+n+"\\."+n+"\\."+n+"\\."+n+"$"),i=function(){function e(){}return e.isValidIPv4Address=function(e){return r.test(e)},e}();t.IPAddress=i});e(zA);zA.IPAddress;var qA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="x-server-ip",r=function(){function e(){}return e.createEdgeServer=function(e,t){return{hostname:new ME.URL(e).hostname,ipv4:null!=t&&null!=t[n]&&zA.IPAddress.isValidIPv4Address(t[n])?t[n]:null,ipv6:null}},e}();t.EdgeServerBuilder=r});e(qA);qA.EdgeServerBuilder;var WA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.consumptionId=null,this.titleId=null,this.hasPlaybackInitiated=!1,this.onPlaybackStateChange=function(e){"playing"===e.playbackState&&(n.hasPlaybackInitiated=!0,n.mpPlayer.off("playbackStateChange",n.onPlaybackStateChange))},this.mediaEventReporter=e,this.mpPlayer=t,this.mpPlayer.on("playbackStateChange",this.onPlaybackStateChange)}return e.prototype.unload=function(){this.consumptionId=null,this.titleId=null,this.hasPlaybackInitiated=!1,this.mpPlayer.off("playbackStateChange",this.onPlaybackStateChange),this.mpPlayer.on("playbackStateChange",this.onPlaybackStateChange)},e.prototype.updateConsumptionId=function(e){this.consumptionId=e},e.prototype.updateTitleId=function(e){this.titleId=e},e.prototype.reportFragmentAcquisitionSuccess=function(e){var t=gA.AcquisitionEventFactory.createAcquisitionEvent(e.type,this.createFragmentAcquisitionRequest(e),this.createAcquisitionResponse(!0,e.status,e.totalBytes,e.headers),this.createAcquisitionPerformance(e.latencyMs,e.totalMs),e.consumptionId,this.getCaching(e.titleId));this.mediaEventReporter.enqueueMediaEvents([t])},e.prototype.reportFragmentAcquisitionFailure=function(e){var t=gA.AcquisitionEventFactory.createAcquisitionEvent(e.type,this.createFragmentAcquisitionRequest(e),this.createAcquisitionResponse(!1,xt.withDefault(e.status,null),xt.withDefault(e.totalBytes,0),xt.withDefault(e.headers,{}),e.acquisitionError),this.createAcquisitionPerformance(xt.withDefault(e.latencyMs,0),xt.withDefault(e.totalMs,0)),e.consumptionId,this.getCaching(e.titleId));this.mediaEventReporter.enqueueMediaEvents([t])},e.prototype.reportLicenseAcquisitionSuccess=function(e){var t=gA.AcquisitionEventFactory.createAcquisitionEvent("DRMLicense",this.createNonFragmentAcquisitionRequest(e.url,e.headers),this.createAcquisitionResponse(!0,e.status,e.totalBytes,e.headers),this.createAcquisitionPerformance(e.latencyMs,e.latencyMs+e.downloadTimeMs),e.consumptionId,this.getCaching(e.titleId));this.mediaEventReporter.enqueueMediaEvents([t])},e.prototype.reportLicenseAcquisitionFailure=function(e){var t=gA.AcquisitionEventFactory.createAcquisitionEvent("DRMLicense",this.createNonFragmentAcquisitionRequest(e.url,e.headers),this.createAcquisitionResponse(!1,xt.withDefault(e.status,null),xt.withDefault(e.totalBytes,0),xt.withDefault(e.headers,{})),this.createAcquisitionPerformance(xt.withDefault(e.latencyMs,0),xt.withDefault(e.latencyMs,0)+xt.withDefault(e.downloadTimeMs,0)),e.consumptionId,this.getCaching(e.titleId));this.mediaEventReporter.enqueueMediaEvents([t])},e.prototype.reportManifestAcquisitionSuccess=function(e){var t=gA.AcquisitionEventFactory.createAcquisitionEvent("Manifest",this.createNonFragmentAcquisitionRequest(e.sourceUrl.url,e.headers),this.createAcquisitionResponse(!0,e.status,e.totalBytes,e.headers),this.createAcquisitionPerformance(e.timing.latencyMs,e.timing.totalMs),e.consumptionId,this.getCaching(e.titleId));this.mediaEventReporter.enqueueMediaEvents([t])},e.prototype.reportManifestAcquisitionFailure=function(e){var t=xt.nestedValue(e.error.reason,"headers",{}),n=gA.AcquisitionEventFactory.createAcquisitionEvent("Manifest",this.createNonFragmentAcquisitionRequest(e.sourceUrl.url,t),this.createAcquisitionResponse(!1,xt.nestedValue(e.error.reason,"statusCode",null),0,t,e.error),this.createAcquisitionPerformance(xt.nestedValue(e.error.reason,"timing.latencyMs",0),xt.nestedValue(e.error.reason,"timing.totalMs",0)),e.consumptionId,this.getCaching(e.titleId));this.mediaEventReporter.enqueueMediaEvents([n])},e.prototype.reportTimedTextAcquisitionSuccess=function(e){var t=gA.AcquisitionEventFactory.createAcquisitionEvent("TimedText",this.createNonFragmentAcquisitionRequest(e.url,e.headers),this.createAcquisitionResponse(!0,e.status,e.totalBytes,e.headers),this.createAcquisitionPerformance(e.latencyMs,e.totalMs),xt.withDefault(this.consumptionId,""),!this.hasPlaybackInitiated);this.mediaEventReporter.enqueueMediaEvents([t])},e.prototype.reportTimedTextAcquisitionFailure=function(e){var t=gA.AcquisitionEventFactory.createAcquisitionEvent("TimedText",this.createNonFragmentAcquisitionRequest(e.url,e.headers),this.createAcquisitionResponse(!1,xt.withDefault(e.status,null),xt.withDefault(e.totalBytes,0),xt.withDefault(e.headers,{})),this.createAcquisitionPerformance(xt.withDefault(e.latencyMs,0),xt.withDefault(e.totalMs,0)),xt.withDefault(this.consumptionId,""),!this.hasPlaybackInitiated);this.mediaEventReporter.enqueueMediaEvents([t])},e.prototype.getCaching=function(e){return!(this.hasPlaybackInitiated&&this.titleId===e)},e.prototype.createFragmentAcquisitionRequest=function(e){return{bitrate:e.bitrateBps,fragment:!0,fragmentDuration:null!=e.fragmentDurationMs?e.fragmentDurationMs:null,fragmentIndex:xt.withDefault(e.fragmentIndex,null),fragmentResolution:null!=e.fragmentResolution?e.fragmentResolution:null,url:e.url,bytesExpected:e.expectedBytes,server:qA.EdgeServerBuilder.createEdgeServer(e.url,e.headers)}},e.prototype.createNonFragmentAcquisitionRequest=function(e,t){return{bitrate:null,fragment:!1,fragmentDuration:null,fragmentIndex:null,fragmentResolution:null,url:e,bytesExpected:null,server:qA.EdgeServerBuilder.createEdgeServer(e,t)}},e.prototype.createAcquisitionResponse=function(e,t,n,r,i){var o="Success";return e||(o=null!=i&&"Timeout"===i.reason.type?"NetworkTimeout":"UnknownError"),{response:o,responseCode:t,bytesAcquired:n,headers:this.convertHeaderValueFromStringToArray(r)}},e.prototype.createAcquisitionPerformance=function(e,t){return{timeToFirstByte:Math.round(e),timeToLastByte:Math.round(t)}},e.prototype.convertHeaderValueFromStringToArray=function(e){for(var t={},n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t[i]=[e[i]]}return t},e}();t.AcquisitionMediaEventController=n});e(WA);WA.AcquisitionMediaEventController;var HA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.auditPingStreamId=null,this.consumptionId=null,this.mediaEventReporter=e,this.playerSessionId=t}return e.prototype.updateAuditPingStreamId=function(e){this.auditPingStreamId=e,this.reportAdIdentifierEvent()},e.prototype.updateConsumptionId=function(e){this.consumptionId=e,this.reportAdIdentifierEvent()},e.prototype.reportAdIdentifierEvent=function(){if(null!=this.auditPingStreamId&&null!=this.consumptionId){var e=gA.AdIdentifierEventFactory.createNielsenAdIdentifier(this.playerSessionId,this.auditPingStreamId),t=gA.AdIdentifierEventFactory.createAdIdentifierEvent(this.consumptionId,e);this.mediaEventReporter.enqueueMediaEvents([t])}},e}();t.AdIdentifierMediaEventController=n});e(HA);HA.AdIdentifierMediaEventController;var GA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("BitstreamMediaEventController"),n=function(){function e(e){var n=this;this.bitstreamUpdateIntervalMs=5e3,this.bitstreamUpdateId=null,this.consumptionId=null,this.audioDropoutMillis=0,this.videoDivergenceMillis=0,this.numDamagedAudioFrames=0,this.numDamagedVideoFrames=0,this.numDecryptedFrames=0,this.numReceivedFrames=0,this.onBootstrappingConfigurationFetched=function(e){var t=xt.nestedValue(e.events.Bitstream,"period");null!=t&&t!==n.bitstreamUpdateIntervalMs&&(n.bitstreamUpdateIntervalMs=t,null!=n.bitstreamUpdateId&&n.startBitstreamUpdateInterval(!0))},this.mediaEventReporter=e}return e.prototype.initialize=function(){this.mediaEventReporter.on("bootstrappingConfigurationFetched",this.onBootstrappingConfigurationFetched)},e.prototype.uninitialize=function(){this.unload(),this.mediaEventReporter.off("bootstrappingConfigurationFetched",this.onBootstrappingConfigurationFetched)},e.prototype.unload=function(){this.stopBitstreamUpdateInterval(),this.clearLastKnownStatistics()},e.prototype.setBitstreamSource=function(e){this.bitstreamSource=e,this.startBitstreamUpdateInterval()},e.prototype.updateConsumptionId=function(e){this.consumptionId=e},e.prototype.startBitstreamUpdateInterval=function(e){var t=this;void 0===e&&(e=!1),(null==this.bitstreamUpdateId||e)&&(null!=this.bitstreamUpdateId&&A.timer.clearInterval(this.bitstreamUpdateId),this.bitstreamUpdateId=A.timer.setInterval(function(){t.reportBitstream()},this.bitstreamUpdateIntervalMs))},e.prototype.stopBitstreamUpdateInterval=function(){null!=this.bitstreamUpdateId&&(A.timer.clearInterval(this.bitstreamUpdateId),this.bitstreamUpdateId=null)},e.prototype.reportBitstream=function(){if(null!=this.consumptionId)if(null!=this.bitstreamSource){var e=this.bitstreamSource.getStatistics();if(null!=e){var t=this.bitstreamSource.sourceUrlStore.get().url,n=gA.BitstreamEventFactory.createBitstreamEvent(["Video","Audio","TimedText"],this.consumptionId,t,qA.EdgeServerBuilder.createEdgeServer(t),e.totalBitsPerSecond,e.currentRoundtripMillis,{received:0},{received:0,lost:0,retransmitted:0},this.createBitstreamFrames(e),[]);this.updateLastKnownStatistics(e),this.mediaEventReporter.enqueueMediaEvents([n])}}else r.warn("Attempted to report a Bitstream event without a source");else r.warn("Attempted to report a Bitstream event without a consumptionId")},e.prototype.createBitstreamFrames=function(e){return{received:e.numReceivedFrames-this.numReceivedFrames,damagedVideo:e.numDamagedVideoFrames-this.numDamagedVideoFrames,damagedAudio:e.numDamagedAudioFrames-this.numDamagedAudioFrames,decrypted:e.numDecryptedFrames-this.numDecryptedFrames,divergentVideoTime:e.videoDivergenceMillis-this.videoDivergenceMillis,divergentAudioTime:e.audioDropoutMillis-this.audioDropoutMillis}},e.prototype.updateLastKnownStatistics=function(e){this.numReceivedFrames=e.numReceivedFrames,this.numDamagedVideoFrames=e.numDamagedVideoFrames,this.numDamagedAudioFrames=e.numDamagedAudioFrames,this.numDecryptedFrames=e.numDecryptedFrames,this.videoDivergenceMillis=e.videoDivergenceMillis,this.audioDropoutMillis=e.audioDropoutMillis},e.prototype.clearLastKnownStatistics=function(){this.numReceivedFrames=0,this.numDamagedVideoFrames=0,this.numDamagedAudioFrames=0,this.numDecryptedFrames=0,this.videoDivergenceMillis=0,this.audioDropoutMillis=0},e}();t.BitstreamMediaEventController=n});e(GA);GA.BitstreamMediaEventController;var KA={FunctionThrottler:function(){function e(){this.timer=A.timer}return e.prototype.throttle=function(n,r){var i=null,o=null,a=null,s=0,l=function(){s=F.now(),i=null,n.apply(o,a),xt.isNullOrUndefined(i)&&(a=o=null)},u=this;return function(){var e=F.now(),t=r-(e-s);o=u,a=arguments,t<=0||r<t?(i&&(u.timer.clearTimeout(i),i=null),s=e,n.apply(o,a),xt.isNullOrUndefined(i)&&(a=o=null)):xt.isNullOrUndefined(i)&&(i=u.timer.setTimeout(l,t))}},e}()},QA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={ethernet:"Ethernet",wifi:"WiFi",cellular:"Cellular"},n="Unknown",i=(M.get("ContextualMediaEventController"),function(){function e(e,t,n,r,i){var o=this;this.displayMode="Fullscreen",this.volume=null,this.volumeFeature=null,this.playbackSettingsId=null,this.getContextualMediaEvents=function(){var e=[];return e.push(gA.ContextualEventFactory.createDeviceEvent(o.hardware,o.software)),e.push(o.createNetworkEvent()),e.push(o.createDisplayEvent()),e.push.apply(e,o.createWeblabEvents()),null!=o.volume&&e.push(gA.ContextualEventFactory.createAudioEvent(o.volume)),e.push(gA.ContextualEventFactory.createPlayerHeuristicEvent("Miyagi",o.playbackSettingsId)),e},this.onDisplayChanged=function(e){o.mediaEventReporter.enqueueMediaEvents([o.createDisplayEvent()])},this.onApplicationViewportChanged=function(e){o.mediaEventReporter.enqueueMediaEvents([o.createDisplayEvent()])},this.onNetworkChanged=function(e){o.mediaEventReporter.enqueueMediaEvents([o.createNetworkEvent()])},this.mediaEventReporter=e,this.applicationIdentity=r,this.clientIdentity=i;var a=Yh.deviceInformation;this.hardware=this.mergeHardware(a.hardware,t),this.software=this.mergeSoftware(a.software),null!=n&&(this.volumeFeature=n,this.volume=this.normalizeVolume(n.volume));var s=new KA.FunctionThrottler;this.throttledUpdateVolume=s.throttle(function(){o.updateVolume()},1e4)}return e.prototype.initialize=function(){this.mediaEventReporter.prepare(this.getContextualMediaEvents);var e=Yh.deviceCapabilities;e.on("output.video.display",this.onDisplayChanged),e.on("output.video.applicationViewport",this.onApplicationViewportChanged),e.on("network",this.onNetworkChanged),null!=this.volumeFeature&&this.volumeFeature.onChange(this.throttledUpdateVolume)},e.prototype.setDisplayMode=function(e){var t=this.displayMode;this.displayMode=e,this.displayMode!==t&&this.mediaEventReporter.enqueueMediaEvents([this.createDisplayEvent()])},e.prototype.uninitialize=function(){var e=Yh.deviceCapabilities;e.off("output.video.display",this.onDisplayChanged),e.off("output.video.applicationViewport",this.onApplicationViewportChanged),e.off("network",this.onNetworkChanged),null!=this.volumeFeature&&this.volumeFeature.offChange(this.throttledUpdateVolume)},e.prototype.updatePlaybackSettingsId=function(e){if(e!==this.playbackSettingsId){this.playbackSettingsId=e;var t=gA.ContextualEventFactory.createPlayerHeuristicEvent("Miyagi",this.playbackSettingsId);this.mediaEventReporter.enqueueMediaEvents([t])}},e.prototype.mergeHardware=function(e,t){return{classTypeId:t,manufacturer:xt.withDefault(e.manufacturer,""),modelName:xt.nestedValue(e,"model.name"),chipset:xt.withDefault(e.chipset,null)}},e.prototype.mergeSoftware=function(e){var t;return t=null!=this.clientIdentity?{name:this.clientIdentity.name,version:xt.withDefault(this.clientIdentity.version,n)}:null!=e.nativeRuntime?{name:e.nativeRuntime.name,version:e.nativeRuntime.version}:null,{application:null!=this.applicationIdentity?{name:this.applicationIdentity.name,version:xt.withDefault(this.applicationIdentity.version,n)}:null!=e.nativeApplication?{name:xt.withDefault(e.nativeApplication.name,n),version:xt.withDefault(e.nativeApplication.version,n)}:{name:n,version:n},operatingSystem:{name:e.operatingSystem.name,version:xt.withDefault(e.operatingSystem.version,n)},firmware:null!=e.firmware?{name:xt.withDefault(e.firmware.name,null),version:e.firmware.version}:null,middleware:null!=e.middleware?{name:e.middleware.name,version:e.middleware.version,userAgent:xt.withDefault(e.middleware.userAgent,null)}:null,runtime:t,browser:null!=e.browser?{name:e.browser.name,version:e.browser.version,userAgent:e.browser.userAgent}:null,scriptEngine:null!=e.scriptEngine?{name:e.scriptEngine.name,version:e.scriptEngine.version}:null,player:{name:"XP Player",version:xt.nestedValue(e.playerBundle,"version",n)},attributionTag:null}},e.prototype.createNetworkEvent=function(){var e=Yh.deviceCapabilities.network,t=xt.withDefault(r[e.type],"Unknown"),n=null;return null!=e.signal&&"dbm"===e.signal.units&&(n={dbm:e.signal.strength}),gA.ContextualEventFactory.createNetworkEvent(t,!0,!0,null,n)},e.prototype.createDisplayEvent=function(){var e=Yh.deviceCapabilities,t=e.output.video.display,n=e.output.video.applicationViewport;return gA.ContextualEventFactory.createDisplayEvent(!0,{height:t.height,width:t.width},this.displayMode,n)},e.prototype.createWeblabEvents=function(){if(null==up.configurationStore.configuration||null==up.configurationStore.configuration.weblabs)return[];for(var e=up.configurationStore.configuration.weblabs,t=[],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t.push(gA.ContextualEventFactory.createWeblabEvent(i,e[i]))}return t},e.prototype.updateVolume=function(){var e=this.normalizeVolume(this.volumeFeature.volume);if(this.volume!==e){this.volume=e;var t=gA.ContextualEventFactory.createAudioEvent(this.volume);this.mediaEventReporter.enqueueMediaEvents([t])}},e.prototype.normalizeVolume=function(e){return Math.round(100*e)},e}());t.ContextualMediaEventController=i});e(QA);QA.ContextualMediaEventController;var YA=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.SYE_FALLBACK_ERROR_CODES=["sye"]});e(YA);YA.SYE_FALLBACK_ERROR_CODES;var JA=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var u=[jA.codes.xp.content.concurrency_limit,jA.codes.xp.system.display_disconnected,jA.codes.xp.system.hdcp_insufficient,"prs.no_rights","prs.unsupported_cdm_version","prs.hd_content_not_allowed"].concat(YA.SYE_FALLBACK_ERROR_CODES),i=((n={})[jA.codes.xp.system.display_disconnected]={errorSource:"Player",errorType:"DRM"},n[jA.codes.xp.system.hdcp_insufficient]={errorSource:"Player",errorType:"DRM"},n),r=M.get("ErrorMediaEventController"),o=function(){function e(e,t){var r=this;this.consumptionId=null,this.onFatalError=function(e){r.reportError(!0,e)},this.onNonFatalError=function(e){r.reportError(!1,e)},this.onContentStateChange=function(){if("error"===r.mpPlayer.contentState&&null!=r.mpPlayer.contentError){var e=r.mpPlayer.contentError,t=null;if(e instanceof Ne.XpError){var n=e.code;null==(t=i[n])&&0===n.indexOf("drm.")&&(t={errorSource:"Player",errorType:"DRM"})}null!=t?r.reportError(!0,e,t.errorSource,t.errorType):r.reportError(!0,e)}},this.mediaEventReporter=e,this.mpPlayer=t}return e.prototype.initialize=function(){var t=this;this.mpPlayer.on("error",this.onFatalError),this.mpPlayer.on("nonfatalError",this.onNonFatalError),this.mpPlayer.on("contentStateChange",this.onContentStateChange),vh.platformRuntime.onUncaughtException(function(e){r.error("PlatformRuntime.UncaughtException:",e),MT.metrics.putMetric("PlatformRuntime.UncaughtException"),t.reportError(!1,Ne.XpError.generatePrefixedError(e,"platform_uncaught"))})},e.prototype.uninitialize=function(){this.mpPlayer.off("error",this.onFatalError),this.mpPlayer.off("nonfatalError",this.onNonFatalError),this.mpPlayer.off("contentStateChange",this.onContentStateChange)},e.prototype.unload=function(){this.consumptionId=null},e.prototype.reportError=function(e,t,n,r){var i=gA.ErrorEventFactory.createErrorDetails(t);if(t instanceof Ne.XpError)for(var o=0,a=u;o<a.length;o++){var s=a[o];-1!==t.code.indexOf(s)&&(e=!1)}e&&(MT.metrics.putMetric("FatalError"),MT.metrics.flush());var l=gA.ErrorEventFactory.createErrorEvent(xt.withDefault(n,"Player"),xt.withDefault(r,"Unknown"),e,i,this.consumptionId);this.mediaEventReporter.enqueueMediaEvents([l])},e.prototype.updateConsumptionId=function(e){this.consumptionId=e},e}();t.ErrorMediaEventController=o});e(JA);JA.ErrorMediaEventController;var $A=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var m=M.get("PlaybackMediaEventController"),n=function(){function e(e,t){var n=this;this.playbackUpdateIntervalMs=1e4,this.playbackUpdateId=null,this.droppedFramesReported=0,this.contentState=null,this.playbackState=null,this.hasLoadedContent=!1,this.frontBufferTimeCapacityMs=xA.BufferConstants.MAX_FRONT_BUFFER_MS,this.backBufferTimeCapacityMs=xA.BufferConstants.MAX_BACK_BUFFER_MS,this.consumptionId=null,this.utcMsAtZero=null,this.playbackContentContext="Feature",this.clientId=null,this.lastKnownPlayheadMs=null,this.lastPlaybackActionReported=null,this.isOpen=!1,this.isStarted=!1,this.onContentStateChange=function(e){if(n.contentState!==e){switch(e){case"ready":n.hasLoadedContent||(n.hasLoadedContent=!0,n.reportAction("ReadyToWatch")),"playing"===n.playbackState&&n.reportAction("Start");break;case"waiting":case"error":"ready"===n.contentState&&"playing"===n.playbackState&&n.reportAction("Stop")}"unloaded"===e&&(n.hasLoadedContent=!1,n.droppedFramesReported=0,n.lastPlaybackActionReported=null),n.contentState=e}},this.onPlaybackStateChange=function(e){var t=e.playbackState;if(n.playbackState!==t&&(n.playbackState=t,"ready"===n.contentState))switch(null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.mediaEventReporting&&!0===up.configurationStore.configuration.mediaEventReporting.reportPlatformTriggeredPause&&!0===e.platformTriggered&&n.reportInteraction("PlayerSDK","Pause","Forced","Platform"),t){case"playing":n.reportAction("Start");break;case"paused":n.reportAction("Stop");break;default:return}},this.onTimeupdate=function(e){n.lastKnownPlayheadMs=e.positionMs},this.onContentEnded=function(e){n.lastKnownPlayheadMs=e},this.onBootstrappingConfigurationFetched=function(e){var t=xt.nestedValue(e.events.Playback,"period");null!=t&&t!==n.playbackUpdateIntervalMs&&(n.playbackUpdateIntervalMs=t,null!=n.playbackUpdateId&&n.startPlaybackUpdateInterval(!0))},this.mediaEventReporter=e,this.mpPlayer=t,this.timer=A.timer}return e.prototype.initialize=function(){this.mpPlayer.on("contentStateChange",this.onContentStateChange),this.mpPlayer.on("playbackStateChange",this.onPlaybackStateChange),this.mpPlayer.on("timeupdate",this.onTimeupdate),this.mpPlayer.on("ended",this.onContentEnded),this.mediaEventReporter.on("bootstrappingConfigurationFetched",this.onBootstrappingConfigurationFetched)},e.prototype.uninitialize=function(){this.mpPlayer.off("contentStateChange",this.onContentStateChange),this.mpPlayer.off("playbackStateChange",this.onPlaybackStateChange),this.mpPlayer.off("timeupdate",this.onTimeupdate),this.mpPlayer.off("ended",this.onContentEnded),this.mediaEventReporter.off("bootstrappingConfigurationFetched",this.onBootstrappingConfigurationFetched),this.stopPlaybackUpdateInterval(),this.contentState=null,this.playbackState=null,this.lastPlaybackActionReported=null},e.prototype.unload=function(){this.isOpen||(this.consumptionId=null)},e.prototype.updateBufferSettings=function(e){null!=e?(this.frontBufferTimeCapacityMs=1e3*e.forwardBufferLengthSeconds,this.backBufferTimeCapacityMs=1e3*e.backwardBufferLengthSeconds):(this.frontBufferTimeCapacityMs=xA.BufferConstants.MAX_FRONT_BUFFER_MS,this.backBufferTimeCapacityMs=xA.BufferConstants.MAX_BACK_BUFFER_MS)},e.prototype.updateConsumptionId=function(e){this.consumptionId=e},e.prototype.updateUtcMsAtZero=function(e){this.utcMsAtZero=e},e.prototype.updateClientId=function(e){this.clientId=e},e.prototype.updatePlaybackContentContext=function(e){var t=this;this.playbackContentContext!==e&&("Start"===this.lastPlaybackActionReported&&this.reportAction("Stop"),this.playbackContentContext=e,this.reportAction("Context"),this.timer.setImmediate(function(){"ready"===t.mpPlayer.contentState&&"playing"===t.mpPlayer.playbackState&&t.reportAction("Start")}))},e.prototype.reportPlaybackEvent=function(e){if("Open"===e){if(this.isOpen)return;this.isOpen=!0;var t=this.getPlayheadPositionMs();null===t&&(t=0),this.report("Open",this.consumptionId,t)}else"Exit"===e?(this.isStarted&&this.reportAction("Stop"),this.isOpen&&(this.reportAction("Exit"),this.isOpen=!1,this.mediaEventReporter.dispatchMediaEvents()),this.consumptionId=null):"Stop"===e&&this.reportAction("Stop")},e.prototype.reportAction=function(e){if("Start"===e){if(this.isStarted=!0,this.startPlaybackUpdateInterval(),"Start"===this.lastPlaybackActionReported)return void m.warn("Attempted to report Playback.Start while the last action reported was already Playback.Start.")}else if("Stop"===e&&(this.isStarted=!1,this.stopPlaybackUpdateInterval(),"Stop"===this.lastPlaybackActionReported))return void m.warn("Attempted to report Playback.Stop while the last action reported was already Playback.Stop.");var t=this.getPlayheadPositionMs();null!==t?null!==this.consumptionId?this.report(e,this.consumptionId,t):m.warn("Cannot report Playback events without a valid consumptionId"):m.warn("Cannot report Playback events without a known playhead.")},e.prototype.report=function(e,t,n){var r=[],i=[],o=this.mpPlayer.getBufferInformationProvider();if(null===o)m.warn("Cannot report Playback events buffer without a BufferInformationProvider.");else for(var a=o.getBufferInformation(),s=0,l=Object.keys(a);s<l.length;s++){var u=l[s];r.push(this.createPlaybackBuffer(u,a[u].front,this.frontBufferTimeCapacityMs)),i.push(this.createPlaybackBuffer(u,a[u].back,this.backBufferTimeCapacityMs))}var c=0,d=this.mpPlayer.getPlaybackQualityProvider();if(null!=d){var p=d.getVideoDecodePerformance();if(null!=p){var f=p.droppedVideoFrames;c=f-this.droppedFramesReported,this.droppedFramesReported=f}}var h=gA.PlaybackEventFactory.createPlaybackEvent(t,e,Math.round(n+xt.withDefault(this.utcMsAtZero,0)),this.playbackContentContext,r,i,c,0,null,this.clientId);this.mediaEventReporter.enqueueMediaEvents([h]),"Start"!==e&&"Stop"!==e||(this.lastPlaybackActionReported=e)},e.prototype.createPlaybackBuffer=function(e,t,n){return{type:e,timeAvailable:Math.round(t.endTimeMs-t.startTimeMs),timeCapacity:n,bytesAvailable:xt.withDefault(t.sizeBytes,0),bytesCapacity:Yh.deviceInformation.storage.fragmentCache.sizeBytes}},e.prototype.startPlaybackUpdateInterval=function(e){var t=this;void 0===e&&(e=!1),(null==this.playbackUpdateId||e)&&(null!=this.playbackUpdateId&&this.timer.clearInterval(this.playbackUpdateId),this.playbackUpdateId=this.timer.setInterval(function(){t.reportAction("Update")},this.playbackUpdateIntervalMs))},e.prototype.stopPlaybackUpdateInterval=function(){null!=this.playbackUpdateId&&(this.timer.clearInterval(this.playbackUpdateId),this.playbackUpdateId=null)},e.prototype.getPlayheadPositionMs=function(){var e=this.mpPlayer.currentTimeMs;return null!==e&&(this.lastKnownPlayheadMs=e),this.lastKnownPlayheadMs},e.prototype.reportInteraction=function(e,t,n,r){var i=gA.InteractionEventFactory.createInteractionEvent(e,t,n,r);this.mediaEventReporter.enqueueMediaEvents([i])},e}();t.PlaybackMediaEventController=n});e($A);$A.PlaybackMediaEventController;var ZA=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("StreamMediaEventController"),o=((n={}).Caption="Caption",n.Mandatory="ForcedNarrative",n.Subtitle="Subtitle",n.SDH=null,n),a=((r={}).Commentary="Commentary",r.Descriptive="Descriptive",r.Dialog="Dialog",r),s=function(){function e(e,t,n){var a=this;this.consumptionId=null,this.audioStreamInfo=null,this.timedTextStreamInfo=null,this.onAudioQualityChange=function(e){if(null!=e){var t=a.getMediaRepresentationStreamFor(e);if(null!=t){if(null==a.audioStreamInfo||a.audioStreamInfo.language!==t.language||a.audioStreamInfo.audioTrackId!==t.audioTrackId){var n={language:t.language,audioTrackId:t.audioTrackId};a.audioStreamInfo=n,a.reportTrackEvent(n)}}else{var r="mediaRepresentation "+(null==a.mediaRepresentation?"does not exist":"exists")+", periodId="+e.periodId+", streamId="+e.streamId;i.error("[Audio] Could not find new active Stream. "+r)}}else a.audioStreamInfo=null},this.onStreamGroupChange=function(e,t){if("TimedText"===e){for(var n={},r=0,i=t;r<i.length;r++){var o=i[r];n[o.id]=o}a.timedTextStreamInfo={activeStreamId:null,streams:n}}},this.onActiveStreamChange=function(e,t){if("TimedText"===e){var n=a.timedTextStreamInfo;if(null!=n){var r=n.streams;null!=r[t]&&a.reportTimedTextEvent(r[t]),n.activeStreamId=t}else i.warn("TimedText ActiveStreamChange without StreamGroup information")}},this.onMpPlayerStateChange=function(e){"unloaded"===e&&(a.audioStreamInfo=null)},this.mediaEventReporter=e,this.streamFeature=t,this.mpPlayer=n,this.mediaRepresentation=null}return e.prototype.initialize=function(){this.streamFeature.on("StreamGroupChange",this.onStreamGroupChange),this.streamFeature.on("ActiveStreamChange",this.onActiveStreamChange),this.mpPlayer.on("contentStateChange",this.onMpPlayerStateChange);var e=this.mpPlayer.getPlaybackQualityProvider();null!=e?e.on("Audio","qualityLevel",this.onAudioQualityChange):i.warn("No QualityProvider. Audio Track events won't be reported")},e.prototype.uninitialize=function(){this.streamFeature.off("StreamGroupChange",this.onStreamGroupChange),this.streamFeature.off("ActiveStreamChange",this.onActiveStreamChange),this.mpPlayer.off("contentStateChange",this.onMpPlayerStateChange);var e=this.mpPlayer.getPlaybackQualityProvider();null!=e&&e.off("Audio","qualityLevel",this.onAudioQualityChange)},e.prototype.updateConsumptionId=function(e){this.consumptionId=e},e.prototype.updateMediaRepresentation=function(e){this.mediaRepresentation=e},e.prototype.getMediaRepresentationStreamFor=function(e){return null==this.mediaRepresentation?null:TE.MediaRepresentationQuerier.for(this.mediaRepresentation).itemById(e.periodId).streamsByType(e.type).streamById(e.streamId).value()},e.prototype.reportTrackEvent=function(e){""===e.language&&i.warn("Empty language reporting to QoS");var t=gA.ContextualEventFactory.createAudioTrack(e.language,null!=e.audioTrackId?e.audioTrackId:null,this.consumptionId),n=gA.ContextualEventFactory.createTrackEvent(t);this.mediaEventReporter.enqueueMediaEvents([n])},e.prototype.reportTimedTextEvent=function(e){var t=gA.ContextualEventFactory.createTimedTextEvent(!0,e.language,null!=e.type?o[e.type]:null,null!=e.subtype?a[e.subtype]:null);this.mediaEventReporter.enqueueMediaEvents([t])},e}();t.StreamMediaEventController=s});e(ZA);ZA.StreamMediaEventController;var eO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("MediaEventController"),r=function(){function e(e,t,n,r,i,o,a){this.consumptionId=null,this.mediaEventReporter=e,this.acquisitionMediaEventController=new WA.AcquisitionMediaEventController(e,t),this.adIdentifierMediaEventController=new HA.AdIdentifierMediaEventController(e,i),this.bitstreamMediaEventController=new GA.BitstreamMediaEventController(e),this.contextualMediaEventController=new QA.ContextualMediaEventController(e,n,t.getVolumeFeature(),o,a),this.errorMediaEventController=new JA.ErrorMediaEventController(e,t),this.playbackMediaEventController=new $A.PlaybackMediaEventController(e,t),this.streamMediaEventController=new ZA.StreamMediaEventController(e,r,t)}return e.prototype.initialize=function(){this.bitstreamMediaEventController.initialize(),this.contextualMediaEventController.initialize(),this.errorMediaEventController.initialize(),this.playbackMediaEventController.initialize(),this.streamMediaEventController.initialize()},e.prototype.uninitialize=function(){this.mediaEventReporter.dispatchMediaEvents(),this.bitstreamMediaEventController.uninitialize(),this.contextualMediaEventController.uninitialize(),this.errorMediaEventController.uninitialize(),this.playbackMediaEventController.uninitialize(),this.streamMediaEventController.uninitialize()},e.prototype.unload=function(){this.consumptionId=null,this.acquisitionMediaEventController.unload(),this.bitstreamMediaEventController.unload(),this.errorMediaEventController.unload(),this.playbackMediaEventController.unload()},e.prototype.updateClientId=function(e){this.playbackMediaEventController.updateClientId(e)},e.prototype.updatePlaybackSettingsId=function(e){this.contextualMediaEventController.updatePlaybackSettingsId(e)},e.prototype.updateBufferSettings=function(e){this.playbackMediaEventController.updateBufferSettings(e)},e.prototype.updateConsumptionId=function(e){this.consumptionId=e,this.acquisitionMediaEventController.updateConsumptionId(e),this.adIdentifierMediaEventController.updateConsumptionId(e),this.bitstreamMediaEventController.updateConsumptionId(e),this.errorMediaEventController.updateConsumptionId(e),this.playbackMediaEventController.updateConsumptionId(e),this.streamMediaEventController.updateConsumptionId(e)},e.prototype.getConsumptionId=function(){return this.consumptionId},e.prototype.updateTitleId=function(e){this.acquisitionMediaEventController.updateTitleId(e)},e.prototype.updateAuditPingStreamId=function(e){this.adIdentifierMediaEventController.updateAuditPingStreamId(e)},e.prototype.updateUtcMsAtZero=function(e){this.playbackMediaEventController.updateUtcMsAtZero(e)},e.prototype.updatePlaybackContentContext=function(e){this.playbackMediaEventController.updatePlaybackContentContext(e)},e.prototype.updateMediaRepresentation=function(e){this.streamMediaEventController.updateMediaRepresentation(e)},e.prototype.setBitstreamSource=function(e){this.bitstreamMediaEventController.setBitstreamSource(e)},e.prototype.reportError=function(e,t,n,r){this.errorMediaEventController.reportError(e,t,n,r)},e.prototype.reportPlayback=function(e){this.playbackMediaEventController.reportPlaybackEvent(e)},e.prototype.reportFailover=function(e){var t=gA.FailoverEventFactory.createFailoverEvent(e.ruleId,e.fromConsumptionId,e.toConsumptionId);this.mediaEventReporter.enqueueMediaEvents([t])},e.prototype.reportFragmentAcquisitionSuccess=function(e){this.acquisitionMediaEventController.reportFragmentAcquisitionSuccess(e)},e.prototype.reportFragmentAcquisitionFailure=function(e){this.acquisitionMediaEventController.reportFragmentAcquisitionFailure(e)},e.prototype.reportLicenseAcquisitionSuccess=function(e){this.acquisitionMediaEventController.reportLicenseAcquisitionSuccess(e)},e.prototype.reportLicenseAcquisitionFailure=function(e){this.acquisitionMediaEventController.reportLicenseAcquisitionFailure(e)},e.prototype.reportManifestAcquisitionSuccess=function(e){this.acquisitionMediaEventController.reportManifestAcquisitionSuccess(e)},e.prototype.reportManifestAcquisitionFailure=function(e){n.info("Reporting manifest acquisition failure: "+JSON.stringify(e)),this.acquisitionMediaEventController.reportManifestAcquisitionFailure(e)},e.prototype.reportTimedTextAcquisitionSuccess=function(e){this.acquisitionMediaEventController.reportTimedTextAcquisitionSuccess(e)},e.prototype.reportTimedTextAcquisitionFailure=function(e){this.acquisitionMediaEventController.reportTimedTextAcquisitionFailure(e)},e.prototype.setDisplayMode=function(e){this.contextualMediaEventController.setDisplayMode(e)},e}();t.MediaEventController=r});e(eO);eO.MediaEventController;var tO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("EndOfContentSeekInterceptor"),n=function(e){var i=this;this.getNewSeekTarget=function(e,t){var n=i.playlistEngine.getItems(),r=n[t].end;return null!=r&&r-2e3<e&&(t===n.length-1||n[t].titleId!==n[t+1].titleId)?(o.info("Detected a seek too close to the end of the content, setting seek position to "+(r-2e3)+"ms"),{newPosition:r-2e3,newItemIndex:t}):{newPosition:e,newItemIndex:t}},this.playlistEngine=e};t.EndOfContentSeekInterceptor=n});e(tO);tO.EndOfContentSeekInterceptor;var nO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});function s(e){return null==e.mediaRepresentation&&null==e.contentSource}function l(e,t,n){for(var r=e[t].titleId,i=0,o=null,a=t;0<=a;a--){var s=e[a];if(s.titleId!==r&&n<++i){o=a;break}r=s.titleId}return o}var n=function(){function e(e,t,n,r){void 0===n&&(n=1/0),void 0===r&&(r=1);var i=this;this.onEnterItem=function(){i.trim(),i.cleanse()},this.playlistEngine=e,this.unloadTitle=t,this.titlesToRetain=n,this.titlesToNotCleanse=r,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.playlistTrimming&&(null!=up.configurationStore.configuration.playlistTrimming.titlesToRetain&&(this.titlesToRetain=up.configurationStore.configuration.playlistTrimming.titlesToRetain),null!=up.configurationStore.configuration.playlistTrimming.titlesToNotCleanse&&(this.titlesToNotCleanse=up.configurationStore.configuration.playlistTrimming.titlesToNotCleanse))}return e.prototype.initialize=function(){this.titlesToRetain===1/0&&this.titlesToNotCleanse===1/0||this.playlistEngine.on("EnterItem",this.onEnterItem)},e.prototype.terminate=function(){this.playlistEngine.off("EnterItem",this.onEnterItem)},e.prototype.cleanseItem=function(e){s(e)||this.unloadTitle(e.titleId),null!=e.mediaRepresentation&&e.mediaRepresentation.stop(),null!=e.contentSource&&e.contentSource.stop()},e.prototype.cleanseRange=function(e,t,n){for(var r=null,i=t;i<=n;i++){var o=e[i];r!==o.titleId&&(this.cleanseItem(o),r=o.titleId)}},e.prototype.cleanse=function(){var e=this.playlistEngine.getCurrentItemIndex();if(null!==e){var t=this.playlistEngine.getItems(),n=function(e){for(var t=0;t<e.length;t++)if(!s(e[t]))return t;return null}(t),r=l(t,e,this.titlesToNotCleanse);if(null!=n&&null!=r&&n<=r){this.cleanseRange(t,n,r);var i=t[n].start,o=t[r].end,a=null===o?1/0:o;this.playlistEngine.update(n,i,r,a,{mediaRepresentation:void 0,contentSource:void 0,playlistRelativeConstrainedTimeWindow:void 0,sourceUrlStore:void 0})}}},e.prototype.trim=function(){var e=this.playlistEngine.getCurrentItemIndex();if(null!==e){var t=this.playlistEngine.getItems(),n=l(t,e,this.titlesToRetain);if(null!=n){this.cleanseRange(t,0,n);var r=t[0].start,i=t[n].end,o=null===i?1/0:i;this.playlistEngine.splice(0,r,n,o,[])}}},e}();t.PlaylistTrimmer=n});e(nO);nO.PlaylistTrimmer;var rO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var n=this;this.enableInfiniteAutoplay=!1,this.maxContinuousPlayTitleTransitions=5,this.titleTransitionsSinceLastInteraction=0,this.currentTitleId=null,this.titleIdBarrierMap={},this.onEnterItem=function(e){var t=e.item.titleId;null!==n.currentTitleId&&t!==n.currentTitleId&&n.titleTransitionsSinceLastInteraction++,n.currentTitleId=t},this.playlistEngine=e}return e.prototype.initialize=function(e){void 0===e&&(e=!1),this.enableInfiniteAutoplay=e,this.playlistEngine.on("EnterItem",this.onEnterItem)},e.prototype.terminate=function(){this.playlistEngine.off("EnterItem",this.onEnterItem)},e.prototype.unloaded=function(){this.currentTitleId=null,this.titleIdBarrierMap={}},e.prototype.resetInteractions=function(){this.titleTransitionsSinceLastInteraction=0},e.prototype.setMaxContinuousPlayTitleTransitions=function(e){this.maxContinuousPlayTitleTransitions=e},e.prototype.addTitleBarrier=function(e,t){this.titleIdBarrierMap[e]=t},e.prototype.canAutoplayBetween=function(e,t){return e.titleId===t.titleId||(null==this.titleIdBarrierMap[e.titleId]||this.titleIdBarrierMap[e.titleId]!==t.titleId)&&(this.enableInfiniteAutoplay||this.titleTransitionsSinceLastInteraction<this.maxContinuousPlayTitleTransitions)},e}();t.XpAutoplayBarrier=n});e(rO);rO.XpAutoplayBarrier;var iO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("VideoQualityOverrideStorage"),o="xp.verified_secure_pipeline",n=function(){function e(e){var r=this;this.videoQualityOverride=null,this.storageUpdated=!1,this.xpPlayerCapabilitiesFeature=e,this.storageAccessPromise=new Fe.Promise(function(n){Wf.keyValueStore.get(o,function(e,t){null===e?"false"===t&&(i.info("Local stored verified secure pipeline is false"),r.xpPlayerCapabilitiesFeature.setVerifiedSecurePipeline(!1),r.videoQualityOverride="SD"):i.warn("Error occurs during local storage access, error: "+e+", code: "+e.code),n(r.videoQualityOverride)})})}return e.prototype.storeVerifiedSecurePipeline=function(e){var t=void 0;!0===e?this.videoQualityOverride=null:(this.videoQualityOverride="SD",t="false"),this.xpPlayerCapabilitiesFeature.setVerifiedSecurePipeline(e),this.storageUpdated=!0,Wf.keyValueStore.set(o,t,function(e){null!=e&&i.warn("Cannot store video quality override locally, error: "+e+", code: "+e.code)})},e.prototype.getValue=function(){return this.storageUpdated?Fe.Promise.resolve(this.videoQualityOverride):this.storageAccessPromise},e}();t.VideoQualityOverrideStorage=n});e(iO);iO.VideoQualityOverrideStorage;var oO=t(function(e,t){var n,r,i,o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=((n={}).Hdcp="Hdcp",n.RendererCapability="RendererCapability",n),s=((r={}).Audio="Audio",r.TimedText="TimedText",r.Video="Video",r),l=function(){function r(){}return r.transformToPublicStreamRestriction=function(e){return r.streamRestrictionExtenderMap[e.restrictionType](e)},r.transformToPublicStreamRestrictionType=function(e){return a[e]},r.transformToPublicHdcpStreamRestriction=function(e){var t=r.transformToPublicBaseStreamRestriction(e),n={hdcpEnforcementResolutionPixels:e.hdcpEnforcementResolutionPixels};return o({},t,n)},r.transformToPublicRendererStreamRestriction=function(e){return r.transformToPublicBaseStreamRestriction(e)},r.transformToPublicBaseStreamRestriction=function(e){return{streamType:s[e.streamType],restrictionType:a[e.restrictionType]}},r.streamRestrictionExtenderMap=((i={}).Hdcp=r.transformToPublicHdcpStreamRestriction,i.RendererCapability=r.transformToPublicRendererStreamRestriction,i),r}();t.StreamRestrictionTransformer=l});e(oO);oO.StreamRestrictionTransformer;var aO=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function i(){}return i.isQualityRestricted=function(e,t){var n=t.restrictionType,r=i.restrictionCheckerMap[n];return null!=r&&r(e,t)},i.isQualityHdcpRestricted=function(e,t){return null==e.height||null==e.width||e.height*e.width>t.hdcpEnforcementResolutionPixels},i.isQualityRendererRestricted=function(e,t){if(null==e.height||null==e.frameRate)return!0;var n,r=Rp.stringToNumber(e.frameRate);if(isNaN(r))return!0;switch(n=1080<e.height?"UHD":480<e.height?"HD":"SD",t.videoQualityToMaxSupportedFrameRate[n]){case"HFR":return!1;case"SFR":return 30<r;case null:return!0}},i.restrictionCheckerMap=((n={}).Hdcp=i.isQualityHdcpRestricted,n.RendererCapability=i.isQualityRendererRestricted,n),i}();t.RestrictionChecker=r});e(aO);aO.RestrictionChecker;var sO=t(function(e,t){var n,r,s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("VariantTransformer"),u=((n={}).stpp="TTMLv1",n.dfxp="TTMLv1",n.wvtt="WebVTT",n),o=null,c=0,d=0,i=function(){function a(){}return a.transformToPublicVariant=function(e,t,n){return void 0===n&&(n=[]),a.variantExtenderMap[t.type](e,t,n)},a.transformToPublicAudioVariant=function(e,t,n){var r=a.transformToPublicBaseVariant(e,t,n);return s({},r,{channelConfiguration:""})},a.transformToPublicTimedTextVariants=function(e,t,n){var r=a.transformToPublicBaseVariant(e,t,n),i=e.codecs.substring(0,4);if(null==u[i])return l.error("Unknown TimedText codecs string ("+e.codecs+")."),r;var o={format:u[i]};return s({},r,o)},a.transformToPublicVideoVariants=function(e,t,n){var r=a.transformToPublicBaseVariant(e,t,n),i={frameRate:xt.withDefault(e.frameRate,o),height:xt.withDefault(e.height,c),width:xt.withDefault(e.width,d)};return s({},r,i)},a.transformToPublicBaseVariant=function(t,e,n){return{id:e.id+"_"+t.id,bitrate:t.bandwidth,codecs:t.codecs,restrictions:n.filter(function(e){return aO.RestrictionChecker.isQualityRestricted(t,e)}).map(function(e){return oO.StreamRestrictionTransformer.transformToPublicStreamRestrictionType(e.restrictionType)})}},a.variantExtenderMap=((r={}).Audio=a.transformToPublicAudioVariant,r.TimedText=a.transformToPublicTimedTextVariants,r.Video=a.transformToPublicVideoVariants,r),a}();t.VariantTransformer=i});e(sO);sO.VariantTransformer;var lO=t(function(e,t){var n,r,i,o,a=V&&V.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s=((n={}).Commentary="Commentary",n.Descriptive="Descriptive",n.Dialog="Dialog",n),l=((r={}).Subtitle="Subtitle",r.Mandatory="Mandatory",r),u=((i={}).Commentary="Commentary",i.Descriptive="Descriptive",i.Dialog="Dialog",i),c=function(){function i(){}return i.transformToPublicStream=function(e,t){return void 0===t&&(t=[]),i.STREAM_EXTENDER_MAP[e.type](e,t)},i.transformToPublicAudioStream=function(e,t){var n=i.transformToPublicBaseStream(e,t),r={language:xt.withDefault(e.language,""),type:xt.withDefault(s[e.subtype],null),label:xt.withDefault(e.label,null)};return a({},n,r)},i.transformToPublicTimedTextStream=function(e,t){var n=i.transformToPublicBaseStream(e,t),r={language:xt.withDefault(e.language,""),type:xt.withDefault(l[e.textType],null),subtype:xt.withDefault(u[e.subtype],null),label:null};return a({},n,r)},i.transformToPublicVideoStreams=function(e,t){var n=i.transformToPublicBaseStream(e,t);return a({},n,{})},i.transformToPublicBaseStream=function(t,n){return{id:i.getPublicStreamId(t),variants:t.qualityLevels.map(function(e){return sO.VariantTransformer.transformToPublicVariant(e,t,n)}),activeVariantId:null}},i.getPublicStreamId=function(e){return null!=e.baseId?e.baseId:e.id},i.STREAM_EXTENDER_MAP=((o={}).Audio=i.transformToPublicAudioStream,o.TimedText=i.transformToPublicTimedTextStream,o.Video=i.transformToPublicVideoStreams,o),i}();t.StreamTransformer=c});e(lO);lO.StreamTransformer;var uO=t(function(e,t){var n,r,o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=((n={}).Dialog="Dialog",n.Commentary="Commentary",n.Descriptive="Descriptive",n),s=((r={}).Mandatory="Mandatory",r.Subtitle="Subtitle",r.Caption="Subtitle",r.SDH="Subtitle",r);t.convertStreamMatcherToTypeMatcher=function(e,t){if("Audio"===e){var n=t;return o({type:"Audio"},null!=n.language?{language:n.language}:{},null!=n.type?{subtype:a[n.type]}:{})}if("TimedText"===e){var r=t,i=null!=r.type?s[r.type]:"Subtitle";return{type:"TimedText",language:t.language,textType:i}}return{type:"Video"}}});e(uO);uO.convertStreamMatcherToTypeMatcher;var cO=t(function(e,t){var n,r,i,o,a,s,l=V&&V.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("XpPlayerStreamFeature"),g=((n={}).Audio={type:"Audio",streams:[],activeId:null},n.TimedText={type:"TimedText",streams:[],activeId:null},n.Video={type:"Video",streams:[],activeId:null},n),c=((r={}).Audio=[],r.TimedText=[],r.Video=[],r),d=((i={}).Audio="Audio",i.TimedText="TimedText",i.Video="Video",i),v=((o={}).Audio="Audio",o.TimedText="TimedText",o.Video="Video",o),p=((a={}).Audio=null,a.TimedText=null,a.Video=null,a),f=((s={}).Audio="Audio",s.TimedText="TimedText",s.Video="Video",s),h=function(){function e(e,t,n){var s=this;this.version="0.0.1",this.objectId="XpPlayer-Stream-"+Math.random(),this.capabilities={},this.streamGroups=Wp(!0,{},g),this.streamRestrictions={},this.activePublicStreamIds=F.clone(p),this.activePublicVariantIds=F.clone(p),this.currentPeriodId={},this.currentPlaylistItem=null,this.maxBitrateThresholds={},this.qualityLevelHandlers={},this.streamEventEventEmitter=new Dt.EventEmitter,this.streamMatchers={},this.streamRestrictionsByStreamType=Wp(!0,{},c),this.typeMatchers={},this.unsupportedCodecs={},this.onStreamQualityChange=function(e,t){null!==t?(s.currentPeriodId[t.type]!==t.periodId&&(s.currentPeriodId[t.type]=t.periodId,s.createStreamGroups(t),s.tryEmitStaticTimedText()),s.processStreamQualityChange(t)):s.processDisabledStreamQualityChange(e)},this.stripActiveVariantIdAndRestrictions=function(e){var t=F.clone(e);return delete t.activeVariantId,t.variants=t.variants.map(s.stripRestrictions),t},this.stripRestrictions=function(e){var t=F.clone(e);return t.restrictions=[],t},this.onStreamGroupChange=function(e){var t,n=l({},s.streamGroups,((t={})[f[e.type]]=e,t));s.updateStreamGroups(n),s.setActivePublicStreamId(f[e.type],e.activeId)},this.onPlaylistUpdate=function(){s.currentPlaylistItem=s.playlistEngine.getCurrentItem(),null===s.currentPlaylistItem&&s.updateStreamGroups(Wp(!0,{},g))},this.onEnterItem=function(){if(null!==s.currentPlaylistItem&&null!=s.currentPlaylistItem.contentSource&&s.currentPlaylistItem.contentSource.off("streamRestrictionChange",s.onStreamRestrictionChange),s.currentPlaylistItem=s.playlistEngine.getCurrentItem(),null!=s.playbackQualityProvider){null!==s.currentPlaylistItem&&null!=s.currentPlaylistItem.contentSource&&s.currentPlaylistItem.contentSource.on("streamRestrictionChange",s.onStreamRestrictionChange),s.currentPeriodId={};for(var e=0,t=Object.keys(v);e<t.length;e++){var n=t[e],r=s.playbackQualityProvider.getCurrentQualityInfo(n);null!=r&&(s.createStreamGroups(r),s.processStreamQualityChange(r))}s.tryEmitStaticTimedText()}},this.onStreamRestrictionChange=function(e){if(s.updateStreamRestriction(e.streamType,e.restrictions),null!==s.playbackQualityProvider){var t=s.playbackQualityProvider.getCurrentQualityInfo(e.streamType);null!=t&&(s.createStreamGroups(t),s.processStreamQualityChange(t))}},this.onTextTrackCue=function(e){var t=s.playlistEngine.getCurrentItemIndex(),n=s.getActiveStream("TimedText"),r=s.streamEventEventEmitter.listeners("TimedTextStreamData");if(null!=n&&null!==s.currentPlaylistItem&&!F.isEmpty(r)){var i=s.currentPlaylistItem.start-s.currentPlaylistItem.contentTimeToPlaylistTimeOffsetMs,o=i-s.currentPlaylistItem.timelineStart,a={data:e.data,timestampOffsetMs:-e.timeOffsetMs+i,startPosition:e.startMs-o,endPosition:e.endMs-o,timelineItemIndex:t,retainableRanges:s.getTimedTextContentRanges(o)};s.streamEventEventEmitter.emit("TimedTextStreamData",n.id,a)}},this.mpPlayer=e,this.playlistEngine=t,this.playbackQualityProvider=this.mpPlayer.getPlaybackQualityProvider(),this.staticTimedTextDataStore=n;for(var r=function(t){i.qualityLevelHandlers[t]=function(e){s.onStreamQualityChange(t,e)}},i=this,o=0,a=Object.keys(d);o<a.length;o++){r(a[o])}}return e.prototype.initialize=function(){if(this.playlistEngine.on("EnterItem",this.onEnterItem),this.playlistEngine.on("PlaylistUpdate",this.onPlaylistUpdate),this.mpPlayer.textTrack.on("newcue",this.onTextTrackCue),null!==this.playbackQualityProvider){this.playbackQualityProvider.onStreamGroupChange(this.onStreamGroupChange);for(var e=0,t=Object.keys(d);e<t.length;e++){var n=t[e],r=this.qualityLevelHandlers[n];null!=r&&this.playbackQualityProvider.on(d[n],"qualityLevel",r)}}},e.prototype.configure=function(e){if(null!=e.preferredStreamMatchers)for(var t=0,n=Object.keys(e.preferredStreamMatchers);t<n.length;t++){var r=n[t];this.setStreamMatchers(r,e.preferredStreamMatchers[r])}},e.prototype.unload=function(){this.activePublicStreamIds=F.clone(p),this.activePublicVariantIds=F.clone(p)},e.prototype.terminate=function(){if(this.unload(),this.playlistEngine.off("EnterItem",this.onEnterItem),this.playlistEngine.off("PlaylistUpdate",this.onPlaylistUpdate),this.mpPlayer.textTrack.off("newcue",this.onTextTrackCue),null!==this.playbackQualityProvider){this.playbackQualityProvider.offStreamGroupChange(this.onStreamGroupChange);for(var e=0,t=Object.keys(d);e<t.length;e++){var n=t[e],r=this.qualityLevelHandlers[n];null!=r&&this.playbackQualityProvider.off(d[n],"qualityLevel",r)}}this.currentPeriodId={}},e.prototype.setMaxBitrateThreshold=function(e,t){if("Video"!==e)throw new Error("Unsupported streamType '"+e+"' for setMaxBitrateThreshold");null===t&&(t=1/0),u.info(">> setMaxBitrateThreshold set for "+e+" to "+t+" bits/sec"),t===1/0?delete this.maxBitrateThresholds[e]:this.maxBitrateThresholds[e]=t;for(var n=this.getMediaRepresentationStreamType(e),r=0,i=this.getAllUniqueContentSources();r<i.length;r++){i[r].setMaxBitrateThreshold(n,"External",t)}},e.prototype.setStreamMatchers=function(e,t){F.isArray(t)||(t=[]);for(var n=0,r=t;n<r.length;n++){var i=r[n];null!=i.language&&"string"!=typeof i.language&&(u.warn("Removing invalid StreamMatcher.language '"+i.language+"'"),delete i.language)}u.info(">> setStreamMatchers("+e+", "+JSON.stringify(t)+")");var o=this.getMediaRepresentationStreamType(e),a=Kk.expandMatcherLanguages(t);this.typeMatchers[o]=a.map(function(e){return uO.convertStreamMatcherToTypeMatcher(o,e)}),this.streamMatchers[e]=a;for(var s=0,l=this.getAllUniqueContentSources();s<l.length;s++){l[s].setStreamMatchers(o,this.typeMatchers[o])}"TimedText"===e&&this.tryEmitStaticTimedText()},e.prototype.setUnsupportedCodecs=function(e,t){if("Audio"!==e)throw new Error("Unsupported streamType '"+e+"' for setUnsupportedCodecs");u.info(">> setUnsupportedCodecs set for "+e+" with "+JSON.stringify(t)+" codecs"),0===t.length?delete this.unsupportedCodecs[e]:this.unsupportedCodecs[e]=t;for(var n=this.getMediaRepresentationStreamType(e),r=0,i=this.getAllUniqueContentSources();r<i.length;r++){i[r].setUnsupportedCodecs(n,t)}},e.prototype.on=function(e,t){this.streamEventEventEmitter.on(e,t),"TimedTextStreamData"===e&&this.tryEmitStaticTimedText()},e.prototype.once=function(e,t){this.streamEventEventEmitter.once(e,t)},e.prototype.off=function(e,t){this.streamEventEventEmitter.off(e,t)},e.prototype.getCurrentMatchers=function(){return this.typeMatchers},e.prototype.getCurrentMaxBitrateThresholds=function(){return this.maxBitrateThresholds},e.prototype.getCurrentUnsupportedCodecs=function(){return this.unsupportedCodecs},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId,capabilities:this.capabilities,streamGroups:this.streamGroups,streamRestrictions:this.streamRestrictions}},e.prototype.tryEmitStaticTimedText=function(){var n=this;if(null!==this.currentPlaylistItem){var e=this.streamEventEventEmitter.listeners("TimedTextStreamData");if(F.isEmpty(e))u.info("No TimedTextStreamData listeners");else{var r=this.getCurrentStaticTimedTextStream();if(null!==r){var i=this.playlistEngine.getCurrentItemIndex();if(null==i)throw new Error("timelineItemIndex is null");var o=this.currentPlaylistItem.timelineStart,a=this.currentPlaylistItem.timelineEnd;this.staticTimedTextDataStore.getContents(r).then(function(e){var t={data:e,timestampOffsetMs:o,startPosition:o,endPosition:a,timelineItemIndex:i,retainableRanges:[{startTimeMs:o,endTimeMs:null!=a?a:1/0,timelineItemIndex:i}]};n.setActivePublicStreamId("TimedText",r.id),n.streamEventEventEmitter.emit("TimedTextStreamData",r.id,t),u.enabledFor(M.DEBUG)&&u.info("Static TimedTextStreamData. lang:\""+r.language+"\", label:\""+r.label+"\"")}).catch(function(e){u.error(e)})}else F.isEmpty(this.currentPlaylistItem.staticTimedTextStreams)||this.setActivePublicStreamId("TimedText",null)}}},e.prototype.getActiveStream=function(e){var t=this.streamGroups[e];if(null===t.activeId)return null;var n=F.find(t.streams,function(e){return e.id===t.activeId});return xt.withDefault(n,null)},e.prototype.getCurrentStaticTimedTextStream=function(){if(null===this.currentPlaylistItem)return null;var e=this.getActiveStream("Audio"),t=this.streamMatchers.TimedText;if(null!=t)for(var n=0,r=t;n<r.length;n++)for(var i=r[n],o=0,a=this.currentPlaylistItem.staticTimedTextStreams;o<a.length;o++){var s=a[o];if("Mandatory"===i.type&&null==i.language&&null!=e&&null!=e.language&&((i=F.clone(i)).language=e.language),Kk.isMatch(s,i))return s}return null==e?null:xt.withDefault(F.findWhere(this.currentPlaylistItem.staticTimedTextStreams,{language:e.language,type:"Mandatory"}),null)},e.prototype.getMediaRepresentationStreamType=function(e){var t=d[e];if(null==t)throw new Error("Invalid stream type: "+e);return t},e.prototype.createStreamGroups=function(e){if(null!==this.currentPlaylistItem){var t=F.findWhere(this.currentPlaylistItem.mediaRepresentation.periods.contents,{id:e.periodId});if(null!=t){for(var n=Wp(!0,{},g),r={Audio:[],TimedText:[],Video:[]},i=0,o=t.streams;i<o.length;i++){var a=o[i];r[a.type].push(a)}for(var s=0,l=Object.keys(r);s<l.length;s++){var u=l[s],c=this.internalStreamsToPublicStreams(r[u],this.streamRestrictionsByStreamType[u]),d=v[u],p=n[d];p.streams=p.streams.concat(c),p.activeId=this.activePublicStreamIds[d]}var f=this.getStaticTimedTextStreams(this.currentPlaylistItem);F.isEmpty(f)||(n.TimedText.streams=f),this.updateStreamGroups(n);for(var h=0,m=Object.keys(this.streamGroups);h<m.length;h++){u=m[h];var y=this.getActiveStream(u);null!==y&&(y.activeVariantId=this.activePublicVariantIds[u])}}}},e.prototype.processDisabledStreamQualityChange=function(e){delete this.currentPeriodId[e],this.setActivePublicStreamId(e,null),this.activePublicVariantIds[e]=null},e.prototype.processStreamQualityChange=function(t){if(null!==this.currentPlaylistItem){var e=F.findWhere(this.currentPlaylistItem.mediaRepresentation.periods.contents,{id:t.periodId});if(null!=e){var n=F.find(e.streams,function(e){return e.id===t.streamId});if(null!=n){var r=lO.StreamTransformer.getPublicStreamId(n);this.setActivePublicStreamId(v[t.type],r);var i=this.qualityLevelToVariantId(t);this.setActivePublicVariantId(v[t.type],i)}else u.warn("Could not find "+t.type+" stream \""+t.streamId+"\"")}}},e.prototype.setActivePublicStreamId=function(e,t){var n=this.activePublicStreamIds[e];this.activePublicStreamIds[e]=t,n!==(this.streamGroups[e].activeId=t)&&(this.streamEventEventEmitter.emit("ActiveStreamChange",e,t),u.enabledFor(M.DEBUG)&&u.info("["+e+"] ActiveStreamChange: \""+n+"\" to \""+t+"\""))},e.prototype.setActivePublicVariantId=function(e,t){var n=this.getActiveStream(e);if(null!==n){var r=this.activePublicVariantIds[e];this.activePublicVariantIds[e]=t,r!==(n.activeVariantId=t)&&(this.streamEventEventEmitter.emit("ActiveVariantChange",e,this.activePublicStreamIds[e],t),u.enabledFor(M.DEBUG)&&u.info("["+e+"] ActiveVariantChange: \""+r+"\" to \""+t+"\"."))}else u.warn("Attempted to set active variant for "+e+" without an active stream")},e.prototype.qualityLevelToVariantId=function(e){return e.streamId+"_"+e.qualityLevelId},e.prototype.updateStreamGroups=function(e){for(var t=0,n=Object.keys(v);t<n.length;t++){var r=n[t],i=this.streamGroups[r],o=e[r],a=i.streams.map(this.stripActiveVariantIdAndRestrictions),s=o.streams.map(this.stripActiveVariantIdAndRestrictions);if(!F.isEqual(a,s))if(this.streamEventEventEmitter.emit("StreamGroupChange",v[r],o.streams),u.enabledFor(M.DEBUG))u.info("["+r+"] StreamGroupChange. New streams: "+JSON.stringify(o.streams));else if(u.enabledFor(M.INFO)){var l=o.streams.map(function(e){return e.id});u.info("["+r+"] StreamGroupChange. New streams: "+JSON.stringify(l))}}this.streamGroups=e},e.prototype.getStaticTimedTextStreams=function(e){return null===e?[]:e.staticTimedTextStreams.map(function(e){var t=e.variants.map(function(e){return{id:e.id,format:e.format,restrictions:[]}});return l({},e,{variants:t})})},e.prototype.internalStreamsToPublicStreams=function(e,t){void 0===t&&(t=[]);for(var n={},r=0,i=e.map(function(e){return lO.StreamTransformer.transformToPublicStream(e,t)});r<i.length;r++){var o=i[r];null!=n[o.id]?n[o.id].push(o):n[o.id]=[o]}for(var a=[],s=0,l=Object.keys(n);s<l.length;s++){for(var u=[],c=n[l[s]],d=0,p=c;d<p.length;d++){var f=p[d];u=u.concat(f.variants)}a.push(F.extend(c[0],{variants:u}))}return a},e.prototype.updateStreamRestriction=function(e,t){var n=this.streamRestrictionsByStreamType[e];if(!F.isEqual(n,t)){this.streamRestrictionsByStreamType[e]=t;for(var r=v[e],i=t.map(function(e){return oO.StreamRestrictionTransformer.transformToPublicStreamRestriction(e)}),o=0,a=i;o<a.length;o++){var s=a[o];this.streamRestrictions[s.restrictionType]=s}this.streamEventEventEmitter.emit("StreamGroupRestrictionChange",r,i),u.enabledFor(M.DEBUG)&&u.info("["+r+"] StreamGroupRestrictionChange. New restrictions: "+JSON.stringify(i))}},e.prototype.getAllUniqueContentSources=function(){for(var e=[],t=0,n=this.playlistEngine.getItems();t<n.length;t++){var r=n[t];null!=r.contentSource&&-1===e.indexOf(r.contentSource)&&e.push(r.contentSource)}return e},e.prototype.getTimedTextContentRanges=function(e){var t=this.mpPlayer.textTrack.bufferedIntervalsMs;if(0===t.length)return[];var n=t[0].start-e,r=t[t.length-1].end-e,i=[],o=this.playlistEngine.getItems();if(0===o.length)return[];var a=Mp.binarySearchIndexOf(o,function(e){var t=null!=e.timelineEnd?e.timelineEnd:1/0;return e.timelineStart>n?-1:t<n?1:0});if(-1===a)return[];for(var s=a;s<o.length;++s){var l=o[s],u=l.timelineStart,c=null!=l.timelineEnd?l.timelineEnd:1/0;if(r<u)break;var d={startTimeMs:Math.max(n,u),endTimeMs:Math.min(r,c),timelineItemIndex:s};i.push(d)}return i},e}();t.XpPlayerStreamFeature=h});e(cO);cO.XpPlayerStreamFeature;var dO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("PlaylistTrackingEventReporter"),r=function(){function e(e){var n=this;this.eventReporters={},this.playlistItem=null,this.volumeFeature=null,this.volumeMuted=!1,this.onEnterItem=function(e){if(e.item!==n.playlistItem){var t=n.getCurrentTrackingEventReporter();null!==t&&t.reportSkipOrComplete()}n.playlistItem=e.item},this.onPlaylistEnd=function(){var e=n.getCurrentTrackingEventReporter();null!==e&&e.reportSkipOrComplete()},this.onPlaylistUpdate=function(){if(F.isEmpty(n.playlistEngine.getItems())){var e=n.getCurrentTrackingEventReporter();null!==e&&e.reportClose(),n.reset()}},this.onVolumeChange=function(){if(null!==n.volumeFeature){var e=n.volumeFeature.muted||0===n.volumeFeature.volume;if(e!==n.volumeMuted){var t=n.getCurrentTrackingEventReporter();null!==t&&t.reportMuteOrUnmute(e),n.volumeMuted=e}}},this.playlistEngine=e}return e.prototype.initialize=function(e){this.playlistEngine.on("EnterItem",this.onEnterItem),this.playlistEngine.on("PlaylistEnd",this.onPlaylistEnd),this.playlistEngine.on("PlaylistUpdate",this.onPlaylistUpdate),null!==e&&(this.volumeFeature=e,this.volumeMuted=e.muted||0===e.volume,e.onChange(this.onVolumeChange))},e.prototype.terminate=function(){this.playlistEngine.off("EnterItem",this.onEnterItem),this.playlistEngine.off("PlaylistEnd",this.onPlaylistEnd),this.playlistEngine.off("PlaylistUpdate",this.onPlaylistUpdate),null!==this.volumeFeature&&this.volumeFeature.offChange(this.onVolumeChange),this.reset()},e.prototype.registerAdTrackingEventReporter=function(e,t){this.eventReporters[e]=t},e.prototype.getCurrentTrackingEventReporter=function(){return null!==this.playlistItem&&"Ad"===this.playlistItem.type?xt.withDefault(this.eventReporters[this.playlistItem.adInstanceId],null):null},e.prototype.reset=function(){n.info("Resetting playlist tracking events"),this.playlistItem=null,this.eventReporters={}},e}();t.PlaylistTrackingEventReporter=r});e(dO);dO.PlaylistTrackingEventReporter;var pO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.compositeState={}}return e.prototype.onEvent=function(e,t,n){"state"===t&&(this.compositeState[e]=n)},Object.defineProperty(e.prototype,"state",{get:function(){return this.compositeState.timestamp=Date.now(),this.compositeState},enumerable:!0,configurable:!0}),e}();t.StateSnapshotDiagnosticsSink=n});e(pO);pO.StateSnapshotDiagnosticsSink;var fO=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("ExcessiveWaitingTracker"),i=function(){function e(e){this.waitTimeoutId=null,this.isExcessiveWaiting=!1,this.stateJsonReplacer=function(e,t){return t instanceof Error?n({name:t.name,message:t.message,stack:t.stack},t):"number"!=typeof t||isFinite(t)&&!isNaN(t)?t:t.toString()},this.mediaEventController=e,this.stateSnapshotDiagnosticsSink=new pO.StateSnapshotDiagnosticsSink,pp.Diagnostics.addSink(this.stateSnapshotDiagnosticsSink),null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.errors&&null!=up.configurationStore.configuration.errors.sessionAbandonedAsFatal?this.sessionAbandonedAsFatalError=!0===up.configurationStore.configuration.errors.sessionAbandonedAsFatal:this.sessionAbandonedAsFatalError=!0,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.weblabs&&this.stateSnapshotDiagnosticsSink.onEvent("weblabs","state",up.configurationStore.configuration.weblabs)}return e.prototype.destroy=function(){this.contentUnloaded(),pp.Diagnostics.removeSink(this.stateSnapshotDiagnosticsSink)},e.prototype.waitingStarted=function(){var e=this;null==this.waitTimeoutId&&(this.waitTimeoutId=A.timer.setTimeout(function(){r.error("EXCESSIVE_WAITING",JSON.stringify(e.stateSnapshotDiagnosticsSink.state,e.stateJsonReplacer,2)),e.reportExcessiveWaiting(),MT.metrics.putMetric("ExcessiveWait"),e.isExcessiveWaiting=!0},3e4))},e.prototype.waitingCompleted=function(){null!=this.waitTimeoutId&&(A.timer.clearTimeout(this.waitTimeoutId),this.waitTimeoutId=null,this.isExcessiveWaiting=!1)},e.prototype.contentUnloaded=function(){this.isExcessiveWaiting&&(r.error("session_abandoned: Content unloaded after an excessive waiting!"),MT.metrics.putMetric("SessionAbandoned"),this.reportSessionAbandoned(),this.isExcessiveWaiting=!1),null!=this.waitTimeoutId&&(A.timer.clearTimeout(this.waitTimeoutId),this.waitTimeoutId=null)},e.prototype.reportExcessiveWaiting=function(){var e=new Ne.XpError("excessive_waiting");this.mediaEventController.reportError(!1,e,"Player","Error")},e.prototype.reportSessionAbandoned=function(){var e=new Ne.XpError("session_abandoned");this.mediaEventController.reportError(this.sessionAbandonedAsFatalError,e,"Player","Error")},e}();t.ExcessiveWaitingTracker=i});e(fO);fO.ExcessiveWaitingTracker;var hO=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={})[Xh.BrowserType.Chrome]=Ce.Version.fromNumber(64),n[Xh.BrowserType.Chromium]=Ce.Version.fromNumber(64),n[Xh.BrowserType.EdgeNext]=Ce.Version.fromNumber(64),n[Xh.BrowserType.Firefox]=Ce.Version.fromNumber(59),n[Xh.BrowserType.Firefox64]=Ce.Version.fromNumber(59),n[Xh.BrowserType.Opera]=Ce.Version.fromNumber(52),n),i=function(){function e(){this.weblabs={}}return e.prototype.initialize=function(e){null!=e&&(this.weblabs=e)},e.prototype.isLiveLowLatencySupported=function(){if(this.isLiveLowLatencyBetaForcefullyEnabled())return!0;if(!this.isPlatformCapable())return!1;var e;switch(Xh.getBrowser().getType()){case Xh.BrowserType.Chrome:e="T1"===this.weblabs[ct.Weblabs.LIVE_LOW_LATENCY_CHROME];break;case Xh.BrowserType.Chromium:e="T1"===this.weblabs[ct.Weblabs.LIVE_LOW_LATENCY_CHROMIUM];break;case Xh.BrowserType.EdgeNext:e="T1"===this.weblabs[ct.Weblabs.LIVE_LOW_LATENCY_EDGENEXT];break;case Xh.BrowserType.Firefox:e="T1"===this.weblabs[ct.Weblabs.LIVE_LOW_LATENCY_FIREFOX];break;case Xh.BrowserType.Firefox64:e="T1"===this.weblabs[ct.Weblabs.LIVE_LOW_LATENCY_FIREFOX64];break;case Xh.BrowserType.Opera:e="T1"===this.weblabs[ct.Weblabs.LIVE_LOW_LATENCY_OPERA];break;default:e=!1}return e},e.prototype.isPlatformCapable=function(){var e=Xh.getBrowser().getType(),t=Xh.getBrowser().getVersion();return e in r&&r[e].compareTo(t)<=0},e.prototype.isUdpFallbackDisabled=function(){return!0===sp.QueryString.getParameter("udpFallbackDisabled")},e.prototype.isLiveLowLatencyBetaForcefullyEnabled=function(){return!0===sp.QueryString.getParameter("liveLowLatencyBeta")},e}();t.LiveLowLatencyContextWeb=i});e(hO);hO.LiveLowLatencyContextWeb;var mO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("LiveLowLatencyLoaderWeb"),n=function(){function e(){}return e.prototype.load=function(e,t,r){var n=this,i=e.SyeWASM,o=e.SyeJS,a=e.SyeClientJS;window.Module={locateFile:function(e,t){return i.filename===e?i.url:""+t+e}};var s=new Fe.Promise(function(e){window.Module.onRuntimeInitialized=e});window[o.name]={};var l={url:o.url,name:o.name,type:Ht.ScriptType.JavaScript,version:"0.0.0.0"},u={url:a.url,name:a.name,type:Ht.ScriptType.JavaScript,version:"0.0.0.0"};this.loadScript(l).then(function(){return s}).then(function(){return n.loadScript(u)}).then(t).catch(function(e){var t=e.error,n=e.errorMessage;c.error("Downloading of Live Low Latency SDK failed: "+t+" - "+n),r("LiveLowLatencyJavaScriptDownloadError",n,!0)})},e.prototype.loadScript=function(n){var e=new Ht.JavaScriptLoader,i=function(e){var t=e&&F.isFunction(e.toString)?e.toString():"Unknown Error";c.error(t)};return new Fe.Promise(function(t,r){e.get(n,function(e){c.info(JSON.stringify(e)),t(window[n.name])},function(e,t){var n=e&&F.isFunction(e.toString)?e.toString():"Unknown Error";c.error(n),r({error:e,errorMessage:n})},i)})},e}();t.LiveLowLatencyLoaderWeb=n});e(mO);mO.LiveLowLatencyLoaderWeb;var yO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=new hO.LiveLowLatencyContextWeb;t.liveLowLatencyContext=n;var r=new mO.LiveLowLatencyLoaderWeb;t.liveLowLatencyLoader=r});e(yO);yO.liveLowLatencyContext,yO.liveLowLatencyLoader;var gO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.adBreaks=e}return e.prototype.mediaTimeToMainContentTime=function(e){for(var t=0,n=0,r=0,i=this.adBreaks;r<i.length;r++){var o=i[r];if(e<=o.timestampMs)return t+(e-n);if(t+=o.timestampMs-n,e<o.timestampMs+o.durationMs)return t;n=o.timestampMs+o.durationMs}return t+(e-n)},e}();t.MainContentTimeTranslator=n});e(gO);gO.MainContentTimeTranslator;var vO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.lookbackWindowMs=1e3*e,this.multicastCallback=new Dt.MulticastCallback}return e.prototype.updateTimelineInfo=function(e){this.timelineInfo=e,this.multicastCallback.invoke()},e.prototype.onAvailable=function(e){this.multicastCallback.add(e)},e.prototype.offAvailable=function(e){this.multicastCallback.remove(e)},Object.defineProperty(e.prototype,"startMs",{get:function(){var e=this.timelineInfo;return null==e?0:Math.max(0,e.livePosUtcMillis-this.lookbackWindowMs)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endMs",{get:function(){var e=this.timelineInfo;return null==e?1/0:e.livePosUtcMillis},enumerable:!0,configurable:!0}),e}();t.LiveLowLatencyTimeWindow=n});e(vO);vO.LiveLowLatencyTimeWindow;var SO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.maxVideoBitrateBps=1/0,this.streamSelector=null,this.getStatistics=function(){return null},this.syeUrls=e,this.sourceUrlStore=t,this.vcid=n;var r=null!=e.duration?e.duration:0;this.timeWindow=new vO.LiveLowLatencyTimeWindow(r)}return e.prototype.flush=function(){},e.prototype.getLicense=function(e,t,n){return Fe.Promise.resolve()},e.prototype.isEncrypted=function(){return Fe.Promise.resolve(!1)},e.prototype.setStreamMatchers=function(e,t){null!==this.streamSelector&&this.streamSelector.setStreamMatchers(e,t)},e.prototype.setMaxBitrateThreshold=function(e,t,n){"Video"===e&&"ExternalNetwork"===t&&(this.maxVideoBitrateBps=n)},e.prototype.setUnsupportedCodecs=function(e,t){},e.prototype.start=function(e){},e.prototype.stop=function(){},e.prototype.on=function(e,t){},e.prototype.off=function(e,t){},e}();t.LiveLowLatencyContentSource=n});e(SO);SO.LiveLowLatencyContentSource;var bO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.UseSingleCCEnabled=!0,e.EgressContactTimeThresholdInMs=500,e.StatisticsNotificationIntervalInMs=5e3,e.Resources={SyeWASM:{filename:"sye.wasm",name:"SyeWASM",url:"https://cloudfront.xp-assets.aiv-cdn.net/packages/LiveLowLatencyWebSDK-1.0/prod/LiveLowLatencyWebSDK/sye.wasm"},SyeJS:{filename:"sye.js",name:"SyeJS",url:"https://cloudfront.xp-assets.aiv-cdn.net/packages/LiveLowLatencyWebSDK-1.0/prod/LiveLowLatencyWebSDK/sye.js"},SyeClientJS:{filename:"syeClient.js",name:"SyeClient",url:"https://cloudfront.xp-assets.aiv-cdn.net/packages/LiveLowLatencyWebSDK-1.0/prod/LiveLowLatencyWebSDK/syeClient.js"}},e.LocaleAndDisplayNameOverrideMap={eng:"English",aua:"Storm - Kremer",aub:"Scout’s Feed",spa:"Spanish"},e}();t.LiveLowLatencyConfigurations=n});e(bO);bO.LiveLowLatencyConfigurations;var TO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.monitorContext=e,this.SyeClientSDK=e.SyeClientSDK,this.syePlayer=e.syePlayer,this.eventEmitter=e.eventEmitter}return e.prototype.initialize=function(){},e.prototype.uninitialize=function(){},e}();t.Monitor=n});e(TO);TO.Monitor;var PO=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.initialize=function(){var t=this;this.syePlayer.onAudioTracksCallback=function(e){return t.onAudioTracksCallback(e)},this.syePlayer.onAudioTrackChangeCallback=function(){return t.onAudioTrackChangeCallback()}},t.prototype.uninitialize=function(){this.syePlayer.onAudioTracksCallback=null},t.prototype.onAudioTracksCallback=function(e){this.monitorContext.audioTracksArray=e,this.monitorContext.streamSelector.onAudioTracksCallback(e)},t.prototype.onAudioTrackChangeCallback=function(){this.monitorContext.streamSelector.onAudioTrackChangeCallback()},t}(TO.Monitor);t.AudioTrackMonitor=i});e(PO);PO.AudioTrackMonitor;var wO=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.useSingleCCEnabled=bO.LiveLowLatencyConfigurations.UseSingleCCEnabled,e}return n(e,t),e.prototype.initialize=function(){var t=this;this.syePlayer.onAvailableClosedCaptionsChannelsCallback=function(e){return t.onAvailableClosedCaptionsChannelsCallback(e)},this.syePlayer.onAvailableClosedCaptionsServicesCallback=function(e){return t.onAvailableClosedCaptionsServicesCallback(e)}},e.prototype.uninitialize=function(){this.syePlayer.onAvailableClosedCaptionsChannelsCallback=null,this.syePlayer.onAvailableClosedCaptionsServicesCallback=null},e.prototype.onAvailableClosedCaptionsChannelsCallback=function(e){this.useSingleCCEnabled&&1<=e.length?this.monitorContext.channelIndexes=e.slice(0,1):this.monitorContext.channelIndexes=e,this.monitorContext.textTrack.closedCaptionsUpdated(),this.monitorContext.streamSelector.onAvailableClosedCaptionsChannelsCallback(this.monitorContext.channelIndexes)},e.prototype.onAvailableClosedCaptionsServicesCallback=function(e){this.monitorContext.channelServices=e,this.monitorContext.textTrack.closedCaptionsUpdated()},e}(TO.Monitor);t.ClosedCaptionMonitor=i});e(wO);wO.ClosedCaptionMonitor;var CO=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("ErrorMonitor"),i=function(i){function e(e,t,n){var r=i.call(this,e)||this;return r.consecutiveRetryAttempt=0,r.onTimeUpdate=function(){r.consecutiveRetryAttempt=0},r.sourceUrlStore=t,r.triggerFrontendFailover=n,r}return n(e,i),e.prototype.initialize=function(){var r=this;this.syePlayer.onErrorCallback=function(e,t){return r.onErrorCallback(e,t)},this.syePlayer.onErrorRetryCallback=function(e,t,n){return r.onErrorRetryCallback(e,t,n)}},e.prototype.uninitialize=function(){this.syePlayer.onErrorCallback=null,this.syePlayer.onErrorRetryCallback=null,this.consecutiveRetryAttempt=0,this.monitorContext.eventEmitter.off("timeupdate",this.onTimeUpdate)},e.prototype.onErrorCallback=function(e,t){var n=Ne.Errors.newError(e,t);this.monitorContext.syeError=n;var r=this.sourceUrlStore.get().channelId;e!==this.SyeClientSDK.SyePlayerError.kTimeshiftOutOfRange?this.triggerFrontendFailover(n):this.syePlayer.playFromLive(r)},e.prototype.onErrorRetryCallback=function(e,t,n){var r=Ne.Errors.newError(e,t);if(this.monitorContext.syeError=r,o.info("Retrying after "+n+"ms with player error:",r),15e3<n){var i=Ne.XpError.generatePrefixedError(r,"sye.excessive_retry_time");this.monitorContext.mpPlayerStateMachine.act("error",i)}else this.attemptResumingPlaybackForPlayerAfter(n)},e.prototype.attemptResumingPlaybackForPlayerAfter=function(e){var t=this;if(3<=this.consecutiveRetryAttempt){var n=Ne.XpError.generatePrefixedError(this.monitorContext.syeError,"sye.max_retries_allowed");this.monitorContext.mpPlayerStateMachine.act("error",n)}else A.timer.setTimeout(function(){t.syePlayer.playerState()===t.SyeClientSDK.SyePlayerState.kError?(o.info("Attempting retry of playResume()."),t.syePlayer.playResume(),t.consecutiveRetryAttempt++,t.eventEmitter.once("timeupdate",t.onTimeUpdate)):o.info("Skipping retry - Player no longer in an error state.")},e)},e}(TO.Monitor);t.ErrorMonitor=i});e(CO);CO.ErrorMonitor;var MO=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("NotificationMonitor"),i=function(i){function e(e,t,n){var r=i.call(this,e)||this;return r.triggerEndOfStream=t,r.vcid=n,r}return n(e,i),e.prototype.initialize=function(){var t=this;this.syePlayer.onNotificationMessageCallback=function(e){return t.onNotificationMessageCallback(e)}},e.prototype.uninitialize=function(){this.syePlayer.onNotificationMessageCallback=null},e.prototype.onNotificationMessageCallback=function(t){var e;this.monitorContext.currentNotificationMessage=t;try{var n=String.fromCharCode.apply(null,t.data);e=JSON.parse(n)}catch(e){return void o.error("Failed to handle notification with messageId "+t.messageId)}null!=e.filter&&e.filter.vcid!==this.vcid||("quit"===e.signal?this.triggerEndOfStream():o.warn("Ignoring unknown signal '"+e.signal+"'"))},e}(TO.Monitor);t.NotificationMonitor=i});e(MO);MO.NotificationMonitor;var IO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.hasPlayerStartedPlaying=!1,this.onTimeUpdateReady=function(){var e=t.monitorContext.currentToState;null!=e&&t.processState(e)},this.monitorContext=e,this.mpPlayerStateMachine=e.mpPlayerStateMachine,this.SyeClientSDK=e.SyeClientSDK}return e.prototype.processState=function(e){switch(e){case this.SyeClientSDK.SyePlayerState.kStopped:this.hasPlayerStartedPlaying&&this.tryBecomeReady();break;case this.SyeClientSDK.SyePlayerState.kLoading:this.mpPlayerStateMachine.act("waiting");break;case this.SyeClientSDK.SyePlayerState.kPlaying:this.hasPlayerStartedPlaying=!0,this.tryBecomeReady();break;case this.SyeClientSDK.SyePlayerState.kStalled:case this.SyeClientSDK.SyePlayerState.kAIS:case this.SyeClientSDK.SyePlayerState.kError:this.mpPlayerStateMachine.act("waiting");break;default:this.mpPlayerStateMachine.act("error",new Ne.XpError("sye.invalid_state",void 0,"Invalid SyePlayerState: "+e))}},e.prototype.teardown=function(){this.hasPlayerStartedPlaying=!1,this.monitorContext.eventEmitter.off("timeupdate",this.onTimeUpdateReady)},e.prototype.tryBecomeReady=function(){null!=this.monitorContext.timelineInfo?this.mpPlayerStateMachine.act("ready"):this.monitorContext.eventEmitter.once("timeupdate",this.onTimeUpdateReady)},e}();t.ContentStateController=n});e(IO);IO.ContentStateController;var EO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("PlaybackStateController"),r=function(){function e(e){this.monitorContext=e,this.SyeClientSDK=e.SyeClientSDK,this.eventEmitter=e.eventEmitter}return e.prototype.processState=function(e){var t=this.stateReducer(e);t!==this.monitorContext.currentPlaybackState&&(this.monitorContext.currentPlaybackState=t,n.info("PlaybackState change:",t),this.eventEmitter.emit("playbackStateChange",{playbackState:t}))},e.prototype.stateReducer=function(e){switch(e){case this.SyeClientSDK.SyePlayerState.kStopped:case this.SyeClientSDK.SyePlayerState.kLoading:return"paused";case this.SyeClientSDK.SyePlayerState.kPlaying:case this.SyeClientSDK.SyePlayerState.kStalled:case this.SyeClientSDK.SyePlayerState.kAIS:return"playing";case this.SyeClientSDK.SyePlayerState.kError:return"paused";default:throw new Error("Invalid SyePlayerState: "+e)}},e}();t.PlaybackStateController=r});e(EO);EO.PlaybackStateController;var _O=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("PlaybackStateMonitor"),n=function(n){function e(e){var t=n.call(this,e)||this;return t.contentStateController=new IO.ContentStateController(e),t.playbackStateController=new EO.PlaybackStateController(e),t}return i(e,n),e.prototype.initialize=function(){var n=this;this.syePlayer.onStateChangeCallback=function(e,t){return n.onStateChangeCallback(e,t)}},e.prototype.uninitialize=function(){this.syePlayer.onStateChangeCallback=null,this.contentStateController.teardown()},e.prototype.onStateChangeCallback=function(e,t){o.info("State changed from: "+this.SyeClientSDK.SyePlayerState[e]+" to "+this.SyeClientSDK.SyePlayerState[t]),this.monitorContext.currentFromState=e,this.monitorContext.currentToState=t,this.contentStateController.processState(t),this.playbackStateController.processState(t)},e}(TO.Monitor);t.PlaybackStateMonitor=n});e(_O);_O.PlaybackStateMonitor;var xO=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.monitorIntervalId=null,e}return n(e,t),e.prototype.initialize=function(){this.startMonitoring(bO.LiveLowLatencyConfigurations.StatisticsNotificationIntervalInMs)},e.prototype.uninitialize=function(){this.stopMonitoring()},e.prototype.startMonitoring=function(e){var t=this;null===this.monitorIntervalId&&(this.monitorIntervalId=A.timer.setInterval(function(){t.monitorContext.currentPlayerStatistics=t.syePlayer.getStatistics()},e))},e.prototype.stopMonitoring=function(){null!==this.monitorIntervalId&&(A.timer.clearInterval(this.monitorIntervalId),this.monitorIntervalId=null)},e}(TO.Monitor);t.StatisticsMonitor=i});e(xO);xO.StatisticsMonitor;var kO=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(e,t){var n=r.call(this,e)||this;return n.timeWindow=t,n}return n(e,r),e.prototype.initialize=function(){var t=this;this.syePlayer.onTimelineUpdateCallback=function(e){return t.onTimelineUpdateCallback(e)}},e.prototype.uninitialize=function(){this.syePlayer.onTimelineUpdateCallback=null},e.prototype.onTimelineUpdateCallback=function(e){this.monitorContext.timelineInfo=e,null!==this.monitorContext.currentToVideoTrack&&this.monitorContext.eventEmitter.emit("timeupdate",{positionMs:e.currentPosUtcMillis,periodId:""+this.monitorContext.currentToVideoTrack.trackId,manifestTimeMs:e.currentPosUtcMillis,mediaWallClockUtcTimeMs:e.currentPosUtcMillis}),this.timeWindow.updateTimelineInfo(e)},e}(TO.Monitor);t.TimelineMonitor=i});e(kO);kO.TimelineMonitor;var RO=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("UDPMonitor"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.initialize=function(){var e=this;this.syePlayer.onEgressAllocatedCallback=function(){return e.onEgressAllocatedCallback()},this.syePlayer.onEgressContactCallback=function(){return e.onEgressContactCallback()}},t.prototype.uninitialize=function(){this.syePlayer.onEgressAllocatedCallback=null,this.syePlayer.onEgressContactCallback=null},t.prototype.onEgressAllocatedCallback=function(){this.monitorContext.isUDPConnectionSuccessful||yO.liveLowLatencyContext.isUdpFallbackDisabled()||this.startUDPTimeout(bO.LiveLowLatencyConfigurations.EgressContactTimeThresholdInMs)},t.prototype.onEgressContactCallback=function(){this.monitorContext.isUDPConnectionSuccessful=!0,null!=this.udpTimeoutId&&A.timer.clearTimeout(this.udpTimeoutId)},t.prototype.startUDPTimeout=function(e){var t=this;this.udpTimeoutId=A.timer.setTimeout(function(){t.monitorContext.isUDPConnectionSuccessful=!1,i.info("Egress contact failed - Falling back"),t.monitorContext.mpPlayerStateMachine.act("error",new Ne.XpError("sye.udp_timeout"))},e)},t}(TO.Monitor);t.UDPMonitor=o});e(RO);RO.UDPMonitor;var AO=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("VideoTrackMonitor"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.initialize=function(){var n=this;this.syePlayer.onVideoTrackChangeCallback=function(e,t){return n.onVideoTrackChangeCallback(e,t)}},t.prototype.uninitialize=function(){this.syePlayer.onVideoTrackChangeCallback=null},t.prototype.onVideoTrackChangeCallback=function(e,t){i.info("VideoTrack changed from: "+this.videoTrackInformation(e)+" to "+this.videoTrackInformation(t)),this.monitorContext.currentFromVideoTrack=null==e?null:e,this.monitorContext.currentToVideoTrack=t},t.prototype.videoTrackInformation=function(e){return null==e?"[undefined]":"["+e.trackId+": "+e.width+"x"+e.height+" bitrate("+e.bitrate+")]"},t}(TO.Monitor);t.VideoTrackMonitor=o});e(AO);AO.VideoTrackMonitor;var OO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i,o){this.monitors=[],this.monitors=[new PO.AudioTrackMonitor(e),new wO.ClosedCaptionMonitor(e),new CO.ErrorMonitor(e,o,n),new _O.PlaybackStateMonitor(e),new MO.NotificationMonitor(e,t,r),new xO.StatisticsMonitor(e),new kO.TimelineMonitor(e,i),new RO.UDPMonitor(e),new AO.VideoTrackMonitor(e)];for(var a=0,s=this.monitors;a<s.length;a++){s[a].initialize()}}return e.prototype.destroy=function(){for(var e=0,t=this.monitors;e<t.length;e++){t[e].uninitialize()}this.monitors=[]},e}();t.MonitorController=n});e(OO);OO.MonitorController;var LO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t,n,r,i,o){this.isUDPConnectionSuccessful=!1,this.timelineInfo=null,this.audioTracksArray=null,this.availableAudioLanguages=null,this.videoTracksArray=null,this.currentFromVideoTrack=null,this.currentToVideoTrack=null,this.channelIndexes=[],this.channelServices=[],this.syeError=null,this.currentNotificationMessage=null,this.currentFromState=null,this.currentToState=null,this.currentPlayerStatistics=null,this.currentPlaybackState="paused",this.SyeClientSDK=e,this.syePlayer=t,this.eventEmitter=n,this.textTrack=r,this.mpPlayerStateMachine=i,this.streamSelector=o};t.MonitorContext=n});e(LO);LO.MonitorContext;var FO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getAggregateBufferedRanges=function(e){return new Rp.NumberLine},e.prototype.getBufferInformation=function(){return{}},e.prototype.getBufferedRanges=function(e){return new Rp.NumberLine},e.prototype.getFrontBufferLengthMs=function(e){return 0},e.prototype.isBufferedToEnd=function(e){return!1},e}();t.LiveLowLatencyBufferInformationProvider=n});e(FO);FO.LiveLowLatencyBufferInformationProvider;var DO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.videoElement=null}return e.prototype.isPictureInPicture=function(){return null!=this.videoElement&&null!=document&&this.videoElement===document.pictureInPictureElement},e.prototype.isSupported=function(){return null!=document&&"pictureInPictureEnabled"in document},e.prototype.requestPictureInPicture=function(){return null!=this.videoElement?this.videoElement.requestPictureInPicture():Fe.Promise.reject("requestPictureInPicture() failed due to feature not being initialized")},e.prototype.exitPictureInPicture=function(){return null!=document?document.exitPictureInPicture():Fe.Promise.reject("exitPictureInPicture() failed due to feature not being initialized")},e.prototype.offChange=function(e){null!=this.videoElement&&(this.videoElement.removeEventListener("enterpictureinpicture",e),this.videoElement.removeEventListener("leavepictureinpicture",e))},e.prototype.onChange=function(e){null!=this.videoElement&&(this.videoElement.addEventListener("enterpictureinpicture",e),this.videoElement.addEventListener("leavepictureinpicture",e))},e.prototype.registerPlayer=function(e){this.videoElement=e},e.prototype.unload=function(){this.videoElement=null},e}();t.LiveLowLatencyPictureInPictureFeature=n});e(DO);DO.LiveLowLatencyPictureInPictureFeature;var NO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.liveLowLatencyVideoPlaybackQuality={corruptedVideoFrames:0,creationTime:0,droppedVideoFrames:0,totalFrameDelay:0,totalVideoFrames:0}});e(NO);NO.liveLowLatencyVideoPlaybackQuality;var UO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.eventEmitter=e}return e.prototype.getCurrentQualityInfo=function(e){return null},e.prototype.getVideoDecodePerformance=function(){return NO.liveLowLatencyVideoPlaybackQuality},e.prototype.off=function(e,t,n){},e.prototype.on=function(e,t,n){},e.prototype.onStreamGroupChange=function(e){this.eventEmitter.on("streamGroupChange",e)},e.prototype.offStreamGroupChange=function(e){this.eventEmitter.off("streamGroupChange",e)},e.prototype.emitStreamGroupChange=function(e){this.eventEmitter.emit("streamGroupChange",e)},e}();t.LiveLowLatencyPlaybackQualityProvider=n});e(UO);UO.LiveLowLatencyPlaybackQualityProvider;var BO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.eventEmitter=new Dt.EventEmitter,this.bufferedIntervalsMs=[],this.cues=[]}return e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.closedCaptionsUpdated=function(){},e}();t.LiveLowLatencyTextTrack=n});e(BO);BO.LiveLowLatencyTextTrack;var VO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.syePlayer=null,this.lastRequestedVolume=0,this.multicastCallback=new Dt.MulticastCallback}return Object.defineProperty(e.prototype,"volume",{get:function(){return null==this.syePlayer?this.lastRequestedVolume:this.syePlayer.getAudioVolume()},set:function(e){this.lastRequestedVolume=e,null!=this.syePlayer&&e!==this.volume&&(this.syePlayer.audioVolume(e),this.multicastCallback.invoke())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return 0===this.volume},set:function(e){null!=this.syePlayer&&e!==this.muted&&(this.volume=e?0:this.lastRequestedVolume,this.multicastCallback.invoke())},enumerable:!0,configurable:!0}),e.prototype.offChange=function(e){this.multicastCallback.remove(e)},e.prototype.onChange=function(e){this.multicastCallback.add(e)},e.prototype.registerPlayer=function(e){this.syePlayer=e,this.syePlayer.audioVolume(this.lastRequestedVolume)},e.prototype.unload=function(){this.syePlayer=null,this.multicastCallback.removeAll()},e}();t.LiveLowLatencyVolumeFeature=n});e(VO);VO.LiveLowLatencyVolumeFeature;var jO=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var d=M.get("LiveLowLatencyStreamSelector"),p=bO.LiveLowLatencyConfigurations.UseSingleCCEnabled,r=function(){function e(e,t,n){var r,i;this.currentAudioStreamGroup={type:"Audio",streams:[],activeId:null},this.currentTimedTextStreamGroup={type:"TimedText",streams:[],activeId:null},this.currentStreamMatchers=((r={}).Audio=[],r.Video=[],r.TimedText=[],r),this.streamMatcherUpdateActionMap=((i={}).Audio=this.selectPreferredAudioTrack,i.TimedText=this.selectPreferredClosedCaptionTrack,i.Video=function(){},i),this.SyeClientSDK=e,this.syePlayer=t,this.playbackQualityProvider=n}return e.prototype.setStreamMatchers=function(e,t){this.currentStreamMatchers[e]=t,this.streamMatcherUpdateActionMap[e].call(this)},e.prototype.onAudioTracksCallback=function(e){this.selectPreferredAudioTrack();var t=this.generateAudioStreams(this.filterSupportedAudioTracks(e));this.updateAudioStreamGroup({streams:t})},e.prototype.onAudioTrackChangeCallback=function(){var e=this.syePlayer.currentAudioTrack(),t=null!=e?""+e.trackId:null;this.updateAudioStreamGroup({activeId:t})},e.prototype.generateAudioStreams=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n],o={id:""+i.trackId,variants:[{id:""+i.trackId,bitrate:i.bitrate,restrictions:[]}],activeVariantId:""+i.trackId,language:i.language,type:"Dialog",label:bO.LiveLowLatencyConfigurations.LocaleAndDisplayNameOverrideMap[i.language]};t.push(o)}return t},e.prototype.updateAudioStreamGroup=function(e){this.currentAudioStreamGroup=n({},this.currentAudioStreamGroup,e),this.playbackQualityProvider.emitStreamGroupChange(this.currentAudioStreamGroup)},e.prototype.selectPreferredAudioTrack=function(){for(var e=this.currentStreamMatchers.Audio,t=this.getPreferredLanguageOrder(e),n=this.filterSupportedAudioTracks(this.syePlayer.audioTracks()),r=function(t){if(null!=F.find(n,function(e){return e.language===t})&&null!=t){d.info("Selecting audio track language: "+t);var e=i.syePlayer.getAudioSettings();return i.syePlayer.setAudioSettings({preferredLanguage:t,preferredCodec:i.SyeClientSDK.SyeAudioCodec.kAAC,preferredBitrate:e.preferredBitrate,preferredChannels:e.preferredChannels,switchMode:e.switchMode}),{value:void 0}}},i=this,o=0,a=t;o<a.length;o++){var s=r(a[o]);if("object"==typeof s)return s.value}},e.prototype.onAvailableClosedCaptionsChannelsCallback=function(e){var t=this.generateTimedTextStreams(e);this.updateTimedTextStreamGroup({streams:t}),this.selectPreferredClosedCaptionTrack()},e.prototype.generateTimedTextStreams=function(e){var t=[],n=this.filterSupportedAudioTracks(this.syePlayer.audioTracks());e.length>n.length&&d.warn("TimedText track length ("+e.length+") > AudioTrack length ("+n.length+")");for(var r=0,i=e;r<i.length;r++){var o=i[r],a=n[o];if(null!=a){var s=a.language,l=bO.LiveLowLatencyConfigurations.LocaleAndDisplayNameOverrideMap[s],u={id:""+o,variants:[{id:""+o,restrictions:[]}],activeVariantId:""+o,language:s||"und",type:"Subtitle",label:l||void 0};t.push(u)}else d.warn("Failed to find associated audio track for channel '"+o+"'. Ignoring.")}return t},e.prototype.selectPreferredClosedCaptionTrack=function(){for(var e=this.syePlayer.getAvailableClosedCaptionsChannels(),t=p&&1<=e.length?e.slice(0,1):e,n=this.filterSupportedAudioTracks(this.syePlayer.audioTracks()),r=this.currentStreamMatchers.TimedText,i=F.chain(t).zip(n).filter(function(e){return null!=e[0]&&null!=e[1]}).value(),o=this.getPreferredTimeTextLanguageOrder(r),a=function(t){var e=F.find(i,function(e){return e[1].language===t});if(null!=e){var n=e[0],r=e[1];return d.info("Selecting closed caption index: "+n+" language: "+r.language),s.syePlayer.selectClosedCaptionsChannel(n),s.syePlayer.setIsClosedCaptionsEnabled(!0),s.updateTimedTextStreamGroup({activeId:""+n}),{value:void 0}}},s=this,l=0,u=o;l<u.length;l++){var c=a(u[l]);if("object"==typeof c)return c.value}d.info("No match for closed captions found – Disabling closed captions."),this.syePlayer.setIsClosedCaptionsEnabled(!1),this.updateTimedTextStreamGroup({activeId:null})},e.prototype.updateTimedTextStreamGroup=function(e){this.currentTimedTextStreamGroup=n({},this.currentTimedTextStreamGroup,e),this.playbackQualityProvider.emitStreamGroupChange(this.currentTimedTextStreamGroup)},e.prototype.getPreferredLanguageOrder=function(e){return F.chain(e).map(function(e){return e.language}).filter(function(e){return null!=e}).uniq().value()},e.prototype.getPreferredTimeTextLanguageOrder=function(e){return F.chain(e).filter(function(e){return null!=e.language&&"Mandatory"!==e.textType}).map(function(e){return e.language}).uniq().value()},e.prototype.filterSupportedAudioTracks=function(e){var t=this;return e.filter(function(e){return e.codec===t.SyeClientSDK.SyeAudioCodec.kAAC})},e}();t.LiveLowLatencyStreamSelector=r});e(jO);jO.LiveLowLatencyStreamSelector;var XO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("SeekController"),n=function(){function e(e){var t=this;this.requestedSeekPositionMs=null,this.isPendingTimelineToSeek=!1,this.channelId=null,this.contentSource=null,this.monitorContext=null,this.syePlayer=null,this.triggerDeferredSeek=function(){null!=t.monitorContext&&null!=t.monitorContext.timelineInfo&&null!==t.requestedSeekPositionMs&&(t.eventEmitter.off("timeupdate",t.triggerDeferredSeek),t.isPendingTimelineToSeek=!1,t.seekAndPlay(t.requestedSeekPositionMs))},this.eventEmitter=e}return e.prototype.initialize=function(e,t,n,r){this.syePlayer=e,this.monitorContext=t,this.contentSource=n,this.SyePlaybackType=r},e.prototype.uninitialize=function(){this.syePlayer=null,this.monitorContext=null,this.contentSource=null,this.requestedSeekPositionMs=null,this.isPendingTimelineToSeek=!1,this.channelId=null,this.eventEmitter.off("timeupdate",this.triggerDeferredSeek)},e.prototype.setChannelId=function(e){this.channelId=e},e.prototype.seekAndPlay=function(e){if(null!=e&&(this.requestedSeekPositionMs=e),null!=this.requestedSeekPositionMs)if(null!=this.syePlayer&&null!=this.channelId)if(null!=this.contentSource){if(null==this.monitorContext||null==this.monitorContext.timelineInfo)this.useEstimatedTimelineToSeek(this.syePlayer,this.channelId,this.requestedSeekPositionMs);else{var t=this.monitorContext.timelineInfo,n=t.livePosUtcMillis,r=this.contentSource.timeWindow,i=Rp.clamp(this.requestedSeekPositionMs,r.startMs,r.endMs);i<n-8e3?this.syePlayer.playFromUtcTime(this.channelId,i):t.playbackType!==this.SyePlaybackType.kLive&&this.syePlayer.playFromLive(this.channelId)}this.requestedSeekPositionMs=null,this.eventEmitter.emit("seeking")}else o.warn("No ContentSource");else o.warn("No SyePlayer or channelId")},e.prototype.useEstimatedTimelineToSeek=function(e,t,n){if(2147483647e3<=n)e.playFromLive(t);else if(null!=this.contentSource){var r=this.contentSource.syeUrls.startTime,i=null!=r?new Date(r).getTime():0;isNaN(i)&&(i=0);var o=Math.max(i,n);e.playFromUtcTime(t,o)}},e.prototype.acquireTimelineToSeek=function(e,t){this.isPendingTimelineToSeek||(o.warn("Attempted to seek to "+this.requestedSeekPositionMs+"ms without a known timeline. Starting at Live to get a timeline"),e.playFromLive(t),this.isPendingTimelineToSeek=!0,this.eventEmitter.on("timeupdate",this.triggerDeferredSeek))},e}();t.SeekController=n});e(XO);XO.SeekController;var zO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.syePlayer=null,this.seekController=e,this.requestedPlaybackState="paused",this.hasStarted=!1}return e.prototype.initialize=function(e){this.syePlayer=e},e.prototype.uninitialize=function(){this.syePlayer=null,this.requestedPlaybackState="paused",this.hasStarted=!1},e.prototype.isRequestedToPlay=function(){return"playing"===this.requestedPlaybackState},e.prototype.pause=function(){this.requestedPlaybackState="paused",null!=this.syePlayer&&this.syePlayer.pause()},e.prototype.play=function(){this.requestedPlaybackState="playing",null!=this.syePlayer&&(this.hasStarted?this.syePlayer.playResume():(this.seekController.seekAndPlay(),this.hasStarted=!0))},e}();t.PlayPauseController=n});e(zO);zO.PlayPauseController;var qO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("MpPlayerLiveLowLatency"),n=function(){function e(e){var s=this;this.contentState="unloaded",this.pictureInPictureFeature=null,this.eventEmitter=new Dt.EventEmitter,this.SyeClientSDK=null,this.syePlayer=null,this.videoElement=null,this.monitorContext=null,this.monitorController=null,this.contentSource=null,this.isContentSourceLoadAttempted=!1,this.hasEnded=!1,this.streamSelector=null,this.excessiveWaitingTimeoutId=null,this.onLoad=function(e){s.contentSource=e,s.isContentSourceLoadAttempted=!0,s.hasEnded=!1,MT.metrics.putMetric("LiveLowLatency.Load");yO.liveLowLatencyLoader.load(bO.LiveLowLatencyConfigurations.Resources,function(e){s.SyeClientSDK=e;var t=s.SyeClientSDK;l.info("Setting up Sye SDK "+t.SdkVersion()+" succeeded");var n=s.contentSource,r=n.sourceUrlStore.get(),i=new s.SyeClientSDK.SyeDomain(r.url,r.cdn),o=new s.SyeClientSDK.SyeSystem(i,r.token);if(s.syePlayer=t.CreatePlayer(o,null,function(){s.mpPlayerStateMachine.act("error",new Ne.XpError("sye.player_creation_failed"))},function(){s.mpPlayerStateMachine.act("error",new Ne.XpError("sye.player_creation_failed",void 0,"create player retry failed"))}),null!=s.syePlayer){0<n.maxVideoBitrateBps&&n.maxVideoBitrateBps<1/0&&(l.info(">> setting max bitrate to "+n.maxVideoBitrateBps),s.syePlayer.setVideoSettings({minBitrate:0,maxBitrate:n.maxVideoBitrateBps,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0})),s.streamSelector=new jO.LiveLowLatencyStreamSelector(s.SyeClientSDK,s.syePlayer,s.playbackQualityProvider),n.streamSelector=s.streamSelector,s.monitorContext=new LO.MonitorContext(s.SyeClientSDK,s.syePlayer,s.eventEmitter,s.textTrack,s.mpPlayerStateMachine,s.streamSelector),s.monitorController=new OO.MonitorController(s.monitorContext,s.triggerEndOfStream,s.triggerFrontendFailover,n.vcid,n.timeWindow,n.sourceUrlStore),s.volumeFeature.registerPlayer(s.syePlayer);var a=document.createElement("video");s.surfaceRef.appendChild(a),a.setAttribute("width","100%"),a.setAttribute("height","100%"),s.videoElement=a,s.syePlayer.attachView(a),s.syePlayer.selectClosedCaptionsType(0),s.syePlayer.attachClosedCaptionsViewToSurface(s.surfaceRef),s.seekController.initialize(s.syePlayer,s.monitorContext,n,s.SyeClientSDK.SyePlaybackType),s.seekController.setChannelId(r.channelId),s.playPauseController.initialize(s.syePlayer),null!=s.pictureInPictureFeature&&s.pictureInPictureFeature.registerPlayer(s.videoElement),s.playPauseController.isRequestedToPlay()?s.playPauseController.play():s.mpPlayerStateMachine.act("ready")}else s.mpPlayerStateMachine.act("error",new Ne.XpError("sye.player_creation_failed",void 0,"syeApi.CreatePlayer() returned undefined"))},function(e,t,n){s.mpPlayerStateMachine.act("error",new Ne.XpError("sye.sdk_download_failed",e,t))}),e.getStatistics=s.getSyeStatistics},this.onUnload=function(){delete s.contentError,s.hasEnded=!1,s.playPauseController.uninitialize(),s.seekController.uninitialize(),null!==s.monitorController&&s.monitorController.destroy(),null!==s.pictureInPictureFeature&&s.pictureInPictureFeature.unload(),null!==s.volumeFeature&&s.volumeFeature.unload(),null!==s.contentSource&&(s.contentSource.getStatistics=function(){return null},s.contentSource=null),null!=s.syePlayer&&(s.syePlayer.stop(),s.syePlayer.detachView(),s.syePlayer.detachClosedCaptionsViewFromSurface(s.surfaceRef),s.surfaceRef.removeChild(s.videoElement),s.syePlayer.teardown(),s.videoElement=null,s.syePlayer=null),s.isContentSourceLoadAttempted=!1,s.mpPlayerStateMachine.act("unloaded")},this.getSyeStatistics=function(){if(null==s.monitorContext||null==s.monitorContext.currentPlayerStatistics)return null;var e;try{e=JSON.parse(s.monitorContext.currentPlayerStatistics)}catch(e){return l.error("Failed to parse SyePlayer statistics",e),null}return e},this.triggerEndOfStream=function(){var e=s.currentTimeMs;null===e&&(l.warn("End of stream triggered without a current position. Defaulting to `0`"),e=0),s.hasEnded=!0,s.eventEmitter.emit("durationchange",e),s.eventEmitter.emit("ended",e),s.pause()},this.triggerFrontendFailover=function(e){if(null!==s.contentSource&&null!==s.SyeClientSDK&&null!==s.syePlayer){var t=s.contentSource.sourceUrlStore.get().urlId;if(s.contentSource.sourceUrlStore.resourceAcquisitionFailed({type:"SourceError",cause:e},c_.AcquisitionResourceType.Fragment,t)){var n=s.contentSource.sourceUrlStore.get(),r=new s.SyeClientSDK.SyeDomain(n.url,n.cdn),i=new s.SyeClientSDK.SyeSystem(r,n.token);l.info("Update Sye system to "+n.cdn+": "+n.url),s.syePlayer.updateSyeSystem(i),s.seekController.setChannelId(n.channelId),s.playPauseController.play()}else s.mpPlayerStateMachine.act("error",new Ne.XpError("sye.player_state",void 0,e.toString()))}},this.excessiveWaitingTimeoutHandler=function(){s.mpPlayerStateMachine.act("error",new Ne.XpError("sye.excessive_waiting"))},this.isPictureInPictureFeatureEnabled=function(){return null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.liveLowLatency&&!0===up.configurationStore.configuration.liveLowLatency.enablePictureInPicture},this.surfaceRef=e,this.textTrack=new BO.LiveLowLatencyTextTrack,this.mpPlayerStateMachine=this.createContentStateMachine(),this.bufferInformationProvider=new FO.LiveLowLatencyBufferInformationProvider,this.playbackQualityProvider=new UO.LiveLowLatencyPlaybackQualityProvider(this.eventEmitter),this.volumeFeature=new VO.LiveLowLatencyVolumeFeature,this.seekController=new XO.SeekController(this.eventEmitter),this.playPauseController=new zO.PlayPauseController(this.seekController),this.isPictureInPictureFeatureEnabled()&&(this.pictureInPictureFeature=new DO.LiveLowLatencyPictureInPictureFeature)}return Object.defineProperty(e.prototype,"error",{get:function(){if(null!=this.monitorContext&&null!=this.monitorContext.syeError)return Ne.XpError.generatePrefixedError(this.monitorContext.syeError,"sye")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackState",{get:function(){return null===this.monitorContext?"paused":this.monitorContext.currentPlaybackState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTimeMs",{get:function(){return null!==this.monitorContext&&null!==this.monitorContext.timelineInfo?this.monitorContext.timelineInfo.currentPosUtcMillis:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackTime",{get:function(){if(null!==this.monitorContext&&null!==this.monitorContext.timelineInfo&&null!==this.monitorContext.currentToVideoTrack){var e=this.monitorContext.timelineInfo;return{positionMs:e.currentPosUtcMillis,periodId:""+this.monitorContext.currentToVideoTrack.trackId,manifestTimeMs:e.currentPosUtcMillis,mediaWallClockUtcTimeMs:e.currentPosUtcMillis}}return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.hasEnded},enumerable:!0,configurable:!0}),e.prototype.isSupported=function(e){return!0},e.prototype.destroy=function(){null!=this.syePlayer&&this.unload()},e.prototype.load=function(e,t){if(l.info(">> load"),this.isContentSourceLoadAttempted)l.info("Content source successfully loaded - Ignoring duplicate load() calls");else{var n=null!=t?t:1/0;this.seek(n),this.mpPlayerStateMachine.act("load",e)}},e.prototype.unload=function(){l.info(">> unload"),this.mpPlayerStateMachine.act("unload")},e.prototype.pause=function(){l.info(">> pause"),this.playPauseController.pause()},e.prototype.play=function(){var e=this;return l.info(">> play"),Fe.Promise.resolve().then(function(){e.playPauseController.play()})},e.prototype.seek=function(e){l.info(">> seek to "+e+"ms"),this.seekController.seekAndPlay(e)},e.prototype.seekToWallClockTime=function(e){l.info(">> seekToWallClockTime to "+e+"ms"),this.seek(e)},Object.defineProperty(e.prototype,"playbackRate",{get:function(){return 1},set:function(e){},enumerable:!0,configurable:!0}),e.prototype.getVolumeFeature=function(){return this.volumeFeature},e.prototype.getPictureInPictureFeature=function(){return this.pictureInPictureFeature},e.prototype.getPlaybackQualityProvider=function(){return this.playbackQualityProvider},e.prototype.getBufferInformationProvider=function(){return this.bufferInformationProvider},e.prototype.getDisplayController=function(){return null},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.show=function(){this.videoElement&&(this.videoElement.style.display="")},e.prototype.hide=function(){this.videoElement&&(this.videoElement.style.display="none")},e.prototype.isPlayerPlaying=function(){if(null==this.syePlayer)return!1;switch(this.syePlayer.playerState()){case yO.SyeClient.SyePlayerState.kStopped:case yO.SyeClient.SyePlayerState.kError:return!1;default:return!0}},e.prototype.createContentStateMachine=function(){var t=this,e=new $k.FiniteStateMachine("unloaded");e.addTransition("unloaded","load","waiting"),e.addTransition("unloaded","unload","unloaded"),e.addTransition("unloaded","error","error"),e.addTransition("waiting","ready","ready"),e.addTransition("waiting","waiting","waiting"),e.addTransition("waiting","unload","unloading"),e.addTransition("waiting","error","error"),e.addTransition("ready","waiting","waiting"),e.addTransition("ready","ready","ready"),e.addTransition("ready","unload","unloading"),e.addTransition("ready","error","error"),e.addTransition("unloading","unloaded","unloaded"),e.addTransition("unloading","unload","unloading"),e.addTransition("unloading","error","error"),e.addTransition("error","error","error"),e.addTransition("error","unload","unloading"),e.onTransition("unloaded","load",this.onLoad),e.onTransition("waiting","unload",this.onUnload),e.onTransition("ready","unload",this.onUnload),e.onTransition("error","unload",this.onUnload);var n=function(e){t.contentError=Ne.XpError.generatePrefixedError(e,"sye")};return e.onTransition("unloading","error",n),e.onTransition("unloaded","error",n),e.onTransition("waiting","error",n),e.onTransition("ready","error",n),e.onTransition("error","error",function(e){l.warn("Received content error while it's already in error state",e)}),e.onEnterState("unloaded",function(){t.onContentStateTransition("unloaded")}),e.onEnterState("waiting",function(){t.onContentStateTransition("waiting"),t.excessiveWaitingTimeoutId=A.timer.setTimeout(t.excessiveWaitingTimeoutHandler,15e3)}),e.onLeaveState("waiting",function(){null!==t.excessiveWaitingTimeoutId&&(A.timer.clearTimeout(t.excessiveWaitingTimeoutId),t.excessiveWaitingTimeoutId=null)}),e.onEnterState("ready",function(){t.onContentStateTransition("ready")}),e.onEnterState("error",function(){l.error("contentError: "+JSON.stringify(t.contentError)),t.onContentStateTransition("error")}),e.onIllegalTransition(function(e,t,n){l.error("IllegalTransitionError",e," :: ",t)}),e},e.prototype.onContentStateTransition=function(e){this.contentState=e,l.info("ContentState change: "+this.contentState),this.eventEmitter.emit("contentStateChange",this.contentState)},e}();t.MpPlayerLiveLowLatency=n});e(qO);qO.MpPlayerLiveLowLatency;var WO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.LiveLowLatencyContentSource=SO.LiveLowLatencyContentSource,t.MpPlayerLiveLowLatency=qO.MpPlayerLiveLowLatency});e(WO);WO.LiveLowLatencyContentSource,WO.MpPlayerLiveLowLatency;var HO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i){var o=this;this.playlistRelativeView=null,this.adBreakViews=[],this.onEnterView=function(){o.mediaEventController.updatePlaybackSettingsId(o.playbackSettingsId),o.mediaEventController.updateBufferSettings(o.bufferSettings),o.mediaEventController.updateConsumptionId(o.consumptionId),o.mediaEventController.updateTitleId(o.titleView.id.titleId);var e=o.titleView.getItems()[0];o.mediaEventController.updateMediaRepresentation(e.mediaRepresentation),e.contentSource instanceof WO.LiveLowLatencyContentSource&&o.mediaEventController.setBitstreamSource(e.contentSource)},this.onExitView=function(){o.reportInternalStop()},this.onEnterPlaylistRelativeView=function(){var e=o.playlistRelativeView.getItems()[0],t=e.timelineUnit===Gd.TimeUnit.EpochMillis?e.contentTimeToPlaylistTimeOffsetMs:null;o.mediaEventController.updateUtcMsAtZero(t)},this.onEnterAdBreakView=function(){o.mediaEventController.updatePlaybackContentContext("AdBreak")},this.onExitAdBreakView=function(){o.mediaEventController.updatePlaybackContentContext("Feature")},this.mediaEventController=e,this.titleView=t,this.playbackSettingsId=n,this.bufferSettings=r,this.consumptionId=i}return e.prototype.initialize=function(){this.titleView.on("EnterView",this.onEnterView),this.titleView.on("ExitView",this.onExitView)},e.prototype.terminate=function(){this.titleView.off("EnterView",this.onEnterView),this.titleView.off("ExitView",this.onExitView),this.reportInternalStop(),null!=this.playlistRelativeView&&this.playlistRelativeView.off("EnterView",this.onEnterPlaylistRelativeView);for(var e=0,t=this.adBreakViews;e<t.length;e++){var n=t[e];n.off("EnterView",this.onEnterAdBreakView),n.off("ExitView",this.onExitAdBreakView)}this.adBreakViews=[]},e.prototype.setPlaylistRelativeView=function(e){this.playlistRelativeView=e,this.playlistRelativeView.on("EnterView",this.onEnterPlaylistRelativeView)},e.prototype.clearPlaylistRelativeView=function(){null!=this.playlistRelativeView&&(this.playlistRelativeView.off("EnterView",this.onEnterPlaylistRelativeView),this.playlistRelativeView=null),this.mediaEventController.updateUtcMsAtZero(null)},e.prototype.appendAdBreakView=function(e){e.on("EnterView",this.onEnterAdBreakView),e.on("ExitView",this.onExitAdBreakView),this.adBreakViews.push(e)},e.prototype.updateConsumptionId=function(e){this.consumptionId=e,this.titleView.isActive()&&this.mediaEventController.updateConsumptionId(e)},e.prototype.reportInternalStop=function(){this.mediaEventController.reportPlayback("Stop")},e}();t.MediaEventReportingPlaylistListener=n});e(HO);HO.MediaEventReportingPlaylistListener;var GO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Qp.createCDPResponseProcessor(function(e,t,n,r){var i=xt.nestedValue(e,"message.body");null!==i?null!=i.statusCallbackIntervalSeconds&&null!=i.canStream?t({statusCallbackIntervalMs:1e3*i.statusCallbackIntervalSeconds,canStream:i.canStream}):r(new Ne.XpError("UpdateStream.Error.InvalidBodyResponse")):r(new Ne.XpError("UpdateStream.Error.NullResponseBody"))}),r=function(){function e(e){this.serviceClient=e.createServiceClient("/cdp/usage/UpdateStream",{firmware:"1",version:"1"},n,"updatestream")}return e.prototype.send=function(e,t,n,r,i,o){var a,s={accept:"application/json"};xt.sanitize(s,!0);var l=(n/1e3).toFixed(r?0:3),u={method:"GET",headers:s,queryParams:((a={titleId:e,event:t,userWatchSessionId:i})[r?"epochUtc":"timecode"]=l,a)};return this.serviceClient.send(u,o,"CRITICAL")},e}();t.UpdateStreamClient=r});e(GO);GO.UpdateStreamClient;var KO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateStreamClient=GO.UpdateStreamClient});e(KO);KO.UpdateStreamClient;var QO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("UpdateStreamListener"),n=function(){function e(e,t,n,r,i,o,a,s,l){var u,c=this;this.timer=A.timer,this.initialized=!1,this.hasStarted=!1,this.hasStopped=!1,this.updateIntervalMs=3e4,this.utcMsAtZero=null,this.lastKnownPositionMs=null,this.onEnterMainContentView=function(){c.hasStopped&&(c.hasStopped=!1,c.hasStarted=!1),F.contains(["ready","waiting"],c.mpPlayer.contentState)&&c.playbackStateTriggerMap[c.mpPlayer.playbackState]();var e=c.mainContentView.playlistEngine.getCurrentItem();c.utcMsAtZero=null!=e&&e.timelineUnit===Gd.TimeUnit.EpochMillis?e.contentTimeToPlaylistTimeOffsetMs:null,c.mpPlayer.on("playbackStateChange",c.onPlaybackStateChange),c.mpPlayer.on("contentStateChange",c.onContentStateChange),c.mpPlayer.on("timeupdate",c.onTimeUpdate)},this.onExitMainContentView=function(){c.mpPlayer.off("playbackStateChange",c.onPlaybackStateChange),c.mpPlayer.off("contentStateChange",c.onContentStateChange),c.mpPlayer.off("timeupdate",c.onTimeUpdate),c.titleView.isActive()||!c.hasStarted||c.hasStopped||(c.hasStopped=!0,c.report("STOP")),c.utcMsAtZero=null,c.clearReportTimeout()},this.onTimeUpdate=function(e){c.mainContentView.isActive()&&(c.lastKnownPositionMs=c.mainContentTimeTranslator.mediaTimeToMainContentTime(e.positionMs))},this.onPlaybackStateChange=function(e){c.playbackStateTriggerMap[e.playbackState]()},this.onContentStateChange=function(e){"unloaded"===e&&c.hasStarted&&!c.hasStopped?(c.hasStopped=!0,c.report("STOP")):"ready"===e&&c.playbackStateTriggerMap[c.mpPlayer.playbackState]()},this.onPlaying=function(){var e;c.hasStarted?e="PLAY":(c.hasStarted=!0,e="START"),c.report(e)},this.onPaused=function(){c.hasStarted&&c.report("PAUSE")},this.titleId=e,this.updateStreamClient=new KO.UpdateStreamClient(t),this.titleView=n,this.mainContentView=r,this.mainContentTimeTranslator=i,this.mpPlayer=o,this.userWatchSessionId=a,this.cancelPlaybackCallback=s,this.mediaEventController=l,this.playbackStateTriggerMap=((u={}).playing=this.onPlaying,u.paused=this.onPaused,u)}return e.prototype.initialize=function(){this.initialized=!0,this.mainContentView.on("EnterView",this.onEnterMainContentView),this.mainContentView.on("ExitView",this.onExitMainContentView)},e.prototype.terminate=function(){this.initialized=!1,this.mainContentView.off("EnterView",this.onEnterMainContentView),this.mainContentView.off("ExitView",this.onExitMainContentView),this.hasStarted&&!this.hasStopped&&(this.hasStopped=!0,this.report("STOP")),this.onExitMainContentView()},e.prototype.clearReportTimeout=function(){null!=this.scheduledReportTimeoutId&&(this.timer.clearTimeout(this.scheduledReportTimeoutId),delete this.scheduledReportTimeoutId)},e.prototype.report=function(e){if("STOP"!==e){var t=this.mpPlayer.currentTimeMs;null!==t&&(this.lastKnownPositionMs=this.mainContentTimeTranslator.mediaTimeToMainContentTime(t))}if(null===this.lastKnownPositionMs){var n="Cannot report UpdateStream event '"+e+"' without a current or last known position";return o.error(n),void this.mediaEventController.reportError(!1,new Error(n),"Player","Unknown")}this.reportForPosition(e,this.lastKnownPositionMs)},e.prototype.reportForPosition=function(e,t){var n=this,r=Fe.CancelToken.source(),i=r.token;r.cancel;this.updateStreamClient.send(this.titleId,e,xt.withDefault(this.utcMsAtZero,0)+t,null!=this.utcMsAtZero,this.userWatchSessionId,i).then(function(e){return e.response()}).then(function(e){i.throwIfRequested(),e.canStream||!n.initialized?n.updateIntervalMs=e.statusCallbackIntervalMs:n.cancelPlaybackCallback(new Ne.XpError(jA.codes.xp.content.concurrency_limit,void 0,void 0,!0))}).catch(function(e){i.throwIfRequested(),o.warn("UpdateStream request failed",e),MT.metrics.putMetric("ServiceRequest.UpdateStream.Error"),n.mediaEventController.reportError(!1,e,"Service","Error")}).then(function(){i.throwIfRequested(),"STOP"!==e&&("START"===e&&(e="PLAY"),n.scheduleUpdate(e))})},e.prototype.scheduleUpdate=function(e){var t=this;this.clearReportTimeout(),this.initialized&&(this.scheduledReportTimeoutId=this.timer.setTimeout(function(){t.report(e)},this.updateIntervalMs))},e}();t.UpdateStreamListener=n});e(QO);QO.UpdateStreamListener;var YO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.fragmentBuffers=e,this.validTypes=Object.keys(e),this.blockedSegmentTracker=t,this.bufferSettings=n}return e.prototype.getBufferInformation=function(e){for(var t={},n=0,r=this.validTypes;n<r.length;n++){var i=r[n],o=this.fragmentBuffers[i].getBufferedRanges();t[i]=this.getBufferRangesForStreamType(e,o,i)}return t},e.prototype.getBufferSizeInBytes=function(e,t,n){if(null!=n)return this.getBufferSizeInBytesForStreamType(e,t,n);for(var r=0,i=0,o=this.validTypes;i<o.length;i++){var a=o[i];r+=this.getBufferSizeInBytesForStreamType(e,t,a)}return r},e.prototype.getBufferedRanges=function(e){for(var t=null,n=0,r=Array.isArray(e)?e:[e];n<r.length;n++){var i=r[n],o=this.fragmentBuffers[i];if(null!=o){var a=o.getBufferedRanges();t=null!=t?t.intersection(a):a}}return null!=t?t:new Rp.NumberLine},e.prototype.isBufferedToEnd=function(e,t){for(var n=0,r=null==t?this.validTypes:[t];n<r.length;n++){var i=r[n],o=this.fragmentBuffers[i].getBufferedRanges().find(e),a=this.fragmentBuffers[i].getBufferedFinalFragment();if(null==o||null==a||o.end<a.position.endTimeMs)return!1}return!0},e.prototype.isBufferedToCapacity=function(e){for(var t=1/0,n=0,r=iE.CRITICAL_STREAM_TYPES;n<r.length;n++){var i=r[n],o=this.blockedSegmentTracker.getMinimumBlockedPositionMs(i);t=Math.min(t,o)}for(var a=!0,s=0,l=iE.CRITICAL_STREAM_TYPES;s<l.length;s++){i=l[s];var u=this.fragmentBuffers[i].getBufferedRanges().find(e);if(null===u)return!1;var c=u.end>=t;a=a&&c}return a},e.prototype.getValidTypes=function(){return this.validTypes},e.prototype.getBufferSizeInBytesForStreamType=function(e,t,n){if(t<=e)return 0;var r=new Rp.NumberLine;r.add({start:e,end:t});for(var i=this.fragmentBuffers[n],o=i.getBufferedRanges(),a=0,s=0,l=r.intersection(o).getIntervals();s<l.length;s++)for(var u=l[s],c=i.getMediaFragmentAt(u.start);null!=c&&c.position.startTimeMs<u.end;)null!=c.data&&(a+=c.data.byteLength),c=i.getNextMediaFragment(c);return a},e.prototype.getBufferRangesForStreamType=function(e,t,n){var r=this.createEmptyBufferedRange(),i=this.createEmptyBufferedRange();if(null!=t){var o=t.find(e);null!=o&&(r.startTimeMs=e,r.endTimeMs=o.end,r.sizeBytes=this.getBufferSizeInBytes(e,o.end,n),i.startTimeMs=o.start,i.endTimeMs=e,i.sizeBytes=this.getBufferSizeInBytes(o.start,e,n))}return{front:r,back:i}},e.prototype.createEmptyBufferedRange=function(){return{startTimeMs:0,endTimeMs:0,sizeBytes:0}},e}();t.BufferInformationCalculator=n});e(YO);YO.BufferInformationCalculator;var JO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("DefaultFragmentSource"),o=M.get("DefaultFragmentSource.shouldReset"),n=function(){function e(e,t,n,r,i,o,a,s){this.lastLocatedPeriod=null,this.started=!1,this.type=e,this.maxAcceptableSegmentPositionErrorMs=t,this.periodTailor=n,this.fragmentBuffer=r,this.downloadQueue=i,this.acquirer=o,this.eventEmitter=a,this.getPreferredStream=s}return e.prototype.fragmentConsumed=function(e){},e.prototype.getBitrateSwitchFragment=function(e,t){return null},e.prototype.getFragmentAt=function(t){var n=this;return this.started?(null!=this.lastLocatedPeriod&&t>=this.lastLocatedPeriod.startMs&&t<=this.lastLocatedPeriod.endMs?this.shouldReset(t)&&this.resetBuffer(t):this.periodTailor.getPeriodAt(t).then(function(e){null!=e&&(n.lastLocatedPeriod=e,n.shouldReset(t)&&n.resetBuffer(t))}),this.fragmentBuffer.getMediaFragmentAt(t)):null},e.prototype.getInitFragment=function(e,t,n){return this.fragmentBuffer.getInitFragment(e,n)},e.prototype.getNextFragment=function(e){return this.fragmentBuffer.getNextMediaFragment(e)},e.prototype.getStitchingInformation=function(e,t,n){return this.periodTailor.getStitchingInformation(e,this.type,t,n)},e.prototype.isDownloadingRange=function(e,t){if(t<=e)return!0;var n=this.downloadQueue.getQueuedRange();if(null===n)return!1;var r=new Rp.NumberLine;r.add({start:e,end:t});var i=this.fragmentBuffer.getBufferedRanges().clone();i.add({start:n.startMs,end:n.endMs});var o=i.intersection(r);return 1===o.getIntervals().length&&null!==o.find(e)&&null!==o.find(t)},e.prototype.isFinalSegment=function(e){return this.fragmentBuffer.isFinalSegment(e)},e.prototype.lockFragment=function(e){this.fragmentBuffer.lockFragment(e)},e.prototype.onUpdate=function(e){this.fragmentBuffer.onUpdate(e)},e.prototype.offUpdate=function(e){this.fragmentBuffer.offUpdate(e)},e.prototype.stop=function(){this.started=!1,this.acquirer.stop(),this.fragmentBuffer.flush(!0),this.downloadQueue.stop()},e.prototype.start=function(e){this.started=!0,this.resetBuffer(e)},e.prototype.shouldReset=function(e){if(!this.started)return o.enabledFor(M.INFO)&&o.info("shouldReset("+this.type+", "+e+"): false (FragmentSource is stopped)"),!1;if(null!=this.lastLocatedPeriod&&null===this.getPreferredStream(this.type,this.lastLocatedPeriod))return o.enabledFor(M.INFO)&&o.info("shouldReset("+this.type+", "+e+"): false (lastLocatedPeriod != null && getPreferredStream(...) === null)"),!1;if(this.fragmentBuffer.isBuffered(e))return o.enabledFor(M.INFO)&&o.info("shouldReset("+this.type+", "+e+"): false (position is in buffered ranges "+JSON.stringify(this.fragmentBuffer.getBufferedRanges())+")"),!1;var t=this.downloadQueue.getQueuedRange();if(null!==t&&e>=t.startMs&&e<t.endMs)return o.enabledFor(M.INFO)&&o.info("shouldReset("+this.type+", "+e+"): false (position is in queued for download ranges "+JSON.stringify(t)+")"),!1;var n=e+this.maxAcceptableSegmentPositionErrorMs,r=this.fragmentBuffer.getBufferedRanges().find(n);return null!=r?(o.enabledFor(M.INFO)&&o.info("shouldReset("+this.type+", "+e+"): false (nearby (forward) position "+n+" is in buffered ranges "+JSON.stringify(this.fragmentBuffer.getBufferedRanges())+")"),this.eventEmitter.emitSync("positionAdjusted",r.start),!1):null!==t&&n>=t.startMs&&n<t.endMs?(o.enabledFor(M.INFO)&&o.info("shouldReset("+this.type+", "+e+"): false (nearby (forward) position "+n+" is in queued for download ranges "+JSON.stringify(t)+")"),!1):(i.enabledFor(M.INFO)&&i.info("shouldReset("+this.type+" ,"+e+"): true\nbuffered ranges: "+JSON.stringify(this.fragmentBuffer.getBufferedRanges())+"\nqueued ranges: "+JSON.stringify(t)),!0)},e.prototype.resetBuffer=function(e){i.info("Resetting "+this.type+" at position "+e),this.started?(this.acquirer.stop(),this.downloadQueue.stop(),this.fragmentBuffer.flush(),this.downloadQueue.start(e),this.acquirer.start(e)):i.error("Attempted to reset "+this.type+" FragmentSource, but it is stopped!")},e}();t.DefaultFragmentSource=n});e(JO);JO.DefaultFragmentSource;var $O=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("FragmentBuffer"),n=function(){function e(e){this.updateCallback=new Dt.MulticastCallback,this.type=e,this.bufferedRanges=new Rp.NumberLine(.1),this.finalSegment=null,this.pendingPeriodBoundaries={},this.periods={}}return e.prototype.isBuffered=function(e){return null!=this.bufferedRanges.find(e)},e.prototype.getBufferedFinalFragment=function(){return null==this.finalSegment?null:this.getMediaFragment(this.finalSegment.periodId,this.finalSegment.segmentIndex)},e.prototype.getBufferedRanges=function(){return this.bufferedRanges},e.prototype.flush=function(e){void 0===e&&(e=!1);for(var t=0<this.bufferedRanges.getIntervals().length,n=0,r=Object.keys(this.periods);n<r.length;n++){var i=r[n];this.removePeriod(i,e)}t&&this.updateCallback.invoke(),this.bufferedRanges=new Rp.NumberLine(.1),this.pendingPeriodBoundaries={}},e.prototype.flushFragment=function(e,t){var n=this.periods[e];if(null==n)return c.warn("Trying to flush "+this.type+" segment from period "+e+", but we don't even know about this period."),!1;var r=n.mediaSegments,i=r.get(t);if(null==i)return c.warn("Trying to flush "+this.type+" segment "+t+" from period "+e+", but we don't have it."),!1;r.remove(t);var o=i.readySegment.position;return n.ranges.remove({start:o.startTimeMs,end:o.endTimeMs}),this.bufferedRanges.remove({start:o.startTimeMs,end:o.endTimeMs}),i.readySegment.onFreed(),this.updateCallback.invoke(),!0},e.prototype.addMediaFragment=function(e){null==this.periods[e.periodId]&&(this.periods[e.periodId]={initSegments:new iE.Cache,mediaSegments:new iE.Cache,ranges:new Rp.NumberLine(.1),streamId:e.streamId}),this.periods[e.periodId].streamId=e.streamId;var t=this.periods[e.periodId].mediaSegments,n=e.index,r=e.position,i=t.get(n);if(null===i||!i.locked&&e.bitrateBps>i.readySegment.bitrateBps){t.put(n,{readySegment:e,locked:!1}),this.periods[e.periodId].ranges.add({start:r.startTimeMs,end:r.endTimeMs}),this.bufferedRanges.add({start:r.startTimeMs,end:r.endTimeMs});var o=this.pendingPeriodBoundaries[e.periodId];null!=o&&n===o.fromSequence&&(this.handlePeriodGap(o.fromPeriodId,o.fromSequence,o.toPeriodId,o.toSequence),delete this.pendingPeriodBoundaries[e.periodId]),e.isFinalSegment?c.info("Buffering final "+this.type+" segment index "+n):null!=this.finalSegment&&e.periodId===this.finalSegment.periodId&&n===this.finalSegment.segmentIndex&&(c.info("Buffered "+this.type+" segment index "+n+" was detected as final segment, marking it."),e.isFinalSegment=!0);var a=this.findPreviousPeriod(e.periodId,n);if(null!==a&&null!=a.nextPeriod){var s=this.getMediaFragment(a.nextPeriod.fromPeriodId,a.nextPeriod.fromSequence);if(null!==s){var l=r.startTimeMs-s.position.endTimeMs;100<Math.abs(l)&&c.warn("Found a gap/overlap of "+l+"ms between "+this.type+" segment "+a.nextPeriod.fromSequence+" of period "+a.nextPeriod.fromPeriodId+" and "+n+" of period "+e.periodId)}}this.updateCallback.invoke()}},e.prototype.containsMediaSegmentThat=function(t){for(var e=function(e){return t(e.readySegment)},n=0,r=Object.keys(this.periods);n<r.length;n++){var i=r[n];if(null!==this.periods[i].mediaSegments.findValue(e))return!0}return!1},e.prototype.setFinalSegment=function(e,t){var n={periodId:e,segmentIndex:t};null!=this.finalSegment&&c.warn("Final segment was already set, previous: "+JSON.stringify(this.finalSegment)+", current: "+JSON.stringify(n)),this.finalSegment=n;var r=this.getMediaFragment(e,t);null!=r&&(c.info("Final "+this.type+" segment "+t+" was already cached when final segment was reported, marking it as final segment"),r.isFinalSegment=!0)},e.prototype.findPreviousPeriod=function(e,t){for(var n=0,r=Object.keys(this.periods);n<r.length;n++){var i=r[n],o=this.periods[i];if(null!=o.nextPeriod&&o.nextPeriod.toPeriodId===e)return o.nextPeriod.toSequence!==t?null:o}return null},e.prototype.addInitFragment=function(e){null==this.periods[e.periodId]&&(this.periods[e.periodId]={initSegments:new iE.Cache,mediaSegments:new iE.Cache,ranges:new Rp.NumberLine(.1),streamId:e.streamId}),this.periods[e.periodId].streamId=e.streamId,this.periods[e.periodId].initSegments.put(e.qualityLevelId,e),this.updateCallback.invoke()},e.prototype.containsInitFragment=function(e,t){return null!=this.periods[e]&&null!==this.periods[e].initSegments.get(t)},e.prototype.getInitFragment=function(e,t){var n=this.periods[e];return null==n?null:n.initSegments.get(t)},e.prototype.getMediaFragmentAt=function(t){for(var e=0,n=Object.keys(this.periods);e<n.length;e++){var r=n[e],i=this.periods[r],o=i.ranges.bounds();if(null!==o&&(!Rp.isApprxEqual(o.end,t,1)&&!(t<o.start-1||t>=o.end))){if(null!=i.endingGapCollapseInterval&&null!=i.nextPeriod&&t>=i.endingGapCollapseInterval.start&&t<=i.endingGapCollapseInterval.end){var a=i.nextPeriod.fromSequence;return this.getMediaFragment(r,a)}var s=i.mediaSegments.findValue(function(e){return TE.SegmentPosition.contains(e.readySegment.position,t)||TE.SegmentPosition.contains(e.readySegment.position,t+1)});return null!=s?s.readySegment:null}}return null},e.prototype.getNextMediaFragment=function(e){var t=this.periods[e.periodId];return null==t?(c.warn("Received query for "+this.type+" segment after "+e.index+" of period "+e.periodId+", but we don't know this period!"),null):null!=t.nextPeriod&&t.nextPeriod.fromSequence===e.index?this.getMediaFragment(t.nextPeriod.toPeriodId,t.nextPeriod.toSequence):this.getMediaFragment(e.periodId,e.index+1)},e.prototype.linkSegment=function(e,t,n,r){null==this.periods[e]&&(this.periods[e]={initSegments:new iE.Cache,mediaSegments:new iE.Cache,ranges:new Rp.NumberLine(.1)}),this.periods[e].nextPeriod={fromPeriodId:e,fromSequence:t,toPeriodId:n,toSequence:r},this.handlePeriodGap(e,t,n,r)},e.prototype.isFinalSegment=function(e){return null!=this.finalSegment&&(this.finalSegment.periodId===e.periodId&&this.finalSegment.segmentIndex===e.index)},e.prototype.handlePeriodGap=function(e,t,n,r){var i=this.getMediaFragment(e,t),o=this.getMediaFragment(n,r);if(null!==i&&null!==o){var a=i.position.endTimeMs,s=o.position.startTimeMs,l=s-a;if(0<l&&l<150){var u={start:a,end:s};this.periods[e].endingGapCollapseInterval=u,this.periods[e].ranges.add(u),this.bufferedRanges.add(u)}150<l?c.error("["+this.type+"] "+l+"ms gap between segment "+t+" of period "+e+" and "+r+" of period "+n+" too large to be collapsed"):l<-100&&c.warn("["+this.type+"] "+l+"ms overlap between segment "+t+" of period "+e+" and "+r+" of period "+n)}else null===i&&(this.pendingPeriodBoundaries[e]=this.periods[e].nextPeriod)},e.prototype.getMediaFragment=function(e,t){var n=this.periods[e];if(null==n)return null;var r=n.mediaSegments.get(t);return null!=r?r.readySegment:null},e.prototype.lockFragment=function(e){var t=this.periods[e.periodId];if(null!=t){var n=t.mediaSegments.get(e.index);null!=n&&(n.locked=!0)}},e.prototype.trim=function(e){var t=e-3e4,n=t-3e4,r=this.bufferedRanges.bounds();if(null!==r&&!(n<r.start))for(var i=0,o=Object.keys(this.periods);i<o.length;i++){var a=o[i],s=this.periods[a],l=s.ranges.bounds();if(null!==l)if(null!=s.endingGapCollapseInterval&&(l={start:l.start,end:s.endingGapCollapseInterval.start}),l.end<=t)this.removePeriod(a);else if(l.start<t)for(var u=0,c=s.mediaSegments.trim(function(e){return e.readySegment.position.endTimeMs>t});u<c.length;u++){var d=c[u],p=d.readySegment.position;s.ranges.remove({start:p.startTimeMs,end:p.endTimeMs}),this.bufferedRanges.remove({start:p.startTimeMs,end:p.endTimeMs}),d.readySegment.onFreed()}}},e.prototype.removePeriod=function(e,t){void 0===t&&(t=!1);var n=this.periods[e];if(null!=n){for(var r=n.mediaSegments,i=0,o=r.getAll();i<o.length;i++){o[i].readySegment.onFreed()}r.clear();var a=n.ranges.bounds();if(null!==a&&this.bufferedRanges.remove(a),null!=n.endingGapCollapseInterval&&(this.bufferedRanges.remove(n.endingGapCollapseInterval),delete n.endingGapCollapseInterval),null!=this.pendingPeriodBoundaries[e]&&delete this.pendingPeriodBoundaries[e],n.ranges=new Rp.NumberLine(.1),t){for(var s=0,l=n.initSegments.getAll();s<l.length;s++){l[s].onFreed()}n.initSegments.clear(),delete this.periods[e]}}},e.prototype.onUpdate=function(e){this.updateCallback.add(e)},e.prototype.offUpdate=function(e){this.updateCallback.remove(e)},e.prototype.getBufferedStreamMetadata=function(){for(var e=[],t=0,n=Object.keys(this.periods);t<n.length;t++){var r=n[t],i=this.periods[r];null!=i.streamId?e.push({periodId:r,streamId:i.streamId}):c.warn("Period "+r+" exists without a known streamId")}return e},e}();t.FragmentBuffer=n});e($O);$O.FragmentBuffer;var ZO=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.videoFragmentBuffer=e,this.videoStreamAcquirer=t,this.mediaRepresentation=n}return e.prototype.checkResolutionPixels=function(e){var t=this.createPredicates(e),n=t.isPendingSegmentAbovePixelConstraint,r=t.isCachedVideoSegmentAbovePixelConstraint;return!!this.videoStreamAcquirer.isMediaFragmentPendingThat(n)||this.videoFragmentBuffer.containsMediaSegmentThat(r)},e.prototype.createPredicates=function(e){return{isPendingSegmentAbovePixelConstraint:this.createPendingSegmentPredicate(e),isCachedVideoSegmentAbovePixelConstraint:this.createCachedSegmentPredicate(e)}},e.prototype.createCachedSegmentPredicate=function(a){var s=this,l={periodId:null,stream:null};return function(e){var t=e.periodId,n=e.streamId;if(!s.updatePredicateMetadata(l,t,n))return!0;if(!s.isStreamEncrypted(l.stream))return!1;for(var r=0,i=l.stream.qualityLevels;r<i.length;r++){var o=i[r];if(o.id===e.qualityLevelId)return s.isVideoQualityUnknownOrAbovePixelConstraint(o,a)}return!0}},e.prototype.createPendingSegmentPredicate=function(a){var s=this,l={periodId:null,stream:null};return function(e,t,n){var r=e.segment.period.id,i=e.segment.stream.id;if(!s.updatePredicateMetadata(l,r,i))return!0;if(null===n||!s.isStreamEncrypted(e.segment.stream))return!1;var o=e.segment.stream.qualityLevels[n];return s.isVideoQualityUnknownOrAbovePixelConstraint(o,a)}},e.prototype.updatePredicateMetadata=function(e,t,n){if(!(t===e.periodId&&null!=e.stream&&n===e.stream.id)){var r=F.find(this.mediaRepresentation.periods.contents,function(e){return e.id===t});if(null==r)return!1;var i=F.find(r.streams,function(e){return"Video"===e.type&&e.id===n});if(null==i)return!1;e.periodId=t,e.stream=i}return!0},e.prototype.isStreamEncrypted=function(e){return null!=e.contentProtections&&0<e.contentProtections.length},e.prototype.isVideoQualityUnknownOrAbovePixelConstraint=function(e,t){return null==e.height||null==e.width||e.height*e.width>t},e}();t.VideoSegmentMonitor=n});e(ZO);ZO.VideoSegmentMonitor;var eL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.Constants={CIRCA_ONE_FRAME_MS:50}});e(eL);eL.Constants;var tL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.onChangeCallback=new Dt.MulticastCallback,this.getDistanceFromPlayhead=e,this.maxFrontBufferMs=t}return e.prototype.setFrontBufferSize=function(e){this.maxFrontBufferMs=e+3*eL.Constants.CIRCA_ONE_FRAME_MS,this.onChangeCallback.invoke()},e.prototype.onPosition=function(e){this.onChangeCallback.invoke()},e.prototype.canProduce=function(e){var t=this.getDistanceFromPlayhead(e.contentPosition);return t<this.maxFrontBufferMs?{canProduce:!0}:{canProduce:!1,reason:"Segment starting at "+e.contentPosition.startTimeMs+" is too far ahead of playhead ("+t+" >= "+this.maxFrontBufferMs+"ms)"}},e.prototype.onChange=function(e){this.onChangeCallback.add(e)},e.prototype.offChange=function(e){this.onChangeCallback.remove(e)},e}();t.FrontBufferProductionBarrier=n});e(tL);tL.FrontBufferProductionBarrier;var nL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.FAILED_LOAD_CONTEXT={isLoaded:!1,qualityLevel:null}});e(nL);nL.FAILED_LOAD_CONTEXT;var rL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("LocalSegmentLoader"),n=function(){function e(e,t,n,r){this.type=e,this.fragmentBuffer=t,this.qualityLevelFilter=n,this.selectionLoader=r,this.storageAvailable=null!=r.downloadOperationId&&xI.localStorage.capabilities.isSupported&&RI.metadataStorage.capabilities.isSupported,this.selectionContext=null}return e.prototype.setSelectionContext=function(e){null!=this.selectionContext&&null==e&&c.warn("Explicitly resetting selection context"),this.selectionContext=e},e.prototype.retrieveLocalMediaSegment=function(r,i){var t=this;if(!this.storageAvailable)return Fe.Promise.resolve(nL.FAILED_LOAD_CONTEXT);var n=r.segment.stream,o=r.segment.period,e=this.qualityLevelFilter.filter(n.qualityLevels,n),a=this.selectBitrateOffline(o,n,e);if(a<0)return Fe.Promise.resolve(nL.FAILED_LOAD_CONTEXT);var s=e[a],l=b_.createQualityLevelProgressMetadataKey(this.selectionLoader.downloadOperationId,o.id,n.id,s.id),u=TE.createLocalStorageSegmentId(this.selectionLoader.downloadOperationId,o.id,n.id,s.id,r.segment.segment);return RI.metadataStorage.get(l).then(function(e){if(i.throwIfRequested(),null==e)return null;var t=e,n=r.segment.segment.position.endTimeMs;return t.storageHeadPositionMs<n?null:xI.localStorage.getArrayBuffer(u)}).then(function(e){return i.throwIfRequested(),null==e?nL.FAILED_LOAD_CONTEXT:(s_.FragmentUtilities.validateDownloadedSegmentData(e,r.segment.segment),t.fragmentBuffer.addMediaFragment({isInitSegment:!1,type:t.type,index:r.segment.segment.index,isFinalSegment:r.segment.isFinalSegment,periodId:o.id,streamId:n.id,qualityLevelId:s.id,bitrateBps:s.bandwidth,position:r.segment.contentPosition,data:e,onFreed:function(){}}),null!=r.previousSegment&&r.previousSegment.periodId!==r.segment.period.id&&t.fragmentBuffer.linkSegment(r.previousSegment.periodId,r.previousSegment.index,o.id,r.segment.segment.index),{isLoaded:!0,qualityLevel:s})}).catch(function(e){if(e instanceof Fe.CancelError)throw e;return c.error("Fail to retrieve media segment of key \""+u+"\"",e),nL.FAILED_LOAD_CONTEXT})},e.prototype.selectBitrateOffline=function(e,t,n){var r=[];if(null!=this.selectionContext&&null!=this.selectionContext[e.id]&&null!=this.selectionContext[e.id][this.type]&&(r=this.selectionContext[e.id][this.type].filter(function(e){return e.streamId===t.id}).map(function(e){return e.qualityLevelId})),0===r.length)return-1;for(var i=n.length-1;0<=i;i--){var o=n[i].id;if(-1<r.indexOf(o))return i}return-1},e.prototype.retrieveLocalInitSegment=function(t,n,r,i,o){var a=this;if(!this.storageAvailable||null==i)return Fe.Promise.resolve(!1);var e=b_.createQualityLevelProgressMetadataKey(this.selectionLoader.downloadOperationId,t.id,n.id,r.id),s=TE.createLocalStorageSegmentId(this.selectionLoader.downloadOperationId,t.id,n.id,r.id,i.segment);return RI.metadataStorage.get(e).then(function(e){return o.throwIfRequested(),null==e?null:e.isInitSegmentStored?xI.localStorage.getArrayBuffer(s):null}).then(function(e){return o.throwIfRequested(),null!=e&&(s_.FragmentUtilities.validateDownloadedSegmentData(e,i.segment),a.fragmentBuffer.addInitFragment({isInitSegment:!0,type:a.type,periodId:t.id,streamId:n.id,qualityLevelId:r.id,bitrateBps:r.bandwidth,data:e,onFreed:function(){}}),!0)}).catch(function(e){if(e instanceof Fe.CancelError)throw e;return c.error("Fail to retrieve init segment of key \""+s+"\"",e),!1})},e}();t.LocalSegmentLoader=n});e(rL);rL.LocalSegmentLoader;var iL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.selectTimeline=function(e,t){return(null!=t?t.filter(e.qualityLevels,e):e.qualityLevels)[0].segmentTimeline},e}();t.BaseQualitySegmentTimelineSelector=n});e(iL);iL.BaseQualitySegmentTimelineSelector;var oL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.onRebuffer=function(){},e.prototype.onSeek=function(){},e}();t.BaseBitrateSelector=n});e(oL);oL.BaseBitrateSelector;var aL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.getSizesBytesForFragment=function(e){return e.fragmentQualities.map(function(e){return e.sizeBytes})},e.getBitratesBpsForFragment=function(e){return e.fragmentQualities.map(function(e){return e.bitrateBps})},e}();t.FragmentUtils=n});e(aL);aL.FragmentUtils;var sL=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.selectBitrate=function(e,t,n){var r=aL.FragmentUtils.getBitratesBpsForFragment(e.fragment);return Mp.indexOfMaximum(r,function(e,t){return e-t})},t}(oL.BaseBitrateSelector);t.HighestBitrateSelector=i});e(sL);sL.HighestBitrateSelector;var lL=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=Rp.PiecewiseLinearFunction,o=function(r){function e(e,t){void 0===t&&(t=i);var n=r.call(this)||this;if(0===(n.bitrateSelectorConfig=e).timeToDownloadPredictor.bitrateVariationFactor)throw new Error("bitrateVariationFactor cannot be 0");return n.bandwidthScaleFactorFunction=new t(n.bitrateSelectorConfig.bandwidthPredictor.bufferFullnessSecondsToConfidenceFactorGraph),n.latencyScaleFactorFunction=new t(n.bitrateSelectorConfig.latencyPredictor.bufferFullnessSecondsToConfidenceFactorGraph),null!=n.bitrateSelectorConfig.timeToDownloadPredictor.bufferFullnessSecondsToBandwidthThrottleFactorGraph&&(n.bandwidthThrottleFactorFunction=new t(n.bitrateSelectorConfig.timeToDownloadPredictor.bufferFullnessSecondsToBandwidthThrottleFactorGraph)),null!=n.bitrateSelectorConfig.timeToDownloadPredictor.bufferFullnessSecondsToRetryBandwidthThrottleFactorGraph&&(n.retryBandwidthThrottleFactorFunction=new t(n.bitrateSelectorConfig.timeToDownloadPredictor.bufferFullnessSecondsToRetryBandwidthThrottleFactorGraph)),n}return n(e,r),e.prototype.selectBitrate=function(e,t,n){for(var r=this.bitrateSelectorConfig.timeToDownloadPredictor,i=this.bitrateSelectorConfig.scheduler,o=this.calculateBitratePenalty(e.fragment,e.futureFragments,r.bitrateVariationFactor),a=this.calculateBitrateVariationPenaltyFactor(o,r.minBitrateVariationPenaltyFactor,r.maxBitrateVariationPenaltyFactor),s=1e3*(null===n.bandwidthAvgKbps?0:n.bandwidthAvgKbps)*a,l=null===n.bandwidthStdDevKbps?0:n.bandwidthStdDevKbps,u=this.createConfidenceLevels(s,1e3*l,i.confidenceLevelsToCompute,this.bandwidthScaleFactorFunction.evaluate(t/1e3),1),c=null===n.latencyAvgMs?0:n.latencyAvgMs,d=null===n.latencyStdDevMs?0:n.latencyStdDevMs,p=this.createConfidenceLevels(c,d,i.confidenceLevelsToCompute,this.latencyScaleFactorFunction.evaluate(t/1e3),1),f=[],h=aL.FragmentUtils.getSizesBytesForFragment(e.fragment),m=aL.FragmentUtils.getBitratesBpsForFragment(e.fragment),y=this.calculateBandwidthThrottleFactor(e,t),g=0;g<m.length;g++){var v=8*h[g];f[g]=this.calculateMaxAcceptableConfidence(e,t,v,u,p,y)}var S=-1,b=0;for(g=0;g<m.length;g++)m[g]>S&&f[g]>=i.minConfidenceLevelSum&&(S=m[g],b=g);return null==this.retryBandwidthThrottleFactorFunction&&0<e.attempt&&(b=Math.max(0,b-2*(e.attempt-1))),b},e.prototype.calculateBitratePenalty=function(e,t,n){for(var r=aL.FragmentUtils.getSizesBytesForFragment(e),i=[e].concat(t).map(function(e){return aL.FragmentUtils.getSizesBytesForFragment(e)}),o=0,a=0;a<r.length;a++){for(var s=-1,l=0;l<i.length;l++)s=Math.max(s,i[l][a]);o+=(r[a]-s)/r[a]}return o/(r.length*n)},e.prototype.calculateBitrateVariationPenaltyFactor=function(e,t,n){return 1+Math.max(t,Math.min(n,e))},e.prototype.createConfidenceLevels=function(e,t,n,r,i){for(var o=[],a=0;a<n;a++)o.push(Math.max(e+r*a*t,i));return o},e.prototype.calculateMaxAcceptableConfidence=function(e,t,n,r,i,o){for(var a=-1,s=0;s<r.length;s++)for(var l=r[s]/1e3,u=0;u<i.length;u++){var c=s+u,d=i[u]-i[0]+n/l;(!this.bitrateSelectorConfig.useBufferSizeRatio||d<this.bitrateSelectorConfig.bufferSizeRatio*t)&&d<o*e.fragment.lengthMs&&a<c&&(a=c)}return a},e.prototype.calculateBandwidthThrottleFactor=function(e,t){return null!=this.retryBandwidthThrottleFactorFunction&&0<e.attempt?this.retryBandwidthThrottleFactorFunction.evaluate(t/1e3):null!=this.bandwidthThrottleFactorFunction?this.bandwidthThrottleFactorFunction.evaluate(t/1e3):Math.pow(t/this.bitrateSelectorConfig.targetBufferFullnessMs,this.bitrateSelectorConfig.bufferFillFactor)},e}(oL.BaseBitrateSelector);t.ThroughputBasedBitrateSelector=o});e(lL);lL.ThroughputBasedBitrateSelector;var uL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=Rp.PiecewiseLinearFunction,n=function(){function e(e,t,n,r,i){this.config=e,this.fragmentHistory=t,this.upshiftLimitFunction=null==n?new o(this.config.filters.bufferFullnessSecondsToBitrateUpshiftLimitFactorGraph):n,this.downshiftThresholdFunction=null==r?new o(this.config.filters.bufferFullnessSecondsToBitrateDownshiftLimitFactorGraph):r,this.downshiftRetryThresholdFunction=null==i?new o(this.config.filters.bufferFullnessSecondsToBitrateRetryDownshiftLimitFactorGraph):i}return e.prototype.smoothBitrate=function(e,t,n,r){var i=0<t.attempt?this.downshiftRetryThresholdFunction:this.downshiftThresholdFunction,o=this.fragmentHistory.findEvent(t.index-1);if(null===o&&null==(o=this.fragmentHistory.getRecentEvents(1)[0]))return e;var a=aL.FragmentUtils.getBitratesBpsForFragment(t.fragment),s=e,l=e-this.findIndexLessThanOrEqualTo(o.bitrateBps,a);if(0<l){var u=Math.floor(this.upshiftLimitFunction.evaluate(n/1e3)),c=Math.min(e,o.selectedBitrateIndex+u),d=t.fragment.fragmentQualities[c].bitrateBps;s=this.findIndexLessThanOrEqualTo(d,aL.FragmentUtils.getBitratesBpsForFragment(t.fragment))}else if(l<0){var p=Math.ceil(i.evaluate(n/1e3)),f=Math.max(e,o.selectedBitrateIndex+p);f=Math.min(f,t.fragment.fragmentQualities.length-1);var h=t.fragment.fragmentQualities[f].bitrateBps;s=this.findIndexLessThanOrEqualTo(h,aL.FragmentUtils.getBitratesBpsForFragment(t.fragment))}return s},e.prototype.findIndexLessThanOrEqualTo=function(e,t){for(var n=0,r=t.length-1;0<=r;--r)if(t[r]<=e){n=r;break}return n},e}();t.QualityLevelBitrateSmoother=n});e(uL);uL.QualityLevelBitrateSmoother;var cL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.findHighestIndexLessThanOrEqualToBitrate=function(t,e){return Math.max(0,F.findLastIndex(e,function(e){return e<=t}))},e}();t.BitrateSelectionUtils=n});e(cL);cL.BitrateSelectionUtils;var dL=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=Rp.PiecewiseLinearFunction,i=function(i){function e(e,t,n){var r=i.call(this)||this;return r.bitrateSelectorConfig=e,r.fragmentHistory=t,r.bandwidthAdjustmentFunction=null!=n?n:new o(r.bitrateSelectorConfig.timeToDownloadPredictor.bufferFullnessSecondsToLiveBandwidthThrottleFactorGraph),r.maxSteps=Math.ceil((r.bitrateSelectorConfig.bandwidthPredictor.maxBandwidthHeadroomFactor-r.bitrateSelectorConfig.bandwidthPredictor.minBandwidthHeadroomFactor)/r.bitrateSelectorConfig.bandwidthPredictor.bandwidthHeadroomStepFactor),r}return n(e,i),e.prototype.selectBitrate=function(t,e,n){for(var r=this.fragmentHistory.getRecentEvents(this.maxSteps),i=0,o=r.length-1;0<=o&&"Baseline"!==r[o].fragmentRequestType;o--)i++;var a=this.bitrateSelectorConfig.bandwidthPredictor.maxBandwidthHeadroomFactor-i*this.bitrateSelectorConfig.bandwidthPredictor.bandwidthHeadroomStepFactor;a=Math.max(a,this.bitrateSelectorConfig.bandwidthPredictor.minBandwidthHeadroomFactor);var s=1e3*(null===n.bandwidthAvgKbps?0:n.bandwidthAvgKbps)*(1-a)*this.bandwidthAdjustmentFunction.evaluate(e/1e3),l=aL.FragmentUtils.getSizesBytesForFragment(t.fragment).map(function(e){return 8*e/(t.fragment.lengthMs/1e3)}),u=s;return"Baseline"===t.requestType?u=this.bitrateSelectorConfig.bandwidthPredictor.bandwidthBaselineFactor*s:"Upgrade"===t.requestType&&(u=(1-this.bitrateSelectorConfig.bandwidthPredictor.bandwidthBaselineFactor)*s),cL.BitrateSelectionUtils.findHighestIndexLessThanOrEqualToBitrate(u,l)},e}(oL.BaseBitrateSelector);t.LiveStreamingBitrateSelector=i});e(dL);dL.LiveStreamingBitrateSelector;var pL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.smoothBitrate=function(e,t,n,r){return e},e}();t.DefaultBitrateSmoother=n});e(pL);pL.DefaultBitrateSmoother;var fL=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(e,t){var n=r.call(this)||this;return n.bitrateSelector=e,n.bitrateSmoother=null!=t?t:new pL.DefaultBitrateSmoother,n}return n(e,r),e.prototype.selectBitrate=function(e,t,n){var r=this.bitrateSelector.selectBitrate(e,t,n);return this.bitrateSmoother.smoothBitrate(r,e,t,n)},e}(oL.BaseBitrateSelector);t.SmoothingBitrateSelector=i});e(fL);fL.SmoothingBitrateSelector;var hL=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(e,t){var n=r.call(this)||this;return n.lowBufferBitrateSelector=e,n.higherBufferBitrateSelector=t,n}return n(e,r),e.prototype.selectBitrate=function(e,t,n){return t<2e4?this.lowBufferBitrateSelector.selectBitrate(e,t,n):this.higherBufferBitrateSelector.selectBitrate(e,t,n)},e}(oL.BaseBitrateSelector);t.DualModeHeuristicsBitrateSelector=i});e(hL);hL.DualModeHeuristicsBitrateSelector;var mL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("QualitySelector");var n=function(){function d(e,t){var c=this;this.previousBitrate=null,this.calcVParamAndGammaDynamic=function(e,t,n,r){var i=c.maxAvailableBufferDurationSeconds-(1+c.bolaConfig.bufferScaler)*n;c.bolaConfig.shouldAdjustBufferLowWatermarkForCVBR&&d.CBR_FRAGMENT_DURATION_SEC<e&&(i=c.maxAvailableBufferDurationSeconds-(1+c.bolaConfig.bufferScaler)*(n-e+d.CBR_FRAGMENT_DURATION_SEC));var o=r[0][0],a=r[r.length-1][0],s=1<r.length?r[1][0]:r[0][0],l=s/o,u=i/(Math.log(a/o)+Math.log(s/o)*l);return[u,(c.maxAvailableBufferDurationSeconds+c.bolaConfig.bufferScaler*t)/u-Math.log(a/o)]},this.calcVParamAndGammaStatic=function(e,t,n,r){var i=c.maxAvailableBufferDurationSeconds+c.bolaConfig.bufferScaler*t,o=r[0][0],a=r[r.length-1][0];return[i/(Math.log(a/o)+c.bolaConfig.tradeOffFactor),c.bolaConfig.tradeOffFactor]},this.bolaConfig=e,this.maxAvailableBufferDurationSeconds=t,"DYNAMIC_TRADE_OFF_FACTOR"===this.bolaConfig.bolaAlgorithm?this.calcVParamAndGamma=this.calcVParamAndGammaDynamic:this.calcVParamAndGamma=this.calcVParamAndGammaStatic}return d.prototype.setMaxAvailableBufferDurationSeconds=function(e){this.maxAvailableBufferDurationSeconds=e},d.prototype.selectBitrate=function(e,t,n,r){for(var i,o,a=e.fragment.lengthMs/1e3,s=this.getBitrateFragmentSizeMap(e),l=s.length-1,u=this.calcVParamAndGamma(t,a,r,s),c=u[0],d=u[1],p=s[0][0],f=[],h=Number.NEGATIVE_INFINITY,m=0;m<s.length;m++){var y=s[m],g=y[0],v=y[1],S=c*(Math.log(g/p)+d);S-=(1+this.bolaConfig.bufferScaler)*t,S/=v,h<(f[m]=S)&&(h=S)}var b=s[l][0],T=l;if(0<=h)for(var P=h*this.bolaConfig.rampUpGoodnessValueFactor,w=0;w<f.length;w++)f[w]>=P&&(b=s[w][0],T=w);return T=(i=this.throttleRampUpQualityLevel(T,b,s))[0],b=i[1],this.bolaConfig.shouldUseThroughputEstimateInGetBolaBitRate&&(T=(o=this.adjustInitialBitRateUsingThroughput(b,T,n,s))[0],b=o[1]),this.previousBitrate=b,T},d.prototype.calculateTransientBufferDuration=function(e,t,n){for(var r=e/1e3,i=t.fragment.lengthMs/1e3,o=this.getBitrateFragmentSizeMap(t),a=o.length-1,s=this.calcVParamAndGamma(r,i,n,o),l=s[0],u=s[1],c=o[a][0],d=o[0][0],p=c*this.bolaConfig.startupBitratePercent,f=0,h=0;h<o.length;h++)o[h][0]<=p&&(f=h);if(0===f)return n;var m=o[f][0],y=o[Math.max(f-1,0)][0];return(l*m*(Math.log(y/d)+u)-l*y*(Math.log(m/d)+u))/(m-y)},d.prototype.getBitrateFragmentSizeMap=function(e){var t=aL.FragmentUtils.getBitratesBpsForFragment(e.fragment),n=aL.FragmentUtils.getSizesBytesForFragment(e.fragment),r=t.map(function(e,t){return[e,n[t]]});return r.sort(function(e,t){return e[0]-t[0]}),r},d.convertBitsToMegaBits=function(e){return(e/d.BITS_MEGABITS_CONVERSION).toFixed(2)+" Mbps"},d.prototype.throttleRampUpQualityLevel=function(e,t,n){if(null!==this.previousBitrate){for(var r=0,i=0;i<n.length&&!(n[i][0]>this.previousBitrate);i++)r=i;e>this.bolaConfig.maxRampUpQualityLevel+r&&(t=n[e=this.bolaConfig.maxRampUpQualityLevel+r][0])}return[e,t]},d.prototype.adjustInitialBitRateUsingThroughput=function(e,t,n,r){var i=null==n.bandwidthAvgKbps?0:n.bandwidthAvgKbps*d.BITS_KILOBITS_CONVERSION,o=r[0][0],a=Math.max(this.bolaConfig.scalerThroughputEstimateInGetBolaBitRate*i-this.bolaConfig.reservedBandwidthForAudioBitsPerSecond,o);if(0<i&&o<e&&a<=e)for(var s=0;s<r.length&&r[s][0]<=a;s++)e=r[t=s][0];return[t,e]},d.BITS_KILOBITS_CONVERSION=1e3,d.BITS_MEGABITS_CONVERSION=1e6,d.CBR_FRAGMENT_DURATION_SEC=2,d}();t.QualitySelector=n});e(mL);mL.QualitySelector;var yL=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.LowTransient=0]="LowTransient",r[r.BufferTransient=1]="BufferTransient",r[r.TransientState=2]="TransientState",r[r.SteadyState=3]="SteadyState",t.States=n});e(yL);yL.States;var gL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("BolaTransientStateController");var n=function(){function e(e,t,n){var r=this;this.onStateChange=function(e){r.prevState=r.currentState,r.currentState=e},this.bolaConfig=e,this.qualitySelector=t,this.stateMachine=new $k.FiniteStateMachine(yL.States.LowTransient),this.stateMachine.addTransition(yL.States.LowTransient,0,yL.States.BufferTransient),this.stateMachine.addTransition(yL.States.LowTransient,1,yL.States.LowTransient),this.stateMachine.addTransition(yL.States.TransientState,0,yL.States.BufferTransient),this.stateMachine.addTransition(yL.States.TransientState,1,yL.States.LowTransient),this.stateMachine.addTransition(yL.States.SteadyState,0,yL.States.BufferTransient),this.stateMachine.addTransition(yL.States.SteadyState,1,yL.States.LowTransient),this.stateMachine.addTransition(yL.States.BufferTransient,0,yL.States.BufferTransient),this.stateMachine.addTransition(yL.States.BufferTransient,1,yL.States.LowTransient),this.stateMachine.addTransition(yL.States.LowTransient,3,yL.States.TransientState),this.stateMachine.addTransition(yL.States.TransientState,2,yL.States.LowTransient),this.stateMachine.addTransition(yL.States.TransientState,4,yL.States.SteadyState),this.stateMachine.addTransition(yL.States.BufferTransient,3,yL.States.TransientState),this.transientBufferDurationSeconds=0,this.transientBufferLastUpdateTimeStampMillis=Date.now(),this.isInitialized=!1,this.maxAvailableBufferDurationSeconds=n,this.prevState=yL.States.LowTransient,this.currentState=yL.States.LowTransient,this.stateMachine.onStateChange(this.onStateChange)}return e.prototype.setMaxAvailableBufferDurationSeconds=function(e){this.maxAvailableBufferDurationSeconds=e},e.prototype.calculateEffectiveBufferDurationSeconds=function(e,t){var n=0,r=e/1e3;switch(this.currentState){case yL.States.LowTransient:case yL.States.BufferTransient:this.initializeTransientBufferDuration(e,t),this.updateTransientBufferDurationWithClip(),r>this.bolaConfig.transientStateBufferThresholdSeconds&&this.stateMachine.actNow(3),n=this.transientBufferDurationSeconds;break;case yL.States.TransientState:this.updateTransientBufferDurationWithClip(),n=this.transientBufferDurationSeconds,r>this.transientBufferDurationSeconds?(this.stateMachine.actNow(4),n=r,this.resetStateVariables()):r<this.bolaConfig.transientStateBufferThresholdSeconds&&this.stateMachine.actNow(2);break;case yL.States.SteadyState:default:n=r}return n},e.prototype.onDownloadComplete=function(e,t){if(this.currentState!==yL.States.SteadyState){switch(this.currentState){case yL.States.LowTransient:case yL.States.BufferTransient:this.transientBufferDurationSeconds+=t*this.bolaConfig.lowTransientBufferDurationIncrementScaleFactor;break;case yL.States.TransientState:default:this.transientBufferDurationSeconds+=t*this.bolaConfig.transientBufferDurationIncrementScaleFactor}this.updateTransientBufferDurationWithClip()}},e.prototype.getBufferLowWaterMarkSeconds=function(){return this.bolaConfig.shouldAdjustBufferLowWatermarkForLowTransient&&this.isInLowTransientState()&&this.prevState!==yL.States.TransientState?this.bolaConfig.bufferLowWatermarkSecondsForLowTransient:this.bolaConfig.bufferLowWatermarkSeconds},e.prototype.onSeek=function(){this.stateMachine.actNow(1),this.resetStateVariables()},e.prototype.onRebuffer=function(){this.stateMachine.actNow(0),this.resetStateVariables()},e.prototype.resetStateVariables=function(){this.transientBufferDurationSeconds=0,this.transientBufferLastUpdateTimeStampMillis=0,this.isInitialized=!1},e.prototype.initializeTransientBufferDuration=function(e,t){if(!this.isInitialized){switch(this.currentState){case yL.States.BufferTransient:this.transientBufferDurationSeconds=this.bolaConfig.bufferLowWatermarkSeconds-.1;break;case yL.States.LowTransient:var n=e/1e3;this.transientBufferDurationSeconds=this.qualitySelector.calculateTransientBufferDuration(e,t,this.getBufferLowWaterMarkSeconds()),this.transientBufferDurationSeconds=Math.max(this.transientBufferDurationSeconds,n)}this.transientBufferLastUpdateTimeStampMillis=Date.now(),this.isInitialized=!0}},e.prototype.updateTransientBufferDurationWithClip=function(){var e=Date.now(),t=(this.transientBufferLastUpdateTimeStampMillis-e)/1e3;t=Math.max(t,0);var n=this.transientBufferDurationSeconds-t;this.transientBufferLastUpdateTimeStampMillis=e,this.transientBufferDurationSeconds=Math.min(this.bolaConfig.transientClipMaxDurationFactor*this.maxAvailableBufferDurationSeconds,Math.max(n,0))},e.prototype.isInLowTransientState=function(){return this.currentState===yL.States.LowTransient||this.currentState===yL.States.BufferTransient},e}();t.TransientStateController=n});e(gL);gL.TransientStateController;var vL=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});M.get("BolaBitrateSelector");var i=function(i){function o(e,t,n){var r=i.call(this)||this;if(r.prevBufferDurationSeconds=null,r.bolaConfig=e,r.bufferSettings=t,0===n)throw new Error("maxAvailableBytes cannot be 0");return r.maxAvailableBytes=n,r.qualitySelector=new mL.QualitySelector(r.bolaConfig,r.bufferSettings.forwardBufferLengthSeconds),r.transientStateController=new gL.TransientStateController(r.bolaConfig,r.qualitySelector,t.forwardBufferLengthSeconds),r}return n(o,i),o.prototype.selectBitrate=function(e,t,n){var r=t/1e3;this.updateMaxAvailableBufferDuration(e,r),this.transientStateController.onDownloadComplete(r,this.calculateDownloadedFragmentDuration(r));var i=this.transientStateController.calculateEffectiveBufferDurationSeconds(t,e),o=this.transientStateController.getBufferLowWaterMarkSeconds();return this.qualitySelector.selectBitrate(e,i,n,o)},o.prototype.onSeek=function(){this.transientStateController.onSeek()},o.prototype.onRebuffer=function(){this.transientStateController.onRebuffer()},o.prototype.updateMaxAvailableBufferDuration=function(e,t){var n=o.getMaxBitrateForGivenSession(e),r=Math.min(8*this.maxAvailableBytes/n,this.bufferSettings.forwardBufferLengthSeconds),i=this.scaleMaxAvailableBufferDuration(r,t);this.transientStateController.setMaxAvailableBufferDurationSeconds(i),this.qualitySelector.setMaxAvailableBufferDurationSeconds(i)},o.prototype.scaleMaxAvailableBufferDuration=function(e,t){var n=this.bolaConfig.maxAvailableBufferDurationScaleFactorHigh-this.bolaConfig.maxAvailableBufferDurationScaleFactorLow,r=t-this.bolaConfig.bufferLowWatermarkSeconds,i=e-this.bolaConfig.bufferLowWatermarkSeconds,o=this.bolaConfig.maxAvailableBufferDurationScaleFactorHigh-n*(r/i);return Rp.clamp(o,this.bolaConfig.maxAvailableBufferDurationScaleFactorLow,this.bolaConfig.maxAvailableBufferDurationScaleFactorHigh)*e},o.prototype.calculateDownloadedFragmentDuration=function(e){var t=null!==this.prevBufferDurationSeconds?e-this.prevBufferDurationSeconds:0;return this.prevBufferDurationSeconds=e,t},o.getMaxBitrateForGivenSession=function(e){var t=aL.FragmentUtils.getBitratesBpsForFragment(e.fragment).sort(function(e,t){return e-t});return t[t.length-1]},o}(oL.BaseBitrateSelector);t.BolaBitrateSelector=i});e(vL);vL.BolaBitrateSelector;var SL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i,o,a){this.throughputSelectorConfig=e,this.liveSelectorConfig=t,this.bitrateSmoothingConfig=n,this.downloadConfig=r,this.bolaConfig=i,this.bufferSettings=o,this.maxAvailableBytes=a}return e.prototype.createBitrateSelector=function(e,t){if("Video"!==e)return new sL.HighestBitrateSelector;var n=new dL.LiveStreamingBitrateSelector(this.liveSelectorConfig,t),r=new lL.ThroughputBasedBitrateSelector(this.throughputSelectorConfig),i=new uL.QualityLevelBitrateSmoother(this.bitrateSmoothingConfig,t),o=new fL.SmoothingBitrateSelector(r,i);switch(this.downloadConfig.player.heuristicAlgorithm){case"BOLA_V1":return new vL.BolaBitrateSelector(this.bolaConfig,this.bufferSettings,this.maxAvailableBytes);case"DUAL_MODE_HEURISTICS":default:return new hL.DualModeHeuristicsBitrateSelector(n,o)}},e}();t.AggregatedBitrateSelectorFactory=n});e(SL);SL.AggregatedBitrateSelectorFactory;var bL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){void 0===e&&(e=40),this.maxEvents=e,this.fragments=[]}return e.prototype.addEvent=function(e){this.fragments.push(e),this.fragments.length>this.maxEvents&&this.fragments.shift()},e.prototype.getRecentEvents=function(e){return F.last(this.fragments,e)},e.prototype.findEvent=function(e,t){for(var n=this.fragments.length-1;0<=n;--n){var r=this.fragments[n];if(r.index===e&&(null==t||r.bitrateBps===t))return r}return null},e}();t.FragmentHistory=n});e(bL);bL.FragmentHistory;var TL={AggregatedBitrateSelectorFactory:SL.AggregatedBitrateSelectorFactory,BitrateSelectionUtils:cL.BitrateSelectionUtils,FragmentHistory:bL.FragmentHistory},PL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("InitialQualitySelector");var n=function(){function e(){}return e.prototype.selectTimeline=function(e,t){var n=lh.getInstance().getNetworkStatistics(),r=0,i=null!=t?t.filter(e.qualityLevels,e):e.qualityLevels;return r=null===n.bandwidthAvgKbps||0===n.bandwidthAvgKbps?Math.floor(i.length/2):TL.BitrateSelectionUtils.findHighestIndexLessThanOrEqualToBitrate(1e3*n.bandwidthAvgKbps,i.map(function(e){return e.bandwidth})),i[r].segmentTimeline},e}();t.InitialQualitySelector=n});e(PL);PL.InitialQualitySelector;var wL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("OfflineSegmentTimelineSelector"),n=function(){function e(){}return e.prototype.selectTimeline=function(t,e,n){void 0===n&&(n=[]);var r=n.filter(function(e){return e.streamId===t.id}).map(function(e){return e.qualityLevelId});if(0===r.length)throw a.warn("The specified stream does not match offline stream selection context."),new Error("The passed in stream mismatches the downloader selection. Attempt of local asset playback WILL FAIL!!!");for(var i=null!=e?e.filter(t.qualityLevels,t):t.qualityLevels,o=i.length-1;0<=o;o--)if(-1!==r.indexOf(i[o].id))return i[o].segmentTimeline;throw new Error("Unable to find a stream's qualityLevel matching the downloader selection. Attempt of local asset playback WILL FAIL!!!")},e}();t.OfflineSegmentTimelineSelector=n});e(wL);wL.OfflineSegmentTimelineSelector;var CL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=M.get("SegmentInfoProducer"),n=function(){function e(e,t,n,r,i,o){this.type=e,this.periodTailor=t,this.selectionContext=null,this.streamSelector=n,this.streamAlternator=r,this.baseQualitySegmentTimelineSelector=new iL.BaseQualitySegmentTimelineSelector,this.initialQualitySelector=new PL.InitialQualitySelector,this.offlineSegmentTimelineSelector=new wL.OfflineSegmentTimelineSelector,this.acceptableSegmentPositionErrorMs=i,this.qualityLevelFilter=o,this.finalSegmentProduced=!1}return e.prototype.setSelectionContext=function(e){null!=this.selectionContext&&null==e&&p.warn("Explicitly resetting selection context"),this.selectionContext=e},e.prototype.getSegmentAt=function(r,i){var o=this;return this.periodTailor.getPeriodAt(r).then(function(t){if(i.throwIfRequested(),null==t)return null;var e=!1;if(null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.streamAcquirers&&null!=up.configurationStore.configuration.streamAcquirers.initialQuality){var n=up.configurationStore.configuration.streamAcquirers.initialQuality;null!=n.downloadBaseQualityIndex&&(e=n.downloadBaseQualityIndex)}return o.queryOnPeriod(Fe.Promise.resolve(t),function(e,t){return t.getSegmentAt(Math.max(r-e.startMs,0),o.acceptableSegmentPositionErrorMs)},i,e).then(function(e){return null!=e?e:o.getSegmentMultiPeriod(t,i)})})},e.prototype.queryOnPeriod=function(e,l,u,c){var d=this;return void 0===c&&(c=!1),e.then(function(e){if(u.throwIfRequested(),null===e)return null;var t=d.streamSelector.selectStreams(e,d.type),n=d.streamAlternator.selectStream(t);if(null==n)return p.warn("Period "+e.id+" returned no "+d.type+" streams"),null;var r=d.getStreamSelectionContexts(e),i=d.selectTimeline(n,!1,r),o=d.waitSegment(function(){return l(e,i)},e,n,i,u);if(c){var a=d.selectTimeline(n,!0,r),s=Fe.Promise.resolve(null);return null!=a&&a!==i&&(s=d.waitSegment(function(){return l(e,a)},e,n,a,u)),Fe.Promise.all([o,s]).then(function(e){var t=e[0];e[1];return t})}return o})},e.prototype.getNextSegment=function(r,i){var o=this,a=this.selectTimeline(r.stream,!1,this.getStreamSelectionContexts(r.period));return this.waitSegment(function(){return a.getEquivalentSegment(r.segment)},r.period,r.stream,a,i).then(function(e){if(i.throwIfRequested(),null===e)return p.error("Previous segment could not be found in SegmentTimeline!!!"),null;if(e.segment.isFinalSegment)return r.period.isFinalPeriod?(o.finalSegmentProduced=!0,null):o.periodTailor.getNextPeriod(r.period).then(function(t){return i.throwIfRequested(),null==t?null:o.queryOnPeriod(Fe.Promise.resolve(t),function(e,t){return t.getSegmentAt(0,o.acceptableSegmentPositionErrorMs)},i).then(function(e){return null!=e?e:o.getSegmentMultiPeriod(t,i)})});var t=a.getNext(e.segment),n=void 0;if("Unavailable"===t.type){if(null==t.etaMs)return p.error("Next segment after "+r.segment.index+" on period "+r.period.id+" is unavailable and without eta!"),null;n=o.delay(t.etaMs,i).then(function(){return t})}else{if("RefreshMe"!==t.type)return o.waitSegment(function(){return t},r.period,r.stream,a,i);n=t.load()}return n.then(function(){return o.getNextSegment(r,i)})}).then(function(e){if(i.throwIfRequested(),null===e)return null;var t=e.contentPosition.startTimeMs-r.contentPosition.endTimeMs;if(.1<Math.abs(t)){var n=0<t?"gap":"overlap";p.warn(t+"ms "+n+" for type "+o.type+" between periodId="+r.period.id+", index="+r.segment.index+" and periodId="+e.period.id+", index="+e.segment.index)}return e})},Object.defineProperty(e.prototype,"isFinalSegmentProduced",{get:function(){return this.finalSegmentProduced},enumerable:!0,configurable:!0}),e.prototype.getSegmentMultiPeriod=function(e,n){var r=this;return this.periodTailor.getNextPeriod(e).then(function(t){return n.throwIfRequested(),null==t?null:r.queryOnPeriod(Fe.Promise.resolve(t),function(e,t){return t.getSegmentAt(0,r.acceptableSegmentPositionErrorMs)},n).then(function(e){return n.throwIfRequested(),null!=e?e:r.getSegmentMultiPeriod(t,n)})})},e.prototype.waitSegment=function(t,n,r,i,o){var a=this,e=t();return("RefreshMe"===e.type?e.load():Fe.Promise.resolve(e)).then(function(e){return o.throwIfRequested(),"Unavailable"===e.type?null==e.etaMs?null:a.delay(e.etaMs,o).then(function(){return o.throwIfRequested(),a.waitSegment(t,n,r,i,o)}):{segment:e.segment,period:n,stream:r,contentPosition:a.periodTailor.toContentRelative(n,e.segment.position),isFinalSegment:e.segment.isFinalSegment&&n.isFinalPeriod}})},e.prototype.selectTimeline=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=[]),0<n.length)try{return this.offlineSegmentTimelineSelector.selectTimeline(e,this.qualityLevelFilter,n)}catch(e){p.error("Offline segment timeline selection failed. Fallback to online timeline. Error:",e)}return t?this.baseQualitySegmentTimelineSelector.selectTimeline(e,this.qualityLevelFilter):this.initialQualitySelector.selectTimeline(e,this.qualityLevelFilter)},e.prototype.getStreamSelectionContexts=function(e){var t=[];return null!=this.selectionContext&&null!=this.selectionContext[e.id]&&null!=this.selectionContext[e.id][this.type]&&(t=this.selectionContext[e.id][this.type]),t},e.prototype.delay=function(r,i){return new Fe.Promise(function(e,t){var n=A.timer.setTimeout(e,r);i.promise.then(function(e){A.timer.clearTimeout(n),t(e)})})},e}();t.SegmentInfoProducer=n});e(CL);CL.SegmentInfoProducer;var ML=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("BlockingSegmentInfoProducer"),r=function(){function e(e,t,n){var r=this;this.onBarrierStateChanged=function(){if(null!==r.heldSegmentInfo){if(r.heldSegmentInfo.token.requested)return r.heldSegmentInfo=null,void r.reportState();var e=r.canProduce(r.heldSegmentInfo.segmentInfo);if(e.canProduce){var t=r.heldSegmentInfo;r.heldSegmentInfo=null,t.deferred.resolve(t.segmentInfo)}else r.heldSegmentInfo.reason=e.reason;r.reportState()}},this.producer=t,this.barriers=n,this.heldSegmentInfo=null,this.diagnostics=pp.Diagnostics.create("BlockingSegmentInfoProducer."+e);for(var i=0,o=n;i<o.length;i++){o[i].onChange(this.onBarrierStateChanged)}}return e.prototype.getSegmentAt=function(e,t){return null===this.heldSegmentInfo||this.heldSegmentInfo.token.requested||(n.warn("getSegmentAt("+e+") called, but we already had a segment on hold. Discarding it and querying again!"),this.heldSegmentInfo=null,this.reportState()),this.execute(this.producer.getSegmentAt(e,t),t)},e.prototype.getNextSegment=function(e,t){return null===this.heldSegmentInfo||this.heldSegmentInfo.token.requested||(n.warn("getNextSegment() called, but we already had a segment on hold. Discarding it and querying again!"),this.heldSegmentInfo=null,this.reportState()),this.execute(this.producer.getNextSegment(e,t),t)},Object.defineProperty(e.prototype,"isFinalSegmentProduced",{get:function(){return this.producer.isFinalSegmentProduced},enumerable:!0,configurable:!0}),e.prototype.execute=function(e,r){var i=this;return e.then(function(e){if(null===e)return null;var t=i.canProduce(e);if(t.canProduce)return i.heldSegmentInfo=null,i.reportState(),e;var n=new Fe.Deferred;return i.heldSegmentInfo={token:r,segmentInfo:e,deferred:n,reason:t.reason},r.promise.then(function(e){return n.reject(e)}),i.reportState(),i.heldSegmentInfo.deferred.promise})},e.prototype.reportState=function(){null==this.heldSegmentInfo?this.diagnostics.report("state",null):this.diagnostics.report("state",{periodId:this.heldSegmentInfo.segmentInfo.period.id,stream:this.heldSegmentInfo.segmentInfo.stream.id,index:this.heldSegmentInfo.segmentInfo.segment.index,startMs:this.heldSegmentInfo.segmentInfo.contentPosition.startTimeMs,endMs:this.heldSegmentInfo.segmentInfo.contentPosition.endTimeMs,reason:this.heldSegmentInfo.reason,timestamp:Date.now()})},e.prototype.canProduce=function(e){for(var t=0,n=this.barriers;t<n.length;t++){var r=n[t].canProduce(e);if(!r.canProduce)return r}return{canProduce:!0}},e}();t.BlockingSegmentInfoProducer=r});e(ML);ML.BlockingSegmentInfoProducer;var IL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("SegmentDownloadQueue"),n=function(){function e(e,t,n){var r=this;this.hasProduced=!1,this.pendingQueryResult=null,this.positionMs=null,this.producedSegments=[],this.productionStoppedReason=null,this.started=!1,this.timer=A.timer,this.unclaimedCount=0,this.waitingCallbacks=[],this.onNewTailoredPeriodsAvailable=function(){r.hasProduced||null==r.positionMs?r.hasProduced&&r.queueMoreSegments():r.queueInitialSegment(r.positionMs)},this.onSegmentProduced=function(e,t,n){r.pendingQueryResult===t?t.token.requested?r.pendingQueryResult=null:(r.addToQueue(e,n),r.pendingQueryResult=null,e.isFinalSegment?(r.productionStoppedReason="Produced final "+r.type+" segment. Stopping production",a.info(r.productionStoppedReason),r.finalSegmentCallback.invoke(e)):(r.productionStoppedReason=null,r.queueMoreSegments()),r.updateState()):a.warn("Got a "+r.type+" segment produced at "+t.contentPositionMs+"ms but we are not waiting for it")},this.type=e,this.periodTailor=t,this.producer=n,this.diagnostics=pp.Diagnostics.create("SegmentDownloadQueue."+e),this.finalSegmentCallback=new Dt.MulticastCallback}return e.prototype.start=function(e){this.started?a.warn(this.type+" queue already started. Ignoring."):(this.started=!0,this.positionMs=e,this.queueInitialSegment(e),this.periodTailor.on("newTailoredPeriodsAvailable",this.onNewTailoredPeriodsAvailable))},e.prototype.stop=function(){null!==this.pendingQueryResult&&(this.pendingQueryResult.cancel(),this.pendingQueryResult=null),this.positionMs=null,this.periodTailor.off("newTailoredPeriodsAvailable",this.onNewTailoredPeriodsAvailable);for(var e=0,t=this.producedSegments;e<t.length;e++){t[e].cancel()}this.producedSegments=[],this.waitingCallbacks=[],this.started=!1,this.hasProduced=!1,this.unclaimedCount=0},e.prototype.onPosition=function(e){this.positionMs=e;for(var t=!1,n=0,r=this.producedSegments;n<r.length;n++){var i=r[n];i.downloadRequest.segment.contentPosition.endTimeMs<=e&&!i.done&&(a.warn(">>> Dropping "+this.type+" download request for segment "+i.downloadRequest.segment.segment.index+" -- it ends at "+i.downloadRequest.segment.contentPosition.endTimeMs+" but playhead is at "+e),i.claimed||(this.unclaimedCount--,t=!0),i.cancel(),i.done=!0)}this.cleanDoneSegments(),null!=this.pendingQueryResult&&this.pendingQueryResult.contentPositionMs+this.pendingQueryResult.durationMs<=e&&this.pendingQueryResult.cancel(),t&&this.validateUnclaimedCount("onPosition")},e.prototype.claim=function(){var e=F.find(this.producedSegments,function(e){return!e.claimed&&!e.done});return null==e?null:(e.claimed=!0,this.unclaimedCount--,this.validateUnclaimedCount("claim"),this.queueMoreSegments(),this.updateState(),e.downloadRequest)},e.prototype.release=function(t){var e=F.find(this.producedSegments,function(e){return e.downloadRequest===t});null!=e&&(e.claimed?e.done?a.error("Attempted to release a "+this.type+" segment, but it is already done!"):(e.claimed=!1,this.unclaimedCount++,this.validateUnclaimedCount("release"),this.invokeCallback(),this.updateState()):a.error("Attempted to release a "+this.type+" segment, but it is not claimed!"))},e.prototype.done=function(t){var e=F.find(this.producedSegments,function(e){return e.downloadRequest===t});null!=e&&(e.claimed=!1,e.done=!0,this.validateUnclaimedCount("done"),this.cleanDoneSegments(),this.updateState())},e.prototype.wait=function(e){this.waitingCallbacks.push(e),0<this.unclaimedCount&&this.invokeCallback()},e.prototype.getQueuedRange=function(e){void 0===e&&(e=!0);for(var t={startMs:1/0,endMs:-1/0},n=0;n<this.producedSegments.length&&this.producedSegments[n].done;)n++;if(n<this.producedSegments.length){var r=this.producedSegments[n],i=F.last(this.producedSegments);t.startMs=r.downloadRequest.segment.contentPosition.startTimeMs,t.endMs=i.downloadRequest.segment.contentPosition.endTimeMs}return e&&null!==this.pendingQueryResult&&(t.startMs=Math.min(t.startMs,this.pendingQueryResult.contentPositionMs),t.endMs=Math.max(t.endMs,this.pendingQueryResult.contentPositionMs+this.pendingQueryResult.durationMs)),isFinite(t.startMs)?t:null},e.prototype.onFinalSegment=function(e){this.finalSegmentCallback.add(e)},e.prototype.offFinalSegment=function(e){this.finalSegmentCallback.remove(e)},e.prototype.addToQueue=function(e,t){var n=Fe.CancelToken.source(),r=n.token,i=n.cancel,o={downloadRequest:{segment:e,token:r,previousSegment:null!=t?{periodId:t.period.id,index:t.segment.index}:void 0},segmentInfo:e,cancel:i,claimed:!1,done:!1};this.producedSegments.push(o),this.unclaimedCount++,this.validateUnclaimedCount("addToQueue"),this.cleanDoneSegments(),this.invokeCallback(),this.updateState()},e.prototype.queueInitialSegment=function(n){var r=this,e=Fe.CancelToken.source(),t=e.token,i=e.cancel,o={contentPositionMs:n,durationMs:1e3,token:t,cancel:i,promise:this.producer.getSegmentAt(n,t).then(function(e){if(null!=e)r.hasProduced=!0,r.onSegmentProduced(e,o);else{var t="["+r.type+"] queueInitialSegment("+n+") failed";F.contains(iE.CRITICAL_STREAM_TYPES,r.type)?a.error(t):a.info(t),r.detectFinalFragment(o)}}).catch(function(e){e instanceof Fe.CancelError||a.error("Failed to query "+r.type+" segment at "+n+": ",e)})};this.pendingQueryResult=o},e.prototype.queueMoreSegments=function(){var t=this;if(2<=this.unclaimedCount)return this.productionStoppedReason="Too many unclaimed segments ("+this.unclaimedCount+" >= 2)",void this.updateState();if(null===this.pendingQueryResult){var n=F.last(this.producedSegments);if(n.segmentInfo.isFinalSegment)return this.productionStoppedReason="Segment "+n.segmentInfo.segment.index+" of period "+n.segmentInfo.period.id+" was the final segment",void this.updateState();var e=Fe.CancelToken.source(),r=e.token,i=e.cancel,o={contentPositionMs:n.segmentInfo.contentPosition.startTimeMs+n.segmentInfo.contentPosition.durationMs,durationMs:1e3,token:r,cancel:i,promise:this.producer.getNextSegment(n.segmentInfo,r).then(function(e){null==e?t.detectFinalFragment(o,n.segmentInfo):t.onSegmentProduced(e,o,n.segmentInfo)}).catch(function(e){t.productionStoppedReason="Failed to query "+t.type+" segment after "+n.segmentInfo.segment.index+" of period "+n.segmentInfo.period.id+": "+e,e instanceof Fe.CancelError||a.error(t.productionStoppedReason,e),t.updateState()})};this.pendingQueryResult=o}},e.prototype.invokeCallback=function(){var t=this;this.timer.setImmediate(function(){var e=t.waitingCallbacks.shift();null!=e&&e()})},e.prototype.cleanDoneSegments=function(){for(;1<this.producedSegments.length&&this.producedSegments[0].done;)this.producedSegments.shift();this.updateState()},e.prototype.detectFinalFragment=function(e,t){this.producer.isFinalSegmentProduced?null!=t?(this.productionStoppedReason="Didn't get a "+this.type+" segment because final segment was already produced",a.info(this.productionStoppedReason),this.finalSegmentCallback.invoke(t)):(this.productionStoppedReason="Didn't get a "+this.type+" segment because final segment was already produced, but we don't have it!",a.error(this.productionStoppedReason)):(this.productionStoppedReason="Did not get a "+this.type+" segment back for a query at "+e.contentPositionMs+"ms. Not adding anything else.",a.warn(this.productionStoppedReason)),this.pendingQueryResult=null,this.updateState()},e.prototype.validateUnclaimedCount=function(e){var t=this.producedSegments.reduce(function(e,t){return e+(t.claimed||t.done?0:1)},0);t!==this.unclaimedCount&&(a.error("When executing a "+e+", "+this.type+" unclaimed count got out of sync. unclaimedCount="+this.unclaimedCount+" but actual count of unclaimed and not done segments is "+t),this.unclaimedCount=t)},e.prototype.updateState=function(){var e={queue:this.producedSegments.map(function(e){return{periodId:e.segmentInfo.period.id,streamId:e.segmentInfo.stream.id,index:e.segmentInfo.segment.index,startMs:e.segmentInfo.contentPosition.startTimeMs,endMs:e.segmentInfo.contentPosition.endTimeMs,isFinalSegment:e.segmentInfo.isFinalSegment,claimed:e.claimed,done:e.done}}),productionStoppedReason:this.productionStoppedReason,timestamp:Date.now()};this.diagnostics.report("state",e)},e}();t.SegmentDownloadQueue=n});e(IL);IL.SegmentDownloadQueue;var EL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.producers=[],this.onChangeCallback=new Dt.MulticastCallback,this.maxDistanceToSlowestSegmentMs=e}return e.prototype.segmentDownloaded=function(){this.onChangeCallback.invoke()},e.prototype.addProducer=function(e){this.producers.push(e)},e.prototype.canProduce=function(e){for(var t,n=1/0,r=0,i=this.producers;r<i.length;r++){var o=i[r],a=o.getQueuedRange(!0);null!==a&&(a.startMs<n&&(n=a.startMs,t=o.type))}return e.contentPosition.startTimeMs<=n+this.maxDistanceToSlowestSegmentMs?{canProduce:!0}:{canProduce:!1,reason:"Segment starting at "+e.contentPosition.startTimeMs+" is "+this.maxDistanceToSlowestSegmentMs+"ms ahead of "+t+" segment at "+n+"ms"}},e.prototype.onChange=function(e){this.onChangeCallback.add(e)},e.prototype.offChange=function(e){this.onChangeCallback.remove(e)},e}();t.SlowSegmentBarrier=n});e(EL);EL.SlowSegmentBarrier;var _L=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.downloadConfig=e,this.timeoutFactorFunction=new Rp.PiecewiseLinearFunction(this.downloadConfig.scheduler.bufferFullnessSecondsToTimeoutFactorGraph)}return e.prototype.calculateTimeout=function(e,t,n){var r=null===n.latencyAvgMs?0:n.latencyAvgMs,i=Math.max(e.fragment.lengthMs,r)*this.timeoutFactorFunction.evaluate(t/1e3);return Math.max(this.downloadConfig.minTimeoutMs,i)},e}();t.BufferSizeBasedTimeoutCalculator=n});e(_L);_L.BufferSizeBasedTimeoutCalculator;var xL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.LEGACY="LEGACY",e.RETENTION_LOW="RETENTION_LOW",e}();t.AudioAdaptationSelectionMode=n});e(xL);xL.AudioAdaptationSelectionMode;var kL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.extend=function(e,t){return xt.deepExtend(e,t)},e}();t.PlaybackSettingsMerger=n});e(kL);kL.PlaybackSettingsMerger;var RL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("PlaybackSettingsParser"),r=function(){function e(){}return e.fromEncodedString=function(e){try{return JSON.parse(tb.decodeString(e))}catch(e){return n.error("Invalid encoded PlaybackSettings:",e),null}},e}();t.PlaybackSettingsParser=r});e(RL);RL.PlaybackSettingsParser;var AL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function a(){}return a.sanitize=function(e,t){var n=[];a.sanitizeBufferSettings(e.buffer,function(e){n=n.concat(e)});for(var r=0,i=a.GRAPH_TYPE_KEYS;r<i.length;r++){var o=i[r];a.sortGraphType(e,o,n)}return 0<n.length&&null!=t&&t(n),e},a.sanitizeBufferSettings=function(e,t){if(null!=e.forwardBufferLengthSeconds){var n=e.forwardBufferLengthSeconds;e.forwardBufferLengthSeconds=Math.max(n,xt.withDefault(e.bufferFullnessForPlaybackStartSeconds,0),xt.withDefault(e.bufferFullnessForPlaybackResumeSeconds,0)),n!==e.forwardBufferLengthSeconds&&null!=t&&t(["bufferSettings.forwardBufferLengthSeconds"])}return e},a.sortGraphType=function(e,t,n){var r=xt.nestedValue(e,t);if(null!=r){for(var i=0;i<r.length-1;++i)if(r[i][0]>r[i+1][0]){n.push(t);break}r.sort(function(e,t){return e[0]-t[0]})}},a.GRAPH_TYPE_KEYS=["filters.bufferFullnessSecondsToBitrateUpshiftLimitFactorGraph","filters.bufferFullnessSecondsToBitrateDownshiftLimitFactorGraph","filters.bufferFullnessSecondsToBitrateRetryDownshiftLimitFactorGraph","bandwidthPredictor.bufferFullnessSecondsToConfidenceFactorGraph","latencyPredictor.bufferFullnessSecondsToConfidenceFactorGraph","scheduler.bufferFullnessSecondsToTimeoutFactorGraph","timeToDownloadPredictor.bufferFullnessSecondsToBandwidthThrottleFactorGraph","timeToDownloadPredictor.bufferFullnessSecondsToLiveBandwidthThrottleFactorGraph","timeToDownloadPredictor.bufferFullnessSecondsToRetryBandwidthThrottleFactorGraph"],a}();t.PlaybackSettingsSanitizer=n});e(AL);AL.PlaybackSettingsSanitizer;var OL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AudioAdaptationSelectionMode=xL.AudioAdaptationSelectionMode,t.PlaybackSettingsMerger=kL.PlaybackSettingsMerger,t.PlaybackSettingsParser=RL.PlaybackSettingsParser,t.PlaybackSettingsSanitizer=AL.PlaybackSettingsSanitizer});e(OL);OL.AudioAdaptationSelectionMode,OL.PlaybackSettingsMerger,OL.PlaybackSettingsParser,OL.PlaybackSettingsSanitizer;var LL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={audioSelection:{audioAdaptationSetSelectionMode:OL.AudioAdaptationSelectionMode.LEGACY,audioTransferSpeedVariationFactorToTransferSpeedSharePair:[[0,0]],bufferFullnessSecondsToAudioTransferSpeedFactor:[[0,1]]},auxiliaryDownload:{maxAuxiliaryConcurrentRequests:999,maxAuxiliaryRequestsCancellation:999,minBandwidthToMaintainAuxiliaryDownloadKbps:-1,minBandwidthToStartAuxiliaryDownloadKbps:0,minBufferFullnessToMaintainAuxiliaryDownloadSeconds:-1,minBufferFullnessToStartAuxiliaryDownloadSeconds:7},bandwidthPredictor:{averageFragmentWindow:5,averageRequestWindow:10,stdDevFragmentWindow:10,stdDevRequestWindow:10,maxStartingBandwidthKbps:99999999,minStartingBandwidthKbps:0,bufferFullnessSecondsToConfidenceFactorGraph:[[0,-.25]],maxBandwidthHeadroomFactor:.5,minBandwidthHeadroomFactor:.15,bandwidthHeadroomStepFactor:.05,bandwidthBaselineFactor:.1},bola:{bolaAlgorithm:"DYNAMIC_TRADE_OFF_FACTOR",bufferScaler:0,tradeOffFactor:10,bufferLowWatermarkSeconds:80,transientStateBufferThresholdSeconds:40,bufferLowWatermarkSecondsForLowTransient:6,shouldAdjustBufferLowWatermarkForLowTransient:!1,startupBitratePercent:.5,rampUpGoodnessValueFactor:.95,maxRampUpQualityLevel:2,transientClipMaxDurationFactor:.99,transientBufferDurationIncrementScaleFactor:.9,lowTransientBufferDurationIncrementScaleFactor:.7,maxAvailableBufferDurationScaleFactorLow:1,maxAvailableBufferDurationScaleFactorHigh:1,shouldAdjustBufferLowWatermarkForCVBR:!1,scalerThroughputEstimateInGetBolaBitRate:.9,shouldUseThroughputEstimateInGetBolaBitRate:!1,reservedBandwidthForAudioBitsPerSecond:0},buffer:{backwardBufferLengthSeconds:32,bufferFullnessForPlaybackResumeSeconds:6,bufferFullnessForPlaybackStartSeconds:6,delayBehindLiveHeadSeconds:20,forwardBufferLengthSeconds:120},filters:{bufferFullnessSecondsToBitrateUpshiftLimitFactorGraph:[[0,0],[4.9,0],[5,1],[14.9,1],[15,2],[29.9,2],[30,3],[120,3]],bufferFullnessSecondsToBitrateDownshiftLimitFactorGraph:[[0,-50],[4.9,-50],[5,-4],[19.9,-4],[20,-3],[29.9,-3],[30,-2],[44.9,-2],[45,-1],[89.9,-1],[90,0],[120,0]],bufferFullnessSecondsToBitrateRetryDownshiftLimitFactorGraph:[[0,-50],[4.9,-50],[5,-8],[19.9,-8],[20,-6],[29.9,-6],[30,-4],[44.9,-4],[45,-2],[84.9,-2],[85,-1],[120,-1]],maxBitrateKbps:99999999,minBitrateKbps:0,minBaselineUpgradeDifferenceQualityLevels:2},latencyPredictor:{averageFragmentWindow:5,averageRequestWindow:10,stdDevFragmentWindow:10,stdDevRequestWindow:10,bufferFullnessSecondsToConfidenceFactorGraph:[[0,.25]]},player:{heuristicAlgorithm:"DUAL_MODE_HEURISTICS"},retention:{fragmentsToRetain:20,requestsPerFragmentToRetain:4},scheduler:{bufferFullnessSecondsToTimeoutFactorGraph:[[0,1],[10,1.8],[20,2.2],[30,2.5],[40,2.8],[60,3],[90,3.8]],confidenceLevelsToCompute:8,minConfidenceLevelSum:10,maxConcurrentRequests:3,maxFutureDownloadFragments:3,upgradeOffsetFragments:2,upgradeEmptyBufferSkipCountFragments:4},timeToDownloadPredictor:{bitrateVariationFactor:1,bitrateVariationWindow:6,bufferFullnessSecondsToBandwidthThrottleFactorGraph:[[15,.16],[25,.2],[35,.25],[50,.32],[70,.5],[88,.75],[100,.9],[110,1]],bufferFullnessSecondsToLiveBandwidthThrottleFactorGraph:[[10,.5],[20,1]],bufferFullnessSecondsToRetryBandwidthThrottleFactorGraph:[[5,.65],[20,.7],[30,.8],[60,.85],[120,.95]],minBitrateVariationPenaltyFactor:-.2,maxBitrateVariationPenaltyFactor:0}};t.DefaultPlaybackSettings=n});e(LL);LL.DefaultPlaybackSettings;var FL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={heuristicDownloadConfig:{bandwidthPredictor:LL.DefaultPlaybackSettings.bandwidthPredictor,filters:LL.DefaultPlaybackSettings.filters,latencyPredictor:LL.DefaultPlaybackSettings.latencyPredictor,retention:LL.DefaultPlaybackSettings.retention,scheduler:LL.DefaultPlaybackSettings.scheduler,timeToDownloadPredictor:LL.DefaultPlaybackSettings.timeToDownloadPredictor,bandwidthAggregationWindow:3,bufferSizeWindow:10,minTimeoutMs:500,skipWithNormalFragments:!1,player:LL.DefaultPlaybackSettings.player},throughputBasedBitrateSelectorConfig:{bandwidthPredictor:LL.DefaultPlaybackSettings.bandwidthPredictor,latencyPredictor:LL.DefaultPlaybackSettings.latencyPredictor,scheduler:LL.DefaultPlaybackSettings.scheduler,timeToDownloadPredictor:LL.DefaultPlaybackSettings.timeToDownloadPredictor,targetBufferFullnessMs:7e4,bufferFillFactor:.9,bufferSizeRatio:.25,useBufferSizeRatio:!0},qualityLevelBitrateSmoothingConfig:{filters:LL.DefaultPlaybackSettings.filters},liveBitrateSelectorConfig:{bandwidthPredictor:LL.DefaultPlaybackSettings.bandwidthPredictor,timeToDownloadPredictor:LL.DefaultPlaybackSettings.timeToDownloadPredictor},bolaConfig:LL.DefaultPlaybackSettings.bola,bufferSettings:LL.DefaultPlaybackSettings.buffer};t.DefaultHeuristicParameters=n});e(FL);FL.DefaultHeuristicParameters;var DL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.trunv1ify=function(e,t,n){var r=AE.BinaryUtils.convertBufferSourceToUint8Array(e);null==n&&(n=(new i_.BmffParser).parseFragment(r));var i=i_.Boxes.find(n,i_.Boxes.ofType("moof"));if(null!=i){var o=i_.Boxes.find(i,i_.Boxes.ofType("traf"));if(null!=o){var a=i_.Boxes.find(o,i_.Boxes.ofType("trun"));if(null!=a){var s=a.samples[0].compositionTimeOffset;if(null!=s&&0!==s){var l=new DataView(r.buffer),u=l.getUint32(a.absoluteStartPosition+8);l.setUint8(a.absoluteStartPosition+8,1);var c=a.absoluteStartPosition+16;0!=(1&u)&&(c+=4),0!=(4&u)&&(c+=4);var d=0;if(0!=(256&u)&&(d+=4),0!=(512&u)&&(d+=4),0!=(1024&u)&&(d+=4),0==(2048&u))throw new Error("composition time was present in the parsed entry but not in the box data!");d+=4;for(var p=0;p<a.samples.length;p++){var f=c+d-4;l.setInt32(f,l.getUint32(f)-s),c+=d}if(t){var h=i_.Boxes.find(o,i_.Boxes.ofType("tfdt"));if(null==h)throw new Error("Missing tfdt box!");var m=l.getUint8(h.absoluteStartPosition+8),y=h.absoluteStartPosition+12;0===m?l.setUint32(y,l.getUint32(y)+s):l.setUint32(y+4,l.getUint32(y+4)+s)}}}}}}});e(DL);DL.trunv1ify;var NL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=lh,R=M.get("StreamAcquirer"),p=new Rp.StepFunction([[0,50],[3,500],[6,4e3]]),n=function(){function e(e,t,n,r,i,o,a,s,l,u,c,d){var p=this;this.fragmentDownloadHistory=new TL.FragmentHistory,this.initFragmentRequestCancelCallbacks={},this.networkRequestManager=lh.getInstance(),this.pendingMediaFragments=[],this.positionMs=null,this.finalSegmentCallback=function(e){p.fragmentBuffer.setFinalSegment(e.period.id,e.segment.index),p.downloadQueue.offFinalSegment(p.finalSegmentCallback)},this.reportStateChange=function(){var e=p.initFragmentAcquirer.getDiagnostics();p.diagnostics.report("state",{pendingMediaFragments:p.pendingMediaFragments.map(p.convertMediaFragmentForDiagnostics),initFragments:e.initFragments,completedMediaFragmentsWithFailure:p.completedMediaFragmentsWithFailure,completedInitFragmentsWithFailure:e.completedInitFragmentsWithFailure,timestamp:Date.now()})},this.convertMediaFragmentForDiagnostics=function(e){return{segment:{periodId:e.downloadRequest.segment.period.id,streamId:e.downloadRequest.segment.stream.id,index:e.downloadRequest.segment.segment.index,startMs:e.downloadRequest.segment.contentPosition.startTimeMs,endMs:e.downloadRequest.segment.contentPosition.endTimeMs},qualityLevelIndex:e.qualityLevelIndex,initialQueuedTime:e.initialQueuedTime,queuedTime:e.queuedTime,priorityWhenQueued:e.priorityWhenQueued,failureCount:e.failureCount,requestStartedTime:e.requestStartedTime,priorityWhenRequested:e.priorityWhenRequested,timeoutMs:e.timeoutMs,lastFailureReason:e.lastFailureReason,lastFailedTime:e.lastFailedTime,isBlockedByBufferManager:e.isBlockedByBufferManager}},this.type=e,this.contentSource=t,this.periodTailor=n,this.downloadQueue=r,this.fragmentBuffer=i,this.fragmentContentSourceEventEmitter=o,this.localSegmentLoader=c,this.playerBufferManager=a,this.sourceUrlStore=s,this.qualityLevelFilter=l,this.blockedSegmentTracker=u,this.playbackSettings=this.mergeDefaultPlaybackSettings(d),this.completedMediaFragmentsWithFailure=[],this.diagnostics=pp.Diagnostics.create("StreamAcquirer."+e),this.fragmentRequestFactory=new s_.FragmentRequestFactory,this.initFragmentAcquirer=new s_.InitFragmentAcquirer(this.reportStateChange,4),this.playerPrioritizationSystem=a.getPlayerPrioritizationSystem();var f=null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.streamAcquirers?up.configurationStore.configuration.streamAcquirers:null;this.maxConcurrentRequests=null==f?3:xt.withDefault(f.maxConcurrentRequests,3),this.shouldTrunv1ify=null!=f&&!0===f.trunv1ify,null!=f&&null!=f.fallbackDecision?(this.preventQualityFallback=xt.withDefault(f.fallbackDecision.preventQualityFallback,!1),this.preventQualityFallbackBitrateUpgrade=xt.withDefault(f.fallbackDecision.preventQualityFallbackBitrateUpgrade,!1)):(this.preventQualityFallback=!1,this.preventQualityFallbackBitrateUpgrade=!1);var h=xt.deepExtend(FL.DefaultHeuristicParameters.throughputBasedBitrateSelectorConfig,this.playbackSettings),m=xt.deepExtend(FL.DefaultHeuristicParameters.throughputBasedBitrateSelectorConfig,this.playbackSettings),y=this.playbackSettings,g=xt.deepExtend(FL.DefaultHeuristicParameters.heuristicDownloadConfig,this.playbackSettings),v=xt.deepExtend(FL.DefaultHeuristicParameters.bolaConfig,this.playbackSettings.bola),S=xt.deepExtend(FL.DefaultHeuristicParameters.bufferSettings,this.playbackSettings.buffer),b=new TL.AggregatedBitrateSelectorFactory(h,m,y,g,v,S,this.playerBufferManager.getMaxAvailableBytes());this.bitrateSelector=b.createBitrateSelector(e,this.fragmentDownloadHistory),this.timeoutCalculator=new _L.BufferSizeBasedTimeoutCalculator(g),this.downloadQueue.onFinalSegment(this.finalSegmentCallback)}return e.prototype.start=function(e){this.positionMs=e;for(var t=0;t<this.maxConcurrentRequests;t++)this.waitSegment()},e.prototype.stop=function(){for(var e=0,t=Object.keys(this.initFragmentRequestCancelCallbacks);e<t.length;e++){var n=t[e];this.initFragmentRequestCancelCallbacks[n]()}this.initFragmentRequestCancelCallbacks={},this.initFragmentAcquirer.stop();for(var r=0,i=this.pendingMediaFragments;r<i.length;r++){var o=i[r];o.cancelCallback(),null!=o.timerHandle&&(A.timer.clearTimeout(o.timerHandle),o.timerHandle=null)}this.pendingMediaFragments=[],this.completedMediaFragmentsWithFailure=[],this.blockedSegmentTracker.removeAllBlockedSegments(this.type)},e.prototype.onPosition=function(e){this.positionMs=e,this.downloadQueue.onPosition(e)},e.prototype.onRebuffer=function(){this.bitrateSelector.onRebuffer()},e.prototype.onSeek=function(){this.bitrateSelector.onSeek()},e.prototype.isFragmentPending=function(n){return this.pendingMediaFragments.some(function(e){var t=e.downloadRequest.segment.contentPosition;return n>=t.startTimeMs&&n<t.endTimeMs})},e.prototype.isMediaFragmentPendingThat=function(t){return this.pendingMediaFragments.some(function(e){return t(e.downloadRequest,e.fragmentRequest,e.qualityLevelIndex)})},e.prototype.isInitFragmentPendingThat=function(e){return this.initFragmentAcquirer.isInitFragmentPendingThat(e)},e.prototype.registerMediaFragmentRequest=function(v){var S=this,b=this.type+"|"+v.segment.period.id+"|"+v.segment.stream.id+"|"+v.segment.segment.index,e=Fe.CancelToken.source(),T=e.token,P=e.cancel,w=xt.withDefault(F.findWhere(this.pendingMediaFragments,{downloadRequest:v}),{downloadRequest:v,fragmentRequest:null,qualityLevelIndex:null,cancelCallback:P,attempt:0,timerHandle:null,initialQueuedTime:null,queuedTime:null,failureCount:0,priorityWhenQueued:null,requestStartedTime:null,priorityWhenRequested:null,isBlockedByBufferManager:!1,isLocalStorageRetrievalOver:!1});null==w.fragmentRequest?(this.pendingMediaFragments.push(w),v.token.promise.then(function(){w.cancelCallback()})):w.cancelCallback=P;var C,M,I,E=v.segment.contentPosition.startTimeMs,_={fulfilled:!1},x=this.getPriorityFunction(T,v),k={assetType:"mediaFragment."+this.type,getRequestBuilder:function(e){if(T.requested)return null;var t=S.getFragmentInfos(v,S.playbackSettings.timeToDownloadPredictor.bitrateVariationWindow);if(null==t)return null;null==w.fragmentRequest?w.fragmentRequest={index:v.segment.segment.index,attempt:0,requestType:"Normal",fragment:t[0],futureFragments:t.slice(1)}:(w.fragmentRequest.attempt++,w.fragmentRequest.fragment=t[0],w.fragmentRequest.futureFragments=t.slice(1));var n=w.fragmentRequest,r=S.getBufferSizeMs(),i=S.selectBitrate(n,r,e,v.segment.stream),o=S.calculateTimeout(n,r,e);w.qualityLevelIndex=i,M=v.segment.stream.qualityLevels[i],k.description=b+"|"+M.id;var a=M.segmentTimeline.getEquivalentSegment(v.segment.segment);if("RefreshMe"===a.type){for(var s=M,l=a.load(),u=0,c=n.futureFragments;u<c.length;u++){var d=c[u];d.fragmentQualities=d.fragmentQualities.filter(function(e,t){return n.fragment.fragmentQualities[t].valid})}n.fragment.fragmentQualities=n.fragment.fragmentQualities.filter(function(e){return e.valid});var p=null;if(0===n.fragment.fragmentQualities.length)R.warn("BitrateSelector selected a missing "+S.type+" segment "+v.segment.segment.index+", and all available qualities are filtered. Loading the selected quality and deferring fragment download.");else if(S.preventQualityFallback)R.warn("BitrateSelector selected a missing "+S.type+" segment "+v.segment.segment.index+", and configuration is to always wait for missing qualities. Loading the selected quality and deferring fragment download.");else if(p=S.selectBitrate(n,r,e,v.segment.stream),S.preventQualityFallbackBitrateUpgrade){var f=M.bandwidth,h=v.segment.stream.qualityLevels[p].bandwidth;f<h&&(R.warn("BitrateSelector selected a missing "+S.type+" segment "+v.segment.segment.index+", and configuration blocks upgrade from "+f+" to "+h+". Loading the selected quality and deferring fragment download."),p=null)}if(null==p)return l.then(function(){T.requested||(n.attempt--,S.registerMediaFragmentRequest(v))}),null;w.qualityLevelIndex=p,a=(M=v.segment.stream.qualityLevels[p]).segmentTimeline.getEquivalentSegment(v.segment.segment),R.warn("BitrateSelector selected a missing "+S.type+" quality "+s.id+". Falling back to "+M.id+", and loading the other")}if("RefreshMe"===a.type)throw new Error("Someone pulled the rug from us: "+S.type+" segment "+v.segment.segment.index+" is not readily available on ANY quality levels!");if("Unavailable"===a.type)throw new Error("Someone pulled the rug from us: "+S.type+" segment "+v.segment.segment.index+" is Unavailable on quality "+M.id+": "+a.reason);C=a.segment,S.shouldRegisterInitFragmentRequest(v.segment.period,v.segment.stream,M)&&S.registerInitFragmentRequest(v.segment.period,v.segment.stream,M,E);var m=s_.FragmentUtilities.getSegmentSizeBytes(M,C);if(0===m)return R.error("Received zero sizeBytes"),null;var y={sizeBytes:m,position:v.segment.contentPosition.startTimeMs,getPriority:x,flush:S.getFlushFunction(v,P),onRetry:{retry:S.getRetryFunction(v,T,P),cancelToken:T}};if(_=S.playerBufferManager.reserve(y),I=v.segment.period.id+"_"+v.segment.segment.index,!_.fulfilled){w.isBlockedByBufferManager=!0,w.fragmentRequest.attempt--;var g=v.segment.contentPosition.startTimeMs;return S.blockedSegmentTracker.addBlockedSegment(S.type,I,g),null}return w.isBlockedByBufferManager=!1,S.blockedSegmentTracker.removeBlockedSegment(S.type,I),S.fragmentDownloadHistory.addEvent({index:v.segment.segment.index,bitrateBps:M.bandwidth,selectedBitrateIndex:w.qualityLevelIndex,fragmentRequestType:w.fragmentRequest.requestType}),w.timeoutMs=o,w.requestStartedTime=Date.now(),w.priorityWhenRequested=x(),S.reportStateChange(),k.getApproximateResponseSizeBytes=function(){return m},S.fragmentRequestFactory.createMediaFragmentRequestBuilder(C,o)},getPriority:x,onCancelled:function(e){},description:b},t=Date.now();0===w.failureCount&&(w.initialQueuedTime=t),w.queuedTime=t,w.priorityWhenQueued=x(),this.reportStateChange(),(w.isLocalStorageRetrievalOver?Fe.Promise.resolve(nL.FAILED_LOAD_CONTEXT):this.localSegmentLoader.retrieveLocalMediaSegment(v,T)).then(function(e){if(T.throwIfRequested(),e.isLoaded&&null!=e.qualityLevel){var t=v.segment.period,n=v.segment.stream,r=e.qualityLevel;S.shouldRegisterInitFragmentRequest(t,n,r)&&S.registerInitFragmentRequest(t,n,r,v.segment.contentPosition.startTimeMs);var i=S.pendingMediaFragments.indexOf(w);return S.pendingMediaFragments.splice(i,1),S.reportStateChange(),S.downloadQueue.done(v),S.waitSegment(),null}return w.isLocalStorageRetrievalOver=!0,S.reportStateChange(),S.networkRequestManager.requestDownload(k,T)}).then(function(e){if(T.throwIfRequested(),null!=e)if(_.fulfilled)if(null!=C&&null!=M){S.onRequestSucceed(e,C.sourceUrl);var t=e.getMetrics(),n=s_.FragmentUtilities.getSegmentSizeFromByteRange(C.byteRange),r={type:S.type,bitrateBps:M.bandwidth,expectedBytes:n,url:C.sourceUrl.url,urlId:C.sourceUrl.urlId,status:e.getStatus(),totalBytes:t.totalBytes,latencyMs:e.getLatencyMs(),totalMs:e.getTotalMs(),headers:e.getHeaders(),fragmentIndex:C.index,fragmentDurationMs:C.position.durationMs};S.addFragmentResolution(r,M),S.fragmentContentSourceEventEmitter.emit("fragmentDownloaded",r),S.diagnostics.report("fragmentDownloaded",{type:S.type,initFragment:!1,fragmentIndex:v.segment.segment.index,qualityLevelIndex:w.qualityLevelIndex,bitrateBps:M.bandwidth,status:e.getStatus(),expectedBytes:n,totalBytes:t.totalBytes,latencyMs:e.getLatencyMs(),totalMs:e.getTotalMs(),pretransferMs:t.pretransferMs,sslConnectMs:t.sslConnectMs,tcpConnectMs:t.tcpConnectMs,dnsLookupMs:t.dnsLookupMs,redirectMs:t.dnsLookupMs});var i=e.getArrayBuffer();s_.FragmentUtilities.validateDownloadedSegmentData(i,C),S.shouldTrunv1ify&&DL.trunv1ify(i,!0),S.fragmentBuffer.addMediaFragment({isInitSegment:!1,type:S.type,index:C.index,isFinalSegment:v.segment.isFinalSegment,periodId:v.segment.period.id,streamId:v.segment.stream.id,qualityLevelId:M.id,bitrateBps:M.bandwidth,position:v.segment.contentPosition,data:i,onFreed:_.onFreed}),null!=v.previousSegment&&v.previousSegment.periodId!==v.segment.period.id&&S.fragmentBuffer.linkSegment(v.previousSegment.periodId,v.previousSegment.index,v.segment.period.id,C.index);var o=S.pendingMediaFragments.indexOf(w);S.pendingMediaFragments.splice(o,1),0<w.failureCount&&(4<=S.completedMediaFragmentsWithFailure.length&&S.completedMediaFragmentsWithFailure.shift(),S.completedMediaFragmentsWithFailure.push(S.convertMediaFragmentForDiagnostics(w))),S.reportStateChange();var a=e.getLatencyMs();e.getTotalMs();S.downloadQueue.done(v),S.waitSegment()}else R.error("selectedMediaFragmentInfo is "+C+" and selectedQualityLevel is "+M+", HttpResponse.status: "+e.getStatus());else R.error("reservationResponse should have been fulfilled at this point.")}).catch(function(e){if(_.fulfilled&&_.onFreed(),null!=I&&S.blockedSegmentTracker.removeBlockedSegment(S.type,I),e instanceof Fe.CancelError)return T.requested||S.downloadQueue.release(v),void S.waitSegment();var t="Failed to acquire "+S.type+" media fragment index "+v.segment.segment.index+" for quality "+w.qualityLevelIndex+" on period "+v.segment.period.id;if(e instanceof d.AcquisitionError){t+=" with errorType "+e.reason.type;var n="ParseError"===e.reason.type||"UnknownError"===e.reason.type?e.reason.cause:null;null!=n&&(t+=" caused by "+n),null!=C&&S.onRequestFailed(e,C.sourceUrl);var r=s_.FragmentUtilities.getSegmentSizeFromByteRange(v.segment.segment.byteRange);if("UnknownError"!==e.reason.type&&null!=M&&null!=C){var i={type:S.type,bitrateBps:M.bandwidth,url:C.sourceUrl.url,urlId:C.sourceUrl.urlId,status:xt.nestedValue(e.reason,"statusCode"),latencyMs:xt.nestedValue(e.reason,"timing.latencyMs"),totalMs:xt.nestedValue(e.reason,"timing.totalMs"),expectedBytes:r,headers:xt.nestedValue(e.reason,"headers"),fragmentIndex:C.index,fragmentDurationMs:C.position.durationMs,acquisitionError:e};S.addFragmentResolution(i,M),S.fragmentContentSourceEventEmitter.emit("fragmentDownloadFailed",i)}else"UnknownError"!==e.reason.type&&(t+="\nDid not emit \"fragmentDownloadFailed\", selectedQualityLevel: "+M+", selectedMediaFragmentInfo: "+C);null!=M&&S.diagnostics.report("fragmentDownloadFailed",{type:S.type,initFragment:!1,error:e.reason.type,fragmentIndex:v.segment.segment.index,qualityLevelIndex:w.qualityLevelIndex,bitrateBps:M.bandwidth,expectedBytes:r,status:xt.nestedValue(e.reason,"statusCode"),latencyMs:xt.nestedValue(e.reason,"timing.latencyMs"),totalMs:xt.nestedValue(e.reason,"timing.totalMs")})}R.error(t,e),w.failureCount++,w.lastFailureReason=t,w.lastFailedTime=Date.now(),S.reportStateChange();var o=null==w.fragmentRequest?0:w.fragmentRequest.attempt,a=p.evaluate(o);w.timerHandle=A.timer.setTimeout(function(){w.timerHandle=null,T.requested||S.registerMediaFragmentRequest(v)},a)})},e.prototype.getFlushFunction=function(e,t){var n=this;return function(){return t(),n.downloadQueue.release(e),n.fragmentBuffer.flushFragment(e.segment.period.id,e.segment.segment.index)}},e.prototype.getPriorityFunction=function(e,t){var n=this;return function(){return e.requested?1/0:n.playerPrioritizationSystem.getPriority(n.contentSource,t.segment.contentPosition)}},e.prototype.getRetryFunction=function(t,n,r){var i=this;return function(e){e?n.requested||(r(),i.downloadQueue.release(t)):i.registerMediaFragmentRequest(t)}},e.prototype.shouldRegisterInitFragmentRequest=function(e,t,n){return!this.fragmentBuffer.containsInitFragment(e.id,n.id)&&!this.initFragmentAcquirer.isInitFragmentPending(e,n)&&"Unavailable"!==n.segmentTimeline.getInitSegment().type},e.prototype.registerInitFragmentRequest=function(i,o,a,s,l){var u=this;void 0===l&&(l=0);var e=i.id+"_"+a.id,t=function(){return Math.max(s-u.positionMs,0)},n=Fe.CancelToken.source(),c=n.token,r=n.cancel;this.initFragmentRequestCancelCallbacks[e]=r,A.timer.setImmediate(function(){c.requested||u.initFragmentAcquirer.getInitSegmentInfo(u.type,c,i,a).then(function(r){if(c.throwIfRequested(),null!=r)return(0===l?u.localSegmentLoader.retrieveLocalInitSegment(i,o,a,r,c):Fe.Promise.resolve(!1)).then(function(e){return e?null:u.initFragmentAcquirer.downloadInitFragment(u.type,c,r,i,o,a,t)}).then(function(e){if(null!=e){u.onRequestSucceed(e,r.segment.sourceUrl),u.fragmentBuffer.addInitFragment({isInitSegment:!0,type:u.type,periodId:i.id,streamId:o.id,qualityLevelId:a.id,bitrateBps:a.bandwidth,data:e.getArrayBuffer(),onFreed:function(){}});var t=e.getMetrics(),n=s_.FragmentUtilities.getSegmentSizeFromByteRange(r.segment.byteRange);u.fragmentContentSourceEventEmitter.emit("fragmentDownloaded",{type:u.type,bitrateBps:a.bandwidth,expectedBytes:n,url:r.segment.sourceUrl.url,urlId:r.segment.sourceUrl.urlId,status:e.getStatus(),totalBytes:t.totalBytes,latencyMs:e.getLatencyMs(),totalMs:e.getTotalMs(),headers:e.getHeaders()}),u.diagnostics.report("fragmentDownloaded",{type:u.type,initFragment:!0,status:e.getStatus(),expectedBytes:n,totalBytes:t.totalBytes,latencyMs:e.getLatencyMs(),totalMs:e.getTotalMs(),pretransferMs:t.pretransferMs,sslConnectMs:t.sslConnectMs,tcpConnectMs:t.tcpConnectMs,dnsLookupMs:t.dnsLookupMs,redirectMs:t.dnsLookupMs}),u.reportStateChange()}}).catch(function(e){if(e instanceof d.AcquisitionError){u.onRequestFailed(e,r.segment.sourceUrl);var t=s_.FragmentUtilities.getSegmentSizeFromByteRange(r.segment.byteRange);u.fragmentContentSourceEventEmitter.emit("fragmentDownloadFailed",{type:u.type,bitrateBps:a.bandwidth,url:r.segment.sourceUrl.url,urlId:r.segment.sourceUrl.urlId,status:xt.nestedValue(e.reason,"statusCode"),latencyMs:xt.nestedValue(e.reason,"timing.latencyMs"),totalMs:xt.nestedValue(e.reason,"timing.totalMs"),headers:xt.nestedValue(e.reason,"headers"),expectedBytes:t,acquisitionError:e}),u.diagnostics.report("fragmentDownloadFailed",{type:u.type,initFragment:!0,expectedBytes:t,error:e.reason.type,status:xt.nestedValue(e.reason,"statusCode"),latencyMs:xt.nestedValue(e.reason,"timing.latencyMs"),totalMs:xt.nestedValue(e.reason,"timing.totalMs")})}var n=p.evaluate(l);A.timer.setTimeout(function(){c.requested||u.registerInitFragmentRequest(i,o,a,s,l+1)},n)})})})},e.prototype.onRequestSucceed=function(e,t){var n={body:"",headers:e.getHeaders(),timing:{latencyMs:e.getLatencyMs(),downloadMs:e.getDownloadMs(),totalMs:e.getTotalMs(),parseMs:null},status:e.getStatus(),sourceUrl:t};this.sourceUrlStore.resourceAcquired(n)},e.prototype.onRequestFailed=function(e,t){"UnknownError"!==e.reason.type&&this.sourceUrlStore.resourceAcquisitionFailed(e.reason,c_.AcquisitionResourceType.Fragment,t.urlId)},e.prototype.selectBitrate=function(e,t,n,r){var i=this.bitrateSelector.selectBitrate(e,t,n),o=e.fragment.fragmentQualities[i].bitrateBps,a=F.findIndex(r.qualityLevels,function(e){return e.bandwidth===o});if(a<0)throw new Error(this.type+" segment "+e.index+" non-existent bitrate is selected.");return a},e.prototype.calculateTimeout=function(e,t,n){return this.timeoutCalculator.calculateTimeout(e,t,n)},e.prototype.getFragmentInfos=function(e,t){try{var n=e.segment.segment,r=e.segment.stream,i=this.qualityLevelFilter.filter(r.qualityLevels,r),o=[],a=[n],s=[];s[0]=[];for(var l=0;l<t&&null!=a[l];l++){l<t-1&&(s[l+1]=[]);for(var u=0;u<i.length;u++){var c=i[u];if(null==s[l][u]){var d=c.segmentTimeline.getEquivalentSegment(a[l]);if("Unavailable"===d.type||"RefreshMe"===d.type)continue;s[l][u]=d.segment}var p=s[l][u];if(l<t-1&&null!=p){var f=c.segmentTimeline.getNext(p);"WellKnown"!==f.type&&"Inferred"!==f.type||(s[l+1][u]=f.segment,null==a[l+1]&&(a[l+1]=f.segment))}}}for(l=0;l<a.length;l++){var h=[],m=this.periodTailor.toContentRelative(e.segment.period,a[l].position);o.push({startTimeMs:m.startTimeMs,lengthMs:m.durationMs,fragmentQualities:h});for(u=0;u<i.length;u++){var y={bitrateBps:i[u].bandwidth,sizeBytes:0,valid:!1};if(h.push(y),null!=(p=s[l][u])){y.valid=!0;var g=s_.FragmentUtilities.getSegmentSizeFromByteRange(p.byteRange);if(null!=g){y.sizeBytes=g;continue}}y.sizeBytes=i[u].bandwidth/8*m.durationMs/1e3}}return o}catch(e){return R.error(e),null}},e.prototype.getBufferSizeMs=function(){var e=this.fragmentBuffer.getBufferedRanges().find(this.positionMs);return null!=e?e.end-this.positionMs:0},e.prototype.mergeDefaultPlaybackSettings=function(e){return xt.deepExtend(LL.DefaultPlaybackSettings,e)},e.prototype.waitSegment=function(){var e=this,t=this.downloadQueue.claim();null!==t?A.timer.setTimeout(function(){e.registerMediaFragmentRequest(t)},0):this.downloadQueue.wait(function(){return e.waitSegment()})},e.prototype.addFragmentResolution=function(e,t){if("Video"===this.type){var n=t;null!=n.height&&null!=n.width&&(e.fragmentResolution={height:n.height,width:n.width})}},e}();t.StreamAcquirer=n});e(NL);NL.StreamAcquirer;var UL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("CompositeFilter"),n=function(){function e(){this.filters=[]}return e.prototype.addFilter=function(e){this.filters.push(e)},e.prototype.removeFilter=function(t){this.filters=this.filters.filter(function(e){return e!==t})},e.prototype.filter=function(e,t){for(var n=e,r=0,i=this.filters;r<i.length;r++){n=i[r].filter(n,t)}return 0===n.length&&(o.warn("Quality levels filtered to empty, falling back to first quality level"),n=[e[0]]),n},e.prototype.isValidQuality=function(t,n){return this.filters.every(function(e){return e.isValidQuality(t,n)})},e}();t.CompositeFilter=n});e(UL);UL.CompositeFilter;var BL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("PeriodValidator"),r=function(){function e(){this.invalidPeriodsTimestamp={}}return e.prototype.validatePeriodStreams=function(e){for(var n=e.streams,r=null,t=function(t){if(!n.some(function(e){return e.type===t}))return r=t,"break"},i=0,o=iE.CRITICAL_STREAM_TYPES;i<o.length;i++){if("break"===t(o[i]))break}if(this.updateValidatorState(e,r),null!==r)throw new Ne.XpError("content_src.manifest.parse",void 0,"New MediaRepresentation has period "+e.id+" not containing "+r+" streams",!0)},e.prototype.stopTrackingPeriod=function(e){null!=this.invalidPeriodsTimestamp[e.id]&&delete this.invalidPeriodsTimestamp[e.id]},e.prototype.updateValidatorState=function(e,t){null===t?null!=this.invalidPeriodsTimestamp[e.id]&&n.warn("The exact period "+e.id+" was identified as invalid "+(Date.now()-this.invalidPeriodsTimestamp[e.id])+" ms ago."):(null==this.invalidPeriodsTimestamp[e.id]&&n.error("Invalid period, critical stream "+t+" missing:\n",JSON.stringify(e)),this.invalidPeriodsTimestamp[e.id]=Date.now())},e}();t.PeriodValidator=r});e(BL);BL.PeriodValidator;var VL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("SegmentTimelineHelper"),n=function(){function e(e,t){this.baseQualitySegmentTimelineSelector=new iL.BaseQualitySegmentTimelineSelector,this.initialQualitySelector=new PL.InitialQualitySelector,this.offlineSegmentTimelineSelector=new wL.OfflineSegmentTimelineSelector,this.qualityLevelFilters=t,this.streamSelector=e,this.selectionContext=null}return e.prototype.setSelectionContext=function(e){null!=this.selectionContext&&null==e&&a.warn("Explicitly resetting selection context"),this.selectionContext=e},e.prototype.getFirstSegment=function(e,t){var n=this,r=[this.selectTimeline(e,t,!1,this.selectionContext)],i=Fe.CancelToken.source(),o=i.token,a=(i.cancel,Math.max(e.shiftMs,0));if(null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.streamAcquirers&&null!=up.configurationStore.configuration.streamAcquirers.initialQuality&&!0===up.configurationStore.configuration.streamAcquirers.initialQuality.downloadBaseQualityIndex){var s=this.selectTimeline(e,t,!0,this.selectionContext);r[0]!==s&&r.push(s)}var l=r.map(function(t){return n.waitSegment(function(){return t.getSegmentAt(a,150)},o).then(function(e){return{segmentInfo:e,timeline:t}})});return Fe.Promise.all(l).then(function(e){return e[0]})},e.prototype.getLastSegment=function(n,r,i){var o=this;return Fe.Promise.resolve().then(function(){var t=o.selectTimeline(n,i,!1,o.selectionContext),e=t.getSegmentAt(Math.max(0,r-n.originalStartMs-100,0));if("Unavailable"===e.type)throw new Error("Last segment for period is not available!");return"RefreshMe"===e.type?e.load().then(function(e){if("Unavailable"===e.type)throw new Error("Segment is still not available after a refresh!");return o.iterateToFinalSegment(t,e.segment)}):o.iterateToFinalSegment(t,e.segment)})},e.prototype.selectTimeline=function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=null);var i=this.streamSelector.selectStreams(e,t);if(F.isEmpty(i))throw new Error("Period "+e.id+" returned no "+t+" streams");var o=i[0];if(null!=r&&null!=r[e.id]&&null!=r[e.id][t]&&0<r[e.id][t].length)try{return this.offlineSegmentTimelineSelector.selectTimeline(o,this.qualityLevelFilters[t],r[e.id][t])}catch(e){a.error("Offline segment timeline selection failed. Fallback to online timeline. Error:",e)}return(n?this.baseQualitySegmentTimelineSelector:this.initialQualitySelector).selectTimeline(o,this.qualityLevelFilters[t])},e.prototype.iterateToFinalSegment=function(t,e){var n=this;if(e.isFinalSegment)return Fe.Promise.resolve(e);var r=t.getNext(e);return"Unavailable"===r.type?Fe.Promise.reject("Last segment for period is not available!"):"RefreshMe"===r.type?r.load().then(function(e){if("Unavailable"===e.type)throw new Error("Segment is still not available after a refresh!");return n.iterateToFinalSegment(t,e.segment)}):this.iterateToFinalSegment(t,r.segment)},e.prototype.waitSegment=function(t,n){var r=this,e=t();return("RefreshMe"===e.type?e.load():Fe.Promise.resolve(e)).then(function(e){if(n.throwIfRequested(),"Unavailable"===e.type){if(null==e.etaMs)throw new Error("Segment unavailable without ETA. Reason: "+e.reason);return r.delay(e.etaMs,n).then(function(){return n.throwIfRequested(),r.waitSegment(t,n)})}return e.segment})},e.prototype.delay=function(r,i){return new Fe.Promise(function(e,t){var n=A.timer.setTimeout(e,r);i.promise.then(function(e){A.timer.clearTimeout(n),t(e)})})},e}();t.SegmentTimelineHelper=n});e(VL);VL.SegmentTimelineHelper;var jL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.segmentTimeline=e,this.isInitSegment=!1,this.segmentInfo=n,this.index=n.index,this.isFinalSegment=n.isFinalSegment,this.byteRange=n.byteRange,this.offsetMs=t}return Object.defineProperty(e.prototype,"position",{get:function(){return null==this.computedPosition&&(this.computedPosition={startTimeMs:this.segmentInfo.position.startTimeMs+this.offsetMs,endTimeMs:this.segmentInfo.position.endTimeMs+this.offsetMs,durationMs:this.segmentInfo.position.durationMs}),this.computedPosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceUrl",{get:function(){return this.segmentInfo.sourceUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyId",{get:function(){return this.segmentInfo.keyId},enumerable:!0,configurable:!0}),e}();t.TailoredMediaSegmentInfo=n});e(jL);jL.TailoredMediaSegmentInfo;var XL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("TailoredSegmentTimeline");var n=function(){function e(e,t,n){this.period=t,this.segmentTimeline=e,this.offsetMs=null,this.usePeriodWideOffset=n}return e.prototype.resetTailoring=function(){this.offsetMs=null},e.prototype.offset=function(e){this.offsetMs=e},e.prototype.getInternalOffsetMs=function(){return this.usePeriodWideOffset?this.period.offsetMs:this.offsetMs},Object.defineProperty(e.prototype,"presentationTimeOffsetMs",{get:function(){var e=this.getInternalOffsetMs();return this.segmentTimeline.presentationTimeOffsetMs-(null!=e?e:0)},enumerable:!0,configurable:!0}),e.prototype.getInitSegment=function(){return this.segmentTimeline.getInitSegment()},e.prototype.getNext=function(e){var t=e;return this.offsetSegment(this.segmentTimeline.getNext(t.segmentInfo),null)},e.prototype.getSegmentAt=function(e,t){var n=this,r=this.getInternalOffsetMs();if(null!=r||null==this.period.latestTailoredTimeline){var i=null!=r?r:0;return this.offsetSegment(this.segmentTimeline.getSegmentAt(Math.min(Math.max(e-i,0),this.period.originalDurationMs),t),null)}var o=this.period.latestTailoredTimeline.getSegmentAt(e,t);return"Unavailable"===o.type?o:"RefreshMe"!==o.type?this.getEquivalentSegment(o.segment):{type:"RefreshMe",load:function(){return o.load().then(function(e){if("Unavailable"===e.type)return e;var t=n.getEquivalentSegment(e.segment);return"RefreshMe"===t.type?t.load():t})}}},e.prototype.getEquivalentSegment=function(e){var t=e;return this.offsetSegment(this.segmentTimeline.getEquivalentSegment(t.segmentInfo),t)},e.prototype.offsetSegment=function(e,t){switch(e.type){case"Unavailable":return e;case"Inferred":case"WellKnown":return null!=this.offsetMs||null==t||this.usePeriodWideOffset||(this.offsetMs=t.position.startTimeMs-e.segment.position.startTimeMs,this.period.latestTailoredTimeline=this),{type:e.type,segment:new jL.TailoredMediaSegmentInfo(this.segmentTimeline,this.usePeriodWideOffset?this.period.offsetMs:this.offsetMs,e.segment)};case"RefreshMe":return this.wrapRefreshMeSegment(e,t)}},e.prototype.wrapRefreshMeSegment=function(e,t){var n=this;return{type:"RefreshMe",load:function(){return e.load().then(function(e){return n.offsetSegment(e,t)})}}},e}();t.TailoredSegmentTimeline=n});e(XL);XL.TailoredSegmentTimeline;var zL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.qualityLevel=e,this.timeline=new XL.TailoredSegmentTimeline(this.qualityLevel.segmentTimeline,t,n)}return e.prototype.resetTailoring=function(){this.timeline.resetTailoring()},Object.defineProperty(e.prototype,"bandwidth",{get:function(){return this.qualityLevel.bandwidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"codecPrivateData",{get:function(){return this.qualityLevel.codecPrivateData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"codecs",{get:function(){return this.qualityLevel.codecs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.qualityLevel.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentTimeline",{get:function(){return this.timeline},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"samplingRate",{get:function(){return this.qualityLevel.samplingRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameRate",{get:function(){return this.qualityLevel.frameRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.qualityLevel.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.qualityLevel.width},enumerable:!0,configurable:!0}),e}();t.TailoredQualityLevel=n});e(zL);zL.TailoredQualityLevel;var qL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t,n,r){this.stream=t,this.tailoredQualityLevels=this.stream.qualityLevels.map(function(e){return new zL.TailoredQualityLevel(e,r,!n||"Video"!==t.type)})}return e.prototype.resetTailoring=function(){for(var e=0,t=this.tailoredQualityLevels;e<t.length;e++){t[e].resetTailoring()}},Object.defineProperty(e.prototype,"contentProtections",{get:function(){return this.stream.contentProtections},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"segmentAlignment",{get:function(){return this.stream.segmentAlignment},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.stream.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mimeType",{get:function(){return this.stream.mimeType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"qualityLevels",{get:function(){return this.tailoredQualityLevels},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.stream.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baseId",{get:function(){return this.stream.baseId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.stream.label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"language",{get:function(){return this.stream.language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textType",{get:function(){return this.stream.textType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"subtype",{get:function(){return this.stream.subtype},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pictureAspectRatio",{get:function(){return this.stream.pictureAspectRatio},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioTrackId",{get:function(){return this.stream.audioTrackId},enumerable:!0,configurable:!0}),e}();t.TailoredStream=n});e(qL);qL.TailoredStream;var WL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("TailoredPeriod"),r=function(){function e(e,t){var n=this;this.period=e,this.tailoredStartMs=e.startMs,this.tailoredEndMs=e.endMs,this.totalShiftMs=0,this.totalExtendMs=0,this.totalOffsetMs=0,this.isSkipped=!1,this.latestTailoredTimeline=null,this.tailoringState={start:{tailored:!1,promise:null,cancel:null},end:{tailored:!1,promise:null,cancel:null}},this.tailoredStreams=e.streams.map(function(e){return new qL.TailoredStream(e,t,n)})}return e.prototype.shift=function(e){this.totalShiftMs+=e,this.tailoredStartMs+=e,this.tailoredEndMs+=e,n.info(">> TailoredPeriod "+this.period.id+" shifted by "+e+". Total shift now "+this.totalShiftMs+", and tailored bounds are "+this.tailoredStartMs+"-"+this.tailoredEndMs)},e.prototype.extend=function(e){this.totalExtendMs+=e,this.tailoredEndMs+=e,n.info(">> TailoredPeriod "+this.period.id+" extended by "+e+". Total extend now "+this.totalExtendMs+", and tailored bounds are "+this.tailoredStartMs+"-"+this.tailoredEndMs)},e.prototype.offset=function(e){this.totalOffsetMs=e},e.prototype.resetTailoring=function(){this.isSkipped=!1,this.totalOffsetMs=0,this.totalExtendMs=0,this.totalShiftMs=0,this.tailoredStartMs=this.period.startMs,this.tailoredEndMs=this.period.endMs,this.latestTailoredTimeline=null;for(var e=0,t=this.tailoredStreams;e<t.length;e++){t[e].resetTailoring()}n.info(">> TailoredPeriod "+this.period.id+" was reset to original conditions. Bounds now are "+this.tailoredStartMs+"-"+this.tailoredEndMs)},e.prototype.skip=function(){this.isSkipped=!0,this.extend(-(this.period.endMs-this.period.startMs))},e.prototype.updateEnd=function(){this.tailoredEndMs=this.period.endMs+this.totalShiftMs+this.totalExtendMs},Object.defineProperty(e.prototype,"skipped",{get:function(){return this.isSkipped},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.period.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startMs",{get:function(){return this.tailoredStartMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endMs",{get:function(){return this.tailoredEndMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mediaWallClockUtcStartMs",{get:function(){return this.period.mediaWallClockUtcStartMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFinalPeriod",{get:function(){return this.period.isFinalPeriod},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"streams",{get:function(){return this.tailoredStreams},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offsetMs",{get:function(){return this.totalOffsetMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shiftMs",{get:function(){return this.totalShiftMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extendMs",{get:function(){return this.totalExtendMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalStartMs",{get:function(){return this.period.startMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalEndMs",{get:function(){return this.period.endMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"originalDurationMs",{get:function(){return this.period.endMs-this.period.startMs},enumerable:!0,configurable:!0}),e}();t.TailoredPeriod=r});e(WL);WL.TailoredPeriod;var HL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("PeriodTailor"),n=function(){function e(e,t,n,r,i){var o=this;this.eventEmitter=new Dt.EventEmitter,this.tailorFirstPeriod=!1,this.perTimelineOffsetTracking=!1,this.minimumPlayablePositionMs=e.timeWindow.startMs,this.periods=[],this.periodValidator=new BL.PeriodValidator,this.segmentTimelineHelper=new VL.SegmentTimelineHelper(t,n),this.periodIdMap={},this.streamAlternatorGetter=r,this.onPeriodRemoved=i,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.periodTailor&&(this.tailorFirstPeriod=this.tailorFirstPeriod||!0===up.configurationStore.configuration.periodTailor.tailorFirstPeriod,this.perTimelineOffsetTracking=this.perTimelineOffsetTracking||!0===up.configurationStore.configuration.periodTailor.perTimelineOffsetTracking);var a=function(){try{o.updatePeriods(o.periods,e.periods.contents)}catch(e){s.error("Error occurs when updating periods:",e),o.eventEmitter.emit("fatalError",e)}};a(),e.periods.onChange(a)}return e.prototype.setSelectionContext=function(e){this.segmentTimelineHelper.setSelectionContext(e)},e.prototype.getMinimumPlayablePositionMs=function(){return this.minimumPlayablePositionMs},e.prototype.getStitchingInformation=function(e,t,n,r){var i=this.periodIdMap[e];if(null==i)throw new Error("Unable to find period "+e+": Current periods are "+JSON.stringify(this.periods.map(function(e){return e.id})));var o=this.findStream(i,t,n);if(null==o)throw new Error("Unable to find "+t+" stream "+n+" on period "+e);var a=F.find(o.qualityLevels,function(e){return e.id===r});if(null==a)throw new Error("Unable to find "+t+" qualityLevel "+r+" on stream "+n+" of period "+e+"!");return{timestampOffsetMs:i.startMs-a.segmentTimeline.presentationTimeOffsetMs,appendWindowStartMs:Math.max(0,i.startMs-3*eL.Constants.CIRCA_ONE_FRAME_MS),appendWindowEndMs:i.tailoringState.end.tailored?i.endMs+3*eL.Constants.CIRCA_ONE_FRAME_MS:1/0}},e.prototype.playbackTimeToManifestTime=function(e,t){var n=this.periodIdMap[e];return null==n?t:t-n.shiftMs-n.offsetMs},e.prototype.manifestTimeToPlaybackTime=function(e,t){var n=this.periodIdMap[e];return null==n?t:t+n.shiftMs+n.offsetMs},e.prototype.getPeriodAt=function(o){var a=this;return Fe.Promise.resolve(this.periods).then(function(e){if(F.isEmpty(e)||o<e[0].startMs)return null;for(var t=null,n=0,r=a.periods;n<r.length;n++){var i=r[n];if(o<i.endMs){t=i;break}}return null===t?t:(t.tailoringState.start.tailored||null!==t.tailoringState.start.promise||t.tailoringState.end.tailored||null!==t.tailoringState.end.promise||a.resetTailoring(),a.tailorPeriodStart(t))})},e.prototype.getNextPeriod=function(r){var i=this;return Fe.Promise.resolve(this.periods).then(function(e){var t=F.findIndex(e,function(e){return r.id===e.id}),n=-1<t?xt.withDefault(e[t+1],null):null;return null===n?n:n.tailoringState.start.tailored?n:i.tailorPeriodStart(n,e[t])}).then(function(e){return null!==e&&e.skipped?i.getNextPeriod(e):e})},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.toContentRelative=function(e,t){var n=e;return{startTimeMs:Math.max(n.startMs+t.startTimeMs,0),durationMs:t.durationMs,endTimeMs:Math.max(n.startMs+t.endTimeMs,0)}},e.prototype.findStream=function(e,t,n){var r=e.streams.filter(function(e){return e.type===t&&e.id===n});return F.isEmpty(r)?null:this.streamAlternatorGetter(t).selectStream(r)},e.prototype.updatePeriods=function(e,t){for(var n=0;n<e.length&&e[n].id!==t[0].id;)this.onPeriodRemoved(e[n].id),this.periodValidator.stopTrackingPeriod(e[n]),delete this.periodIdMap[e[n].id],e.splice(n,1);if(e.length>t.length)throw new Ne.XpError("content_src.manifest.parse",void 0,"New MediaRepresentation has removed periods from the leading edge!",!0);for(;n<e.length&&e[n].id===t[n].id;)this.periodValidator.validatePeriodStreams(t[n]),isFinite(t[n].endMs)&&e[n].tailoringState.start.tailored&&!e[n].tailoringState.end.tailored&&null==e[n].tailoringState.end.promise&&(e[n].updateEnd(),this.tailorPeriodEnd(e[n])),n++;if(n<e.length)throw new Ne.XpError("content_src.manifest.parse",void 0,"New MediaRepresentation has replaced period "+e[n].id+" with "+t[n].id,!0);for(n<t.length&&this.eventEmitter.emit("newTailoredPeriodsAvailable");n<t.length;)this.periodValidator.validatePeriodStreams(t[n]),e[n]=new WL.TailoredPeriod(t[n],this.perTimelineOffsetTracking),this.periodIdMap[e[n].id]=e[n],n++;return e},e.prototype.resetTailoring=function(){for(var e=0,t=this.periods;e<t.length;e++){var n=t[e];n.resetTailoring(),n.tailoringState.start.tailored=!1,null!==n.tailoringState.start.cancel&&n.tailoringState.start.cancel(),n.tailoringState.start.promise=null,n.tailoringState.end.tailored=!1,null!==n.tailoringState.end.cancel&&n.tailoringState.end.cancel(),n.tailoringState.end.promise=null}},e.prototype.tailorPeriodStart=function(r,e){var i=this;if(r.tailoringState.start.tailored||!this.tailorFirstPeriod&&this.periods[0]===r)return r.tailoringState.start.tailored=!0,r.tailoringState.end.tailored||!isFinite(r.endMs)?Fe.Promise.resolve(r):this.tailorPeriodEnd(r);if(null===r.tailoringState.start.promise){var t=Fe.CancelToken.source(),o=t.token,n=t.cancel;r.tailoringState.start.cancel=n;var a=void 0;null!=e?(e.tailoringState.start.tailored||s.warn(">>> Previous period "+e.id+" didn't have start tailored, when start tailoring period "+r.id+"!"),e.skipped||e.tailoringState.end.tailored?a=Fe.Promise.resolve(e):null!=e.tailoringState.end.promise?a=e.tailoringState.end.promise:isFinite(e.endMs)?a=this.tailorPeriodEnd(e):(s.warn(">>> EndMs of previous period "+e.id+" is still unknown, when start tailoring period "+r.id),a=Fe.Promise.resolve(null))):a=Fe.Promise.resolve(null),r.tailoringState.start.promise=a.then(function(e){if(o.requested)return null;if(null!=e){r.shift(e.shiftMs+e.extendMs),s.warn(">>> Begin tailoring start position of period {\n                            id:"+r.id+",\n                            originalBoundary:["+r.originalStartMs+","+r.originalEndMs+"],\n                            boundary:["+r.startMs+","+r.endMs+"],\n                            offsetMs:"+r.offsetMs+",\n                            shiftMs:"+r.shiftMs+",\n                            extendMs:"+r.extendMs+"\n                        }");var t=r.startMs-e.endMs;.001<Math.abs(t)&&s.warn(">>> Mismatch between end of period "+e.id+" and start of period "+r.id+": difference of "+t+"ms!!!")}var n=Math.max(r.shiftMs,100);return isFinite(r.originalDurationMs)&&r.originalDurationMs<n?(s.warn(">> Period "+r.id+" has an untailored duration of "+r.originalDurationMs+"ms. Expecting valid period has untailored duration at least "+n+"ms. Skipping it."),null):i.segmentTimelineHelper.getFirstSegment(r,"Video")}).then(function(e){if(o.requested)return null;if(null==e||null==e.segmentInfo){if(!isFinite(r.endMs))throw new Error("Could not get first segment for period, but the period is not ended yet!");s.warn(">> Period "+r.id+" will be skipped! Untailored duration is "+r.originalDurationMs+"ms"),null!==r.tailoringState.end.cancel&&r.tailoringState.end.cancel(),r.skip(),s.warn(">> Period "+r.id+" is skipped and therefore had its end tailored: extendMs: "+r.extendMs+"ms. End shifted: "+r.originalEndMs+" --\x3e "+r.endMs)}else{if(0<Math.abs(e.segmentInfo.position.startTimeMs)){r.offset(-e.segmentInfo.position.startTimeMs),s.warn(">> Segments from period "+r.id+" are being offset by "+r.offsetMs+"ms");var t=e.timeline;t.offset(r.offsetMs),r.latestTailoredTimeline=t}r.extend(r.offsetMs),s.warn(">> Period "+r.id+" had its start tailored: shiftMs="+r.shiftMs+" and extendMs="+r.extendMs+". Start shifted: "+r.originalStartMs+" --\x3e "+r.startMs)}return r.tailoringState.start.tailored=!0,r.tailoringState.start.promise=null,r.tailoringState.start.cancel=null,!isFinite(r.endMs)||r.skipped||r.tailoringState.end.tailored?r:i.tailorPeriodEnd(r)})}return r.tailoringState.start.promise},e.prototype.tailorPeriodEnd=function(r){if(r.tailoringState.end.tailored)return Fe.Promise.resolve(r);if(null===r.tailoringState.end.promise){var e=Fe.CancelToken.source(),i=e.token,t=e.cancel;r.tailoringState.end.cancel=t,r.tailoringState.end.promise=this.segmentTimelineHelper.getLastSegment(r,r.originalEndMs,"Video").catch(function(e){return i.requested||(r.tailoringState.end.promise=null,r.tailoringState.end.cancel=null,s.warn("Could not find last video segment of period "+r.id,e)),null}).then(function(e){if(i.requested)return null;var t=r.endMs-r.startMs,n=null===e?0:e.position.endTimeMs-t;return 0<Math.abs(n)&&s.warn(">>> Period "+r.id+" needs to be further extended by "+n+"ms, for a total of "+(r.extendMs+n)+"ms"),r.extend(n),r.tailoringState.end.tailored=!0,r.tailoringState.end.promise=null,r.tailoringState.end.cancel=null,s.warn(">> Period "+r.id+" had its end tailored: adding "+n+" to extendMs. End shifted: "+r.originalEndMs+" --\x3e "+r.endMs),r})}return r.tailoringState.end.promise},e}();t.PeriodTailor=n});e(HL);HL.PeriodTailor;var GL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("PersistentStorageSelectionLoader"),r=function(){function e(e){void 0===e&&(e=null),this.persistentSelectionContextPromise=null,this.downloadOperationId=e,this.selectionContextKey=b_.createSelectionContextKey(null==e?"":e)}return e.prototype.load=function(){return null!=this.persistentSelectionContextPromise||(RI.metadataStorage.capabilities.isSupported&&null!=this.downloadOperationId?this.persistentSelectionContextPromise=RI.metadataStorage.get(this.selectionContextKey).then(function(e){return null==e?null:e}).catch(function(e){return n.error("Fail to load selection context",e),null}):(n.info("Retrieving persistent selection context is not supported"),this.persistentSelectionContextPromise=Fe.Promise.resolve(null))),this.persistentSelectionContextPromise},e}();t.PersistentStorageSelectionLoader=r});e(GL);GL.PersistentStorageSelectionLoader;var KL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e;this.locks=((e={}).Audio={},e.TimedText={},e.Video={},e),this.diagnostics=pp.Diagnostics.create("BlockedSegmentTracker")}return e.prototype.addBlockedSegment=function(e,t,n){this.locks[e][t]=n,this.reportDiagnosticsState()},e.prototype.removeBlockedSegment=function(e,t){delete this.locks[e][t],this.reportDiagnosticsState()},e.prototype.removeAllBlockedSegments=function(e){this.locks[e]={},this.reportDiagnosticsState()},e.prototype.getMinimumBlockedPositionMs=function(e){for(var t=1/0,n=0,r=Object.keys(this.locks[e]);n<r.length;n++){var i=r[n];t=Math.min(t,this.locks[e][i])}return t},e.prototype.reportDiagnosticsState=function(){this.diagnostics.report("state",{locks:this.locks,timestamp:Date.now()})},e}();t.BlockedSegmentTracker=n});e(KL);KL.BlockedSegmentTracker;var QL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.maxBitrate=e}return e.prototype.filter=function(e,t){var n=this;return e.filter(function(e){return n.isValidQuality(e,t)})},e.prototype.isValidQuality=function(e,t){return e.bandwidth<=this.maxBitrate},Object.defineProperty(e.prototype,"maxBitrateBitsPerSec",{get:function(){return this.maxBitrate},enumerable:!0,configurable:!0}),e}();t.BitrateCapFilter=n});e(QL);QL.BitrateCapFilter;var YL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("PixelCountVideoQualityLevelFilter"),n=function(){function e(){var t=this;this.internalPixelConstraint=Number.MAX_VALUE,this.isValidResolution=function(e){return null!=e.height&&null!=e.width&&e.height*e.width<=t.internalPixelConstraint}}return Object.defineProperty(e.prototype,"pixelConstraint",{get:function(){return this.internalPixelConstraint},set:function(e){this.internalPixelConstraint=e,r.warn("Maximum amount of pixels allowed is "+this.internalPixelConstraint+".")},enumerable:!0,configurable:!0}),e.prototype.resetPixelConstraint=function(){this.internalPixelConstraint=Number.MAX_VALUE,r.info("Amount of pixels is not constrained.")},e.prototype.isPixelConstrained=function(){return this.internalPixelConstraint!==Number.MAX_VALUE},e.prototype.filter=function(e,t){if(this.internalPixelConstraint===Number.MAX_VALUE||null==t.contentProtections||0===t.contentProtections.length)return e;var n=e.filter(this.isValidResolution);return 0===n.length&&r.error("All available video qualities are above pixel constraint."),n},e.prototype.isValidQuality=function(e,t){return this.internalPixelConstraint===Number.MAX_VALUE||null==t.contentProtections||0===t.contentProtections.length||this.isValidResolution(e)},e}();t.PixelCountVideoQualityLevelFilter=n});e(YL);YL.PixelCountVideoQualityLevelFilter;var JL=t(function(e,t){var n,o=V&&V.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a={hdcp:"1.4",hdcpEnforcementResolutionPixels:52e4},s=((n={}).HDCP_NONE="0",n.HDCP_V1="1.4",n.HDCP_V2_2="2.2",n),l=M.get("HdcpRestrictionEnforcer"),r=function(){function e(e,t,n,r,i){this.hdcpLicensePolicy=o({},a),this.pixelCountVideoQualityLevelFilter=new YL.PixelCountVideoQualityLevelFilter,e.addFilter(this.pixelCountVideoQualityLevelFilter),t.addFilter(this.pixelCountVideoQualityLevelFilter),this.videoSegmentMonitor=n,this.notifyRestrictionChange=r,this.triggerStreamRestart=i}return e.prototype.updateHdcpStatus=function(e,t){null==this.hdcpLicensePolicy.hdcpEnforcementResolutionPixels||tx.HdcpStore.compareHdcpStatuses(e,this.hdcpLicensePolicy.hdcp)?this.clearHdcpEnforcementResolutionPixels(t):this.setHdcpEnforcementResolutionPixels(t,this.hdcpLicensePolicy.hdcpEnforcementResolutionPixels)},e.prototype.updateKeyMetadata=function(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];if("CONTENT"===i.keyType){t++;var o=i.hdcp;if(null!=o&&null!=o.hdcpEnforcementResolutionPixels){var a=s[o.hdcp];return null==a?void l.error("Content license policy requires unsupported HDCP level "+o.hdcp+". Keep using default license policy instead."):void this.updateHdcpLicensePolicy({hdcp:a,hdcpEnforcementResolutionPixels:o.hdcpEnforcementResolutionPixels})}}}0<t&&this.updateHdcpLicensePolicy({hdcp:s.HDCP_NONE})},e.prototype.setHdcpEnforcementResolutionPixels=function(e,t){var n=this.pixelCountVideoQualityLevelFilter.pixelConstraint;if(this.pixelCountVideoQualityLevelFilter.pixelConstraint=t,!e&&this.pixelCountVideoQualityLevelFilter.isPixelConstrained()&&this.videoSegmentMonitor.checkResolutionPixels(t)&&(l.warn("Video stream is restricted. Triggering restart."),MT.metrics.putMetric("StreamFlush.Hdcp"),this.triggerStreamRestart("Video")),n!==t||e){var r={streamType:"Video",restrictionType:"Hdcp",hdcpEnforcementResolutionPixels:t};this.notifyRestrictionChange("Video","Hdcp",r)}},e.prototype.clearHdcpEnforcementResolutionPixels=function(e){var t=this.pixelCountVideoQualityLevelFilter.isPixelConstrained();this.pixelCountVideoQualityLevelFilter.resetPixelConstraint(),(t||e)&&this.notifyRestrictionChange("Video","Hdcp",null)},e.prototype.updateHdcpLicensePolicy=function(e){l.info("Content license policy updated to",JSON.stringify(e)),this.hdcpLicensePolicy=e},e}();t.HdcpRestrictionEnforcer=r});e(JL);JL.HdcpRestrictionEnforcer;var $L=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.parseFrameRate=function(e){if(null!=e){var t=Rp.stringToNumber(e);return isNaN(t)?void 0:t}},e.getMaxHeight=function(e){switch(e){case"UHD":return Number.MAX_VALUE;case"HD":return this.MAX_HD_HEIGHT;case"SD":return this.MAX_SD_HEIGHT}},e.getMaxFrameRate=function(e){switch(e){case"HFR":return Number.MAX_VALUE;case"SFR":return this.MAX_SFR}},e.getVideoQuality=function(e){return e>this.MAX_HD_HEIGHT?"UHD":e>this.MAX_SD_HEIGHT?"HD":"SD"},e.getFrameRate=function(e){return e>this.MAX_SFR?"HFR":"SFR"},e.MAX_HD_HEIGHT=1080,e.MAX_SD_HEIGHT=480,e.MAX_SFR=30,e}();t.RendererCapabilitiesUtils=n});e($L);$L.RendererCapabilitiesUtils;var ZL=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("RendererCapabilityFilter");var n=function(){function e(e){this.rendererCapabilityStore=e}return e.prototype.filter=function(e,t){var n=this;return e.filter(function(e){return n.isValidQuality(e,t)})},e.prototype.isValidQuality=function(e,t){return this.rendererCapabilityStore.canRender(e.width,e.height,$L.RendererCapabilitiesUtils.parseFrameRate(e.frameRate))},e}();t.RendererCapabilityFilter=n});e(ZL);ZL.RendererCapabilityFilter;var eF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.from=function(e){var t=this.determineVideoQuality(e.height),n=this.determineFrameRate(e.hdcpStatus,t);return"UHD"===t&&"HFR"===n?null:{streamType:"Video",restrictionType:"RendererCapability",videoQualityToMaxSupportedFrameRate:this.createRestrictedQualities(t,n)}},e.determineVideoQuality=function(e){return e>this.MAX_HD_HEIGHT?"UHD":e>this.MAX_SD_HEIGHT?"HD":"SD"},e.determineFrameRate=function(e,t){return"UHD"===t?"2.2"===e?"HFR":"SFR":"HFR"},e.createRestrictedQualities=function(e,t){var n,r,i;switch(e){case"UHD":return(n={}).UHD=t,n.HD="HFR",n.SD="HFR",n;case"HD":return(r={UHD:null}).HD=t,r.SD="HFR",r;case"SD":return(i={UHD:null,HD:null}).SD=t,i}},e.MAX_HD_HEIGHT=1080,e.MAX_SD_HEIGHT=480,e}();t.RendererCapabilityStreamRestrictionFactory=n});e(eF);eF.RendererCapabilityStreamRestrictionFactory;var tF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===e&&(e=new Dt.EventEmitter),this.deviceDisplayWidth=Yh.deviceCapabilities.output.video.display.width,this.deviceDisplayHeight=Yh.deviceCapabilities.output.video.display.height,this.eventEmitter=e,this.internalHdcpStatus=t}return e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.canRender=function(e,t,n){return null!=t&&null!=n&&(n>$L.RendererCapabilitiesUtils.getMaxFrameRate("SFR")?this.canRenderHFR(t):this.canRenderSFR(t))},e.prototype.canRenderHFR=function(e){var t=this.canRenderSFR(e);return t&&e>$L.RendererCapabilitiesUtils.getMaxHeight("HD")?"2.2"===this.internalHdcpStatus:t},e.prototype.canRenderSFR=function(e){return!0},Object.defineProperty(e.prototype,"hdcpStatus",{set:function(e){this.internalHdcpStatus!==e&&(this.internalHdcpStatus=e,this.eventEmitter.emit("RendererCapabilitiesChange",{streamRestriction:eF.RendererCapabilityStreamRestrictionFactory.from({hdcpStatus:this.internalHdcpStatus,height:this.deviceDisplayHeight,width:this.deviceDisplayWidth})}))},enumerable:!0,configurable:!0}),e}();t.RendererCapabilitiesStore=n});e(tF);tF.RendererCapabilitiesStore;var nF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("ResolutionBasedVideoQualityFilter"),r=function(){function e(e){void 0===e&&(e=720),this.pixelHeightCeiling=e,this.viewHeight=Yh.deviceCapabilities.output.video.applicationViewport.height,this.viewWidth=Yh.deviceCapabilities.output.video.applicationViewport.width}return e.prototype.filter=function(e,t){var n=this;this.updateViewportDetails();for(var r=null,i=0,o=e;i<o.length;i++){var a=o[i];null!=a.height&&720===a.height&&(null===r||a.bandwidth<r.bandwidth)&&(r=a)}return e.filter(function(e){return null!==r&&e.id===r.id||n.isValidResolution(e)})},e.prototype.isValidQuality=function(e,t){return this.updateViewportDetails(),this.isValidResolution(e)},e.prototype.isValidResolution=function(e){var t=null!=e.height&&e.height<=this.viewHeight&&null!=e.width&&e.width<=this.viewWidth;return null!=e.height&&e.height<this.pixelHeightCeiling||t},e.prototype.updateViewportDetails=function(){var e=Yh.deviceCapabilities.output.video.applicationViewport.height,t=Yh.deviceCapabilities.output.video.applicationViewport.width;e===this.viewHeight&&t===this.viewWidth||(this.viewHeight=e,this.viewWidth=t,n.info("Viewport resolution is changed to "+this.viewWidth+"x"+this.viewHeight+"."))},e}();t.ResolutionBasedVideoQualityFilter=r});e(nF);nF.ResolutionBasedVideoQualityFilter;var rF=t(function(e,t){var n,p=V&&V.__assign||function(){return(p=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("StreamRestrictionsManager"),f=((n={}).AppendTimeRatio=null,n.External=null,n.FrameDropRate=null,n.UnexpectedWaiting=null,n.ExternalNetwork=null,n),r=function(){function e(e,t,n,r,i){var o,a,s,l=this;this.cancelUpdateRestrictions=null,this.isStarted=!1,this.maxBitrateThresholdFilters=((o={}).Audio=p({},f),o.TimedText=p({},f),o.Video=p({},f),o),this.playbackRestrictionFilters=((a={}).Video=new UL.CompositeFilter,a),this.restrictionPromise=Fe.Promise.resolve(),this.playbackRestrictions=((s={}).Hdcp=null,s.RendererCapability=null,s),this.onHdcpStatusChanged=function(){l.restrictionPromise=l.updateHdcpRestriction()},this.updateStreamRestriction=function(e,t,n){l.playbackRestrictions[t]=n,l.notifyPlaybackRestrictionChange(e),l.reportDiagnostics()},this.onRendererCapabilityChange=function(e){var t=l.playbackRestrictions.RendererCapability,n=e.streamRestriction;l.isSameRendererRestriction(t,n)||l.updateStreamRestriction("Video","RendererCapability",n)},this.downloadFilters=e,this.hdcpStore=t,this.notifyPlaybackRestrictionChange=r,this.hdcpEnforcer=new JL.HdcpRestrictionEnforcer(this.downloadFilters.Video,this.playbackRestrictionFilters.Video,n,this.updateStreamRestriction,i),this.diagnostics=pp.Diagnostics.create("StreamRestrictionsManager"),e.Video.addFilter(new nF.ResolutionBasedVideoQualityFilter),this.rendererCapabilitiesStore=new tF.RendererCapabilitiesStore;var u=new ZL.RendererCapabilityFilter(this.rendererCapabilitiesStore);this.downloadFilters.Video.addFilter(u),this.playbackRestrictionFilters.Video.addFilter(u);var c=Yh.deviceInformation;if(null!=c.mediaSource&&null!=c.mediaSource.maxVideoBitrate){var d=new QL.BitrateCapFilter(c.mediaSource.maxVideoBitrate);this.downloadFilters.Video.addFilter(d)}}return e.prototype.setMaxBitrateThreshold=function(e,t,n){var r=this.maxBitrateThresholdFilters[e][t];if(null!==r){if(n===r.maxBitrateBitsPerSec)return;this.downloadFilters[e].removeFilter(r)}if(n===1/0)null!==r&&(o.info("["+e+"]["+t+"] MaxBitrateThreshold filter removed."),this.maxBitrateThresholdFilters[e][t]=null);else{o.info("["+e+"]["+t+"] MaxBitrateThreshold filter set to "+n+" bits/sec.");var i=new QL.BitrateCapFilter(n);this.maxBitrateThresholdFilters[e][t]=i,this.downloadFilters[e].addFilter(i)}},e.prototype.start=function(){this.isStarted?o.warn("Attempted to start while already started"):(this.isStarted=!0,this.hdcpStore.on("hdcpStatusChange",this.onHdcpStatusChanged),this.rendererCapabilitiesStore.on("RendererCapabilitiesChange",this.onRendererCapabilityChange),this.restrictionPromise=this.updateHdcpRestriction(!0))},e.prototype.stop=function(){this.isStarted=!1,this.hdcpStore.off("hdcpStatusChange",this.onHdcpStatusChanged),this.rendererCapabilitiesStore.off("RendererCapabilitiesChange",this.onRendererCapabilityChange),null!==this.cancelUpdateRestrictions&&this.cancelUpdateRestrictions()},e.prototype.awaitRestrictionResolution=function(){return this.restrictionPromise},e.prototype.getPlaybackRestrictions=function(){return this.playbackRestrictions},e.prototype.getPlaybackRestrictionFilters=function(){return this.playbackRestrictionFilters},e.prototype.updateKeyMetadata=function(e){this.hdcpEnforcer.updateKeyMetadata(e),this.restrictionPromise=this.updateHdcpRestriction()},e.prototype.updateHdcpRestriction=function(t){var n=this;void 0===t&&(t=!1),null!==this.cancelUpdateRestrictions&&this.cancelUpdateRestrictions();var e=Fe.CancelToken.source(),r=e.token,i=e.cancel;return this.cancelUpdateRestrictions=i,this.hdcpStore.getHdcpStatus().then(function(e){r.throwIfRequested(),n.cancelUpdateRestrictions=null,n.rendererCapabilitiesStore.hdcpStatus=e,n.hdcpEnforcer.updateHdcpStatus(e,t)}).catch(function(e){e instanceof Fe.CancelError||o.error(e.message)})},e.prototype.isSameRendererRestriction=function(e,t){return null===e?null===t:null===t?null===e:F.isEqual(e.videoQualityToMaxSupportedFrameRate,t.videoQualityToMaxSupportedFrameRate)},e.prototype.reportDiagnostics=function(){this.diagnostics.report("state",{playbackRestrictions:this.playbackRestrictions,timestamp:Date.now()})},e}();t.StreamRestrictionsManager=r});e(rF);rF.StreamRestrictionsManager;var iF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i){this.type=e,this.fragmentBuffer=t,this.streamAcquirer=n,this.mediaRepresentation=r,this.getPreferredStream=i}return e.prototype.hasUnpreferredStream=function(){return!!this.hasUnpreferredDownloadedSegment()||this.hasUnpreferredDownloadingSegment()},e.prototype.hasUnpreferredDownloadedSegment=function(){for(var e=0,t=this.fragmentBuffer.getBufferedStreamMetadata();e<t.length;e++){var n=t[e];if(!this.isStreamIdPreferred(n.periodId,n.streamId))return!0}return!1},e.prototype.hasUnpreferredDownloadingSegment=function(){var i=this;return!!this.streamAcquirer.isMediaFragmentPendingThat(function(e,t){var n=e.segment.period.id,r=e.segment.stream.id;return!i.isStreamIdPreferred(n,r)})||this.streamAcquirer.isInitFragmentPendingThat(function(e,t){return!i.isStreamIdPreferred(e,t)})},e.prototype.isStreamIdPreferred=function(e,t){var n=TE.MediaRepresentationQuerier.for(this.mediaRepresentation).itemById(e).value();if(null==n)return!1;var r=this.getPreferredStream(this.type,n);return null!=r&&r.id===t},e}();t.ActiveStreamMonitor=n});e(iF);iF.ActiveStreamMonitor;var oF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("StreamSelectionManager");function c(e){return F.contains(iE.CRITICAL_STREAM_TYPES,e)}var n=function(){function e(e,t,n,r,i,o,a,s,l,u){var c=this;this.activeStreamTypes=[],this.streamMetadata={},this.cancelSetNewStream={},this.setNewStreamsPromise=Fe.Promise.resolve(),this.playbackPositionMs=null,this.cachedCurrentPlaybackPeriod=null,this.started=!1,this.getPreferredStream=function(e,t){var n=c.streamSelector.selectStreams(t,e);return c.streamAlternators[e].selectStream(n)},this.streamSelector=e,this.streamAlternators=t,this.periods=n.periods,this.periodTailor=r,this.fragmentSources=i,this.onContentFlushed=s,this.onStreamMetadataChanged=l,this.onStreamChange=u,this.activeStreamMonitors={},this.streamTypes=Object.keys(i);for(var d=0,p=this.streamTypes;d<p.length;d++){var f=p[d];this.activeStreamMonitors[f]=new iF.ActiveStreamMonitor(f,a[f],o[f],n,this.getPreferredStream),this.initializeStreamAlternator(f),this.setRepresentativeStream(f,this.getRepresentativeStream(f))}this.diagnostics=pp.Diagnostics.create("StreamSelectionManager"),this.state={streamSwitches:[],unsupportedCodecs:{},timestamp:Date.now()}}return e.prototype.start=function(e){this.started?u.warn("Already started"):(this.started=!0,this.playbackPositionMs=e,this.tryUpdateActiveStreamTypes(e))},e.prototype.stop=function(){this.playbackPositionMs=null,this.cachedCurrentPlaybackPeriod=null,this.started=!1},e.prototype.onPosition=function(e){this.playbackPositionMs=e,this.tryUpdateActiveStreamTypes(e)},e.prototype.setStreamMatchers=function(t,n){this.streamSelector.setMatchers(t,n),this.updateStreams(t).catch(function(e){e instanceof Fe.CancelError||u.error(">> setStreamMatchers, type: "+t+", matchers: "+JSON.stringify(n)+", error: "+e.message)})},e.prototype.setUnsupportedCodecs=function(t,n){this.streamAlternators[t].setUnsupportedCodecs(n),this.state.unsupportedCodecs[t]=n,this.started?this.updateStreams(t).catch(function(e){e instanceof Fe.CancelError||u.error(">> setUnsupportedCodecs, type: "+t+", unsupportedCodecs: "+JSON.stringify(n)+", error: "+e.message)}):this.setRepresentativeStream(t,this.getRepresentativeStream(t))},e.prototype.updateStreams=function(t){var n=this,e=this.cancelSetNewStream[t];null!=e&&e();var r=Fe.CancelToken.source(),i=r.token,o=r.cancel;this.cancelSetNewStream[t]=o;var a=this.setNewStreamsPromise.then(function(){if(!i.requested&&n.started){if(null==n.playbackPositionMs)throw new Error("playbackPositionMs is null");if(null!=n.fragmentSources[t]||c(t))return n.periodTailor.getPeriodAt(n.playbackPositionMs).then(function(e){i.throwIfRequested(),null!==e&&n.selectNewStream(e,t)})}});return this.setNewStreamsPromise=a.catch(function(e){e instanceof Fe.CancelError||u.error("updateStreams error:",e)}),a},e.prototype.selectNewStream=function(e,t){if(this.streamAlternators[t].uninitialize(),this.initializeStreamAlternator(t),this.updateActiveStreamTypes(e),null!=this.playbackPositionMs){var n=this.activeStreamMonitors[t];if(null==n)throw new Error("Attempted to select new stream for unavailable StreamType "+t);if(n.hasUnpreferredStream()){var r=this.getPreferredStream(t,e);if(null===r&&c(t))throw new Error("selectStream for type "+t+" returned no streams");if(null===r)return u.info("There isn't a currently available "+t+" stream"),this.fragmentSources[t].stop(),this.fragmentSources[t].start(this.playbackPositionMs),this.onContentFlushed(t),void this.onStreamChange(t);var i=this.streamMetadata[t],o=this.createStreamMetadata(t,r);if(null==i||i.codecs!==o.codecs){u.info("["+t+"] Newly selected stream has different codec. Current stream codec is ["+o.codecs+"] and previous stream codec was ["+(null==i?null:i.codecs)+"]"),this.streamMetadata[t]=o;for(var a=0,s=this.streamTypes;a<s.length;a++){var l=s[a];this.fragmentSources[l].stop(),this.fragmentSources[l].start(this.playbackPositionMs)}MT.metrics.putMetric("StreamSwitch."+t+".DifferentCodec.Started"),this.onStreamMetadataChanged(t,this.playbackPositionMs)}else u.info("["+t+"] Newly selected stream has same codec ["+o.codecs+"] as previous stream"),this.fragmentSources[t].stop(),this.fragmentSources[t].start(this.playbackPositionMs),MT.metrics.putMetric("StreamSwitch."+t+".SameCodec.Started"),this.onContentFlushed(t);this.state.streamSwitches.push({type:t,from:null!=i?{codec:i.codecs}:null,to:{id:r.id,codec:o.codecs}}),this.reportDiagnostics(),this.onStreamChange(t)}}},e.prototype.tryUpdateActiveStreamTypes=function(e,t){var n=this;void 0===t&&(t=!1),!t&&null!=this.cachedCurrentPlaybackPeriod&&this.cachedCurrentPlaybackPeriod.startMs<=e&&e<=this.cachedCurrentPlaybackPeriod.endMs||this.periodTailor.getPeriodAt(e).then(function(e){null!=e&&n.updateActiveStreamTypes(e)}).catch(function(e){e instanceof Fe.CancelError||u.error("updateActiveStreamTypes failed:",e)})},e.prototype.updateActiveStreamTypes=function(e){for(var t={},n=0,r=(this.cachedCurrentPlaybackPeriod=e).streams;n<r.length;n++){t[r[n].type]=!0}this.activeStreamTypes=[];for(var i=0,o=Object.keys(t);i<o.length;i++){var a=o[i];null!==this.getPreferredStream(a,e)&&this.activeStreamTypes.push(a)}},e.prototype.getRepresentativeStream=function(t){if(c(t)){for(var e=0,n=this.periods.contents;e<n.length;e++){var r=n[e];if(null!=(a=this.getPreferredStream(t,r)))return a}throw new Ne.XpError("content_src.no_representative_stream",void 0,"Unable to find a representative stream for type "+t)}for(var i=0,o=this.periods.contents;i<o.length;i++){var a;r=o[i];if(null!=(a=F.find(r.streams,function(e){return e.type===t})))return a}return null},e.prototype.setRepresentativeStream=function(e,t){null!=t&&(this.streamMetadata[e]=this.createStreamMetadata(e,t))},e.prototype.initializeStreamAlternator=function(t){var n=this,e=this.periods.contents.map(function(e){return n.streamSelector.selectStreams(e,t)});this.streamAlternators[t].initialize(e)},e.prototype.createStreamMetadata=function(e,t){var n={mimeType:t.mimeType,codecs:t.qualityLevels[0].codecs};if("Video"===e){var r=t.qualityLevels;n.maxWidth=F.max(r,function(e){return e.width}).width,n.maxHeight=F.max(r,function(e){return e.height}).height,n.framerate=r[0].frameRate}return n},e.prototype.reportDiagnostics=function(){this.state.timestamp=Date.now(),this.diagnostics.report("state",this.state)},e}();t.StreamSelectionManager=n});e(oF);oF.StreamSelectionManager;var aF=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var S=M.get("FragmentContentSource"),b=((n={}).Video=3*eL.Constants.CIRCA_ONE_FRAME_MS,n.Audio=0,n.TimedText=0,n),r=function(){function e(e,t,n,r,i,o,a,s,l,u){var c,d=this;this.onContentFlushed=null,this.onStreamMetadataChanged=null,this.blockedSegmentTracker=new KL.BlockedSegmentTracker,this.cancelFragmentSourcesStart=null,this.eventEmitter=new Dt.EventEmitter,this.fatalError=null,this.started=!1,this.playbackPositionMs=null,this.notifyRestrictionChange=function(e){for(var t=[],n=d.streamRestrictionsManager.getPlaybackRestrictions(),r=0,i=Object.keys(n);r<i.length;r++){var o=n[i[r]];null!==o&&o.streamType===e&&t.push(o)}var a={streamType:e,restrictions:t};S.info("Stream restriction changed:",JSON.stringify(a)),d.eventEmitter.emit("streamRestrictionChange",a)},this.getDistanceFromPlayhead=function(e){return d.playerBufferManager.getPlayerPrioritizationSystem().getDistanceFromPlayhead(d,e)},this.onPeriodRemoved=function(e){for(var t=0,n=d.streamTypes;t<n.length;t++){var r=n[t];d.fragmentBuffers[r].removePeriod(e,!0)}},this.streamAlternatorGetter=function(e){return d.streamAlternators[e]},this.triggerStreamRestart=function(e){if(null!==d.playbackPositionMs){var t=d.sources[e];null!=t&&(S.info("Restarting "+e+" stream."),t.stop(),t.start(d.playbackPositionMs))}else S.warn("Ignoring stream restart without a current position")},this.onFragmentDownloaded=function(){for(var e=0,t=Object.keys(d.fragmentBuffers);e<t.length;e++){var n=t[e];d.state.buffers[n]=d.fragmentBuffers[n].getBufferedRanges().getIntervals()}d.reportDiagnostics()},this.onPeriodTailorFatalError=function(e){e=Ne.XpError.generatePrefixedError(e,"content_src"),d.fatalError=e,d.state.fatalError=e,d.started&&d.eventEmitter.emit("fatalError",e),d.reportDiagnosticsIfStarted()},this.getPreferredStream=function(e,t){var n=d.streamSelector.selectStreams(t,e);return d.streamAlternators[e].selectStream(n)},this.mediaRepresentation=e,this.periods=e.periods,this.getLicense=t,this.playerBufferManager=n,this.sourceUrlStore=i,this.timeWindow=a,this.persistentStorageSelectionLoader=new GL.PersistentStorageSelectionLoader(u),this.diagnostics=pp.Diagnostics.create("FragmentContentSource"),this.state={started:!1,keyIds:[],positionMs:null,fatalError:null,frontBufferSizeMs:null,buffers:{},timestamp:Date.now()},this.streamTypes=this.extractStreamTypes(),this.streamSelector=new iE.StreamSelector(l,r);var p=((c={}).Audio=new UL.CompositeFilter,c.TimedText=new UL.CompositeFilter,c.Video=new UL.CompositeFilter,c);this.periodTailor=new HL.PeriodTailor(e,this.streamSelector,p,this.streamAlternatorGetter,this.onPeriodRemoved),this.fragmentBuffers={},this.downloadQueues={},this.acquirers={},this.localSegmentLoaders={},this.segmentInfoProducers={},this.sources={},this.streamAlternators={},this.frontBufferBarrier=new tL.FrontBufferProductionBarrier(this.getDistanceFromPlayhead,xA.BufferConstants.MAX_FRONT_BUFFER_MS),this.state.frontBufferSizeMs=xA.BufferConstants.MAX_FRONT_BUFFER_MS,this.slowSegmentBarrier=new EL.SlowSegmentBarrier(1e4);for(var f=function(e){h.fragmentBuffers[e]=new $O.FragmentBuffer(e),h.fragmentBuffers[e].onUpdate(function(){d.reportBufferSizeForDiagnostics(e),d.slowSegmentBarrier.segmentDownloaded()}),h.streamAlternators[e]=new iE.streamAlternatorTypeMap[e];var t=new CL.SegmentInfoProducer(e,h.periodTailor,h.streamSelector,h.streamAlternators[e],b[e],p[e]);h.segmentInfoProducers[e]=t;var n=[h.frontBufferBarrier,h.slowSegmentBarrier],r=new ML.BlockingSegmentInfoProducer(e,t,n);h.downloadQueues[e]=new IL.SegmentDownloadQueue(e,h.periodTailor,r),"TimedText"!==e&&h.slowSegmentBarrier.addProducer(h.downloadQueues[e]),h.localSegmentLoaders[e]=new rL.LocalSegmentLoader(e,h.fragmentBuffers[e],p[e],h.persistentStorageSelectionLoader),h.acquirers[e]=new NL.StreamAcquirer(e,h,h.periodTailor,h.downloadQueues[e],h.fragmentBuffers[e],h.eventEmitter,h.playerBufferManager,h.sourceUrlStore,p[e],h.blockedSegmentTracker,h.localSegmentLoaders[e],s),h.sources[e]=new JO.DefaultFragmentSource(e,b[e],h.periodTailor,h.fragmentBuffers[e],h.downloadQueues[e],h.acquirers[e],h.eventEmitter,h.getPreferredStream)},h=this,m=0,y=this.streamTypes;m<y.length;m++){f(y[m])}var g=null!=s?s.buffer:void 0;this.bufferInformationCalculator=new YO.BufferInformationCalculator(this.fragmentBuffers,this.blockedSegmentTracker,g);var v=new ZO.VideoSegmentMonitor(this.fragmentBuffers.Video,this.acquirers.Video,this.mediaRepresentation);this.streamRestrictionsManager=new rF.StreamRestrictionsManager(p,o,v,this.notifyRestrictionChange,this.triggerStreamRestart),this.initializationDataGenerator=new iE.InitializationDataGenerator(e),this.eventEmitter.on("fragmentDownloaded",this.onFragmentDownloaded),this.periodTailor.on("fatalError",this.onPeriodTailorFatalError),this.streamSelectionManager=new oF.StreamSelectionManager(this.streamSelector,this.streamAlternators,e,this.periodTailor,this.sources,this.acquirers,this.fragmentBuffers,function(e){null!=d.onContentFlushed&&d.onContentFlushed(e)},function(e,t){null!=d.onStreamMetadataChanged&&d.onStreamMetadataChanged(e,t)},function(e){d.eventEmitter.emit("streamChange",e)}),this.state.keyIds=this.initializationDataGenerator.keyIds,this.reportDiagnostics()}return Object.defineProperty(e.prototype,"activeStreamTypes",{get:function(){return this.streamSelectionManager.activeStreamTypes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"streamMetadata",{get:function(){return this.streamSelectionManager.streamMetadata},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downloadOperationId",{get:function(){return this.persistentStorageSelectionLoader.downloadOperationId},enumerable:!0,configurable:!0}),e.prototype.flush=function(){for(var e=0,t=this.streamTypes;e<t.length;e++){var n=t[e];this.fragmentBuffers[n].flush()}},e.prototype.setKeyMetadata=function(e){this.streamRestrictionsManager.updateKeyMetadata(e)},e.prototype.isEncrypted=function(){var o=this;return Fe.Promise.resolve().then(function(){for(var e=0,t=o.mediaRepresentation.periods.contents;e<t.length;e++)for(var n=0,r=t[e].streams;n<r.length;n++){var i=r[n];if(null!=i.contentProtections&&0<i.contentProtections.length)return!0}return!1})},e.prototype.isSegmentQualityValid=function(i,o,a,s){var l=this;return"Video"!==i?Fe.Promise.resolve(!0):this.streamRestrictionsManager.awaitRestrictionResolution().then(function(){var e=l.streamRestrictionsManager.getPlaybackRestrictionFilters()[i];if(null==e)return!0;var t=TE.MediaRepresentationQuerier.for(l.mediaRepresentation).itemById(o).streamById(a),n=t.value();if(null===n)return!1;var r=t.qualityLevelById(s).value();return null!==r&&e.isValidQuality(r,n)})},e.prototype.getInitializationData=function(){return this.initializationDataGenerator.getInitializationData().map(function(e){return{type:"cenc",data:e}})},e.prototype.getDurationMs=function(){return this.mediaRepresentation.durationMs},Object.defineProperty(e.prototype,"minimumPlayablePositionMs",{get:function(){return this.periodTailor.getMinimumPlayablePositionMs()},enumerable:!0,configurable:!0}),e.prototype.start=function(e){var i=this;if(S.info(">> start at "+e+"ms, with available streamTypes: "+this.streamTypes),this.started=!0,this.playbackPositionMs=e,this.frontBufferBarrier.onPosition(e),null!==this.fatalError)return S.error("FatalError exists at start:",this.fatalError),this.eventEmitter.emit("fatalError",this.fatalError),void this.reportDiagnostics();this.streamRestrictionsManager.start();var t=Fe.CancelToken.source(),o=t.token,n=t.cancel;this.cancelFragmentSourcesStart=n,this.persistentStorageSelectionLoader.load().then(function(t){if(o.throwIfRequested(),i.periodTailor.setSelectionContext(t),null!==i.playbackPositionMs){i.streamSelectionManager.start(i.playbackPositionMs);for(var e=function(e){i.segmentInfoProducers[e].setSelectionContext(t),i.localSegmentLoaders[e].setSelectionContext(t);("Video"===e?i.streamRestrictionsManager.awaitRestrictionResolution():Fe.Promise.resolve()).then(function(){o.throwIfRequested(),null!==i.playbackPositionMs?i.sources[e].start(i.playbackPositionMs):S.warn("this.playbackPositionMs is null when trying to start FragmentSource")}).catch(function(e){e instanceof Fe.CancelError||S.error(e.message)})},n=0,r=i.streamTypes;n<r.length;n++){e(r[n])}}else S.warn("this.playbackPositionMs is null when trying to start StreamSelectionManager")}).catch(function(e){e instanceof Fe.CancelError||S.error(e.message)}),this.reportDiagnostics()},e.prototype.stop=function(){S.info(">> stop"),(this.playbackPositionMs=null)!=this.cancelFragmentSourcesStart&&this.cancelFragmentSourcesStart(),this.streamRestrictionsManager.stop(),this.streamSelectionManager.stop();for(var e=0,t=this.streamTypes;e<t.length;e++){var n=t[e];this.sources[n].stop()}this.reportDiagnosticsIfStarted(),this.started=!1},e.prototype.setFrontBufferSize=function(e){this.frontBufferBarrier.setFrontBufferSize(e),this.state.frontBufferSizeMs=e,this.reportDiagnosticsIfStarted()},e.prototype.setMaxBitrateThreshold=function(e,t,n){this.streamRestrictionsManager.setMaxBitrateThreshold(e,t,n)},e.prototype.setStreamMatchers=function(e,t){this.streamSelectionManager.setStreamMatchers(e,t)},e.prototype.setUnsupportedCodecs=function(e,t){this.streamSelectionManager.setUnsupportedCodecs(e,t)},e.prototype.onPosition=function(e){this.playbackPositionMs=e,this.frontBufferBarrier.onPosition(e);for(var t=0,n=Object.keys(this.acquirers);t<n.length;t++){var r=n[t];this.acquirers[r].onPosition(e)}for(var i=0,o=Object.keys(this.fragmentBuffers);i<o.length;i++){r=o[i];this.fragmentBuffers[r].trim(e),this.state.buffers[r]=this.fragmentBuffers[r].getBufferedRanges().getIntervals()}this.streamSelectionManager.onPosition(e),this.reportDiagnostics()},e.prototype.onRebuffer=function(){for(var e=0,t=Object.keys(this.acquirers);e<t.length;e++){var n=t[e];this.acquirers[n].onRebuffer()}},e.prototype.seek=function(e){this.onPosition(e);for(var t=0,n=Object.keys(this.acquirers);t<n.length;t++){var r=n[t];this.acquirers[r].onSeek()}},e.prototype.getFragmentSource=function(e){return this.sources[e]},e.prototype.playbackTimeToManifestTime=function(e,t){return this.periodTailor.playbackTimeToManifestTime(e,t)},e.prototype.playbackTimeToWallClockUtcTime=function(t,e){var n=F.findIndex(this.periods.contents,function(e){return e.id===t}),r=this.periods.contents[n];if(null==r)return null;var i=this.periodTailor.playbackTimeToManifestTime(t,e),o=r.mediaWallClockUtcStartMs;if(null==o)for(var a=0,s=n-1;0<=s;s--){var l=this.periods.contents[s];if(a+=l.endMs-l.startMs,null!=l.mediaWallClockUtcStartMs){o=l.mediaWallClockUtcStartMs+a;break}}return null==o?null:i-r.startMs+o},e.prototype.wallClockUtcTimeToPlaybackTime=function(e){for(var t=null,n=0,r=this.periods.contents;n<r.length;n++){var i=r[n];if(null!=i.mediaWallClockUtcStartMs&&e>=i.mediaWallClockUtcStartMs&&(t=i.mediaWallClockUtcStartMs),null!==t){var o=i.endMs-i.startMs;if(t<=e&&e<=t+o){var a=e-t+i.startMs;return this.periodTailor.manifestTimeToPlaybackTime(i.id,a)}t+=o}}return null},e.prototype.getBufferInformationCalculator=function(){return this.bufferInformationCalculator},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.extractStreamTypes=function(){for(var e={},t=0,n=this.periods.contents;t<n.length;t++)for(var r=0,i=n[t].streams;r<i.length;r++){e[i[r].type]=!0}return Object.keys(e)},e.prototype.reportDiagnostics=function(){this.state.started=this.started,this.state.positionMs=this.playbackPositionMs,this.state.timestamp=Date.now(),this.diagnostics.report("state",this.state)},e.prototype.reportDiagnosticsIfStarted=function(){this.started&&this.reportDiagnostics()},e.prototype.reportBufferSizeForDiagnostics=function(e){null!=this.playbackPositionMs&&this.diagnostics.report("fragmentBufferChanged",{type:e,positionMs:this.playbackPositionMs,ranges:this.fragmentBuffers[e].getBufferedRanges().getIntervals().map(function(e){return{startMs:e.start,endMs:e.end}})})},e}();t.FragmentContentSource=r});e(aF);aF.FragmentContentSource;var sF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BufferInformationCalculator=YO.BufferInformationCalculator,t.FragmentContentSource=aF.FragmentContentSource});e(sF);sF.BufferInformationCalculator,sF.FragmentContentSource;var lF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.fromPlaybackUrls=function(e){var t={},n=e.defaultAudioTrackId;null!=n&&(t.Audio=[{baseId:n}]);for(var r=0,i=e.audioTracks;r<i.length;r++){var o=i[r];if(o.audioTrackId===n){t.TimedText=[{language:o.languageCode}];break}}return t}});e(lF);lF.fromPlaybackUrls;var uF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.playbackUrls=e,this.currentUrlSet=this.playbackUrls.urlSets[this.playbackUrls.defaultUrlSetId],this.multicastCallback=new Dt.MulticastCallback}return e.prototype.get=function(){return this.toSourceUrl(this.currentUrlSet)},e.prototype.resourceAcquired=function(e){},e.prototype.resourceAcquisitionFailed=function(e,t,n){return!0},e.prototype.onChange=function(e){this.multicastCallback.add(e)},e.prototype.offChange=function(e){this.multicastCallback.remove(e)},e.prototype.toSourceUrl=function(e){return{url:e.urls.manifest.url,urlId:e.urlSetId,headers:{},adsTrackingEndpoint:e.urls.adsTrackingEndpoint}},e}();t.OfflineSourceUrlStore=n});e(uF);uF.OfflineSourceUrlStore;var cF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){var i=this;if(this.whisperCacheBufferSizeMs=8e3,this.playbackBufferSizeMs=xA.BufferConstants.MAX_FRONT_BUFFER_MS,this.onEnterView=function(){"playing"===i.mpPlayer.playbackState?i.contentSource.setFrontBufferSize(i.playbackBufferSizeMs):i.mpPlayer.on("playbackStateChange",i.onPlaybackStateChange)},this.onPlaybackStateChange=function(e){"playing"===e.playbackState&&(i.contentSource.setFrontBufferSize(i.playbackBufferSizeMs),i.mpPlayer.off("playbackStateChange",i.onPlaybackStateChange))},this.titleIdView=e,this.mpPlayer=t,this.contentSource=n,null!==r){var o=r.buffer.forwardBufferLengthSeconds;null!=o&&(this.playbackBufferSizeMs=1e3*o);var a=r.buffer.bufferFullnessForPlaybackStartSeconds;null!=a&&(this.whisperCacheBufferSizeMs=Math.max(8e3,1e3*a))}}return e.prototype.initialize=function(){this.titleIdView.on("EnterView",this.onEnterView),this.titleIdView.isActive()&&"playing"===this.mpPlayer.playbackState?this.contentSource.setFrontBufferSize(this.playbackBufferSizeMs):this.contentSource.setFrontBufferSize(this.whisperCacheBufferSizeMs)},e.prototype.terminate=function(){this.titleIdView.off("EnterView",this.onEnterView),this.mpPlayer.off("playbackStateChange",this.onPlaybackStateChange)},e}();t.FrontBufferSetter=n});e(cF);cF.FrontBufferSetter;var dF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.resourceAcquirer=new c_.ResourceAcquirer}return e.prototype.getFromStreamingTechnology=function(e,t,n,r,i){if(void 0===n&&(n=null),"DASH"===e)return new Rk.DashMediaRepresentationSource(this.resourceAcquirer,t,n,r,i);throw new Error("StreamingTechnology "+e+" is not supported!")},e}();t.MediaRepresentationSourceFactory=n});e(dF);dF.MediaRepresentationSourceFactory;var pF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.xpPlaylistItemFormatter=function(e){return e.map(function(e,t){var n=e.start,r=null!=e.end?e.end:1/0,i=r-n;return{idx:t,type:e.type,timeMs:"{"+n+", "+r+"}",durationMs:i}})}});e(pF);pF.xpPlaylistItemFormatter;var fF=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("PlaylistItemHandler"),r=function(){function e(e,t,n,r,i,o,a,s){this.timer=A.timer,this.updateIntervalId=null,this.contentMetadata=e,this.contentSource=t,this.mainContentView=n,this.mediaRepresentation=r,this.eventTimelineMetadata=i,this.manifestRelativeConstrainedTimeWindow=o,this.playlistRelativeConstrainedTimeWindow=a,this.sourceUrlStore=s}return e.prototype.append=function(){var e=this.extractMetadata();this.tryStartUpdater(e,!1),this.mainContentView.appendItem(n({},this.contentMetadata,{contentSource:this.contentSource,start:e.startTime,end:e.endTime,contentTimeToPlaylistTimeOffsetMs:e.contentTimeToPlaylistTimeOffsetMs,timelineStart:e.startTime,timelineEnd:e.endTime,timelineUnit:null!=this.mediaRepresentation.utcMsAtZero?Gd.TimeUnit.EpochMillis:Gd.TimeUnit.ContentMillis,playlistRelativeConstrainedTimeWindow:this.playlistRelativeConstrainedTimeWindow,mediaRepresentation:this.mediaRepresentation,sourceUrlStore:this.sourceUrlStore})),this.mainContentView.playlistEngine.tracePlaylistItems(pF.xpPlaylistItemFormatter)},e.prototype.reset=function(e,t,n){this.contentSource=e,this.eventTimelineMetadata=t,this.mediaRepresentation=n,this.stop(),this.tryStartUpdater(this.extractMetadata(),!0)},e.prototype.stop=function(){null!==this.updateIntervalId&&(this.timer.clearInterval(this.updateIntervalId),this.updateIntervalId=null)},e.prototype.extractMetadata=function(){var e=null!=this.mediaRepresentation.utcMsAtZero?this.mediaRepresentation.utcMsAtZero:0,t=0,n=t+this.mediaRepresentation.durationMs;return this.hasLiveScheduleEntries()||null==this.eventTimelineMetadata.durationMs||(t=null!=this.eventTimelineMetadata.startTimeMs?Math.min(this.eventTimelineMetadata.startTimeMs,this.manifestRelativeConstrainedTimeWindow.endMs+e):this.mediaRepresentation.timeWindow.startMs+e,n=Math.max(t+this.eventTimelineMetadata.durationMs,this.mediaRepresentation.timeWindow.endMs+e)),{startTime:t,endTime:n,contentTimeToPlaylistTimeOffsetMs:e}},e.prototype.startUpdater=function(r,i,o,a){var s=this;null!==this.updateIntervalId&&this.timer.clearInterval(this.updateIntervalId),this.updateIntervalId=this.timer.setInterval(function(){var e=s.mediaRepresentation.timeWindow.endMs+r,t=null!=i?Math.min(i,s.manifestRelativeConstrainedTimeWindow.endMs+r):s.mediaRepresentation.timeWindow.startMs+r,n=Math.max(a,e);if(null==s.mediaRepresentation.updatePeriodMs&&e<=a&&(n=e,s.stop()),t!==o||n!==a)try{s.mainContentView.update(o,a,{start:t,end:n,timelineStart:t,timelineEnd:n})}catch(e){l.error("Live Event playlist update failed (["+o+", "+a+"]):",e)}a=n,o=t},2e3)},e.prototype.tryStartUpdater=function(e,t){if(!this.hasLiveScheduleEntries()&&null!=this.eventTimelineMetadata.durationMs&&null!=this.mediaRepresentation.updatePeriodMs){var n=e.startTime,r=e.endTime;if(t){var i=this.mainContentView.playlistEngine.getCurrentItem();null!=i&&(n=i.start,r=null!=i.end?i.end:1/0)}this.startUpdater(e.contentTimeToPlaylistTimeOffsetMs,this.eventTimelineMetadata.startTimeMs,n,r)}},e.prototype.hasLiveScheduleEntries=function(){var e=this.contentMetadata.liveSchedule;return null!=e&&0<e.scheduled.length},e}();t.PlaylistItemHandler=r});e(fF);fF.PlaylistItemHandler;var hF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===t&&(t=3e4),this.mediaRepresentation=e,this.requestedDelayBehindLiveHeadMs=t}return e.prototype.update=function(e){this.mediaRepresentation=e},Object.defineProperty(e.prototype,"startMs",{get:function(){var e=this.mediaRepresentation;return isFinite(e.durationMs)?e.timeWindow.startMs:e.timeWindow.startMs+1e4},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endMs",{get:function(){var e=this.mediaRepresentation;if(isFinite(e.durationMs))return e.timeWindow.endMs;var t=null!=e.updatePeriodMs?e.updatePeriodMs+4e3:0,n=Math.max(t,this.requestedDelayBehindLiveHeadMs);return e.timeWindow.endMs-n},enumerable:!0,configurable:!0}),e}();t.ConstrainedMediaRepresentationTimeWindow=n});e(hF);hF.ConstrainedMediaRepresentationTimeWindow;var mF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.baseTimeWindow=e,this.offsetMs=t}return e.prototype.updateTimeWindow=function(e){this.baseTimeWindow=e},e.prototype.updateOffset=function(e){this.offsetMs=e},Object.defineProperty(e.prototype,"startMs",{get:function(){return this.baseTimeWindow.startMs+this.offsetMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endMs",{get:function(){return this.baseTimeWindow.endMs+this.offsetMs},enumerable:!0,configurable:!0}),e}();t.TimeWindowProxy=n});e(mF);mF.TimeWindowProxy;var yF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("TimeWindowController"),r=function(){function e(e,t,n,r){var i=this;this.timer=A.timer,this.timeWindowCheckId=null,this.onEnterView=function(){"waiting"===i.mpPlayer.contentState&&i.startBufferTimer(),i.mpPlayer.on("contentStateChange",i.onContentStateChange)},this.onExitView=function(){i.stopBufferTimer(),i.mpPlayer.off("contentStateChange",i.onContentStateChange)},this.onContentStateChange=function(e){"waiting"===e?i.startBufferTimer():i.stopBufferTimer()},this.mediaRepresentation=e,this.mpPlayer=t,this.playlistEngine=n,this.view=r,this.playlistRelativeTimeWindow=this.createPlaylistRelativeTimeWindow(e)}return e.prototype.initialize=function(){null!=this.mediaRepresentation.updatePeriodMs&&0!==this.mediaRepresentation.updatePeriodMs&&(this.view.on("EnterView",this.onEnterView),this.view.on("ExitView",this.onExitView))},e.prototype.terminate=function(){this.view.off("EnterView",this.onEnterView),this.view.off("ExitView",this.onExitView),this.mpPlayer.off("contentStateChange",this.onContentStateChange),this.stopBufferTimer()},e.prototype.reset=function(e){this.mediaRepresentation=e,this.playlistRelativeTimeWindow=this.createPlaylistRelativeTimeWindow(e)},e.prototype.startBufferTimer=function(){var e,t=this;this.stopBufferTimer(),this.timeWindowCheckId=this.timer.setTimeout(function(){var e=t.playlistEngine.getCurrentPosition();null!==e?(n.info("Current position "+e+"ms (playlist time) outside time window. Seeking back into time window"),t.playlistEngine.seek(e),t.startBufferTimer()):n.error("Cannot seek back into time window without current position")},null===(e=t.playlistEngine.getCurrentPosition())?(n.warn("Attempted to check for buffer without a current position. Retrying in 1min"),6e4):Math.max(0,e-t.playlistRelativeTimeWindow.startMs))},e.prototype.stopBufferTimer=function(){null!==this.timeWindowCheckId&&this.timer.clearTimeout(this.timeWindowCheckId)},e.prototype.createPlaylistRelativeTimeWindow=function(e){var t=xt.withDefault(e.utcMsAtZero,0);return new mF.TimeWindowProxy(e.timeWindow,t)},e}();t.TimeWindowController=r});e(yF);yF.TimeWindowController;var gF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.playlistRelativeConstrainedTimeWindow=e,this.playlistEngine=t,this.liveContentView=n}return e.prototype.getNewSeekTarget=function(e,t){var n=this.playlistEngine.getItems()[t];if(!F.contains(this.liveContentView.getItems(),n))return{newPosition:e,newItemIndex:t};var r=this.constrainPosition(e);return{newPosition:r,newItemIndex:this.liveContentView.getItemIndex(r)}},e.prototype.constrainPosition=function(e){var t=this.playlistRelativeConstrainedTimeWindow;return Math.max(t.startMs,Math.min(e,t.endMs))},e}();t.TimeWindowEnforcingSeekInterceptor=n});e(gF);gF.TimeWindowEnforcingSeekInterceptor;var vF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var g={dialog:"Dialog",descriptive:"Descriptive",commentary:"Commentary"},n=function(){function e(e,t,n,r,i,o,a,s,l,u,c,d){var p=this;if(this.audioTrackMetadata=null,this.contentSource=null,this.frontBufferSetter=null,this.mainContentView=null,this.mediaRepresentation=null,this.playlistItemHandler=null,this.representationSource=null,this.timeWindowController=null,this.timeWindowEnforcingSeekInterceptor=null,this.onContentSourceFatalError=function(e){e instanceof Ne.XpError&&"content_src.manifest.parse"===e.code?p.mediaEventController.reportError(!0,e,"Player","ManifestParse"):p.mediaEventController.reportError(!0,e,"Player","Error"),p.globalStreamControl.onStreamFatalError(e)},this.contentMetadata=e,this.downloadOperationId=t,this.globalStreamControl=n,this.hdcpStore=r,this.mediaEventController=i,this.mpPlayer=o,this.playbackSettings=a,this.playerBufferManager=l,this.playlistEngine=u,this.streamFeature=d,this.titleIdView=c,this.sourceUrlStore=new uF.OfflineSourceUrlStore(s),0!==s.audioTracks.length){this.audioTrackMetadata={};for(var f=0,h=s.audioTracks;f<h.length;f++){var m=h[f],y=null!=m.audioTrackId?m.audioTrackId:m.languageCode+"_"+m.audioSubtype+"_"+m.index;this.audioTrackMetadata[y]={languageCode:m.languageCode,subtype:g[m.audioSubtype],label:m.displayName}}}this.fallbackLanguageStreamMatchers=lF.fromPlaybackUrls(s)}return e.prototype.initializeContent=function(n){var r=this,e=FA.PlaylistRelativeView.fromView(this.titleIdView,{type:"Main"});this.mainContentView=e,n.promise.then(function(){r.cleanupPlaylistSource()});var t=(new dF.MediaRepresentationSourceFactory).getFromStreamingTechnology("DASH","segmentBase",this.audioTrackMetadata,1,this.downloadOperationId);return this.representationSource=t,this.acquireMediaRepresentation(t).then(function(t){return n.throwIfRequested(),TE.MediaCapabilitiesFilter.create(t).then(function(e){return n.throwIfRequested(),t.applyFilters([e,new TE.AudioQualityLevelFilter]),r.mediaRepresentation=t,r.initializePlaylistSourceComponents(t),r.mainContentView})})},e.prototype.acquireMediaRepresentation=function(e){e.prepare(this.sourceUrlStore,1e4);var t=e.mediaRepresentation;return!0===t.valid?Fe.Promise.resolve(t.contents):t.refresh()},e.prototype.cleanupPlaylistSource=function(){null!=this.timeWindowController&&this.timeWindowController.terminate(),null!=this.timeWindowEnforcingSeekInterceptor&&this.playlistEngine.deregisterSeekInterceptor(this.timeWindowEnforcingSeekInterceptor),null!=this.playlistItemHandler&&this.playlistItemHandler.stop(),null!=this.frontBufferSetter&&this.frontBufferSetter.terminate(),null!=this.contentSource&&(this.contentSource.off("fatalError",this.onContentSourceFatalError),this.contentSource.stop()),null!=this.mediaRepresentation&&this.mediaRepresentation.stop(),null!=this.representationSource&&this.representationSource.stop()},e.prototype.createContentSource=function(e,t){for(var n=new sF.FragmentContentSource(e,function(e,t,n){return Fe.Promise.reject(new Error("License acquisition not implemented yet"))},this.playerBufferManager,this.fallbackLanguageStreamMatchers,this.sourceUrlStore,this.hdcpStore,t,null!=this.playbackSettings?this.playbackSettings:void 0,this.streamFeature.getCurrentMatchers(),this.downloadOperationId),r=this.streamFeature.getCurrentMaxBitrateThresholds(),i=0,o=Object.keys(r);i<o.length;i++){var a=r[c=o[i]];null!=a&&n.setMaxBitrateThreshold(c,"External",a)}for(var s=this.streamFeature.getCurrentUnsupportedCodecs(),l=0,u=Object.keys(s);l<u.length;l++){var c,d=s[c=u[l]];null!=d&&n.setUnsupportedCodecs(c,d)}return n.on("fatalError",this.onContentSourceFatalError),this.frontBufferSetter=new cF.FrontBufferSetter(this.titleIdView,this.mpPlayer,n,this.playbackSettings),this.frontBufferSetter.initialize(),n},e.prototype.initializePlaylistSourceComponents=function(e){var t=null!=this.playbackSettings&&null!=this.playbackSettings.buffer.delayBehindLiveHeadSeconds?1e3*this.playbackSettings.buffer.delayBehindLiveHeadSeconds:void 0,n=new hF.ConstrainedMediaRepresentationTimeWindow(e,t),r=null!=e.utcMsAtZero?e.utcMsAtZero:0,i=new mF.TimeWindowProxy(n,r);e.start(n.requestedDelayBehindLiveHeadMs),this.contentSource=this.createContentSource(e,n),this.playlistItemHandler=new fF.PlaylistItemHandler(this.contentMetadata,this.contentSource,this.mainContentView,e,{},n,i,this.sourceUrlStore),this.playlistItemHandler.append(),this.timeWindowEnforcingSeekInterceptor=new gF.TimeWindowEnforcingSeekInterceptor(i,this.playlistEngine,this.mainContentView),this.playlistEngine.registerSeekInterceptor(this.timeWindowEnforcingSeekInterceptor),this.timeWindowController=new yF.TimeWindowController(e,this.mpPlayer,this.playlistEngine,this.mainContentView),this.timeWindowController.initialize()},e}();t.OfflineContentPlaylistSource=n});e(vF);vF.OfflineContentPlaylistSource;var SF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("ConsumptionAllowedVerifier"),n=function(){function e(e,t,n,r,i,o,a,s,l){var u=this;this.hasRequestedConsumption=!1,this.requestConsumptionIfPlaying=function(){"playing"===u.mpPlayer.playbackState&&u.requestConsumption()},this.onViewEntered=function(){u.mpPlayer.on("playbackStateChange",u.requestConsumptionIfPlaying),u.requestConsumptionIfPlaying()},this.onViewExited=function(){null!=u.cancelRequest&&u.cancelRequest()},this.mpPlayer=e,this.globalStreamControl=a,this.prsRequest=i,this.whispercacheCacheKey=o,this.position=s,this.optOutAdTracking=l,this.titleIdView=r,this.titleIdView.on("EnterView",this.onViewEntered),this.titleIdView.on("ExitView",this.onViewExited),this.prsClient=t,this.mediaEventController=n,this.prsResponseValidator=new ux.PRSResponseValidator}return e.prototype.terminate=function(){this.titleIdView.off("EnterView",this.onViewEntered),this.titleIdView.off("ExitView",this.onViewExited),this.mpPlayer.off("playbackStateChange",this.requestConsumptionIfPlaying),null!=this.cancelRequest&&(this.cancelRequest(),delete this.cancelRequest)},e.prototype.requestConsumption=function(){var r=this;if(!this.hasRequestedConsumption){var e=Fe.CancelToken.source(),i=e.token,t=e.cancel;this.cancelRequest=t,this.hasRequestedConsumption=!0,this.mpPlayer.off("playbackStateChange",this.requestConsumptionIfPlaying),this.prsClient.send(this.prsRequest,i).then(function(e){return e.response()}).then(function(e){i.throwIfRequested();var t=r.prsResponseValidator.validateResponse(e);if(null!==t)throw t;var n=e.playbackUrls;if(null==n||F.isEmpty(n.defaultUrlSetId))throw new Ne.XpError("prs.no_url_set");r.whispercacheCacheKey!==n.cacheKey&&(o.info("Stale PlaybackUrls detected (\""+r.whispercacheCacheKey+"\" -> \""+n.cacheKey+"\"). Restarting stream to invalidate cache."),r.onInvalidCache(),r.globalStreamControl.onStreamRestart({titleId:r.prsRequest.titleId,videoMaterialType:r.prsRequest.videoMaterialType,position:r.position,playbackToken:r.prsRequest.playbackToken,optOutAdTracking:r.optOutAdTracking}))}).catch(function(e){r.onError(e)})}},e.prototype.onError=function(e){e instanceof Fe.CancelError||(this.mediaEventController.reportError(!0,e,"Service","Error"),this.globalStreamControl.onStreamError(e))},e.prototype.onInvalidCache=function(){MT.metrics.putMetric("PRS.InvalidCacheKey");var e=new Ne.XpError("prs.invalid_cache_key");this.mediaEventController.reportError(!1,e,"Service","Error")},e}();t.ConsumptionAllowedVerifier=n});e(SF);SF.ConsumptionAllowedVerifier;function bF(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function TF(e,t){return e>>>t|e<<32-t}function PF(e,t){return e>>>t}var wF=function(e){return function(e){for(var t="0123456789abcdef",n="",r=0;r<4*e.length;r++)n+=t.charAt(e[r>>2]>>8*(3-r%4)+4&15)+t.charAt(e[r>>2]>>8*(3-r%4)&15);return n}(function(e,t){var n,r,i,o,a,s,l,u,c,d,p,f,h,m,y,g,v,S,b=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),T=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),P=new Array(64);e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var w=0;w<e.length;w+=16){n=T[0],r=T[1],i=T[2],o=T[3],a=T[4],s=T[5],l=T[6],u=T[7];for(var C=0;C<64;C++)P[C]=C<16?e[C+w]:bF(bF(bF(TF(S=P[C-2],17)^TF(S,19)^PF(S,10),P[C-7]),TF(v=P[C-15],7)^TF(v,18)^PF(v,3)),P[C-16]),c=bF(bF(bF(bF(u,TF(g=a,6)^TF(g,11)^TF(g,25)),(y=a)&s^~y&l),b[C]),P[C]),d=bF(TF(m=n,2)^TF(m,13)^TF(m,22),(p=n)&(f=r)^p&(h=i)^f&h),u=l,l=s,s=a,a=bF(o,c),o=i,i=r,r=n,n=bF(c,d);T[0]=bF(n,T[0]),T[1]=bF(r,T[1]),T[2]=bF(i,T[2]),T[3]=bF(o,T[3]),T[4]=bF(a,T[4]),T[5]=bF(s,T[5]),T[6]=bF(l,T[6]),T[7]=bF(u,T[7])}return T}(function(e){for(var t=Array(),n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<24-n%32;return t}(e),8*e.length))},CF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("AuditPingListener"),n=function(){function e(e,t,n,r,i){var o=this;this.hasReportedStart=!1,this.hasReportedStop=!1,this.onEnterView=function(){o.hasReportedStop&&(o.hasReportedStart=!1,o.hasReportedStop=!1),l.info("Audit Ping Stream ID:",o.streamId),o.mediaEventController.updateAuditPingStreamId(o.streamId),o.mpPlayer.on("contentStateChange",o.onContentStateChange),o.mpPlayer.on("playbackStateChange",o.onPlaybackStateChange),o.tryReportAuditPingStart()},this.onExitView=function(){if(o.mpPlayer.off("contentStateChange",o.onContentStateChange),o.mpPlayer.off("playbackStateChange",o.onPlaybackStateChange),!o.titleView.isActive()&&o.hasReportedStart&&!o.hasReportedStop){for(var e=0,t=o.auditPings;e<t.length;e++){var n=t[e];o.reportAuditPing(n.url,3)}o.hasReportedStop=!0}o.mediaEventController.updateAuditPingStreamId(null)},this.onContentStateChange=function(e){o.tryReportAuditPingStart()},this.onPlaybackStateChange=function(e){o.tryReportAuditPingStart()},this.hashedPlayerSessionId=this.hash(e),this.streamId=fh.UUID.v4(),this.hashedStreamSessionId=this.hash(this.streamId),this.mpPlayer=t,this.auditPings=n,this.titleView=r,this.mediaEventController=i,this.beaconServiceClient=new NA.BeaconServiceClient}return e.prototype.initialize=function(){this.titleView.on("EnterView",this.onEnterView),this.titleView.on("ExitView",this.onExitView)},e.prototype.terminate=function(){this.titleView.off("EnterView",this.onEnterView),this.titleView.off("ExitView",this.onExitView),this.onExitView()},e.prototype.tryReportAuditPingStart=function(){if("ready"===this.mpPlayer.contentState&&"playing"===this.mpPlayer.playbackState&&!this.hasReportedStart){for(var e=0,t=this.auditPings;e<t.length;e++){var n=t[e];this.reportAuditPing(n.url,1)}this.hasReportedStart=!0}},e.prototype.reportAuditPing=function(i,o){var a=this;l.info("Reporting audit pings with url "+i+" and ping type "+o);var s=Math.floor(Date.now()/1e3);(new Op.ExponentialBackoffRetry).withMaxAttempts(4).withInitialIntervalMs(100).withExponentialFactor(2).withRandomizationFactor(1e3).onAttempt(function(e,t,n,r){a.sendRequest(i,o,s,function(){return n(null)},t,r)}).execute()},e.prototype.sendRequest=function(e,t,n,r,i,o){var a=new ME.URL(e),s={sessionid:this.hashedPlayerSessionId,streamid:this.hashedStreamSessionId,pingtype:t,uoo:0,createtm:n};ME.URLUtils.appendQueryParams(a,s),this.beaconServiceClient.sendAuditPing(a.toString(),r,i,o)},e.prototype.hash=function(e){return wF(e)},e}();t.AuditPingListener=n});e(CF);CF.AuditPingListener;var MF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("LiveMetadataPlaylistUpdater"),n=function(){function e(e){this.playlistRelativeView=e}return e.prototype.updateLiveMetadata=function(e,t){null!=e&&(this.liveSchedule=e,this.updateViewWithSchedule(e)),null!=t&&this.updateViewWithRestrictions(t,this.liveSchedule),this.playlistRelativeView.playlistEngine.tracePlaylistItems(pF.xpPlaylistItemFormatter)},e.prototype.updateViewWithSchedule=function(e){if(0!==e.scheduled.length){for(var t=this.playlistRelativeView.getItems()[0].start,n=0,r=e.scheduled;n<r.length;n++){var i=r[n],o=1e3*i.time.startTime,a=1e3*i.time.endTime;o!==t&&this.updateView(t,o,{timelineStart:t,timelineEnd:o,timelineUnit:Gd.TimeUnit.EpochMillis},"Live schedule gap"),this.updateView(o,a,{catalogMetadata:i.title,liveScheduleTitleId:i.titleId,timelineStart:o,timelineEnd:a,timelineUnit:Gd.TimeUnit.EpochMillis},"Live schedule update"),t=a}this.updateView(t,1/0,{timelineStart:t,timelineEnd:1/0,timelineUnit:Gd.TimeUnit.EpochMillis},"Live schedule future timeline")}},e.prototype.updateView=function(e,t,n,r){try{this.playlistRelativeView.update(e,t,n)}catch(e){i.error(r+". Failed to update main content view:",e)}},e.prototype.updateViewWithRestrictions=function(o,a){if(null!=a)for(var e=function(n){var r=n.startTime;if(null==n.restriction)return"continue";var e=F.find(a.scheduled,function(e){var t=1e3*e.time.startTime;return F.contains(n.identifiers,e.titleId)&&Rp.isApprxEqual(t,r,9e5)});if(null!=e){var t=1e3*e.time.startTime,i=1e3*e.time.endTime;s.updateView(t,i,{pinRestrictions:{pinLength:o.metadata.customerPin.length,restrictions:[n.restriction]}},"LinearRestrictions")}},s=this,t=0,n=o.programs;t<n.length;t++){e(n[t])}var r={};null!=o.defaultRestriction.restriction&&(r={pinLength:o.metadata.customerPin.length,restrictions:[o.defaultRestriction.restriction]});for(var i=0,l=this.playlistRelativeView.getItems();i<l.length;i++){var u=l[i];if(null==u.pinRestrictions){var c=u.start,d=null===u.end?1/0:u.end;this.updateView(c,d,{pinRestrictions:r},"DefaultRestrictions")}}},e}();t.LiveMetadataPlaylistUpdater=n});e(MF);MF.LiveMetadataPlaylistUpdater;var IF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("LiveMetadataRequestScheduler"),n=function(){function e(e,t,n,r,i){var o=this;this.timer=A.timer,this.scheduleUpdateIntervalId=null,this.scheduleRequestCancel=null,this.onEnterView=function(){o.scheduleUpdateIntervalId=o.timer.setInterval(o.refreshSchedule,36e5)},this.refreshSchedule=function(){null!==o.scheduleRequestCancel&&o.scheduleRequestCancel();var e=Fe.CancelToken.source(),t=e.token,n=e.cancel;o.scheduleRequestCancel=n,o.prsClient.send(o.liveMetadataRequestBuilder.build("ImmediateConsumption"),t).then(function(e){return e.response()}).then(function(e){t.throwIfRequested(),a.info("LiveMetadata response:",e),null==e.liveSchedule&&o.reportResourceFailure(e,"LiveSchedule"),null==e.linearRestrictions&&o.reportResourceFailure(e,"LinearRestrictions"),o.liveMetadataPlaylistUpdater.updateLiveMetadata(e.liveSchedule,e.linearRestrictions)}).catch(function(e){e instanceof Fe.CancelError||(a.error("LiveMetadata request failed",e),MT.metrics.putMetric("ServiceRequest.PRS.LiveMetadataRequest.Error"),o.mediaEventController.reportError(!1,e,"Service","Error"))})},this.prsClient=e,this.liveMetadataRequestBuilder=t,this.view=n,this.liveMetadataPlaylistUpdater=r,this.mediaEventController=i}return e.prototype.initialize=function(){this.view.on("EnterView",this.onEnterView)},e.prototype.terminate=function(){this.view.off("EnterView",this.onEnterView),null!==this.scheduleUpdateIntervalId&&(this.timer.clearInterval(this.scheduleUpdateIntervalId),this.scheduleUpdateIntervalId=null),null!==this.scheduleRequestCancel&&(this.scheduleRequestCancel(),this.scheduleRequestCancel=null)},e.prototype.reportResourceFailure=function(e,t){var n,r=e.errorsByResource;n=null!=r&&null!=r[t]?r[t]:new Error(t+" request error without errorsByResource"),a.error("Resource request failure",n),MT.metrics.putMetric("ServiceRequest.PRS."+t+".Error"),this.mediaEventController.reportError(!1,n,"Service","Error")},e}();t.LiveMetadataRequestScheduler=n});e(IF);IF.LiveMetadataRequestScheduler;var EF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=Qp.createCDPResponseProcessor(function(e,t,n,r){var i=xt.nestedValue(e,"sections.bottom.collections.collectionList.0.items.itemList.0"),o=xt.nestedValue(e,"sections.bottom.collections.collectionList.0.autoplayConfig");if(null!=o&&null!=i){var a={autoplayEnabled:!0===o.autoplayEnabled,numTitlesToAutoplay:o.numTitlesToAutoplay,preferredImageName:o.autoplayCardPreferredImage,showAutoplayCard:!0===o.showAutoplayCard,titleId:i.titleId},s=i.metadata;null!=s&&(a.recommendationStrategy=xt.withDefault(F.find(Object.keys(s),function(e){return 0===e.indexOf("source.")}),void 0),a.inSameSeries="source.OtherEpisodes"===a.recommendationStrategy),t(a)}else t(null)}),r=function(){function e(e){this.serviceClient=e.createServiceClient("/cdp/discovery/GetSections",{firmware:"1"},n,"getsections")}return e.prototype.send=function(e,t){var n={accept:"application/json"};xt.sanitize(n,!0);var r={method:"GET",timeoutMs:4e3,headers:n,queryParams:{decorationScheme:"none",pageType:"player",sectionTypes:"bottom",version:"default",format:"json",pageId:e}};return this.serviceClient.send(r,t,"CRITICAL")},e}();t.GetSectionsClient=r});e(EF);EF.GetSectionsClient;var _F=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GetSectionsClient=EF.GetSectionsClient});e(_F);_F.GetSectionsClient;var xF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.transform=function(e){return{autoplayEnabled:e.autoplayEnabled,showAutoplayCard:e.showAutoplayCard,autoplayCardPreferredImage:e.preferredImageName,inSameSeries:e.inSameSeries}},e}();t.AutoplaySettingsTransformer=n});e(xF);xF.AutoplaySettingsTransformer;var kF=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("NextTitlePlaylistListener"),n=function(){function e(e,t,n,r,i,o,a,s,l){var u=this;this.autoplaySettingsTransformer=new xF.AutoplaySettingsTransformer,this.onEnterView=function(){var e=Fe.CancelToken.source(),a=e.token,t=e.cancel;u.getSectionsCancel=t,u.getSectionsClient.send(u.titleId,a).then(function(e){return e.on("latency",function(e){MT.metrics.putMetric("ServiceRequest.GetSections.RequestLatencyTime",e,"ms")}),e.response()}).catch(function(e){return a.throwIfRequested(),c.error("GetSections request failed",e),MT.metrics.putMetric("ServiceRequest.GetSections.Error"),u.mediaEventController.reportError(!1,e,"Service","Error"),null}).then(function(e){if(a.throwIfRequested(),null===e)return Fe.Promise.resolve();e.autoplayEnabled||u.playlistAutoplayBarrier.addTitleBarrier(u.titleId,e.titleId),u.playlistAutoplayBarrier.setMaxContinuousPlayTitleTransitions(e.numTitlesToAutoplay);var t=u.autoplaySettingsTransformer.transform(e),n=Fe.CancelToken.source(),r=n.token,i=n.cancel;u.prsManager.getInFlightRequests()[e.titleId]={videoMaterialType:"Feature",cancel:i};var o={titleId:e.titleId,videoMaterialType:"Feature",playbackToken:u.playbackToken,position:0,optOutAdTracking:u.optOutAdTracking};return u.prsManager.resolve(o,!1,u.userWatchSessionId,r,t)}).catch(function(e){e instanceof Fe.CancelError||(c.error("Next episode PRS request failed",e),MT.metrics.putMetric("NextEpisodeRequest.Error"),u.mediaEventController.reportError(!1,e,"Service","Error"))})},this.titleId=e,this.getSectionsClient=new _F.GetSectionsClient(t),this.prsManager=n,this.titleView=r,this.userWatchSessionId=i,this.playlistAutoplayBarrier=o,this.mediaEventController=a,this.playbackToken=s,this.optOutAdTracking=l}return e.prototype.initialize=function(){this.titleView.on("EnterView",this.onEnterView)},e.prototype.terminate=function(){this.titleView.off("EnterView",this.onEnterView),null!=this.getSectionsCancel&&this.getSectionsCancel()},e}();t.NextTitlePlaylistListener=n});e(kF);kF.NextTitlePlaylistListener;var RF,AF,OF,LF,FF,DF,NF,UF,BF,VF,jF,XF,zF,qF,WF,HF,GF,KF,QF,YF,JF,$F=V&&V.__extends||(RF=function(e,t){return(RF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}RF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ZF=rk.LeafElementHandler,eD=rk.Utilities,tD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $F(t,e),t.prototype.getElementName=function(){return"AdSystem"},t.prototype.onElementStart=function(e,t){var n=e();this.adSystem={name:"unknown"},eD.optionallyCopyString(n,this.adSystem,"version")},t.prototype.onText=function(e){this.adSystem.name=e().trim()},t.prototype.onElementEnd=function(){return this.adSystem},t}(ZF),nD=V&&V.__extends||(AF=function(e,t){return(AF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}AF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),rD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return nD(t,e),t.prototype.getElementName=function(){return"UniversalAdId"},t.prototype.onElementStart=function(e,t){var n=e();this.universalAdId={idValue:n.idValue,idRegistry:n.idRegistry}},t.prototype.onElementEnd=function(){return this.universalAdId},t}(rk.LeafElementHandler),iD=V&&V.__extends||(OF=function(e,t){return(OF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}OF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),oD=rk.LeafElementHandler,aD=rk.Utilities,sD=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCData=function(e){t.mediaFile.uri=e().trim()},t}return iD(t,e),t.prototype.getElementName=function(){return"MediaFile"},t.prototype.onElementStart=function(e,t){var n=e();this.mediaFile={delivery:n.delivery,type:n.type};for(var r=0,i=["height","width","bitrate","minBitrate","maxBitrate"];r<i.length;r++){var o=i[r];aD.optionallyCopyNumber(n,this.mediaFile,o)}for(var a=0,s=["scalable","maintainAspectRatio"];a<s.length;a++){var l=s[a];aD.optionallyCopyBoolean(n,this.mediaFile,l)}for(var u=0,c=["codec","id"];u<c.length;u++){var d=c[u];aD.optionallyCopyString(n,this.mediaFile,d)}},t.prototype.onElementEnd=function(){return this.mediaFile},t.prototype.onText=function(e){this.mediaFile.uri=e().trim()},t}(oD),lD=V&&V.__extends||(LF=function(e,t){return(LF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}LF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),uD=function(e){function t(){return e.call(this,[new sD])||this}return lD(t,e),t.prototype.getElementName=function(){return"MediaFiles"},t.prototype.onElementStart=function(e,t){this.mediaFiles={files:[]}},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"MediaFile":this.mediaFiles.files.push(e.onElementEnd())}},t.prototype.onElementEnd=function(){return this.mediaFiles},t}(rk.ParentElementHandler),cD=V&&V.__extends||(FF=function(e,t){return(FF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}FF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),dD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cD(t,e),t.prototype.getElementName=function(){return"Tracking"},t.prototype.onElementStart=function(e,t){var n=e();this.trackingEvent={name:n.event}},t.prototype.onElementEnd=function(){return this.trackingEvent},t.prototype.onText=function(e){this.trackingEvent.uri=e().trim()},t}(rk.LeafElementHandler),pD=V&&V.__extends||(DF=function(e,t){return(DF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}DF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),fD=function(e){function t(){return e.call(this,[new dD])||this}return pD(t,e),t.prototype.getElementName=function(){return"TrackingEvents"},t.prototype.onElementStart=function(e,t){this.trackingEvents=[]},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"Tracking":this.trackingEvents.push(e.onElementEnd())}},t.prototype.onElementEnd=function(){return this.trackingEvents},t}(rk.ParentElementHandler),hD=V&&V.__extends||(NF=function(e,t){return(NF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}NF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),mD=rk.LeafElementHandler,yD=rk.Utilities,gD=function(n){function e(e){var t=n.call(this)||this;return t.elementName=e,t}return hD(e,n),e.prototype.getElementName=function(){return this.elementName},e.prototype.onElementStart=function(e,t){var n=e();this.genericClickResult={},yD.optionallyCopyString(n,this.genericClickResult,"id")},e.prototype.onElementEnd=function(){return this.genericClickResult},e.prototype.onText=function(e){this.genericClickResult.uri=e().trim()},e}(mD),vD=V&&V.__extends||(UF=function(e,t){return(UF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}UF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),SD=function(e){function t(){return e.call(this,[new gD("ClickThrough"),new gD("ClickTracking"),new gD("CustomClick")])||this}return vD(t,e),t.prototype.getElementName=function(){return"VideoClicks"},t.prototype.onElementStart=function(e,t){this.videoClicks={clickTracking:[],customClicks:[]}},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"ClickThrough":this.videoClicks.clickThrough=e.onElementEnd();break;case"ClickTracking":this.videoClicks.clickTracking.push(e.onElementEnd());break;case"CustomClick":this.videoClicks.customClicks.push(e.onElementEnd())}},t.prototype.onElementEnd=function(){return this.videoClicks},t}(rk.ParentElementHandler),bD=V&&V.__extends||(BF=function(e,t){return(BF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}BF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),TD=rk.ParentElementHandler,PD=rk.TextOnlyLeafHandler,wD=rk.Utilities,CD=function(e){function t(){return e.call(this,[new PD("Duration"),new uD,new fD,new SD])||this}return bD(t,e),t.prototype.getElementName=function(){return"Linear"},t.prototype.onElementStart=function(e,t){var n=e();this.linear={},wD.optionallyCopyString(n,this.linear,"skipoffset")},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"Duration":this.linear.duration=e.onElementEnd();break;case"MediaFiles":this.linear.mediaFiles=e.onElementEnd();break;case"TrackingEvents":this.linear.trackingEvents=e.onElementEnd();break;case"VideoClicks":this.linear.videoClicks=e.onElementEnd()}},t.prototype.onElementEnd=function(){return this.linear},t}(TD),MD=V&&V.__extends||(VF=function(e,t){return(VF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}VF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ID=rk.ParentElementHandler,ED=rk.Utilities,_D=function(e){function t(){return e.call(this,[new rD,new CD])||this}return MD(t,e),t.prototype.getElementName=function(){return"Creative"},t.prototype.onElementStart=function(e,t){var n=e();this.creative={},ED.optionallyCopyNumber(n,this.creative,"sequence"),ED.optionallyCopyString(n,this.creative,"adId"),ED.optionallyCopyString(n,this.creative,"apiFramework"),ED.optionallyCopyString(n,this.creative,"id"),n.AdID&&(this.creative.adId=n.AdID)},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"UniversalAdId":this.creative.universalAdId=e.onElementEnd();break;case"Linear":this.creative.linear=e.onElementEnd()}},t.prototype.onElementEnd=function(){return this.creative},t}(ID),xD=V&&V.__extends||(jF=function(e,t){return(jF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}jF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),kD=rk.LeafElementHandler,RD=rk.Utilities,AD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return xD(t,e),t.prototype.getElementName=function(){return"SkipOffset"},t.prototype.onElementStart=function(e,t){var n=e();this.skipOffset={},RD.optionallyCopyBoolean(n,this.skipOffset,"showTimer")},t.prototype.onText=function(e){this.skipOffset.offset=e().trim()},t.prototype.onElementEnd=function(){return this.skipOffset},t}(kD),OD=V&&V.__extends||(XF=function(e,t){return(XF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}XF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),LD=rk.ParentElementHandler,FD=rk.TextOnlyLeafHandler,DD=function(e){function t(){return e.call(this,[new AD,new FD("MinAdLength")])||this}return OD(t,e),t.prototype.getElementName=function(){return"Extension"},t.prototype.onElementStart=function(e,t){this.skippableExtension={type:"skippable"}},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"MinAdLength":this.skippableExtension.minAdLength=e.onElementEnd();break;case"SkipOffset":this.skippableExtension.skipOffset=e.onElementEnd()}},t.prototype.onElementEnd=function(){return this.skippableExtension},t}(LD),ND=V&&V.__extends||(zF=function(e,t){return(zF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}zF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),UD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ND(t,e),t.prototype.getElementName=function(){return"Extension"},t.prototype.onElementStart=function(e,t){this.watchlist={type:"watchlist"}},t.prototype.onElementEnd=function(){return this.watchlist},t}(rk.LeafElementHandler),BD=V&&V.__extends||(qF=function(e,t){return(qF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}qF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),VD=function(t){function e(){var e=t.call(this,[])||this;return e.extensionMap={skippable:new DD,watchlist:new UD},e}return BD(e,t),e.prototype.getElementName=function(){return"Extension"},e.prototype.onElementStart=function(e,t){var n=e().type;this.currentHandler=this.extensionMap[n],this.currentHandler&&this.currentHandler.onElementStart(e,t)},e.prototype.onChildElementStart=function(e,t){return this.currentHandler?this.currentHandler.onChildElementStart(e,t):null},e.prototype.onChildElementEnd=function(e){this.currentHandler&&this.currentHandler.onChildElementEnd(e)},e.prototype.onElementEnd=function(){return this.currentHandler?this.currentHandler.onElementEnd():null},e}(rk.ParentElementHandler),jD=V&&V.__extends||(WF=function(e,t){return(WF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}WF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),XD=rk.LeafElementHandler,zD=rk.Utilities,qD=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return jD(t,e),t.prototype.getElementName=function(){return"Impression"},t.prototype.onElementStart=function(e,t){var n=e();this.impression={},zD.optionallyCopyString(n,this.impression,"id")},t.prototype.onText=function(e){this.impression.uri=e().trim()},t.prototype.onElementEnd=function(){return this.impression},t}(XD),WD=V&&V.__extends||(HF=function(e,t){return(HF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}HF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),HD=rk.ParentElementHandler,GD=rk.TextOnlyLeafHandler,KD=function(e){function t(){return e.call(this,[new tD,new _D,new VD,new qD,new GD("AdTitle"),new GD("Error")])||this}return WD(t,e),t.prototype.getElementName=function(){return"InLine"},t.prototype.onElementStart=function(e,t){this.inLine={creatives:[],extensions:[],impressions:[]}},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"AdSystem":this.inLine.adSystem=e.onElementEnd();break;case"AdTitle":this.inLine.adTitle=e.onElementEnd();break;case"Error":this.inLine.errorUri=e.onElementEnd();break;case"Impression":this.inLine.impressions.push(e.onElementEnd());break;case"Creative":this.inLine.creatives.push(e.onElementEnd());break;case"Extension":var t=e.onElementEnd();null!==t&&this.inLine.extensions.push(t)}},t.prototype.onElementEnd=function(){return this.inLine},t}(HD),QD=V&&V.__extends||(GF=function(e,t){return(GF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}GF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),YD=rk.ParentElementHandler,JD=rk.Utilities,$D=function(e){function t(){return e.call(this,[new KD])||this}return QD(t,e),t.prototype.getElementName=function(){return"Ad"},t.prototype.onElementStart=function(e,t){var n=e();this.ad={id:n.id},JD.optionallyCopyNumber(n,this.ad,"sequence"),JD.optionallyCopyBoolean(n,this.ad,"conditionalAd")},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"InLine":this.ad.inLine=e.onElementEnd()}},t.prototype.onElementEnd=function(){return this.ad},t}(YD),ZD=V&&V.__extends||(KF=function(e,t){return(KF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}KF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),eN=rk.ParentElementHandler,tN=rk.TextOnlyLeafHandler,nN=function(e){function t(){return e.call(this,[new tN("Error"),new $D])||this}return ZD(t,e),t.prototype.getElementName=function(){return"VAST"},t.prototype.onElementStart=function(e,t){this.adData={ads:[]}},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"Error":this.adData.errorUri=e.onElementEnd();break;case"Ad":this.adData.ads.push(e.onElementEnd())}},t.prototype.onElementEnd=function(){return this.adData},t}(eN),rN=V&&V.__extends||(QF=function(e,t){return(QF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}QF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),iN=rk.ParentElementHandler,oN=rk.Utilities,aN=function(e){function t(){return e.call(this,[new nN])||this}return rN(t,e),t.prototype.getElementName=function(){return"vmap:AdSource"},t.prototype.onElementStart=function(e,t){var n=e();this.adSource={id:n.id,allowMultipleAds:"false"!==n.allowMultipleAds,followRedirects:"false"!==n.followRedirects},oN.optionallyCopyString(n,this.adSource,"adTagUri")},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"VAST":this.adSource.vastAdData=e.onElementEnd()}},t.prototype.onElementEnd=function(){return this.adSource},t}(iN),sN=V&&V.__extends||(YF=function(e,t){return(YF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}YF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),lN=function(e){function t(){return e.call(this,[new aN])||this}return sN(t,e),t.prototype.getElementName=function(){return"vmap:AdBreak"},t.prototype.onElementStart=function(e,t){var n=e();this.adBreak={timeOffset:n.timeOffset,breakId:n.breakId,breakType:n.breakType,adSources:[],trackingEvents:[]}},t.prototype.onChildElementEnd=function(e){switch(e.getElementName()){case"vmap:AdSource":this.adBreak.adSources.push(e.onElementEnd())}},t.prototype.onElementEnd=function(){return this.adBreak},t}(rk.ParentElementHandler),uN=V&&V.__extends||(JF=function(e,t){return(JF=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}JF(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),cN=function(e){function t(){return e.call(this,[new lN])||this}return uN(t,e),t.prototype.getElementName=function(){return"vmap:VMAP"},t.prototype.onElementStart=function(e,t){this.adBreaks=[]},t.prototype.onChildElementEnd=function(e){"vmap:AdBreak"===e.getElementName()&&this.adBreaks.push(e.onElementEnd())},t.prototype.onElementEnd=function(){return this.adBreaks},t}(rk.ParentElementHandler),dN=rk.Parser,pN=function(){function e(){this.xmlParser=new dN,this.vmapHandler=new cN}return e.prototype.parse=function(e){return this.xmlParser.parse(this.vmapHandler,e)},e}(),fN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.VmapParser=pN});e(fN);fN.VmapParser;var hN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=S.of("XpAdPlaylistInterceptor"),u=M.get("XpAdPlaylistInterceptor"),n=function(){function e(e,t,n,r,i){var o=this;this.viewedAdBreaks={},this.savedSeekPosition=null,this.onEnterItem=function(e){var t=e.item;F.contains(o.titleIdView.getItems(),t)&&null!=t.breakId&&(o.viewedAdBreaks[t.breakId]=!0)},this.onEnterTitleView=function(){"playing"===o.mpPlayer.playbackState&&null!=o.prerollAdBreakInfo?(o.viewedAdBreaks[o.prerollAdBreakInfo.breakId]=!0,o.removeTitleViewListeners()):o.mpPlayer.on("playbackStateChange",o.onPlaybackStateChange)},this.onExitTitleView=function(){o.mpPlayer.off("playbackStateChange",o.onPlaybackStateChange)},this.onPlaybackStateChange=function(e){o.titleIdView.isActive()&&"playing"===e.playbackState&&null!=o.prerollAdBreakInfo&&(o.viewedAdBreaks[o.prerollAdBreakInfo.breakId]=!0,o.removeTitleViewListeners(),o.mpPlayer.off("playbackStateChange",o.onPlaybackStateChange))},this.playlistEngine=e,this.titleIdView=t,this.mainContentView=n,this.mpPlayer=r,s(i,"adBreakInfos").not.empty();var a=i.sort(function(e,t){return e.timestamp-t.timestamp});this.adBreakInfos=a.filter(function(e){return 0!==e.timestamp}),0===a[0].timestamp&&(this.prerollAdBreakInfo=a[0])}return e.prototype.initialize=function(){this.playlistEngine.on("EnterItem",this.onEnterItem),this.titleIdView.on("EnterView",this.onEnterTitleView),this.titleIdView.on("ExitView",this.onExitTitleView)},e.prototype.terminate=function(){this.playlistEngine.off("EnterItem",this.onEnterItem),this.removeTitleViewListeners(),this.mpPlayer.off("playbackStateChange",this.onPlaybackStateChange)},e.prototype.getNewSeekTarget=function(e,t){var n=this.playlistEngine.getItems()[t];if(!F.contains(this.titleIdView.getItems(),n))return{newPosition:e,newItemIndex:t};if(this.titleIdView.isActive()&&!this.mainContentView.isActive())return u.warn("Allowing seek while in ad content"),{newPosition:e,newItemIndex:t};if(!F.contains(this.mainContentView.getItems(),n))return u.warn("Allowing explicit seek into an ad item"),{newPosition:e,newItemIndex:t};var r=this.playlistEngine.getCurrentItem(),i=this.mainContentView.getItems()[0];if(n===i&&e===i.start&&null!=this.prerollAdBreakInfo&&!this.viewedAdBreaks[this.prerollAdBreakInfo.breakId]){var o=this.prerollAdBreakInfo.view.getItems()[0];return u.info("Intercepting seek to "+e+" to go to preroll"),{newPosition:0,newItemIndex:this.playlistEngine.getItems().indexOf(o)}}for(var a=this.adBreakInfos.length-1;0<=a;a--){var s=this.adBreakInfos[a];if(!(s.timestamp>e)){if(null===r)return{newPosition:e,newItemIndex:t};if(F.contains(this.getChapterItemsOfAdBreak(s.breakId),r))return{newPosition:e,newItemIndex:t};if(this.viewedAdBreaks[s.breakId])return{newPosition:e,newItemIndex:t};var l=s.view.getItems()[0];return this.savedSeekPosition=e,u.info("Intercepting seek to "+e+" to go to midroll: "+s.breakId),{newPosition:l.start,newItemIndex:this.playlistEngine.getItems().indexOf(l)}}}return{newPosition:e,newItemIndex:t}},e.prototype.getNewPositionTarget=function(e){if(!this.titleIdView.isActive())return e;var t=this.playlistEngine.getCurrentItem();if(null===t)return u.warn("Position update without a current item"),e;var n=this.playlistEngine.getItems(),r=this.playlistEngine.getCurrentItemIndex(),i=n[r+1],o=null===t.end?1/0:t.end;if(this.mainContentView.isActive()){if(o<=e&&null!=i&&"Ad"===i.type&&this.viewedAdBreaks[i.breakId])for(var a=r+2;null!=n[a];){var s=n[a];if("Ad"!==s.type)return u.info("Already played proceeding ad break. Seeking to next chapter"),{newPosition:s.start,newItemIndex:a};a++}}else{if(null===this.savedSeekPosition)return e;if(o<=e&&null!=i&&"Main"===i.type){var l=this.savedSeekPosition;return this.savedSeekPosition=null,u.info("Ad break complete. Seeking to previously requested seek position "+l),{newPosition:l,newItemIndex:r+1}}}return e},e.prototype.removeTitleViewListeners=function(){this.titleIdView.off("EnterView",this.onEnterTitleView),this.titleIdView.off("ExitView",this.onExitTitleView)},e.prototype.getChapterItemsOfAdBreak=function(t){var e=F.find(this.adBreakInfos,function(e){return e.breakId===t});if(null==e)return[];var n=this.playlistEngine.getItems(),r=F.last(e.view.getItems());if(null==r)return[];for(var i=F.findIndex(n,r)+1,o=[];null!=n[i]&&"Main"===n[i].type;)o.push(n[i]),i++;return o},e}();t.XpAdPlaylistInterceptor=n});e(hN);hN.XpAdPlaylistInterceptor;var mN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("TrackingEventReporter"),n=function(){function e(e,t,n,r){var i=this;this.playedToTime=0,this.playlistItem=null,this.onEnterView=function(){i.view.isActive()&&(i.playlistItem=i.view.playlistEngine.getCurrentItem(),i.playedToTime=0,i.mpPlayer.on("contentStateChange",i.onContentStateChange),"playing"!==i.mpPlayer.playbackState?i.mpPlayer.on("playbackStateChange",i.waitForPlayingState):i.mpPlayer.on("playbackStateChange",i.onPlaybackStateChange),i.timeDataManager.on("TimeDataChange",i.onTimeDataChange))},this.onExitView=function(){i.mpPlayer.off("contentStateChange",i.onContentStateChange),i.mpPlayer.off("playbackStateChange",i.onPlaybackStateChange),i.mpPlayer.off("playbackStateChange",i.waitForPlayingState),i.timeDataManager.off("TimeDataChange",i.onTimeDataChange),i.playlistItem=null},this.onContentStateChange=function(e){"error"===e&&i.reportEventByName("error")},this.waitForPlayingState=function(e){"playing"===e.playbackState&&(i.mpPlayer.off("playbackStateChange",i.waitForPlayingState),i.mpPlayer.on("playbackStateChange",i.onPlaybackStateChange))},this.onPlaybackStateChange=function(e){"paused"===e.playbackState?i.reportEventByName("pause"):"playing"===e.playbackState&&i.reportEventByName("resume")},this.onTimeDataChange=function(e){e.currentPosition>i.playedToTime&&(i.playedToTime=e.currentPosition),i.reportEventsForNewTimeData(e)},this.view=e,this.mpPlayer=t,this.timeDataManager=n,this.adEventReporter=r,e.on("EnterView",this.onEnterView),e.on("ExitView",this.onExitView)}return e.prototype.reportSkipOrComplete=function(){if(null!==this.playlistItem&&null!==this.playlistItem.start&&null!==this.playlistItem.end){var e=this.playlistItem.end-this.playlistItem.start;Rp.isApprxEqual(this.playedToTime,e,500)?this.reportEventByName("complete"):this.reportEventByName("skip")}},e.prototype.reportClose=function(){if(null!==this.playlistItem&&null!=this.playlistItem.trackingEvents){var e=this.playlistItem.trackingEvents.some(function(e){return"closeLinear"===e.name});this.reportEventByName(e?"closeLinear":"close")}this.onExitView()},e.prototype.reportMuteOrUnmute=function(e){e?this.reportEventByName("mute"):this.reportEventByName("unmute")},e.prototype.reportEventsForNewTimeData=function(e){var t=null===this.playlistItem?null:this.playlistItem.trackingEvents,n=e.playableRanges[e.currentTimelineItemIndex];if(null!==this.playlistItem&&null!=t&&null!=n&&null!=n.start&&null!=this.playlistItem.sourceUrlStore)for(var r=e.currentPosition-n.start,i=0,o=t.filter(function(e){return!e.reported&&null!=e.position&&(r>=e.position||"complete"===e.name&&r>=e.position-500)});i<o.length;i++){var a=o[i];this.reportEvent(a,this.playlistItem.sourceUrlStore.get().urlId)}},e.prototype.reportEventByName=function(t){var e=null===this.playlistItem?null:this.playlistItem.trackingEvents;if(null!==this.playlistItem&&null!=e&&null!=this.playlistItem.sourceUrlStore)for(var n=0,r=e.filter(function(e){return e.name===t});n<r.length;n++){var i=r[n];this.reportEvent(i,this.playlistItem.sourceUrlStore.get().urlId)}},e.prototype.reportEvent=function(e,t){r.info("Reporting \""+e.name+"\" tracking event.");var n=[{url:e.uri,method:null!=e.httpMethod?e.httpMethod:"GET",data:e.data}];this.adEventReporter.send(n,{CONSUMPTIONID:t}),e.reported=!0},e}();t.TrackingEventReporter=n});e(mN);mN.TrackingEventReporter;var yN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.normalize=function(e){for(var t=[],n=0,r=0,i=e;r<i.length;r++){var o=i[r];t.push({timestampMs:o.timestampMs+n,durationMs:o.durationMs,ads:o.ads}),n+=o.durationMs}return t},e}();t.MssVmapNormalizer=n});e(yN);yN.MssVmapNormalizer;var gN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("VastVmapTransformer");var n=function(){function e(){this.calculateEventPositionMap={impression:function(e){return 0},start:function(e){return 0},firstQuartile:function(e){return e/4},midpoint:function(e){return e/2},thirdQuartile:function(e){return e/4*3},complete:function(e){return e}}}return e.prototype.transform=function(e,n){var r=this;return e.map(function(e){var t=r.adSourcesToAds(e.adSources);return{timestampMs:r.vmapTimestampMs(e.timeOffset,n),durationMs:t.reduce(function(e,t){return e+t.durationMs},0),ads:t}}).sort(function(e,t){return e.timestampMs-t.timestampMs})},e.prototype.adSourcesToAds=function(e){var t=this;return F.chain(e).map(function(e){return null==e.vastAdData?[]:t.vastAdsToSimplifiedAds(e.vastAdData.ads)}).flatten().value()},e.prototype.vastAdsToSimplifiedAds=function(e){var t=this;return F.chain(e).map(function(e){return null==e.inLine?[]:t.creativesToSimplifiedAds(e.inLine.creatives,e.inLine.impressions,e.inLine.extensions,e.inLine.adSystem,e.inLine.errorUri)}).flatten().value()},e.prototype.creativesToSimplifiedAds=function(e,p,t,f,h){var m=this;void 0===t&&(t=[]);var y=F.find(t,function(e){return"skippable"===e.type});return e.map(function(e){return e.linear}).filter(function(e){return null!=e}).map(function(e){var r=ok.extendedLimitedIso8601TimeFormatToMilliseconds(e.duration),t={durationMs:r,adSystem:f};if(null!=y&&r>=ok.extendedLimitedIso8601TimeFormatToMilliseconds(y.minAdLength)&&(t.skipOptions={skipOffsetMs:ok.extendedLimitedIso8601TimeFormatToMilliseconds(y.skipOffset.offset),showTimer:y.skipOffset.showTimer}),null!=e.videoClicks){if(null!=e.videoClicks.clickThrough){var n=xt.withDefault(e.videoClicks.clickTracking,[]);t.clickThrough={clickThroughUri:F.unescape(e.videoClicks.clickThrough.uri),clickTrackingUris:n.map(function(e){return F.unescape(e.uri)})}}if(null!=e.videoClicks.customClicks){for(var i=[],o=0,a=e.videoClicks.customClicks;o<a.length;o++){var s=a[o];i.push({id:s.id,uri:F.unescape(s.uri)})}t.customClicks=i}}F.isEmpty(e.trackingEvents)||(t.trackingEvents=e.trackingEvents.map(function(e){var t={name:e.name,uri:F.unescape(e.uri),reported:!1},n=m.calculateEventPositionMap[e.name];return null!=n&&(t.position=n(r)),t})),null!=h&&(null==t.trackingEvents&&(t.trackingEvents=[]),t.trackingEvents.push({name:"error",uri:F.unescape(h),reported:!1}));for(var l=m.calculateEventPositionMap.impression(r),u=0,c=p;u<c.length;u++){var d=c[u];null==t.trackingEvents&&(t.trackingEvents=[]),t.trackingEvents.push({name:"impression",uri:F.unescape(d.uri),reported:!1,position:l})}return t})},e.prototype.vmapTimestampMs=function(e,t){if("start"===e)return 0;if("end"===e)return t;if(-1<e.indexOf("%")||-1<e.indexOf("#"))throw new Error("Unsupported 'timeOffset' format: "+e);return ok.extendedLimitedIso8601TimeFormatToMilliseconds(e)},e}();t.VastVmapTransformer=n});e(gN);gN.VastVmapTransformer;var vN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=M.get("CuepointPlaylistPlaylistSource"),n=function(){function e(e,t,n,r,i,o,a,s,l){this.vmapParser=new fN.VmapParser,this.vastVmapTransformer=new gN.VastVmapTransformer,this.prsCuepointPlaylist=e,this.playlistEngine=t,this.playlistTrackingEventReporter=n,this.mpPlayer=r,this.timeDataManager=i,this.titleIdView=o,this.mainContentView=a,this.mediaEventReportingPlaylistListener=s,this.adEventReporter=l}return e.prototype.resolve=function(e){var t=this;if(null==this.prsCuepointPlaylist.encodedManifest)return Fe.Promise.resolve([]);var n=Date.now(),r=this.vmapParser.parse(tb.decodeString(this.prsCuepointPlaylist.encodedManifest)),i=Date.now()-n;MT.metrics.putMetric("Asset.VastVmap.ParseTime",i,"ms"),250<i&&d.warn("VAST-VMAP parse took "+i+"ms");var o=this.mainContentView.getItems(),a=o[o.length-1],s=null===a.end?1/0:a.end,l=this.vastVmapTransformer.transform(r,s);if(0===(l=yN.MssVmapNormalizer.normalize(l)).length)return Fe.Promise.resolve([]);var u=this.splitMainContent(l,s),c=new hN.XpAdPlaylistInterceptor(this.playlistEngine,this.titleIdView,this.mainContentView,this.mpPlayer,u);return c.initialize(),this.playlistEngine.registerOnPositionInterceptor(c),this.playlistEngine.registerSeekInterceptor(c),e.promise.then(function(){t.playlistEngine.deregisterOnPositionInterceptor(c),t.playlistEngine.deregisterSeekInterceptor(c),c.terminate()}),this.playlistEngine.tracePlaylistItems(pF.xpPlaylistItemFormatter),Fe.Promise.resolve(l)},e.prototype.createAdMetadata=function(e,t){var n={showCountdownTimer:xt.nestedValue(this.prsCuepointPlaylist.additionalMetadata,"showCountdownTimer",!1),adSystem:e.adSystem,adInstanceId:t};if(null!=e.skipOptions&&(n.showSkipCountdownTimer=null!=e.skipOptions.showTimer&&e.skipOptions.showTimer,n.skipOffset=e.skipOptions.skipOffsetMs),null!=e.clickThrough&&(n.clickThroughUri=e.clickThrough.clickThroughUri),null!=e.customClicks){for(var r=[],i=0,o=e.customClicks;i<o.length;i++){var a=o[i];r.push(a.id)}n.customClicks=r}return n},e.prototype.splitMainContent=function(e,t){for(var n=[],r=0,i=0,o=0,a=e;o<a.length;o++){var s=a[o],l=s.timestampMs;if(l!==r){var u=(w=r-i)+(l-r);this.mainContentView.update(r,l,{timelineStart:w,timelineEnd:u,timelineUnit:Gd.TimeUnit.ContentMillis})}for(var c=fh.UUID.v4(),d=0,p=0,f=s.ads;p<f.length;p++){var h=f[p],m=fh.UUID.v4(),y=l+d,g=y+h.durationMs,v=this.createAdMetadata(h,m),S={clickThroughTrackingUris:null!=h.clickThrough?h.clickThrough.clickTrackingUris:void 0,customClicks:h.customClicks};this.mainContentView.update(y,g,{type:"Ad",breakId:c,adInstanceId:m,timelineStart:d,timelineEnd:d+h.durationMs,timelineUnit:Gd.TimeUnit.ContentMillis,catalogMetadata:v,videoPreviewAssets:[],transitionTimecodes:void 0,staticTimedTextStreams:[],trackingEvents:h.trackingEvents,adVideoClickTrackingUris:S});var b=FA.PlaylistRelativeView.fromView(this.titleIdView,{adInstanceId:m}),T=new mN.TrackingEventReporter(b,this.mpPlayer,this.timeDataManager,this.adEventReporter);this.playlistTrackingEventReporter.registerAdTrackingEventReporter(m,T),d+=h.durationMs}r=l+d,i+=d;var P=FA.ItemRelativeView.fromView(this.titleIdView,{breakId:c});n.push({timestamp:l,breakId:c,view:P}),this.mediaEventReportingPlaylistListener.appendAdBreakView(P)}if(r!==t){var w;u=(w=r-i)+(t-r);this.mainContentView.update(r,t,{timelineStart:w,timelineEnd:u,timelineUnit:Gd.TimeUnit.ContentMillis})}return n},e}();t.CuepointPlaylistPlaylistSource=n});e(vN);vN.CuepointPlaylistPlaylistSource;var SN=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={})).StreamEnd="StreamEnd",r.OriginFailure="OriginFailure591",r.LegacyOriginFailure="LegacyOriginFailure504",r.FragmentNotReady="FragmentNotReady",r.LegacyOriginFailureOnFragment="LegacyOriginFailure5XX",r.OriginManifestFailure="OriginManifestFailure",r.MidasFailure="MidasFailure",r.CDNFailure="CDNFailure",r.TimeoutCDN="TimeoutCDN",r.CatchAll="CatchAll",t.FailoverCase=n});e(SN);SN.FailoverCase;var bN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=[{case:SN.FailoverCase.OriginFailure,maxAttempts:1,action:"origin",statusCode:{min:591,max:591}},{case:SN.FailoverCase.LegacyOriginFailure,maxAttempts:1,action:"origin",xAmzSource:["liveplaybackorigin"],statusCode:{min:504,max:504}},{case:SN.FailoverCase.FragmentNotReady,maxAttempts:100,action:"origin",xAmzSource:["liveplaybackorigin"],resourceType:c_.AcquisitionResourceType.Fragment,statusCode:{min:404,max:404}},{case:SN.FailoverCase.LegacyOriginFailureOnFragment,maxAttempts:3,action:"origin",xAmzSource:["liveplaybackorigin"],resourceType:c_.AcquisitionResourceType.Fragment,statusCode:{min:500,max:599}},{case:SN.FailoverCase.OriginManifestFailure,maxAttempts:3,action:"origin",xAmzSource:["liveplaybackorigin"],resourceType:c_.AcquisitionResourceType.Manifest,statusCode:{min:400,max:599}},{case:SN.FailoverCase.MidasFailure,maxAttempts:3,action:"manifestService",xAmzSource:["midas"],statusCode:{min:400,max:599}},{case:SN.FailoverCase.CDNFailure,maxAttempts:3,action:"cdn",xAmzSource:["cdn",null,void 0],statusCode:{min:400,max:599}},{case:SN.FailoverCase.TimeoutCDN,maxAttempts:3,action:"cdn",xAmzSource:[null,void 0]},{case:SN.FailoverCase.CatchAll,maxAttempts:3,action:"cdn",statusCode:{min:400,max:599}}];t.DefaultFailoverTable=n});e(bN);bN.DefaultFailoverTable;var TN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={case:SN.FailoverCase.StreamEnd,maxAttempts:1,action:"playerClose",xAmzSource:["liveplaybackorigin"],statusCode:{min:260,max:260}};t.StreamEndFailoverTableEntry=n});e(TN);TN.StreamEndFailoverTableEntry;var PN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("PlaybackUrlsSourceUrlStore"),d="x-amz-live-playback-stream-status",p="x-amz-source",n=function(){function e(e,t,n,r,i,o){void 0===o&&(o=new Dt.MulticastCallback),this.failoverCaseCounterMap={},this.livePlaybackStreamStatusMap={},this.playbackUrls=e,this.onStreamEnd=t,this.onStreamError=n,this.mediaEventController=r,this.mediaEventReportingPlaylistListener=i,this.currentUrlSet=this.playbackUrls.urlSets[this.playbackUrls.defaultUrlSetId],this.multicastCallback=new Dt.MulticastCallback,this.originSwitchCallback=o,this.streamEndInitiated=!1,this.diagnostics=pp.Diagnostics.create("PlaybackUrlsSourceUrlStore"),this.resetCounter()}return e.prototype.get=function(){return this.toSourceUrl(this.currentUrlSet)},e.prototype.getCurrentManifestData=function(){return this.currentUrlSet.urls.manifest},e.prototype.resourceAcquired=function(e){var t=e.headers[p];this.isMatchingEntry(TN.StreamEndFailoverTableEntry,t,e.status)&&!this.streamEndInitiated&&(this.onStreamEnd(),this.streamEndInitiated=!0),this.updateStreamStatusMap(e.headers[d]),this.resetCounter()},e.prototype.resourceAcquisitionFailed=function(e,t,n){var r,i,o=JSON.stringify(e,function(e,t){return t instanceof Error?t.toString():t},2);if(c.warn("Received error with AcquisitionErrorReason: "+o+", resourceType: "+t+", and urlId: "+n),this.currentUrlSet.urlSetId!==n)return c.warn("URL ID "+n+" of failed acquisition doesn't match current UrlSetId "+this.currentUrlSet.urlSetId+", ignore failover."),!0;"HttpError"===e.type&&(i=e.headers[p],r=e.statusCode,this.updateStreamStatusMap(e.headers[d]));for(var a="none",s=0,l=bN.DefaultFailoverTable;s<l.length;s++){var u=l[s];if(this.isMatchingEntry(u,i,r,t)){c.enabledFor(M.DEBUG)&&c.info("Resource failure for resource "+t+" with status code "+r+" and amz-source "+i+" matched rule "+JSON.stringify(u)),a=this.trySwitch(u.action,u.maxAttempts,u.case,t);break}}return"none"===a&&(a=this.tryNonContractualFailover(e,t)),"none"===a||"seamless"===a},e.prototype.onChange=function(e){this.multicastCallback.add(e)},e.prototype.offChange=function(e){this.multicastCallback.remove(e)},e.prototype.onOriginSwitch=function(e){this.originSwitchCallback.add(e)},e.prototype.offOriginSwitch=function(e){this.originSwitchCallback.remove(e)},e.prototype.tryNonContractualFailover=function(e,t){var n={fromConsumptionId:this.currentUrlSet.urlSetId};return"ParseError"===e.type?(n.ruleId="cdn",this.performAction("cdn",n,t)):"SourceError"===e.type?(this.onStreamError(e.cause),"error"):"none"},e.prototype.onSourceUrlChanged=function(){this.multicastCallback.invoke(this.toSourceUrl(this.currentUrlSet))},e.prototype.trySwitch=function(e,t,n,r){if(++this.failoverCaseCounterMap[n]>=t){c.enabledFor(M.DEBUG)&&c.info("Failure case "+n+" now has failure count "+this.failoverCaseCounterMap[n]+" and reached the max count "+t+". Attempting an "+e+" failover");var i={ruleId:n,fromConsumptionId:this.currentUrlSet.urlSetId};return this.performAction(e,i,r)}return c.enabledFor(M.DEBUG)&&c.info("Failure case "+n+" now has failure count "+this.failoverCaseCounterMap[n]+" but did not reach "+t+". No failover executed."),"none"},e.prototype.performAction=function(e,t,n){var r=this.getValidRule(this.currentUrlSet.failover,e,this.currentUrlSet.urlSetId);return"origin"===e&&null!=r&&(r=this.selectHealthyOrigin(r)),null==r?(this.mediaEventController.reportError(!1,new Ne.XpError("failover.no_url"),"Player","Error"),"none"):(t.toConsumptionId=r.urlSetId,this.switch(r.mode,this.playbackUrls.urlSets[r.urlSetId],t,n))},e.prototype.switch=function(e,t,n,r){var i=this.currentUrlSet;return this.currentUrlSet=t,this.onSourceUrlChanged(),c.warn("Switch "+e+" to "+this.currentUrlSet.urlSetId+" with manifest: "+JSON.stringify(this.currentUrlSet.urls.manifest,null,2)),this.mediaEventController.reportFailover(n),"seamless"===e?MT.metrics.putMetric("CdnSwitch."+i.urls.manifest.cdn.toLowerCase()):(MT.metrics.putMetric("OriginSwitch"),this.originSwitchCallback.invokeSync(),this.mediaEventController.reportPlayback("Stop")),this.mediaEventReportingPlaylistListener.updateConsumptionId(n.toConsumptionId),this.diagnostics.report("cdnSwitched",{mode:e,from:{urlSetId:i.urlSetId,cdn:i.urls.manifest.cdn,origin:i.urls.manifest.origin},to:{urlSetId:t.urlSetId,cdn:t.urls.manifest.cdn,origin:t.urls.manifest.origin}}),"seamless"===e?"seamless":"discontinuous"},e.prototype.resetCounter=function(){for(var e=0,t=[SN.FailoverCase.OriginFailure,SN.FailoverCase.LegacyOriginFailure,SN.FailoverCase.FragmentNotReady,SN.FailoverCase.LegacyOriginFailureOnFragment,SN.FailoverCase.OriginManifestFailure,SN.FailoverCase.MidasFailure,SN.FailoverCase.CDNFailure,SN.FailoverCase.TimeoutCDN,SN.FailoverCase.CatchAll];e<t.length;e++){var n=t[e];c.enabledFor(M.DEBUG)&&0!==this.failoverCaseCounterMap[n]&&c.info("Failure counter for case "+n+" is being reset. Previous count was "+this.failoverCaseCounterMap[n]),this.failoverCaseCounterMap[n]=0}},e.prototype.isMatchingEntry=function(e,t,n,r){return null!=t&&(t=t.toLowerCase()),(null==e.xAmzSource||F.contains(e.xAmzSource,t))&&(null==e.resourceType||e.resourceType===r)&&(null==e.statusCode||null!=n&&n>=e.statusCode.min&&n<=e.statusCode.max)},e.prototype.getStreamIdFromRule=function(e){return this.playbackUrls.urlSets[e.urlSetId].urls.manifest.livePlaybackStreamId},e.prototype.getValidRule=function(e,t,n){var r=e[t];if(null==r){if(null==(r=e.default))return c.warn("No 'default' rule exists for "+n+", urls exhausted."),null;c.warn("No rule '"+t+"' exists for "+n+". Using 'default' rule.")}return r},e.prototype.selectHealthyOrigin=function(e){for(var t=e,n=this.getStreamIdFromRule(t);null!=n&&n!==this.currentUrlSet.urls.manifest.livePlaybackStreamId;){if(null==this.livePlaybackStreamStatusMap[n]||"DOWN"!==this.livePlaybackStreamStatusMap[n].currentStatus)return t;var r=this.getValidRule(this.playbackUrls.urlSets[t.urlSetId].failover,"origin",t.urlSetId);if(null==r)return e;t=r,n=this.getStreamIdFromRule(t)}return e},e.prototype.updateStreamStatusMap=function(t){if(null!=t)try{var e=JSON.parse(t);this.livePlaybackStreamStatusMap=xt.deepExtend(this.livePlaybackStreamStatusMap,e)}catch(e){c.error("Failed to parse status: "+t)}},e.prototype.toSourceUrl=function(e){return{url:e.urls.manifest.url,urlId:e.urlSetId,headers:{},adsTrackingEndpoint:e.urls.adsTrackingEndpoint}},e}();t.PlaybackUrlsSourceUrlStore=n});e(PN);PN.PlaybackUrlsSourceUrlStore;var wN=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Initialize=0]="Initialize",r[r.OriginSwitch=1]="OriginSwitch",r[r.Ready=2]="Ready",r[r.Cancel=3]="Cancel",t.PlaylistSourceAction=n});e(wN);wN.PlaylistSourceAction;var CN=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Uninitialized=0]="Uninitialized",r[r.Initializing=1]="Initializing",r[r.Ready=2]="Ready",r[r.SwitchingOrigins=3]="SwitchingOrigins",t.PlaylistSourceState=n});e(CN);CN.PlaylistSourceState;var MN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("TrackingEventReportingServiceController"),n=function(){function e(e,t,n){var o=this;this.trackingEventsByAdId={},this.triggeredEvents={},this.supportedEvents=["impression","start","firstQuartile","midpoint","thirdQuartile","complete"],this.retryPolicy={backoffBaseMs:100,backoffMaxMs:5e3,backoffModifier:2,jitterMs:60},this.onTimeUpdate=function(e){var t=o.trackingEventsByAdId[e.periodId];if(null!=t)for(var n={CONSUMPTIONID:o.sourceUrlStore.get().urlId},r=0;r<t.length;r++){var i=1e3*t[r].startTimeInSeconds;if(Rp.isApprxEqual(i,e.manifestTimeMs,1e3))o.adEventReporter.send(t[r].beaconUrls,n,o.retryPolicy),a.info("TrackingEvent "+t[r].eventType+" triggered based on the period's positionMs (Period: "+e.periodId+")."),o.triggeredEvents[e.periodId].push(t[r]),t.splice(r,1),r-=1;else if(i>e.manifestTimeMs)return}},this.mpPlayerProxy=e,this.adEventReporter=t,this.sourceUrlStore=n,this.mpPlayerProxy.on("timeupdate",this.onTimeUpdate)}return e.prototype.destroy=function(){this.mpPlayerProxy.off("timeupdate",this.onTimeUpdate)},e.prototype.addTrackingEvents=function(e){this.trackingEventsByAdId={},this.retryPolicy={backoffBaseMs:e.retry.backoffBase,backoffMaxMs:e.retry.backoffMax,backoffModifier:e.retry.backoffModifier,jitterMs:e.retry.jitter};for(var t=0,n=e.avails;t<n.length;t++)for(var r=0,i=n[t].ads;r<i.length;r++){var o=i[r];null==this.trackingEventsByAdId[o.adId]&&(this.trackingEventsByAdId[o.adId]=[]),null==this.triggeredEvents[o.adId]&&(this.triggeredEvents[o.adId]=[]);for(var a=function(t){if(!F.contains(s.supportedEvents,t.eventType))return"continue";null==F.find(s.triggeredEvents[o.adId],function(e){return t.eventType===e.eventType&&t.startTimeInSeconds===e.startTimeInSeconds})&&s.trackingEventsByAdId[o.adId].push(t)},s=this,l=0,u=o.trackingEvents;l<u.length;l++){a(u[l])}}for(var c=0,d=Object.keys(this.trackingEventsByAdId);c<d.length;c++){var p=d[c];this.trackingEventsByAdId[p]=F.sortBy(this.trackingEventsByAdId[p],function(e){return e.startTimeInSeconds})}for(var f=0,h=Object.keys(this.triggeredEvents);f<h.length;f++){p=h[f];null==this.trackingEventsByAdId[p]&&delete this.triggeredEvents[p]}},e}();t.TrackingEventReportingServiceController=n});e(MN);MN.TrackingEventReportingServiceController;var IN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=[500,503],n=function(){function e(){this.request=null,this.retry=null,this.retryPolicy={backoffBase:100,backoffMax:5e3,backoffModifier:2,jitter:60}}return e.prototype.stop=function(){this.cancelPendingRequest()},e.prototype.send=function(i,e,t,n,r,o){var a=this;this.cancelPendingRequest();var s={consumptionId:e,optOut:t?"true":"false",advertisingId:t?"optOut":n};this.retry=(new Op.ExponentialBackoffRetry).withMaxAttempts(4).withInitialIntervalMs(this.retryPolicy.backoffBase).withExponentialFactor(this.retryPolicy.backoffModifier).withRandomizationFactor(this.retryPolicy.jitter).withMaxDelayMs(this.retryPolicy.backoffMax).onSuccess(r).onError(o).onAttempt(function(e,t,n,r){a.sendRequest(i,s,e,t,n,r)}).execute()},e.prototype.sendRequest=function(e,t,n,r,i,o){var a=this,s=new ME.URL(e);ME.URLUtils.appendQueryParams(s,t),this.request=mp.HttpRequest.get(s.toString()).timeout(5e3).accept("application/json").onError(function(e,t){null==t||F.contains(l,t.getStatus())?r(e):o(e)}).onLoad(function(e){var t;a.request=null;try{var n=e.getText();t=JSON.parse(n)}catch(e){return void o(new Error("JSON parsing error in TEVS response: "+e.toString()))}a.retryPolicy=t.retry,i(t)}).send()},e.prototype.cancelPendingRequest=function(){null!==this.retry&&(this.retry.abort(),this.retry=null),null!==this.request&&(this.request.abort(),this.request=null)},e}();t.TrackingEventVendingServiceClient=n});e(IN);IN.TrackingEventVendingServiceClient;var EN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("TrackingEventVendingServiceController"),n=function(){function e(e,t,n,r,i){void 0===i&&(i=new IN.TrackingEventVendingServiceClient);var o=this;this.timer=A.timer,this.updateIntervalMs=6e3,this.scheduledReportTimeoutId=null,this.onSourceUrlChange=function(e){o.clearReportTimeout(),o.sendRequest()},this.onSuccess=function(e){o.reportingServiceController.addTrackingEvents(e)},this.onError=function(e){a.error(e)},this.optOutAdTracking=e,this.advertisingId=t,this.sourceUrlStore=n,this.reportingServiceController=r,this.vendingServiceClient=i}return e.prototype.start=function(){this.sourceUrlStore.onChange(this.onSourceUrlChange),this.sendRequest()},e.prototype.stop=function(){this.clearReportTimeout(),this.vendingServiceClient.stop(),this.reportingServiceController.destroy(),this.sourceUrlStore.offChange(this.onSourceUrlChange)},e.prototype.startTimer=function(){var e=this;this.clearReportTimeout(),this.scheduledReportTimeoutId=this.timer.setTimeout(function(){return e.sendRequest()},this.updateIntervalMs)},e.prototype.clearReportTimeout=function(){null!=this.scheduledReportTimeoutId&&(this.timer.clearTimeout(this.scheduledReportTimeoutId),this.scheduledReportTimeoutId=null)},e.prototype.sendRequest=function(){var e=this.sourceUrlStore.get();null!=e.adsTrackingEndpoint?(this.vendingServiceClient.send(e.adsTrackingEndpoint,e.urlId,this.optOutAdTracking,this.advertisingId,this.onSuccess,this.onError),this.startTimer()):a.warn("No 'adsTrackingEndpoint' for consumption id "+e.urlId+". Won't request tracking events")},e}();t.TrackingEventVendingServiceController=n});e(EN);EN.TrackingEventVendingServiceController;var _N=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var T=M.get("PlaybackUrlsPlaylistSource"),P={dialog:"Dialog",descriptive:"Descriptive",commentary:"Commentary"},n=function(){function e(e,t,n,r,i,o,a,s,l,u,c,d,p,f,h,m){var y=this;if(this.adEventReporter=null,this.audioTrackMetadata=null,this.manifestRelativeConstrainedTimeWindow=null,this.contentSource=null,this.deferredPlaylistSourcePromise=null,this.frontBufferSetter=null,this.internalOperationCancelFunction=null,this.internalOperationCancelToken=null,this.mainContentView=null,this.mediaRepresentation=null,this.playlistItemHandler=null,this.playlistRelativeConstrainedTimeWindow=null,this.playlistSourceResolutionCancelToken=null,this.representationSource=null,this.timeWindowEnforcingSeekInterceptor=null,this.timeWindowController=null,this.trackingEventVendingServiceController=null,this.acquireManifest=function(){if(null==y.mainContentView){var e=FA.PlaylistRelativeView.fromView(y.titleIdView,{type:"Main"});y.mainContentView=e}var t=y.createRepresentationSource();y.representationSource=t,Fe.Promise.resolve().then(function(){return y.checkOperationCanceled(),y.acquireMediaRepresentation(t)}).then(function(t){return y.checkOperationCanceled(),TE.MediaCapabilitiesFilter.create(t).then(function(e){y.checkOperationCanceled(),t.applyFilters([e,new TE.AudioQualityLevelFilter]),y.mediaRepresentation=t,y.stateMachine.act(wN.PlaylistSourceAction.Ready)})}).catch(function(e){e instanceof Fe.CancelError||(y.stateMachine.act(wN.PlaylistSourceAction.Cancel),y.deferredPlaylistSourcePromise.reject(e))})},this.acquireNewManifest=function(){null!=y.internalOperationCancelFunction&&y.internalOperationCancelFunction(),null!=y.frontBufferSetter&&y.frontBufferSetter.terminate(),null!=y.contentSource&&(y.deregisterFragmentDownloadReporterCallbacks(y.contentSource),y.contentSource.off("fatalError",y.onContentSourceFatalError),y.contentSource.stop()),null!=y.mediaRepresentation&&y.mediaRepresentation.stop(),null!=y.representationSource&&(y.deregisterRepresentationSourceDownloadReporterCallbacks(y.representationSource),y.representationSource.stop());var e=Fe.CancelToken.source(),t=e.token,n=e.cancel;y.internalOperationCancelFunction=n,y.internalOperationCancelToken=t,y.acquireManifest()},this.handleInitialManifestAcquired=function(){if(null==y.mediaRepresentation)return null!=y.deferredPlaylistSourcePromise&&y.deferredPlaylistSourcePromise.reject(new Error("MediaRepresentation does not exist")),void y.stateMachine.act(wN.PlaylistSourceAction.Cancel);var e=null!==y.playbackSettings&&null!=y.playbackSettings.buffer.delayBehindLiveHeadSeconds?1e3*y.playbackSettings.buffer.delayBehindLiveHeadSeconds:void 0;y.manifestRelativeConstrainedTimeWindow=new hF.ConstrainedMediaRepresentationTimeWindow(y.mediaRepresentation,e);var t=null!=y.mediaRepresentation.utcMsAtZero?y.mediaRepresentation.utcMsAtZero:0;if(y.playlistRelativeConstrainedTimeWindow=new mF.TimeWindowProxy(y.manifestRelativeConstrainedTimeWindow,t),y.mediaRepresentation.start(y.manifestRelativeConstrainedTimeWindow.requestedDelayBehindLiveHeadMs),y.contentSource=y.createContentSource(y.mediaRepresentation,y.manifestRelativeConstrainedTimeWindow),y.playlistItemHandler=new fF.PlaylistItemHandler(y.contentMetadata,y.contentSource,y.mainContentView,y.mediaRepresentation,y.createLiveEventTimelineMetadata(),y.manifestRelativeConstrainedTimeWindow,y.playlistRelativeConstrainedTimeWindow,y.sourceUrlStore),y.playlistItemHandler.append(),y.timeWindowEnforcingSeekInterceptor=new gF.TimeWindowEnforcingSeekInterceptor(y.playlistRelativeConstrainedTimeWindow,y.playlistEngine,y.mainContentView),y.playlistEngine.registerSeekInterceptor(y.timeWindowEnforcingSeekInterceptor),y.timeWindowController=new yF.TimeWindowController(y.mediaRepresentation,y.mpPlayer,y.playlistEngine,y.mainContentView),y.timeWindowController.initialize(),null!=y.sourceUrlStore.get().adsTrackingEndpoint){var n=new MN.TrackingEventReportingServiceController(y.mpPlayer,y.adEventReporter,y.sourceUrlStore);y.trackingEventVendingServiceController=new EN.TrackingEventVendingServiceController(y.optOutAdTracking,y.advertisingId,y.sourceUrlStore,n),y.trackingEventVendingServiceController.start()}null!=y.deferredPlaylistSourcePromise&&(y.deferredPlaylistSourcePromise.resolve(),y.deferredPlaylistSourcePromise=null),y.internalOperationCancelFunction=null,y.internalOperationCancelToken=null},this.handleOriginSwitchManifestAcquired=function(){if(null==y.mediaRepresentation)return null!=y.deferredPlaylistSourcePromise&&y.deferredPlaylistSourcePromise.reject(new Error("MediaRepresentation does not exist")),void y.stateMachine.act(wN.PlaylistSourceAction.Cancel);y.mediaEventController.updateUtcMsAtZero(xt.withDefault(y.mediaRepresentation.utcMsAtZero,null));var e=null!=y.mediaRepresentation.utcMsAtZero?y.mediaRepresentation.utcMsAtZero:0;y.manifestRelativeConstrainedTimeWindow.update(y.mediaRepresentation),y.playlistRelativeConstrainedTimeWindow.updateOffset(e),y.timeWindowController.reset(y.mediaRepresentation),y.mediaRepresentation.start(y.manifestRelativeConstrainedTimeWindow.requestedDelayBehindLiveHeadMs),y.contentSource=y.createContentSource(y.mediaRepresentation,y.manifestRelativeConstrainedTimeWindow);var t=FA.PlaylistRelativeView.fromView(y.titleIdView,{}),n=t.getItems(),r=n[0].start,i=xt.withDefault(n[n.length-1].end,1/0);t.update(r,i,{contentSource:y.contentSource,mediaRepresentation:y.mediaRepresentation,contentTimeToPlaylistTimeOffsetMs:e}),y.playlistItemHandler.reset(y.contentSource,y.createLiveEventTimelineMetadata(),y.mediaRepresentation),y.globalStreamControl.onReset(),y.internalOperationCancelFunction=null,y.internalOperationCancelToken=null},this.onOriginSwitch=function(){T.info("Attempting an origin switch."),y.stateMachine.act(wN.PlaylistSourceAction.OriginSwitch)},this.reacquireManifest=function(){null!=y.internalOperationCancelFunction&&y.internalOperationCancelFunction(),null!=y.representationSource&&(y.representationSource.stop(),y.representationSource=null);var e=Fe.CancelToken.source(),t=e.token,n=e.cancel;y.internalOperationCancelFunction=n,y.internalOperationCancelToken=t,y.acquireManifest()},this.reportLicenseAcquisitionSuccess=function(e){y.mediaEventController.reportLicenseAcquisitionSuccess(F.extend(e,{consumptionId:y.sourceUrlStore.get().urlId,titleId:y.titleIdView.id.titleId}))},this.reportLicenseAcquisitionFailure=function(e){y.mediaEventController.reportLicenseAcquisitionFailure(F.extend(e,{consumptionId:y.sourceUrlStore.get().urlId,titleId:y.titleIdView.id.titleId}))},this.reportFragmentDownloadSuccess=function(e){y.mediaEventController.reportFragmentAcquisitionSuccess(F.extend(e,{consumptionId:e.urlId,titleId:y.titleIdView.id.titleId}))},this.reportFragmentDownloadFailure=function(e){if(null!=e.acquisitionError&&"ParseError"===e.acquisitionError.reason.type){var t=e.acquisitionError.reason.cause;y.mediaEventController.reportError(!1,t,"Player","FragmentParse")}else y.mediaEventController.reportFragmentAcquisitionFailure(F.extend(e,{consumptionId:e.urlId,titleId:y.titleIdView.id.titleId}))},this.shutdownSource=function(){y.deregisterLicenseAcquisitionReporterCallbacks(y.licenseAcquirer),y.deregisterOriginSwitchCallbacks(y.sourceUrlStore),null!==y.deferredPlaylistSourcePromise&&y.deferredPlaylistSourcePromise.reject(new Fe.CancelError),null!=y.internalOperationCancelFunction&&y.internalOperationCancelFunction(),null!=y.trackingEventVendingServiceController&&y.trackingEventVendingServiceController.stop(),null!=y.timeWindowController&&y.timeWindowController.terminate(),null!=y.timeWindowEnforcingSeekInterceptor&&y.playlistEngine.deregisterSeekInterceptor(y.timeWindowEnforcingSeekInterceptor),null!=y.playlistItemHandler&&y.playlistItemHandler.stop(),null!=y.frontBufferSetter&&y.frontBufferSetter.terminate(),null!=y.contentSource&&(y.deregisterFragmentDownloadReporterCallbacks(y.contentSource),y.contentSource.off("fatalError",y.onContentSourceFatalError),y.contentSource.stop()),null!=y.mediaRepresentation&&y.mediaRepresentation.stop(),null!=y.representationSource&&(y.deregisterRepresentationSourceDownloadReporterCallbacks(y.representationSource),y.representationSource.stop())},this.onContentSourceFatalError=function(e){e instanceof Ne.XpError&&"content_src.manifest.parse"===e.code?y.mediaEventController.reportError(!0,e,"Player","ManifestParse"):y.mediaEventController.reportError(!0,e,"Player","Error"),y.globalStreamControl.onStreamFatalError(e)},this.reportRepresentationSourceDownloadSuccess=function(e){var t=y.sourceUrlStore.get().urlId;null!=e.sourceUrl&&(t=e.sourceUrl.urlId),y.mediaEventController.reportManifestAcquisitionSuccess(F.extend(e,{consumptionId:t,titleId:y.titleIdView.id.titleId}))},this.reportRepresentationSourceDownloadFailure=function(e){y.mediaEventController.reportManifestAcquisitionFailure(F.extend(e,{consumptionId:e.sourceUrl.urlId,titleId:y.titleIdView.id.titleId}))},this.onStateChangeError=function(e){null!=y.deferredPlaylistSourcePromise?y.deferredPlaylistSourcePromise.reject(e):y.globalStreamControl.onStreamFatalError(e)},this.mpPlayer=t,this.playlistEngine=n,this.titleIdView=r,this.contentMetadata=i,this.playbackSettings=s,this.playerBufferManager=l,this.streamFeature=u,this.hdcpStore=c,this.mediaEventController=d,this.fallbackLanguageStreamMatchers=lF.fromPlaybackUrls(e),this.globalStreamControl=f,this.optOutAdTracking=h,this.advertisingId=m,this.licenseAcquirer=new Hk.LicenseAcquirer(o,a),this.registerLicenseAcquisitionReporterCallbacks(this.licenseAcquirer),this.sourceUrlStore=new PN.PlaybackUrlsSourceUrlStore(e,f.onStreamEnd,f.onStreamError,d,p),this.registerOriginSwitchCallbacks(this.sourceUrlStore),!F.isEmpty(e.audioTracks)){this.audioTrackMetadata={};for(var g=0,v=e.audioTracks;g<v.length;g++){var S=v[g],b=xt.withDefault(S.audioTrackId,S.languageCode+"_"+S.audioSubtype+"_"+S.index);this.audioTrackMetadata[b]={languageCode:S.languageCode,subtype:P[S.audioSubtype],label:S.displayName}}}this.stateMachine=new $k.FiniteStateMachine(CN.PlaylistSourceState.Uninitialized),this.setupStateMachine()}return e.prototype.initializeContent=function(e,t){var n=this;this.adEventReporter=t,(this.playlistSourceResolutionCancelToken=e).promise.then(function(){n.stateMachine.act(wN.PlaylistSourceAction.Cancel),n.playlistSourceResolutionCancelToken=null});var r=Fe.CancelToken.source(),i=r.token,o=r.cancel;return this.internalOperationCancelFunction=o,this.internalOperationCancelToken=i,null===this.deferredPlaylistSourcePromise&&(this.deferredPlaylistSourcePromise=new Fe.Deferred),T.info("Manifest URL:",this.sourceUrlStore.get().url),this.stateMachine.act(wN.PlaylistSourceAction.Initialize),this.deferredPlaylistSourcePromise.promise.then(function(){return n.mainContentView}).catch(function(e){if(e instanceof Fe.CancelError)throw e;throw T.error(e),n.mediaEventController.reportError(!1,e,"Player","Unknown"),e})},e.prototype.acquireMediaRepresentation=function(e){e.prepare(this.sourceUrlStore,1e4);var t=e.mediaRepresentation;return!0===t.valid?t.contents:t.refresh()},e.prototype.checkOperationCanceled=function(){null!=this.internalOperationCancelToken&&this.internalOperationCancelToken.throwIfRequested(),null!=this.playlistSourceResolutionCancelToken&&this.playlistSourceResolutionCancelToken.requested&&(this.stateMachine.act(wN.PlaylistSourceAction.Cancel),this.playlistSourceResolutionCancelToken.throwIfRequested())},e.prototype.createContentSource=function(e,t){for(var r=this.licenseAcquirer,n=new sF.FragmentContentSource(e,function(e,t,n){return r.acquireLicense(e,t,n)},this.playerBufferManager,this.fallbackLanguageStreamMatchers,this.sourceUrlStore,this.hdcpStore,t,xt.withDefault(this.playbackSettings,void 0),this.streamFeature.getCurrentMatchers()),i=this.streamFeature.getCurrentMaxBitrateThresholds(),o=0,a=Object.keys(i);o<a.length;o++){var s=i[d=a[o]];null!=s&&n.setMaxBitrateThreshold(d,"External",s)}for(var l=this.streamFeature.getCurrentUnsupportedCodecs(),u=0,c=Object.keys(l);u<c.length;u++){var d,p=l[d=c[u]];null!=p&&n.setUnsupportedCodecs(d,p)}return this.registerFragmentDownloadReporterCallbacks(n),n.on("fatalError",this.onContentSourceFatalError),this.frontBufferSetter=new cF.FrontBufferSetter(this.titleIdView,this.mpPlayer,n,this.playbackSettings),this.frontBufferSetter.initialize(),n},e.prototype.createRepresentationSource=function(){var e=(new dF.MediaRepresentationSourceFactory).getFromStreamingTechnology("DASH","segmentBase",this.audioTrackMetadata);return this.registerRepresentationSourceDownloadReporterCallbacks(e),e},e.prototype.registerLicenseAcquisitionReporterCallbacks=function(e){e.on("licenseAcquired",this.reportLicenseAcquisitionSuccess),e.on("licenseAcquisitionFailed",this.reportLicenseAcquisitionFailure)},e.prototype.deregisterLicenseAcquisitionReporterCallbacks=function(e){e.off("licenseAcquired",this.reportLicenseAcquisitionSuccess),e.off("licenseAcquisitionFailed",this.reportLicenseAcquisitionFailure)},e.prototype.setupStateMachine=function(){this.stateMachine.addTransition(CN.PlaylistSourceState.Uninitialized,wN.PlaylistSourceAction.Initialize,CN.PlaylistSourceState.Initializing),this.stateMachine.addTransition(CN.PlaylistSourceState.Initializing,wN.PlaylistSourceAction.Cancel,CN.PlaylistSourceState.Uninitialized),this.stateMachine.addTransition(CN.PlaylistSourceState.Initializing,wN.PlaylistSourceAction.OriginSwitch,CN.PlaylistSourceState.Initializing),this.stateMachine.addTransition(CN.PlaylistSourceState.Initializing,wN.PlaylistSourceAction.Ready,CN.PlaylistSourceState.Ready),this.stateMachine.addTransition(CN.PlaylistSourceState.Ready,wN.PlaylistSourceAction.Cancel,CN.PlaylistSourceState.Uninitialized),this.stateMachine.addTransition(CN.PlaylistSourceState.Ready,wN.PlaylistSourceAction.OriginSwitch,CN.PlaylistSourceState.SwitchingOrigins),this.stateMachine.addTransition(CN.PlaylistSourceState.SwitchingOrigins,wN.PlaylistSourceAction.Cancel,CN.PlaylistSourceState.Uninitialized),this.stateMachine.addTransition(CN.PlaylistSourceState.SwitchingOrigins,wN.PlaylistSourceAction.OriginSwitch,CN.PlaylistSourceState.SwitchingOrigins),this.stateMachine.addTransition(CN.PlaylistSourceState.SwitchingOrigins,wN.PlaylistSourceAction.Ready,CN.PlaylistSourceState.Ready),this.stateMachine.onEnterState(CN.PlaylistSourceState.Initializing,this.acquireManifest),this.stateMachine.onEnterState(CN.PlaylistSourceState.Uninitialized,this.shutdownSource),this.stateMachine.onReenterState(CN.PlaylistSourceState.Initializing,this.reacquireManifest),this.stateMachine.onReenterState(CN.PlaylistSourceState.SwitchingOrigins,this.reacquireManifest),this.stateMachine.onTransition(CN.PlaylistSourceState.Initializing,wN.PlaylistSourceAction.Ready,this.handleInitialManifestAcquired),this.stateMachine.onTransition(CN.PlaylistSourceState.Ready,wN.PlaylistSourceAction.OriginSwitch,this.acquireNewManifest),this.stateMachine.onTransition(CN.PlaylistSourceState.SwitchingOrigins,wN.PlaylistSourceAction.Ready,this.handleOriginSwitchManifestAcquired),this.stateMachine.onIllegalTransition(function(e,t,n){T.error("IllegalTransitionError from action ["+wN.PlaylistSourceAction[t]+"] while in state ["+CN.PlaylistSourceState[e]+"]")}),this.stateMachine.onUncaughtException(this.onStateChangeError)},e.prototype.registerFragmentDownloadReporterCallbacks=function(e){e.on("fragmentDownloaded",this.reportFragmentDownloadSuccess),e.on("fragmentDownloadFailed",this.reportFragmentDownloadFailure)},e.prototype.deregisterFragmentDownloadReporterCallbacks=function(e){e.off("fragmentDownloaded",this.reportFragmentDownloadSuccess),e.off("fragmentDownloadFailed",this.reportFragmentDownloadFailure)},e.prototype.registerRepresentationSourceDownloadReporterCallbacks=function(e){e.on("downloadComplete",this.reportRepresentationSourceDownloadSuccess),e.on("failure",this.reportRepresentationSourceDownloadFailure)},e.prototype.deregisterRepresentationSourceDownloadReporterCallbacks=function(e){e.off("downloadComplete",this.reportRepresentationSourceDownloadSuccess),e.off("failure",this.reportRepresentationSourceDownloadFailure)},e.prototype.registerOriginSwitchCallbacks=function(e){e.onOriginSwitch(this.onOriginSwitch)},e.prototype.deregisterOriginSwitchCallbacks=function(e){e.offOriginSwitch(this.onOriginSwitch)},e.prototype.createLiveEventTimelineMetadata=function(){var e=this.sourceUrlStore.getCurrentManifestData(),t={};return null!=e.startTime&&(t.startTimeMs=new Date(e.startTime).getTime()),null!=e.duration&&(t.durationMs=e.duration),t},e}();t.PlaybackUrlsPlaylistSource=n});e(_N);_N.PlaybackUrlsPlaylistSource;var xN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("SyeLiveEventPlaylistUpdater"),n=function(){function e(e,t,n,r){var i=this;this.updateIntervalId=null,this.onTimeWindowAvailable=function(){i.contentSource.timeWindow.offAvailable(i.onTimeWindowAvailable);var e=i.mainContentView.getItems()[0],t=i.calculateTimeline();i.updatePlaylistTimeline(e.start,t.startTimeMs,t.endTimeMs),i.hasLiveScheduleEntries()||null==i.eventTimelineMetadata.durationMs||i.startUpdater(t)},this.mainContentView=e,this.contentSource=t,this.eventTimelineMetadata=n,this.liveSchedule=r,this.playlistRelativeTimeWindow=t.timeWindow}return e.prototype.initialize=function(){this.hasLiveScheduleEntries()||this.contentSource.timeWindow.onAvailable(this.onTimeWindowAvailable)},e.prototype.uninitialize=function(){this.contentSource.timeWindow.offAvailable(this.onTimeWindowAvailable),null!==this.updateIntervalId&&(A.timer.clearInterval(this.updateIntervalId),this.updateIntervalId=null)},e.prototype.startUpdater=function(e){var t=this;null!==this.updateIntervalId&&A.timer.clearInterval(this.updateIntervalId);var n=e.startTimeMs,r=e.endTimeMs;this.updateIntervalId=A.timer.setInterval(function(){var e=t.calculateTimeline();e.startTimeMs===n&&e.endTimeMs===r||t.updatePlaylistTimeline(n,e.startTimeMs,e.endTimeMs),n=e.startTimeMs,r=e.endTimeMs},2e3)},e.prototype.updatePlaylistTimeline=function(t,e,n){try{this.mainContentView.update(t,1/0,{start:e,end:1/0,timelineStart:e,timelineEnd:n})}catch(e){r.error("Live Event playlist update failed (["+t+", Infinity]):",e)}},e.prototype.calculateTimeline=function(){var e=0,t=1/0;return this.hasLiveScheduleEntries()||null==this.eventTimelineMetadata.durationMs||(e=null!=this.eventTimelineMetadata.startTimeMs?Math.min(this.eventTimelineMetadata.startTimeMs,this.playlistRelativeTimeWindow.endMs):this.playlistRelativeTimeWindow.startMs,t=Math.max(e+this.eventTimelineMetadata.durationMs,this.playlistRelativeTimeWindow.endMs)),{startTimeMs:e,endTimeMs:t}},e.prototype.hasLiveScheduleEntries=function(){return null!=this.liveSchedule&&0<this.liveSchedule.scheduled.length},e}();t.SyeLiveEventPlaylistUpdater=n});e(xN);xN.SyeLiveEventPlaylistUpdater;var kN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("SyeUrlsSourceUrlStore"),n=function(){function t(e,t,n){this.syeUrls=e,this.mediaEventController=t,this.mediaEventReportingPlaylistListener=n,this.currentSyeCdnIndex=0,this.multicastCallback=new Dt.MulticastCallback}return t.prototype.get=function(){var e=this.syeUrls.listOfCdns[this.currentSyeCdnIndex];return t.toSourceUrl(e)},t.prototype.resourceAcquired=function(e){},t.prototype.resourceAcquisitionFailed=function(e,t,n){var r=this.get();if(r.urlId!==n)return o.warn("URL ID "+n+" of failed acquisition doesn't match current UrlSetId "+r.urlId+", ignore failover."),!0;if(this.currentSyeCdnIndex+1===this.syeUrls.listOfCdns.length)return!1;this.currentSyeCdnIndex++;var i=this.get();return o.info("Sye frontend url switch from "+r.cdn+": "+r.url+" to "+i.cdn+": "+i.url),this.mediaEventReportingPlaylistListener.updateConsumptionId(i.urlId),this.mediaEventController.reportFailover({ruleId:"default",fromConsumptionId:r.urlId,toConsumptionId:i.urlId}),this.multicastCallback.invoke(this.get()),!0},t.prototype.onChange=function(e){this.multicastCallback.add(e)},t.prototype.offChange=function(e){this.multicastCallback.remove(e)},t.toSourceUrl=function(e){return{url:e.frontendUrl,urlId:e.urlSetId,headers:{},cdn:e.cdnName,token:e.token,channelId:e.channelId}},t}();t.SyeUrlsSourceUrlStore=n});e(kN);kN.SyeUrlsSourceUrlStore;var RN=t(function(e,t){var l=V&&V.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("SyeUrlsPlaylistSource"),r=function(){function s(e,t,n,r,i,o){this.syeUrls=e,this.vcid=t,this.titleIdView=n,this.contentMetadata=r,this.mediaEventReportingPlaylistListener=o,this.syeUrlsSourceUrlStore=new kN.SyeUrlsSourceUrlStore(e,i,this.mediaEventReportingPlaylistListener)}return s.prototype.initializeContent=function(o){var a=this;return Fe.Promise.resolve().then(function(){o.throwIfRequested();var e=a.syeUrlsSourceUrlStore.get().urlId;a.mediaEventReportingPlaylistListener.updateConsumptionId(e);var t=new WO.LiveLowLatencyContentSource(a.syeUrls,a.syeUrlsSourceUrlStore,a.vcid),n=null!=a.syeUrls.maxBitrateBps&&0<a.syeUrls.maxBitrateBps?a.syeUrls.maxBitrateBps:1/0;t.setMaxBitrateThreshold("Video","ExternalNetwork",n);var r=FA.PlaylistRelativeView.fromView(a.titleIdView,{type:"Main"}),i=new xN.SyeLiveEventPlaylistUpdater(r,t,s.createLiveEventTimelineMetadata(a.syeUrls),a.contentMetadata.liveSchedule);return i.initialize(),o.promise.then(function(){i.uninitialize()}),r.appendItem(l({},a.contentMetadata,{contentSource:t,start:0,end:null,timelineStart:0,timelineEnd:null,timelineUnit:Gd.TimeUnit.EpochMillis,contentTimeToPlaylistTimeOffsetMs:0,playlistRelativeConstrainedTimeWindow:t.timeWindow,sourceUrlStore:a.syeUrlsSourceUrlStore})),r})},s.createLiveEventTimelineMetadata=function(e){var t={};return null!=e.startTime&&(t.startTimeMs=new Date(e.startTime).getTime(),isNaN(t.startTimeMs)&&n.error("Invalid startTime: '"+e.startTime+"'")),null!=e.duration&&(t.durationMs=1e3*e.duration),t},s}();t.SyeUrlsPlaylistSource=r});e(RN);RN.SyeUrlsPlaylistSource;var AN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("PrimaryContentPlaylistSource"),n=function(){function e(e,t,n,r,i,o,a,s,l,u,c,d,p,f,h,m,y,g){this.mediaEventController=d,this.playbackUrlsPlaylistSourceFactory=function(){return new _N.PlaybackUrlsPlaylistSource(e,t,n,r,i,o,a,s,l,u,c,d,p,f,m,y)},null!=g&&(this.syeUrlsPlaylistSourceFactory=function(){return new RN.SyeUrlsPlaylistSource(g,h,r,i,d,p)})}return e.prototype.initializeContent=function(e,t){var n,r=this;yO.liveLowLatencyContext.isLiveLowLatencySupported()&&null!=this.syeUrlsPlaylistSourceFactory?n=this.syeUrlsPlaylistSourceFactory().initializeContent(e):n=this.playbackUrlsPlaylistSourceFactory().initializeContent(e,t);return n.catch(function(e){if(e instanceof Fe.CancelError)throw e;throw i.error(e),r.mediaEventController.reportError(!1,e,"Player","Unknown"),e})},e}();t.PrimaryContentPlaylistSource=n});e(AN);AN.PrimaryContentPlaylistSource;var ON=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.LINEAR_RESTRICTIONS_START_TIME_MINS=-120,e.LINEAR_RESTRICTIONS_END_TIME_MINS=120,e}();t.LinearRestrictionsConfig=n});e(ON);ON.LinearRestrictionsConfig;var LN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("PlaybackSettingsTransformer"),r=function(){function e(){}return e.transform=function(e){if(null==e)return n.warn("No PlaybackSettings returned from PRS"),null;var t=null;return null!=e.playbackSettings&&(t=OL.PlaybackSettingsParser.fromEncodedString(e.playbackSettings)),null!==t?{playbackSettings:OL.PlaybackSettingsSanitizer.sanitize(t.base),id:e.settingsId}:(n.error("Failed to access PlaybackSettings object from PRS response"),null)},e}();t.PlaybackSettingsTransformer=r});e(LN);LN.PlaybackSettingsTransformer;var FN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.transform=function(e,t){if(null!=e)return{outroCreditsStart:e.outroCreditsStart,autoPlayTimer:e.autoPlayTimer,autoplaySettings:t,skipElements:e.skipElements}},e}();t.TransitionTimecodesTransformer=n});e(FN);FN.TransitionTimecodesTransformer;var DN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("TrickplayUrlTransformer"),n=function(){function e(){}return e.toVideoPreviewAssets=function(e){if(null==e)return[];for(var r=[],t=0,n=e.trickplayUrlsCdnSets;t<n.length;t++)for(var i=function(e){var t;if("480"===e.resolution)t="Low";else{if("720"!==e.resolution)return s.warn("Received unknown resolution "+e.resolution+", ignoring."),"continue";t="Medium"}var n=F.find(r,function(e){return e.quality===t});null==n?(n={urls:[e.url],quality:t,format:"BIF"},r.push(n)):n.urls.push(e.url)},o=0,a=n[t].trickplayUrlInfoList;o<a.length;o++){i(a[o])}return r},e}();t.TrickplayUrlTransformer=n});e(DN);DN.TrickplayUrlTransformer;var NN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var w=M.get("PRSResponseHandler"),a=["DASH"],i={catalog:{}},n=function(){function P(e,t,n,r,i,o,a,s,l,u,c,d,p,f,h,m,y,g,v,S){this.prsManager=t,this.serviceClientFactory=n,this.prsClient=e,this.advertisingId=v,this.playbackToken=S,this.playlistEngine=r,this.playlistAutoplayBarrier=i,this.playlistTrackingEventReporter=o,this.mpPlayer=l,this.liveScheduleConfigToken=u,this.mediaEventController=c,this.playerSessionId=a,this.playerBufferManager=s,this.streamFeature=d,this.hdcpStore=p,this.timeDataManager=h,this.timelineManager=f,this.globalStreamControl=m,this.baseBuilder=y,this.immediateConsumptionRequest=g}return P.prototype.handleResponse=function(n,e,d,r,p,f,t){var h=this,m=e.titleId,y=e.videoMaterialType,i=e.position,g=e.optOutAdTracking,v=[];f.promise.then(function(){for(var e=0,t=v;e<t.length;e++){var n=t[e];null!=n.terminate&&n.terminate(),null!=n.destroy&&n.destroy()}});var o=P.validatePRSResponse(d);if(null!=o)return this.timelineManager.appendPseudoEntry({timeUnit:Gd.TimeUnit.ContentMillis,startTime:null,endTime:null,error:o,contentId:m,groupId:m},{titleId:m,contentType:"Feature",metadata:d.catalogMetadata,videoPreviewAssets:[]}),Fe.Promise.reject(o);var a=d.playbackUrls;w.info("Default URL SET ID: ",a.defaultUrlSetId);var S=new FA.ItemRelativeView(this.playlistEngine,{titleId:m}),s=LN.PlaybackSettingsTransformer.transform(d.playbackSettings),l=null,u=null;null!==s&&(l=s.playbackSettings,u=s.id,lh.getInstance().updateConfig({maxConcurrentRequests:l.scheduler.maxConcurrentRequests}));var b=new HO.MediaEventReportingPlaylistListener(this.mediaEventController,S,u,xt.nestedValue(l,"buffer"),a.defaultUrlSetId);b.initialize(),v.push(b);var c=d.returnedTitleRendition.contentId,T=P.getContentMetadataFromPRSResponse(m,d,t);return new AN.PrimaryContentPlaylistSource(a,this.mpPlayer,this.playlistEngine,S,T,this.prsClient,this.baseBuilder,l,this.playerBufferManager,this.streamFeature,this.hdcpStore,this.mediaEventController,b,this.globalStreamControl,c,!0===g,this.advertisingId,d.syeUrlsV2).initializeContent(f,n).then(function(t){if(!r){var e=new SF.ConsumptionAllowedVerifier(h.mpPlayer,h.prsClient,h.mediaEventController,S,h.immediateConsumptionRequest,a.cacheKey,h.globalStreamControl,i,g);v.push(e)}return d.cuepointPlaylist?new vN.CuepointPlaylistPlaylistSource(d.cuepointPlaylist,h.playlistEngine,h.playlistTrackingEventReporter,h.mpPlayer,h.timeDataManager,S,t,b,n).resolve(f).then(function(e){return{mainContentView:t,adBreaks:e}}):Fe.Promise.resolve({mainContentView:t,adBreaks:[]})}).then(function(e){var t=e.mainContentView,n=e.adBreaks;f.throwIfRequested();var r=0<=m.search(/^com\.amazon\.playback\.object\./);if("Feature"===y&&!r){var i=new kF.NextTitlePlaylistListener(m,h.serviceClientFactory,h.prsManager,S,p,h.playlistAutoplayBarrier,h.mediaEventController,h.playbackToken,g);i.initialize(),v.push(i)}if("Feature"===y||"LiveStreaming"===y){var o=new gO.MainContentTimeTranslator(n),a=new QO.UpdateStreamListener(m,h.serviceClientFactory,S,t,o,h.mpPlayer,p,h.globalStreamControl.onStreamError,h.mediaEventController);if(a.initialize(),v.push(a),null!=d.returnedTitleRendition.auditPings){var s=new CF.AuditPingListener(h.playerSessionId,h.mpPlayer,d.returnedTitleRendition.auditPings,S,h.mediaEventController);s.initialize(),v.push(s)}}if("LiveStreaming"===y){var l=h.baseBuilder.clone().resource(ux.PlaybackResource.LiveSchedule(h.liveScheduleConfigToken)).resource(ux.PlaybackResource.LinearRestrictions(ON.LinearRestrictionsConfig.LINEAR_RESTRICTIONS_START_TIME_MINS,ON.LinearRestrictionsConfig.LINEAR_RESTRICTIONS_END_TIME_MINS)),u=new MF.LiveMetadataPlaylistUpdater(t);u.updateLiveMetadata(d.liveSchedule,d.linearRestrictions);var c=new IF.LiveMetadataRequestScheduler(h.prsClient,l,t,u,h.mediaEventController);c.initialize(),v.push(c),b.setPlaylistRelativeView(t)}else b.clearPlaylistRelativeView()})},P.getContentMetadataFromPRSResponse=function(e,t,n){var r=null==t.catalogMetadata?i:t.catalogMetadata;return{returnedTitleRendition:t.returnedTitleRendition,catalogMetadata:r,staticTimedTextStreams:fx.SubtitleUrlTransformer.toTimedTextStreams(e,t.subtitleUrls,t.forcedNarratives),videoPreviewAssets:DN.TrickplayUrlTransformer.toVideoPreviewAssets(t.trickplayUrls),transitionTimecodes:FN.TransitionTimecodesTransformer.transform(t.transitionTimecodes,n),xrayMetadata:t.xrayMetadata,liveSchedule:t.liveSchedule}},P.validatePRSResponse=function(e){var t=(new ux.PRSResponseValidator).validateResponse(e);return null!=t?t:null!=(t=P.validateSupportedStreamingTechnologies(e.playbackUrls))?t:null},P.validateSupportedStreamingTechnologies=function(e){var t=e.urlSets,n=t[e.defaultUrlSetId].urls.manifest.streamingTechnology;if(!F.includes(a,n))return new Error("PRS response contains unsupported "+n+" Url Sets");for(var r=0,i=Object.keys(t);r<i.length;r++){var o=t[i[r]].urls.manifest.streamingTechnology;if(o!==n)return new Error("PRS response contains "+o+" streaming technology, which is different from the default ("+n+")")}return null},P}();t.PRSResponseHandler=n});e(NN);NN.PRSResponseHandler;var UN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("OfflinePRSResponseHandler");var n=function(){function e(e,t,n,r,i,o,a,s,l,u,c,d){this.globalStreamControl=e,this.hdcpStore=t,this.mediaEventController=n,this.mpPlayer=r,this.playerBufferManager=i,this.playerSessionId=o,this.playlistAutoplayBarrier=a,this.playlistEngine=s,this.serviceClientFactory=u,this.streamFeature=c,this.timelineManager=d}return e.prototype.handleResponse=function(r,e,t,i){var o=this,a=e.titleId,s=e.videoMaterialType,l=[];r.promise.then(function(){for(var e=0,t=l;e<t.length;e++){var n=t[e];null!=n.terminate&&n.terminate(),null!=n.destroy&&n.destroy()}});var n=NN.PRSResponseHandler.validatePRSResponse(t);if(null!=n)return this.timelineManager.appendPseudoEntry({timeUnit:Gd.TimeUnit.ContentMillis,startTime:null,endTime:null,error:n,contentId:a,groupId:a},{titleId:a,contentType:"Feature",metadata:t.catalogMetadata,videoPreviewAssets:[]}),Fe.Promise.reject(n);var u=t.playbackUrls,c=NN.PRSResponseHandler.getContentMetadataFromPRSResponse(a,t),d=new FA.ItemRelativeView(this.playlistEngine,{titleId:a}),p=LN.PlaybackSettingsTransformer.transform(t.playbackSettings),f=null,h=null;null!==p&&(f=p.playbackSettings,h=p.id);var m=new HO.MediaEventReportingPlaylistListener(this.mediaEventController,d,h,null!=f?f.buffer:null,u.defaultUrlSetId);return m.initialize(),l.push(m),new vF.OfflineContentPlaylistSource(c,a+"_"+s,this.globalStreamControl,this.hdcpStore,this.mediaEventController,this.mpPlayer,f,t.playbackUrls,this.playerBufferManager,this.playlistEngine,d,this.streamFeature).initializeContent(r).then(function(e){if(r.throwIfRequested(),"Feature"===s||"LiveStreaming"===s){var t=new gO.MainContentTimeTranslator([]),n=new QO.UpdateStreamListener(a,o.serviceClientFactory,d,e,t,o.mpPlayer,i,o.globalStreamControl.onStreamError,o.mediaEventController);n.initialize(),l.push(n)}})},e}();t.OfflinePRSResponseHandler=n});e(UN);UN.OfflinePRSResponseHandler;var BN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){this.inFlightRequests={},this.prsClient=e,this.clientPrsParameters=t,this.videoQualityOverrideStorage=n}return e.prototype.resolve=function(e,i,t,o){var a=this,n=e.titleId,s=e.videoMaterialType,r=e.playbackToken,l=e.optOutAdTracking,u=new Hk.PlaybackResourceRequestBuilderFactory,c=null,d=null;return this.videoQualityOverrideStorage.getValue().then(function(e){return o.throwIfRequested(),u.createDeviceCompliantBuilder(e,o)}).then(function(e){return o.throwIfRequested(),c=e.content(n,s,"Streaming",r).userWatchSessionId(t),Hk.PlaybackUrlsOptionsFactory.create()}).then(function(e){o.throwIfRequested();var t=c.clone().resource(ux.PlaybackResource.PlaybackUrls(e)).resource(ux.PlaybackResource.CuepointPlaylist(void 0,l));d=t.clone().build("ImmediateConsumption"),t.resource(ux.PlaybackResource.CatalogMetadata(a.clientPrsParameters.titleDecorationScheme)).resource(ux.PlaybackResource.SubtitleUrls("TTMLv2")).resource(ux.PlaybackResource.ForcedNarratives()).resource(ux.PlaybackResource.TrickplayUrls()).resource(ux.PlaybackResource.TransitionTimecodes()).resource(ux.PlaybackResource.PlaybackSettings("1.0.0")),"LiveStreaming"===s&&t.resource(ux.PlaybackResource.LiveSchedule(a.clientPrsParameters.liveScheduleConfigToken)).resource(ux.PlaybackResource.LinearRestrictions(ON.LinearRestrictionsConfig.LINEAR_RESTRICTIONS_START_TIME_MINS,ON.LinearRestrictionsConfig.LINEAR_RESTRICTIONS_END_TIME_MINS)),"LiveStreaming"===s&&yO.liveLowLatencyContext.isLiveLowLatencySupported()&&t.resource(ux.PlaybackResource.SyeUrls());var n=a.clientPrsParameters.xrayConfig;null!=n&&t.resource(ux.PlaybackResource.XRayMetadata(n.token,n.playbackMode,n.deviceClass));var r=i?"ImmediateConsumption":"CacheResources";return a.prsClient.send(t.build(r),o)}).then(function(e){return e.on("latency",function(e){MT.metrics.putMetric("ServiceRequest.PRS.PrimaryResources.RequestLatencyTime",e,"ms")}),e.response()}).catch(function(e){throw MT.metrics.putMetric("ServiceRequest.PRS.PrimaryResources.Error"),e}).then(function(e){return{prsResponse:e,baseBuilder:c,immediateConsumptionRequest:d}})},e}();t.PRSResolver=n});e(BN);BN.PRSResolver;var VN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=M.get("PRSManager"),n=function(){function e(e,t,n,r,i,o,a,s,l,u,c,d,p,f,h,m){this.prsResponseHistory={},this.serviceClientFactory=e;var y,g=Yh.deviceInformation;null!=o.applicationIdentity?y=o.applicationIdentity.name:null!=g.software&&null!=g.software.nativeApplication&&(y=g.software.nativeApplication.name),null!=g.software&&null!=g.software.advertisingId&&(this.advertisingId=""!==g.software.advertisingId.trim()?g.software.advertisingId:void 0),this.prsClient=new ux.PlaybackResourceClient(e,o.clientId,y),this.playlistEngine=t,this.playlistAutoplayBarrier=n,this.playlistTrackingEventReporter=r,this.mpPlayer=i,this.clientPrsParameters=o,this.mediaEventController=a,this.playerBufferManager=s,this.streamFeature=l,this.hdcpStore=u,this.timeDataManager=d,this.timelineManager=c,this.globalStreamControl=p,this.playerSessionId=f,this.adEventReporter=m,this.prsResolver=new BN.PRSResolver(this.prsClient,this.clientPrsParameters,h)}return e.prototype.resolve=function(t,n,r,i,o){var a=this,e=t.titleId,s=t.videoMaterialType;if(null!=this.prsResponseHistory[e]){d.info("Apply existing prsResponse and prsResponseHandler for titleId: "+e);var l=this.prsResponseHistory[e].prsResponseHandler,u=this.prsResponseHistory[e].prsResponse;return l.handleResponse(this.adEventReporter,t,u,n,r,i,o)}var c=e+"_"+s;return(RI.metadataStorage.capabilities.isSupported?RI.metadataStorage.get(uR.createPlaybackResourceResponseKey(c)).then(function(e){return e}).catch(function(){return null}):Fe.Promise.resolve(null)).then(function(e){return null==e?a.requestPlaybackResources(t,n,r,i,o):a.retrieveLocalPlaybackResources(i,t,e,r)})},e.prototype.retrieveLocalPlaybackResources=function(e,t,n,r){return new UN.OfflinePRSResponseHandler(this.globalStreamControl,this.hdcpStore,this.mediaEventController,this.mpPlayer,this.playerBufferManager,this.playerSessionId,this.playlistAutoplayBarrier,this.playlistEngine,this.playlistTrackingEventReporter,this.serviceClientFactory,this.streamFeature,this.timelineManager).handleResponse(e,t,n,r)},e.prototype.requestPlaybackResources=function(n,r,i,o,a){var s=this,l=n.titleId,u=n.playbackToken;return this.prsResolver.resolve(n,r,i,o).then(function(e){o.throwIfRequested();var t=new NN.PRSResponseHandler(s.prsClient,s,s.serviceClientFactory,s.playlistEngine,s.playlistAutoplayBarrier,s.playlistTrackingEventReporter,s.playerSessionId,s.playerBufferManager,s.mpPlayer,s.clientPrsParameters.liveScheduleConfigToken,s.mediaEventController,s.streamFeature,s.hdcpStore,s.timelineManager,s.timeDataManager,s.globalStreamControl,e.baseBuilder,e.immediateConsumptionRequest,s.advertisingId,u);return t.handleResponse(s.adEventReporter,n,e.prsResponse,r,i,o,a).then(function(){null!=e.prsResponse.syeUrlsV2&&yO.liveLowLatencyContext.isLiveLowLatencySupported()&&(s.prsResponseHistory[l]={prsResponse:e.prsResponse,prsResponseHandler:t})})})},e.prototype.getInFlightRequests=function(){return this.prsResolver.inFlightRequests},e.prototype.clearHistory=function(){this.prsResponseHistory={}},e.prototype.removeSyeUrlsForTitle=function(e){null!=this.prsResponseHistory[e]&&(d.info("Remove syeUrlsV2 for titleId: "+e),this.prsResponseHistory[e].prsResponse.syeUrlsV2=void 0)},e}();t.PRSManager=n});e(VN);VN.PRSManager;var jN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("LoadMetricsCalculator"),r=function(){function e(e){var t=this;this.loadTime=null,this.loadedTime=null,this.startTime=null,this.tryLogMetrics=function(){if(null!==t.loadTime){if("ready"===t.mpPlayer.contentState&&(null===t.loadedTime&&(t.loadedTime=Date.now()-t.loadTime,n.info("Time to become Ready took "+t.loadedTime+" ms"),MT.metrics.putMetric("ReadyToWatchTime",t.loadedTime,"ms")),"playing"===t.mpPlayer.playbackState)){if(null===t.startTime)return void n.warn("Attempted to log TTFF without start time");var e=Date.now()-t.startTime;n.info("Player-calculated TTFF took "+e+" ms"),MT.metrics.putMetric("TTFF",e,"ms"),t.removeMpPlayerListeners()}}else n.warn("Attempted to log metrics without load time")},this.mpPlayer=e}return e.prototype.load=function(){null===this.loadTime&&this.mpPlayer.on("contentStateChange",this.tryLogMetrics),this.loadTime=Date.now(),MT.metrics.putMetric("LoadCalled")},e.prototype.play=function(){null===this.startTime&&(this.startTime=Date.now(),this.mpPlayer.on("playbackStateChange",this.tryLogMetrics))},e.prototype.unload=function(){this.removeMpPlayerListeners(),this.loadTime=null,this.loadedTime=null,this.startTime=null},e.prototype.removeMpPlayerListeners=function(){this.mpPlayer.off("contentStateChange",this.tryLogMetrics),this.mpPlayer.off("playbackStateChange",this.tryLogMetrics)},e}();t.LoadMetricsCalculator=r});e(jN);jN.LoadMetricsCalculator;var XN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.videoElement=e}return e.prototype.requestPictureInPicture=function(){return this.videoElement.requestPictureInPicture()},e.prototype.exitPictureInPicture=function(){return document.exitPictureInPicture()},e.prototype.isPictureInPicture=function(){return this.videoElement===document.pictureInPictureElement},e.prototype.isSupported=function(){return"pictureInPictureEnabled"in document},e.prototype.onChange=function(e){this.videoElement.addEventListener("enterpictureinpicture",e),this.videoElement.addEventListener("leavepictureinpicture",e)},e.prototype.offChange=function(e){this.videoElement.removeEventListener("enterpictureinpicture",e),this.videoElement.removeEventListener("leavepictureinpicture",e)},e}();t.W3CPictureInPictureFeature=n});e(XN);XN.W3CPictureInPictureFeature;var zN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.videoElement=e}return Object.defineProperty(e.prototype,"volume",{get:function(){return this.videoElement.volume},set:function(e){this.videoElement.volume=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this.videoElement.muted},set:function(e){this.videoElement.muted=e},enumerable:!0,configurable:!0}),e.prototype.onChange=function(e){this.videoElement.addEventListener("volumechange",e)},e.prototype.offChange=function(e){this.videoElement.removeEventListener("volumechange",e)},e}();t.W3CVolumeFeature=n});e(zN);zN.W3CVolumeFeature;var qN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=S.of("W3CVideoElementMediaPlayer"),r=M.get("W3CVideoElementMediaPlayer"),i=function(){function e(e){var t=this;this.onPlaying=function(){null!=t.deferredPlay&&(t.deferredPlay.resolve(),t.deferredPlay=null),t.off("playing",t.onPlaying)},this.videoElement=n(e,"videoElement").exists(),this.attachedMediaKeys=null,this.attachedMediaSource=null,this.volumeFeatureRef=new zN.W3CVolumeFeature(this.videoElement),this.pictureInPictureFeatureRef=new XN.W3CPictureInPictureFeature(this.videoElement),this.deferredPlay=null}return e.prototype.destroy=function(){this.mediaSource=null},Object.defineProperty(e.prototype,"textTracks",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){if(null!=this.videoElement.error){var e=this.videoElement.error,t="errorCode: "+e.code+". ";return null!=e.message&&(t+=e.message),new Ne.XpError("media.error",void 0,t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seekable",{get:function(){return this.videoElement.seekable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seeking",{get:function(){return this.videoElement.seeking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.videoElement.currentTime},set:function(e){r.info("Setting currentTime to "+e+"."),this.videoElement.currentTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.videoElement.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.videoElement.ended},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){switch(this.videoElement.readyState){case 0:return 0;case 1:case 2:return 1;case 3:case 4:return 2;default:throw new Error("Invalid readyState "+this.videoElement.readyState)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.videoElement.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mediaSource",{get:function(){return this.attachedMediaSource},set:function(e){this.setMediaSource(e)},enumerable:!0,configurable:!0}),e.prototype.setMediaSource=function(e){if(null!=this.attachedMediaSource){var t=this.videoElement.src;this.videoElement.removeAttribute("src"),this.videoElement.load(),URL.revokeObjectURL(t)}null!=(this.attachedMediaSource=e)&&(this.videoElement.src=URL.createObjectURL(e.mediaSourceW3C),this.videoElement.load())},Object.defineProperty(e.prototype,"mediaKeys",{get:function(){return this.attachedMediaKeys},enumerable:!0,configurable:!0}),e.prototype.setMediaKeys=function(e){return this.attachedMediaKeys=e,this.videoElement.setMediaKeys(null!=e?e.mediaKeysW3C:null)},e.prototype.pause=function(){null!=this.deferredPlay&&(this.off("playing",this.onPlaying),this.deferredPlay.reject(new Error("The play() request was interrupted by a call to pause().")),this.deferredPlay=null),this.videoElement.pause()},e.prototype.play=function(){var e=this.videoElement.play();return null!=e?e:(null==this.deferredPlay&&(this.deferredPlay=new Fe.Deferred,this.on("playing",this.onPlaying)),this.deferredPlay.promise)},Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.videoElement.playbackRate},set:function(e){this.videoElement.playbackRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this.videoElement.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.volumeFeatureRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pictureInPicture",{get:function(){return this.pictureInPictureFeatureRef},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){this.videoElement.addEventListener(e,t,!1)},e.prototype.off=function(e,t){this.videoElement.removeEventListener(e,t)},e.prototype.getVideoPlaybackQuality=function(){return null==this.videoElement.getVideoPlaybackQuality?null:this.videoElement.getVideoPlaybackQuality()},e.prototype.show=function(){this.videoElement.style.display=""},e.prototype.hide=function(){this.videoElement.style.display="none"},e}();t.W3CVideoElementMediaPlayer=i});e(qN);qN.W3CVideoElementMediaPlayer;var WN=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("HtmlElementMediaPlayer"),o=function(r){function e(e){var t=this;i(e,"surfaceRef").exists();var n=document.createElement("video");return e.appendChild(n),n.setAttribute("width","100%"),n.setAttribute("height","100%"),(t=r.call(this,n)||this).parentElement=e,t}return n(e,r),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.parentElement.removeChild(this.videoElement)},e}(qN.W3CVideoElementMediaPlayer);t.HtmlElementMediaPlayer=o});e(WN);WN.HtmlElementMediaPlayer;var HN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlayer=WN.HtmlElementMediaPlayer,t.W3CVideoElementMediaPlayer=qN.W3CVideoElementMediaPlayer,t.VolumeFeature=zN.W3CVolumeFeature});e(HN);HN.MediaPlayer,HN.W3CVideoElementMediaPlayer,HN.VolumeFeature;var GN=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("ChromiumVideoElementMediaPlayer"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attachedMediaSourceChromium=null,e.requiresNudgeAfterBuffer=!1,e.clearNudgeHack=function(){},e.waitingTimeoutId=null,e.bufferFlushed=function(){0!==e.readyState&&e.nudge()},e.stopWaitingTimeout=function(){null!==e.waitingTimeoutId&&(A.timer.clearTimeout(e.waitingTimeoutId),e.waitingTimeoutId=null)},e}return n(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.stopWaitingTimeout(),null!==this.attachedMediaSourceChromium&&(this.attachedMediaSourceChromium.clearBufferFlushedCallback(),this.attachedMediaSourceChromium.destroy(),this.attachedMediaSourceChromium=null)},e.prototype.setMediaSource=function(e){t.prototype.setMediaSource.call(this,e),this.stopWaitingTimeout(),this.requiresNudgeAfterBuffer=!1,this.clearNudgeHack(),null!==this.attachedMediaSourceChromium&&(this.attachedMediaSourceChromium.clearBufferFlushedCallback(),this.attachedMediaSourceChromium.destroy(),this.attachedMediaSourceChromium=null),null!==e&&(this.attachedMediaSourceChromium=e,this.attachedMediaSourceChromium.setBufferFlushedCallback(this.bufferFlushed),this.setupMediaPlayerNudging(e))},e.prototype.getVideoPlaybackQuality=function(){var e=this.videoElement;return null!=e.webkitDecodedFrameCount&&null!=e.webkitDroppedFrameCount?{creationTime:performance.now(),droppedVideoFrames:e.webkitDroppedFrameCount,totalVideoFrames:e.webkitDecodedFrameCount}:null},e.prototype.nudge=function(){i.warn("Nudging the VideoElement at "+this.videoElement.currentTime+"sec, MediaPlayer.readyState "+this.readyState+", VideoElement.readyState "+this.videoElement.readyState),this.videoElement.currentTime=this.videoElement.currentTime},e.prototype.setupMediaPlayerNudging=function(t){var n=this,r=function(){n.requiresNudgeAfterBuffer=!0,n.startWaitingTimeout()};this.on("waiting",r),this.on("canplay",this.stopWaitingTimeout);var i=function(){1===n.readyState&&n.requiresNudgeAfterBuffer&&n.hasSufficientBufferToNudge()&&(n.nudge(),n.requiresNudgeAfterBuffer=!1)},o=function(){for(var e=0;e<t.sourceBuffers.length;e++)t.sourceBuffers[e].removeEventListener("update",i),t.sourceBuffers[e].addEventListener("update",i)};t.sourceBuffers.addEventListener("addsourcebuffer",o),this.clearNudgeHack=function(){n.off("waiting",r),n.off("canplay",n.stopWaitingTimeout),t.sourceBuffers.removeEventListener("addsourcebuffer",o);for(var e=0;e<t.sourceBuffers.length;e++)t.sourceBuffers[e].removeEventListener("update",i);n.clearNudgeHack=function(){}}},e.prototype.startWaitingTimeout=function(){var e=this;this.stopWaitingTimeout(),this.waitingTimeoutId=A.timer.setTimeout(function(){e.waitingTimeoutId=null,1===e.readyState&&(e.hasSufficientBufferToNudge()?(i.warn("In waiting state for 5000ms with sufficient buffered length"),e.nudge()):e.startWaitingTimeout())},5e3)},e.prototype.hasSufficientBufferToNudge=function(e){void 0===e&&(e=.5);for(var t=0;t<this.videoElement.buffered.length;t++)if(!(this.videoElement.buffered.end(t)<this.videoElement.currentTime)){if(this.videoElement.buffered.end(t)-this.videoElement.currentTime>=e)return!0;break}return!1},e}(HN.W3CVideoElementMediaPlayer);t.ChromiumVideoElementMediaPlayer=o});e(GN);GN.ChromiumVideoElementMediaPlayer;var KN=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("MediaPlayerChromium"),o=function(r){function e(e){var t=this;i(e,"surfaceRef").exists();var n=document.createElement("video");return e.appendChild(n),n.setAttribute("width","100%"),n.setAttribute("height","100%"),(t=r.call(this,n)||this).parentElement=e,t}return n(e,r),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.parentElement.removeChild(this.videoElement)},e}(GN.ChromiumVideoElementMediaPlayer);t.MediaPlayerChromium=o});e(KN);KN.MediaPlayerChromium;var QN=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ChromiumVideoElementMediaPlayer=GN.ChromiumVideoElementMediaPlayer,t.MediaPlayer=KN.MediaPlayerChromium});e(QN);QN.ChromiumVideoElementMediaPlayer,QN.MediaPlayer;var YN=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("EdgeVideoElementMediaPlayer"),a="keystatuseschange",n=function(n){function e(e){var r=n.call(this,e)||this;return r.attachedListener=!1,r.bufferPollingIntervalId=null,r.bufferToResumeSec=.5,r.eventEmitter=new Dt.EventEmitter,r.isInternallyBuffering=!1,r.isSeeking=!1,r.lastKnownPositionSec=r.currentTime,r.positionPollingTimerId=null,r.onWaiting=function(){r.isInternallyBuffering=!0,r.stopPlaybackPositionPolling(),r.startBufferPolling()},r.onSeeked=function(){r.startBufferPolling()},r.onCanPlay=function(){r.isSeeking||(r.isInternallyBuffering=!1,r.stopBufferPolling(),r.paused||r.startPlaybackPositionPolling())},r.canAppendBuffer=function(e){null===r.initSegmentKeyId&&null!==e&&(r.initSegmentKeyId=e);var t=xt.withDefault(e,r.initSegmentKeyId);return null===t||null===r.attachedMediaKeysEdge||null===r.attachedMediaKeysEdge.session||r.isLicenseLoaded(t,r.attachedMediaKeysEdge.session)},r.onKeyStatusesChange=function(){var n=!1;r.attachedMediaKeysEdge.session.keyStatuses.forEach(function(e,t){"usable"!==e&&"output-downscaled"!==e||(n=!0)}),n&&r.attachedMediaSourceMS.onLicenseLoaded()},r.attachedMediaKeysEdge=null,r.attachedMediaSourceMS=null,(r.initSegmentKeyId=null)!=Yh.deviceInformation.mediaSource&&null!=Yh.deviceInformation.mediaSource.requestedFrontBufferLengthMs?r.maxFrontBufferLengthSec=Yh.deviceInformation.mediaSource.requestedFrontBufferLengthMs/1e3:r.maxFrontBufferLengthSec=6,r.videoElement.addEventListener("waiting",r.onWaiting),r.videoElement.addEventListener("seeked",r.onSeeked),r.videoElement.addEventListener("canplay",r.onCanPlay),r}return i(e,n),e.prototype.destroy=function(){null!=this.attachedMediaKeysEdge&&this.attachedMediaKeysEdge.setMsGraphicsTrust(null),this.stopBufferPolling(),this.stopPlaybackPositionPolling(),this.eventEmitter.removeAllListeners(),this.videoElement.removeEventListener("waiting",this.onWaiting),this.videoElement.removeEventListener("seeked",this.onSeeked),this.videoElement.removeEventListener("canplay",this.onCanPlay),this.attachedMediaKeysEdge=null,this.isSeeking=!1,n.prototype.destroy.call(this)},Object.defineProperty(e.prototype,"readyState",{get:function(){switch(this.videoElement.readyState){case 0:return 0;case 1:case 2:return 1;case 3:case 4:return this.isInternallyBuffering?1:2;default:throw new Error("Invalid readyState "+this.videoElement.readyState)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seeking",{get:function(){return this.videoElement.seeking||this.isSeeking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.videoElement.currentTime},set:function(e){0!==this.readyState&&(this.isSeeking=!0),this.videoElement.currentTime=e},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){"canplay"!==e&&"playing"!==e&&"seeked"!==e&&"waiting"!==e||this.eventEmitter.on(e,t),"seeked"!==e&&n.prototype.on.call(this,e,t)},e.prototype.off=function(e,t){"canplay"!==e&&"playing"!==e&&"seeked"!==e&&"waiting"!==e||this.eventEmitter.off(e,t),"seeked"!==e&&n.prototype.off.call(this,e,t)},e.prototype.setMediaKeys=function(e){return null==e?(null!=this.attachedMediaKeysEdge&&this.attachedMediaKeysEdge.setMsGraphicsTrust(null),this.attachedMediaKeysEdge=null):(this.attachedMediaKeysEdge=e,this.attachedMediaKeysEdge.setMsGraphicsTrust(this.videoElement.msGraphicsTrustStatus)),null!==this.attachedMediaSourceMS&&this.attachedMediaSourceMS.setKeyStatusVerifier(this.canAppendBuffer),n.prototype.setMediaKeys.call(this,e)},Object.defineProperty(e.prototype,"mediaSource",{set:function(e){null!==this.attachedMediaSourceMS&&(this.stopBufferPolling(),this.stopPlaybackPositionPolling(),this.isSeeking=!1,this.initSegmentKeyId=null,this.attachedListener=!1,this.bufferToResumeSec=.5,null!==this.attachedMediaKeysEdge&&(null!==this.attachedMediaKeysEdge.session&&this.attachedMediaKeysEdge.session.off(a,this.onKeyStatusesChange),this.attachedMediaKeysEdge.clearCurrentSession())),this.attachedMediaSourceMS=e,null!==this.attachedMediaSourceMS&&null!==this.attachedMediaKeysEdge&&this.attachedMediaSourceMS.setKeyStatusVerifier(this.canAppendBuffer),n.prototype.setMediaSource.call(this,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){if(null!=this.videoElement.error){var e=this.videoElement.error,t="errorCode: "+e.code+". ";return null!=e.msExtendedCode&&(t+="msExtendedCode: "+e.msExtendedCode+". "),null!=e.message&&(t+=e.message),new Ne.XpError("media.error",void 0,t)}},enumerable:!0,configurable:!0}),e.prototype.getVideoPlaybackQuality=function(){return document.hidden?null:this.videoElement.getVideoPlaybackQuality()},e.prototype.pause=function(){n.prototype.pause.call(this),this.stopPlaybackPositionPolling()},e.prototype.play=function(){var e=this;return n.prototype.play.call(this).then(function(){0!==e.readyState&&1!==e.readyState&&e.startPlaybackPositionPolling()})},e.prototype.startPlaybackPositionPolling=function(){var n=this;this.stopPlaybackPositionPolling(),o.info("Starting playback position polling."),this.lastKnownPositionSec=this.currentTime;var r=function(){if(n.paused||n.ended||0===n.readyState||1===n.readyState)n.lastKnownPositionSec=n.currentTime;else{var e=Math.abs(n.currentTime-n.lastKnownPositionSec),t=n.getFrontBufferLengthSec();e<.1&&t<n.maxFrontBufferLengthSec?(o.info("Starting internal rebuffer. Position moved by "+e+"sec"),n.bufferToResumeSec=Math.max(.5,n.getFrontBufferLengthSec()),n.startInternalRebuffer()):n.positionPollingTimerId=A.timer.setTimeout(r,500),n.lastKnownPositionSec=n.currentTime}};this.positionPollingTimerId=A.timer.setTimeout(r,500)},e.prototype.startInternalRebuffer=function(){this.isInternallyBuffering=!0,this.eventEmitter.emit("waiting"),this.stopPlaybackPositionPolling(),this.startBufferPolling()},e.prototype.startBufferPolling=function(){var e=this;this.stopBufferPolling(),o.info("Starting buffer polling."),this.bufferPollingIntervalId=A.timer.setInterval(function(){if(e.shouldEndBufferPolling())return e.isInternallyBuffering&&e.endInternalRebuffer(),e.isSeeking&&e.endInternalSeek(),void(e.paused||e.startPlaybackPositionPolling())},500)},e.prototype.shouldEndBufferPolling=function(){var e=this.getFrontBufferLengthSec(),t=this.currentTime+e;return!!(this.duration-t<.25||e>this.bufferToResumeSec||this.ended)},e.prototype.endInternalSeek=function(){this.isSeeking=!1,this.eventEmitter.emit("seeked"),this.stopBufferPolling()},e.prototype.stopBufferPolling=function(){null!=this.bufferPollingIntervalId&&(o.info("Stopping buffer polling."),A.timer.clearInterval(this.bufferPollingIntervalId),this.bufferPollingIntervalId=null,this.bufferToResumeSec=.5)},e.prototype.stopPlaybackPositionPolling=function(){null!==this.positionPollingTimerId&&(o.info("Stopping playback position polling."),A.timer.clearTimeout(this.positionPollingTimerId),this.positionPollingTimerId=null)},e.prototype.endInternalRebuffer=function(){o.info("Stopping internal rebuffer."),this.isInternallyBuffering=!1,this.eventEmitter.emit("canplay"),this.paused||2!==this.readyState||this.eventEmitter.emit("playing"),this.stopBufferPolling()},e.prototype.getFrontBufferLengthSec=function(){for(var e=0;e<this.buffered.length;e++){var t=this.buffered.start(e),n=this.buffered.end(e);if(t<=this.currentTime&&this.currentTime<=n)return n-this.currentTime}return 0},e.prototype.reorderKeyId=function(e){var t=new Uint8Array(e.length);t[0]=e[3],t[1]=e[2],t[2]=e[1],t[3]=e[0],t[4]=e[5],t[5]=e[4],t[6]=e[7],t[7]=e[6];for(var n=8;n<t.length;++n)t[n]=e[n];return t},e.prototype.isLicenseLoaded=function(e,t){var n=t.keyStatuses.get(this.reorderKeyId(e));return"usable"===n||"output-downscaled"===n||(this.attachedListener||(t.on(a,this.onKeyStatusesChange),this.attachedListener=!0),!1)},e}(HN.W3CVideoElementMediaPlayer);t.EdgeVideoElementMediaPlayer=n});e(YN);YN.EdgeVideoElementMediaPlayer;var JN=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("MediaPlayerEdge"),o=function(r){function e(e){var t=this;i(e,"surfaceRef").exists();var n=document.createElement("video");return e.appendChild(n),n.setAttribute("width","100%"),n.setAttribute("height","100%"),(t=r.call(this,n)||this).parentElement=e,t}return n(e,r),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.parentElement.removeChild(this.videoElement)},e}(YN.EdgeVideoElementMediaPlayer);t.MediaPlayerEdge=o});e(JN);JN.MediaPlayerEdge;var $N=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlayer=JN.MediaPlayerEdge});e($N);$N.MediaPlayer;var ZN=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=M.get("EdgeNextVideoElementMediaPlayer"),n=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.bufferMonitorIntervalId=null,e.didNudge=!1,e.checkBuffer=function(){0===e.getFrontBufferLengthSec()&&2===e.readyState?e.didNudge||(e.nudge(),e.didNudge=!0):e.didNudge=!1},e}return i(e,n),e.prototype.setMediaKeys=function(e){var t=this;return n.prototype.setMediaKeys.call(this,e).then(function(){null!==t.mediaKeys&&null!==t.mediaSource&&t.mediaSource.onMediaKeysSet()})},e.prototype.setMediaSource=function(e){n.prototype.setMediaSource.call(this,e),this.startFrontBufferMonitor(e),null!==this.mediaKeys&&null!==this.mediaSource&&this.mediaSource.onMediaKeysSet()},e.prototype.startFrontBufferMonitor=function(e){null!=this.bufferMonitorIntervalId&&A.timer.clearInterval(this.bufferMonitorIntervalId),null!=e&&(this.bufferMonitorIntervalId=A.timer.setInterval(this.checkBuffer,500))},e.prototype.getFrontBufferLengthSec=function(){for(var e=0;e<this.buffered.length;e++){var t=this.buffered.start(e),n=this.buffered.end(e);if(t<=this.currentTime&&this.currentTime<=n)return n-this.currentTime}return 0},e.prototype.nudge=function(){o.warn("Nudging the VideoElement at "+this.videoElement.currentTime+"sec, MediaPlayer.readyState "+this.readyState+", VideoElement.readyState "+this.videoElement.readyState),this.videoElement.currentTime=this.videoElement.currentTime},e}(QN.ChromiumVideoElementMediaPlayer);t.EdgeNextVideoElementMediaPlayer=n});e(ZN);ZN.EdgeNextVideoElementMediaPlayer;var eU=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(e){var t=this,n=document.createElement("video");return e.appendChild(n),n.setAttribute("width","100%"),n.setAttribute("height","100%"),(t=r.call(this,n)||this).parentElement=e,t}return n(e,r),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.parentElement.removeChild(this.videoElement)},e}(ZN.EdgeNextVideoElementMediaPlayer);t.MediaPlayerEdgeNext=i});e(eU);eU.MediaPlayerEdgeNext;var tU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlayer=eU.MediaPlayerEdgeNext});e(tU);tU.MediaPlayer;var nU=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("FirefoxVideoElementMediaPlayer"),o=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.attachedMediaSourceFirefox=null,n.waitingTimeoutId=null,n.bufferFlushed=function(){if(0!==n.readyState)if(document.hidden){var t=function(e){document.removeEventListener("visibilitychange",t),n.nudge()};document.addEventListener("visibilitychange",t)}else n.nudge()},n.startWaitingTimeout=function(){n.stopWaitingTimeout(),n.waitingTimeoutId=A.timer.setTimeout(function(){n.waitingTimeoutId=null,1===n.readyState&&(n.hasSufficientBufferToNudge()?(i.warn("In waiting state for 5000ms with sufficient buffered length"),n.nudge()):n.startWaitingTimeout())},5e3)},n.stopWaitingTimeout=function(){null!==n.waitingTimeoutId&&(A.timer.clearTimeout(n.waitingTimeoutId),n.waitingTimeoutId=null)},n}return n(e,t),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.stopWaitingTimeout(),null!==this.attachedMediaSourceFirefox&&(this.attachedMediaSourceFirefox.clearBufferFlushedCallback(),this.attachedMediaSourceFirefox=null)},e.prototype.setMediaSource=function(e){t.prototype.setMediaSource.call(this,e),this.stopWaitingTimeout(),this.off("waiting",this.startWaitingTimeout),this.off("canplay",this.stopWaitingTimeout),null!==this.attachedMediaSourceFirefox&&(this.attachedMediaSourceFirefox.clearBufferFlushedCallback(),this.attachedMediaSourceFirefox=null),null!==e&&(this.attachedMediaSourceFirefox=e,this.attachedMediaSourceFirefox.setBufferFlushedCallback(this.bufferFlushed),this.on("waiting",this.startWaitingTimeout),this.on("canplay",this.stopWaitingTimeout))},e.prototype.nudge=function(){i.warn("Nudging the VideoElement at "+this.videoElement.currentTime+"sec, MediaPlayer.readyState "+this.readyState+", VideoElement.readyState "+this.videoElement.readyState),this.videoElement.currentTime=this.videoElement.currentTime},e.prototype.hasSufficientBufferToNudge=function(e){void 0===e&&(e=.5);for(var t=0;t<this.videoElement.buffered.length;t++)if(!(this.videoElement.buffered.end(t)<this.videoElement.currentTime)){if(this.videoElement.buffered.end(t)-this.videoElement.currentTime>=e)return!0;break}return!1},e}(HN.W3CVideoElementMediaPlayer);t.FirefoxVideoElementMediaPlayer=o});e(nU);nU.FirefoxVideoElementMediaPlayer;var rU=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("MediaPlayerFirefox"),o=function(r){function e(e){var t=this;i(e,"surfaceRef").exists();var n=document.createElement("video");return e.appendChild(n),n.setAttribute("width","100%"),n.setAttribute("height","100%"),(t=r.call(this,n)||this).parentElement=e,t}return n(e,r),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.parentElement.removeChild(this.videoElement)},e}(nU.FirefoxVideoElementMediaPlayer);t.MediaPlayerFirefox=o});e(rU);rU.MediaPlayerFirefox;var iU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlayer=rU.MediaPlayerFirefox});e(iU);iU.MediaPlayer;var oU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.videoElement=e}return Object.defineProperty(e.prototype,"volume",{get:function(){return this.videoElement.volume},set:function(e){this.videoElement.volume=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this.videoElement.muted},set:function(e){this.videoElement.muted=e},enumerable:!0,configurable:!0}),e.prototype.onChange=function(e){this.videoElement.addEventListener("volumechange",e)},e.prototype.offChange=function(e){this.videoElement.removeEventListener("volumechange",e)},e}();t.IEVolumeFeature=n});e(oU);oU.IEVolumeFeature;var aU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=S.of("IEVideoElementMediaPlayer"),r=function(){function e(e){var t=this;this.attachedMediaKeys=null,this.attachedMediaSource=null,this.deferredPlay=null,this.isLoaded=!1,this.isSeeking=!1,this.onPlaying=function(){null!==t.deferredPlay&&(t.deferredPlay.resolve(),t.deferredPlay=null),t.off("playing",t.onPlaying)},this.videoElement=n(e,"videoElement").exists(),this.volumeFeatureRef=new oU.IEVolumeFeature(this.videoElement),this.seekPositionSeconds=0,this.nudgePlayheadAfterSeek=!0,this.videoElement.addEventListener("loadedmetadata",function(){t.isLoaded=!0,t.setMediaKeysDeferred(),t.currentTime=t.seekPositionSeconds})}return e.prototype.destroy=function(){null!=this.attachedMediaKeys&&this.attachedMediaKeys.setMsGraphicsTrust(null),this.attachedMediaKeys=null,this.mediaSource=null,this.isLoaded=!1,this.isSeeking=!1,A.timer.clearTimeout(this.nudgePlayheadTimer)},Object.defineProperty(e.prototype,"textTracks",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){if(null!=this.videoElement.error){var e=this.videoElement.error,t="errorCode: "+e.code+". ";return null!=e.msExtendedCode&&(t+="msExtendedCode: "+e.msExtendedCode+". "),null!=e.message&&(t+=e.message),new Ne.XpError("media.error",void 0,t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seekable",{get:function(){return this.videoElement.seekable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seeking",{get:function(){return this.videoElement.seeking||this.isSeeking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return!this.isLoaded||this.isSeeking?this.seekPositionSeconds:this.videoElement.currentTime},set:function(e){var t=this;this.seekPositionSeconds=e,this.isLoaded&&!this.isSeeking&&(this.nudgePlayheadAfterSeek?(this.isSeeking=!0,this.nudgePlayheadTimer=A.timer.setTimeout(function(){t.videoElement.currentTime=t.seekPositionSeconds,t.nudgePlayheadAfterSeek=!1,t.isSeeking=!1},100)):this.videoElement.currentTime=this.seekPositionSeconds)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.videoElement.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.videoElement.ended},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){switch(this.videoElement.readyState){case 0:return 0;case 1:case 2:return 1;case 3:case 4:return 2;default:throw new Error("Invalid readyState "+this.videoElement.readyState)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.videoElement.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mediaSource",{get:function(){return this.attachedMediaSource},set:function(e){if(null!==this.attachedMediaSource){var t=this.videoElement.src;this.videoElement.removeAttribute("src"),this.videoElement.load(),URL.revokeObjectURL(t),this.isLoaded=!1,this.nudgePlayheadAfterSeek=!0,this.seekPositionSeconds=0,null!==this.deferredPlay&&(this.deferredPlay.reject("play() interrupted because MediaSource was removed."),this.deferredPlay=null)}null!==(this.attachedMediaSource=e)&&(this.videoElement.src=URL.createObjectURL(e.mediaSourceW3C),this.videoElement.load())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mediaKeys",{get:function(){return this.attachedMediaKeys},enumerable:!0,configurable:!0}),e.prototype.setMediaKeys=function(e){null==e?(null!=this.attachedMediaKeys&&this.attachedMediaKeys.setMsGraphicsTrust(null),this.attachedMediaKeys=null):(this.attachedMediaKeys=e,this.attachedMediaKeys.setMsGraphicsTrust(this.videoElement.msGraphicsTrustStatus));try{return 1<=this.videoElement.readyState&&null!==e&&this.videoElement.msSetMediaKeys(e.mediaKeysIE),Fe.Promise.resolve()}catch(e){return Fe.Promise.reject(e)}},e.prototype.pause=function(){null!==this.deferredPlay&&(this.off("playing",this.onPlaying),this.deferredPlay.reject(new Error("The play() request was interrupted by a call to pause().")),this.deferredPlay=null),this.videoElement.pause()},e.prototype.play=function(){return null===this.deferredPlay&&(this.deferredPlay=new Fe.Deferred,this.on("playing",this.onPlaying)),this.videoElement.play(),this.deferredPlay.promise},Object.defineProperty(e.prototype,"paused",{get:function(){return this.videoElement.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.videoElement.playbackRate},set:function(e){this.videoElement.playbackRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.volumeFeatureRef},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){"encrypted"===e&&this.videoElement.addEventListener("msneedkey",t),this.videoElement.addEventListener(e,t,!1)},e.prototype.off=function(e,t){"encrypted"===e&&this.videoElement.removeEventListener("msneedkey",t),this.videoElement.removeEventListener(e,t)},e.prototype.getVideoPlaybackQuality=function(){return document.hidden?null:this.videoElement.getVideoPlaybackQuality()},e.prototype.setMediaKeysDeferred=function(){null!==this.attachedMediaKeys&&this.videoElement.msSetMediaKeys(this.attachedMediaKeys.mediaKeysIE)},e.prototype.show=function(){this.videoElement.style.display=""},e.prototype.hide=function(){this.videoElement.style.display="none"},e}();t.IEVideoElementMediaPlayer=r});e(aU);aU.IEVideoElementMediaPlayer;var sU=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=S.of("HtmlElementMediaPlayer"),o=function(r){function e(e){var t=this;i(e,"surfaceRef").exists();var n=document.createElement("video");return e.appendChild(n),n.setAttribute("width","100%"),n.setAttribute("height","100%"),(t=r.call(this,n)||this).parentElement=e,t}return n(e,r),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.parentElement.removeChild(this.videoElement)},e}(aU.IEVideoElementMediaPlayer);t.HtmlElementMediaPlayer=o});e(sU);sU.HtmlElementMediaPlayer;var lU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IEVideoElementMediaPlayer=aU.IEVideoElementMediaPlayer,t.MediaPlayer=sU.HtmlElementMediaPlayer});e(lU);lU.IEVideoElementMediaPlayer,lU.MediaPlayer;var uU=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("SafariVideoElementMediaPlayer"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),Object.defineProperty(t.prototype,"buffered",{get:function(){var t=this.videoElement.buffered;return{length:t.length,end:function(e){return t.end(e)-.1},start:function(e){return t.start(e)-.1}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.videoElement.currentTime-.1},set:function(e){i.info("Setting currentTime to "+e+"."),this.videoElement.currentTime=e+.1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"seekable",{get:function(){var t=this.videoElement.seekable;return{length:t.length,end:function(e){return t.end(e)-.1},start:function(e){return t.start(e)-.1}}},enumerable:!0,configurable:!0}),t}(HN.W3CVideoElementMediaPlayer);t.SafariVideoElementMediaPlayer=o});e(uU);uU.SafariVideoElementMediaPlayer;var cU=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(e){var t=this;if(null==e)throw new Error("surfaceRef doesn't exist");var n=document.createElement("video");return e.appendChild(n),n.setAttribute("width","100%"),n.setAttribute("height","100%"),(t=r.call(this,n)||this).parentElement=e,t}return n(e,r),e.prototype.destroy=function(){r.prototype.destroy.call(this),this.parentElement.removeChild(this.videoElement)},e}(uU.SafariVideoElementMediaPlayer);t.HtmlElementMediaPlayer=i});e(cU);cU.HtmlElementMediaPlayer;var dU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlayer=cU.HtmlElementMediaPlayer,t.SafariVideoElementMediaPlayer=uU.SafariVideoElementMediaPlayer});e(dU);dU.MediaPlayer,dU.SafariVideoElementMediaPlayer;var pU=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MediaPlayer=n;var r=Xh.getBrowser().getType();r===Xh.BrowserType.IE?t.MediaPlayer=n=lU.MediaPlayer:r===Xh.BrowserType.Edge?t.MediaPlayer=n=$N.MediaPlayer:r===Xh.BrowserType.EdgeNext?t.MediaPlayer=n=tU.MediaPlayer:r===Xh.BrowserType.Chrome||r===Xh.BrowserType.Chromium||r===Xh.BrowserType.Opera?t.MediaPlayer=n=QN.MediaPlayer:r===Xh.BrowserType.Safari?t.MediaPlayer=n=dU.MediaPlayer:r===Xh.BrowserType.Firefox||r===Xh.BrowserType.Firefox64?t.MediaPlayer=n=iU.MediaPlayer:t.MediaPlayer=n=HN.MediaPlayer});e(pU);pU.MediaPlayer;var fU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.MAX_PLAY_HEAD_GAP_ALLOWED_MS=1;t.NATIVE_TIMESTAMP_PADDING_SEC=0});e(fU);fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS,fU.NATIVE_TIMESTAMP_PADDING_SEC;var hU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.contentSource=null,this.fcsBufferInformationCalculator=null,this.streamTypes=[],this.positionMs=null,this.mediaPlayer=e,this.contentLevelAdapter=t}return e.prototype.load=function(e){this.contentSource=e,this.streamTypes=e.streamTypes,this.fcsBufferInformationCalculator=e.getBufferInformationCalculator()},e.prototype.unload=function(){this.contentSource=null,this.fcsBufferInformationCalculator=null},e.prototype.onPosition=function(e){this.positionMs=e},e.prototype.getBufferedRanges=function(e){return null===this.fcsBufferInformationCalculator?new Rp.NumberLine:this.fcsBufferInformationCalculator.getBufferedRanges(e).union(this.contentLevelAdapter.getBufferedRanges(e))},e.prototype.getAggregateBufferedRanges=function(e){void 0===e&&(e=this.streamTypes);for(var t=null,n=0,r=e;n<r.length;n++){var i=r[n];if(this.isActiveStream(i)){var o=this.getBufferedRanges(i);t=null!=t?t.intersection(o):o}}return t},e.prototype.getFrontBufferLengthMs=function(e){if(void 0===e&&(e=this.streamTypes),null===this.positionMs)return 0;var t=this.getAggregateBufferedRanges(e).find(this.positionMs,fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS);return null!=t?t.end-this.positionMs:0},e.prototype.isBufferedToEnd=function(e){if(void 0===e&&(e=this.streamTypes),null===this.fcsBufferInformationCalculator)return!1;for(var t=!0,n=1e3*this.mediaPlayer.currentTime,r=0,i=e;r<i.length;r++){var o=i[r];this.isActiveStream(o)&&(t=t&&this.fcsBufferInformationCalculator.isBufferedToEnd(n,o))}return t},e.prototype.getBufferInformation=function(){for(var e={},t=1e3*this.mediaPlayer.currentTime,n=null!=this.fcsBufferInformationCalculator?this.fcsBufferInformationCalculator.getBufferInformation(t):null,r=0,i=this.streamTypes;r<i.length;r++){var o=i[r],a=this.getBufferedRanges(o).find(t,fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS),s=null!=a?a.end:t,l=null!=a?a.start:t;e[o]={front:{startTimeMs:t,endTimeMs:s,sizeBytes:null!=n?n[o].front.sizeBytes:0},back:{startTimeMs:l,endTimeMs:t,sizeBytes:null!=n?n[o].back.sizeBytes:0}}}return e},e.prototype.isActiveStream=function(e){return null!==this.contentSource&&0<=this.contentSource.activeStreamTypes.indexOf(e)},e}();t.MpPlayerBufferInfoProvider=n});e(hU);hU.MpPlayerBufferInfoProvider;var mU=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Initialize=0]="Initialize",r[r.Initialized=1]="Initialized",r[r.CreateFragmentLoaders=2]="CreateFragmentLoaders",r[r.AttachContent=3]="AttachContent",r[r.Ready=4]="Ready",r[r.DetachContent=5]="DetachContent",r[r.Stop=6]="Stop",r[r.Uninitialize=7]="Uninitialize",r[r.Error=8]="Error",t.MSEWrapperAction=n});e(mU);mU.MSEWrapperAction;var yU=t(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n||(n={}))[r.Uninitialized=0]="Uninitialized",r[r.Initializing=1]="Initializing",r[r.Initialized=2]="Initialized",r[r.NeedsContent=3]="NeedsContent",r[r.Loading=4]="Loading",r[r.Ready=5]="Ready",r[r.Error=6]="Error",t.MSEWrapperState=n});e(yU);yU.MSEWrapperState;var gU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.buffer=e}return Object.defineProperty(e.prototype,"appendWindowEnd",{get:function(){return this.buffer.appendWindowEnd},set:function(e){this.buffer.appendWindowEnd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appendWindowStart",{get:function(){return this.buffer.appendWindowStart},set:function(e){this.buffer.appendWindowStart=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.buffer.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this.buffer.mode},set:function(e){this.buffer.mode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestampOffset",{get:function(){return this.buffer.timestampOffset},set:function(e){this.buffer.timestampOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this.buffer.updating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.buffer.audioTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.buffer.textTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoTracks",{get:function(){return this.buffer.videoTracks},enumerable:!0,configurable:!0}),e.prototype.abort=function(){this.buffer.abort()},e.prototype.appendBuffer=function(e){this.buffer.appendBuffer(e)},e.prototype.appendStream=function(e,t){this.buffer.appendStream(e,t)},e.prototype.remove=function(e,t){this.buffer.remove(e,t)},e.prototype.addEventListener=function(e,t,n){this.buffer.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this.buffer.removeEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){return this.buffer.dispatchEvent(e)},e}();t.SourceBufferW3C=n});e(gU);gU.SourceBufferW3C;var vU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.mediaSourceW3C=new MediaSource}return Object.defineProperty(e.prototype,"activeSourceBuffers",{get:function(){return this.mediaSourceW3C.activeSourceBuffers},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.mediaSourceW3C.duration},set:function(e){this.mediaSourceW3C.duration=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this.mediaSourceW3C.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sourceBuffers",{get:function(){return this.mediaSourceW3C.sourceBuffers},enumerable:!0,configurable:!0}),e.prototype.addSourceBuffer=function(e){return new gU.SourceBufferW3C(this.mediaSourceW3C.addSourceBuffer(e))},e.prototype.endOfStream=function(e){this.mediaSourceW3C.endOfStream(e)},e.prototype.removeSourceBuffer=function(e){this.mediaSourceW3C.removeSourceBuffer(e.buffer)},e.prototype.addEventListener=function(e,t,n){this.mediaSourceW3C.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this.mediaSourceW3C.removeEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){return this.mediaSourceW3C.dispatchEvent(e)},e}();t.MediaSourceW3C=n});e(vU);vU.MediaSourceW3C;var SU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSource=vU.MediaSourceW3C});e(SU);SU.MediaSource;var bU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.bufferFlushedCallback=null,this.pendingRemove=!1,this.update=function(){n.updating||"closed"===n.mediaSource.readyState||n.pendingRemove&&(n.pendingRemove=!1,0===n.buffered.length&&null!==n.bufferFlushedCallback&&n.bufferFlushedCallback())},this.buffer=e,this.mediaSource=t,this.addEventListener("update",this.update)}return e.prototype.destroy=function(){this.removeEventListener("update",this.update)},Object.defineProperty(e.prototype,"appendWindowEnd",{get:function(){return this.buffer.appendWindowEnd},set:function(e){this.buffer.appendWindowEnd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appendWindowStart",{get:function(){return this.buffer.appendWindowStart},set:function(e){this.buffer.appendWindowStart=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.buffer.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this.buffer.mode},set:function(e){this.buffer.mode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestampOffset",{get:function(){return this.buffer.timestampOffset},set:function(e){this.buffer.timestampOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this.buffer.updating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.buffer.audioTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.buffer.textTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoTracks",{get:function(){return this.buffer.videoTracks},enumerable:!0,configurable:!0}),e.prototype.abort=function(){this.buffer.abort()},e.prototype.appendBuffer=function(e){this.buffer.appendBuffer(e),this.pendingRemove=!1},e.prototype.appendStream=function(e,t){this.buffer.appendStream(e,t)},e.prototype.remove=function(e,t){this.buffer.remove(e,t),this.pendingRemove=!0},e.prototype.addEventListener=function(e,t,n){this.buffer.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this.buffer.removeEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){return this.buffer.dispatchEvent(e)},e.prototype.setBufferFlushedCallback=function(e){this.bufferFlushedCallback=e},e.prototype.clearBufferFlushedCallback=function(){this.bufferFlushedCallback=null},e}();t.SourceBufferChromium=n});e(bU);bU.SourceBufferChromium;var TU=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.bufferFlushedCallback=null,e.internalSourceBuffers=[],e.invokeBufferFlushedCallback=function(){null!=e.bufferFlushedCallback&&e.bufferFlushedCallback()},e}return n(e,r),e.prototype.destroy=function(){for(var e=0,t=this.internalSourceBuffers;e<t.length;e++){t[e].destroy()}},e.prototype.addSourceBuffer=function(e){var t=new bU.SourceBufferChromium(r.prototype.addSourceBuffer.call(this,e),this.mediaSourceW3C);return t.setBufferFlushedCallback(this.invokeBufferFlushedCallback),this.internalSourceBuffers.push(t),t},e.prototype.removeSourceBuffer=function(e){var t=e;t.clearBufferFlushedCallback(),t.destroy();var n=this.internalSourceBuffers.indexOf(t);-1!==n&&this.internalSourceBuffers.splice(n,1),r.prototype.removeSourceBuffer.call(this,t.buffer)},e.prototype.setBufferFlushedCallback=function(e){this.bufferFlushedCallback=e},e.prototype.clearBufferFlushedCallback=function(){this.bufferFlushedCallback=null},e}(SU.MediaSource);t.MediaSourceChromium=i});e(TU);TU.MediaSourceChromium;var PU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSource=TU.MediaSourceChromium});e(PU);PU.MediaSource;var wU=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var y=[0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],m=[0,0,0,28,115,98,103,112,0,0,0,0,115,101,105,103,0,0,0,1,0,0,0,0,0,1,0,1],g=[0,0,0,44,115,103,112,100,1,0,0,0,115,101,105,103,0,0,0,20,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],v=M.get("Encryptify"),S=((n={})[i_.Boxes.fourCCToNumber("soun")]=i_.Boxes.fourCCToNumber("enca"),n[i_.Boxes.fourCCToNumber("vide")]=i_.Boxes.fourCCToNumber("encv"),n),r=function(){function e(){this.bmffParser=new i_.BmffParser,this.wasLastInitFragmentEncrypted=!1}return e.prototype.encryptify=function(e){var t=AE.BinaryUtils.convertBufferSourceToUint8Array(e),n=this.bmffParser.parseFragment(t),r=i_.Boxes.find(n,i_.Boxes.ofType("moov"));if(null!=r)return this.encryptifyInitFragment(t,n,r);var i=i_.Boxes.find(n,i_.Boxes.ofType("moof"));return null==i||this.wasLastInitFragmentEncrypted?t:this.encryptifyMediaFragment(t,n,i)},e.prototype.encryptifyInitFragment=function(e,t,n){var r=i_.Boxes.find(n,i_.Boxes.ofType("trak"));if(null==r)return e;var i=i_.Boxes.find(r,i_.Boxes.ofType("mdia"));if(null==i)return e;var o=i_.Boxes.find(i,i_.Boxes.ofType("hdlr"));if(null==o)return e;var a=i_.Boxes.find(i,i_.Boxes.ofType("minf"));if(null==a)return e;var s=i_.Boxes.find(a,i_.Boxes.ofType("stbl"));if(null==s)return e;var l=i_.Boxes.find(s,i_.Boxes.ofType("stsd"));if(null==l)return e;if("encv"===l.entries[0].type||"enca"===l.entries[0].type)return this.wasLastInitFragmentEncrypted=!0,e;this.wasLastInitFragmentEncrypted=!1;var u=S[o.handlerType];if(null==u)return e;var c=new Uint8Array(y.length);c.set(y),new DataView(c.buffer,c.byteOffset,c.byteLength).setUint32(16,i_.Boxes.fourCCToNumber(l.entries[0].type));var d=t.boxes.reduce(function(e,t){return e+t.size},0),p=new Uint8Array(d+c.byteLength),f=e.slice(0,l.entries[0].absoluteStartPosition+l.entries[0].size),h=e.slice(l.entries[0].absoluteStartPosition+l.entries[0].size);p.set(f,0),p.set(c,f.byteLength),p.set(h,f.byteLength+c.byteLength);var m=new DataView(p.buffer,p.byteOffset,p.byteLength);return m.setUint32(l.entries[0].absoluteStartPosition+4,u),m.setUint32(l.entries[0].absoluteStartPosition,l.entries[0].size+c.byteLength),m.setUint32(l.absoluteStartPosition,l.size+c.byteLength),m.setUint32(s.absoluteStartPosition,s.size+c.byteLength),m.setUint32(a.absoluteStartPosition,a.size+c.byteLength),m.setUint32(i.absoluteStartPosition,i.size+c.byteLength),m.setUint32(r.absoluteStartPosition,r.size+c.byteLength),m.setUint32(n.absoluteStartPosition,n.size+c.byteLength),p},e.prototype.encryptifyMediaFragment=function(e,t,n){var r=i_.Boxes.find(n,i_.Boxes.ofType("traf"));if(null==r)return e;var i=i_.Boxes.find(r,i_.Boxes.ofType("trun"));if(null==i)return e;if(null==i.dataOffset)return v.warn("trun.dataOffset does not exist, returning original input"),e;var o=null;if(null==i_.Boxes.find(n,i_.Boxes.ofType("sbgp"))){var a=i.sampleCount;(o=new Uint8Array(m.length)).set(m),new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(20,a)}var s=null;if(null==i_.Boxes.find(n,i_.Boxes.ofType("sgpd"))&&(s=new Uint8Array(g.length)).set(g),null===o&&null===s)return e;var l=null===o?0:o.byteLength,u=l+(null===s?0:s.byteLength),c=t.boxes.reduce(function(e,t){return e+t.size},0)+u,d=new Uint8Array(c),p=e.slice(0,r.absoluteStartPosition+r.size),f=e.slice(r.absoluteStartPosition+r.size);d.set(p,0),null!==o&&d.set(o,p.byteLength),null!==s&&d.set(s,p.byteLength+l),d.set(f,p.byteLength+u);var h=new DataView(d.buffer,d.byteOffset,d.byteLength);return h.setInt32(i.absoluteStartPosition+16,i.dataOffset+u),h.setUint32(r.absoluteStartPosition,r.size+u),h.setUint32(n.absoluteStartPosition,n.size+u),d},e}();t.Encryptify=r});e(wU);wU.Encryptify;var CU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.encryptify=null,this.bufferFlushedCallback=null,this.pendingRemove=!1,this.update=function(){n.updating||"closed"===n.mediaSource.readyState||n.pendingRemove&&(n.pendingRemove=!1,0===n.buffered.length&&null!==n.bufferFlushedCallback&&n.bufferFlushedCallback())},this.buffer=e,this.mediaSource=t,this.addEventListener("update",this.update)}return e.prototype.destroy=function(){this.removeEventListener("update",this.update),this.encryptify=null},e.prototype.onMediaKeysSet=function(){null===this.encryptify&&(this.encryptify=new wU.Encryptify)},e.prototype.contentMayBeEncrypted=function(e){e?null===this.encryptify&&e&&(this.encryptify=new wU.Encryptify):this.encryptify=null},Object.defineProperty(e.prototype,"appendWindowEnd",{get:function(){return this.buffer.appendWindowEnd},set:function(e){this.buffer.appendWindowEnd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appendWindowStart",{get:function(){return this.buffer.appendWindowStart},set:function(e){this.buffer.appendWindowStart=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.buffer.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this.buffer.mode},set:function(e){this.buffer.mode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestampOffset",{get:function(){return this.buffer.timestampOffset},set:function(e){this.buffer.timestampOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this.buffer.updating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.buffer.audioTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.buffer.textTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoTracks",{get:function(){return this.buffer.videoTracks},enumerable:!0,configurable:!0}),e.prototype.abort=function(){this.buffer.abort()},e.prototype.appendBuffer=function(e){if(null!==this.encryptify){var t=this.encryptify.encryptify(e);e=AE.BinaryUtils.convertBufferSourceToUint8Array(t)}this.buffer.appendBuffer(e),this.pendingRemove=!1},e.prototype.appendStream=function(e,t){this.buffer.appendStream(e,t)},e.prototype.remove=function(e,t){this.buffer.remove(e,t),this.pendingRemove=!0},e.prototype.addEventListener=function(e,t,n){this.buffer.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this.buffer.removeEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){return this.buffer.dispatchEvent(e)},e.prototype.setBufferFlushedCallback=function(e){this.bufferFlushedCallback=e},e.prototype.clearBufferFlushedCallback=function(){this.bufferFlushedCallback=null},e}();t.SourceBufferEdgeNext=n});e(CU);CU.SourceBufferEdgeNext;var MU=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(r){function e(){var e=null!==r&&r.apply(this,arguments)||this;return e.bufferFlushedCallback=null,e.isMediaKeysSet=!1,e.internalSourceBuffers=[],e.mediaSourceConfig={},e.invokeBufferFlushedCallback=function(){null!=e.bufferFlushedCallback&&e.bufferFlushedCallback()},e}return n(e,r),e.prototype.destroy=function(){for(var e=0,t=this.internalSourceBuffers;e<t.length;e++){t[e].destroy()}},e.prototype.onMediaKeysSet=function(){this.isMediaKeysSet=!0;for(var e=0,t=this.internalSourceBuffers;e<t.length;e++){t[e].onMediaKeysSet()}},e.prototype.addSourceBuffer=function(e){var t=new CU.SourceBufferEdgeNext(r.prototype.addSourceBuffer.call(this,e),this.mediaSourceW3C);return t.setBufferFlushedCallback(this.invokeBufferFlushedCallback),this.isMediaKeysSet&&t.onMediaKeysSet(),t.contentMayBeEncrypted(this.mayBeEncrypted()),this.internalSourceBuffers.push(t),t},e.prototype.removeSourceBuffer=function(e){var t=e;t.clearBufferFlushedCallback(),t.destroy();var n=this.internalSourceBuffers.indexOf(t);-1!==n&&this.internalSourceBuffers.splice(n,1),r.prototype.removeSourceBuffer.call(this,t.buffer)},e.prototype.setBufferFlushedCallback=function(e){this.bufferFlushedCallback=e},e.prototype.clearBufferFlushedCallback=function(){this.bufferFlushedCallback=null},e.prototype.configure=function(e){this.mediaSourceConfig=e;for(var t=this.mayBeEncrypted(),n=0,r=this.internalSourceBuffers;n<r.length;n++){r[n].contentMayBeEncrypted(t)}},e.prototype.mayBeEncrypted=function(){var e=this.mediaSourceConfig.contentMayBeEncrypted;return null==e||e},e}(SU.MediaSource);t.MediaSourceEdgeNext=i});e(MU);MU.MediaSourceEdgeNext;var IU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSource=MU.MediaSourceEdgeNext});e(IU);IU.MediaSource;var EU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.bufferFlushedCallback=null,this.pendingRemove=!1,this.update=function(){n.updating||n.pendingRemove&&(n.pendingRemove=!1,0===n.buffered.length&&null!==n.bufferFlushedCallback&&n.bufferFlushedCallback())},this.buffer=e,this.bufferFlushedCallback=t,this.addEventListener("update",this.update)}return e.prototype.destroy=function(){this.removeEventListener("update",this.update),this.bufferFlushedCallback=null},Object.defineProperty(e.prototype,"appendWindowEnd",{get:function(){return this.buffer.appendWindowEnd},set:function(e){this.buffer.appendWindowEnd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appendWindowStart",{get:function(){return this.buffer.appendWindowStart},set:function(e){this.buffer.appendWindowStart=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.buffer.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this.buffer.mode},set:function(e){this.buffer.mode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestampOffset",{get:function(){return this.buffer.timestampOffset},set:function(e){this.buffer.timestampOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this.buffer.updating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.buffer.audioTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.buffer.textTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoTracks",{get:function(){return this.buffer.videoTracks},enumerable:!0,configurable:!0}),e.prototype.abort=function(){this.buffer.abort()},e.prototype.appendBuffer=function(e){this.buffer.appendBuffer(e),this.pendingRemove=!1},e.prototype.appendStream=function(e,t){this.buffer.appendStream(e,t)},e.prototype.remove=function(e,t){this.buffer.remove(e,t),this.pendingRemove=!0},e.prototype.addEventListener=function(e,t,n){this.buffer.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this.buffer.removeEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){return this.buffer.dispatchEvent(e)},e}();t.SourceBufferFirefox=n});e(EU);EU.SourceBufferFirefox;var _U=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(){var e=null!==n&&n.apply(this,arguments)||this;return e.bufferFlushedCallback=function(){},e}return i(e,n),e.prototype.addSourceBuffer=function(e){var t=this;return new EU.SourceBufferFirefox(n.prototype.addSourceBuffer.call(this,e),function(){t.bufferFlushedCallback()})},e.prototype.removeSourceBuffer=function(e){var t=e;t.destroy(),n.prototype.removeSourceBuffer.call(this,t.buffer)},e.prototype.setBufferFlushedCallback=function(e){this.bufferFlushedCallback=e},e.prototype.clearBufferFlushedCallback=function(){this.bufferFlushedCallback=function(){}},e}(SU.MediaSource);t.MediaSourceFirefox=n});e(_U);_U.MediaSourceFirefox;var xU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSource=_U.MediaSourceFirefox});e(xU);xU.MediaSource;var kU=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var g=[0,0,0,80,115,105,110,102,0,0,0,12,102,114,109,97,0,0,0,0,0,0,0,20,115,99,104,109,0,0,0,0,99,101,110,99,0,1,0,0,0,0,0,40,115,99,104,105,0,0,0,32,116,101,110,99,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],v=((n={})[i_.Boxes.fourCCToNumber("soun")]=i_.Boxes.fourCCToNumber("enca"),n[i_.Boxes.fourCCToNumber("vide")]=i_.Boxes.fourCCToNumber("encv"),n),r=function(){function e(){this.bmffParser=new i_.BmffParser}return e.prototype.encryptify=function(e){var t=AE.BinaryUtils.convertBufferSourceToUint8Array(e),n=this.bmffParser.parseFragment(t),r=i_.Boxes.find(n,i_.Boxes.ofType("moov"));if(null==r)return t;var i=i_.Boxes.find(r,i_.Boxes.ofType("trak"));if(null==i)return t;var o=i_.Boxes.find(i,i_.Boxes.ofType("mdia"));if(null==o)return t;var a=i_.Boxes.find(o,i_.Boxes.ofType("hdlr"));if(null==a)return t;var s=i_.Boxes.find(o,i_.Boxes.ofType("minf"));if(null==s)return t;var l=i_.Boxes.find(s,i_.Boxes.ofType("stbl"));if(null==l)return t;var u=i_.Boxes.find(l,i_.Boxes.ofType("stsd"));if(null==u)return t;if("encv"===u.entries[0].type||"enca"===u.entries[0].type)return t;var c=v[a.handlerType];if(null==c)return t;var d=new Uint8Array(g.length);d.set(g),new DataView(d.buffer,d.byteOffset,d.byteLength).setUint32(16,i_.Boxes.fourCCToNumber(u.entries[0].type));var p=n.boxes.reduce(function(e,t){return e+t.size},0),f=new Uint8Array(p+d.byteLength),h=new Uint8Array(t.subarray(0,u.entries[0].absoluteStartPosition+u.entries[0].size)),m=new Uint8Array(t.subarray(u.entries[0].absoluteStartPosition+u.entries[0].size));f.set(h,0),f.set(d,h.byteLength),f.set(m,h.byteLength+d.byteLength);var y=new DataView(f.buffer,f.byteOffset,f.byteLength);return y.setUint32(u.entries[0].absoluteStartPosition+4,c),y.setUint32(u.entries[0].absoluteStartPosition,u.entries[0].size+d.byteLength),y.setUint32(u.absoluteStartPosition,u.size+d.byteLength),y.setUint32(l.absoluteStartPosition,l.size+d.byteLength),y.setUint32(s.absoluteStartPosition,s.size+d.byteLength),y.setUint32(o.absoluteStartPosition,o.size+d.byteLength),y.setUint32(i.absoluteStartPosition,i.size+d.byteLength),y.setUint32(r.absoluteStartPosition,r.size+d.byteLength),f},e}();t.Encryptify=r});e(kU);kU.Encryptify;var RU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.bmffParser=new i_.BmffParser}return e.prototype.extractKeyId=function(e){var t=AE.BinaryUtils.convertBufferSourceToUint8Array(e),n=this.bmffParser.parseFragment(t),r=i_.Boxes.getPath(n,"moov[0]/trak[0]/mdia[0]/minf[0]/stbl[0]/stsd[0]"),i=null;if(null==r){var o=i_.Boxes.getPath(n,"moof[0]/traf[0]/sgpd[0]");null!=o&&o.groupingType===i_.Boxes.fourCCToNumber("seig")&&(i=o.entries[0].KID)}else{var a=F.find(r.entries,i_.Boxes.ofType("enca"));if(null==a&&(a=F.find(r.entries,i_.Boxes.ofType("encv"))),null!=a){var s=i_.Boxes.getPath(a,"sinf[0]/schi[0]/tenc[0]");null!=s&&(i=s.defaultKID)}}return i},e}();t.FragmentKeyIdExtractor=n});e(RU);RU.FragmentKeyIdExtractor;var AU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("SourceBufferMS"),r=function(){function e(e,t){this.encryptify=null,this.pendingBuffer=null,this.buffer=e,this.canAppendBuffer=t,this.fragmentKeyIdExtractor=new RU.FragmentKeyIdExtractor}return e.prototype.onMediaKeysSet=function(){null===this.encryptify&&(this.encryptify=new kU.Encryptify)},e.prototype.contentMayBeEncrypted=function(e){e?null===this.encryptify&&e&&(this.encryptify=new kU.Encryptify):this.encryptify=null},Object.defineProperty(e.prototype,"appendWindowEnd",{get:function(){return this.buffer.appendWindowEnd},set:function(e){this.buffer.appendWindowEnd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appendWindowStart",{get:function(){return this.buffer.appendWindowStart},set:function(e){this.buffer.appendWindowStart=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this.buffer.buffered},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this.buffer.mode},set:function(e){this.buffer.mode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestampOffset",{get:function(){return this.buffer.timestampOffset},set:function(e){this.buffer.timestampOffset=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this.buffer.updating||null!=this.pendingBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.buffer.audioTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.buffer.textTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoTracks",{get:function(){return this.buffer.videoTracks},enumerable:!0,configurable:!0}),e.prototype.abort=function(){this.buffer.abort()},e.prototype.appendBuffer=function(e){var t=this.fragmentKeyIdExtractor.extractKeyId(e);if(this.canAppendBuffer(t)&&null==this.pendingBuffer)this.appendEncryptedBuffer(e);else{if(null!=this.pendingBuffer)throw new Error("Attempted to append to SourceBuffer while updating.");this.pendingBuffer=e,n.info("Cannot append buffer since license is not loaded for keyId: "+t+". Setting updating flag to true while waiting for license to load.")}},e.prototype.appendStream=function(e,t){this.buffer.appendStream(e,t)},e.prototype.remove=function(e,t){this.buffer.remove(e,t)},e.prototype.addEventListener=function(e,t,n){this.buffer.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this.buffer.removeEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){return this.buffer.dispatchEvent(e)},e.prototype.onLicenseLoaded=function(){null!=this.pendingBuffer&&this.canAppendBuffer(this.fragmentKeyIdExtractor.extractKeyId(this.pendingBuffer))&&(this.appendEncryptedBuffer(this.pendingBuffer),this.pendingBuffer=null)},e.prototype.appendEncryptedBuffer=function(e){if(null!==this.encryptify){var t=this.encryptify.encryptify(e);e=AE.BinaryUtils.convertBufferSourceToUint8Array(t)}this.buffer.appendBuffer(AE.BinaryUtils.convertBufferSourceToUint8Array(e))},e}();t.SourceBufferMS=r});e(AU);AU.SourceBufferMS;var OU=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(){var t=n.call(this)||this;return t.canAppendBufferProxy=function(e){return null===t.canAppendBuffer||t.canAppendBuffer(e)},t.canAppendBuffer=null,t.isMediaKeysSet=!1,t.mediaSourceConfig={},t.sourceBuffersMS=[],t}return i(e,n),e.prototype.onMediaKeysSet=function(){this.isMediaKeysSet=!0;for(var e=0,t=this.sourceBuffersMS;e<t.length;e++){t[e].onMediaKeysSet()}},e.prototype.addSourceBuffer=function(e){var t=new AU.SourceBufferMS(n.prototype.addSourceBuffer.call(this,e),this.canAppendBufferProxy);return this.isMediaKeysSet&&t.onMediaKeysSet(),t.contentMayBeEncrypted(this.mayBeEncrypted()),this.sourceBuffersMS.push(t),t},e.prototype.setKeyStatusVerifier=function(e){this.canAppendBuffer=e},e.prototype.onLicenseLoaded=function(){this.sourceBuffersMS.forEach(function(e){e.onLicenseLoaded()})},e.prototype.configure=function(e){this.mediaSourceConfig=e;for(var t=this.mayBeEncrypted(),n=0,r=this.sourceBuffersMS;n<r.length;n++){r[n].contentMayBeEncrypted(t)}},e.prototype.endOfStream=function(e){null!=e?this.mediaSourceW3C.endOfStream(e):this.mediaSourceW3C.endOfStream()},e.prototype.mayBeEncrypted=function(){var e=this.mediaSourceConfig.contentMayBeEncrypted;return void 0===e||e},e}(SU.MediaSource);t.MediaSourceMS=n});e(OU);OU.MediaSourceMS;var LU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSource=OU.MediaSourceMS});e(LU);LU.MediaSource;var FU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.buffer=e,this.buffer.timestampOffset+=.1}return Object.defineProperty(e.prototype,"appendWindowEnd",{get:function(){return this.buffer.appendWindowEnd-.1},set:function(e){this.buffer.appendWindowEnd=e+.1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appendWindowStart",{get:function(){return this.buffer.appendWindowStart-.1},set:function(e){this.buffer.appendWindowStart=e+.1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){var t=this.buffer.buffered;return{length:t.length,end:function(e){return t.end(e)-.1},start:function(e){return t.start(e)-.1}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this.buffer.mode},set:function(e){this.buffer.mode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestampOffset",{get:function(){return this.buffer.timestampOffset-.1},set:function(e){this.buffer.timestampOffset=e+.1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this.buffer.updating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.buffer.audioTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.buffer.textTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoTracks",{get:function(){return this.buffer.videoTracks},enumerable:!0,configurable:!0}),e.prototype.abort=function(){this.buffer.abort()},e.prototype.appendBuffer=function(e){this.buffer.appendBuffer(e)},e.prototype.appendStream=function(e,t){this.buffer.appendStream(e,t)},e.prototype.remove=function(e,t){this.buffer.remove(e+.1,t+.1)},e.prototype.addEventListener=function(e,t,n){this.buffer.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this.buffer.removeEventListener(e,t,n)},e.prototype.dispatchEvent=function(e){return this.buffer.dispatchEvent(e)},e}();t.SourceBufferSafari=n});e(FU);FU.SourceBufferSafari;var DU=t(function(e,t){var r,i=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var n=function(n){function e(){return null!==n&&n.apply(this,arguments)||this}return i(e,n),e.prototype.addSourceBuffer=function(e){return new FU.SourceBufferSafari(n.prototype.addSourceBuffer.call(this,e))},e.prototype.removeSourceBuffer=function(e){var t=e;n.prototype.removeSourceBuffer.call(this,t.buffer)},e}(SU.MediaSource);t.MediaSourceSafari=n});e(DU);DU.MediaSourceSafari;var NU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSource=DU.MediaSourceSafari});e(NU);NU.MediaSource;var UU=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.MediaSource=n;var r=Xh.getBrowser().getType();r===Xh.BrowserType.IE||r===Xh.BrowserType.Edge?t.MediaSource=n=LU.MediaSource:r===Xh.BrowserType.EdgeNext?t.MediaSource=n=IU.MediaSource:r===Xh.BrowserType.Chrome||r===Xh.BrowserType.Chromium||r===Xh.BrowserType.Opera?t.MediaSource=n=PU.MediaSource:r===Xh.BrowserType.Safari?t.MediaSource=n=NU.MediaSource:r===Xh.BrowserType.Firefox||r===Xh.BrowserType.Firefox64?t.MediaSource=n=xU.MediaSource:t.MediaSource=n=SU.MediaSource});e(UU);UU.MediaSource;var BU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l="sourceopen",n=function(){function e(e,t){void 0===e&&(e=Fe.Promise),void 0===t&&(t=UU.MediaSource),this.promiseType=e,this.mediaSourceType=t}return e.prototype.createMediaSource=function(o,a){var s=this;return new this.promiseType(function(e,t){var n,r=new s.mediaSourceType,i=function(){r.removeEventListener(l,n)};n=function(){i(),e(r)},a.promise.then(function(e){i(),t(e)}),r.addEventListener(l,n),o.mediaSource=r})},e}();t.MediaSourceFactory=n});e(BU);BU.MediaSourceFactory;var VU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){void 0===n&&(n=new BU.MediaSourceFactory);var i=this;this.cancelInitialize=null,this.doInitialize=function(e){var t=Fe.CancelToken.source(),n=t.token,r=t.cancel;i.cancelInitialize=r,i.mediaSourceFactory.createMediaSource(i.stateContext.mediaPlayer,n).then(function(e){n.throwIfRequested(),(i.stateContext.mediaSource=e).addEventListener("sourceclose",i.onMediaSourceClosed),i.stateMachine.act(mU.MSEWrapperAction.Initialized)}).catch(function(e){e instanceof Fe.CancelError||i.stateMachine.act(mU.MSEWrapperAction.Error,e)})},this.doUninitialize=function(e){null!=i.stateContext.mediaSource&&(i.stateContext.mediaSource.removeEventListener("sourceclose",i.onMediaSourceClosed),i.stateContext.mediaPlayer.mediaSource=null),null!==i.cancelInitialize&&(i.cancelInitialize(),i.cancelInitialize=null),delete i.stateContext.mediaSource},this.onMediaSourceClosed=function(){var e=i.stateContext.mediaSource;null!=e&&e.removeEventListener("sourceclose",i.onMediaSourceClosed),i.stateMachine.act(mU.MSEWrapperAction.Error,new Ne.XpError("media.source_closed",void 0,"MediaSource unexpectedly closed"))},this.stateMachine=e,this.stateContext=t,this.mediaSourceFactory=n}return e.prototype.initialize=function(){this.stateMachine.onTransition(yU.MSEWrapperState.Uninitialized,mU.MSEWrapperAction.Initialize,this.doInitialize),this.stateMachine.onTransition(yU.MSEWrapperState.Initializing,mU.MSEWrapperAction.Uninitialize,this.doUninitialize),this.stateMachine.onTransition(yU.MSEWrapperState.Initialized,mU.MSEWrapperAction.Uninitialize,this.doUninitialize),this.stateMachine.onTransition(yU.MSEWrapperState.NeedsContent,mU.MSEWrapperAction.Uninitialize,this.doUninitialize),this.stateMachine.onTransition(yU.MSEWrapperState.Error,mU.MSEWrapperAction.Uninitialize,this.doUninitialize)},e}();t.InitializeHandler=n});e(VU);VU.InitializeHandler;var jU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.name="FrontBufferLoadBarrier",this.type=e,this.frontBufferSizeCallback=t;var n=Yh.deviceInformation;null!=n.mediaSource&&null!=n.mediaSource.requestedFrontBufferLengthMs?this.maxFrontBufferSizeMs=n.mediaSource.requestedFrontBufferLengthMs:this.maxFrontBufferSizeMs=6e3}return e.prototype.destroy=function(){},e.prototype.canLoadSegment=function(e){if(e.isInitSegment)return{canLoad:!0};var t=this.frontBufferSizeCallback();return t<=this.maxFrontBufferSizeMs?{canLoad:!0}:{canLoad:!1,reason:"Front buffer size("+t+"ms) > max front buffer size("+this.maxFrontBufferSizeMs+"ms)"}},e.prototype.onStateChanged=function(e){},e.prototype.offStateChanged=function(e){},e}();t.FrontBufferLoadBarrier=n});e(jU);jU.FrontBufferLoadBarrier;var XU=t(function(e,t){var n,r,i;Object.defineProperty(t,"__esModule",{value:!0});var o=((n={}).Audio={leading:-90,lagging:185},n.Video={leading:0,lagging:0},n.TimedText={leading:-1/0,lagging:-1/0},n);t.ACCEPTABLE_DRIFT_RANGES_MS=o;var a=((r={}).Audio={leading:-45,lagging:125},r.Video={leading:0,lagging:0},r.TimedText={leading:-1/0,lagging:-1/0},r);t.DETECTABLE_DRIFT_RANGES_MS=a;var s=((i={}).Audio={leading:-20,lagging:40},i.Video={leading:0,lagging:0},i.TimedText={leading:-1/0,lagging:-1/0},i);t.SUBCONSCIOUSLY_DISTURBING_DRIFT_RANGES_MS=s});e(XU);XU.ACCEPTABLE_DRIFT_RANGES_MS,XU.DETECTABLE_DRIFT_RANGES_MS,XU.SUBCONSCIOUSLY_DISTURBING_DRIFT_RANGES_MS;var zU=t(function(e,t){function r(e,t){return e.leading<=t&&t<=e.lagging}Object.defineProperty(t,"__esModule",{value:!0}),t.newlyBreachesRange=function(e,t,n){return r(e,t)&&!r(e,n)}});e(zU);zU.newlyBreachesRange;var qU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.log=new IR.EphemeralJSLogger("DriftTracker"),this.streamType=e,this.log.setId(e),this.currentDriftMs=0}return e.prototype.getDriftMs=function(){return this.currentDriftMs},e.prototype.reset=function(){this.currentDriftMs=0},e.prototype.updateDrift=function(e,t){var n=t-e;if(1<n){var r=this.currentDriftMs;this.currentDriftMs+=-n;var i="Stream drift change: "+r+"ms -> "+this.currentDriftMs+"ms";this.log.info(i+" after applying a gap of "+n+"ms");var o=XU.SUBCONSCIOUSLY_DISTURBING_DRIFT_RANGES_MS[this.streamType];zU.newlyBreachesRange(o,r,this.currentDriftMs)&&this.log.info(i+"; now in detectable range ["+JSON.stringify(o)+"]");var a=XU.DETECTABLE_DRIFT_RANGES_MS[this.streamType];zU.newlyBreachesRange(a,r,this.currentDriftMs)&&(MT.metrics.putMetric("Media.DetectableDrift."+this.streamType),this.log.warn(i+"; now in detectable range ["+JSON.stringify(a)+"]"));var s=XU.ACCEPTABLE_DRIFT_RANGES_MS[this.streamType];if(zU.newlyBreachesRange(s,r,this.currentDriftMs))return MT.metrics.putMetric("Media.UnacceptableDrift."+this.streamType),this.log.error(i+"; now in unacceptable range ["+JSON.stringify(s)+"]."),!0}else if(n<-1&&this.currentDriftMs<0){var l=-Math.max(n,this.currentDriftMs);this.currentDriftMs+=l,this.log.info("Drift is "+this.currentDriftMs+"ms after applying a recover value of "+l+"ms")}return!1},e}();t.DriftTracker=n});e(qU);qU.DriftTracker;var WU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i,o,a,s){void 0===a&&(a=null),void 0===s&&(s=6e3);var b=this;this.log=new IR.EphemeralJSLogger("FragmentLoader"),this.sourceBufferLoadMonitor=null,this.barriers=[],this.fragmentSource=null,this.encrypted=!1,this.needsInitSegment=!1,this.currentPeriodId=null,this.currentStreamId=null,this.currentQualityId=null,this.lastAppendedSegment=null,this.emittedFinalSegment=!1,this.isAppending=!1,this.isPendingFlush=!1,this.isFinalSegmentLoaded=!1,this.waiting=!0,this.backBufferSizeMs=6e3,this.skippedSegmentRanges=new Rp.NumberLine(.01),this.appendBufferTimerStartMs=null,this.pendingFlushPositionMs=null,this.update=function(){if(null!=b.fragmentSource)if(null!=b.sourceBuffer){if("closed"===b.mediaSource.readyState)return b.log.warn("Parent MediaSource has been closed."),void b.emitState();if(b.getFrontBufferSizeMs()<500&&!b.isFinalSegmentLoaded?b.waiting||(b.waiting=!0,b.eventEmitter.emit("waiting")):b.waiting&&(b.waiting=!1,b.eventEmitter.emit("buffered")),b.sourceBuffer.updating)b.emitState();else{var e=b.sourceBuffer.buffered;if(b.isAppending){b.isAppending=!1,b.state.lastFragmentAppended=b.state.lastFragmentAttempted,b.state.lastFragmentAttempted=void 0;var t=Date.now()-b.appendBufferTimerStartMs;b.appendBufferTimerStartMs=null,b.eventEmitter.emit("progress",{fragment:b.lastAppendedSegment,backBufferStartSeconds:0<e.length?e.start(0):null,appendTimeMs:t}),b.log.enabledFor(M.DEBUG)&&b.log.info("Finished appending segment "+b.lastAppendedSegment.index+" at "+JSON.stringify(b.lastAppendedSegment.position)+" with an extra offset of "+b.driftTracker.getDriftMs()+"ms. SourceBuffer buffered ranges are now "+JSON.stringify(b.getBufferedRanges().getIntervals()))}if(b.isPendingFlush)return b.log.info("Attempting a flush"),b.doFlush(),void b.emitState();var n,r=b.positionTracker.getPositionMs();if(0<e.length&&r<1e3*e.start(0)-fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS){var i=1e3*e.start(0);b.log.warn("positionMs("+r+"ms) is outside of the buffered ranges("+JSON.stringify(b.getBufferedRanges().getIntervals())+"). Setting it to "+i),b.eventEmitter.emit("positionBump",i),b.emitState(),r=i}if(b.isFinalSegmentLoaded)b.emittedFinalSegment||(b.eventEmitter.emit("finalFragmentLoaded"),b.emittedFinalSegment=!0),b.state.lastFragmentAttemptedBlockedReason="Already loaded final segment",n=null;else{if(b.trimBuffer())return void b.emitState();null!==b.lastAppendedSegment?null==(n=b.fragmentSource.getNextFragment(b.lastAppendedSegment))&&(b.state.lastFragmentAttemptedBlockedReason="No next segment available yet"):null==(n=b.fragmentSource.getFragmentAt(r))&&(b.state.lastFragmentAttemptedBlockedReason="No segment at position "+r)}if(null!=n){b.state.lastFragmentAttempted={periodId:n.periodId,streamId:n.streamId,qualityId:n.qualityLevelId,index:n.index,startMs:n.position.startTimeMs,endMs:n.position.endTimeMs,timestamp:Date.now()},b.encrypted||null==n.keyId||(b.encrypted=!0,b.eventEmitter.emit("encrypted"));var o=b.canLoadSegment(n);if(o.canLoad){b.fragmentSource.lockFragment(n);var a=n.periodId,s=n.streamId,l=n.qualityLevelId,u=a!==b.currentPeriodId||s!==b.currentStreamId||l!==b.currentQualityId;if(b.needsInitSegment=b.needsInitSegment||u,b.currentPeriodId=a,b.currentStreamId=s,b.currentQualityId=l,u&&null!=b.lastAppendedSegment&&b.appendBitrateSwitchSegment(n))return void b.emitState();if(u){var c=b.fragmentSource.getStitchingInformation(a,s,l),d=n.position.startTimeMs,p=c.appendWindowStartMs;if(null!=b.lastAppendedSegment){var f=b.lastAppendedSegment.position.endTimeMs+b.driftTracker.getDriftMs(),h=0<b.sourceBuffer.buffered.length?1e3*b.sourceBuffer.buffered.end(b.sourceBuffer.buffered.length-1):0;(h<p||f<p)&&(p=Math.min(h,f)),d+=b.driftTracker.getDriftMs();var m=b.driftTracker.getDriftMs(),y=b.driftTracker.updateDrift(f,d);b.resetOnUnacceptableDrift&&y&&null===b.pendingFlushPositionMs&&(0!==m?(b.log.error("Pending reset at "+d+"ms to remove drift"),b.pendingFlushPositionMs=d):b.log.warn("Not flushing as single-fragment drift is too much"))}var g=Math.max((p-5)/1e3,0),v=(c.appendWindowEndMs+5)/1e3;g>=b.sourceBuffer.appendWindowEnd?(b.sourceBuffer.appendWindowEnd=v,b.sourceBuffer.appendWindowStart=g):(b.sourceBuffer.appendWindowStart=g,b.sourceBuffer.appendWindowEnd=v),b.sourceBuffer.timestampOffset=(c.timestampOffsetMs+b.driftTracker.getDriftMs())/1e3,b.state.lastAppliedStitchingInfo={timestampOffsetMs:1e3*b.sourceBuffer.timestampOffset,appendWindowStartMs:1e3*g,appendWindowEndMs:1e3*v}}if(b.needsInitSegment)return b.appendInitSegment(a,s,l,n.index),void b.emitState();if(null==n.data)return b.skippedSegmentRanges.add({start:n.position.startTimeMs,end:n.position.endTimeMs}),b.lastAppendedSegment=n,A.timer.setImmediate(b.update),void b.emitState();if(b.appendBuffer(n.data)){if(b.isAppending=!0,b.state.lastFragmentAttemptedBlockedReason=void 0,"Video"!==b.streamType&&null!==b.lastAppendedSegment){var S=n.position.startTimeMs-b.lastAppendedSegment.position.endTimeMs;.01<S&&S<=50&&b.log.warn("Buffer gap found and will be collapsed. start: "+b.lastAppendedSegment.position.endTimeMs+" ms, end: "+n.position.startTimeMs+" ms, length: "+S+" ms")}return b.lastAppendedSegment=n,b.eventEmitter.emit("fragmentConsumed",n),b.setBackBufferSize(Math.max(n.position.durationMs,b.backBufferSizeMs)),n.isFinalSegment&&(b.isFinalSegmentLoaded=!0),void b.emitState()}b.state.lastFragmentAttemptedBlockedReason="QUOTA_EXCEEDED_ERR from appendBuffer"}else b.state.lastFragmentAttemptedBlockedReason=o.reason}else!b.isFinalSegmentLoaded&&null!==b.lastAppendedSegment&&b.fragmentSource.isFinalSegment(b.lastAppendedSegment)&&(b.state.lastFragmentAttemptedBlockedReason="Previous segment appended was the final segment",b.isFinalSegmentLoaded=!0);!b.emittedFinalSegment&&b.isFinalSegmentLoaded&&(b.eventEmitter.emit("finalFragmentLoaded"),b.emittedFinalSegment=!0),b.eventEmitter.emit("idle"),b.emitState()}}else b.emitState();else b.emitState()},this.getFrontBufferSizeMs=function(){if(b.isPendingFlush)return 0;if("closed"===b.mediaSource.readyState)return 0;var e=b.positionTracker.getPositionMs(),t=b.getBufferedRanges().find(e,fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS);return null===t?0:t.end-e},this.onSourceBufferError=function(e){b.log.error("Source buffer has raised an error",e),b.eventEmitter.emit("nonfatalError",new Error("Source buffer for type "+b.streamType+" has raised an error"))},this.streamType=e,this.mediaSource=t,this.sourceBuffer=n,this.positionTracker=r,this.acceptableSegmentPositionErrorMs=i,"TimedText"!==this.streamType&&(this.sourceBufferLoadMonitor=o.registerStreamType(this.streamType)),this.bufferSizeBarrier=a,this.setBackBufferSize(s),this.frontBufferBarrier=new jU.FrontBufferLoadBarrier(e,this.getFrontBufferSizeMs),this.eventEmitter=new Dt.EventEmitter,this.state={lastKnownPositionMs:r.getPositionMs(),sourceBufferUpdating:!1,mediaSourceReadyState:"closed",buffered:[],timestamp:Date.now()},this.log.setId(this.streamType),this.diagnostics=pp.Diagnostics.create("FragmentLoader."+this.streamType),this.driftTracker=new qU.DriftTracker(e),this.resetOnUnacceptableDrift=!1,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.fragmentLoaders&&(this.resetOnUnacceptableDrift=!0===up.configurationStore.configuration.fragmentLoaders.resetOnUnacceptableDrift)}return e.prototype.setBackBufferSize=function(e){this.backBufferSizeMs=Math.max(e,6e3)},e.prototype.initialize=function(){this.sourceBuffer.addEventListener("update",this.update),this.sourceBuffer.addEventListener("error",this.onSourceBufferError)},e.prototype.uninitialize=function(){this.stop(),this.frontBufferBarrier.destroy(),this.sourceBuffer.removeEventListener("update",this.update),this.sourceBuffer.removeEventListener("error",this.onSourceBufferError)},e.prototype.prepare=function(e){void 0===e&&(e=[]),this.barriers=e.slice(),this.barriers.push(this.frontBufferBarrier),this.bufferSizeBarrier;for(var t=0,n=this.barriers;t<n.length;t++){n[t].onStateChanged(this.update)}},e.prototype.stop=function(){if(this.detachContent(),null!=this.barriers)for(var e=0,t=this.barriers;e<t.length;e++){t[e].offStateChanged(this.update)}this.isAppending=!1,this.emittedFinalSegment=!1,this.isPendingFlush=!1,this.waiting=!0},e.prototype.attachContent=function(e,t){this.fragmentSource=e,null!=t&&this.log.setId(t,this.streamType),this.reset()},e.prototype.detachContent=function(){this.reset(),this.encrypted=!1,this.currentPeriodId=null,this.currentStreamId=null,this.currentQualityId=null,this.lastAppendedSegment=null,this.waiting=!1,this.fragmentSource=null,this.skippedSegmentRanges=new Rp.NumberLine(.01),this.log.setId(this.streamType)},e.prototype.reset=function(){this.isPendingFlush=!0,this.emittedFinalSegment=!1,this.update()},e.prototype.isBuffered=function(e){return!this.isPendingFlush&&("closed"!==this.mediaSource.readyState&&(null!==this.getBufferedRanges().find(e,this.acceptableSegmentPositionErrorMs)||null!==this.lastAppendedSegment&&(TE.SegmentPosition.contains(this.lastAppendedSegment.position,e)||TE.SegmentPosition.contains(this.lastAppendedSegment.position,e+this.acceptableSegmentPositionErrorMs))))},e.prototype.updatePosition=function(){if(null!=this.fragmentSource){var e=this.positionTracker.getPositionMs();if(null!=this.pendingFlushPositionMs&&e>=this.pendingFlushPositionMs)return this.log.warn("Resetting to remove drift"),void this.reset();var t=!0;this.isPendingFlush?t=!1:null===this.lastAppendedSegment?t=!1:this.isBuffered(e)?t=!1:this.isFinalSegmentLoaded&&e>=this.lastAppendedSegment.position.endTimeMs?t=!1:e-this.lastAppendedSegment.position.endTimeMs<2e3&&e>=this.lastAppendedSegment.position.endTimeMs&&this.fragmentSource.isDownloadingRange(this.lastAppendedSegment.position.endTimeMs,e)&&(t=!1),t?(null===this.lastAppendedSegment?this.log.error("Trying to reset when last segment was null"):this.log.info("Seek detected -- flushing buffer\n\t :: lastKnownPositionMs="+e+"\n\t :: buffered="+JSON.stringify(this.getBufferedRanges().getIntervals())+"\n\t :: lastAppendedSegment.end="+this.lastAppendedSegment.position.endTimeMs+"\n\t :: finalSegmentLoaded="+this.isFinalSegmentLoaded+"\n\t :: isDownloadingRange("+this.lastAppendedSegment.position.endTimeMs+", "+e+"): "+this.fragmentSource.isDownloadingRange(this.lastAppendedSegment.position.endTimeMs,e)),this.reset()):this.update()}},e.prototype.isUpdating=function(){return this.isPendingFlush||null==this.sourceBuffer||this.sourceBuffer.updating},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.getBufferedRanges=function(e){void 0===e&&(e=!1);var t=new Rp.NumberLine("Video"===this.streamType?.01:50);if(this.isPendingFlush)return t;if(null==this.sourceBuffer)return t;if("closed"===this.mediaSource.readyState)return this.log.warn("mediaSource is closed -- returning empty buffered ranges"),t;for(var n=this.sourceBuffer.buffered,r=!1,i=0;i<n.length;i++){var o={start:1e3*n.start(i),end:1e3*n.end(i)};o.start<o.end?t.add(o):r=!0}return r&&this.saveInvalidBufferedRangesToState(n),e&&this.sourceBuffer.updating&&null!==this.lastAppendedSegment&&t.add({start:this.lastAppendedSegment.position.startTimeMs,end:this.lastAppendedSegment.position.endTimeMs}),this.skippedSegmentRanges.union(t)},e.prototype.doFlush=function(){this.isPendingFlush=!1,this.lastAppendedSegment=null,this.isAppending=!1,this.isFinalSegmentLoaded=!1,this.skippedSegmentRanges=new Rp.NumberLine(.01),this.driftTracker.reset(),this.pendingFlushPositionMs=null,this.state.lastFragmentAppended=void 0,this.state.lastFragmentAttempted=void 0,this.state.lastFragmentAttemptedBlockedReason=void 0,this.state.invalidBufferedInterval=void 0,this.currentPeriodId=null,this.currentStreamId=null,this.currentQualityId=null;var e=this.sourceBuffer.buffered;if(0<e.length){var t=e.start(0),n=e.end(e.length-1);try{this.sourceBuffer.remove(t,n),this.state.lastSourceBufferOperation="remove",this.eventEmitter.emit("flushed"),this.log.info("Flushed buffer")}catch(e){this.log.error("doFlush SourceBuffer.remove("+t+", "+n+") failed:",e,this.getSimpleStateString()),A.timer.setImmediate(this.update)}}else A.timer.setImmediate(this.update)},e.prototype.appendBuffer=function(e){try{return null!=e&&(this.sourceBuffer.appendBuffer(e),this.state.lastSourceBufferOperation="appendBuffer",this.appendBufferTimerStartMs=Date.now(),!0)}catch(e){return 22===e.code?this.trimBuffer(!0):(this.log.error("Fatal appendBuffer error:",e,this.getSimpleStateString()),this.eventEmitter.emit("fatalError",e)),!1}},e.prototype.appendBitrateSwitchSegment=function(e){var t=this.fragmentSource.getBitrateSwitchFragment(this.lastAppendedSegment,e);return null!=t&&this.appendBuffer(t)},e.prototype.appendInitSegment=function(e,t,n,r){var i=this.fragmentSource.getInitFragment(e,t,n);if(null!=i){this.state.lastFragmentAttempted={periodId:e,streamId:t,qualityId:n,index:"init",timestamp:Date.now()},this.encrypted||null==i.keyId||(this.encrypted=!0,this.eventEmitter.emit("encrypted"));var o=this.canLoadSegment(i);o.canLoad?(this.log.info("Appending init segment for period "+e+", quality "+n+", at media segment "+r),this.appendBuffer(i.data)&&(this.needsInitSegment=!1)):this.state.lastFragmentAttemptedBlockedReason=o.reason}else this.state.lastFragmentAttemptedBlockedReason="Init segment not available yet",this.log.info("Init segment for period "+e+", quality "+n+" not available yet.")},e.prototype.canLoadSegment=function(e){for(var t=0,n=this.barriers;t<n.length;t++){var r=n[t],i=r.canLoadSegment(e);if(!i.canLoad)return{canLoad:!1,reason:"["+r.name+"] "+i.reason}}return{canLoad:!0}},e.prototype.trimBuffer=function(e){if(void 0===e&&(e=!1),"ended"===this.mediaSource.readyState)return!1;var t=this.sourceBuffer.buffered;if(0===t.length)return!1;for(var n,r=this.positionTracker.getPositionMs(),i=null,o=0;o<t.length;o++)if(t.start(o)<t.end(o)){i=t.start(o);break}if(null===i)return this.log.error("Ignoring fully non-normalized buffered ranges"),!1;if(e)n=Math.min(i+30,(r-this.backBufferSizeMs)/1e3);else{if(r<this.backBufferSizeMs)return!1;n=(r-this.backBufferSizeMs)/1e3}if(n<=i)return!1;if(n-i<2)return!1;try{this.sourceBuffer.remove(0,n),this.state.lastSourceBufferOperation="remove"}catch(e){return this.log.error("trimBuffer SourceBuffer.remove(0, "+n+") failed:",e,this.getSimpleStateString()),!1}return!0},e.prototype.getBufferRegionIndexForPositionMs=function(e,t){for(var n=t/1e3,r=0;r<e.length;r++)if(e.start(r)<=n&&e.end(r)>n)return r;return null},e.prototype.getSimpleStateString=function(){return"mediaSource.readyState: "+this.mediaSource.readyState+", sourceBuffer.updating:"+this.sourceBuffer.updating+", stack:"+(new Error).stack},e.prototype.saveInvalidBufferedRangesToState=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:1e3*e.start(n),end:1e3*e.end(n)});this.state.invalidBufferedInterval={timestamp:Date.now(),sourceBufferBuffered:t}},e.prototype.emitState=function(){this.state.lastKnownPositionMs=this.positionTracker.getPositionMs(),this.state.sourceBufferUpdating=this.sourceBuffer.updating,this.state.mediaSourceReadyState=this.mediaSource.readyState,this.state.buffered=this.getBufferedRanges().getIntervals(),this.state.timestamp=Date.now(),this.diagnostics.report("state",this.state)},e}();t.FragmentLoader=n});e(WU);WU.FragmentLoader;var HU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.bufferedSegments=[],this.totalSizeBytes=0,this.pendingSizeBytes=0,this.streamType=e,this.bufferedRangesCalculator=t}return e.prototype.destroy=function(){this.bufferedSegments=[]},e.prototype.update=function(){if(0!==this.bufferedSegments.length){var e=this.bufferedRangesCalculator.getBufferedRanges(this.streamType).getIntervals();if(0===e.length)return this.bufferedSegments=[],void(this.totalSizeBytes=0);var t=e[0].start,n=Mp.binarySearchIndexOfClosestBelow(this.bufferedSegments,function(e){return t-e.position.endTimeMs});if(!(this.bufferedSegments[n].position.endTimeMs>t)){for(var r=0,i=0,o=this.bufferedSegments.splice(0,n+1);i<o.length;i++){r+=o[i].sizeBytes}this.totalSizeBytes-=r}}},e.prototype.appendCompleted=function(e){this.registerSegment(e,!1)},e.prototype.appendStarted=function(e){this.registerSegment(e,!0)},e.prototype.clearAppending=function(){this.pendingSizeBytes=0},e.prototype.getSourceBufferSizeBytes=function(){return this.totalSizeBytes+this.pendingSizeBytes},e.prototype.registerSegment=function(e,t){if(null!=e.data)if(t)this.pendingSizeBytes=e.data.byteLength;else{var n={position:e.position,sizeBytes:e.data.byteLength};this.bufferedSegments.push(n),this.totalSizeBytes+=n.sizeBytes,this.pendingSizeBytes=0}},e}();t.SourceBufferLoadMonitor=n});e(HU);HU.SourceBufferLoadMonitor;var GU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t;this.bufferedRangesCalculator=e,this.streamMonitors=((t={}).Video=null,t.Audio=null,t.TimedText=null,t)}return e.prototype.registerStreamType=function(e){var t=new HU.SourceBufferLoadMonitor(e,this.bufferedRangesCalculator);return this.streamMonitors[e]=t},e.prototype.deregisterStreamType=function(e){var t=this.streamMonitors[e];null!=t&&t.destroy(),this.streamMonitors[e]=null},e.prototype.getSourceBufferSizeBytes=function(e){if(null!=e)return null==(i=this.streamMonitors[e])?0:i.getSourceBufferSizeBytes();for(var t=0,n=0,r=Object.keys(this.streamMonitors);n<r.length;n++){var i,o=r[n];null!==(i=this.streamMonitors[o])&&(t+=i.getSourceBufferSizeBytes())}return t},e}();t.AggregateSourceBufferLoadMonitor=n});e(GU);GU.AggregateSourceBufferLoadMonitor;var KU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r){this.name="BufferSizeLoadBarrier",this.streamType=e,this.useSeparateLimits=t,this.sourceBufferLoadMonitor=n,this.maxSourceBufferSizeBytes=r}return e.prototype.destroy=function(){},e.prototype.canLoadSegment=function(e){var t=e.type;return t!==this.streamType?{canLoad:!0}:e.isInitSegment?{canLoad:!0}:null!=e.data?this.checkBufferSizeAndLimit(t,e.data.byteLength):{canLoad:!0}},e.prototype.onStateChanged=function(e){},e.prototype.offStateChanged=function(e){},e.prototype.checkBufferSizeAndLimit=function(e,t){var n=this.sourceBufferLoadMonitor.getSourceBufferSizeBytes(this.useSeparateLimits?e:void 0);return n+t<=this.maxSourceBufferSizeBytes?{canLoad:!0}:{canLoad:!1,reason:"current size("+n+") + fragment size("+t+") > max size("+this.maxSourceBufferSizeBytes+")"}},e}();t.BufferSizeLoadBarrier=n});e(KU);KU.BufferSizeLoadBarrier;var QU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.name="SlowSegmentLoadBarrier",this.stateChangedCallback=new Dt.MulticastCallback,this.fragmentLoaders=[],this.onProgress=function(){t.stateChangedCallback.invoke()},this.maxDistanceToSlowestSegmentMs=e}return e.prototype.destroy=function(){for(var e=0,t=this.fragmentLoaders;e<t.length;e++){t[e].off("progress",this.onProgress)}this.fragmentLoaders=[]},e.prototype.addFragmentLoader=function(e){this.fragmentLoaders.push(e),e.on("progress",this.onProgress)},e.prototype.canLoadSegment=function(e){if(e.isInitSegment)return{canLoad:!0};for(var t,n=1/0,r=0,i=this.fragmentLoaders;r<i.length;r++){var o=i[r],a=o.getBufferedRanges(!0).bounds();null!==a&&(n>a.end&&(n=a.end,t=o.streamType))}return e.position.startTimeMs<=n+this.maxDistanceToSlowestSegmentMs?{canLoad:!0}:{canLoad:!1,reason:"Segment at "+e.position.startTimeMs+"ms more than "+this.maxDistanceToSlowestSegmentMs+" ahead of "+t+" buffer, ending at "+n+"ms"}},e.prototype.onStateChanged=function(e){this.stateChangedCallback.add(e)},e.prototype.offStateChanged=function(e){this.stateChangedCallback.remove(e)},e}();t.SlowSegmentLoadBarrier=n});e(QU);QU.SlowSegmentLoadBarrier;var YU=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){void 0===t&&(t=0),this.wrappedBuffer=e,this.timestampOffsetOverrideSec=t,this.wrappedBuffer.timestampOffset+=t}return Object.defineProperty(e.prototype,"audioTracks",{get:function(){return this.wrappedBuffer.audioTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){var t=this,n=this.wrappedBuffer.buffered;return{length:n.length,end:function(e){return Math.max(n.end(e)-t.timestampOffsetOverrideSec,0)},start:function(e){return Math.max(n.start(e)-t.timestampOffsetOverrideSec,0)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"updating",{get:function(){return this.wrappedBuffer.updating},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.wrappedBuffer.textTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoTracks",{get:function(){return this.wrappedBuffer.videoTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appendWindowEnd",{get:function(){return this.wrappedBuffer.appendWindowEnd-this.timestampOffsetOverrideSec},set:function(e){this.wrappedBuffer.appendWindowEnd=Math.max(e+this.timestampOffsetOverrideSec,this.wrappedBuffer.appendWindowStart+1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"appendWindowStart",{get:function(){return Math.max(this.wrappedBuffer.appendWindowStart-this.timestampOffsetOverrideSec,0)},set:function(e){this.wrappedBuffer.appendWindowStart=0===e?0:Math.max(e+this.timestampOffsetOverrideSec,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this.wrappedBuffer.mode},set:function(e){this.wrappedBuffer.mode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestampOffset",{get:function(){return this.wrappedBuffer.timestampOffset-this.timestampOffsetOverrideSec},set:function(e){this.wrappedBuffer.timestampOffset=e+this.timestampOffsetOverrideSec},enumerable:!0,configurable:!0}),e.prototype.abort=function(){throw new Error("Not implemented")},e.prototype.appendStream=function(e,t){this.wrappedBuffer.appendStream(e,t)},e.prototype.appendBuffer=function(e){this.wrappedBuffer.appendBuffer(e)},e.prototype.remove=function(e,t){.01<e&&(e+=this.timestampOffsetOverrideSec),t+=this.timestampOffsetOverrideSec,this.wrappedBuffer.remove(Math.max(e,0),t)},e.prototype.addEventListener=function(e,t,n){this.wrappedBuffer.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t){this.wrappedBuffer.removeEventListener(e,t)},e.prototype.dispatchEvent=function(e){return this.wrappedBuffer.dispatchEvent(e)},e}();t.TimeOffsettingSourceBuffer=n});e(YU);var JU,$U;YU.TimeOffsettingSourceBuffer;($U=JU||(JU={}))[$U.AUDIO=0]="AUDIO",$U[$U.VIDEO=1]="VIDEO",$U[$U.TEXT=2]="TEXT";var ZU,eB,tB,nB,rB,iB,oB=JU,aB=M.get("BaseAudioDataExtractor"),sB=function(){function e(){}return e.prototype.extractData=function(e,t,n){if(t.type!==oB.AUDIO)return aB.warn("Expected track type AUDIO, but encountered "+oB[t.type]),t;var r=t,i=e;return r.sampleRate=i.entries[0].sampleRate>>>16,r.numChannels=i.entries[0].channelCount,r},e}(),lB=V&&V.__extends||(ZU=function(e,t){return(ZU=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}ZU(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),uB=i_.Boxes,cB=[48e3,44100,32e3,-1],dB=[48e3,44100,32e3,-1],pB=[2,1,2,3,3,4,4,5],fB=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return lB(e,o),e.prototype.extractData=function(e,t,n){(t=o.prototype.extractData.call(this,e,t,n)).codecType="AUDIO_CODEC_EAC3";var r=t;if("ec-3"===t.fourCC){if(null==(i=uB.find(e.entries[0],uB.ofType("dec3"))))throw new Error("Missing EC-3 configuration box!");r.sampleRate=cB[i.independentSubstreams[0].fscod],r.numChannels=pB[i.independentSubstreams[0].acmod],i.independentSubstreams[0].lfeon&&r.numChannels++}else if("ac-3"===t.fourCC){var i;if(null==(i=uB.find(e.entries[0],uB.ofType("dac3"))))throw new Error("Missing AC-3 configuration box!");r.sampleRate=dB[i.fscod],r.numChannels=pB[i.acmod],i.lfeon&&r.numChannels++}return r},e}(sB),hB=V&&V.__extends||(eB=function(e,t){return(eB=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}eB(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),mB=function(r){function e(){return null!==r&&r.apply(this,arguments)||this}return hB(e,r),e.prototype.extractData=function(e,t,n){return(t=r.prototype.extractData.call(this,e,t,n)).codecType="AUDIO_CODEC_AAC",t},e}(sB),yB=M.get("BaseVideoDataExtractor"),gB=function(){function e(){}return e.prototype.extractData=function(e,t,n){if(t.type!==oB.VIDEO)return yB.warn("Expected track type VIDEO, but encountered "+oB[t.type]),t;var r=t,i=e;return r.resolution={width:i.entries[0].width,height:i.entries[0].height},r.maxResolution=this.parseMaxResolution(n["max-resolution"]),r.frameRate=this.parseFrameRate(n["frame-rate"]),t.baseSample.resolution=r.resolution,r},e.prototype.parseMaxResolution=function(e){if(null==e)throw new Error("Required parameter max-resolution is missing");var t=e.split("x"),n=t[0],r=t[1];if(0<t.slice(2).length)throw new Error("Required parameter max-resolution malformed as \""+e+"\"");var i=parseInt(n),o=parseInt(r);if(0<i&&0<o)return{width:i,height:o};throw new Error("Required parameter max-resolution \""+e+"\" contains non-positive numbers")},e.prototype.parseFrameRate=function(e){if(null==e)throw new Error("Required parameter frame-rate is missing");var t=-1!==e.indexOf("/")?this.evaluateFrameRate(e):parseFloat(e);if(0<t)return t;throw new Error("Parameter frame-rate value "+e+" is not a positive number")},e.prototype.evaluateFrameRate=function(e){var t=e.split("/");if(2!==t.length)throw new Error("Invalid frame-rate parameter: "+e);var n=t.map(function(e){return parseFloat(e)}),r=n[0],i=n[1];if(0===i)throw new Error("Frame-rate division by zero: ("+r+") / ("+i+") ");var o=r/i;return o=Math.floor(100*o)/100},e}(),vB=V&&V.__extends||(tB=function(e,t){return(tB=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}tB(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),SB=i_.Boxes,bB=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return vB(e,o),e.prototype.extractData=function(e,t,n){(t=o.prototype.extractData.call(this,e,t,n)).codecType="VIDEO_CODEC_AVC";var r=SB.find(e.entries[0],SB.ofType("avcC"));if(null==r)throw new Error("Missing AVC configuration box!");var i=t;return i.codecSpecificData=this.extractAvcData(r),i},e.prototype.extractAvcData=function(e){if(null!=e){var t=0<e.SPSs.length?e.SPSs[0]:null,n=0<e.PPSs.length?e.PPSs[0]:null;if(null!=t||null!=n){var r=null!=t&&0<t.length?4+t.length:0,i=null!=n&&0<n.length?4+n.length:0;if(0!==r||0!==i){var o=new Uint8Array(r+i);return 0<r&&null!=t&&(o.set([0,0,0,1]),o.set(t,4)),0<i&&null!=n&&(o.set([0,0,0,1],r),o.set(n,r+4)),o}}}},e}(gB),TB=V&&V.__extends||(nB=function(e,t){return(nB=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}nB(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),PB=M.get("HevcDataExtractor"),wB=function(o){function e(){return null!==o&&o.apply(this,arguments)||this}return TB(e,o),e.prototype.extractData=function(e,t,n){(t=o.prototype.extractData.call(this,e,t,n)).codecType="VIDEO_CODEC_HEVC";var r=i_.Boxes.find(e.entries[0],i_.Boxes.ofType("hvcC"));if(null==r)throw new Error("Missing HEVC configuration box!");var i=t;return i.codecSpecificData=this.extractHevcData(r),i},e.prototype.extractHevcData=function(e){if(null!=e){var t=e.arrays.reduce(function(e,t){return e+t.nals.reduce(function(e,t){return e+t.byteLength+4},0)},0);t<0&&PB.warn("[neguintarray] Creating new Uint8Array for HEVC initData of negative length: "+t);for(var n=new Uint8Array(t),r=0,i=0,o=e.arrays;i<o.length;i++)for(var a=0,s=o[i].nals;a<s.length;a++){var l=s[a];n.set([0,0,0,1],r),n.set(l,r+4),r+=l.byteLength+4}return n}},e}(gB),CB=V&&V.__extends||(rB=function(e,t){return(rB=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}rB(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),MB=i_.Boxes,IB=M.get("DvheDataExtractor"),EB={4:"DTR",5:"STN",7:"DTB",8:"ST",9:"SE"},_B=function(u){function e(){return null!==u&&u.apply(this,arguments)||this}return CB(e,u),e.prototype.extractData=function(e,t,n){var r;t=u.prototype.extractData.call(this,e,t,n);var i=e.entries[0];if("dvhe"===t.fourCC||"dvh1"===t.fourCC||"hev1"===t.fourCC||"hvc1"===t.fourCC){if(null==(t=(new wB).extractData(e,t,n)))return IB.error("HevcDataExtractor returned "+t+" trackInitInfo"),t;r=t;for(var o=void 0,a=0,s=["dvcC","dvvC"];a<s.length;a++){var l=s[a];if(null!=(o=MB.find(i,MB.ofType(l)))){r.codecType=this.buildCodecType(o);break}}return r}return t},e.prototype.buildCodecType=function(e){return"VIDEO_CODEC_DVHE_"+this.getProfileString(e.profile)},e.prototype.getProfileString=function(e){var t=EB[e];if(null==t)throw new Error("Not supported DVHE profile "+e);return t},e}(gB),xB=M.get("BaseTextDataExtractor"),kB=function(){function e(){}return e.prototype.extractData=function(e,t,n){return t.type!==oB.TEXT&&xB.warn("Expected track type TEXT, but encountered "+oB[t.type]),t},e}(),RB=function(){function e(e,t,n,r,i,o){void 0===e&&(e=bB),void 0===t&&(t=fB),void 0===n&&(n=mB),void 0===r&&(r=wB),void 0===i&&(i=_B),void 0===o&&(o=kB),this.extractorMap={},this.extractorMap["ac-3"]=this.extractorMap["ec-3"]=new t,this.extractorMap.avc1=new e,this.extractorMap.hev1=this.extractorMap.hvc1=new r,this.extractorMap.dvhe=new i,this.extractorMap.mp4a=new n,this.extractorMap.stpp=new o}return e.prototype.selectExtractor=function(e){return this.extractorMap[e]},e}(),AB=i_.Boxes,OB=i_.CencParser,LB=AB.fourCCToNumber("seig"),FB=AB.fourCCToNumber("cenc"),DB=function(){function e(e){void 0===e&&(e=new OB),this.cencParser=e}return e.prototype.processTrackInitInfo=function(e,t){var n=AB.getPath(t,"sinf[0]/schi[0]/tenc[0]");if(null==n)throw new Error("Track is protected with scheme "+e.protectionSchemeType.toString(16)+", but is missing the TENC box");var r=e.containerSpecificData;r.defaultIsEncrypted=n.defaultIsEncrypted,r.defaultIvSize=n.defaultIvSize,r.defaultKID=n.defaultKID},e.prototype.processTrackMedia=function(e,t){for(var n=e.containerSpecificData,r=0,i=t.sampleRuns;r<i.length;r++)for(var o=0,a=i[r].samples;o<a.length;o++){var s=a[o],l=s.containerSpecificData,u=null!=l.groupInformation[LB]?l.groupInformation[LB].entry:null;if(null!=u?u.isEncrypted:n.defaultIsEncrypted){s.isEncrypted=!0;var c=void 0;c=null==u?{sessionId:"",keyId:n.defaultKID,ivSize:n.defaultIvSize,initializationVector:new Uint8Array(0),encryptedRegions:[]}:{sessionId:"",keyId:u.KID,ivSize:u.ivSize,initializationVector:new Uint8Array(0),encryptedRegions:[]},s.encryptionInfo=c;var d=l.auxiliaryInfos[FB][0],p=this.cencParser.parseSampleAuxiliaryInfo(d,c.ivSize);c.initializationVector=p.initializationVector,0<p.entries.length?s.encryptionInfo.encryptedRegions=p.entries.map(function(e){return{bytesOfClearData:e.bytesOfClearData,bytesOfEncryptedData:e.bytesOfProtectedData}}):s.encryptionInfo.encryptedRegions.push({bytesOfClearData:0,bytesOfEncryptedData:s.data.byteLength})}}},e}(),NB=i_.Boxes,UB=["enca","encs","enct","encv"],BB=S.of("ProtectedStreamProcessor"),VB=((iB={})[NB.fourCCToNumber("cenc")]=new DB,iB),jB=function(){function e(e){void 0===e&&(e=VB),this.processorMap=e}return e.prototype.isProtectedTrack=function(e){return-1!==UB.indexOf(e)},e.prototype.processTrackInitInfo=function(e,t){if(BB(e,"initInfo").exists(),BB(t,"sampleDescriptionEntry").exists(),this.isProtectedTrack(t.type)){var n=NB.find(t,NB.ofType("sinf"));if(null==n)throw new Error("Protected sample type "+t.type+" is missing the \"sinf\" box");var r=NB.find(n,NB.ofType("schm"));if(null==r)throw new Error("Protected sample type "+t.type+" is missing the \"schm\" box");var i=NB.find(n,NB.ofType("frma"));if(null==i)throw new Error("Protected sample type "+t.type+" is missing the \"frma\" box");e.fourCC=NB.numberToFourCC(i.dataFormat),e.protectionSchemeType=r.schemeType,null!=this.processorMap[e.protectionSchemeType]&&this.processorMap[e.protectionSchemeType].processTrackInitInfo(e,t)}},e.prototype.processTrackMedia=function(e,t){null!=this.processorMap[e.protectionSchemeType]&&this.processorMap[e.protectionSchemeType].processTrackMedia(e,t)},e}(),XB=M.get("AuxiliaryInfoExtractor"),zB=function(){function e(e,t,n,r,i){this.auxInfos={},this.data=e,this.moofAbsolutePosition=t,this.defaultAuxInfoType=n,this.saios=r;for(var o=0,a=this.saizs=i;o<a.length;o++){var s=a[o],l=null!=s.auxInfoType?s.auxInfoType:this.defaultAuxInfoType,u=null!=s.auxInfoTypeParameter?s.auxInfoTypeParameter:0,c=this.findMatchingOffsets(l,u);if(null==c)throw new Error("Could not find corresponding offset box!");null==this.auxInfos[l]&&(this.auxInfos[l]={}),this.auxInfos[l][u]={saio:c,saiz:s,start:-1}}this.currentRun=-1,this.globalSampleNumber=-1}return e.prototype.startTrackRun=function(){this.currentRun++;for(var e=0,t=this.saios;e<t.length;e++){var n=t[e];if(0===this.currentRun||1<n.offset.length){var r=null!=n.auxInfoType?n.auxInfoType:this.defaultAuxInfoType,i=null!=n.auxInfoTypeParameter?n.auxInfoTypeParameter:0;this.auxInfos[r][i].start=n.offset[this.currentRun]}}},e.prototype.nextSample=function(){this.globalSampleNumber++;for(var e={},t=0,n=this.saizs;t<n.length;t++){var r=n[t];if(!(r.sampleCount<=this.globalSampleNumber)){var i=null!=r.auxInfoType?r.auxInfoType:this.defaultAuxInfoType,o=null!=r.auxInfoTypeParameter?r.auxInfoTypeParameter:0;if(null==this.auxInfos[i][o].saio)throw new Error("Could not find matching offset box!");var a=this.auxInfos[i][o].start;null==e[i]&&(e[i]={}),this.moofAbsolutePosition+a<0&&XB.warn("[neguintarray] Negative offset for Uint8Array: moofAbsolutePosition: "+this.moofAbsolutePosition+" and auxInfoOffset: "+a),r.sampleInfoSize[this.globalSampleNumber]<0&&XB.warn("[neguintarray] Negative size for Uint8Array: saiz.sampleInfoSize[this.globalSampleNumber]: "+r.sampleInfoSize[this.globalSampleNumber]),e[i][o]=new Uint8Array(this.data,this.moofAbsolutePosition+a,r.sampleInfoSize[this.globalSampleNumber]),this.auxInfos[i][o].start+=r.sampleInfoSize[this.globalSampleNumber]}}return e},e.prototype.findMatchingOffsets=function(t,n){var r=this;return F.find(this.saios,function(e){return null!=e.auxInfoType?t===e.auxInfoType&&n===e.auxInfoTypeParameter:t===r.defaultAuxInfoType&&0===n})},e}(),qB=function(){function e(e,t,n){this.initGroups=e,this.mediaGroups=t,this.sbgps=n,this.currentSampleToGroupMap={};for(var r=0,i=this.sbgps;r<i.length;r++){var o=i[r];this.currentSampleToGroupMap[o.groupingType]={entryIndex:0,groupDescriptionIndex:o.entries[0].groupDescriptionIndex,remainingSamples:o.entries[0].sampleCount}}}return e.prototype.nextSample=function(){for(var e={},t=0,n=this.sbgps;t<n.length;t++){var r=n[t],i=r.groupingType,o=this.currentSampleToGroupMap[i];0===o.remainingSamples&&(o.entryIndex++,o.groupDescriptionIndex=r.entries[o.entryIndex].groupDescriptionIndex,o.remainingSamples=r.entries[o.entryIndex].sampleCount);r.entries[o.entryIndex];var a=null;65536<o.groupDescriptionIndex?a=this.mediaGroups[i].entries[o.groupDescriptionIndex-65537]:0<o.groupDescriptionIndex&&(a=this.initGroups[i].entries[o.groupDescriptionIndex-1]),null!==a&&(e[i]={parameter:r.groupingTypeParameters,entry:a}),o.remainingSamples--}return e},e}(),WB=V&&V.__assign||function(){return(WB=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},HB=i_.Boxes,GB=i_.BmffParser,KB=M.get("MP4SegmentParser"),QB=function(){function e(e,t,n,r,i,o,a){void 0===n&&(n=new GB),void 0===r&&(r=new RB),void 0===i&&(i=new jB),void 0===o&&(o=zB),void 0===a&&(a=qB),this.mimeTypeParameters=e,this.parser=n,this.codecDataExtractorSelector=r,this.protectedStreamProcessor=i,this.auxiliaryInfoExtractorType=o,this.groupDataExtractorType=a,this.codecs=this.validateCodecs(t)}return e.prototype.parse=function(t,e){var n,r,i=this.parser.parseFragment(t),o=HB.find(i,HB.ofType("moov")),a=HB.all(i,HB.ofType("moof"));if((null!=o&&0<a.length||1<a.length)&&KB.warn("Multiple fragments found in the same buffer. Only one is currently supported."),null!=o)n=this.parseInitSegment(i,o),r=HB.all(o,HB.ofType("pssh"));else{if(!(0<a.length))return[];if(null==e)throw new Error("Received media segment but did not receive first initialization segment");n=this.parseMediaSegment(e,i,t,a[0]),r=HB.all(a[0],HB.ofType("pssh"))}for(var s=[],l=0,u=r;l<u.length;l++){var c=u[l],d=F.last(s);null!=d&&d.end===c.absoluteStartPosition?d.end+=c.size:s.push({start:c.absoluteStartPosition,end:c.absoluteStartPosition+c.size})}return n.initializationDatas=s.map(function(e){return{type:"cenc",data:new Uint8Array(t.slice(e.start,e.end))}}),[n]},e.prototype.parseInitSegment=function(e,t){var n,r={},i=HB.find(t,HB.ofType("mvhd"));if(null==i)throw new Error("Segment is missing the MVHD box");var o=HB.all(t,HB.ofType("trak"));if(0===o.length)throw new Error("Segment is missing the TRAK box");for(var a=0,s=o;a<s.length;a++){var l=s[a],u=HB.find(l,HB.ofType("tkhd"));if(null==u)throw new Error("Segment is missing the TKHD box");var c=u.trackId,d=HB.find(l,HB.ofType("mdia"));if(null==d)throw new Error("Segment is missing the MDIA box");var p=HB.find(d,HB.ofType("mdhd"));if(null==p)throw new Error("Segment is missing the MDHD box");var f=HB.find(d,HB.ofType("minf"));if(null==f)throw new Error("Segment is missing the MINF box");var h=p.timescale,m=HB.find(d,HB.ofType("hdlr"));if(null==m)throw new Error("Segment is missing the HDLR box");var y=void 0;if(m.handlerType===HB.fourCCToNumber("soun"))y=oB.AUDIO;else if(m.handlerType===HB.fourCCToNumber("vide"))y=oB.VIDEO;else{if(m.handlerType!==HB.fourCCToNumber("subt"))throw new Error("Unknown track type "+m.handlerType);y=oB.TEXT}var g=HB.find(f,HB.ofType("stbl"));if(null==g)throw new Error("Segment is missing the STBL box");var v=HB.find(g,HB.ofType("stsd"));if(null==v)throw new Error("Segment is missing the STSD box");var S={defaultSampleFlags:0,defaultSampleDuration:0,defaultSampleSize:0,defaultSampleDescriptionIndex:0,isProtected:!1,groups:{}},b=void 0;if(0<v.entryCount)b=v.entries[0].type;else{if(y!==oB.TEXT)throw new Error("Unable to determine a fourCC");b=this.codecs[0]}var T={type:y,trackId:c,timescale:h,fourCC:b,codecType:"",containerSpecificData:S,baseSample:{timescale:h},codecSpecificData:new Uint8Array(0),durationSeconds:u.duration/h};this.protectedStreamProcessor.isProtectedTrack(T.fourCC)&&(S.isProtected=!0,this.protectedStreamProcessor.processTrackInitInfo(T,v.entries[0])),F.find(this.codecs,T.fourCC)&&KB.warn("FourCC from segment is \""+T.fourCC+"\", but got \""+this.codecs+"\" from MIME type");var P=this.codecDataExtractorSelector.selectExtractor(T.fourCC);if(null==P)throw new Error("Encountered unknown codec fourCC \""+T.fourCC+"\"");T=P.extractData(v,T,this.mimeTypeParameters);var w=HB.all(g,HB.ofType("sgpd"));if(null!=w)for(var C=0,M=w;C<M.length;C++){var I=M[C];S.groups[I.groupingType]=I}r[c]=T}var E=HB.find(t,HB.ofType("mvex"));if(null==E)throw new Error("Segment is missing the MVEX box");var _=HB.find(E,HB.ofType("mehd"));null!=_&&(n=_.fragmentDuration);var x=HB.all(E,HB.ofType("trex"));if(0===x.length)throw new Error("Segment is missing the TREX box");for(var k=0,R=x;k<R.length;k++){var A=R[k];if(null==r[A.trackId])throw new Error("Track "+A.trackId+" does not exist on TRAK box but exists on TREX box");var O=r[A.trackId].containerSpecificData;O.defaultSampleDuration=A.defaultSampleDuration;var L=A.defaultSampleFlags;r[A.trackId].type===oB.VIDEO&&null!=L&&(L|=65536),O.defaultSampleFlags=L,O.defaultSampleSize=A.defaultSampleSize,O.defaultSampleDescriptionIndex=A.defaultSampleDescriptionIndex,r[A.trackId].baseSample.duration=O.defaultSampleDuration,r[A.trackId].baseSample.flags=O.defaultSampleFlags}return{type:"init",totalDurationSec:null!=n?n/i.timescale:void 0,tracks:r,containerSpecificData:null,initializationDatas:[]}},e.prototype.parseMediaSegment=function(e,t,n,r){var i={},o=HB.all(r,HB.ofType("traf"));if(0===o.length)throw new Error("Missing TRAF box in media segment");for(var a=0;a<o.length;a++){var s=this.parseMediaTrack(e,t,n,r,a,o.length,o[a]);i[s.trackId]=s}return{type:"media",tracks:i,containerSpecificData:null,initializationDatas:[]}},e.prototype.parseMediaTrack=function(e,t,n,r,i,o,a){var s=HB.find(a,HB.ofType("tfhd")),l=HB.find(a,HB.ofType("tfdt")),u=HB.all(a,HB.ofType("trun"));if(null==s)throw new Error("Missing \"tfhd\" box for track entry "+i);if((1!==o||s.baseDataOffsetPresent)&&!s.defaultBaseIsMoof)throw new Error("Movie fragment is not using movie-fragment relative addressing: track "+s.trackId+" has a baseDataOffset");var c=e.tracks[s.trackId],d=c.containerSpecificData;if(null==c)throw new Error("Track "+s.trackId+" on media segment does not exist in the last init segment.");if(null==l)throw new Error("Missing \"tfdt\" box for track "+s.trackId);if(0===u.length)throw new Error("No \"trun\" boxes for track "+s.trackId);for(var p=u.reduce(function(e,t){return e+t.samples.length},0),f=HB.all(a,HB.ofType("saio")),h=0,m=f;h<m.length;h++){var y=m[h];if(1!==y.entryCount&&y.entryCount!==u.length)throw new Error("Sample Auxiliary Info Offsets box with type  "+y.auxInfoType+"-"+y.auxInfoTypeParameter+" has "+y.entryCount+" entries, but there are "+u.length+" trun boxes.")}for(var g=HB.all(a,HB.ofType("saiz")),v=0,S=g;v<S.length;v++){var b=S[v];if(b.sampleCount>p)throw new Error("Sample Auxiliary Info Sizes box with type "+b.auxInfoType+"-"+b.auxInfoTypeParameter+" has "+b.sampleCount+" samples, but total samples in fragment is "+p)}for(var T=HB.all(a,HB.ofType("sbgp")),P=0,w=T;P<w.length;P++){var C=w[P],M=C.entries.reduce(function(e,t){return e+t.sampleCount},0);if(M!==p)throw new Error("Sample-to-Group box with groupingType "+C.groupingType+" has "+M+" samples, but total samples in fragment is "+p)}var I={groups:{}},E=HB.all(a,HB.ofType("sgpd"));if(null!=E)for(var _=0,x=E;_<x.length;_++){var k=x[_];I.groups[k.groupingType]=k}for(var R={trackId:s.trackId,containerSpecificData:I,sampleRuns:[]},A=l.baseMediaDecodeTime,O=null!=c.protectionSchemeType?c.protectionSchemeType:HB.fourCCToNumber(c.fourCC),L=new this.auxiliaryInfoExtractorType(n,r.absoluteStartPosition,O,f,g),F=new this.groupDataExtractorType(d.groups,I.groups,T),D=0,N=0;N<u.length;N++){L.startTrackRun();var U={samples:[]},B=u[N];if(0===N&&null==B.dataOffset)throw new Error("Movie fragment is not using movie-fragment relative addressing: first trun for track "+s.trackId+" does not have a dataOffset");null!=B.dataOffset&&(D=B.dataOffset);for(var V=0;V<B.samples.length;V++){var j=B.samples[V],X=void 0;null!=j.flags?X=j.flags:0===V&&null!=B.firstSampleFlags?X=B.firstSampleFlags:s.defaultSampleFlagsPresent?(X=s.defaultSampleFlags,c.type===oB.VIDEO&&(X|=65536)):X=d.defaultSampleFlags;var z=void 0;z=null!=j.size?j.size:s.defaultSampleSizePresent?s.defaultSampleSize:d.defaultSampleSize;var q=void 0;q=null!=j.duration?j.duration:s.defaultSampleDurationPresent?s.defaultSampleDuration:d.defaultSampleDuration;var W=A,H=W+(null!=j.compositionTimeOffset?j.compositionTimeOffset:0),G=r.absoluteStartPosition+D;G<0&&KB.warn("[neguintarray] Creating a Uint8Array with negative offset: sampleStart is "+G),z<0&&KB.warn("[neguintarray] Create a Uint8Array with negative size: size is "+z);var K=new Uint8Array(n,G,z),Q=L.nextSample(),Y=F.nextSample(),J=WB({},c.baseSample,{dts:W,pts:H,flags:X,duration:q,isCodecPrivateData:!1,data:K,isEncrypted:!1,containerSpecificData:{auxiliaryInfos:Q,groupInformation:Y}});U.samples.push(J),A+=q,D+=z}R.sampleRuns.push(U)}return d.isProtected&&this.protectedStreamProcessor.processTrackMedia(c,R),R},e.prototype.validateCodecs=function(e){if(F.isEmpty(e))throw new Error("Required parameter \"codecs\" is empty");for(var t=0,n=e;t<n.length;t++){var r=n[t];if(null==this.codecDataExtractorSelector.selectExtractor(r))throw new Error("Encountered unknown codec fourCC \""+r+"\"")}return e},e}(),YB={SegmentParserFactory:function(){function e(e){void 0===e&&(e=QB),this.mp4SegmentParserType=e}return e.prototype.createSegmentParser=function(e){var t=this.extractCodecs(e.parameters.codecs);switch(e.subtype){case"mp4":return new this.mp4SegmentParserType(e.parameters,t);default:return null}},e.prototype.extractCodecs=function(e){return null==e?[]:e.split(",").map(function(e){return e.trim().substring(0,4)})},e}(),TrackType:oB},JB=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.decode=function(e){for(var t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=[],r=0;r<t.length;){var i=0,o=0,a=t[r++];if(240==(248&a))i=3,o=7&a;else if(224==(240&a))i=2,o=15&a;else if(192==(224&a))i=1,o=31&a;else{if(0!=(128&a))throw new TypeError("Failed to decode value: "+a.toString(16));i=0,o=127&a}for(;0<i&&r<t.length;)o<<=6,o|=63&t[r++],i--;if(0<i)throw new TypeError("Failed to decode value");if(65536<=o){var s=56320|1023&(o-=65536),l=55296|o>>10&1023;n.push(String.fromCharCode(l,s))}else n.push(String.fromCharCode(o))}return n.join("")},e}();t.Utf8Decoder=n});e(JB);JB.Utf8Decoder;var $B=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8TextDecoder=n,"undefined"!=typeof TextDecoder?t.Utf8TextDecoder=n=function(){return new TextDecoder("utf-8")}:t.Utf8TextDecoder=n=JB.Utf8Decoder});e($B);$B.Utf8TextDecoder;var ZB=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.textDecoder=new $B.Utf8TextDecoder}return e.prototype.decode=function(e){return this.textDecoder.decode(e)},e}();t.TextDecoderCodec=n});e(ZB);ZB.TextDecoderCodec;var eV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.create=function(e){if(-1!==e.indexOf("stpp")||-1!==e.indexOf("wvtt"))return new ZB.TextDecoderCodec;throw new Error("Could not create Codec for mime-type '"+e+"'")},e}();t.CodecFactory=n});e(eV);eV.CodecFactory;var tV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.bufferedRanges=new Rp.NumberLine(.001),this.eventEmitter=new Dt.EventEmitter,this.trackCues=[]}return Object.defineProperty(e.prototype,"cues",{get:function(){return this.trackCues.slice()},enumerable:!0,configurable:!0}),e.prototype.addCue=function(e){this.trackCues.push(e),this.trackCues=F.sortBy(this.cues,function(e){return e.startMs}),this.bufferedRanges.add({start:e.startMs,end:e.endMs}),this.eventEmitter.emit("cueupdate"),this.eventEmitter.emit("newcue",e)},e.prototype.removeCues=function(n,r){var i=this;this.trackCues=this.trackCues.filter(function(e){var t=e.startMs<n||e.endMs>r;return t||i.bufferedRanges.remove({start:e.startMs,end:e.endMs}),t}),this.eventEmitter.emit("cueupdate")},e.prototype.getDataAt=function(t){var e=Mp.binarySearchIndexOf(this.trackCues,function(e){return t<e.startMs?-1:e.startMs<=t&&t<e.endMs?0:1});return-1!==e?this.trackCues[e].data:null},Object.defineProperty(e.prototype,"bufferedIntervalsMs",{get:function(){return this.bufferedRanges.getIntervals()},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e}();t.ApplicationSpecificTrack=n});e(tV);tV.ApplicationSpecificTrack;var nV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("ApplicationSpecificSourceBuffer"),n=function(){function e(e,t){var n=this;this.timer=A.timer,this.sourceBufferEmitter=new Dt.EventEmitter,this.timescale=1,this.trackId=null,this.lastInitSegment=null,this.applicationTrack=new tV.ApplicationSpecificTrack,this.timestampOffset=0,this.updating=!1,this.appendWindowStart=0,this.appendWindowEnd=0,this.mode="segments",this.audioTracks=null,this.textTracks=null,this.videoTracks=null,this.expectedTrackType=t;var r=(new dE.MimeTypeParser).parse(e);if(this.segmentParser=(new YB.SegmentParserFactory).createSegmentParser(r),null===this.segmentParser)throw new Error("Unsupported mimeType: "+r);this.codec=(new eV.CodecFactory).create(e);this.buffered={get length(){return n.timeRanges.getIntervals().length},start:function(e){return n.timeRanges.getIntervals()[e].start},end:function(e){return n.timeRanges.getIntervals()[e].end}},this.timeRanges=this.createNewTimeRanges()}return e.prototype.appendBuffer=function(e){var t=this;try{this.updating=!0;for(var n=this.segmentParser.parse(e,this.lastInitSegment),r=0,i=n;r<i.length;r++){var o=i[r];"init"===o.type?this.processInitSegment(o):"media"===o.type&&this.processMediaSegment(o)}this.timer.setImmediate(function(){t.updating=!1,t.dispatchEvent({type:"update"})})}catch(e){this.mediaError("Failed to append buffer: "+e)}},e.prototype.remove=function(e,t){this.applicationTrack.removeCues(1e3*e,1e3*t),this.timeRanges=this.createNewTimeRanges()},e.prototype.addEventListener=function(e,t){this.sourceBufferEmitter.on(e,t)},e.prototype.removeEventListener=function(e,t){this.sourceBufferEmitter.off(e,t)},e.prototype.dispatchEvent=function(e){return this.sourceBufferEmitter.emit(e.type,e),!1},e.prototype.abort=function(){},e.prototype.appendStream=function(e,t){},e.prototype.processInitSegment=function(e){for(var t=0,n=F.values(e.tracks);t<n.length;t++){var r=n[t];if(r.type===this.expectedTrackType){this.trackId=r.trackId;break}}null!==this.trackId?(this.timescale=e.tracks[this.trackId].timescale,this.lastInitSegment=e):i.warn("Could not find trackId for expected track type "+this.expectedTrackType)},e.prototype.processMediaSegment=function(e){if(null!==this.trackId){var t=e.tracks[this.trackId].sampleRuns[0].samples[0],n=this.timestampOffset+t.dts/this.timescale,r=n+t.duration/this.timescale,i=this.decodeSampleData(t.data);if(null!==i){this.applicationTrack.addCue({startMs:1e3*n,endMs:1e3*r,data:i,timeOffsetMs:1e3*this.timestampOffset}),this.timeRanges.add({start:n,end:r});var o=this.applicationTrack.cues;100<o.length&&(this.applicationTrack.removeCues(o[0].startMs,o[Math.floor(o.length/2)].endMs),this.timeRanges=this.createNewTimeRanges())}}},e.prototype.decodeSampleData=function(e){if(!xt.exists(e))throw new Error("Fragment data is null or undefined");var t=null;try{t=this.codec.decode(e)}catch(e){this.decodeError("Failed to parse fragment: "+e)}return t},e.prototype.decodeError=function(e){this.dispatchEvent({type:"decodeError",message:e})},e.prototype.mediaError=function(e){var t=this;this.timer.setImmediate(function(){t.updating=!1,t.dispatchEventSync({type:"mediaError",message:e})})},e.prototype.createNewTimeRanges=function(){for(var e=new Rp.NumberLine(1e-5),t=0,n=this.applicationTrack.cues;t<n.length;t++){var r=n[t];e.add({start:r.startMs/1e3,end:r.endMs/1e3})}return e},e.prototype.dispatchEventSync=function(e){this.sourceBufferEmitter.emitSync(e.type,e)},e}();t.ApplicationSpecificSourceBuffer=n});e(nV);nV.ApplicationSpecificSourceBuffer;var rV=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(t){function e(e){return t.call(this,e,YB.TrackType.TEXT)||this}return n(e,t),e}(nV.ApplicationSpecificSourceBuffer);t.TimedTextSourceBuffer=i});e(rV);rV.TimedTextSourceBuffer;var iV=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var m=new IR.EphemeralJSLogger("CreateFragmentLoadersHandler"),y=((n={}).Video=150,n.Audio=0,n.TimedText=0,n),r=function(){function e(e,t,n){void 0===n&&(n=WU.FragmentLoader);var h=this;this.eventTrackers={},this.aggregateSourceBufferLoadMonitor=null,this.createFragmentLoaders=function(e){h.stateContext.sourceBuffers={},h.stateContext.fragmentLoaders={};var t=new QU.SlowSegmentLoadBarrier(3e3);h.stateContext.fragmentLoadBarriers={slowSegmentBarrier:t},h.aggregateSourceBufferLoadMonitor=new GU.AggregateSourceBufferLoadMonitor(h.stateContext.bufferedRangesCalculator);for(var n=0,r=Object.keys(e.streamsMetadata);n<r.length;n++){var i=r[n],o=e.streamsMetadata[i],a=o.mimeType+"; codecs=\""+o.codecs+"\"";"Video"===i&&(a+=";max-resolution=\""+o.maxWidth+"x"+o.maxHeight+"\";frame-rate=\""+o.framerate+"\"");var s=void 0;try{if("TimedText"===i){var l=new rV.TimedTextSourceBuffer(a);h.stateContext.textTrackProxy.addTrack(l.applicationTrack),s=l}else s=h.stateContext.mediaSource.addSourceBuffer(a),s=new YU.TimeOffsettingSourceBuffer(s,e.reductionTermSec)}catch(e){m.error("Could not create "+i+" sourceBuffer for "+a+".",e);continue}h.stateContext.sourceBuffers[i]=s;var u=h.createBufferSizeBarrier(h.aggregateSourceBufferLoadMonitor,i),c=new h.fragmentLoaderType(i,h.stateContext.mediaSource,s,h.stateContext.positionTracker,y[i],h.aggregateSourceBufferLoadMonitor,u);h.stateContext.fragmentLoaders[i]=c,h.attachLoaderListeners(c,i)}for(var d=h.stateContext.fragmentLoaders,p=0,f=Object.keys(d);p<f.length;p++){(c=d[i=f[p]]).initialize(),"TimedText"!==i&&t.addFragmentLoader(c)}h.stateContext.playbackQualityProvider.attachLoaders(h.stateContext.fragmentLoaders)},this.destroyFragmentLoaders=function(){h.stateContext.playbackQualityProvider.detachLoaders();var e=h.stateContext.fragmentLoaders;if(null!=e&&null!=h.aggregateSourceBufferLoadMonitor){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];h.detachLoaderListeners(r),e[r].uninitialize(),h.aggregateSourceBufferLoadMonitor.deregisterStreamType(r)}var i=h.stateContext.fragmentLoadBarriers;null!=i&&i.slowSegmentBarrier.destroy(),h.stateContext.sourceBuffers={},h.stateContext.fragmentLoaders={},delete h.stateContext.fragmentLoadBarriers,h.stateContext.textTrackProxy.removeTrack()}},this.onLoaderProgress=function(e){h.stateContext.eventEmitter.emit("progress",e)},this.onLoaderError=function(e){m.error("Loader error:",e),h.stateContext.eventEmitter.emit("nonfatalError",e)},this.onLoaderFatalError=function(e){m.error("Loader fatal error:",e),h.stateMachine.act(mU.MSEWrapperAction.Error,e)},this.onLoaderPositionBump=function(e){h.stateContext.eventEmitter.emit("positionBump",e)},this.stateMachine=e,this.stateMachine.onStateChange(function(e){return m.setId(yU.MSEWrapperState[e])}),this.stateContext=t,this.fragmentLoaderType=n}return e.prototype.initialize=function(){this.stateMachine.onTransition(yU.MSEWrapperState.Initialized,mU.MSEWrapperAction.CreateFragmentLoaders,this.createFragmentLoaders),this.stateMachine.onTransition(yU.MSEWrapperState.Initialized,mU.MSEWrapperAction.Uninitialize,this.destroyFragmentLoaders),this.stateMachine.onTransition(yU.MSEWrapperState.NeedsContent,mU.MSEWrapperAction.Uninitialize,this.destroyFragmentLoaders)},e.prototype.attachLoaderListeners=function(e,t){var n=new Dt.EventTracker(e);(this.eventTrackers[t]=n).on("progress",this.onLoaderProgress),n.on("nonfatalError",this.onLoaderError),n.on("fatalError",this.onLoaderFatalError),n.on("positionBump",this.onLoaderPositionBump)},e.prototype.detachLoaderListeners=function(e){this.eventTrackers[e].removeAllListeners(),delete this.eventTrackers[e]},e.prototype.createBufferSizeBarrier=function(e,t){if("TimedText"===t)return null;var n=xt.nestedValue(Yh.deviceInformation.mediaSource,"maxSourceBufferSizeBytes");if(null===n)return null;if(F.isNumber(n))return new KU.BufferSizeLoadBarrier(t,!1,e,n);var r=xt.nestedValue(n,this.streamTypeToBufferSizeLimitTypeKey(t));return null===r?null:new KU.BufferSizeLoadBarrier(t,!0,e,r)},e.prototype.streamTypeToBufferSizeLimitTypeKey=function(e){switch(e){case"Video":return"video";case"Audio":return"audio";default:return"unknown"}},e}();t.CreateFragmentLoadersHandler=r});e(iV);iV.CreateFragmentLoadersHandler;var oV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=new IR.EphemeralJSLogger("LoadHandler"),n=function(){function e(e,t){var l=this;this.cancelAttach=null,this.contentSource=null,this.wasWaiting=!1,this.isEncrypted=!1,this.eventTrackers={},this.fragmentSources={},this.fragmentSourceUpdateCallbacks={},this.finalFragmentAppended={},this.isWaitingMap={},this.attachContent=function(i){var e=Fe.CancelToken.source(),r=e.token,t=e.cancel;l.cancelAttach=t,(l.contentSource=i).isEncrypted().then(function(e){if(r.throwIfRequested(),null!=l.stateContext.mediaSource.configure&&l.stateContext.mediaSource.configure({contentMayBeEncrypted:e}),e)return l.stateContext.drmController.mediaKeysSet}).then(function(){r.throwIfRequested(),i.on("streamChange",l.onStreamChange),i.on("streamRestrictionChange",l.onStreamRestrictionChange),l.stateContext.mediaSource.duration=i.getDurationMs()/1e3;for(var e=function(e){var t=l.stateContext.fragmentLoaders[e];if(null==t)return"continue";var n=i.getFragmentSource(e),r=function(){return l.onSourceUpdate(e)};l.fragmentSourceUpdateCallbacks[e]=r,n.onUpdate(r),l.fragmentSources[e]=n,"TimedText"===e?t.prepare():t.prepare([l.stateContext.fragmentLoadBarriers.slowSegmentBarrier]),t.attachContent(n),l.isWaitingMap[e]=!0,l.finalFragmentAppended[e]=!1,l.attachLoaderListeners(t,e)},t=0,n=i.streamTypes;t<n.length;t++){e(n[t])}l.wasWaiting=!0,l.stateContext.positionTracker.prepare(i,l.stateContext.fragmentLoaders),l.stateContext.bufferedRangesCalculator.setContent(i,l.stateContext.fragmentLoaders),l.stateMachine.act(mU.MSEWrapperAction.Ready),l.stateContext.eventEmitter.emit("attachedContent")}).catch(function(e){e instanceof Fe.CancelError||l.stateMachine.act(mU.MSEWrapperAction.Error,e)})},this.detachContent=function(e){null!==l.cancelAttach&&(l.cancelAttach(),l.cancelAttach=null),l.stateContext.positionTracker.stop(),l.stateContext.bufferedRangesCalculator.clearContent();for(var t=l.contentSource,n=0,r=t.streamTypes;n<r.length;n++){var i=r[n];l.detachLoaderListeners(i)}var o=l.stateContext.fragmentLoaders;for(var i in o){if(o.hasOwnProperty(i))o[i].stop()}for(var a in l.fragmentSources)if(l.fragmentSources.hasOwnProperty(a)){var s=l.fragmentSourceUpdateCallbacks[a];l.fragmentSources[a].offUpdate(s)}l.fragmentSources={},l.fragmentSourceUpdateCallbacks={},l.isWaitingMap={},l.finalFragmentAppended={},t.off("streamChange",l.onStreamChange),t.off("streamRestrictionChange",l.onStreamRestrictionChange),l.contentSource=null,l.stateContext.eventEmitter.emit("detachedContent")},this.onSourceUpdate=function(e){l.stateContext.fragmentLoaders[e].updatePosition()},this.onLoaderIdle=function(){if(null!==l.contentSource){for(var e=!0,t=!0,n=0,r=iE.CRITICAL_STREAM_TYPES;n<r.length;n++){var i=r[n],o=l.stateContext.fragmentLoaders[i];null!=o&&(e=e&&!o.isUpdating(),t=t&&l.finalFragmentAppended[i])}if(t&&e){if("open"!==l.stateContext.mediaSource.readyState)return;a.info("All final fragments appended and all loaders are idle. Signaling end of stream"),l.stateContext.mediaSource.endOfStream(),l.stateContext.eventEmitter.emit("loadedToEnd")}}},this.onLoaderWaiting=function(e){l.isWaitingMap[e]=!0,l.wasWaiting||(l.wasWaiting=!0,l.stateContext.eventEmitter.emit("waiting"))},this.onLoaderFlushed=function(e){l.finalFragmentAppended[e]=!1},this.onFinalFragmentLoaded=function(e){a.info("Loader for type "+e+" has finished"),l.finalFragmentAppended[e]=!0},this.onLoaderBuffered=function(e){l.isWaitingMap[e]=!1,l.checkLoadersBuffered()},this.checkLoadersBuffered=function(){var e=l.isWaiting();l.wasWaiting&&!e&&(l.wasWaiting=!1,l.stateContext.eventEmitter.emit("buffered"))},this.onLoaderEncrypted=function(){l.isEncrypted||(l.isEncrypted=!0,l.stateContext.eventEmitter.emit("encrypted"))},this.onStreamChange=function(e){var t=l.stateContext.fragmentLoaders[e];null!=t?null!=l.contentSource?(t.reset(),l.stateContext.positionTracker.update(),l.checkLoadersBuffered(),F.contains(l.contentSource.activeStreamTypes,e)||l.stateContext.playbackQualityProvider.removeCurrentQualityInfo(e)):a.warn("Received a "+e+" 'streamChange' without an existent ContentSource"):a.warn("Received a "+e+" 'streamChange' without an existent FragmentLoader")},this.onStreamRestrictionChange=function(e){var t=e.streamType,n=l.stateContext.fragmentLoaders[t],r=l.contentSource;null!=n?null!=r?0!==e.restrictions.length?l.stateContext.playbackQualityProvider.validateQualities(e.streamType,r).then(function(e){r===l.contentSource?e||(a.info(t+" source buffer contains invalid qualities."),n.reset(),l.stateContext.positionTracker.update()):a.warn("ContentSource already changed before "+t+" buffer validity check completes.")}):a.info(t+" stream is not restricted."):a.warn("Received a "+t+" 'streamRestrictionChange' without an existent ContentSource"):a.warn("Received a "+t+" 'streamRestrictionChange' without an existent FragmentLoader")},this.stateMachine=e,this.stateMachine.onStateChange(function(e){return a.setId(yU.MSEWrapperState[e])}),this.stateContext=t}return e.prototype.initialize=function(){this.stateMachine.onTransition(yU.MSEWrapperState.NeedsContent,mU.MSEWrapperAction.AttachContent,this.attachContent),this.stateMachine.onTransition(yU.MSEWrapperState.Loading,mU.MSEWrapperAction.DetachContent,this.detachContent),this.stateMachine.onTransition(yU.MSEWrapperState.Ready,mU.MSEWrapperAction.DetachContent,this.detachContent),this.stateMachine.onTransition(yU.MSEWrapperState.Error,mU.MSEWrapperAction.DetachContent,this.detachContent)},e.prototype.attachLoaderListeners=function(e,t){var n=this,r=this.eventTrackers[t]=new Dt.EventTracker(e);r.on("flushed",function(){return n.onLoaderFlushed(t)}),r.on("finalFragmentLoaded",function(){return n.onFinalFragmentLoaded(t)}),r.on("idle",this.onLoaderIdle),r.on("waiting",function(){return n.onLoaderWaiting(t)}),r.on("buffered",function(){return n.onLoaderBuffered(t)}),r.on("encrypted",this.onLoaderEncrypted),r.on("fragmentConsumed",function(e){return n.onLoaderFragmentConsumed(t,e)})},e.prototype.detachLoaderListeners=function(e){var t=this.eventTrackers[e];null!=t&&(t.removeAllListeners(),delete this.eventTrackers[e])},e.prototype.isWaiting=function(){if(null===this.contentSource)return!0;for(var e=!1,t=0,n=this.contentSource.streamTypes;t<n.length;t++){var r=n[t];"TimedText"!==r&&(e=e||this.isWaitingMap[r])}return e},e.prototype.onLoaderFragmentConsumed=function(e,t){this.fragmentSources[e].fragmentConsumed(t)},e}();t.LoadHandler=n});e(oV);oV.LoadHandler;var aV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.setContent=function(e,t){this.content=e,this.fragmentLoaders=t},e.prototype.clearContent=function(){delete this.content,delete this.fragmentLoaders},e.prototype.getBufferedRanges=function(e){if(null==this.content||null==this.fragmentLoaders)return new Rp.NumberLine;null==e?e=this.content.streamTypes:Array.isArray(e)||(e=[e]);for(var t=null,n=0,r=e;n<r.length;n++){var i=r[n],o=this.fragmentLoaders[i];if(null!=o){var a=o.getBufferedRanges();t=null!=t?t.intersection(a):a}}return null!=t?t:new Rp.NumberLine},e}();t.BufferedRangesCalculator=n});e(aV);aV.BufferedRangesCalculator;var sV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.contentSource=null,this.fragmentLoaders={},this.getPositionMs=e}return e.prototype.prepare=function(e,t){this.contentSource=e,this.fragmentLoaders=t,this.updateFragmentLoaders()},e.prototype.stop=function(){this.contentSource=null,this.fragmentLoaders={}},e.prototype.update=function(){this.updateFragmentLoaders()},e.prototype.updateFragmentLoaders=function(){if(null!=this.contentSource&&null!=this.fragmentLoaders)for(var e=0,t=this.contentSource.activeStreamTypes;e<t.length;e++){var n=t[e],r=this.fragmentLoaders[n];null!=r&&r.updatePosition()}},e}();t.PositionTracker=n});e(sV);sV.PositionTracker;var lV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("TrackProxy"),r=function(){function e(){this.multiplexedEventSource=new Dt.MultiplexedEventSource,this.track=null}return e.prototype.addTrack=function(e){null===this.track?(this.track=e,this.multiplexedEventSource.addSource("1",e),this.multiplexedEventSource.selectSource("1")):n.warn("Cannot currently handle multiple concurrent text tracks. Ignoring new track")},e.prototype.removeTrack=function(){xt.exists(this.track)&&this.multiplexedEventSource.removeSource("1"),this.track=null},Object.defineProperty(e.prototype,"cues",{get:function(){return null!==this.track?this.track.cues:[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedIntervalsMs",{get:function(){return null!==this.track?this.track.bufferedIntervalsMs:[]},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){this.multiplexedEventSource.on(e,t)},e.prototype.off=function(e,t){this.multiplexedEventSource.off(e,t)},e}();t.TrackProxy=r});e(lV);lV.TrackProxy;var uV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=new IR.EphemeralJSLogger("ContentLevelAdapterMSE"),n=function(){function e(e,t,n,r){var i=this;this.error=null,this.bufferedRangesCalculator=new aV.BufferedRangesCalculator,this.eventEmitter=new Dt.EventEmitter,this.onInitialized=function(){i.eventEmitter.emit("initialized")},this.onUninitialized=function(){i.eventEmitter.emit("uninitialized")},this.onNeedsContent=function(){i.eventEmitter.emit("needsContent")},this.onReady=function(){i.eventEmitter.emit("ready")},this.mediaPlayer=e,this.positionTracker=new sV.PositionTracker(r),this.textTrack=new lV.TrackProxy,this.stateContext={mediaPlayer:e,playbackQualityProvider:n,drmController:t,eventEmitter:this.eventEmitter,positionTracker:this.positionTracker,bufferedRangesCalculator:this.bufferedRangesCalculator,textTrackProxy:this.textTrack},this.stateMachine=new $k.FiniteStateMachine(yU.MSEWrapperState.Uninitialized),this.stateMachine.onStateChange(function(e){return c.setId(yU.MSEWrapperState[e])}),this.stateMachine.addTransition(yU.MSEWrapperState.Uninitialized,mU.MSEWrapperAction.Initialize,yU.MSEWrapperState.Initializing),this.stateMachine.addTransition(yU.MSEWrapperState.Initializing,mU.MSEWrapperAction.Initialized,yU.MSEWrapperState.Initialized),this.stateMachine.addTransition(yU.MSEWrapperState.Initialized,mU.MSEWrapperAction.CreateFragmentLoaders,yU.MSEWrapperState.NeedsContent),this.stateMachine.addTransition(yU.MSEWrapperState.NeedsContent,mU.MSEWrapperAction.AttachContent,yU.MSEWrapperState.Loading),this.stateMachine.addTransition(yU.MSEWrapperState.Loading,mU.MSEWrapperAction.Ready,yU.MSEWrapperState.Ready),this.stateMachine.addTransition(yU.MSEWrapperState.Initializing,mU.MSEWrapperAction.Uninitialize,yU.MSEWrapperState.Uninitialized),this.stateMachine.addTransition(yU.MSEWrapperState.Initialized,mU.MSEWrapperAction.Uninitialize,yU.MSEWrapperState.Uninitialized),this.stateMachine.addTransition(yU.MSEWrapperState.NeedsContent,mU.MSEWrapperAction.Uninitialize,yU.MSEWrapperState.Uninitialized),this.stateMachine.addTransition(yU.MSEWrapperState.Loading,mU.MSEWrapperAction.DetachContent,yU.MSEWrapperState.NeedsContent),this.stateMachine.addTransition(yU.MSEWrapperState.Ready,mU.MSEWrapperAction.DetachContent,yU.MSEWrapperState.NeedsContent),this.stateMachine.addTransition(yU.MSEWrapperState.Uninitialized,mU.MSEWrapperAction.Error,yU.MSEWrapperState.Error),this.stateMachine.addTransition(yU.MSEWrapperState.Initializing,mU.MSEWrapperAction.Error,yU.MSEWrapperState.Error),this.stateMachine.addTransition(yU.MSEWrapperState.Initialized,mU.MSEWrapperAction.Error,yU.MSEWrapperState.Error),this.stateMachine.addTransition(yU.MSEWrapperState.NeedsContent,mU.MSEWrapperAction.Error,yU.MSEWrapperState.Error),this.stateMachine.addTransition(yU.MSEWrapperState.Loading,mU.MSEWrapperAction.Error,yU.MSEWrapperState.Error),this.stateMachine.addTransition(yU.MSEWrapperState.Ready,mU.MSEWrapperAction.Error,yU.MSEWrapperState.Error),this.stateMachine.addTransition(yU.MSEWrapperState.Error,mU.MSEWrapperAction.Error,yU.MSEWrapperState.Error),this.stateMachine.addTransition(yU.MSEWrapperState.Error,mU.MSEWrapperAction.DetachContent,yU.MSEWrapperState.Error),this.stateMachine.addTransition(yU.MSEWrapperState.Error,mU.MSEWrapperAction.Uninitialize,yU.MSEWrapperState.Uninitialized);for(var o=0,a=[yU.MSEWrapperState.Uninitialized,yU.MSEWrapperState.Initializing,yU.MSEWrapperState.Initialized,yU.MSEWrapperState.NeedsContent,yU.MSEWrapperState.Loading,yU.MSEWrapperState.Ready,yU.MSEWrapperState.Error];o<a.length;o++){var s=a[o];this.stateMachine.onEnterState(s,function(){return null}),this.stateMachine.onTransition(s,mU.MSEWrapperAction.Error,function(e){i.error=e})}for(var l=0,u=[new VU.InitializeHandler(this.stateMachine,this.stateContext),new iV.CreateFragmentLoadersHandler(this.stateMachine,this.stateContext),new oV.LoadHandler(this.stateMachine,this.stateContext)];l<u.length;l++){u[l].initialize()}this.stateMachine.onEnterState(yU.MSEWrapperState.Initialized,this.onInitialized),this.stateMachine.onEnterState(yU.MSEWrapperState.Uninitialized,this.onUninitialized),this.stateMachine.onEnterState(yU.MSEWrapperState.NeedsContent,this.onNeedsContent),this.stateMachine.onEnterState(yU.MSEWrapperState.Ready,this.onReady),this.stateMachine.onEnterState(yU.MSEWrapperState.Error,function(){var e=i.error;null===e&&(e=new Error("ContentLevelAdapterMSE went to Error state without an error set")),c.error("StateMachineError:",e),i.eventEmitter.emit("fatalError",e)}),this.stateMachine.onLeaveState(yU.MSEWrapperState.Error,function(){i.error=null}),this.stateMachine.onIllegalTransition(function(e,t,n){c.error("IllegalTransitionError from action ["+mU.MSEWrapperAction[t]+"] while in state ["+yU.MSEWrapperState[e]+"]")})}return e.prototype.initialize=function(){this.stateMachine.act(mU.MSEWrapperAction.Initialize)},e.prototype.terminate=function(){this.detachContent(),this.stateMachine.act(mU.MSEWrapperAction.Uninitialize)},e.prototype.prepare=function(e,t){this.stateMachine.act(mU.MSEWrapperAction.CreateFragmentLoaders,{streamsMetadata:e,reductionTermSec:t})},e.prototype.attachContent=function(e){this.stateMachine.act(mU.MSEWrapperAction.AttachContent,e)},e.prototype.detachContent=function(){this.stateMachine.act(mU.MSEWrapperAction.DetachContent)},e.prototype.onPosition=function(){this.positionTracker.update()},e.prototype.flushStream=function(e){var t=this.stateContext;null!=t.fragmentLoaders&&null!=t.fragmentLoaders[e]&&t.fragmentLoaders[e].reset()},e.prototype.getBufferedRanges=function(e){return this.bufferedRangesCalculator.getBufferedRanges(e)},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e}();t.ContentLevelAdapterMSE=n});e(uV);uV.ContentLevelAdapterMSE;var cV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("MpPlayerPlaybackQualityProvider"),n=function(){function e(e){var i=this;this.currentPlayingQualities={},this.fragmentLoaderEventTrackers={},this.loaderFlushedHandlers={},this.loaders=null,this.pendingQualities={},this.qualitiesValidationCancelCallbacks={},this.qualityCallbacks={},this.onFragmentConsumed=function(e){var t=e.type,n={type:t,periodId:e.periodId,streamId:e.streamId,qualityLevelId:e.qualityLevelId,startTimeMs:e.position.startTimeMs,endTimeMs:e.position.endTimeMs,bitrateBitsPerSec:e.bitrateBps},r=i.currentPlayingQualities[t];!r||r.startTimeMs!==n.startTimeMs||r.endTimeMs!==n.endTimeMs||r.periodId===n.periodId&&r.streamId===n.streamId&&r.qualityLevelId===n.qualityLevelId||(i.currentPlayingQualities[t]=n,i.qualityCallbacks[t]&&i.qualityCallbacks[t].invoke(i.currentPlayingQualities[t])),i.pendingQualities[t].push(n)},this.onLoaderProgress=function(t){null!==t.backBufferStartSeconds&&(i.pendingQualities[t.fragment.type]=i.pendingQualities[t.fragment.type].filter(function(e){return e.endTimeMs/1e3>t.backBufferStartSeconds}))},this.mediaPlayer=e}return e.prototype.attachLoaders=function(e){var r=this;this.loaders=e;for(var t=function(e){var t=e;i.pendingQualities[e]=[];var n=new Dt.EventTracker(i.loaders[e]);i.fragmentLoaderEventTrackers[t]=n,i.loaderFlushedHandlers[t]=function(){r.onLoaderFlushed(t)},n.on("flushed",i.loaderFlushedHandlers[t]),n.on("fragmentConsumed",i.onFragmentConsumed),n.on("progress",i.onLoaderProgress)},i=this,n=0,o=Object.keys(e);n<o.length;n++){t(o[n])}},e.prototype.detachLoaders=function(){if(null!==this.loaders){for(var e=0,t=Object.keys(this.loaders);e<t.length;e++){var n=o=t[e];this.fragmentLoaderEventTrackers[n].removeAllListeners(),delete this.fragmentLoaderEventTrackers[n]}for(var r=0,i=Object.keys(this.qualitiesValidationCancelCallbacks);r<i.length;r++){var o=i[r],a=this.qualitiesValidationCancelCallbacks[o];null!=a&&a()}this.loaders=null,this.currentPlayingQualities={},this.loaderFlushedHandlers={},this.pendingQualities={},this.qualitiesValidationCancelCallbacks={}}},e.prototype.getCurrentPeriod=function(){return null!=this.currentPlayingQualities.Video?this.currentPlayingQualities.Video.periodId:null},e.prototype.getCurrentQualityInfo=function(e){return xt.withDefault(this.currentPlayingQualities[e],null)},e.prototype.getVideoDecodePerformance=function(){return this.mediaPlayer.getVideoPlaybackQuality()},e.prototype.validateQualities=function(t,n){var r=this,e=this.qualitiesValidationCancelCallbacks[t];null!=e&&(e(),this.qualitiesValidationCancelCallbacks[t]=null);var i=[];null!=this.pendingQualities[t]&&(i=this.pendingQualities[t].map(function(e){return n.isSegmentQualityValid(e.type,e.periodId,e.streamId,e.qualityLevelId)}));var o=this.currentPlayingQualities[t];if(null!=o&&i.push(n.isSegmentQualityValid(o.type,o.periodId,o.streamId,o.qualityLevelId)),0===i.length)return Fe.Promise.resolve(!0);var a=Fe.CancelToken.source(),s=a.token,l=a.cancel;return this.qualitiesValidationCancelCallbacks[t]=l,Fe.Promise.all(i).then(function(e){return s.throwIfRequested(),r.qualitiesValidationCancelCallbacks[t]=null,e.every(function(e){return e})}).catch(function(e){return e instanceof Fe.CancelError||u.error(e.message),!0})},e.prototype.onPosition=function(e){if(null!==this.loaders)for(var t=0,n=Object.keys(this.loaders);t<n.length;t++){var r=n[t],i=this.currentPlayingQualities[r];if(!i||e>=i.endTimeMs||e<i.startTimeMs)for(var o=0,a=this.pendingQualities[r];o<a.length;o++){var s=a[o];if(e>=s.startTimeMs-1&&e<s.endTimeMs){var l=!i||s.periodId!==i.periodId||s.streamId!==i.streamId||s.qualityLevelId!==i.qualityLevelId;this.currentPlayingQualities[r]=s,l&&this.qualityCallbacks[r]&&this.qualityCallbacks[r].invoke(this.currentPlayingQualities[r])}}}},e.prototype.on=function(e,t,n){"qualityLevel"===t&&(null==this.qualityCallbacks[e]&&(this.qualityCallbacks[e]=new Dt.MulticastCallback),this.qualityCallbacks[e].add(n))},e.prototype.off=function(e,t,n){"qualityLevel"===t&&null!=this.qualityCallbacks[e]&&this.qualityCallbacks[e].remove(n)},e.prototype.onStreamGroupChange=function(e){},e.prototype.offStreamGroupChange=function(e){},e.prototype.removeCurrentQualityInfo=function(e){delete this.currentPlayingQualities[e],this.pendingQualities[e]=[],null!=this.qualityCallbacks[e]&&this.qualityCallbacks[e].invoke(null)},e.prototype.onLoaderFlushed=function(e){this.pendingQualities[e]=[]},e}();t.MpPlayerPlaybackQualityProvider=n});e(cV);cV.MpPlayerPlaybackQualityProvider;var dV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("LocalLicenseLoader"),s={previouslyRequested:!1,keyMetadata:null},n=function(){function e(e,t){this.usePersistentSession=t,this.contentLoadPromise=null,this.licenseMetadataList=[],this.licenseRequested={},this.mediaKeysManager=e}return e.prototype.load=function(e){var n=this;if(void 0===e&&(e=null),null!=e&&RI.metadataStorage.capabilities.isSupported&&this.usePersistentSession){null!=this.contentLoadPromise&&(a.warn("New content is loaded without unloading the previous content"),this.contentLoadPromise=null);var t=b_.createPersistentLicenseMetadataKey(e);this.contentLoadPromise=RI.metadataStorage.get(t).then(function(e){if(null!=e){var t=e;n.licenseMetadataList=t.metadataList}})}},e.prototype.unload=function(){this.contentLoadPromise=null,this.licenseMetadataList=[],this.licenseRequested={}},e.prototype.loadLicenseAndKeyMetadata=function(e,n){var r=this;if(null==this.contentLoadPromise)return Fe.Promise.resolve(s);var i=null,o=null;return this.contentLoadPromise.then(function(){return n.throwIfRequested(),r.mediaKeysManager.extractKeyId(e)}).then(function(e){n.throwIfRequested(),o=e;var t=r.findMetadata(e);return null!=t&&(i=t,r.mediaKeysManager.loadLicense(i.sessionId))}).then(function(e){if(n.throwIfRequested(),e&&null!=i){var t={previouslyRequested:null!=r.licenseRequested[i.sessionId],keyMetadata:i.keyMetadata};return r.licenseRequested[i.sessionId]=!0,t}return s}).catch(function(e){return e instanceof Fe.CancelError||a.error("Fail to load license of keyId "+o,e),s})},e.prototype.findMetadata=function(t){return F.find(this.licenseMetadataList,function(e){return e.keyId===t})},e}();t.LocalLicenseLoader=n});e(dV);dV.LocalLicenseLoader;var pV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("DrmController"),n=function(){function e(e,t){var r=this;this.internalMediaKeysSet=null,this.cancelSetMediaKeys=null,this.contentCancelTokenPair=null,this.keySystemInternalCode=null,this.contentSource=null,this.initDataAppliedSessionIds={},this.onEncryptedEvent=function(t){if(null===r.mediaKeysManager.getKeyMetadata(t.initData)&&null!=r.contentCancelTokenPair){var n=r.contentCancelTokenPair.token;r.localLicenseLoader.loadLicenseAndKeyMetadata(t.initData,n).then(function(e){n.throwIfRequested(),null==r.contentSource||e.previouslyRequested||(null!=e.keyMetadata?r.contentSource.setKeyMetadata(e.keyMetadata):r.applyInitData(t.initDataType,t.initData))}).catch(function(e){e instanceof Fe.CancelError||l.error("Fail to load local license in encrypted event",e)})}},this.onLicenseAcquired=function(e){null!==r.contentSource&&r.contentSource.setKeyMetadata(e.keyMetadata)},this.onMediaKeysManagerError=function(e){var t=r.convertError(e);r.eventEmitter.emit("fatalError",t)},this.mediaPlayer=e,this.mediaKeysManager=new tx.MediaKeysManager(t),this.eventEmitter=new Dt.EventEmitter,this.mediaKeysSetDeferred=new Fe.Deferred,this.hdcpStore=t;var n=up.configurationStore.configuration;this.usePersistentSession=null!=n&&null!=n.drm&&!0===n.drm.usePersistentSession,this.localLicenseLoader=new dV.LocalLicenseLoader(this.mediaKeysManager,this.usePersistentSession)}return e.prototype.reset=function(){this.unload(),null!=this.cancelSetMediaKeys&&(this.cancelSetMediaKeys(),this.cancelSetMediaKeys=null),this.keySystemInternalCode=null,this.mediaKeysManager.reset(),this.mediaPlayer.setMediaKeys(null),this.internalMediaKeysSet=null,this.mediaKeysSetDeferred.reject(new Fe.CancelError),this.mediaKeysSetDeferred=new Fe.Deferred},e.prototype.load=function(o){var a=this;this.contentSource=o,this.contentCancelTokenPair=Fe.CancelToken.source(),this.mediaPlayer.on("encrypted",this.onEncryptedEvent),this.mediaKeysManager.on("licenseAcquired",this.onLicenseAcquired),this.mediaKeysManager.on("error",this.onMediaKeysManagerError),this.localLicenseLoader.load(o.downloadOperationId);var s=this.contentCancelTokenPair.token;o.isEncrypted().then(function(e){if(s.throwIfRequested(),e){null==a.internalMediaKeysSet&&(a.internalMediaKeysSet=a.setMediaKeys());for(var r=[],t=function(t){var e=a.mediaKeysManager.getKeyMetadata(t.data);if(null!==a.contentSource&&null!==e)a.contentSource.setKeyMetadata(e),r.push(Fe.Promise.resolve());else{var n=a.localLicenseLoader.loadLicenseAndKeyMetadata(t.data,s).then(function(e){s.throwIfRequested(),null==a.contentSource||e.previouslyRequested||(null!=e.keyMetadata?a.contentSource.setKeyMetadata(e.keyMetadata):a.applyInitData(t.type,t.data))});r.push(n)}},n=0,i=o.getInitializationData();n<i.length;n++){t(i[n])}return Fe.Promise.all(r).then(function(){})}}).catch(function(e){if(!(e instanceof Fe.CancelError)){l.error("Failure to handle potentially encrypted content",e);var t=a.convertError(e);a.eventEmitter.emit("fatalError",t)}})},e.prototype.unload=function(){var e=this;if(this.mediaPlayer.off("encrypted",this.onEncryptedEvent),this.mediaKeysManager.off("licenseAcquired",this.onLicenseAcquired),this.mediaKeysManager.off("error",this.onMediaKeysManagerError),this.usePersistentSession){for(var n=[],t=function(t){n.push(r.mediaKeysManager.removeLicense(t).catch(function(e){l.warn("Error occurs when session "+t+" removing license before unloading. Ignoring.",e)}))},r=this,i=0,o=Object.keys(this.initDataAppliedSessionIds);i<o.length;i++){t(o[i])}var a=this.contentSource;Fe.Promise.all(n).then(function(){null!=e.contentSource&&e.contentSource!==a||e.mediaKeysManager.reset()})}else this.mediaKeysManager.reset();this.initDataAppliedSessionIds={},this.localLicenseLoader.unload(),null!=this.contentCancelTokenPair&&(this.contentCancelTokenPair.cancel(),this.contentCancelTokenPair=null),this.contentSource=null},Object.defineProperty(e.prototype,"mediaKeysSet",{get:function(){return this.mediaKeysSetDeferred.promise},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.setMediaKeys=function(){var n=this,e=Fe.CancelToken.source(),t=e.token,r=e.cancel;return this.cancelSetMediaKeys=r,tx.MediaKeysManager.getMediaKeys().then(function(e){return t.throwIfRequested(),n.keySystemInternalCode=n.getInternalCodeFromKeySystem(e.system),n.mediaPlayer.setMediaKeys(e.mediaKeys)}).then(function(){t.throwIfRequested(),n.mediaKeysSetDeferred.resolve()}).catch(function(e){if(e instanceof Fe.CancelError)throw e;n.mediaKeysSetDeferred.reject(e),l.error("Failed to set MediaKeys with encrypted content",e);var t=n.convertError(e);throw n.eventEmitter.emit("fatalError",t),e})},e.prototype.getInternalCodeFromKeySystem=function(e){return 0===e.indexOf("com.microsoft.playready")?"playready":"com.widevine.alpha"===e?"widevine":null},e.prototype.applyInitData=function(e,t){var n=this;if(null!==this.contentSource){null==this.internalMediaKeysSet&&(this.internalMediaKeysSet=this.setMediaKeys());var r=this.contentCancelTokenPair.token;this.internalMediaKeysSet.then(function(){r.throwIfRequested();n.mediaKeysManager.applyInitData(e,t,function(e,t){return r.requested?Fe.Promise.reject(new Fe.CancelError):n.contentSource.getLicense(e,t,r)},n.usePersistentSession).then(function(e){null!=e&&null==n.initDataAppliedSessionIds[e]&&(n.initDataAppliedSessionIds[e]=!0)}).catch(function(e){if(e instanceof Fe.CancelError)throw e;l.error("Failed to apply initialization data",e);var t=n.convertError(e);n.eventEmitter.emit("fatalError",t)})})}else l.error("Found encrypted content without a content source")},e.prototype.convertError=function(e){if(e instanceof Ne.XpError&&-1!==e.code.indexOf("xp.system"))return e;var t=null!==this.keySystemInternalCode?"drm."+this.keySystemInternalCode:"drm";return Ne.XpError.generatePrefixedError(e,t)},e}();t.DrmController=n});e(pV);pV.DrmController;var fV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});M.get("PlaybackQualityMonitor");var n=function(){function e(e){this.eventEmitter=new Dt.EventEmitter,this.lastVideoPlaybackQuality=null,this.monitorIntervalId=null,this.timer=A.timer,this.playbackQualityProvider=e}return e.prototype.start=function(){var i=this;null===this.monitorIntervalId&&(this.lastVideoPlaybackQuality=this.playbackQualityProvider.getVideoDecodePerformance(),this.monitorIntervalId=this.timer.setInterval(function(){var e=i.playbackQualityProvider.getVideoDecodePerformance();if(null!==i.lastVideoPlaybackQuality&&null!==e&&-1!==i.lastVideoPlaybackQuality.totalVideoFrames&&-1!==e.totalVideoFrames){var t=e.droppedVideoFrames-i.lastVideoPlaybackQuality.droppedVideoFrames,n=e.totalVideoFrames-i.lastVideoPlaybackQuality.totalVideoFrames,r=e.creationTime-i.lastVideoPlaybackQuality.creationTime;(0<t||0<n)&&i.eventEmitter.emit("frameCountChange",{framesDropped:t,framesDecoded:n,periodMs:r}),i.lastVideoPlaybackQuality=e}else i.lastVideoPlaybackQuality=e},250))},e.prototype.stop=function(){null!==this.monitorIntervalId&&(this.timer.clearInterval(this.monitorIntervalId),this.monitorIntervalId=null)},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e}();t.PlaybackQualityMonitor=n});e(fV);fV.PlaybackQualityMonitor;var hV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.windowRatioTracker=new Rp.WindowSampleTracker(e),this.runningRatioTracker=new Rp.RunningSampleTracker}return e.prototype.addSample=function(e,t){var n=e/t;this.runningRatioTracker.addSample(n),this.windowRatioTracker.addSample(n)},e}();t.SourceBufferAppendTimeTracker=n});e(hV);hV.SourceBufferAppendTimeTracker;var mV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("AppendTimeBitrateFilterManager"),n=function(){function e(e){var o=this;if(this.contentSource=null,this.lastAppendedVideoBitrateBitsPerSec=null,this.maxBitrateCapBitsPerSec=null,this.onSegmentAppended=function(e){if(null!==o.contentSource){var t=e.appendTimeMs,n=e.fragment.position.durationMs,r=e.fragment.type;400<t&&a.warn("["+r+"] SourceBuffer.appendBuffer took "+t+"ms to complete"),"Video"===r&&(o.lastAppendedVideoBitrateBitsPerSec=e.fragment.bitrateBps);var i=o.perStreamTracker[r];i.addSample(t,n),"Video"!==r&&"Audio"!==r||o.aggregateNativeSourceBufferTracker.addSample(t,n),o.checkTracker(o.aggregateNativeSourceBufferTracker,o.contentSource,"Tracker.Aggregate"),"Video"===r&&o.checkTracker(i,o.contentSource,"Tracker.Video")}},this.contentLevelAdapter=e,this.aggregateNativeSourceBufferTracker=new hV.SourceBufferAppendTimeTracker(5),this.perStreamTracker=this.createNewPerStreamTrackers(),this.enableBitrateFiltering=!1,this.appendTimeFilterRatio=1,this.bitrateFloorBitsPerSec=2e6,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.qualityFilters&&null!=up.configurationStore.configuration.qualityFilters.appendTimeRatio){var t=up.configurationStore.configuration.qualityFilters.appendTimeRatio;this.enableBitrateFiltering=t.enabled,null!=t.appendTimeFilterRatio&&(this.appendTimeFilterRatio=t.appendTimeFilterRatio),null!=t.filterBitrateFloorBitsPerSec&&(this.bitrateFloorBitsPerSec=t.filterBitrateFloorBitsPerSec)}}return e.prototype.load=function(e){this.contentSource=e,null!==this.maxBitrateCapBitsPerSec&&e.setMaxBitrateThreshold("Video","AppendTimeRatio",this.maxBitrateCapBitsPerSec),this.contentLevelAdapter.on("progress",this.onSegmentAppended)},e.prototype.unload=function(){this.contentLevelAdapter.off("progress",this.onSegmentAppended),this.reportSessionAppendTimeRatioMetrics(),this.aggregateNativeSourceBufferTracker=new hV.SourceBufferAppendTimeTracker(5),this.perStreamTracker=this.createNewPerStreamTrackers(),this.contentSource=null,this.lastAppendedVideoBitrateBitsPerSec=null},e.prototype.getWindowedSamples=function(e){return this.perStreamTracker[e].windowRatioTracker.getSamples()},e.prototype.checkTracker=function(e,t,n){if(this.enableBitrateFiltering&&!(e.windowRatioTracker.size()<5)&&null!==this.lastAppendedVideoBitrateBitsPerSec){var r=e.windowRatioTracker.average();r>this.appendTimeFilterRatio&&this.lastAppendedVideoBitrateBitsPerSec>this.bitrateFloorBitsPerSec&&(null===this.maxBitrateCapBitsPerSec||this.lastAppendedVideoBitrateBitsPerSec<this.maxBitrateCapBitsPerSec)&&(a.warn(n+" AppendTimeRatio is "+r.toFixed(3)+" (> "+this.appendTimeFilterRatio+"). Capping video to below "+this.lastAppendedVideoBitrateBitsPerSec+" bits/sec"),this.maxBitrateCapBitsPerSec=this.lastAppendedVideoBitrateBitsPerSec-1,t.setMaxBitrateThreshold("Video","AppendTimeRatio",this.maxBitrateCapBitsPerSec),e.windowRatioTracker.reset(),MT.metrics.putMetric("StreamRestriction.AppendTimeRatioQualityFilter",this.maxBitrateCapBitsPerSec))}},e.prototype.createNewPerStreamTrackers=function(){var e;return(e={}).Audio=new hV.SourceBufferAppendTimeTracker(5),e.TimedText=new hV.SourceBufferAppendTimeTracker(5),e.Video=new hV.SourceBufferAppendTimeTracker(5),e},e.prototype.reportSessionAppendTimeRatioMetrics=function(){if(null!==this.contentSource)for(var e=0,t=this.contentSource.streamTypes;e<t.length;e++){var n=t[e],r=this.perStreamTracker[n].runningRatioTracker.average();null!==r&&MT.metrics.putMetric("Media.SourceBuffer."+n+".SessionAppendTimeRatio.Average",r);var i=this.perStreamTracker[n].runningRatioTracker.stdDev();null!==i&&MT.metrics.putMetric("Media.SourceBuffer."+n+".SessionAppendTimeRatio.StdDev",i)}},e}();t.AppendTimeBitrateFilterManager=n});e(mV);mV.AppendTimeBitrateFilterManager;var yV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("FramerateBasedBitrateCapManager"),n=function(){function e(e,t,n,r,i,o){void 0===n&&(n=2e6),void 0===r&&(r=5e3),void 0===i&&(i=.2),void 0===o&&(o=.3);var a=this;this.contentSource=null,this.currentBitrateBitsPerSec=0,this.maxBitrateBitsPerSecThreshold=Number.MAX_VALUE,this.samples=[],this.onPlaybackQualityMetrics=function(e){if(null!==a.contentSource){a.samples.push(e);for(var t=a.samples.reduce(function(e,t){return e+t.periodMs},0);0<a.samples.length&&t-a.samples[0].periodMs>=a.timeNeededMs;)t-=a.samples[0].periodMs,a.samples.shift();var n=a.samples.map(function(e){return e.framesDropped/Math.max(e.framesDecoded,1)}).sort(function(e,t){return e-t}),r=n[Math.floor(n.length*a.samplesPercentileThreshold)];t>=a.timeNeededMs&&r>=a.dropPercentThreshold&&a.currentBitrateBitsPerSec>a.bitrateFloorBitsPerSec&&a.currentBitrateBitsPerSec<=a.maxBitrateBitsPerSecThreshold&&(s.warn("P"+100*a.samplesPercentileThreshold+" of frame drop rate is "+r.toFixed(2)+"in last "+a.timeNeededMs+"ms, downshifting video quality to below "+a.currentBitrateBitsPerSec+"."),a.maxBitrateBitsPerSecThreshold=a.currentBitrateBitsPerSec-1,a.contentSource.setMaxBitrateThreshold("Video","FrameDropRate",a.maxBitrateBitsPerSecThreshold),MT.metrics.putMetric("StreamRestriction.FrameDropRateQualityFilter",a.maxBitrateBitsPerSecThreshold),a.samples=[])}},this.onVideoQualityChanged=function(e){null!==e&&(a.currentBitrateBitsPerSec=e.bitrateBitsPerSec)},this.playbackQualityProvider=e,this.playbackQualityMonitor=t,this.bitrateFloorBitsPerSec=n,this.timeNeededMs=r,this.dropPercentThreshold=i,this.samplesPercentileThreshold=o}return e.prototype.start=function(e){this.contentSource=e,this.playbackQualityProvider.on("Video","qualityLevel",this.onVideoQualityChanged),this.playbackQualityMonitor.on("frameCountChange",this.onPlaybackQualityMetrics)},e.prototype.stop=function(){this.contentSource=null,this.playbackQualityProvider.off("Video","qualityLevel",this.onVideoQualityChanged),this.playbackQualityMonitor.off("frameCountChange",this.onPlaybackQualityMetrics),this.samples=[]},e}();t.FramerateBasedBitrateCapManager=n});e(yV);yV.FramerateBasedBitrateCapManager;var gV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=M.get("PlatformUnexpectedWaitingMonitor"),n=function(){function e(e,t,n,r,i,o){void 0===n&&(n=!1),void 0===r&&(r=2e6),void 0===i&&(i=1e4),void 0===o&&(o=10);var a=this;if(this.contentSource=null,this.currentBitrateBitsPerSec=0,this.maxBitrateBitsPerSecThreshold=Number.MAX_VALUE,this.totalWaitingEventCount=0,this.onUnexpectedWaiting=function(){a.slidingWindowEventTracker.recordEvent();var e=a.slidingWindowEventTracker.getEventCountInWindow();a.enableBitrateFiltering&&null!==a.contentSource&&a.currentBitrateBitsPerSec>a.bitrateFloorBitsPerSec&&a.currentBitrateBitsPerSec<=a.maxBitrateBitsPerSecThreshold&&e>=a.waitingCountThreshold&&(l.info(e+" unexpected waiting event occurred in last "+a.timeWindowMs+"ms.Downshift video quality to below "+a.currentBitrateBitsPerSec+" bits per sec."),a.maxBitrateBitsPerSecThreshold=a.currentBitrateBitsPerSec-1,a.contentSource.setMaxBitrateThreshold("Video","UnexpectedWaiting",a.maxBitrateBitsPerSecThreshold),MT.metrics.putMetric("StreamRestriction.UnexpectedWaitingQualityFilter",a.maxBitrateBitsPerSecThreshold)),a.totalWaitingEventCount++},this.onVideoQualityChanged=function(e){null!==e&&(a.currentBitrateBitsPerSec=e.bitrateBitsPerSec)},this.playbackQualityProvider=e,this.readyTracker=t,this.enableBitrateFiltering=n,this.bitrateFloorBitsPerSec=r,this.timeWindowMs=i,this.waitingCountThreshold=o,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.qualityFilters&&null!=up.configurationStore.configuration.qualityFilters.platformUnexpectedWaiting){var s=up.configurationStore.configuration.qualityFilters.platformUnexpectedWaiting;this.enableBitrateFiltering=s.enabled,null!=s.timeWindowMs&&(this.timeWindowMs=s.timeWindowMs),null!=s.waitingCountThreshold&&(this.waitingCountThreshold=s.waitingCountThreshold),null!=s.filterBitrateFloorBitsPerSec&&(this.bitrateFloorBitsPerSec=s.filterBitrateFloorBitsPerSec)}this.slidingWindowEventTracker=new Rp.SlidingWindowEventTracker(this.timeWindowMs)}return e.prototype.start=function(e){this.contentSource=e,this.readyTracker.on("UnexpectedWaiting",this.onUnexpectedWaiting),this.playbackQualityProvider.on("Video","qualityLevel",this.onVideoQualityChanged)},e.prototype.stop=function(){MT.metrics.putMetric("Media.UnexpectedWaiting.Count",this.totalWaitingEventCount),this.contentSource=null,this.totalWaitingEventCount=0,this.playbackQualityProvider.off("Video","qualityLevel",this.onVideoQualityChanged),this.readyTracker.off("UnexpectedWaiting",this.onUnexpectedWaiting)},e}();t.PlatformUnexpectedWaitingMonitor=n});e(gV);gV.PlatformUnexpectedWaitingMonitor;var vV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var r=this;this.log=new IR.EphemeralJSLogger("PlaybackStateController"),this.playbackState="paused",this.shouldAutoplay=!1,this.cancelInternalMediaPlayerPlay=null,this.pendingPlayPromise=null,this.hasPendingPublicPause=!1,this.publicPauseStartTime=null,this.onPlaybackStateChange=function(e){e.playbackState!==r.playbackState&&(r.playbackState=e.playbackState,r.log.info("PlaybackState change:",r.playbackState),r.eventEmitter.emit("playbackStateChange",e),r.notifyContentStateTransition())},this.onMediaPlayerPlaying=function(){r.mediaPlayer.paused?r.log.info("Ignoring a \"playing\" event -- mediaPlayer is paused"):(r.log.info("MediaPlayer emitted a \"playing\" event"),r.shouldAutoplay=!0,r.onPlaybackStateChange({playbackState:"playing"}))},this.onMediaPlayerPaused=function(){if(r.mediaPlayer.paused){if(null!=r.publicPauseStartTime){var e=Date.now()-r.publicPauseStartTime;MT.metrics.putMetric("MediaPlayer.PauseInvocation.Time",e,"ms"),r.publicPauseStartTime=null}r.log.info("MediaPlayer emitted a \"pause\" event"),"waiting"!==r.getContentState()&&(r.mediaPlayer.ended||(r.shouldAutoplay=!1,r.onPlaybackStateChange({playbackState:"paused",platformTriggered:!r.hasPendingPublicPause}),r.hasPendingPublicPause=!1))}else r.log.info("Ignoring a \"pause\" event -- mediaPlayer is not paused")},this.mediaPlayer=e,this.eventEmitter=t,this.getContentState=n}return e.prototype.load=function(){this.mediaPlayer.on("playing",this.onMediaPlayerPlaying),this.mediaPlayer.on("pause",this.onMediaPlayerPaused)},e.prototype.unload=function(){this.mediaPlayer.off("playing",this.onMediaPlayerPlaying),this.mediaPlayer.off("pause",this.onMediaPlayerPaused)},e.prototype.play=function(){return this.shouldAutoplay=!0,"ready"===this.getContentState()?this.internalPlay():(null==this.pendingPlayPromise&&(this.pendingPlayPromise=new Fe.Deferred),this.pendingPlayPromise.promise)},e.prototype.pause=function(){this.shouldAutoplay=!1,this.mediaPlayer.paused||(this.publicPauseStartTime=Date.now(),this.hasPendingPublicPause=!0),this.mediaPlayer.pause(),this.onPlaybackStateChange({playbackState:"paused"}),null!=this.pendingPlayPromise&&(this.pendingPlayPromise.reject(new Error("Play interrupted by pause")),this.pendingPlayPromise=null)},e.prototype.notifyContentStateTransition=function(){var e=this.getContentState();if(this.log.setId(e),"ready"===e){if(this.mediaPlayer.ended)return;this.shouldAutoplay&&this.mediaPlayer.paused?this.internalPlay():this.shouldAutoplay||this.mediaPlayer.paused||this.internalPause()}else"waiting"!==e||this.mediaPlayer.paused||this.internalPause()},e.prototype.internalPlay=function(){var t=this;null==this.pendingPlayPromise&&(this.pendingPlayPromise=new Fe.Deferred);var e=Fe.CancelToken.source(),n=e.token,r=e.cancel;this.cancelInternalMediaPlayerPlay=r;var i=this.pendingPlayPromise;return this.log.info("Invoking mediaPlayer.play()"),this.mediaPlayer.play().then(function(){t.log.info("MediaPlayer.play promise resolved"),i===t.pendingPlayPromise&&(t.pendingPlayPromise.resolve(),t.pendingPlayPromise=null),t.onPlaybackStateChange({playbackState:"playing"})}).catch(function(e){n.requested||(t.log.warn("MediaPlayer.play rejection. Explicitly setting PlaybackState.Paused:",e),t.onPlaybackStateChange({playbackState:"paused"}),i===t.pendingPlayPromise&&(t.pendingPlayPromise.reject(e),t.pendingPlayPromise=null))}),this.pendingPlayPromise.promise},e.prototype.internalPause=function(){null!=this.cancelInternalMediaPlayerPlay&&(this.cancelInternalMediaPlayerPlay(),this.cancelInternalMediaPlayerPlay=null),this.log.info("Invoking mediaPlayer.pause()"),this.mediaPlayer.pause()},e}();t.PlaybackStateController=n});e(vV);vV.PlaybackStateController;var SV=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var y=new IR.EphemeralJSLogger("ReadyTracker"),g=((n={}).waiting="waiting",n.ready="ready",n),r=function(){function e(e,t,n,r,i,o){var a=this;this.mpBufferInformationProvider=null,this.bufferReason=null,this.contentSource=null,this.eventEmitter=new Dt.EventEmitter,this.isMediaPlayerWaitingForKey=!1,this.inMemoryReadyBufferSizeThresholdMs=6e3,this.lastBufferLogTimestampMs=0,this.onWaiting=function(){if(a.contentLevelAdapter.on("progress",a.checkState),null!==a.contentSource)for(var e=0,t=a.contentSource.streamTypes;e<t.length;e++){var n=t[e];a.contentSource.getFragmentSource(n).onUpdate(a.checkState)}},this.offWaiting=function(){if(a.contentLevelAdapter.off("progress",a.checkState),null!==a.contentSource)for(var e=0,t=a.contentSource.streamTypes;e<t.length;e++){var n=t[e];a.contentSource.getFragmentSource(n).offUpdate(a.checkState)}},this.onMediaPlayerWaiting=function(){y.info("MediaPlayer emitted a \"waiting\" event"),2===a.mediaPlayer.readyState?(y.info("Ignoring MediaPlayer \"waiting\" event while readyState is sufficient"),MT.metrics.putMetric("Media.ReceivedWaitingEventWithSufficientReadyState")):a.internalCheckState(!0)},this.onMediaPlayerCanPlay=function(){y.info("MediaPlayer emitted a \"canplay\" event"),"waiting"===a.contentStateMachine.state?a.checkState():y.info("Ignoring MediaPlayer \"canplay\" event when not Waiting")},this.onMediaPlayerSeeked=function(){y.info("MediaPlayer emitted a \"seeked\" event"),"waiting"===a.contentStateMachine.state?a.checkState():y.info("Ignoring MediaPlayer \"seeked\" event when not Waiting")},this.checkState=function(){a.internalCheckState(!1)},this.onWaitingForKey=function(){a.isMediaPlayerWaitingForKey=!0},this.intervalMsToSec=function(e){return{start:e.start/1e3,end:e.end/1e3}},this.mediaPlayer=e,this.contentLevelAdapter=t,this.contentStateMachine=n,this.seekController=r,this.appendTimeBitrateFilterManager=i,this.timestampPaddingSec=o,this.contentStateMachine.onStateChange(function(e){return y.setId(e)}),this.contentStateMachine.onEnterState("waiting",this.onWaiting),this.contentStateMachine.onLeaveState("waiting",this.offWaiting),this.diagnostics=pp.Diagnostics.create("ReadyTracker"),this.sourceBufferReadyLengthMs=xt.nestedValue(Yh.deviceInformation.mediaSource,"sourceBufferReadyLengthMs",500),this.midBufferLogThrottleFrequencyMs=1/0,null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.readyTracker&&null!=up.configurationStore.configuration.readyTracker.midBufferLogThrottleFrequencyMs&&(this.midBufferLogThrottleFrequencyMs=up.configurationStore.configuration.readyTracker.midBufferLogThrottleFrequencyMs)}return e.prototype.start=function(e,t){null!==this.contentSource&&y.warn("Started multiple times before stop"),this.contentSource=e,this.mpBufferInformationProvider=t;var n=e.getBufferInformationCalculator().bufferSettings;null!=n&&null!=n.bufferFullnessForPlaybackStartSeconds&&(this.inMemoryReadyBufferSizeThresholdMs=1e3*n.bufferFullnessForPlaybackStartSeconds);var r=this.mediaPlayer;if(r.on("waiting",this.onMediaPlayerWaiting),r.on("canplay",this.onMediaPlayerCanPlay),r.on("seeked",this.onMediaPlayerSeeked),r.on("waitingforkey",this.onWaitingForKey),"waiting"===this.contentStateMachine.state)for(var i=0,o=this.contentSource.streamTypes;i<o.length;i++){var a=o[i];this.contentSource.getFragmentSource(a).onUpdate(this.checkState)}},e.prototype.stop=function(){this.contentLevelAdapter.off("progress",this.checkState);var e=this.mediaPlayer;if(e.off("waiting",this.onMediaPlayerWaiting),e.off("canplay",this.onMediaPlayerCanPlay),e.off("seeked",this.onMediaPlayerSeeked),e.off("waitingforkey",this.onWaitingForKey),null!==this.contentSource)for(var t=0,n=this.contentSource.streamTypes;t<n.length;t++){var r=n[t];this.contentSource.getFragmentSource(r).offUpdate(this.checkState)}this.mpBufferInformationProvider=null,this.contentSource=null,this.inMemoryReadyBufferSizeThresholdMs=6e3,this.isMediaPlayerWaitingForKey=!1,this.bufferReason=null},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.internalCheckState=function(e){null!==this.contentSource&&(2===this.mediaPlayer.readyState&&(this.isMediaPlayerWaitingForKey=!1),this.contentStateMachine.act(this.getContentActionFromComponents(e)))},e.prototype.isSourceBufferBufferedToMemoryCapacity=function(e){if(null===this.contentSource)return!1;if(!e.isInMemoryBufferedToEnd&&!e.isInMemoryBufferedToCapacity)return!1;var t=1e3*this.mediaPlayer.currentTime,n=this.contentSource.getBufferInformationCalculator().getBufferedRanges(iE.CRITICAL_STREAM_TYPES).find(t,fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS),r=this.contentLevelAdapter.getBufferedRanges(iE.CRITICAL_STREAM_TYPES).find(t,fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS);return null!==n&&null!==r&&Math.abs(r.end-n.end)<150},e.prototype.isPlayable=function(e){return e.inMemoryBufferSizeMs>this.inMemoryReadyBufferSizeThresholdMs&&e.sourceBufferSizeMs>this.sourceBufferReadyLengthMs||!(!e.isInMemoryBufferedToEnd&&!e.isInMemoryBufferedToCapacity||!(e.sourceBufferSizeMs>this.sourceBufferReadyLengthMs||this.isSourceBufferBufferedToMemoryCapacity(e)))},e.prototype.collectBufferStatus=function(){var e={inMemoryBufferSizeMs:0,sourceBufferSizeMs:0,isInMemoryBufferedToEnd:!1,isInMemoryBufferedToCapacity:!1};null!==this.mpBufferInformationProvider&&(e.inMemoryBufferSizeMs=this.mpBufferInformationProvider.getFrontBufferLengthMs(iE.CRITICAL_STREAM_TYPES),e.isInMemoryBufferedToEnd=this.mpBufferInformationProvider.isBufferedToEnd(iE.CRITICAL_STREAM_TYPES));var t=1e3*this.mediaPlayer.currentTime;if(null!==this.contentSource){var n=this.contentSource.getBufferInformationCalculator();e.isInMemoryBufferedToCapacity=n.isBufferedToCapacity(t)}var r=this.contentLevelAdapter.getBufferedRanges(iE.CRITICAL_STREAM_TYPES).find(t,fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS);return null!==r&&(e.sourceBufferSizeMs=r.end-t),e},e.prototype.getContentActionFromComponents=function(e){if(null===this.contentSource)return"waiting";var t=!this.mediaPlayer.seeking&&2===this.mediaPlayer.readyState,n=this.collectBufferStatus(),r=this.isPlayable(n),i=t&&r?"ready":"waiting";e&&!this.isMediaPlayerWaitingForKey&&!this.mediaPlayer.seeking&&r&&this.eventEmitter.emit("UnexpectedWaiting");for(var o={},a={},s=0,l=this.contentSource.streamTypes;s<l.length;s++){var u=l[s];o[u]=this.contentSource.getBufferInformationCalculator().getBufferedRanges(u).getIntervals().map(this.intervalMsToSec),a[u]=this.contentLevelAdapter.getBufferedRanges(u).getIntervals().map(this.intervalMsToSec)}for(var c={},d=0,p=this.contentSource.streamTypes;d<p.length;d++){var f=p[d];c[f]=this.appendTimeBitrateFilterManager.getWindowedSamples(f)}"ready"===this.contentStateMachine.state&&"waiting"===i&&(this.bufferReason=this.getBufferReason(n),null!=this.contentSource&&this.contentSource.onRebuffer(),y.warn("BufferReason:",this.bufferReason),MT.metrics.putMetric("BufferReason."+this.bufferReason));var h={contentAction:i,readyState:this.mediaPlayer.readyState,mediaPlayerCurrentTimeSec:this.mediaPlayer.currentTime,mediaPlayerDurationSec:this.mediaPlayer.duration,mediaPlayerEnded:this.mediaPlayer.ended,playheadTimeSec:this.seekController.getPositionMs()/1e3,isMediaPlayerWaitingForKey:this.isMediaPlayerWaitingForKey,seeking:this.mediaPlayer.seeking,reductionTermSec:this.contentSource.minimumPlayablePositionMs/1e3-this.timestampPaddingSec,inMemoryBufferedSec:o,inMemoryBufferSizeSec:n.inMemoryBufferSizeMs/1e3,inMemoryReadyBufferSizeThresholdSec:this.inMemoryReadyBufferSizeThresholdMs/1e3,sourceBufferRangesSec:a,sourceBufferSizeSec:n.sourceBufferSizeMs/1e3,sourceBufferReadyLengthSec:this.sourceBufferReadyLengthMs/1e3,mediaPlayerBufferSec:this.createIntervals(this.mediaPlayer.buffered),isBufferedToEnd:n.isInMemoryBufferedToEnd,isInMemoryBufferedToCapacity:n.isInMemoryBufferedToCapacity,appendTimeSamples:c,bufferReason:this.bufferReason,timestamp:Date.now()};if("waiting"===this.contentStateMachine.state&&"ready"===i&&(this.bufferReason=null),this.diagnostics.report("state",h),(this.contentStateMachine.state!==g[i]||Date.now()>this.lastBufferLogTimestampMs+this.midBufferLogThrottleFrequencyMs)&&(y.info(JSON.stringify(h)),this.lastBufferLogTimestampMs=Date.now()),"ready"===i){var m=this.contentSource.getBufferInformationCalculator().bufferSettings;null!=m&&null!=m.bufferFullnessForPlaybackResumeSeconds&&(this.inMemoryReadyBufferSizeThresholdMs=1e3*m.bufferFullnessForPlaybackResumeSeconds)}return i},e.prototype.getBufferReason=function(e){if(1<this.mediaPlayer.buffered.length)return"MediaPlayer.BufferedRangesGap";if(this.isMediaPlayerWaitingForKey)return"MediaPlayer.WaitingForKey";if(e.inMemoryBufferSizeMs<500&&!e.isInMemoryBufferedToEnd){for(var t=1e3*this.mediaPlayer.currentTime,n=0,r=iE.CRITICAL_STREAM_TYPES;n<r.length;n++){var i=r[n];if(null===this.contentSource)break;if(0===(s=this.contentSource.getBufferInformationCalculator().getBufferedRanges(i)).getIntervals().length)return"InMemory.EmptyBuffer."+i;if(this.hasGapNearCurrentPosition(t,s))return"InMemory.GapNearPosition."+i}return"InMemory.InsufficientBufferSize"}if(e.sourceBufferSizeMs<500&&!this.isSourceBufferBufferedToMemoryCapacity(e)){t=1e3*this.mediaPlayer.currentTime;for(var o=0,a=iE.CRITICAL_STREAM_TYPES;o<a.length;o++){i=a[o];var s,l=(s=this.contentLevelAdapter.getBufferedRanges(i)).getIntervals();if(0===l.length)return"SourceBuffer.EmptyBuffer."+i;if(this.hasGapNearCurrentPosition(t,s))return"SourceBuffer.GapNearPosition."+i;if(this.seekController.getPositionMs()<l[0].start)return"SourceBuffer.PlayheadBehindBuffer."+i}return"SourceBuffer.InsufficientBufferSize"}return 2!==this.mediaPlayer.readyState?"MediaPlayer.InsufficientReadyState."+this.mediaPlayer.readyState:this.mediaPlayer.seeking?"MediaPlayer.Seeking":e.inMemoryBufferSizeMs<this.inMemoryReadyBufferSizeThresholdMs?"InMemory.BufferBelowReadyThreshold":e.sourceBufferSizeMs<this.sourceBufferReadyLengthMs?"SourceBuffer.BufferBelowReadyThreshold":"Unknown"},e.prototype.createIntervals=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},e.prototype.hasGapNearCurrentPosition=function(e,t){var n=t.getIntervals();if(n.length<=1)return!1;for(var r=0;r<n.length-1;r++){var i=n[r];if(Math.abs(i.end-e)<250)return!0}return!1},e}();t.ReadyTracker=r});e(SV);SV.ReadyTracker;var bV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=M.get("SeekController"),n=function(){function e(e,t){this.currentPositionMs=null,this.isMpPlayerReinitializing=!1,this.loaded=!1,this.seekPromise=null,this.mediaPlayer=e,this.contentLevelAdapter=t,this.diagnostics=pp.Diagnostics.create("SeekController"),this.state={currentPositionMs:null,isMpPlayerReinitializing:!1,loaded:!1,mediaPlayerBufferSec:[],mediaPlayerCurrentTimeSec:0,mediaPlayerDuration:Number.NaN,mediaPlayerReadyState:0,seeking:!1}}return Object.defineProperty(e.prototype,"isSeeking",{get:function(){return null!=this.seekPromise},enumerable:!0,configurable:!0}),e.prototype.getPositionMs=function(){return!this.loaded||this.isSeeking||this.isMpPlayerReinitializing?null!=this.currentPositionMs?this.currentPositionMs:0:1e3*this.mediaPlayer.currentTime},e.prototype.seek=function(e){var t=this;a.info(">> seek with positionMs: "+e);var n=void 0;if(null!=this.seekPromise&&(n=this.seekPromise,this.clearSeekingOperations()),this.currentPositionMs=e,this.loaded){var r=Fe.CancelToken.source(),i=r.token,o=r.cancel;this.cancelSetPosition=o,this.seekPromise=Fe.Promise.resolve(n).then(function(){if(isNaN(t.mediaPlayer.duration)||t.mediaPlayer.duration===1/0||0===t.mediaPlayer.readyState)return t.logOperation("Wait for buffer"),t.waitForBuffer(i).then(function(){i.throwIfRequested(),t.mediaPlayer.currentTime=e/1e3,t.seekPromise=null,t.logOperation("Seek on MediaPlayer")}).catch(function(e){e instanceof Fe.CancelError||(t.seekPromise=null,a.error("Live: Error seeking to new position",e),t.logOperation("Live: Error seeking to new position, "+e))});t.mediaPlayer.currentTime=e/1e3,t.seekPromise=null,t.logOperation("Seek on MediaPlayer")}).catch(function(e){a.error("Error during seek: ",e)})}},Object.defineProperty(e.prototype,"isReinitializing",{get:function(){return this.isMpPlayerReinitializing},set:function(e){this.isMpPlayerReinitializing=e},enumerable:!0,configurable:!0}),e.prototype.unload=function(){this.loaded=!1,this.isMpPlayerReinitializing=!1,this.clearSeekingOperations(),this.seekPromise=null,this.logOperation("Unload")},e.prototype.load=function(){this.loaded||(this.loaded=!0,null!=this.currentPositionMs&&this.seek(this.currentPositionMs))},e.prototype.clearSeekingOperations=function(){(this.currentPositionMs=null)!=this.cancelSetPosition&&(this.cancelSetPosition(),delete this.cancelSetPosition)},e.prototype.isLoadedWithBuffer=function(){if(this.emitState(),0===this.mediaPlayer.readyState||0===this.mediaPlayer.buffered.length||null===this.currentPositionMs)return!1;for(var e=this.mediaPlayer.buffered,t=0;t<e.length;t++)if(1e3*e.start(t)<=this.currentPositionMs+fU.MAX_PLAY_HEAD_GAP_ALLOWED_MS&&this.currentPositionMs<=1e3*e.end(t))return!0;return!1},e.prototype.waitForBuffer=function(r){var i=this;return new Fe.Promise(function(e,t){if(i.isLoadedWithBuffer())e();else{var n=function(){i.isLoadedWithBuffer()&&(i.contentLevelAdapter.off("progress",n),e())};r.promise.then(function(e){i.contentLevelAdapter.off("progress",n),t(e)}),i.contentLevelAdapter.on("progress",n)}})},e.prototype.logOperation=function(e){try{this.state.lastOperation=e,this.state.lastOperationTimestamp=Date.now(),this.emitState()}catch(e){a.error("Failed to log operation: ",e)}},e.prototype.emitState=function(){this.state.currentPositionMs=this.currentPositionMs,this.state.isMpPlayerReinitializing=this.isMpPlayerReinitializing,this.state.loaded=this.loaded,this.state.mediaPlayerBufferSec=this.createIntervals(this.mediaPlayer.buffered),this.state.mediaPlayerCurrentTimeSec=this.mediaPlayer.currentTime,this.state.mediaPlayerDuration=this.mediaPlayer.duration,this.state.mediaPlayerReadyState=this.mediaPlayer.readyState,this.state.seeking=this.isSeeking,this.diagnostics.report("state",this.state)},e.prototype.createIntervals=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t},e}();t.SeekController=n});e(bV);bV.SeekController;var TV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("TimeOffsettingMediaPlayer"),n=function(){function e(e){var r=this;this.onTimeUpdate=function(){for(var e=0,t=r.timeUpdateListeners;e<t.length;e++){var n=t[e];try{n()}catch(e){i.error("Listener for the \"timeupdate\" event threw an error",e)}}},this.mediaPlayer=e,this.timestampOffsetSec=0,this.timeUpdateListeners=[],this.mediaPlayer.on("timeupdate",this.onTimeUpdate)}return e.prototype.setTimestampOffset=function(e){this.timestampOffsetSec=e},e.prototype.destroy=function(){this.mediaPlayer.off("timeupdate",this.onTimeUpdate),this.mediaPlayer.destroy()},Object.defineProperty(e.prototype,"textTracks",{get:function(){return this.mediaPlayer.textTracks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this.mediaPlayer.error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seekable",{get:function(){var t=this,n=this.mediaPlayer.seekable;return{length:n.length,end:function(e){return n.end(e)-t.timestampOffsetSec},start:function(e){return n.start(e)-t.timestampOffsetSec}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"seeking",{get:function(){return this.mediaPlayer.seeking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return Math.max(this.mediaPlayer.currentTime-this.timestampOffsetSec,0)},set:function(e){this.mediaPlayer.currentTime=e+this.timestampOffsetSec},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.mediaPlayer.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.mediaPlayer.ended},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this.mediaPlayer.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){var t=this,n=this.mediaPlayer.buffered;return{length:n.length,end:function(e){return Math.max(n.end(e)-t.timestampOffsetSec,0)},start:function(e){return Math.max(n.start(e)-t.timestampOffsetSec,0)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mediaKeys",{get:function(){return this.mediaPlayer.mediaKeys},enumerable:!0,configurable:!0}),e.prototype.setMediaKeys=function(e){return this.mediaPlayer.setMediaKeys(e)},Object.defineProperty(e.prototype,"mediaSource",{get:function(){return this.mediaPlayer.mediaSource},set:function(e){this.mediaPlayer.mediaSource=e},enumerable:!0,configurable:!0}),e.prototype.pause=function(){this.mediaPlayer.pause()},e.prototype.play=function(){return this.mediaPlayer.play()},Object.defineProperty(e.prototype,"paused",{get:function(){return this.mediaPlayer.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.mediaPlayer.playbackRate},set:function(e){this.mediaPlayer.playbackRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.mediaPlayer.volume},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pictureInPicture",{get:function(){return this.mediaPlayer.pictureInPicture},enumerable:!0,configurable:!0}),e.prototype.on=function(e,t){"timeupdate"===e?this.timeUpdateListeners.push(t):this.mediaPlayer.on(e,t)},e.prototype.off=function(e,t){"timeupdate"===e?this.timeUpdateListeners=F.without(this.timeUpdateListeners,t):this.mediaPlayer.off(e,t)},e.prototype.getVideoPlaybackQuality=function(){return this.mediaPlayer.getVideoPlaybackQuality()},e.prototype.show=function(){this.mediaPlayer.show()},e.prototype.hide=function(){this.mediaPlayer.hide()},e}();t.TimeOffsettingMediaPlayer=n});e(TV);TV.TimeOffsettingMediaPlayer;var PV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=M.get("TimeUpdateFrequencyTracker"),n=function(){function e(e){this.lastKnownPositionMs=0,this.lastTimeUpdateTimeMs=Date.now(),this.mediaStallTimeoutId=null,this.mediaPlayer=e,this.frequencyTracker=new Rp.RunningSampleTracker}return e.prototype.start=function(e){this.lastKnownPositionMs=e,this.lastTimeUpdateTimeMs=Date.now()},e.prototype.stop=function(){var e=this.frequencyTracker.average();null!=e&&MT.metrics.putMetric("Media.TimeUpdateFrequency.Average",e,"ms");var t=this.frequencyTracker.stdDev();null!=t&&MT.metrics.putMetric("Media.TimeUpdateFrequency.StdDev",t,"ms"),this.frequencyTracker=new Rp.RunningSampleTracker,this.clearMediaStallTimer()},e.prototype.onTimeUpdate=function(e){var t=Date.now()-this.lastTimeUpdateTimeMs,n=e-this.lastKnownPositionMs;2e3<n&&r.warn("'timeupdate' occurred after "+t+"ms with a position change of "+n+"ms between successive updates"),e!==this.lastKnownPositionMs&&this.setMediaStallTimer(),this.lastKnownPositionMs=e,this.lastTimeUpdateTimeMs=Date.now(),this.frequencyTracker.addSample(t)},e.prototype.setMediaStallTimer=function(){var e=this;this.clearMediaStallTimer(),this.mediaStallTimeoutId=A.timer.setTimeout(function(){2!==e.mediaPlayer.readyState||e.mediaPlayer.seeking||e.mediaPlayer.paused||r.warn("Media player should be playing but position is not updated for 2000ms")},2e3)},e.prototype.clearMediaStallTimer=function(){null!==this.mediaStallTimeoutId&&(A.timer.clearTimeout(this.mediaStallTimeoutId),this.mediaStallTimeoutId=null)},e}();t.TimeUpdateFrequencyTracker=n});e(PV);PV.TimeUpdateFrequencyTracker;var wV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var n=this;this.contentState="unloaded",this.log=new IR.EphemeralJSLogger("MpPlayerFragment"),this.codecSwitchStreamType=null,this.contentSource=null,this.eventEmitter=new Dt.EventEmitter,this.reinitializeStartMs=null,this.onLoad=function(e){n.bufferInformationProvider.load(e),n.playbackStateController.load(),(n.contentSource=e).on("positionAdjusted",n.onPositionAdjusted),n.contentSource.onContentFlushed=function(e){n.contentLevelAdapter.flushStream(e)},n.contentSource.onStreamMetadataChanged=function(e,t){n.onStreamMetadataChanged(e,t)},n.contentLevelAdapter.on("initialized",n.onInitialized),n.contentLevelAdapter.initialize(),n.playbackQualityMonitor.start(),n.framerateBasedBitrateCapManager.start(e),n.platformUnexpectedWaitingMonitor.start(e),n.appendTimeBitrateFilterManager.load(e),n.timeUpdateFrequencyTracker.start(n.seekController.getPositionMs())},this.onReinitializing=function(){n.log.info("onReinitializing"),n.mediaPlayerEventTracker.removeAllListeners(),n.removeContentLevelAdapterListeners(),n.contentLevelAdapter.on("uninitialized",n.onUninitialized),n.contentLevelAdapter.terminate()},this.onStreamMetadataChanged=function(e,t){n.log.info("Reinitializing the content buffers"),n.codecSwitchStreamType=e,n.reinitializeStartMs=Date.now(),n.seekController.isReinitializing=!0,n.seekController.seek(t),n.mpPlayerStateMachine.act("reinitialize")},this.onInitialized=function(){if(n.contentLevelAdapter.off("initialized",n.onInitialized),null!==n.contentSource){n.readyTracker.start(n.contentSource,n.bufferInformationProvider),n.addMediaPlayerPlaybackListeners(n.contentSource);var e=n.contentSource.minimumPlayablePositionMs-1e3*n.timestampPaddingSec;n.mediaPlayer.setTimestampOffset(-e/1e3),n.drmController.load(n.contentSource),n.contentLevelAdapter.on("needsContent",n.onNeedsContent),n.contentLevelAdapter.prepare(n.contentSource.streamMetadata,-e/1e3)}},this.onFinishedReinitialization=function(){var e=n.seekController.getPositionMs();n.seekController.isReinitializing=!1,n.seek(e),MT.metrics.putMetric("MpPlayerRestart.CodecSwitch."+n.codecSwitchStreamType,Date.now()-n.reinitializeStartMs)},this.onNeedsContent=function(){n.contentLevelAdapter.off("needsContent",n.onNeedsContent),null!==n.contentSource&&(n.contentLevelAdapter.on("ready",n.onReady),n.contentLevelAdapter.attachContent(n.contentSource))},this.onReady=function(){n.contentLevelAdapter.off("ready",n.onReady),n.seekController.load(),n.mpPlayerStateMachine.act("contentLevelAdapterReady")},this.onUninitialized=function(){n.contentLevelAdapter.off("uninitialized",n.onUninitialized),n.contentLevelAdapter.on("initialized",n.onInitialized),n.contentLevelAdapter.initialize()},this.onEnterUnloading=function(){if(null!=n.mediaPlayer.mediaSource){var e=function(){n.mediaPlayer.off("emptied",e),n.mpPlayerStateMachine.act("unloaded")};n.mediaPlayer.on("emptied",e)}else n.mpPlayerStateMachine.act("unloaded")},this.onUnload=function(){delete n.contentError,null!==n.contentSource&&(n.appendTimeBitrateFilterManager.unload(),n.timeUpdateFrequencyTracker.stop(),n.playbackStateController.unload(),n.readyTracker.stop(),n.mediaPlayerEventTracker.removeAllListeners(),n.seekController.unload(),n.bufferInformationProvider.unload(),n.playbackQualityMonitor.stop(),n.framerateBasedBitrateCapManager.stop(),n.platformUnexpectedWaitingMonitor.stop(),n.removeContentLevelAdapterListeners(),delete n.contentSource.onContentFlushed,delete n.contentSource.onStreamMetadataChanged,n.contentSource.off("positionAdjusted",n.onPositionAdjusted),n.contentSource=null,n.contentLevelAdapter.terminate())},this.onPositionAdjusted=function(e){n.log.info("Requested content position adjusted. Seeking to new position "+e+"ms"),n.seek(e)},this.mpPlayerStateMachine=this.createContentStateMachine(),this.mediaPlayer=new TV.TimeOffsettingMediaPlayer(new pU.MediaPlayer(t)),this.hdcpStore=e,this.drmController=new pV.DrmController(this.mediaPlayer,e),this.mediaPlayerEventTracker=new Dt.EventTracker(this.mediaPlayer),this.playbackQualityProvider=new cV.MpPlayerPlaybackQualityProvider(this.mediaPlayer),this.contentLevelAdapter=new uV.ContentLevelAdapterMSE(this.mediaPlayer,this.drmController,this.playbackQualityProvider,function(){return n.seekController.getPositionMs()}),this.textTrack=this.contentLevelAdapter.textTrack,this.bufferInformationProvider=new hU.MpPlayerBufferInfoProvider(this.mediaPlayer,this.contentLevelAdapter),this.seekController=new bV.SeekController(this.mediaPlayer,this.contentLevelAdapter),null!=up.configurationStore.configuration&&null!=up.configurationStore.configuration.timestampOffsetting&&null!=up.configurationStore.configuration.timestampOffsetting.timestampPaddingSec?this.timestampPaddingSec=up.configurationStore.configuration.timestampOffsetting.timestampPaddingSec:this.timestampPaddingSec=fU.NATIVE_TIMESTAMP_PADDING_SEC,this.appendTimeBitrateFilterManager=new mV.AppendTimeBitrateFilterManager(this.contentLevelAdapter),this.playbackStateController=new vV.PlaybackStateController(this.mediaPlayer,this.eventEmitter,function(){return n.contentState}),this.readyTracker=new SV.ReadyTracker(this.mediaPlayer,this.contentLevelAdapter,this.mpPlayerStateMachine,this.seekController,this.appendTimeBitrateFilterManager,this.timestampPaddingSec),this.playbackQualityMonitor=new fV.PlaybackQualityMonitor(this.playbackQualityProvider),this.framerateBasedBitrateCapManager=new yV.FramerateBasedBitrateCapManager(this.playbackQualityProvider,this.playbackQualityMonitor),this.platformUnexpectedWaitingMonitor=new gV.PlatformUnexpectedWaitingMonitor(this.playbackQualityProvider,this.readyTracker),this.timeUpdateFrequencyTracker=new PV.TimeUpdateFrequencyTracker(this.mediaPlayer),this.mpPlayerStateMachine.onStateChange(function(e){return n.log.setId(e)}),this.mediaPlayer.on("error",function(){n.mpPlayerStateMachine.act("error",n.mediaPlayer.error)}),this.drmController.on("fatalError",function(e){n.mpPlayerStateMachine.act("error",e),n.drmController.reset()}),this.drmController.on("nonfatalError",function(e){n.eventEmitter.emit("nonfatalError",e)}),this.contentLevelAdapter.on("positionBump",function(e){n.log.warn("Bumping position to "+e+"ms due to ContentLevelAdapter bump"),n.seek(e)}),this.contentLevelAdapter.on("nonfatalError",function(e){n.eventEmitter.emit("nonfatalError",e)}),this.contentLevelAdapter.on("fatalError",function(e){n.mpPlayerStateMachine.act("error",e)})}return Object.defineProperty(e.prototype,"playbackState",{get:function(){return this.playbackStateController.playbackState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTimeMs",{get:function(){return"waiting"===this.contentState||"ready"===this.contentState?this.seekController.getPositionMs():null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackTime",{get:function(){if("waiting"!==this.contentState&&"ready"!==this.contentState)return null;var e=this.playbackQualityProvider.getCurrentPeriod();if(null===e||null===this.contentSource)return null;var t=this.seekController.getPositionMs();return{positionMs:t,periodId:e,manifestTimeMs:this.contentSource.playbackTimeToManifestTime(e,t),mediaWallClockUtcTimeMs:this.contentSource.playbackTimeToWallClockUtcTime(e,t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.mediaPlayer.ended},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){var e=this;if(null!=this.mediaPlayer.mediaSource){var t=function(){e.drmController.reset(),e.mediaPlayer.off("emptied",t)};this.mediaPlayer.on("emptied",t)}else this.drmController.reset();this.mediaPlayer.destroy()},e.prototype.isSupported=function(e){return!0},e.prototype.load=function(e,t){this.log.info(">> load"),null!=t&&this.seek(t),this.mpPlayerStateMachine.act("load",e)},e.prototype.unload=function(){this.log.info(">> unload"),this.mpPlayerStateMachine.act("unload")},e.prototype.pause=function(){this.log.info(">> pause"),this.playbackStateController.pause()},e.prototype.play=function(){return this.log.info(">> play"),this.playbackStateController.play()},e.prototype.seek=function(e){if(this.log.info(">> seek to "+e+"ms"),null!=this.contentSource){var t=this.contentSource.timeWindow,n=Rp.clamp(e,t.startMs,t.endMs);n!==e&&(this.log.info(">> seek constrained to "+n+"ms"),e=n)}this.seekController.seek(e),this.bufferInformationProvider.onPosition(e),null!=this.contentSource&&(this.contentSource.seek(e),this.mpPlayerStateMachine.act("waiting")),this.contentLevelAdapter.onPosition()},e.prototype.seekToWallClockTime=function(e){if(this.log.info(">> seekToWallClockTime to "+e+"ms"),null!=this.contentSource){var t=this.contentSource.wallClockUtcTimeToPlaybackTime(e);if(null==t)throw new Error("Unable to seek to wall clock without appropriate reference");this.seek(t)}},Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.mediaPlayer.playbackRate},set:function(e){this.mediaPlayer.playbackRate=e},enumerable:!0,configurable:!0}),e.prototype.getPictureInPictureFeature=function(){return xt.withDefault(this.mediaPlayer.pictureInPicture,null)},e.prototype.getVolumeFeature=function(){return xt.withDefault(this.mediaPlayer.volume,null)},e.prototype.getPlaybackQualityProvider=function(){return this.playbackQualityProvider},e.prototype.getBufferInformationProvider=function(){return this.bufferInformationProvider},e.prototype.getDisplayController=function(){return null},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.show=function(){this.mediaPlayer.show()},e.prototype.hide=function(){this.mediaPlayer.hide()},e.prototype.addMediaPlayerPlaybackListeners=function(n){var r=this;this.mediaPlayerEventTracker.on("ended",function(){return r.eventEmitter.emit("ended",r.seekController.getPositionMs())}),this.mediaPlayerEventTracker.on("seeking",function(){r.log.info("on mediaPlayerEventTracker's 'seeking' event"),r.eventEmitter.emit("seeking")}),this.mediaPlayerEventTracker.on("seeked",function(){return r.eventEmitter.emit("seeked")}),this.mediaPlayerEventTracker.on("timeupdate",function(){if(null!==r.contentSource)if(r.seekController.isSeeking)r.log.warn("Received 'timeupdate' while seeking");else{var e=r.seekController.getPositionMs();r.timeUpdateFrequencyTracker.onTimeUpdate(e),r.contentLevelAdapter.onPosition(),n.onPosition(e),r.bufferInformationProvider.onPosition(e),r.playbackQualityProvider.onPosition(e);var t=r.playbackQualityProvider.getCurrentPeriod();r.eventEmitter.emit("timeupdate",{positionMs:e,periodId:t,manifestTimeMs:r.contentSource.playbackTimeToManifestTime(t,e),mediaWallClockUtcTimeMs:r.contentSource.playbackTimeToWallClockUtcTime(t,e)})}else r.log.warn("Received 'timeupdate' while unloaded")})},e.prototype.createContentStateMachine=function(){var r=this,e=new $k.FiniteStateMachine("unloaded");e.addTransition("unloaded","load","waiting"),e.addTransition("unloaded","unload","unloaded"),e.addTransition("waiting","ready","ready"),e.addTransition("waiting","waiting","waiting"),e.addTransition("waiting","reinitialize","reinitializing"),e.addTransition("waiting","contentLevelAdapterReady","waiting"),e.addTransition("ready","waiting","waiting"),e.addTransition("ready","ready","ready"),e.addTransition("ready","reinitialize","reinitializing"),e.addTransition("ready","unload","unloading"),e.addTransition("waiting","unload","unloading"),e.addTransition("reinitializing","unload","unloading"),e.addTransition("reinitializing","contentLevelAdapterReady","waiting"),e.addTransition("reinitializing","reinitialize","reinitializing"),e.addTransition("unloaded","error","error"),e.addTransition("waiting","error","error"),e.addTransition("ready","error","error"),e.addTransition("reinitializing","error","error"),e.addTransition("unloading","error","error"),e.addTransition("error","error","error"),e.onTransition("unloaded","load",this.onLoad),e.onTransition("waiting","unload",this.onUnload),e.onTransition("waiting","reinitialize",this.onReinitializing),e.onTransition("reinitializing","reinitialize",this.onReinitializing),e.onTransition("reinitializing","contentLevelAdapterReady",this.onFinishedReinitialization),e.onTransition("ready","reinitialize",this.onReinitializing),e.onTransition("ready","unload",this.onUnload),e.addTransition("unloading","unloaded","unloaded"),e.onEnterState("unloading",this.onEnterUnloading),e.addTransition("error","unload","unloading");var t=function(e){e instanceof Ne.XpError?r.contentError=e:r.contentError=new Ne.XpError(e.name,void 0,e.message,!0,e)};return e.onTransition("unloading","error",t),e.onTransition("unloaded","error",t),e.onTransition("waiting","error",t),e.onTransition("ready","error",t),e.onTransition("reinitializing","error",t),e.onTransition("error","error",function(e){r.log.error("Received content error while already in error state",e)}),e.onTransition("error","unload",this.onUnload),e.onEnterState("unloaded",function(){r.drmController.unload(),r.contentState="unloaded",r.log.info("ContentState change:",r.contentState),r.eventEmitter.emit("contentStateChange",r.contentState)}),e.onEnterState("waiting",function(){r.contentState="waiting",r.log.info("ContentState change:",r.contentState),r.eventEmitter.emit("contentStateChange",r.contentState),r.playbackStateController.notifyContentStateTransition()}),e.onEnterState("ready",function(){r.contentState="ready",r.log.info("ContentState change:",r.contentState),r.eventEmitter.emit("contentStateChange",r.contentState),r.playbackStateController.notifyContentStateTransition()}),e.onEnterState("reinitializing",function(){r.contentState="waiting",r.log.info("ContentState change:",r.contentState),r.eventEmitter.emit("contentStateChange",r.contentState),r.playbackStateController.notifyContentStateTransition()}),e.onEnterState("error",function(){r.contentState="error",null!=r.contentError&&r.contentError.code===jA.codes.xp.system.hdcp_insufficient&&r.hdcpStore.getHdcpStatus().then(function(e){r.log.warn("HDCP insufficient error, current HDCP status",e)}),r.log.error("ContentState change:",r.contentState," contentError:",r.contentError),r.eventEmitter.emit("contentStateChange",r.contentState)}),e.onIllegalTransition(function(e,t,n){r.log.error("IllegalTransitionError",e," :: ",t)}),e},e.prototype.removeContentLevelAdapterListeners=function(){this.contentLevelAdapter.off("initialized",this.onInitialized),this.contentLevelAdapter.off("needsContent",this.onNeedsContent),this.contentLevelAdapter.off("ready",this.onReady),this.contentLevelAdapter.off("uninitialized",this.onUninitialized)},e}();t.MpPlayerFragment=n});e(wV);wV.MpPlayerFragment;var CV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MpPlayerFragment=wV.MpPlayerFragment});e(CV);CV.MpPlayerFragment;var MV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.provider=e}return e.prototype.on=function(e,t){if("!streamGroupChange"===e)this.provider.onStreamGroupChange(t);else{var n=e.split("$"),r=n[0],i=n[1];this.provider.on(r,i,t)}},e.prototype.off=function(e,t){if("!streamGroupChange"===e)this.provider.offStreamGroupChange(t);else{var n=e.split("$"),r=n[0],i=n[1];this.provider.off(r,i,t)}},e}(),r=function(){function e(){this.playbackQualityProviders=[],this.activePlaybackQualityProvider=null,this.eventSource=new Dt.MultiplexedEventSource}return e.prototype.selectSource=function(t){var e=F.find(this.playbackQualityProviders,function(e){return e.id===t});this.activePlaybackQualityProvider=null!=e?e.playbackQualityProvider:null,this.eventSource.selectSource(t)},e.prototype.addSource=function(t,e){if(null!=F.find(this.playbackQualityProviders,function(e){return e.id===t}))throw new Error("Source with id "+t+" already exist");this.eventSource.addSource(t,new n(e)),this.playbackQualityProviders.push({id:t,playbackQualityProvider:e})},e.prototype.removeSource=function(t){var e=F.partition(this.playbackQualityProviders,function(e){return e.id===t}),n=e[0],r=e[1];null!=n.length&&(this.eventSource.removeSource(t),this.playbackQualityProviders=r)},e.prototype.getCurrentQualityInfo=function(e){return null!=this.activePlaybackQualityProvider?this.activePlaybackQualityProvider.getCurrentQualityInfo(e):null},e.prototype.getVideoDecodePerformance=function(){return null!=this.activePlaybackQualityProvider?this.activePlaybackQualityProvider.getVideoDecodePerformance():null},e.prototype.on=function(e,t,n){var r=e+"$"+t;this.eventSource.on(r,n)},e.prototype.off=function(e,t,n){var r=e+"$"+t;this.eventSource.off(r,n)},e.prototype.onStreamGroupChange=function(e){this.eventSource.on("!streamGroupChange",e)},e.prototype.offStreamGroupChange=function(e){this.eventSource.off("!streamGroupChange",e)},e}();t.MultiplexedPlaybackQualityProvider=r});e(MV);MV.MultiplexedPlaybackQualityProvider;var IV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.volumeFeatures=[],this.activeVolumeFeature=null,this.allListeners=[]}return e.prototype.selectSource=function(t){var e=F.find(this.volumeFeatures,function(e){return e.id===t});this.activeVolumeFeature=null!=e?e.volumeFeature:null},e.prototype.addSource=function(t,e){if(null!=F.find(this.volumeFeatures,function(e){return e.id===t}))throw new Error("Source with id "+t+" already exist");this.volumeFeatures.push({id:t,volumeFeature:e})},e.prototype.removeSource=function(t){var e=F.partition(this.volumeFeatures,function(e){return e.id===t}),n=e[0],r=e[1];if(0!==n.length){for(var i=0,o=this.allListeners;i<o.length;i++){var a=o[i].originalListener;n[0].volumeFeature.offChange(a)}this.volumeFeatures=r}},Object.defineProperty(e.prototype,"volume",{get:function(){return null==this.activeVolumeFeature?0:this.activeVolumeFeature.volume},set:function(e){null!=this.activeVolumeFeature&&(this.activeVolumeFeature.volume=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return null==this.activeVolumeFeature||this.activeVolumeFeature.muted},set:function(e){null!=this.activeVolumeFeature&&(this.activeVolumeFeature.muted=e)},enumerable:!0,configurable:!0}),e.prototype.onChange=function(t){var n=this;if(null!=this.activeVolumeFeature)for(var e=function(e){return function(){n.activeVolumeFeature===e&&t()}},r=0,i=this.volumeFeatures;r<i.length;r++){var o=i[r].volumeFeature,a=e(o);o.onChange(a),this.allListeners.push({wrappedListener:a,originalListener:t})}},e.prototype.offChange=function(e){null!=this.activeVolumeFeature&&this.removeListenerFromVolumeFeatures(e)},e.prototype.removeListenerFromVolumeFeatures=function(t){var e=F.findIndex(this.allListeners,function(e){return e.originalListener===t});if(-1!==e){for(var n=this.allListeners[e].wrappedListener,r=0,i=this.volumeFeatures;r<i.length;r++){i[r].volumeFeature.offChange(n)}this.allListeners.splice(e,1)}},e}();t.MultiplexedVolumeFeature=n});e(IV);IV.MultiplexedVolumeFeature;var EV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.pictureInPictureFeatures=[],this.activePictureInPictureFeature=null,this.allListeners=[]}return e.prototype.selectSource=function(t){var e=F.find(this.pictureInPictureFeatures,function(e){return e.id===t});this.activePictureInPictureFeature=null!=e?e.pictureInPictureFeature:null},e.prototype.addSource=function(t,e){if(null!=F.find(this.pictureInPictureFeatures,function(e){return e.id===t}))throw new Error("Source with id "+t+" already exist");this.pictureInPictureFeatures.push({id:t,pictureInPictureFeature:e})},e.prototype.removeSource=function(t){var e=F.partition(this.pictureInPictureFeatures,function(e){return e.id===t}),n=e[0],r=e[1];if(0!==n.length){for(var i=0,o=this.allListeners;i<o.length;i++){var a=o[i].originalListener;n[0].pictureInPictureFeature.offChange(a)}this.pictureInPictureFeatures=r}},e.prototype.onChange=function(t){var n=this;if(null!=this.activePictureInPictureFeature)for(var e=function(e){return function(){n.activePictureInPictureFeature===e&&t()}},r=0,i=this.pictureInPictureFeatures;r<i.length;r++){var o=i[r].pictureInPictureFeature,a=e(o);o.onChange(a),this.allListeners.push({wrappedListener:a,originalListener:t})}},e.prototype.offChange=function(e){null!=this.activePictureInPictureFeature&&this.removeListenerFromPictureInPictureFeatures(e)},e.prototype.isPictureInPicture=function(){return null!=this.activePictureInPictureFeature&&this.activePictureInPictureFeature.isPictureInPicture()},e.prototype.isSupported=function(){return null!=this.activePictureInPictureFeature&&this.activePictureInPictureFeature.isSupported()},e.prototype.requestPictureInPicture=function(){return null!=this.activePictureInPictureFeature?this.activePictureInPictureFeature.requestPictureInPicture():Promise.reject("No active Picture-In-Picture Feature")},e.prototype.exitPictureInPicture=function(){return null!=this.activePictureInPictureFeature?this.activePictureInPictureFeature.exitPictureInPicture():Promise.reject("No active Picture-In-Picture Feature")},e.prototype.removeListenerFromPictureInPictureFeatures=function(t){var e=F.findIndex(this.allListeners,function(e){return e.originalListener===t});if(-1!==e){for(var n=this.allListeners[e].wrappedListener,r=0,i=this.pictureInPictureFeatures;r<i.length;r++){i[r].pictureInPictureFeature.offChange(n)}this.allListeners.splice(e,1)}},e}();t.MultiplexedPictureInPictureFeature=n});e(EV);EV.MultiplexedPictureInPictureFeature;var _V=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("MultiplexedMpPlayer"),n=function(){function e(){var t=this;this.internalActivePlayer=null,this.players=[],this.multiplexedPlayerEventSource=new Dt.MultiplexedEventSource,this.multiplexedTextTrackEventSource=new Dt.MultiplexedEventSource,this.multiplexedPlaybackQualityProvider=new MV.MultiplexedPlaybackQualityProvider,this.multiplexedPictureInPictureFeature=new EV.MultiplexedPictureInPictureFeature,this.multiplexedVolumeFeature=new IV.MultiplexedVolumeFeature,this.bufferInformationProvider={getBufferedRanges:function(e){return t.activePlayer.getBufferInformationProvider().getBufferedRanges(e)},getAggregateBufferedRanges:function(e){return t.activePlayer.getBufferInformationProvider().getAggregateBufferedRanges(e)},getFrontBufferLengthMs:function(e){return t.activePlayer.getBufferInformationProvider().getFrontBufferLengthMs(e)},isBufferedToEnd:function(e){return t.activePlayer.getBufferInformationProvider().isBufferedToEnd(e)},getBufferInformation:function(){return t.activePlayer.getBufferInformationProvider().getBufferInformation()}}}return Object.defineProperty(e.prototype,"activePlayer",{get:function(){return this.internalActivePlayer},enumerable:!0,configurable:!0}),e.prototype.selectSource=function(t){var e=F.find(this.players,function(e){return e.id===t});if(null==e)throw new Error("[MultiplexedMpPlayer] Entry with id "+t+" doesn't exist");this.multiplexedPlayerEventSource.selectSource(t),this.multiplexedTextTrackEventSource.selectSource(t),this.multiplexedPlaybackQualityProvider.selectSource(t),this.multiplexedVolumeFeature.selectSource(t),this.multiplexedPictureInPictureFeature.selectSource(t),null!=this.internalActivePlayer&&this.transferPlayerPresets(this.internalActivePlayer,e.player),this.internalActivePlayer=e.player},e.prototype.addSource=function(t,e){if(null!=F.find(this.players,function(e){return e.id===t}))throw new Error("Source with id "+t+" already exist");this.multiplexedPlayerEventSource.addSource(t,e),this.multiplexedTextTrackEventSource.addSource(t,e.textTrack),null!=e.getPlaybackQualityProvider()&&this.multiplexedPlaybackQualityProvider.addSource(t,e.getPlaybackQualityProvider()),null!=e.getVolumeFeature()&&this.multiplexedVolumeFeature.addSource(t,e.getVolumeFeature()),null!=e.getPictureInPictureFeature()&&this.multiplexedPictureInPictureFeature.addSource(t,e.getPictureInPictureFeature()),this.players.push({id:t,player:e})},e.prototype.removeSource=function(t){var e=F.partition(this.players,function(e){return e.id===t}),n=e[0],r=e[1];if(0===n.length)throw new Error("No source with id "+t+" exists");this.multiplexedPlayerEventSource.removeSource(t),this.multiplexedTextTrackEventSource.removeSource(t),this.multiplexedPlaybackQualityProvider.removeSource(t),this.multiplexedPictureInPictureFeature.removeSource(t),this.multiplexedVolumeFeature.removeSource(t),this.players=r,this.internalActivePlayer!==n[0].player&&(this.internalActivePlayer=null)},e.prototype.on=function(e,t){this.multiplexedPlayerEventSource.on(e,t)},e.prototype.once=function(e,t){this.multiplexedPlayerEventSource.once(e,t)},e.prototype.off=function(e,t){this.multiplexedPlayerEventSource.off(e,t)},e.prototype.unload=function(){for(var e=0,t=this.players;e<t.length;e++){var n=t[e].id;this.multiplexedPlayerEventSource.removeSource(n),this.multiplexedTextTrackEventSource.removeSource(n)}},e.prototype.getPictureInPictureFeature=function(){return this.multiplexedPictureInPictureFeature},e.prototype.getVolumeFeature=function(){return this.multiplexedVolumeFeature},e.prototype.getPlaybackQualityProvider=function(){return this.multiplexedPlaybackQualityProvider},e.prototype.getBufferInformationProvider=function(){return this.bufferInformationProvider},Object.defineProperty(e.prototype,"textTrack",{get:function(){var n=this;return{get cues(){return n.activePlayer.textTrack.cues},get bufferedIntervalsMs(){return n.activePlayer.textTrack.bufferedIntervalsMs},on:function(e,t){n.multiplexedTextTrackEventSource.on(e,t)},off:function(e,t){n.multiplexedTextTrackEventSource.off(e,t)}}},enumerable:!0,configurable:!0}),e.prototype.transferPlayerPresets=function(e,t){this.transferVolumePresets(e,t),this.transferClosedCaptionsLanguageSelection(e,t),this.transferPictureInPicturePresets(e,t)},e.prototype.transferVolumePresets=function(e,t){var n=e.getVolumeFeature(),r=t.getVolumeFeature();null!=n&&null!=r&&(r.volume=n.volume)},e.prototype.transferPictureInPicturePresets=function(e,t){var n=e.getPictureInPictureFeature(),r=t.getPictureInPictureFeature();null!=n&&null!=r&&n.isPictureInPicture()&&r.requestPictureInPicture().catch(function(e){return i.error("Failed to request Picture-In-Picture while transfering Picture-In-Picture presets",e)})},e.prototype.transferClosedCaptionsLanguageSelection=function(e,t){},e}();t.MultiplexedMpPlayer=n});e(_V);_V.MultiplexedMpPlayer;var xV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.primaryContentMpPlayer=null,this.mpPlayerLiveLowLatency=null,this.multiplexedMpPlayer=new _V.MultiplexedMpPlayer,this.activePlayerSourceId=0,this.shouldAutoplay=!1}return Object.defineProperty(e.prototype,"error",{get:function(){return this.multiplexedMpPlayer.activePlayer.error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentError",{get:function(){return this.multiplexedMpPlayer.activePlayer.contentError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentState",{get:function(){return this.multiplexedMpPlayer.activePlayer.contentState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackState",{get:function(){return this.multiplexedMpPlayer.activePlayer.playbackState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTimeMs",{get:function(){return this.multiplexedMpPlayer.activePlayer.currentTimeMs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackTime",{get:function(){return this.multiplexedMpPlayer.activePlayer.playbackTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.multiplexedMpPlayer.activePlayer.ended},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textTrack",{get:function(){return this.multiplexedMpPlayer.textTrack},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.multiplexedMpPlayer.activePlayer.playbackRate},set:function(e){this.multiplexedMpPlayer.activePlayer.playbackRate=e},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e,t){this.primaryContentMpPlayer=new CV.MpPlayerFragment(t,e),this.mpPlayerLiveLowLatency=new WO.MpPlayerLiveLowLatency(e),this.multiplexedMpPlayer.addSource(0,this.primaryContentMpPlayer),this.multiplexedMpPlayer.addSource(1,this.mpPlayerLiveLowLatency),this.multiplexedMpPlayer.selectSource(0)},e.prototype.isSupported=function(e){return!0},e.prototype.destroy=function(){null!=this.primaryContentMpPlayer&&(this.multiplexedMpPlayer.removeSource(0),this.primaryContentMpPlayer.destroy(),this.primaryContentMpPlayer=null),null!=this.mpPlayerLiveLowLatency&&(this.multiplexedMpPlayer.removeSource(1),this.mpPlayerLiveLowLatency.destroy(),this.mpPlayerLiveLowLatency=null)},e.prototype.load=function(e,t){e instanceof WO.LiveLowLatencyContentSource?(this.setupActivePlayerSource(1),this.multiplexedMpPlayer.activePlayer.load(e,t)):this.primaryContentMpPlayer instanceof CV.MpPlayerFragment&&(this.setupActivePlayerSource(0),this.multiplexedMpPlayer.activePlayer.load(e,t)),this.shouldAutoplay&&this.multiplexedMpPlayer.activePlayer.play()},e.prototype.unload=function(){this.multiplexedMpPlayer.activePlayer.unload()},e.prototype.play=function(){return this.shouldAutoplay=!0,this.multiplexedMpPlayer.activePlayer.play()},e.prototype.pause=function(){this.shouldAutoplay=!1,this.multiplexedMpPlayer.activePlayer.pause()},e.prototype.seek=function(e){this.multiplexedMpPlayer.activePlayer.seek(e)},e.prototype.seekToWallClockTime=function(e){this.multiplexedMpPlayer.activePlayer.seekToWallClockTime(e)},e.prototype.getVolumeFeature=function(){return this.multiplexedMpPlayer.getVolumeFeature()},e.prototype.getPictureInPictureFeature=function(){return this.multiplexedMpPlayer.getPictureInPictureFeature()},e.prototype.getPlaybackQualityProvider=function(){return this.multiplexedMpPlayer.getPlaybackQualityProvider()},e.prototype.getBufferInformationProvider=function(){return this.multiplexedMpPlayer.getBufferInformationProvider()},e.prototype.getDisplayController=function(){return this.multiplexedMpPlayer.activePlayer.getDisplayController()},e.prototype.on=function(e,t){this.multiplexedMpPlayer.on(e,t)},e.prototype.once=function(e,t){this.multiplexedMpPlayer.once(e,t)},e.prototype.off=function(e,t){this.multiplexedMpPlayer.off(e,t)},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.setupActivePlayerSource=function(e){if(this.activePlayerSourceId!==e){var t=this.multiplexedMpPlayer.activePlayer;this.multiplexedMpPlayer.selectSource(e),this.activePlayerSourceId=e,null!=t&&null!=this.multiplexedMpPlayer.activePlayer&&(t.hide(),this.multiplexedMpPlayer.activePlayer.show())}},e}();t.MpPlayerProxy=n});e(xV);xV.MpPlayerProxy;var kV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.constrainPosition=function(e,t){return Math.max(e.startMs,Math.min(t,e.endMs))},t.isWithinTimeWindow=function(e,t){return e.startMs<=t&&t<=e.endMs}});e(kV);kV.constrainPosition,kV.isWithinTimeWindow;var RV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=M.get("PlaylistMediaPlaybackController"),n=function(){function e(e,t,n,r){var a=this;this.currentItem=null,this.isContentLoaded=!1,this.pendingMpPlayerSeek=!1,this.autoloadOnUnloaded=!0,this.onReset=function(){null!=a.currentItem&&a.mpPlayer.unload()},this.onStreamEnd=function(){var e=a.mpPlayer.currentTimeMs;if(null!=e){var t=a.playlistEngine.getCurrentItem();if(null!==t&&t===a.currentItem){var n=e+t.contentTimeToPlaylistTimeOffsetMs,r=new FA.PlaylistRelativeView(a.playlistEngine,{contentSource:t.contentSource}),i=r.getItems(),o=i[i.length-1].end;null!=o&&o!==1/0||(r.update(t.start,1/0,{end:n}),r.splice(n,1/0,[]),o=n),a.mpPlayer.pause(),a.playlistEngine.onPosition(o),s.info("Stream has finished, closing the player.")}else s.warn("Received 'StreamEnd' with non-existent or mismatched current playlist item")}else s.warn("Stream ended without current media position")},this.onEnterItem=function(e){a.autoloadOnUnloaded=!0,null==a.currentItem||e.item.contentSource!==a.currentItem.contentSource?null!=a.currentItem?(null!=a.currentItem.contentSource&&a.currentItem.contentSource.stop(),a.mpPlayer.unload()):a.load():a.currentItem=e.item},this.onPlaylistEngineSeek=function(e){if(s.info(">> onPlaylistEngineSeek with positionMs: "+e),null===a.currentItem){var t="Attempted to seek without a current item";return s.error(t),void a.mediaEventController.reportError(!1,new Error(t),"Player","Unknown")}var n=e-a.currentItem.contentTimeToPlaylistTimeOffsetMs;a.isContentLoaded&&(a.pendingMpPlayerSeek=!0,a.reportDiagnostics()),a.mpPlayer.seek(n)},this.onTimeUpdate=function(e){if(a.pendingMpPlayerSeek)return a.state.numOfIgnoredTimeUpdatesSinceLastStateChange++,a.reportDiagnostics(!1),void(25===a.state.numOfIgnoredTimeUpdatesSinceLastStateChange&&s.warn("Ignored a frequent number of 'timeupdate' events'"));var t=a.playlistEngine.getCurrentItem();if(null!==t&&t===a.currentItem){var n=e.positionMs+t.contentTimeToPlaylistTimeOffsetMs;a.playlistEngine.onPosition(n),a.timeDataManager.onTimeUpdate()}else s.warn("Received 'timeupdate' for position "+e.positionMs+"ms for item which does not match current playlist item")},this.onSeeking=function(){s.info(">> onSeeking"),a.pendingMpPlayerSeek=!1,a.reportDiagnostics()},this.onEnded=function(){var e=a.playlistEngine.getCurrentItem();if(null!==e&&e===a.currentItem){var t=e.end;null!==t&&a.playlistEngine.onPosition(t)}else s.warn("Received 'ended' for item which does not match current playlist item")},this.onDurationChange=function(e){var t=a.playlistEngine.getCurrentItem();if(null!==t&&t===a.currentItem){var n=new FA.PlaylistRelativeView(a.playlistEngine,{contentSource:t.contentSource}),r=n.getItems(),i=F.last(r);if(null!=i){var o=null!=i.end?i.end:1/0;n.update(i.start,o,{end:e})}}else s.warn("Received 'durationchange' with non-existent or mismatched current playlist item")},this.onContentStateChange=function(e){"unloaded"===e?(s.info("MpPlayer Unloaded"),a.pendingMpPlayerSeek=!1,a.isContentLoaded=!1,a.autoloadOnUnloaded&&a.load()):a.isContentLoaded||"waiting"!==e&&"ready"!==e||(a.isContentLoaded=!0,a.pendingMpPlayerSeek=!1),a.reportDiagnostics()},this.playlistEngine=e,this.mpPlayer=t,this.timeDataManager=n,this.mediaEventController=r,this.diagnostics=pp.Diagnostics.create("PlaylistMediaPlaybackController"),this.state={autoloadOnUnloaded:!0,isContentLoaded:!1,pendingMpPlayerSeek:!1,numOfIgnoredTimeUpdatesSinceLastStateChange:0,timestamp:Date.now()}}return e.prototype.initialize=function(){this.playlistEngine.on("Seek",this.onPlaylistEngineSeek),this.playlistEngine.on("EnterItem",this.onEnterItem),this.mpPlayer.on("timeupdate",this.onTimeUpdate),this.mpPlayer.on("seeking",this.onSeeking),this.mpPlayer.on("ended",this.onEnded),this.mpPlayer.on("durationchange",this.onDurationChange),this.mpPlayer.on("contentStateChange",this.onContentStateChange)},e.prototype.terminate=function(){this.playlistEngine.off("Seek",this.onPlaylistEngineSeek),this.playlistEngine.off("EnterItem",this.onEnterItem),this.mpPlayer.off("timeupdate",this.onTimeUpdate),this.mpPlayer.off("seeking",this.onSeeking),this.mpPlayer.off("ended",this.onEnded),this.mpPlayer.off("durationchange",this.onDurationChange),this.mpPlayer.off("contentStateChange",this.onContentStateChange)},e.prototype.play=function(){if(null!==this.currentItem&&null!=this.currentItem.playlistRelativeConstrainedTimeWindow){var e=this.playlistEngine.getCurrentPosition(),t=this.currentItem.playlistRelativeConstrainedTimeWindow;null===e||kV.isWithinTimeWindow(t,e)||(s.info("Current position "+e+"ms (playlist time) outside time window. Seeking back into time window"),this.playlistEngine.seek(e))}return this.mpPlayer.play()},e.prototype.unloaded=function(){this.autoloadOnUnloaded=!1,this.currentItem=null,s.info("Unloading current playlist."),this.mpPlayer.unload(),this.pendingMpPlayerSeek=!1,this.reportDiagnostics()},e.prototype.load=function(){var e=this.playlistEngine.getCurrentItem();if(null!=(this.currentItem=e))if(null!=e.contentSource){var t=this.playlistEngine.getCurrentPosition()-e.contentTimeToPlaylistTimeOffsetMs,n=e.contentSource;this.mpPlayer.load(n,t),n.start(t)}else s.warn("No current ContentSource. Not loading anything");else s.warn("No current item in PlaylistEngine. Not loading new content")},e.prototype.reportDiagnostics=function(e){void 0===e&&(e=!0),this.state.autoloadOnUnloaded=this.autoloadOnUnloaded,this.state.isContentLoaded=this.isContentLoaded,this.state.pendingMpPlayerSeek=this.pendingMpPlayerSeek,this.state.timestamp=Date.now(),this.diagnostics.report("state",this.state),e&&(this.state.numOfIgnoredTimeUpdatesSinceLastStateChange=0)},e}();t.PlaylistMediaPlaybackController=n});e(RV);RV.PlaylistMediaPlaybackController;var AV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("PublicTimeTranslator"),n=function(){function e(e){this.playlistEngine=e}return e.prototype.getPlaylistPosition=function(e,t){var n=new FA.PlaylistRelativeView(this.playlistEngine,{titleId:t,type:"Main"}),r=this.getMainContentDurationMs(n),i=this.getBoundPositionMs(n,e,r),o=F.findIndex(n.getItems(),function(e){return e.timelineStart<=i&&i<=xt.withDefault(e.timelineEnd,1/0)}),a=i;-1===o&&(u.error("Cannot find position: "+i+"ms in main content. Seeking to 0ms"),o=a=0);var s=n.getItems()[o],l=this.playlistEngine.getItems().indexOf(s);return{position:a-s.timelineStart+s.start,playlistItemIndex:l}},e.prototype.getCurrentPublicPositionMs=function(){var e=this.playlistEngine.getCurrentPosition(),t=this.playlistEngine.getCurrentItem();if(null==e||null==t)return null;var n=new FA.ItemRelativeView(this.playlistEngine,{titleId:t.titleId,type:"Main"}).getItems();if(0===n.length)return null;if(n[0].timelineUnit===Gd.TimeUnit.EpochMillis)return e;for(var r=0,i=0,o=n;i<o.length;i++){var a=o[i];if(e<a.start)return r;if(a.start<=e&&(null===a.end||e<=a.end))return r+(e-a.start);r+=null!=a.end?a.end-a.start:1/0}return r},e.prototype.getMainContentDurationMs=function(e){var t=e.getItems(),n=t[t.length-1];return xt.withDefault(n.timelineEnd,1/0)},e.prototype.getBoundPositionMs=function(e,t,n){var r=e.getItems()[0].mediaRepresentation;return null==r?t:null==r.updatePeriodMs&&n-2e3<t?(u.warn("Requested position "+t+"ms near or beyond content end "+n+"ms. Converting to 0ms instead."),0):null!=r.updatePeriodMs&&n<t?(u.warn("Requested starting position "+t+"ms beyond timeline end. Binding to end position: "+n+"ms."),n):t},e}();t.PublicTimeTranslator=n});e(AV);AV.PublicTimeTranslator;var OV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.fromTimeWindow=function(e,t){return{startMs:Math.max(e.startMs,e.endMs-t),endMs:e.endMs}},e}();t.LookbackTimeWindowFactory=n});e(OV);OV.LookbackTimeWindowFactory;var LV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var p=this;this.eventEmitter=new Dt.EventEmitter,this.createPlayableRange=function(e){var t=p.playlistEngine.getCurrentPosition(),n=null!=t?t:0,r=e.playlistRelativeConstrainedTimeWindow;if(null==r)return{unit:e.timelineUnit,start:e.start,end:e.end};var i=e.returnedTitleRendition.liveLookbackSec;if(null!=i){var o=1e3*i;r=OV.LookbackTimeWindowFactory.fromTimeWindow(r,o)}var a=0;n<r.startMs?a=n-r.startMs:n>r.endMs&&(a=n-r.endMs),r={startMs:r.startMs+a,endMs:r.endMs+a};var s=e.start,l=e.end;if(null!==l&&l<r.startMs)return{unit:e.timelineUnit,start:null,end:null};if(s>r.endMs)return{unit:e.timelineUnit,start:null,end:null};s=Math.max(s,r.startMs),null!==l&&(l=Math.min(l,r.endMs));var u=e.timelineStart-e.start,c=s+u,d=l;return null!==d&&(d+=u),{unit:e.timelineUnit,start:c,end:d}},this.playlistEngine=e,this.mpPlayer=t}return e.prototype.getTimeData=function(){var e=this.playlistEngine.getCurrentItem();if(null===e)return{unit:Gd.TimeUnit.ContentMillis,currentPosition:0,currentTimelineItemIndex:0,playableRanges:this.getPlayableRanges()};var t=this.playlistEngine.getCurrentItemIndex(),n=this.mpPlayer.playbackTime,r=null!=n?n.mediaWallClockUtcTimeMs:null;return{unit:e.timelineUnit,currentPosition:this.getTimelineRelativeCurrentPositionMs(e),currentTimelineItemIndex:null!=t?t:0,playableRanges:this.getPlayableRanges(),mediaWallClockUtcTime:null!=r?r:void 0}},e.prototype.onTimeUpdate=function(){this.eventEmitter.emit("TimeDataChange",this.getTimeData())},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.getTimelineRelativeCurrentPositionMs=function(e){var t=this.playlistEngine.getCurrentPosition(),n=null!=t?t:0;return n+=e.timelineStart-e.start},e.prototype.getPlayableRanges=function(){var n=this,r={};return this.playlistEngine.getItems().forEach(function(e,t){r[t]=n.createPlayableRange(e)}),r},e}();t.TimeDataManager=n});e(LV);LV.TimeDataManager;var FV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("TimelineManager"),r=function(){function e(e){var t=this;this.eventEmitter=new Dt.EventEmitter,this.appendedPseudoEntries=[],this.onPlaylistUpdate=function(){t.timeline=t.createTimeline(),t.eventEmitter.emit("TimelineChange",t.timeline)},this.onPlaylistEnd=function(){0===t.appendedPseudoEntries.length?(n.info("<< TimelineEnded"),t.eventEmitter.emit("TimelineEnded")):(n.warn("<< TimelineBlocked"),t.eventEmitter.emit("TimelineBlocked"))},this.playlistEngine=e,this.timeline=this.createTimeline()}return e.prototype.initialize=function(){this.playlistEngine.on("PlaylistUpdate",this.onPlaylistUpdate),this.playlistEngine.on("PlaylistEnd",this.onPlaylistEnd)},e.prototype.terminate=function(){this.playlistEngine.off("PlaylistUpdate",this.onPlaylistUpdate),this.playlistEngine.off("PlaylistEnd",this.onPlaylistEnd),this.reset()},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.getTimeline=function(){return this.timeline},e.prototype.createTimeline=function(){for(var e=[],t={},n=0,r=this.playlistEngine.getItems();n<r.length;n++){var i=r[n],o=i.returnedTitleRendition,a=void 0;if("Main"===i.type)a=[i.titleId,o.asin,o.contentId].join("_");else{if("Ad"!==i.type)throw new Error("Unrecognized PlaylistItem.type '"+i.type+"'");a=[i.titleId,i.adInstanceId].join("_")}var s=a,l=i.titleId;null!=i.liveScheduleTitleId&&(s=i.liveScheduleTitleId,l=i.liveScheduleTitleId),null!=i.liveSchedule&&0!==i.liveSchedule.scheduled.length&&(l+="_"+i.timelineStart);var u={timeUnit:i.timelineUnit,startTime:i.timelineStart,endTime:i.timelineEnd,error:null,contentId:s,groupId:l};if(e.push(u),null==t[s]){var c="Ad"===i.type?"Advertisement":"Feature",d=null!=i.liveScheduleTitleId?i.liveScheduleTitleId:i.titleId;t[s]={titleId:d,contentType:c,metadata:i.catalogMetadata,videoPreviewAssets:i.videoPreviewAssets,transitionTimecodes:i.transitionTimecodes,pinRestrictions:i.pinRestrictions,xrayMetadata:i.xrayMetadata,channelName:null!=i.liveSchedule?i.liveSchedule.channelName:void 0}}}for(var p=0,f=this.appendedPseudoEntries;p<f.length;p++){var h=f[p];e.push(h.timelineItem),t[h.timelineItem.contentId]=h.contentInfo}return{items:e,contentInfos:t}},e.prototype.appendPseudoEntry=function(e,t){null!=e.error&&(e.error=XA.InternalToExternalCodeConverter.convertCode(e.error)),this.appendedPseudoEntries.push({timelineItem:e,contentInfo:t}),this.timeline=this.createTimeline(),this.eventEmitter.emit("TimelineChange",this.timeline)},e.prototype.reset=function(){this.appendedPseudoEntries=[]},e}();t.TimelineManager=r});e(FV);FV.TimelineManager;var DV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=M.get("XpPlayerAdReportingFeature");function p(e,t){return e.filter(function(e){return e.id===t}).map(function(e){return{url:e.uri,method:"GET"}})}function f(e,t){return e.filter(function(e){return e.name===t}).map(function(e){var t=null!=e.httpMethod?e.httpMethod:"GET";return{url:e.uri,method:t,data:e.data}})}var h=["expand","collapse","acceptInvitation"],n=function(){function e(e,t){var i=this;this.version="0.0.1",this.objectId="XpPlayer-Ad-Reporting-Feature-"+Math.random(),this.onEnterItem=function(e){var t=e.item.adInstanceId;null!=t&&i.encounteredAdInstanceIds.push(t)},this.onPlaylistUpdate=function(){for(var e=[],t=0,n=i.playlistEngine.getItems();t<n.length;t++){var r=n[t];null!=r.adInstanceId&&e.push(r.adInstanceId)}i.encounteredAdInstanceIds=F.intersection(i.encounteredAdInstanceIds,e)},this.adEventReporter=e,this.playlistEngine=t,this.encounteredAdInstanceIds=[],t.on("EnterItem",this.onEnterItem),t.on("PlaylistUpdate",this.onPlaylistUpdate)}return e.prototype.notifyAdInteractionEvent=function(e,t,n){if(null==e||"customClick"===e&&null==n)d.warn("Invalid ad event notification: "+e+" event with customClickId "+n+".");else if(-1!==this.encounteredAdInstanceIds.indexOf(t))for(var r=0,i=this.playlistEngine.getItems();r<i.length;r++){var o=i[r];if(o.adInstanceId===t)if(null!=o.sourceUrlStore){var a=[],s=o.adVideoClickTrackingUris;if("customClick"===e&&null!=s&&null!=s.customClicks)a.push.apply(a,p(s.customClicks,n));else if("clickThrough"===e&&null!=s&&null!=s.clickThroughTrackingUris)for(var l=0,u=s.clickThroughTrackingUris;l<u.length;l++){var c=u[l];a.push({url:c,method:"GET"})}else-1<h.indexOf(e)&&null!=o.trackingEvents&&a.push.apply(a,f(o.trackingEvents,e));0<a.length?this.adEventReporter.send(a,{CONSUMPTIONID:o.sourceUrlStore.get().urlId}):d.warn("The uri for '"+e+"' event with customClickId '"+n+"' cannot be found")}else d.warn("Ignoring beacon URL reporting due to missing SourceUrlStore")}else d.warn("adInstanceId "+t+" has not yet been encountered. Ignoring.")},e.prototype.toggleReporting=function(e){this.adEventReporter.toggleReporting(e)},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId}},e.prototype.terminate=function(){this.playlistEngine.off("EnterItem",this.onEnterItem),this.playlistEngine.off("PlaylistUpdate",this.onPlaylistUpdate)},e}();t.XpPlayerAdReportingFeature=n});e(DV);DV.XpPlayerAdReportingFeature;var NV=t(function(e,t){var u=V&&V.__assign||function(){return(u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var c=M.get("XpPlayerMetricsReportingFeature"),n=function(){function e(e,t){this.version="0.0.1",this.objectId="XpPlayer-Metrics-"+Math.random(),this.mediaEventReporter=e,this.mediaEventController=t}return e.prototype.reportInteraction=function(e,t,n,r,i,o,a){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null);var s=gA.InteractionEventFactory.createInteractionEvent(e,t,n,a,r,i,o);this.mediaEventReporter.enqueueMediaEvents([s])},e.prototype.reportInterface=function(e,t,n){var r=gA.InterfaceEventFactory.createInterfaceEvent(e,t,n);this.mediaEventReporter.enqueueMediaEvents([r])},e.prototype.reportRating=function(e,t,n){var r=gA.RatingEventFactory.createRatingEvent(e,t,n);this.mediaEventReporter.enqueueMediaEvents([r])},e.prototype.reportAcquisition=function(e,t,n,r,i,o){var a=this.mediaEventController.getConsumptionId();if(null!=i||null!=a){var s=u({bitrate:null,fragment:!1,fragmentDuration:null,fragmentIndex:null,fragmentResolution:null},t),l=gA.AcquisitionEventFactory.createAcquisitionEvent(e,s,n,r,xt.withDefault(i,a),xt.withDefault(o,!1));this.mediaEventReporter.enqueueMediaEvents([l])}else c.warn("Not reporting "+e+" Acquisition event: no consumption ID available.")},e.prototype.reportError=function(e,t,n,r){var i;i=t instanceof Error?t.toString():JSON.stringify(t),e?c.error("Client fatal error: "+i):c.warn("Client nonfatal error: "+i),this.mediaEventController.reportError(e,t,n,r)},e.prototype.reportPlayback=function(e){},e.prototype.reportRemote=function(e,t,n){var r=gA.RemoteEventFactory.createRemoteEvent(e,t,n);this.mediaEventReporter.enqueueMediaEvents([r])},e.prototype.setDisplayMode=function(e){this.mediaEventController.setDisplayMode(e)},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId}},e}();t.XpPlayerMetricsReportingFeature=n});e(NV);NV.XpPlayerMetricsReportingFeature;var UV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.version="0.0.1",this.objectId="XpPlayer-Volume-"+Math.random(),this.volumeFeature=e}return Object.defineProperty(e.prototype,"volume",{get:function(){return this.volumeFeature.volume},set:function(e){this.volumeFeature.volume=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this.volumeFeature.muted},set:function(e){this.volumeFeature.muted=e},enumerable:!0,configurable:!0}),e.prototype.offChange=function(e){this.volumeFeature.offChange(e)},e.prototype.onChange=function(e){this.volumeFeature.onChange(e)},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId,muted:this.muted,volume:this.volume}},e}();t.XpPlayerVolumeFeature=n});e(UV);UV.XpPlayerVolumeFeature;var BV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.version="0.0.1",this.objectId="XpPlayer-PictureInPicture-"+Math.random(),this.pictureInPictureFeature=e}return e.prototype.requestPictureInPicture=function(){return this.pictureInPictureFeature.requestPictureInPicture()},e.prototype.exitPictureInPicture=function(){return this.pictureInPictureFeature.exitPictureInPicture()},e.prototype.isPictureInPicture=function(){return this.pictureInPictureFeature.isPictureInPicture()},e.prototype.isSupported=function(){return this.pictureInPictureFeature.isSupported()},e.prototype.offChange=function(e){this.pictureInPictureFeature.offChange(e)},e.prototype.onChange=function(e){this.pictureInPictureFeature.onChange(e)},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId}},e}();t.XpPlayerPictureInPictureFeature=n});e(BV);BV.XpPlayerPictureInPictureFeature;var VV=t(function(e,t){var n,r=V&&V.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var h=M.get("XpPlayer"),o=((n={}).unloaded=Gd.ContentState.Unloaded,n.error=Gd.ContentState.Error,n.ready=Gd.ContentState.Ready,n.waiting=Gd.ContentState.Waiting,n),i=function(){function e(e,t,n){var r,f=this;this.adReportingFeature=null,this.pictureInPictureFeature=null,this.volumeFeature=null,this.canUpdateContentState=!0,this.contentConfig=null,this.playPromise=null,this.playlistPlaybackController=null,this.prsManager=null,this.shouldForceUnloadedEvent=!1,this.userWatchSessionId="",this.version="0.0.1",this.Features=Gd.PlayerFeatures,this.Events=Gd.PlayerEvent,this.error=null,this.contentError=null,this.contentState=Gd.ContentState.Unloaded,this.playbackState=Gd.PlaybackState.Paused,this.doDestroy=function(){h.info(">> doDestroy"),f.excessiveWaitingTracker.destroy(),null!==f.streamFeature&&f.streamFeature.terminate(),null!==f.adReportingFeature&&f.adReportingFeature.terminate(),null!=f.staticTimedTextDataStore&&(f.staticTimedTextDataStore.off("timedTextDownloaded",f.onTimedTextDownloaded),f.staticTimedTextDataStore.off("timedTextDownloadFailed",f.onTimedTextDownloadFailed)),null!=f.playlistPlaybackController&&f.playlistPlaybackController.terminate(),f.timelineManager.terminate(),f.playlistAutoplayBarrier.terminate(),f.playlistEngine.deregisterSeekInterceptor(f.endOfContentSeekInterceptor),f.playlistTrimmer.terminate(),f.playlistTrackingEventReporter.terminate(),null!=f.mediaEventController&&f.mediaEventController.uninitialize(),f.mpPlayerProxy.destroy(),f.hdcpStore.destroy()},this.requestResources=function(e,t){f.loadMetricsCalculator.load();for(var n=e.titleId,r=e.videoMaterialType,i=e.position,o=(e.playbackToken,e.optOutAdTracking,f.prsManager.getInFlightRequests()),a=!1,s=0,l=Object.keys(o);s<l.length;s++){var u=l[s];h.info("Cancelling request for "+u),o[u].cancel(),delete o[u],a=!0}a&&f.unload(),f.excessiveWaitingTracker.waitingStarted(),f.userWatchSessionId=fh.UUID.v4();var c=Fe.CancelToken.source(),d=c.token,p=c.cancel;o[n]={videoMaterialType:r,position:i,cancel:p},f.prsManager.resolve(e,t,f.userWatchSessionId,d).then(function(){d.throwIfRequested();var e=o[n].position,t=xt.withDefault(e,0);f.startingSeekToMainContentPosition(t,n)}).catch(function(e){e instanceof Fe.CancelError||(f.setContentError(e),null!=f.mediaEventController&&f.mediaEventController.reportError("Promo"!==r,e,"Service","Error"))})},this.onContentStateChange=function(e){if(f.canUpdateContentState){if("waiting"===e?(f.shouldForceUnloadedEvent=!1,f.excessiveWaitingTracker.waitingStarted()):f.excessiveWaitingTracker.waitingCompleted(),"error"===e&&null!=f.mpPlayerProxy.contentError){var t=f.mpPlayerProxy.contentError;return-1!==t.code.indexOf("prs.hd_content_not_allowed")?(h.info("Triggering internal restart for HD downgrade:",t),void A.timer.setImmediate(function(){f.internalRestart(),null!=f.videoQualityOverrideStorage&&f.videoQualityOverrideStorage.storeVerifiedSecurePipeline(!1)})):YA.SYE_FALLBACK_ERROR_CODES.some(function(e){return-1!==t.code.indexOf(e)})?(null!==f.prsManager&&null!==f.contentConfig&&f.prsManager.removeSyeUrlsForTitle(f.contentConfig.titleId),h.info("Triggering internal restart for Sye fallback:",t),A.timer.setImmediate(function(){f.internalRestart()}),void MT.metrics.putMetric("LiveLowLatency.Fallback")):(f.setContentError(f.mpPlayerProxy.contentError),void A.timer.setImmediate(function(){f.internalUnload()}))}"unloaded"===e&&lh.getInstance().storeState().catch(function(e){h.info("NetworkRequestManager.storeState failed with reason:",e)}),f.contentState===Gd.ContentState.Error&&f.playbackState===Gd.PlaybackState.Playing&&"error"!==e&&null!=f.playlistPlaybackController?f.playlistPlaybackController.play().then(function(){null!=f.playPromise&&(f.playPromise.resolve(),f.playPromise=null)}).catch(function(e){null!=f.playPromise&&(f.playPromise.reject(e),f.playPromise=null)}):null!=f.playPromise&&f.contentState===Gd.ContentState.Error&&f.playbackState===Gd.PlaybackState.Playing&&"error"===e&&(f.playPromise.reject(f.contentError),f.playPromise=null),f.contentState===Gd.ContentState.Error&&"unloaded"===e||(f.contentState=o[e],f.setContentError(null),f.eventEmitter.emit("ContentStateChange",f.contentState),f.diagnostics.report("contentStateChanged",{positionMs:f.mpPlayerProxy.currentTimeMs,state:f.contentState}))}},this.onPlaybackStateChange=function(e){var t=e.playbackState;"paused"===t?f.playbackState=Gd.PlaybackState.Paused:"playing"===t&&(f.playbackState=Gd.PlaybackState.Playing),f.eventEmitter.emit("PlaybackStateChange",f.playbackState),f.diagnostics.report("playbackStateChanged",{positionMs:f.mpPlayerProxy.currentTimeMs,state:t})},this.onError=function(e){var t=XA.InternalToExternalCodeConverter.convertCode(e);f.error=t,h.warn("PlayerError:",e,", public playerError:",t),f.eventEmitter.emit("Error",t)},this.onTimelineBlocked=function(){var e=f.timelineManager.getTimeline(),t=f.currentTime.currentTimelineItemIndex+1;if(t<e.items.length){var n=e.items[t].error;h.warn("Timeline blocked due to error. Setting content error",n),f.setContentError(n)}else h.warn("Timeline blocked without a next item! Ignoring.")},this.onTimedTextDownloaded=function(e){f.mediaEventController.reportTimedTextAcquisitionSuccess(e)},this.onTimedTextDownloadFailed=function(e){f.mediaEventController.reportTimedTextAcquisitionFailure(e)},this.unloadTitle=function(e){var t=f.prsManager.getInFlightRequests();null!=t[e]?(t[e].cancel(),delete t[e]):h.warn("Attempted to unload non-existent title '"+e+"'")},h.info(">> constructor, with config:",JSON.stringify(e,function(e,t){return"authContext"===e||"surfaceRef"===e?"<REDACTED>":t})),this.playerConfig=e,this.playerSessionId=fh.UUID.v4(),this.mpPlayerProxy=new xV.MpPlayerProxy,this.playlistEngine=new FA.PlaylistEngine,this.staticTimedTextDataStore=new fx.StaticTimedTextDataStore,this.streamFeature=new cO.XpPlayerStreamFeature(this.mpPlayerProxy,this.playlistEngine,this.staticTimedTextDataStore),this.mediaEventController=new eO.MediaEventController(t,this.mpPlayerProxy,e.deviceTypeId,this.streamFeature,this.playerSessionId,e.applicationIdentity,e.clientIdentity),this.metricsReportingFeature=new NV.XpPlayerMetricsReportingFeature(t,this.mediaEventController),this.mediaEventController.initialize(),null!=e.clientId&&this.mediaEventController.updateClientId(e.clientId),r=Fe.CancelToken.source(),this.destroyed=r.token,this.destroyRequested=r.cancel,this.eventEmitter=new Dt.EventEmitter,this.excessiveWaitingTracker=new fO.ExcessiveWaitingTracker(this.mediaEventController),this.endOfContentSeekInterceptor=new tO.EndOfContentSeekInterceptor(this.playlistEngine),this.playlistAutoplayBarrier=new rO.XpAutoplayBarrier(this.playlistEngine),this.playlistTrimmer=new nO.PlaylistTrimmer(this.playlistEngine,this.unloadTitle),this.playlistTrackingEventReporter=new dO.PlaylistTrackingEventReporter(this.playlistEngine),this.publicTimeTranslator=new AV.PublicTimeTranslator(this.playlistEngine),this.timelineManager=new FV.TimelineManager(this.playlistEngine),this.timeDataManager=new LV.TimeDataManager(this.playlistEngine,this.mpPlayerProxy),this.loadMetricsCalculator=new jN.LoadMetricsCalculator(this.mpPlayerProxy);var i={memorySize:new xA.MemorySize(Yh.deviceInformation.storage.fragmentCache.sizeBytes,xA.MemoryUnits.B)};this.playerBufferManager=new xA.PlayerBufferManager(i,this.playlistEngine),this.hdcpStore=new tx.HdcpStore(!1),this.videoQualityOverrideStorage=new iO.VideoQualityOverrideStorage(n),this.diagnostics=pp.Diagnostics.create("XpPlayer"),this.globalStreamControl={onStreamEnd:function(){null!=f.playlistPlaybackController&&f.playlistPlaybackController.onStreamEnd(),f.internalUnload()},onReset:function(){null!=f.playlistPlaybackController&&f.playlistPlaybackController.onReset()},onStreamError:function(e){return f.setContentError(e)},onStreamFatalError:function(e){f.setContentError(e),A.timer.setImmediate(function(){f.internalUnload()})},onStreamRestart:function(e){f.internalUnload(),f.start(e)}},h.info("Player Session ID:",this.playerSessionId)}return Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.timeDataManager.getTimeData()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeline",{get:function(){return this.timelineManager.getTimeline()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.mpPlayerProxy.playbackRate},enumerable:!0,configurable:!0}),e.prototype.initialize=function(){var t=this;h.info(">> initialize");var e=this.playerConfig;this.serviceClientFactory=this.createServiceClientFactory(e),this.mpPlayerProxy.initialize(e.surfaceRef,this.hdcpStore),this.mpPlayerProxy.on("contentStateChange",this.onContentStateChange),this.mpPlayerProxy.on("playbackStateChange",this.onPlaybackStateChange),this.mpPlayerProxy.on("timeupdate",function(e){return t.playerBufferManager.onPosition(e.positionMs)}),this.mpPlayerProxy.on("error",this.onError);var n=this.mpPlayerProxy.getVolumeFeature();null!=n&&(this.volumeFeature=new UV.XpPlayerVolumeFeature(n));var r=this.mpPlayerProxy.getPictureInPictureFeature();null!=r&&(this.pictureInPictureFeature=new BV.XpPlayerPictureInPictureFeature(r)),this.playlistAutoplayBarrier.initialize(!!e.debug&&e.debug.enableInfiniteAutoplay),this.playlistEngine.registerAutoplayBarrier(this.playlistAutoplayBarrier),this.playlistEngine.registerSeekInterceptor(this.endOfContentSeekInterceptor),this.playlistTrimmer.initialize(),this.playlistTrackingEventReporter.initialize(this.volumeFeature);var i=new UA.AdEventReporter;this.adReportingFeature=new DV.XpPlayerAdReportingFeature(i,this.playlistEngine);var o=xt.nestedValue(e,"features.stream",{});this.streamFeature.initialize(),this.streamFeature.configure(o),this.staticTimedTextDataStore.on("timedTextDownloaded",this.onTimedTextDownloaded),this.staticTimedTextDataStore.on("timedTextDownloadFailed",this.onTimedTextDownloadFailed),this.playlistPlaybackController=new RV.PlaylistMediaPlaybackController(this.playlistEngine,this.mpPlayerProxy,this.timeDataManager,this.mediaEventController),this.playlistPlaybackController.initialize(),this.prsManager=new VN.PRSManager(this.serviceClientFactory,this.playlistEngine,this.playlistAutoplayBarrier,this.playlistTrackingEventReporter,this.mpPlayerProxy,{applicationIdentity:e.applicationIdentity,clientId:e.clientId,liveScheduleConfigToken:e.liveScheduleConfigToken,titleDecorationScheme:e.titleDecorationScheme,xrayConfig:e.xray},this.mediaEventController,this.playerBufferManager,this.streamFeature,this.hdcpStore,this.timelineManager,this.timeDataManager,this.globalStreamControl,this.playerSessionId,this.videoQualityOverrideStorage,i),this.timelineManager.initialize(),this.attachProxyListeners(),MT.metrics.putMetric("InitializeCalled")},e.prototype.destroy=function(){var t=this;if(h.info(">> destroy"),this.destroyed.requested)h.warn("Attempted to destroy already-destroyed instance");else if(this.destroyRequested(),null!==this.playlistEngine.getCurrentItem()){null!=this.playPromise&&(this.playPromise.reject(new Error("Destroying player")),this.playPromise=null);var n=function(e){"unloaded"===e&&(t.mpPlayerProxy.off("contentStateChange",n),t.doDestroy())};this.mpPlayerProxy.on("contentStateChange",n),this.unload()}else this.doDestroy()},e.prototype.getFeature=function(e,t){var n=this;return Fe.Promise.resolve().then(function(){if(n.destroyed.throwIfRequested(),e===Gd.PlayerFeatures.MetricsReporting&&null!==n.metricsReportingFeature)return n.metricsReportingFeature;if(e===Gd.PlayerFeatures.AdReporting&&null!==n.adReportingFeature)return n.adReportingFeature;if(e===Gd.PlayerFeatures.Stream&&null!==n.streamFeature)return null!=t&&n.streamFeature.configure(t),n.streamFeature;if(e===Gd.PlayerFeatures.Volume&&null!==n.volumeFeature)return n.volumeFeature;if(e===Gd.PlayerFeatures.PictureInPicture&&null!==n.pictureInPictureFeature)return n.pictureInPictureFeature;throw new Ne.XpError("xp.player.unsupported_feature",void 0,"Feature "+e+" is currently unsupported.")}).catch(function(e){if(n.destroyed.requested)throw new Ne.XpError("xp.player.destroyed",void 0,"Attempting to use a destroyed Player");throw e})},e.prototype.load=function(t,n){var r=this;void 0===n&&(n=!1),h.info(">> load, (contentConfig: "+JSON.stringify(t)+", immediateConsumption: "+n+")");var e=null!=Yh.deviceInformation.software?Yh.deviceInformation.software.advertisingId:null;!0!==t.optOutAdTracking&&null==e&&h.error("AdvertisingId is not available when required by ad tracking."),this.contentConfig=t;var i=this.playlistEngine.getCurrentItem();this.canUpdateContentState=!0,this.shouldForceUnloadedEvent=!0;var o=this.prsManager.getInFlightRequests();if(null===t.position&&(t.position=1/0),null!==i){var a=i.titleId===t.titleId&&i.returnedTitleRendition.videoMaterialType===t.videoMaterialType;if(a&&this.contentState!==Gd.ContentState.Error){var s=o[t.titleId];return null!=t.position&&null!=s.position&&t.position!==s.position?(h.info("Load called with different position: "+t.position+". Seeking to new position."),void this.startingSeekToMainContentPosition(t.position,t.titleId)):void h.info("Load called with titleId: "+t.titleId+", but already loaded. Ignoring.")}if(h.info("Load called with "+(a?"same":"different")+" content while already loaded. Unloading, ContentState: "+this.contentState),"unloaded"!==this.mpPlayerProxy.contentState){var l=function(e){"unloaded"===e&&(r.mpPlayerProxy.off("contentStateChange",l),r.requestResources(t,n))};return this.mpPlayerProxy.on("contentStateChange",l),void this.unload()}this.unload()}else{var u=t.titleId,c=t.videoMaterialType,d=t.position;if(null!=o[u]){var p=o[u];if(c===p.videoMaterialType&&this.contentState!==Gd.ContentState.Error)return null==d||d===p.position?void h.info("Attempted to re-load already loading content "+u+" without unloading. Ignoring."):(h.info("Attempted to load already loading content "+u+" with different position. Updating start position."),void(p.position=d));h.info("Attempted to load already loading content "+u+" with videoMaterialType ("+c+") and ContentState: "+Gd.ContentState.Error)}}this.playbackState===Gd.PlaybackState.Playing&&this.mpPlayerProxy.play(),this.requestResources(t,n)},e.prototype.unload=function(){h.info(">> unload: this.contentState="+this.contentState+", MpPlayer.contentState="+this.mpPlayerProxy.contentState),this.excessiveWaitingTracker.contentUnloaded(),this.internalUnload(),this.canUpdateContentState=!0,null!==this.contentError&&this.setContentError(null),null!==this.prsManager&&this.prsManager.clearHistory(),"unloaded"===this.mpPlayerProxy.contentState&&this.contentState!==Gd.ContentState.Unloaded?(this.contentState=Gd.ContentState.Unloaded,this.eventEmitter.emit("ContentStateChange",Gd.ContentState.Unloaded)):this.shouldForceUnloadedEvent&&this.eventEmitter.emit("ContentStateChange",Gd.ContentState.Unloaded),this.shouldForceUnloadedEvent=!1,this.mediaEventController.reportPlayback("Exit")},e.prototype.internalUnload=function(){h.info(">> internalUnload"),null!=this.playPromise&&(this.playPromise.reject(new Error("Unloading player")),this.playPromise=null),null!=this.streamFeature&&this.streamFeature.unload(),null!=this.playlistPlaybackController&&this.playlistPlaybackController.unloaded(),this.timelineManager.reset(),this.playlistAutoplayBarrier.unloaded(),this.playlistAutoplayBarrier.resetInteractions(),this.loadMetricsCalculator.unload(),null!=this.mediaEventController&&this.mediaEventController.unload();for(var e=this.playlistEngine.removeAllItems(),t=0,n=F.unique(e.map(function(e){return e.contentSource}));t<n.length;t++){var r=n[t];null!=r&&r.stop()}for(var i=this.prsManager.getInFlightRequests(),o=0,a=Object.keys(i);o<a.length;o++){var s=a[o];i[s].cancel(),delete i[s]}null!=this.staticTimedTextDataStore&&this.staticTimedTextDataStore.flushCache()},e.prototype.internalRestart=function(){var e=this.publicTimeTranslator.getCurrentPublicPositionMs();if(this.internalUnload(),null!==this.contentConfig){var t=null!=e?e:this.contentConfig.position;this.start(r({},this.contentConfig,{position:t}))}},e.prototype.start=function(e){h.info(">> start, content: "+JSON.stringify(e)),this.load(e,!0),this.play()},e.prototype.pause=function(){if(h.info(">> pause"),this.metricsReportingFeature.reportInteraction("PlayerSDK","Pause","Client",null,null,null,"Client"),this.diagnostics.report("interaction",{type:"Pause"}),this.playlistAutoplayBarrier.resetInteractions(),this.contentState===Gd.ContentState.Error)return h.warn("Player in the Error state. Deferring pause on MpPlayer."),void(this.playbackState!==Gd.PlaybackState.Paused&&(this.playbackState=Gd.PlaybackState.Paused,this.eventEmitter.emit("PlaybackStateChange",this.playbackState)));this.mpPlayerProxy.pause()},e.prototype.play=function(){var n=this;return h.info(">> play"),this.metricsReportingFeature.reportInteraction("PlayerSDK","Play","Client",null,null,null,"Client"),this.diagnostics.report("interaction",{type:"Play"}),this.mediaEventController.reportPlayback("Open"),this.playlistAutoplayBarrier.resetInteractions(),this.loadMetricsCalculator.play(),this.contentState===Gd.ContentState.Error?(h.warn("Player in the Error state. Deferring play on MpPlayer."),this.playbackState!==Gd.PlaybackState.Playing&&(this.playbackState=Gd.PlaybackState.Playing,this.eventEmitter.emit("PlaybackStateChange",this.playbackState)),null==this.playPromise&&(this.playPromise=new Fe.Deferred),this.playPromise.promise):new Fe.Promise(function(e,t){A.timer.setImmediate(function(){n.playlistPlaybackController.play().then(e).catch(t)})})},e.prototype.seek=function(e,t){null===e&&(e=1/0),h.info(">> seek, to "+e+"ms on timeline item index "+t);var n,r=this.playlistEngine.getCurrentItemIndex();n=null==t||null===r||t===r?e>=this.currentTime.currentPosition?"SeekForward":"SeekBackward":r<t?"SeekForward":"SeekBackward",this.metricsReportingFeature.reportInteraction("PlayerSDK",n,"Client",null,null,null,"Client"),this.diagnostics.report("interaction",{type:n,positionMs:e,itemIndex:t});var i=xt.withDefault(t,r);if(null!=i){this.playlistAutoplayBarrier.resetInteractions();var o=this.playlistEngine.getItems()[i],a=e-o.timelineStart+o.start;this.playlistEngine.seek(a,i)}else h.error("Cannot seek without at least a current item index")},e.prototype.seekToWallClockTime=function(e){this.mpPlayerProxy.seekToWallClockTime(e)},e.prototype.setPlaybackRate=function(e){if(h.info("set playback rate to "+e),e<=0)throw new Error("Do not support zero or negative playback rate");this.mpPlayerProxy.playbackRate=e},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.attachProxyListeners=function(){var t=this;this.timelineManager.on("TimelineChange",function(e){t.eventEmitter.emit("TimelineChange",e)}),this.timelineManager.on("TimelineEnded",function(){t.eventEmitter.emit("TimelineEnded")}),this.timelineManager.on("TimelineBlocked",this.onTimelineBlocked),this.timeDataManager.on("TimeDataChange",function(e){t.eventEmitter.emit("TimeDataChange",e)})},e.prototype.setContentError=function(e){if(null===e)return null!==this.contentError&&h.warn("Clearing contentError"),void(this.contentError=null);this.excessiveWaitingTracker.waitingCompleted(),this.canUpdateContentState=!1;var t=XA.InternalToExternalCodeConverter.convertCode(e);this.contentState=Gd.ContentState.Error,this.contentError=t,h.warn("ContentError:",e,", public contentError:",t),this.mpPlayerProxy.pause(),this.eventEmitter.emit("ContentStateChange",this.contentState),this.eventEmitter.emit("ContentError",t)},e.prototype.startingSeekToMainContentPosition=function(e,t){var n=this.publicTimeTranslator.getPlaylistPosition(e,t);h.info("Requested start position: "+e+". Attempting to start at "+n.position+"ms within item index "+n.playlistItemIndex),this.playlistEngine.seek(n.position,n.playlistItemIndex)},e.prototype.createServiceClientFactory=function(e){var t={deviceID:e.deviceId,deviceTypeID:e.deviceTypeId,gascEnabled:!cw.MarketplaceID.isClassic(e.marketplaceId),marketplaceID:e.marketplaceId};null!=e.uxLocale&&(t.uxLocale=e.uxLocale);var n=Yh.deviceInformation.hardware.zipcode;return null!=n&&(t["comcast-zipcode"]=n),new Qp.ServiceClientFactory(e.deviceProxyUrl,t,e.authContext)},e}();t.XpPlayer=i});e(VV);VV.XpPlayer;var jV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={HDR10:"HDR10",DolbyVision:"DolbyVision"},r={Unknown:"Unknown",None:"None",NoDigitalOutput:"NoDigitalOutput",V1:"V1",V2:"V2",V2_1:"V2_1",V2_2:"V2_2"},i={H264:"H264",H265:"H265"};var o=function(){function e(){this.version="0.0.1",this.eventEmitter=new Dt.EventEmitter,this.verifiedSecurePipeline=!0}return e.prototype.initialize=function(e){var t=this;return this.isInitialized()?Fe.Promise.reject("XpPlayerCapabilitiesFeature.initialize() was called after the instance had been initialized"):(this.storeDisplayCapabilities(e.output.video.display),e.on("output.video.display",function(e){return t.storeDisplayCapabilities(e)}),zk.CodecsQuerier.querySupportedCodecs().then(function(e){return(null!=e.supportedVideoCodecs?e.supportedVideoCodecs:[]).filter(function(e){return null!=i[e]}).map(function(e){return i[e]})}).then(function(e){t.videoCodecs=e}))},e.prototype.getDeviceCapabilities=function(){return this.isInitialized()?Fe.Promise.resolve([{maxVideoOutputResolution:this.maxVideoResolution,hdrFormats:this.hdrFormats,hdcpStatus:this.hdcpStatus,videoCodecs:this.videoCodecs,verifiedSecurePipeline:this.verifiedSecurePipeline}]):Fe.Promise.reject(Error("XpPlayerCapabilitiesFeature.getDeviceCapabilities() was called before the instance was initialized"))},e.prototype.setVerifiedSecurePipeline=function(e){e!==this.verifiedSecurePipeline&&this.eventEmitter.emit("VerifiedSecurePipelineChange",e),this.verifiedSecurePipeline=e},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.isInitialized=function(){return!!(this.maxVideoResolution||this.hdrFormats||this.hdcpStatus||this.videoCodecs)},e.prototype.storeDisplayCapabilities=function(e){this.maxVideoResolution={width:e.width,height:e.height},this.hdrFormats=e.dynamicRangeFormatSupport.map(function(e){return n[e]}),this.hdcpStatus=r[e.hdcpStatus]},e}();t.XpPlayerCapabilitiesFeature=o});e(jV);jV.XpPlayerCapabilitiesFeature;var XV=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={})[0]="debug",n[1]="info",n[2]="info",n[3]="warn",n[4]="error",n);t.LogLevelToFirewoodLevelMap=r});e(XV);XV.LogLevelToFirewoodLevelMap;var zV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.setSushiConfiguration(e,t)}return e.prototype.setSushiConfiguration=function(e,t){this.eelEndpoint="https://"+e+"/1/events/"+t},e.prototype.send=function(n){var o=this,a=this.eelEndpoint;(new Op.ExponentialBackoffRetry).withMaxAttempts(2).withInitialIntervalMs(5e3).withExponentialFactor(5).onAttempt(function(e,r,t,i){new mp.HttpRequest("POST",a).json(o.buildPayloadObject(n)).onLoad(function(e){return t(e)}).timeout(6e3).onError(function(e,t){if(null==t)r(e);else{var n=t.getStatus();500<=n&&n<=599?r(e):429===n?r(e):i(e)}}).send()}).execute()},e.prototype.buildPayloadObject=function(e){return{events:e.map(function(e){return{data:e}})}},e}();t.EelClient=n});e(zV);zV.EelClient;var qV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n,r,i,o){void 0===i&&(i=0),void 0===o&&(o=new zV.EelClient(e,t));var a=this;this.pendingLogs=[],this.pendingLogsSize=0,this.fields=null,this.flush=function(){A.timer.clearTimeout(a.postIntervalId),0<a.pendingLogs.length&&(a.logSender.send(a.pendingLogs),a.pendingLogs=[],a.pendingLogsSize=0),a.postIntervalId=A.timer.setTimeout(a.flush,6e4)},this.deviceId=n,this.deviceTypeId=r,this.logSender=o,this.logLevel=i,this.postIntervalId=A.timer.setTimeout(this.flush,6e4),this.baseLineSize=this.estimateBaseLineSize()}return e.prototype.setSushiConfiguration=function(e,t){this.flush(),this.logSender.setSushiConfiguration(e,t)},e.prototype.setPlayerVersion=function(e){this.playerVersion=e,this.baseLineSize=this.estimateBaseLineSize()},e.prototype.setAppInstanceId=function(e){this.appInstanceId=e,this.baseLineSize=this.estimateBaseLineSize()},e.prototype.setFields=function(e){this.fields=e,this.baseLineSize=this.estimateBaseLineSize()},e.prototype.getLevel=function(){return this.logLevel},e.prototype.setLevel=function(e){this.logLevel=e},e.prototype.write=function(e,t){if(!(e<this.logLevel)){var n=this.toLogLine(XV.LogLevelToFirewoodLevelMap[e],t),r=this.estimateLogSize(n.message);838860.8<this.pendingLogsSize+r&&this.flush(),this.pendingLogs.push(n),this.pendingLogsSize+=r,500<=this.pendingLogs.length&&this.flush()}},e.prototype.toLogLine=function(e,t){var n={deviceId:this.deviceId,deviceTypeId:this.deviceTypeId,level:e,message:t,timestamp:Date.now(),app:"XpPlayer",appInstanceId:this.appInstanceId,playerVersion:this.playerVersion};if(null==this.fields)return n;for(var r=0,i=Object.keys(this.fields);r<i.length;r++){var o=i[r];n[o]=this.fields[o]}return n},e.prototype.estimateBaseLineSize=function(){var e=this.toLogLine("debug","");return JSON.stringify(e).length},e.prototype.estimateLogSize=function(e){return this.baseLineSize+e.length},e}();t.FirewoodLogSink=n});e(qV);qV.FirewoodLogSink;var WV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FirewoodLogSink=qV.FirewoodLogSink,t.EelClient=zV.EelClient});e(WV);WV.FirewoodLogSink,WV.EelClient;var HV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=["fragmentDownloaded","fragmentDownloadFailed","qualityChanged","playbackStateChanged","contentStateChanged","sourceBufferChanged","fragmentBufferChanged","cdnSwitched","interaction"],n=function(){function e(e,t){this.events=[],this.appInstanceId=null,this.sushiClient=new WV.EelClient(e,t)}return e.prototype.setAppInstanceId=function(e){this.appInstanceId=e},e.prototype.setSushiConfiguration=function(e,t){this.sushiClient.setSushiConfiguration(e,t)},e.prototype.onEvent=function(e,t,n){null!=this.appInstanceId&&-1!==r.indexOf(t)&&(this.events.push({timestamp:Date.now(),appInstanceId:this.appInstanceId,componentId:e,event:t,data:n}),100<=this.events.length&&this.flush())},e.prototype.flush=function(){this.sushiClient.send(this.events),this.events=[]},e}();t.PlaybackDiagnosticsSink=n});e(HV);HV.PlaybackDiagnosticsSink;var GV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.XpPlayer=VV.XpPlayer,t.XpPlayerCapabilitiesFeature=jV.XpPlayerCapabilitiesFeature,t.XpPlayerMetricsReportingFeature=NV.XpPlayerMetricsReportingFeature,t.PlaybackDiagnosticsSink=HV.PlaybackDiagnosticsSink});e(GV);GV.XpPlayer,GV.XpPlayerCapabilitiesFeature,GV.XpPlayerMetricsReportingFeature,GV.PlaybackDiagnosticsSink;var KV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.weblabResponseProcessor=function(e,t,n,r){var i={},o=e.getText();if(null!=o){var a=void 0;try{a=JSON.parse(o)}catch(e){return void r(e)}if(null!=a&&null!=a.TreatmentList)for(var s=0,l=a.TreatmentList;s<l.length;s++){var u=l[s];i[u.weblabName]=u.treatmentName}}t(i)};this.serviceClient=e.createServiceClient("/cdp/usage/GetWeblabTreatment",{firmware:"1"},this.weblabResponseProcessor)}return e.prototype.send=function(e,t){var n={accept:"application/json","content-type":"application/json"};null!=e.sessionId&&(n["x-atv-session-id"]=e.sessionId);var r={method:"POST",timeoutMs:4e3,headers:n,body:JSON.stringify({WeblabList:e.weblabs}),queryParams:{}};return this.serviceClient.send(r,t,"CRITICAL",!1)},e}();t.WeblabClient=n});e(KV);KV.WeblabClient;var QV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.WeblabClient=KV.WeblabClient});e(QV);QV.WeblabClient;var YV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.context=e}return e.prototype.setAuthContext=function(e){this.context=e},e.prototype.getHeaders=function(){return this.context.headers},e}();t.AuthContextWrapper=n});e(YV);YV.AuthContextWrapper;var JV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=M.get("CachingServiceCall");function a(r,e,i){return e().then(function(e){var t=Yh.deviceInformation.software.playerBundle;if(!RI.metadataStorage.capabilities.isSupported||null==t)return e;var n={expiryTimeMs:Date.now()+i,value:e,version:t.version};return RI.metadataStorage.put(r,n).catch(function(){}).then(function(){return e})})}t.makeCachedServiceCall=function(r,i,o){return RI.metadataStorage.capabilities.isSupported?RI.metadataStorage.get(r).catch(function(e){return n.error("MetadataStorage retrieval failed due to error: "+e),null}).then(function(e){var t=Yh.deviceInformation.software.playerBundle,n=e;return null==n||null==t||n.version!==t.version?a(r,i,o):(n.expiryTimeMs<Date.now()&&a(r,i,o),n.value)}):a(r,i,o)}});e(JV);JV.makeCachedServiceCall;var $V=t(function(e,t){var l=V&&V.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var u=M.get("LogFieldsParser"),n=function(){function e(e){this.marketplaceId=e}return e.prototype.getFields=function(e){var t={};return this.extractGeneralFields(t,e.general),this.extractDeviceInformationFields(t,e.deviceInformation),t},e.prototype.extractGeneralFields=function(e,t){if(null!=t)for(var n=0,r=t;n<r.length;n++){var i=r[n];"marketplaceId"===i&&(e[i]=this.marketplaceId)}},e.prototype.extractDeviceInformationFields=function(e,t){if(null!=t){for(var n={},r=0,i=t;r<i.length;r++){var o=i[r],a=xt.nestedValue(Yh.deviceInformation,o,null);null!=a&&this.deepSet(n,o,a)}0<Object.keys(n).length&&(e.device=n)}},e.prototype.deepSet=function(e,t,n){for(var r=t.split("."),i=e,o=0;o<r.length-1;o++){var a=r[o];if(null!=i[a]){if("object"!=typeof i[a])return void u.error("path "+t+" already contains a value at key "+a+" !!!. existing value: "+JSON.stringify(i[a])+" new value: "+JSON.stringify(n));i=i[a]}else i=i[a]={}}var s=r[r.length-1];null!=i[s]?"object"!=typeof i[s]||"object"!=typeof n?i[s]!==n&&u.warn("Path "+t+" already contains a value at last node !!!. existing value: "+JSON.stringify(i[s])+" new value: "+JSON.stringify(n)):i[s]=l({},i[s],n):i[s]=n},e}();t.LogFieldsProvider=n});e($V);$V.LogFieldsProvider;var ZV=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.version="0.0.1",this.mediaEventReporter=e}return e.prototype.getAppInstanceId=function(){return this.mediaEventReporter.getAppInstanceId()},e}();t.XpPlayerSDKMetricsReportingFeature=n});e(ZV);ZV.XpPlayerSDKMetricsReportingFeature;var ej=t(function(e,i){var t,s=V&&V.__assign||function(){return(s=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},c=V&&V.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n};Object.defineProperty(i,"__esModule",{value:!0});var n=Yh,r=((t={}).Debug=0,t.Info=1,t.Log=2,t.Warn=3,t.Error=4,t.Off=5,t),a={DEBUG:M.DEBUG,INFO:M.INFO,WARN:M.WARN,ERROR:M.ERROR,OFF:M.OFF};i.DEFAULT_LOGGING_LEVELS={SeekController:"WARN",FragmentLoader:"WARN",DriftTracker:"WARN",XpPlayerStreamFeature:"WARN",UpdateStreamListener:"WARN",VideoStreamSelector:"WARN",ContentLevelAdapterMSE:"WARN"};var l="ipv6.unagi-na.amazon.com",u="com.amazon.eel.pv.xpplayer.prod",d="com.amazon.eel.pv.xp.diagnostics.prod",p=M.get("XpPlayerSDK"),o=function(){function e(e,t){var n=this;this.version="to-be-injected",this.Features=Gd.PlayerSDKFeatures,this.xpPlayer=null,this.serverConfig={loggers:i.DEFAULT_LOGGING_LEVELS},this.serviceClientFactory=null,this.xpLocalContentManagerFeature=null,this.xpLocalContentManagerFeaturePromise=null,this.xpPlayerCapabilitiesFeaturePromise=null,this.xpPlayerSDKMetricsReportingFeature=null,this.config=e;var r={objectBridge:t};vh.platformRuntime.configure(r),this.initializeLogging(e),this.configureMetricsReporter(e,cw.MarketplaceID.US,"Unknown"),this.authContextWrapper=new YV.AuthContextWrapper(this.config.authContext),this.mediaEventReporter=new gA.MediaEventReporter,this.xpPlayerCapabilitiesFeature=new GV.XpPlayerCapabilitiesFeature,null!=this.firewoodLogSink&&this.mediaEventReporter.on("bootstrappingConfigurationFetched",function(e){n.firewoodLogSink.setAppInstanceId(e.appInstanceId)}),null!=this.playbackDiagnosticSink&&this.mediaEventReporter.on("bootstrappingConfigurationFetched",function(e){n.playbackDiagnosticSink.setAppInstanceId(e.appInstanceId)}),this.serviceClientConfigDeferred=new Fe.Deferred,this.initializationPromise=this.initializeComponents(this.config)}return e.prototype.destroy=function(){var o=this;null!=this.xpPlayer&&this.xpPlayer.destroy(),null!=this.xpLocalContentManagerFeature&&this.xpLocalContentManagerFeature.getAllDownloadOperations().then(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];t.push(o.xpLocalContentManagerFeature.pause(i.id))}return o.xpLocalContentManagerFeature=null,Fe.Promise.all(t)}),this.serviceClientConfigDeferred.reject(new Fe.CancelError),this.xpPlayer=null,this.xpLocalContentManagerFeaturePromise=null,this.xpPlayerCapabilitiesFeaturePromise=null,(this.xpPlayerSDKMetricsReportingFeature=null)!=this.playbackDiagnosticSink&&pp.Diagnostics.addSink(this.playbackDiagnosticSink)},e.prototype.getFeature=function(e,t){var n=this;return this.initializationPromise.then(function(){if(e===Gd.PlayerSDKFeatures.Player)return null!=n.firewoodLogSink&&n.firewoodLogSink.flush(),n.xpPlayer=new GV.XpPlayer(n.mergePlayerConfigDefaults(t),n.mediaEventReporter,n.xpPlayerCapabilitiesFeature),n.xpPlayer.initialize(),n.registerUnhandledEventListenerCallback(n.mediaEventReporter),n.xpPlayer;if(e===Gd.PlayerSDKFeatures.LocalContentManager){if(null==n.xpLocalContentManagerFeaturePromise){if(null==t)throw new Error("Attempting to create LocalContentManager without a config object");n.xpLocalContentManagerFeature=new uR.XpLocalContentManagerFeature(n.serviceClientFactory,n.mergeLocalContentManagerConfigDefaults(t)),n.xpLocalContentManagerFeaturePromise=n.xpLocalContentManagerFeature.initialize().then(function(){return n.xpLocalContentManagerFeature})}return n.xpLocalContentManagerFeaturePromise}if(e===Gd.PlayerSDKFeatures.MetricsReporting){if(null==n.xpPlayerSDKMetricsReportingFeature)throw new Error("XpPlayerSDK instance has already been destroyed.");return n.xpPlayerSDKMetricsReportingFeature}if(e===Gd.PlayerSDKFeatures.PlayerCapabilities)return null==n.xpPlayerCapabilitiesFeaturePromise&&(n.xpPlayerCapabilitiesFeaturePromise=n.xpPlayerCapabilitiesFeature.initialize(Yh.deviceCapabilities).then(function(){return n.xpPlayerCapabilitiesFeature})),n.xpPlayerCapabilitiesFeaturePromise;throw new Error("Feature '"+Gd.PlayerSDKFeatures[e]+"' is currently unsupported.")})},e.prototype.registerUnhandledEventListenerCallback=function(i){var n=function(e,t){MT.metrics.putMetric("UnhandledEventListenerError");var n=gA.ErrorEventFactory.createErrorDetails(e);n.message.generic="UnhandledEventListenerError",n.message.specific="Unhandled event listener error "+(null!=t?"for "+t:"")+": "+n.message.specific;var r=gA.ErrorEventFactory.createErrorEvent("Player","Error",!1,n);i.enqueueMediaEvents([r])};Dt.EventEmitter.onUnhandledEventListener(function(e,t){n(e,t)}),Dt.MulticastCallback.onUnhandledEventListener(function(e){n(e)})},e.prototype.getServiceClientConfig=function(){return this.serviceClientConfigDeferred.promise},e.prototype.setAuthContext=function(e){this.authContextWrapper.setAuthContext(e)},e.prototype.mergePlayerConfigDefaults=function(e){return e.authContext=this.authContextWrapper,e.deviceId=this.config.deviceId,e.deviceProxyUrl=this.deviceProxyUrl,e.deviceTypeId=this.config.deviceTypeId,e.marketplaceId=this.marketplaceId,e.clientIdentity=this.config.clientIdentity,e.applicationIdentity=this.config.applicationIdentity,e},e.prototype.mergeLocalContentManagerConfigDefaults=function(e){return null==e.titleDecorationScheme&&(e.titleDecorationScheme="primary-content"),e.clientIdentity=this.config.clientIdentity,e.applicationIdentity=this.config.applicationIdentity,e},e.prototype.initializeLogging=function(e){var t=e.debug,n=this.getLogConfig(t),r=new IR.JSLoggerLogSource;r.setLevel(n.generalLogLevel);var i=new IR.PlatformLogSource;if(i.setLevel(n.platformLogLevel),5!==n.consoleLogLevel){var o=new IR.PlatformLogSink(n.consoleLogLevel),a=new IR.LogRouter;a.addSinks(o),a.addSources(r,i)}if(e.deviceId&&e.deviceTypeId&&5!==n.remoteLogLevel){var s=new IR.LogRouter;this.firewoodLogSink=new WV.FirewoodLogSink(l,u,e.deviceId,e.deviceTypeId),this.firewoodLogSink.setLevel(n.remoteLogLevel),s.addSources(r,i),s.addSinks(this.firewoodLogSink)}(F.isBoolean(t)?t:null!=t)&&(this.playbackDiagnosticSink=new GV.PlaybackDiagnosticsSink(l,d),pp.Diagnostics.addSink(this.playbackDiagnosticSink))},e.prototype.getLogConfig=function(e){var t={consoleLogLevel:5,generalLogLevel:1,platformLogLevel:1,remoteLogLevel:1};return(F.isBoolean(e)?e:null!=e)&&(t.consoleLogLevel=r[xt.withDefault(e.consoleLogLevel,"Info")],t.generalLogLevel=r[xt.withDefault(e.generalLogLevel,"Info")],t.platformLogLevel=r[xt.withDefault(e.platformLogLevel,"Info")],t.remoteLogLevel=r[xt.withDefault(e.remoteLogLevel,"Info")]),t},e.prototype.initializeComponents=function(a){var u=this;return Fe.Promise.all([this.promisifyInitMethod(n.initDeviceInformation,{deviceTypeId:a.deviceTypeId}),this.promisifyInitMethod(n.initDeviceCapabilities,{})]).then(function(){var e=Yh.deviceInformation.software.playerBundle;null!=u.firewoodLogSink&&null!=e&&u.firewoodLogSink.setPlayerVersion(e.version)}).then(function(){return JV.makeCachedServiceCall("gasc_metadata",function(){return u.sendDeviceInitializationRequest(a)},36e5)}).then(function(e){u.deviceProxyUrl=e.baseUrl,u.marketplaceId=e.marketplaceId;var t=Yh.deviceInformation.software.middleware,n=null!=t?t.name:"Unknown";u.configureMetricsReporter(a,u.marketplaceId,n);var r=u.createBaseServiceClientParameters(),i=s({},r,{deviceProxyUrl:u.deviceProxyUrl});u.serviceClientConfigDeferred.resolve(i),u.serviceClientFactory=new Qp.ServiceClientFactory(u.deviceProxyUrl,r,u.authContextWrapper),null!=e.deviceConfig&&null!=e.deviceConfig.values&&u.mergeServerConfig(e.deviceConfig.values);var o=gA.MediaEventConstants.getReportingServiceUrlFromMarketplaceId(u.marketplaceId);return u.mediaEventReporter.initialize(o,u.authContextWrapper),u.xpPlayerSDKMetricsReportingFeature=new ZV.XpPlayerSDKMetricsReportingFeature(u.mediaEventReporter),u.getWeblabConfig()}).then(function(e){var t=u.serverConfig,n=t.weblabs,r=c(t,["weblabs"]);if(null!=n)for(var i=0,o=Object.keys(e);i<o.length;i++){var a=o[i],s=e[a];try{var l=n[a][s];null!=l&&wI.applyPatch(r,l)}catch(e){p.error("Failed to apply patch for weblab "+a+" with treatment "+s,e)}}r.weblabs=e,up.configurationStore.configuration=r,u.configureLoggers(),F.isEmpty(e)||p.info("Weblabs:",JSON.stringify(e))}).catch(function(e){throw p.error("Failed to initialize PlayerSDK:",e),u.serviceClientConfigDeferred.reject(e),e instanceof Fe.CancelError||(MT.metrics.putMetric("PlayerSDK.InitializationFailed"),MT.metrics.flush()),e})},e.prototype.sendDeviceInitializationRequest=function(e){var t=new cw.DeviceInitializationServiceClient(e.deviceId,e.deviceTypeId,this.authContextWrapper,e.route),n=Fe.CancelToken.source().token;return t.send(n).then(function(e){return e.on("latency",function(e){MT.metrics.putMetric("ServiceRequest.DIS.RequestLatencyTime",e,"ms")}),e.on("success",function(e){MT.metrics.putMetric("ServiceRequest.DIS.SuccessfulRequestAtAttempt",e.attempt)}),e.response()}).catch(function(e){throw MT.metrics.putMetric("ServiceRequest.DIS.Error"),e})},e.prototype.createBaseServiceClientParameters=function(){var e={deviceID:this.config.deviceId,deviceTypeID:this.config.deviceTypeId,gascEnabled:!cw.MarketplaceID.isClassic(this.marketplaceId),marketplaceID:this.marketplaceId},t=Yh.deviceInformation.hardware.zipcode;return null!=t&&(e["comcast-zipcode"]=t),e},e.prototype.configureMetricsReporter=function(e,t,n){var r=fh.UUID.v4(),i=e.deviceTypeId,o=new II.MetricsPublisher("ATVXpPlayer","dv-xp-player",t,r,[{host:"XP"},{host:i},{host:i,client:n}],20,6e4);MT.metrics.setHandler(function(e,t,n){o.putMetric("XpPlayer","."+e,t,n)}),MT.metrics.setFlusher(function(){o.flush()})},e.prototype.configureLoggers=function(){var e=up.configurationStore.configuration;if(null!=e){if(null!=e.firewood&&null!=this.firewoodLogSink&&(this.firewoodLogSink.setSushiConfiguration(xt.withDefault(e.firewood.sushiEndpoint,l),xt.withDefault(e.firewood.sushiSourceGroup,u)),null!=e.firewood.logFields)){var t=new $V.LogFieldsProvider(this.marketplaceId).getFields(e.firewood.logFields);this.firewoodLogSink.setFields(t)}if(null!=e.loggers){if(null!=e.loggers["*"]&&"string"==typeof e.loggers["*"]){var n=e.loggers["*"].toUpperCase();null==a[n]?p.warn("Ignoring configuration for global logger: Level \""+n+"\" is not valid"):M.setLevel(a[n])}for(var r=0,i=Object.keys(e.loggers);r<i.length;r++){var o=i[r];if("*"!==o&&(null!=e.loggers[o]&&"string"==typeof e.loggers[o])){n=e.loggers[o].toUpperCase();if(null==a[n]){p.warn("Ignoring configuration for logger \""+o+"\": Level \""+n+"\" is not valid");continue}M.get(o).setLevel(a[n])}}null!=e.playbackDiagnostics&&null!=this.playbackDiagnosticSink&&this.playbackDiagnosticSink.setSushiConfiguration(xt.withDefault(e.playbackDiagnostics.sushiEndpoint,l),xt.withDefault(e.playbackDiagnostics.sushiSourceGroup,d))}}},e.prototype.getWeblabConfig=function(){var e=new QV.WeblabClient(this.serviceClientFactory),t=this.serverConfig.weblabs;if(null==t)return Fe.Promise.resolve({});var n=Fe.CancelToken.source().token,r=Object.keys(t),i={weblabs:r};return e.send(i,n).then(function(e){return e.on("latency",function(e){MT.metrics.putMetric("ServiceRequest.Weblabs.RequestLatencyTime",e,"ms")}),e.response()}).catch(function(e){return p.error("Failed to acquire weblabs: "+r,e),MT.metrics.putMetric("ServiceRequest.Weblabs.Error"),{}})},e.prototype.promisifyInitMethod=function(e,r){return new Fe.Promise(function(t,n){e(r,function(e){null!=e?n(e):t()})})},e.prototype.mergeServerConfig=function(e){for(var t=null,n=0,r=e;n<r.length;n++){var i=r[n];if("xp.config"===i.key){t=i.value;break}}if(null!=t)try{this.serverConfig=xt.deepExtend(this.serverConfig,JSON.parse(t))}catch(e){p.error("Failed to parse DIS configuration. Using built-in defaults",e),MT.metrics.putMetric("ServiceRequest.DIS.ServerConfig.Error.Parse")}},e}();i.XpPlayerSDK=o});e(ej);ej.DEFAULT_LOGGING_LEVELS,ej.XpPlayerSDK;var tj=Fe.Promise,nj=function(){function e(e){void 0===e&&(e=JSON),this.jsonInstance=e}return e.prototype.encode=function(t){var n=this;return new tj(function(e){e(n.jsonInstance.stringify(t,n.JSONReplacer))})},e.prototype.decode=function(t){var n=this;return new tj(function(e){e(n.jsonInstance.parse(t))})},e.prototype.JSONReplacer=function(e,t){if(t&&t instanceof Error){for(var n={name:t.name,message:t.message},r=0,i=Object.getOwnPropertyNames(t);r<i.length;r++){var o=i[r];n[o]=t[o]}return n}return t},e}(),rj=function(e,t,n){this.name="AvpRpcError",this.code=e,this.message=t,this.stack=n},ij=Fe.Deferred,oj=Fe.Promise,aj=(S.of("CallMessageHandler"),M.get("CallMessageHandler")),sj=function(){function e(e){var n=this;this.onRequest=function(t){n.callObjectMethod(t.object_id,t.method_name,t.args).then(function(e){xt.exists(n.transceiver)&&n.transceiver.sendMessage("call_response",{id:t.id,result:e})}).catch(function(e){xt.exists(n.transceiver)&&n.transceiver.sendMessage("call_response",{id:t.id,result:null,error:e})})},this.onResponse=function(e){var t=n.callIdMap[e.id];xt.isNullOrUndefined(t)?aj.warn("Received an unexpected \"call_response\" with id: "+e.id):(xt.exists(e.error)?t.reject(e.error):t.resolve(e.result),delete n.callIdMap[e.id])},this.idVendor=e.idVendor,this.transceiver=e.transceiver,this.objectMap=e.objectMap,this.callIdMap={},this.transceiver.onMessage("call",this.onRequest),this.transceiver.onMessage("call_response",this.onResponse)}return e.prototype.destroy=function(){for(var e=0,t=F.values(this.callIdMap);e<t.length;e++){t[e].reject(new Error("Bridge is shutting down"))}xt.exists(this.transceiver)&&(this.transceiver.offMessage("call",this.onRequest),this.transceiver.offMessage("call_response",this.onResponse)),this.objectMap={},this.callIdMap={},this.idVendor=null,this.transceiver=null},e.prototype.call=function(e,t,n){var r=this,i=this.idVendor.get(),o=new ij;return this.callIdMap[i]=o,this.transceiver.sendMessage("call",{id:i,object_id:e,method_name:t,args:n}).catch(function(e){throw delete r.callIdMap[i],e}).then(function(){return o.promise})},e.prototype.callObjectMethod=function(e,t,n){var r=this.objectMap[e];if(xt.isNullOrUndefined(r)){var i=new rj("avp_rpc_invalid_object_id","Call failed: no object with id \""+e+"\"");return oj.reject(i)}try{var o=r[t];if(!F.isFunction(o)){i=new rj("avp_rpc_invalid_method_name","Call failed: object \""+e+"\" has no method \""+t+"\"");return oj.reject(i)}return oj.resolve(o.apply(r,n))}catch(e){return oj.reject(e)}},e}(),lj=function(){function e(e){var o=this;this.onSubscribe=function(n){var t={id:n.id,object_id:n.object_id,event_name:n.event_name},e=o.objectMap[n.object_id];if(xt.isNullOrUndefined(e))t.error=new rj("avp_rpc_invalid_object_id","Subscribe failed: no object with id \""+n.object_id+"\"");else{var r=o.getObjectEventPairName(n.object_id,n.event_name);if(o.eventAttachedMap[r])t.error=new rj("avp_rpc_already_subscribed","Received subscribe request to "+n.object_id+"."+n.event_name+", but already subscribed.");else try{var i=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.sendEventMessage(n.object_id,n.event_name,e)};o.eventAttachedMap[r]={objectId:n.object_id,eventName:n.event_name,callback:i},e.on(n.event_name,i)}catch(e){t.error=e}}o.transceiver.sendMessage("subscribe_response",t)},this.onUnsubscribe=function(e){var t={id:e.id,object_id:e.object_id,event_name:e.event_name},n=o.objectMap[e.object_id];if(xt.isNullOrUndefined(n))t.error=new rj("avp_rpc_invalid_object_id","Unsubscribe failed: no object with id \""+e.object_id+"\"");else{var r=o.getObjectEventPairName(e.object_id,e.event_name);if(xt.isNullOrUndefined(o.eventAttachedMap[r]))t.error=new rj("avp_rpc_not_subscribed","Received unsubscribe request to "+e.object_id+"."+e.event_name+", but not subscribed.");else try{n.off(e.event_name,o.eventAttachedMap[r].callback),delete o.eventAttachedMap[r]}catch(e){t.error=e}}o.transceiver.sendMessage("unsubscribe_response",t)},this.sendEventMessage=function(e,t,n){o.transceiver.sendMessage("event",{id:o.idVendor.get(),object_id:e,event_name:t,payloads:n})},this.idVendor=e.idVendor,this.transceiver=e.transceiver,this.objectMap=e.objectMap,this.eventAttachedMap={},this.transceiver.onMessage("subscribe",this.onSubscribe),this.transceiver.onMessage("unsubscribe",this.onUnsubscribe)}return e.prototype.destroy=function(){xt.exists(this.transceiver)&&(this.transceiver.offMessage("subscribe",this.onSubscribe),this.transceiver.offMessage("unsubscribe",this.onUnsubscribe));for(var e=0,t=Object.keys(this.eventAttachedMap);e<t.length;e++){var n=t[e],r=this.eventAttachedMap[n];this.objectMap[r.objectId].off(r.eventName,r.callback)}this.objectMap={},this.eventAttachedMap={},this.idVendor=null,this.transceiver=null},e.prototype.deregister=function(e){for(var t=0,n=Object.keys(this.eventAttachedMap);t<n.length;t++){var r=n[t],i=this.eventAttachedMap[r];i.objectId===e&&this.objectMap[i.objectId].off(i.eventName,i.callback)}},e.prototype.getObjectEventPairName=function(e,t){return e+"-"+t},e}(),uj=Dt.EventEmitter,cj=Fe.Deferred,dj=Fe.Promise,pj=(S.of("EventSubscriberHandler"),M.get("EventSubscriberHandler")),fj=function(){function e(e){var r=this;this.eventEmitter=new uj,this.onUnsubscribeResponse=function(e){var t=r.getObjectEventPairName(e.object_id,e.event_name),n=r.unsubscribeMap[t];xt.exists(n)?(xt.exists(e.error)?n.reject(e.error):n.resolve(void 0),delete r.unsubscribeMap[t]):pj.warn("Received duplicate UnsubscribeResponse.")},this.onSubscribeResponse=function(e){var t=r.getObjectEventPairName(e.object_id,e.event_name),n=r.subscribeMap[t];xt.exists(n)&&xt.exists(n.pending)?(xt.exists(e.error)?(r.eventEmitter.removeAllListeners(t),n.pending.reject(e.error)):n.pending.resolve(void 0),delete r.subscribeMap[t].pending):pj.warn("Received duplicate SubscribeResponse.")},this.onEventReceived=function(e){var t=r.getObjectEventPairName(e.object_id,e.event_name);r.eventEmitter.emit.apply(r.eventEmitter,[t].concat(e.payloads))},this.idVendor=e.idVendor,this.transceiver=e.transceiver,this.subscribeMap={},this.unsubscribeMap={},this.transceiver.onMessage("subscribe_response",this.onSubscribeResponse),this.transceiver.onMessage("unsubscribe_response",this.onUnsubscribeResponse),this.transceiver.onMessage("event",this.onEventReceived)}return e.prototype.destroy=function(){xt.exists(this.transceiver)&&(this.transceiver.offMessage("subscribe_response",this.onSubscribeResponse),this.transceiver.offMessage("unsubscribe_response",this.onUnsubscribeResponse),this.transceiver.offMessage("event",this.onEventReceived));for(var e=0,t=Object.keys(this.subscribeMap);e<t.length;e++){var n=t[e],r=this.subscribeMap[n];xt.exists(r.pending)&&r.pending.reject(new Error("Bridge was shutdown while waiting to subscribe."))}for(var i=0,o=Object.keys(this.unsubscribeMap);i<o.length;i++){n=o[i];this.unsubscribeMap[n].reject(new Error("Bridge was shutdown while waiting to unsubscribe."))}this.subscribeMap={},this.unsubscribeMap={},this.idVendor=null,this.transceiver=null},e.prototype.on=function(e,t,n){var r=this.getObjectEventPairName(e,t);if(this.eventEmitter.on(r,n),xt.isNullOrUndefined(this.subscribeMap[r])){var i=new cj;return this.subscribeMap[r]={pending:i},this.transceiver.sendMessage("subscribe",{id:this.idVendor.get(),object_id:e,event_name:t}).then(function(){return i.promise})}return xt.exists(this.subscribeMap[r].pending)?this.subscribeMap[r].pending.promise:dj.resolve()},e.prototype.off=function(e,t,n){var r=this.getObjectEventPairName(e,t);if(this.eventEmitter.off(r,n),0===this.eventEmitter.listeners(r).length&&xt.exists(this.subscribeMap[r])){var i=this.subscribeMap[r].pending;xt.exists(i)&&i.reject(new Error("Listener for "+e+"."+t+" removed while waiting to attach.")),delete this.subscribeMap[r];var o=new cj;return this.unsubscribeMap[r]=o,this.transceiver.sendMessage("unsubscribe",{id:this.idVendor.get(),object_id:e,event_name:t}).then(function(){return o.promise})}return dj.resolve()},e.prototype.getObjectEventPairName=function(e,t){return e+"-"+t},e}(),hj=function(){function e(e){this.counter=0,this.prefix=e+"-"+Math.random()+"-"}return e.prototype.get=function(){return this.prefix+this.counter++},e}(),mj=Dt.MulticastCallback,yj=(S.of("V1ObjectBridge"),M.get("V1ObjectBridge")),gj={"1.0.0":function(){function e(e,t){var n=this;this.onDisconnectRequest=function(e){n.doDisconnectCleanup(),n.disconnectCallback.invokeSync(void 0),n.disconnectCallback.removeAll(),n.disconnectCallback=null},this.doDisconnectCleanup=function(){n.transceiver.offMessage("disconnect",n.onDisconnectRequest),n.transceiver.offError(n.onTransceiverError),n.transceiver.destroy(),n.callHandler.destroy(),n.eventSubscriberHandler.destroy(),n.eventPublisherHandler.destroy(),n.transceiver=null,n.idVendor=null,n.objectMap=null,n.callHandler=null,n.eventSubscriberHandler=null,n.eventPublisherHandler=null},this.onTransceiverError=function(e){yj.error("Unexpected transceiver error!",e)},this.transceiver=t,this.objectMap={},this.idVendor=new hj(e.appId);var r={idVendor:this.idVendor,transceiver:this.transceiver,objectMap:this.objectMap};this.callHandler=new sj(r),this.eventPublisherHandler=new lj(r),this.eventSubscriberHandler=new fj(r),this.disconnectCallback=new mj,this.transceiver.onMessage("disconnect",this.onDisconnectRequest),this.transceiver.onError(this.onTransceiverError)}return e.prototype.disconnect=function(){this.transceiver.sendMessage("disconnect",{}),this.doDisconnectCleanup(),this.disconnectCallback.removeAll(),this.disconnectCallback=null},e.prototype.onDisconnect=function(e){this.disconnectCallback.add(e)},e.prototype.offDisconnect=function(e){this.disconnectCallback.remove(e)},e.prototype.register=function(e,t){this.objectMap[e]=t},e.prototype.deregister=function(e){this.eventPublisherHandler.deregister(e),delete this.objectMap[e]},e.prototype.call=function(e,t,n){return this.callHandler.call(e,t,n)},e.prototype.on=function(e,t,n){return this.eventSubscriberHandler.on(e,t,n)},e.prototype.off=function(e,t,n){return this.eventSubscriberHandler.off(e,t,n)},e}()},vj={json:nj},Sj=Dt.EventEmitter,bj=Dt.MulticastCallback,Tj=function(){function e(e,t){var n=this;this.eventEmitter=new Sj,this.errorCallback=new bj,this.onBusError=function(e){n.errorCallback.invoke(new Error(e))},this.onBusMessage=function(t,e){n.transcoder.decode(e).then(function(e){n.eventEmitter.emit(t,e)}).catch(function(e){n.errorCallback.invoke(e)})},this.messageBus=e,this.transcoder=t,this.messageBus.onMessage(this.onBusMessage),this.messageBus.onError(this.onBusError)}return e.prototype.destroy=function(){this.messageBus.offMessage(this.onBusMessage),this.messageBus.offError(this.onBusError)},e.prototype.sendMessage=function(t,e){var n=this;return this.transcoder.encode(e).then(function(e){n.messageBus.sendMessage(t,e)})},e.prototype.onMessage=function(e,t){this.eventEmitter.on(e,t)},e.prototype.offMessage=function(e,t){this.eventEmitter.off(e,t)},e.prototype.onError=function(e){this.errorCallback.add(e)},e.prototype.offError=function(e){this.errorCallback.remove(e)},e}(),Pj=function(){function e(){}return e.isValidSemVer=function(e){return/^\d+\.\d+\.\d+$/.test(e)},e.findHighestSharedVersion=function(e,t){for(var n=this.getSemverIntegers(e),r=this.getSemverIntegers(t),i=0,o=n;i<o.length;i++)for(var a=o[i],s=0,l=r;s<l.length;s++){var u=l[s];if(u[0]===a[0])return u[1]<=a[1]?u.join("."):a.join(".")}return null},e.getSemverIntegers=function(e){return e.map(function(e){return e.split(".").map(function(e){return parseInt(e)})}).sort(function(e,t){for(var n=0;n<e.length;n++){if(t[n]>e[n])return 1;if(t[n]<e[n])return-1}return 0})},e}(),wj=Fe.Deferred,Cj=Fe.Promise,Mj=(S.of("BridgeOpener"),M.get("BridgeOpener")),Ij=function(){function e(e,t,n){var s=this;this.onTransceiverError=function(e){Mj.error("Unexpected transceiver error!",e)},this.onConnectRequest=function(e){Mj.info("Received connection request from "+e.app_id+".");var t=Object.keys(vj),n=F.intersection(t,e.payload_encodings);if(F.isEmpty(n))s.sendConnectResponseError("avp_rpc_no_supported_encodings","No available encodings: "+e.app_id+":"+e.payload_encodings+" vs. "+s.config.appId+":"+t);else{var r=Object.keys(gj),i=Pj.findHighestSharedVersion(r,e.protocol_versions);if(null!==i){var o=n[0],a=s.createBridge(i,o);s.jsonTransceiver.sendMessage("connect_response",{app_id:s.config.appId,protocol_version:i,payload_encoding:o}),xt.exists(s.pendingConnection)&&(s.pendingConnection.resolve(a),s.pendingConnection=null)}else s.sendConnectResponseError("avp_rpc_no_supported_versions","No available protocol versions: "+s.config.appId+":"+r+" vs. "+e.app_id+":"+e.protocol_versions)}},this.onConnectResponse=function(e){if(xt.isNullOrUndefined(s.pendingConnection))Mj.warn("Unexpected connect_response, ignoring.");else{if(Mj.info("Received connection response from "+e.app_id+". Using encoding: "+e.payload_encoding+" and version "+e.protocol_version),xt.isNullOrUndefined(e.error)){var t=s.createBridge(e.protocol_version,e.payload_encoding);null===t?s.pendingConnection.reject(new rj("avp_rpc_no_supported_versions","Received a connect response without any workable versions.")):s.pendingConnection.resolve(t)}else s.pendingConnection.reject(e.error);s.pendingConnection=null}},this.config=e,this.messageBus=t,this.jsonTransceiver=new Tj(t,new nj),this.jsonTransceiver.onMessage("connect",this.onConnectRequest),this.jsonTransceiver.onMessage("connect_response",this.onConnectResponse),this.jsonTransceiver.onError(this.onTransceiverError)}return e.prototype.destroy=function(){xt.exists(this.pendingConnection)&&(this.pendingConnection.reject(new Error("BridgeOpener was destroyed while waiting for the connection to open")),this.pendingConnection=null),xt.exists(this.jsonTransceiver)&&(this.jsonTransceiver.offMessage("connect",this.onConnectRequest),this.jsonTransceiver.offMessage("connect_response",this.onConnectResponse),this.jsonTransceiver.offError(this.onTransceiverError),this.jsonTransceiver.destroy()),this.config=null,this.messageBus=null,this.jsonTransceiver=null},e.prototype.waitForConnect=function(){return xt.isNullOrUndefined(this.jsonTransceiver)?Cj.reject(new Error("BridgeOpener must be initialized for usage")):(xt.isNullOrUndefined(this.pendingConnection)&&(this.pendingConnection=new wj),this.pendingConnection.promise)},e.prototype.connect=function(){return xt.isNullOrUndefined(this.jsonTransceiver)?Cj.reject(new Error("BridgeOpener must be initialized for usage")):(xt.isNullOrUndefined(this.pendingConnection)?(e=new wj,this.pendingConnection=e):e=this.pendingConnection,this.jsonTransceiver.sendMessage("connect",{app_id:this.config.appId,protocol_versions:Object.keys(gj),payload_encodings:Object.keys(vj)}).then(function(){return e.promise}));var e},e.prototype.sendConnectResponseError=function(e,t){this.jsonTransceiver.sendMessage("connect_response",{app_id:this.config.appId,protocol_version:null,payload_encoding:null,error:new rj(e,t)})},e.prototype.createBridge=function(e,t){for(var n=e.split("."),r=parseInt(n[0]),i=parseInt(n[1]),o=0,a=Object.keys(gj);o<a.length;o++){var s=a[o],l=s.split("."),u=parseInt(l[0]),c=parseInt(l[1]);if(u===r&&i<=c){var d=new Tj(this.messageBus,new nj);return new gj[s](this.config,d)}}return null},e}(),Ej=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.BridgeOpener=Ij});e(Ej);Ej.BridgeOpener;var _j=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){function e(e,t,n,r){var i=o.call(this,t,n,r)||this;return i.objectId="XpPlayer-"+Math.random(),i.featureObjectIds=[],i.bridge=e,i.bridge.register(i.objectId,i),i}return n(e,o),e.prototype.getFeature=function(e,t){var n=this;return o.prototype.getFeature.call(this,e,t).then(function(e){if(null==n.bridge)throw new Error("XpPlayer has been destroyed and can't be used anymore.");return-1===n.featureObjectIds.indexOf(e.objectId)&&(n.bridge.register(e.objectId,e),n.featureObjectIds.push(e.objectId)),e})},e.prototype.destroy=function(){if(null!=this.bridge){for(var e=0,t=this.featureObjectIds;e<t.length;e++){var n=t[e];this.bridge.deregister(n)}this.featureObjectIds=[],this.bridge.deregister(this.objectId),this.bridge=null}o.prototype.destroy.call(this)},e.prototype.toJSON=function(){return{objectId:this.objectId,version:this.version,Features:this.Features,Events:this.Events,error:this.error,contentError:this.contentError,contentState:this.contentState,playbackState:this.playbackState,currentTime:this.currentTime,timeline:this.timeline,playbackRate:this.playbackRate}},e}(GV.XpPlayer);t.RemoteXpPlayer=i});e(_j);_j.RemoteXpPlayer;var xj=t(function(e,t){var r,n=V&&V.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(o){function e(e,t,n,r){var i=o.call(this,t,e)||this;return i.objectId="XpPlayerSDK-"+Math.random(),i.bridge=e,i.onDestroy=n,i.surfaceRef=r,i.bridge.register(i.objectId,i),i}return n(e,o),e.prototype.getFeature=function(e,t){var n=this;return e===Gd.PlayerSDKFeatures.Player?this.initializationPromise.then(function(){if(null!=n.firewoodLogSink&&n.firewoodLogSink.flush(),null==n.bridge)throw new Error("XpPlayerSDK has been destroyed and can't be used.");null==t.surfaceRef&&(t.surfaceRef=n.surfaceRef);var e=new _j.RemoteXpPlayer(n.bridge,n.mergePlayerConfigDefaults(t),n.mediaEventReporter,n.xpPlayerCapabilitiesFeature);return e.initialize(),n.xpPlayer=e}):o.prototype.getFeature.call(this,e,t)},e.prototype.destroy=function(){o.prototype.destroy.call(this),(this.surfaceRef=null)!=this.bridge&&(this.bridge.deregister(this.objectId),this.bridge=null),null!=this.onDestroy&&(this.onDestroy(),this.onDestroy=null)},e.prototype.toJSON=function(){return{objectId:this.objectId,version:this.version,Features:this.Features}},e}(ej.XpPlayerSDK);t.RemoteXpPlayerSDK=i});e(xj);xj.RemoteXpPlayerSDK;var kj=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("XpPlayerSDKServer"),n=function(){function e(e,t,n){var r=this;this.bridgeOpener=null,this.objectBridge=null,this.playerSDKCreated=!1,this.onBridgeOpen=function(e){i.log("Server bridge opened."),r.objectBridge=e,r.objectBridge.register("ATVXpPlayerSDK",{constructor:r.playerSDKConstructor})},this.onPlayerSDKDestroy=function(){r.playerSDKCreated=!1},this.playerSDKConstructor=function(e){if(r.playerSDKCreated)throw new Error("PlayerSDK already created. Only a single SDK is currently supported.");var t=new xj.RemoteXpPlayerSDK(r.objectBridge,e,r.onPlayerSDKDestroy,r.surfaceRef);return r.playerSDKCreated=!0,t},this.bridgeOpener=new Ej.BridgeOpener({appId:"ATVXpPlayerSDK"},e,Fe.Promise),this.surfaceRef=n,i.log("Waiting for remote connection."),this.bridgeOpener.waitForConnect().then(this.onBridgeOpen).catch(function(e){i.error("Bridge open failure: ",e),t(e)})}return e.prototype.destroy=function(){null!=this.bridgeOpener&&(this.bridgeOpener.destroy(),this.bridgeOpener=null),null!=this.objectBridge&&(this.objectBridge.disconnect(),this.objectBridge=null)},e}();t.XpPlayerSDKServer=n});e(kj);kj.XpPlayerSDKServer;var Rj=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.XpPlayerSDK=ej.XpPlayerSDK,t.XpPlayerSDKServer=kj.XpPlayerSDKServer});e(Rj);Rj.XpPlayerSDK,Rj.XpPlayerSDKServer;var Aj=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=["/"];t.AssetRoots=n;try{t.AssetRoots=n=JSON.parse('["https://cloudfront.xp-assets.aiv-cdn.net/packages/ATVWebPlayerSDK-1.0/prod/","https://lvlt.xp-assets.aiv-cdn.net/packages/ATVWebPlayerSDK-1.0/prod/","https://limelight.xp-assets.aiv-cdn.net/packages/ATVWebPlayerSDK-1.0/prod/"]')}catch(e){}});e(Aj);Aj.AssetRoots;var Oj=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});t.PackageVersion="ATVWebPlayerSDK-1.0.209200.0"});e(Oj);Oj.PackageVersion;var Lj=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=M.get("Player");t.Player=function(n,e,t){var r;return{Events:ct.WebPlayerEvent,Features:(r={},r[ct.WebPlayerFeatures.Stream]=ct.WebPlayerFeatures.Stream,r[ct.WebPlayerFeatures.UIDisplayStatus]=ct.WebPlayerFeatures.UIDisplayStatus,r[ct.WebPlayerFeatures.Volume]=ct.WebPlayerFeatures.Volume,r),version:"1.0.0",get contentError(){return n.contentError},get contentState(){return n.contentState},get currentTime(){return n.currentTime},get error(){return n.error},get playbackRate(){return n.playbackRate},get playbackState(){return n.playbackState},get timeline(){return n.timeline},destroy:function(){n.destroy()},getFeature:function(e,t){return xt.exists(this.Features[e])?n.getFeature(e,t):Fe.Promise.reject(new Error("The "+e+" feature is not supported by this player."))},load:function(e){n.load(e)},unload:function(){n.unload()},on:function(e,t){xt.exists(this.Events[e])?n.on(e,t):i.error("The "+e+" event is not supported by this player.")},off:function(e,t){n.off(e,t)},once:function(e,t){xt.exists(this.Events[e])?n.once(e,t):i.error("The "+e+" event is not supported by this player.")},play:function(){return n.play()},pause:function(){n.pause()},seek:function(e){n.seek(e)},setPlaybackRate:function(e){e=Math.max(.5,Math.min(e,3)),n.setPlaybackRate(e)},start:function(e){n.start(e)}}}});e(Lj);Lj.Player;var Fj=t(function(e,t){var n=V&&V.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.objectId="WebPlayer-CastState-"+Math.random(),this.version="1.0.0",this.currentCastState=ct.CastState.Disconnected,this.pinRequired=!1,this.timedTextStyle=null,this.dataUsage=n({},ct.DataUsageDefault),this.eventEmitter=new Dt.EventEmitter}return e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.setCastState=function(e){e!==this.currentCastState&&(this.currentCastState=e,this.eventEmitter.emit("CastStateChange",this.currentCastState))},e.prototype.setPINRequired=function(e){e!==this.pinRequired&&(this.pinRequired=e,this.eventEmitter.emit("PINRequiredChange",this.pinRequired))},e.prototype.setTimedTextStyle=function(e){this.timedTextStyle=e,this.eventEmitter.emit("TimedTextStyleChange",this.timedTextStyle)},e.prototype.setDataUsage=function(e){e.bandwidthCap===this.dataUsage.bandwidthCap&&e.displayText===this.dataUsage.displayText||(this.dataUsage=e,this.eventEmitter.emit("DataUsageChange",this.dataUsage))},e.prototype.setPreloadState=function(e){this.eventEmitter.emit("PreloadStateChange",e)},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId,currentCastState:this.currentCastState,pinRequired:this.pinRequired,timedTextStyle:this.timedTextStyle,dataUsage:this.dataUsage}},e}();t.GCastFeature=r});e(Fj);Fj.GCastFeature;var Dj=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var o=this;this.onTimeDataChange=function(e){var t=o.player.timeline,n=t.items[e.currentTimelineItemIndex],r=t.contentInfos[n.contentId].contentType,i=null;e.currentTimelineItemIndex+1<t.items.length&&(i=t.items[e.currentTimelineItemIndex+1].groupId),null!=o.webUIConfig&&null!=o.webUIConfig.enableNextUp&&!1===o.webUIConfig.enableNextUp&&"Feature"===r&&n.groupId!==i&&o.isAtEndOfTitle(e)&&o.player.playbackState===Gd.PlaybackState.Playing&&(o.player.pause(),o.eventEmitter.emit("TimelineEnded"))},this.player=e,this.eventEmitter=t,this.webUIConfig=n}return e.prototype.initialize=function(){this.player.on("TimeDataChange",this.onTimeDataChange)},e.prototype.uninitialize=function(){this.player.off("TimeDataChange",this.onTimeDataChange)},e.prototype.isAtEndOfTitle=function(e){var t=this.player.timeline.items[e.currentTimelineItemIndex];return xt.withDefault(t.endTime,1/0)-e.currentPosition<=500},e}();t.TimelineHandler=n});e(Dj);Dj.TimelineHandler;var Nj=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.objectId="WebPlayer-UIDisplayStatus-"+Math.random(),this.version="1.0.0",this.onUiDisplayStatusChange=function(e){t.multicastCallback.invoke(e)},this.ui=e,this.multicastCallback=new Dt.MulticastCallback,this.ui.on("UIDisplayStatusChange",this.onUiDisplayStatusChange)}return e.prototype.onDisplayStatusChange=function(e){this.multicastCallback.add(e)},e.prototype.offDisplayStatusChange=function(e){this.multicastCallback.remove(e)},e.prototype.isShowing=function(){return this.ui.arePlaybackControlsShowing()},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId}},e}();t.UIDisplayStatusFeature=n});e(Nj);Nj.UIDisplayStatusFeature;var Uj=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,n){var r=this;this.objectId="WebPlayer-UserActivity-"+Math.random(),this.version="1.0.0",this.userActive=!0,this.currentTimelineItemGroupId=null,this.inactiveTimeoutMs=216e5,this.numTitlesPlayedWithoutInput=0,this.resumeOnActive=!1,this.timeoutId=null,this.onTimeDataChange=function(e){var t=r.player.timeline.items[e.currentTimelineItemIndex].groupId;if(null!==r.currentTimelineItemGroupId&&t!==r.currentTimelineItemGroupId&&(r.numTitlesPlayedWithoutInput++,5<=r.numTitlesPlayedWithoutInput)){var n=r.player.playbackState===Gd.PlaybackState.Playing;r.reportNonSeekInteraction("Pause"),r.player.pause(),r.emitUserInactive(n)}r.currentTimelineItemGroupId=t},this.multicastCallback=new Dt.MulticastCallback,this.player=e,this.metricsReportingFeature=t,this.deviceId=n,this.player.on("TimeDataChange",this.onTimeDataChange)}return e.prototype.onUserActiveChange=function(e){this.multicastCallback.add(e)},e.prototype.offUserActiveChange=function(e){this.multicastCallback.remove(e)},e.prototype.reportUserActivity=function(){this.userActive||(this.userActive=!0,this.multicastCallback.invoke(this.userActive),this.resumeOnActive&&(this.reportNonSeekInteraction("Play"),this.player.play())),this.setInactivityTimeout(),this.numTitlesPlayedWithoutInput=0},e.prototype.setInactiveTimeoutMs=function(e){this.inactiveTimeoutMs=e,this.setInactivityTimeout()},e.prototype.toJSON=function(){return{version:this.version,objectId:this.objectId,userActive:this.userActive}},e.prototype.setInactivityTimeout=function(){var e=this;this.clearTimeout(),this.timeoutId=A.timer.setTimeout(function(){e.emitUserInactive(!1)},this.inactiveTimeoutMs)},e.prototype.emitUserInactive=function(e){this.userActive=!1,this.clearTimeout(),this.multicastCallback.invoke(this.userActive),this.resumeOnActive=e},e.prototype.clearTimeout=function(){null!=this.timeoutId&&(A.timer.clearTimeout(this.timeoutId),this.timeoutId=null)},e.prototype.reportNonSeekInteraction=function(e){this.metricsReportingFeature.reportInteraction("Player",e,"Forced",null,null,this.deviceId,"RemoteDevice")},e}();t.UserActivityFeature=n});e(Uj);Uj.UserActivityFeature;var Bj=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var r=((n={})[ct.WebPlayerFeatures.AdReporting]=Gd.PlayerFeatures.AdReporting,n[ct.WebPlayerFeatures.MetricsReporting]=Gd.PlayerFeatures.MetricsReporting,n[ct.WebPlayerFeatures.PictureInPicture]=Gd.PlayerFeatures.PictureInPicture,n[ct.WebPlayerFeatures.Stream]=Gd.PlayerFeatures.Stream,n[ct.WebPlayerFeatures.Volume]=Gd.PlayerFeatures.Volume,n),i="PlayerDestroyedError",o=function(){function e(e,t,n,r,i,o,a,s){var l,u,c=this;this.version="1.0.0",this.Events=ct.WebPlayerEvent,this.Features=ct.WebPlayerFeatures,this.clickstreamReporter=null,this.ui=null,this.onFullscreenStateChange=function(e){c.eventEmitter.emit("FullscreenChange",e)},this.onXpContentStateChange=function(e){c.eventEmitter.emit("ContentStateChange",e)},this.onXpPlaybackStateChange=function(e){null!=c.clickstreamReporter&&e===Gd.PlaybackState.Playing&&c.clickstreamReporter.clickstreamPlaybackPlaying(),c.eventEmitter.emit("PlaybackStateChange",e)},this.onXpTimeDataChange=function(e){c.eventEmitter.emit("TimeDataChange",e)},this.onXpTimelineChange=function(e){c.eventEmitter.emit("TimelineChange",e)},this.onXpTimelineEnded=function(){c.eventEmitter.emit("TimelineEnded")},this.onXpError=function(e){var t=tp.ErrorCodeTransformer.transformError(e);c.eventEmitter.emit("Error",t)},this.onXpContentError=function(e){var t=tp.ErrorCodeTransformer.transformError(e);c.eventEmitter.emit("ContentError",t)},this.player=e,this.metricsReportingFeature=t,this.config=i,this.ui=o,this.clickstreamReporter=s,this.eventEmitter=new Dt.EventEmitter,this.eventEmitter.setMaxListeners(18),this.timelineHandler=new Dj.TimelineHandler(e,this.eventEmitter,i.uiConfig),this.timelineQuerier=new hP.TimelineQuerier(e),this.webFeatureMap=((l={})[ct.WebPlayerFeatures.UIDisplayStatus]=new Nj.UIDisplayStatusFeature(this.ui),l),r===ct.WebPlayerSDKFeatures.GCastPlayer&&(this.webFeatureMap=((u={})[ct.WebPlayerFeatures.GCast]=new Fj.GCastFeature,u[ct.WebPlayerFeatures.UserActivity]=new Uj.UserActivityFeature(this,t,a),u)),this.playerCapabilitiesFeature=n,this.hasPlaybackInitiated=!1,this.attachXpEventListeners(),null!==this.ui&&this.attachUIEventListeners()}return Object.defineProperty(e.prototype,"contentError",{get:function(){return this.player.contentError},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentState",{get:function(){return null==this.player?Gd.ContentState.Unloaded:this.player.contentState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.player.currentTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this.player.error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.player.playbackRate},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackState",{get:function(){return this.player.playbackState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeline",{get:function(){return this.player.timeline},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.eventEmitter.removeAllListeners(),null!==this.ui&&(this.detachUIEventListeners(),this.ui.detach()),this.detachXpEventListeners(),this.timelineHandler.uninitialize(),this.player.destroy(),this.player=null},e.prototype.getFeature=function(e,t){return null==this.player?Fe.Promise.reject(Yd.Errors.newError(i,"Player is destroyed")):null!=this.webFeatureMap[e]?Fe.Promise.resolve(this.webFeatureMap[e]):this.player.getFeature(r[e],t)},e.prototype.getPlayerCapabilitiesFeature=function(){return this.playerCapabilitiesFeature},e.prototype.load=function(e){if(null==this.player)throw Yd.Errors.newError(i,"Player is destroyed");this.reportUserActivity();var t=this.getContentConfigFromWebContentConfig(e);if(null!==this.ui&&(this.ui.setVideoMaterialType(t.videoMaterialType),null!=e.metadata&&this.ui.setContentMetadata(e.titleId,e.metadata),null!=e.clickstreamRefMarker&&this.ui.setClickstreamRefMarker(e.clickstreamRefMarker)),null!=this.clickstreamReporter&&null!=e.clickstreamRefMarker){var n="Trailer"===e.videoMaterialType;this.clickstreamReporter.setRefMarker(e.clickstreamRefMarker),this.clickstreamReporter.setContent(e.titleId,n)}this.timelineHandler.initialize(),this.player.load(t)},e.prototype.off=function(e,t){this.eventEmitter.off(e,t)},e.prototype.on=function(e,t){this.eventEmitter.on(e,t)},e.prototype.once=function(e,t){this.eventEmitter.once(e,t)},e.prototype.pause=function(){null!=this.player&&this.player.pause()},e.prototype.play=function(){return null==this.player?Fe.Promise.reject(Yd.Errors.newError(i,"Player is destroyed")):(this.emitPlaybackInitiated(),this.player.play())},e.prototype.seek=function(e,t){if(null!=this.player){if(null==t){var n=this.timeline.items[this.player.currentTime.currentTimelineItemIndex];if(xt.withDefault(n.startTime,0)<=e&&xt.withDefault(n.endTime,1/0)>=e)t=this.player.currentTime.currentTimelineItemIndex;else for(var r=0,i=this.timelineQuerier.getMainContentItems(n);r<i.length;r++){var o=i[r],a=o.timelineItem;if(!(xt.withDefault(a.endTime,1/0)<e)){t=o.timelineItemIndex;break}}}this.player.seek(e,t),this.eventEmitter.emit("Seek",e)}},e.prototype.seekToWallClockTime=function(e){null!=this.player&&this.player.seekToWallClockTime(e)},e.prototype.setPlaybackRate=function(e){null!=this.player&&this.player.setPlaybackRate(e)},e.prototype.start=function(e){if(null==this.player)throw Yd.Errors.newError(i,"Player is destroyed");var t=!0;this.reportUserActivity();var n=this.getContentConfigFromWebContentConfig(e);if(null!==this.ui&&(this.ui.setVideoMaterialType(n.videoMaterialType),null!=e.metadata&&this.ui.setContentMetadata(e.titleId,e.metadata),null!=e.clickstreamRefMarker&&this.ui.setClickstreamRefMarker(e.clickstreamRefMarker),t=!this.ui.isBlockingModalShowing()),null!=this.clickstreamReporter&&null!=e.clickstreamRefMarker){var r="Trailer"===e.videoMaterialType;this.clickstreamReporter.setRefMarker(e.clickstreamRefMarker),this.clickstreamReporter.setContent(e.titleId,r)}null!=this.timelineHandler&&(this.timelineHandler.uninitialize(),this.timelineHandler.initialize()),t?(this.emitPlaybackInitiated(),this.player.start(n)):this.player.load(n)},e.prototype.unload=function(){null!=this.player&&(this.timelineHandler.uninitialize(),this.player.pause(),this.player.unload())},e.prototype.closePlayer=function(){this.hasPlaybackInitiated=!1,this.eventEmitter.emit("Close")},e.prototype.setLocale=function(e){null!==this.ui&&this.ui.setLocale(e)},e.prototype.playbackInitiated=function(){this.emitPlaybackInitiated(),this.metricsReportingFeature.reportInteraction("DetailPage","Play")},e.prototype.getContentConfigFromWebContentConfig=function(e){return{titleId:e.titleId,videoMaterialType:this.convertVideoTypeToVideoMaterialType(e.videoMaterialType),position:e.position,playbackToken:e.playbackToken}},e.prototype.convertVideoTypeToVideoMaterialType=function(e){return"Live"===e&&(e="LiveStreaming"),xt.withDefault(e,"Feature")},e.prototype.reportUserActivity=function(){null!=this.webFeatureMap[ct.WebPlayerFeatures.UserActivity]&&this.webFeatureMap[ct.WebPlayerFeatures.UserActivity].reportUserActivity()},e.prototype.attachUIEventListeners=function(){this.ui.on("FullscreenChange",this.onFullscreenStateChange)},e.prototype.detachUIEventListeners=function(){this.ui.off("FullscreenChange",this.onFullscreenStateChange)},e.prototype.attachXpEventListeners=function(){this.player.on("ContentStateChange",this.onXpContentStateChange),this.player.on("PlaybackStateChange",this.onXpPlaybackStateChange),this.player.on("TimeDataChange",this.onXpTimeDataChange),this.player.on("TimelineChange",this.onXpTimelineChange),this.player.on("TimelineEnded",this.onXpTimelineEnded),this.player.on("Error",this.onXpError),this.player.on("ContentError",this.onXpContentError)},e.prototype.detachXpEventListeners=function(){this.player.off("ContentStateChange",this.onXpContentStateChange),this.player.off("PlaybackStateChange",this.onXpPlaybackStateChange),this.player.off("TimeDataChange",this.onXpTimeDataChange),this.player.off("TimelineChange",this.onXpTimelineChange),this.player.off("TimelineEnded",this.onXpTimelineEnded),this.player.off("Error",this.onXpError),this.player.off("ContentError",this.onXpContentError)},e.prototype.emitPlaybackInitiated=function(){this.hasPlaybackInitiated||(this.hasPlaybackInitiated=!0,this.eventEmitter.emit("PlaybackInitiated"))},e}();t.WebPlayer=o});e(Bj);Bj.WebPlayer;var Vj=t(function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0});var l=S.of("WebPlayerSDK"),g=M.get("WebPlayerSDK"),u=((n={})[ct.WebPlayerSDKFeatures.AmazonVideoPlayer]=KM.AmazonVideoUI,n[ct.WebPlayerSDKFeatures.GCastPlayer]=KM.GCastUI,n[ct.WebPlayerSDKFeatures.ChromelessPlayer]=null,n[ct.WebPlayerSDKFeatures.Player]=KM.AmazonVideoUI,n),c={headers:{}},v="primary-content",r="atvwebplayer_deviceid",i=function(){function e(e,t,n,r,i,o){void 0===n&&(n=document),void 0===r&&(r=M),void 0===i&&(i=u),void 0===o&&(o=window);var a=this;if(this.version="1.0.0",this.Features=ct.WebPlayerSDKFeatures,this.ui=null,this.constructedPlayers=[],this.onWindowUnload=function(e){var t=null==a.documentRef.activeElement?null:a.documentRef.activeElement.getAttribute("href");null!=t&&0!==t.indexOf("http:")&&0!==t.indexOf("https:")||a.destroy()},l(e,"playerSDKConfig").exists(),!0===e.debug&&r.useDefaults(),this.documentRef=n,this.featureToUIMap=i,this.playerSDKConfig=e,this.windowRef=o,this.storage=new Ce.LocalStorage,this.playerSDKConfig.authContext=xt.withDefault(e.authContext,c),this.playerSDKConfig.deviceId=xt.withDefault(e.deviceId,this.generateDeviceId()),this.playerSDKConfig.deviceTypeId=xt.withDefault(e.deviceTypeId,Y.DeviceTypeId.HTML5),this.playerSDKConfig.marketplaceId=xt.withDefault(e.marketplaceId,Y.MarketplaceID.US),this.playerSDKConfig.clientId=xt.withDefault(e.clientId,null),this.playerSDKConfig.weblabs=xt.withDefault(e.weblabs,{}),null==e.route&&null!=Yh.setDeviceCapabilitiesClientConfig){var s={marketplaceId:e.marketplaceId};Yh.setDeviceCapabilitiesClientConfig(s)}this.xpPlayerSDK=null!=t?t:new Rj.XpPlayerSDK({applicationIdentity:this.playerSDKConfig.applicationIdentity,authContext:this.playerSDKConfig.authContext,debug:this.playerSDKConfig.debug,deviceId:this.playerSDKConfig.deviceId,deviceTypeId:this.playerSDKConfig.deviceTypeId,route:this.playerSDKConfig.route}),this.addBeforeUnloadListener(this.onWindowUnload),yO.liveLowLatencyContext.initialize(this.convertWeblabFormat(this.playerSDKConfig.weblabs)),g.info("Live Low Latency supported: "+yO.liveLowLatencyContext.isLiveLowLatencySupported()),g.info("ATVWebPlayerSDK version "+Oj.PackageVersion),g.info("ATVWebPlayerSDKConfig:",JSON.stringify(e,function(e,t){return"authContext"===e?"<REDACTED>":t}))}return e.prototype.destroy=function(){for(var e=0,t=this.constructedPlayers;e<t.length;e++){t[e].destroy()}this.constructedPlayers=[],this.removeBeforeUnloadListener(this.onWindowUnload),this.xpPlayerSDK.destroy()},e.prototype.getFeature=function(e,t){return F.chain(this.featureToUIMap).keys().contains(e).value()?(g.info("WebPlayerConfig:",JSON.stringify(t,function(e,t){return"container"===e||"videoElement"===e?"<REDACTED>":t})),this.getPlayerFeature(e,t)):e===ct.WebPlayerSDKFeatures.LocalContentManager?(g.info("WebLocalContentManagerConfig:",JSON.stringify(t)),null==t&&(t={}),this.getLocalContentManagerFeature(e,t)):Fe.Promise.reject(new Error("Feature "+ct.WebPlayerSDKFeatures[e]+" ("+e+") not supported."))},e.prototype.setAuthContext=function(e){this.playerSDKConfig.authContext=e,this.xpPlayerSDK.setAuthContext(e),null!==this.ui&&this.ui.setAuthContext(e)},e.prototype.on=function(e,t){},e.prototype.once=function(e,t){},e.prototype.off=function(e,t){},e.prototype.convertWeblabFormat=function(t){var n={};return Object.keys(t).forEach(function(e){n[e]=ct.WeblabTreatment[t[e]]}),n},e.prototype.createScalingVideoContainer=function(e){var t=this.documentRef.createElement("div");t.className="scalingVideoContainer",t.style.position="absolute",t.style.height="100%",t.style.width="100%",t.style.backgroundColor="black";var n=this.documentRef.createElement("div");n.className="scalingVideoContainerTop",n.style.width="100%",n.style.height="0",n.style.transition="height 0.2s linear";var r=this.documentRef.createElement("div");return r.className="scalingVideoContainerBottom",r.appendChild(e),t.appendChild(n),t.appendChild(r),t},e.prototype.createVideoContainer=function(){var e=this.documentRef.createElement("div");return e.className="rendererContainer",e.style.height="100%",e.style.width="100%",e.style.pointerEvents="none",e.style.position="absolute",e.style.transition="width 0.2s linear",e.tabIndex=-1,e},e.prototype.getPlayerFeature=function(i,o){var a=this;if(null==o)return Fe.Promise.reject(new Error("Can't create a Player feature without a PlayerConfig."));null!=this.featureToUIMap[i]&&(this.ui=new this.featureToUIMap[i]);var t=o.container;t.innerHTML="";var r=this.documentRef.createElement("div");r.className="webPlayerSDKContainer",r.style.position="relative",r.style.height="100%",r.style.width="100%",r.style.display="flex",r.style.flexDirection="column";var s=this.documentRef.createElement("div");s.className="webPlayerSDKUiContainer",s.style.height="100%",s.style.width="100%",s.style.margin="0",s.style.padding="0",s.style.position="relative",s.style.cursor="default",s.style.userSelect="none",s.style.outline="none";var n=this.createVideoContainer(),e=this.createScalingVideoContainer(n);r.appendChild(e),r.appendChild(s);var l=this.documentRef.createElement("style");l.innerHTML="\n            .webPlayerSDKContainer.scale .scalingVideoContainerTop {\n                height: 65px !important;\n            }\n\n            .webPlayerSDKContainer.scale .rendererContainer {\n                max-height: calc(100% - 65px);\n                height: 40.43vw !important;\n            }\n\n            @media (max-width:1280px) {\n                .webPlayerSDKContainer.scale .rendererContainer {\n                    width: calc(100% - 360px) !important;\n                }\n            }\n\n            @media (min-width:1281px) {\n                .webPlayerSDKContainer.scale .rendererContainer {\n                    width: calc(100% - 28.125vw) !important;\n                }\n            }\n\n            .webPlayerSDKContainer.scale .scalingVideoContainer {\n                background-color: #0f171e !important;\n            }\n        ",t.appendChild(l),t.appendChild(r);var u=null!=o.videoElement;u&&n.appendChild(o.videoElement);var c,d,p=this.getLocale(xt.withDefault(o.locale,null)),f=p.replace("-","_"),h=this.xpPlayerSDK.getFeature(Gd.PlayerSDKFeatures.Player,{clientId:this.playerSDKConfig.clientId,liveScheduleConfigToken:"html5-player-1",surfaceRef:u?o.videoElement:n,titleDecorationScheme:xt.withDefault(o.titleDecorationScheme,v),uxLocale:f,xray:dP.WebXrayConfig}),m=this.xpPlayerSDK.getFeature(Gd.PlayerSDKFeatures.PlayerCapabilities),y=this.xpPlayerSDK.getServiceClientConfig();return Fe.Promise.all([h,m,y]).then(function(e){var t=e[0],n=e[1],r=e[2];return a.deviceProxyUrl=r.deviceProxyUrl,null!=a.playerSDKConfig.sessionId&&(d=new Ct.ClickstreamReporter(a.deviceProxyUrl,a.playerSDKConfig.marketplaceId,a.playerSDKConfig.deviceId,a.playerSDKConfig.sessionId,a.playerSDKConfig.weblabs)),t.getFeature(Gd.PlayerFeatures.MetricsReporting).then(function(e){return c=e,new Bj.WebPlayer(t,c,n,i,o,a.ui,a.playerSDKConfig.deviceId,d)})}).then(function(e){a.configureMetricsReporter();var t=a.setInitialVolume(o,e);null!==a.ui&&a.ui.attach({assetRoots:Aj.AssetRoots,clientId:a.playerSDKConfig.clientId,container:s,deviceId:a.playerSDKConfig.deviceId,deviceProxyUrl:a.deviceProxyUrl,deviceTypeId:a.playerSDKConfig.deviceTypeId,initialVolume:t,locale:p,marketplaceId:a.playerSDKConfig.marketplaceId,metricsReportingFeature:c,parentContainer:r,requestedPlayerFeature:i,webPlayer:e,authContext:a.playerSDKConfig.authContext,uiConfig:o.uiConfig,clickstreamReporter:d,weblabs:a.playerSDKConfig.weblabs});var n=i!==ct.WebPlayerSDKFeatures.Player?e:new Lj.Player(e,o,a.ui);return a.constructedPlayers.push(n),n}).catch(function(e){return g.error("An error occurred while trying to acquire a Player.",e),t.removeChild(r),t.removeChild(l),n=null,Fe.Promise.reject(e)})},e.prototype.getLocalContentManagerFeature=function(e,t){return this.xpPlayerSDK.getFeature(Gd.PlayerSDKFeatures.LocalContentManager,{clientId:this.playerSDKConfig.clientId,titleDecorationScheme:xt.withDefault(t.titleDecorationScheme,v)})},e.prototype.configureMetricsReporter=function(){var e=Yh.deviceInformation.software.middleware,t=null!=e?e.name:"Unknown",n=fh.UUID.v4(),r=new Et.MetricsPublisher(this.playerSDKConfig.marketplaceId,n,this.playerSDKConfig.clientId,t);Pt.metrics.setHandler(function(e,t,n){r.putMetric("HTML5Player","."+e,t,n)}),Pt.metrics.setFlusher(function(){r.flush()})},e.prototype.setInitialVolume=function(e,t){var n=xt.nestedValue(e,"features.volume.initialVolume");return null!==n&&t.getFeature(t.Features.Volume).then(function(e){0===n&&(e.muted=!0),e.volume=n}).catch(function(e){g.warn("Unable to acquire volume feature: "+e)}),n},e.prototype.getLocale=function(e){return null!==e&&(e=Qt.Locales.getClosestLocale(e)),null===e&&(e=Qt.Locales.getClosestLocale(this.windowRef.navigator.language)),null===e&&(e=xt.withDefault(Qt.Locales.getLocaleFromMarketplaceId(this.playerSDKConfig.marketplaceId),Qt.Locales.EN_US)),e},e.prototype.generateDeviceId=function(){var e=this.storage.get(r);if(null!=e&&10<e.length&&e.length<60)return e;var t=fh.UUID.v4();return this.storage.set(r,t),t},e.prototype.addBeforeUnloadListener=function(e){void 0!==this.windowRef.addEventListener?this.windowRef.addEventListener("beforeunload",e):void 0!==this.windowRef.attachEvent&&this.windowRef.attachEvent("onbeforeunload",e)},e.prototype.removeBeforeUnloadListener=function(e){void 0!==this.windowRef.removeEventListener?this.windowRef.removeEventListener("beforeunload",e):void 0!==this.windowRef.detachEvent&&this.windowRef.detachEvent("onbeforeunload",e)},e}();t.WebPlayerSDK=i});e(Vj);Vj.WebPlayerSDK;return e(t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),window.ATVWebPlayerSDK=Vj.WebPlayerSDK,t.default=Vj.WebPlayerSDK}))}();