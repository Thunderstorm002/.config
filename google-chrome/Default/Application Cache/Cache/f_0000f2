Kmc.prototype.OP=X(1525,function(){if(!this.isDisposed()){var a=this.Da(bL.c3),b=Ze("Estimating\u2026");gf(a,b);this.yb()&&(P(a,!0),a=this.Da(bL.OQ),P(a,!1))}});Mmc.prototype.OP=X(1524,function(){this.C["refresh-query"].OP()});Umc.prototype.OP=X(1523,function(){this.C.OP()});function dlh(){return rw.getInstance().C.newDatasourceFromOnboarding}function elh(){return!!rw.getInstance().C.showBigQueryProjectSelectionOnStart}
function flh(a){var b=[];a.C.forEach(function(c,d){ih(c,2)||b.push(d)});return b}function glh(a){C.call(this,a)}v(glh,C);glh.prototype.hasError=function(){return this.message.hasError()};glh.prototype.getError=function(){return this.message.getError()};function hlh(a){this.hb=ah(a,-1,0)}v(hlh,dh);hlh.prototype.toBuilder=function(){return new glh(this)};hlh.prototype.hasError=function(){return ih(this,1)};hlh.prototype.getError=function(){return rh(this,1,0)};function ilh(a){C.call(this,a)}v(ilh,C);
ilh.prototype.getStatus=function(){return this.message.getStatus()};ilh.prototype.Ge=function(){return this.message.Ge()};ilh.prototype.getNumberOfColumns=function(){return this.message.getNumberOfColumns()};ilh.prototype.getNumberOfRows=function(){return this.message.getNumberOfRows()};function jlh(a){this.hb=ah(a,-1,0)}v(jlh,dh);p=jlh.prototype;p.toBuilder=function(){return new ilh(this)};p.getStatus=function(){return rh(this,6,0)};p.Ge=function(){return rh(this,7,0)};
p.getNumberOfColumns=function(){return qh(this,8)};p.getNumberOfRows=function(){return qh(this,9)};function klh(a){C.call(this,a)}v(klh,C);klh.prototype.getStatus=function(){return this.message.getStatus()};function llh(a){this.hb=ah(a,-1,0)}v(llh,dh);llh.prototype.toBuilder=function(){return new klh(this)};llh.prototype.getStatus=function(){return rh(this,1,0)};function mlh(a){C.call(this,a)}v(mlh,C);p=mlh.prototype;p.mf=function(){return this.message.mf()};p.Rl=function(){return this.message.Rl()};
p.Pf=function(){return this.message.Pf()};p.Aq=function(){return this.message.Aq()};p.getDataSourceId=function(){return this.message.getDataSourceId()};function nlh(a){this.hb=ah(a,-1,0)}v(nlh,dh);p=nlh.prototype;p.toBuilder=function(){return new mlh(this)};p.mf=function(){return this.sb(1,Fh)};p.Rl=function(){return nh(this,2)};p.Pf=function(){return ph(this,3)};p.Aq=function(){return ih(this,5)};p.getDataSourceId=function(){return nh(this,5)};
function olh(a){var b=void 0===b?gh(nlh):b;b=new mlh(b);return Eh(b,1,a)}function plh(a){C.call(this,a)}v(plh,C);function qlh(a){this.hb=ah(a,-1,0)}v(qlh,dh);qlh.prototype.toBuilder=function(){return new plh(this)};function rlh(a){C.call(this,a)}v(rlh,C);function slh(a){this.hb=ah(a,-1,0)}v(slh,dh);slh.prototype.toBuilder=function(){return new rlh(this)};function tlh(a,b){return Ch(a,1,b)}function ulh(a){C.call(this,a)}v(ulh,C);ulh.prototype.zT=function(a){return this.message.zT(a)};
function vlh(a){this.hb=ah(a,-1,0)}v(vlh,dh);vlh.prototype.toBuilder=function(){return new ulh(this)};vlh.prototype.zT=function(a){return th(this,2,a,nlh)};function wlh(a){C.call(this,a)}v(wlh,C);wlh.prototype.zT=function(a){return this.message.zT(a)};function xlh(a){this.hb=ah(a,-1,0)}v(xlh,dh);xlh.prototype.toBuilder=function(){return new wlh(this)};xlh.prototype.zT=function(a){return th(this,1,a,nlh)};function ylh(a){C.call(this,a)}v(ylh,C);ylh.prototype.getStatus=function(){return this.message.getStatus()};
function zlh(a){this.hb=ah(a,-1,0)}v(zlh,dh);zlh.prototype.toBuilder=function(){return new ylh(this)};zlh.prototype.getStatus=function(){return rh(this,1,0)};function Alh(a,b){return new Sm(function(c,d){cp(xk(yk(wk(dp(vk(a.C.Oe("/answers/tablemetadata"),"did",b),"POST"),2),function(e){e=eh(hlh,JSON.stringify(e.we()));c(e)}),function(){d()})).Re()})}function Blh(a,b){return new Sm(function(c,d){tH(a,"/dbx/createDelegation",[],b.pb(),function(e){c(eh(llh,JSON.stringify(e.we())))},d)})}
function Clh(a,b){return new Sm(function(c,d){tH(a,"/dbx/updateDelegation",[],b.pb(),function(e){c(eh(zlh,JSON.stringify(e.we())))},d)})}function Dlh(a){Date.now()-a.D>a.F&&a.clearCache()}function Elh(a,b){return a.C.has(b)?a.C.get(b):null}function Flh(a,b){var c=new Set;b.forEach(function(d){a.ea.add(d);c.add(d)});g3b(a,c,"dbobjectmodel-event-update")}function Glh(a,b){a.D&&a.F&&b.forEach(function(c){a.D.C.has(c)?Elh(a.D,c)||a.F.C(116202):a.F.C(1162031)})}
function Hlh(a,b){a.F.C(36994);b||a.F.C(36995)}function Ilh(a,b,c,d){bqe(a.J,b,function(e){var f=e.filter(function(h){return 2==h.mf().getState()});c(f);e=e.filter(function(h){return 2!=h.mf().getState()});d(e)},d,!0,2)}
function Jlh(a,b){if(a.O&&b&&a.F){b=N().CMb()(b.gb());yd(b)||Dlh(a.D);for(var c=[],d=0;d<b.length;d++){var e=b[d];a.D.C.has(e)?(e=Elh(a.D,e),Hlh(a,e)):c.push(e)}yd(c)||Ilh(a,c,function(f){f.forEach(function(h){h=h.Rl();a.D.C.set(h,!0);Hlh(a,!0)})},function(f){f.forEach(function(h){var k=h.mf();k=ih(h,1)&&37==k.getErrorCode();h=h.Rl();a.D.C.set(h,!k);Hlh(a,!k)})})}}function Klh(a,b,c,d){bqe(a.J,b,function(e){var f=e.filter(function(h){return 2!=h.mf().getState()});0==f.length?c(e):d(f)},d,!0)}
function Llh(a,b,c,d){N1e(a.J,b,c,d,!0)}function Mlh(a){var b=sH.getInstance();return new Sm(function(c,d){C1e(b,"/dbx/delegations",function(e){c(eh(slh,JSON.stringify(e.we())))},d,["data",a.pb()])})}function Nlh(a){var b=sH.getInstance();return new Sm(function(c,d){tH(b,"/charts/score",[],a.pb(),function(e){e=eh(jlh,JSON.stringify(e.we()));c(e)},d)})}function Olh(a){var b=sH.getInstance();b.F=a;b.C&&b.F.kE(b.C)}
function Plh(a,b,c){return new Sm(function(d,e){gw(c,function(){tH(a,"/dbx/refreshSlicerObject",a.D?["esid",a.D]:[],b.pb(),function(f){f=eh(xlh,JSON.stringify(f.we()));d(f)},function(){var f=ZP(YP().Db(3),31).build();f=olh(f).build();var h=void 0===h?gh(xlh):h;h=new wlh(h);f=Ch(h,1,f).build();e(f)})})})}
function Qlh(a,b,c){return new Sm(function(d,e){gw(c,function(){tH(a,"/dbx/refreshObject",a.D?["esid",a.D]:[],b.pb(),function(f){f=eh(vlh,qk(f.we(),dma));d(f)},function(){var f=ZP(YP().Db(3),31).build();f=olh(f).build();var h=void 0===h?gh(vlh):h;h=new ulh(h);f=Ch(h,2,f).build();e(f)})})})}
function Rlh(a,b,c){return new Sm(function(d,e){gw(c,function(){tH(a,"/dbx/validateCalculatedColumn",[],b.pb(),function(f){f=eh(x1e,JSON.stringify(f.we()));d(f)},function(){var f=ZP(YP().Db(3),31).build();f=y1e(f).build();e(f)})})})}function Slh(a){return a.D["ritz-DisplayCountBigsheetsPromo"]}function Tlh(a){a.ma&&a.ma.cd(a.La(),a.ea?5:1,new lq(0,a.ea?50:0,12,a.ea?0:50))}
function Ulh(a,b,c,d,e,f,h,k,l){qJ.call(this,a,b,c,d,e,l);this.F=new Umc(h,d.qc(),k,l);this.Ha(this.F,!0);this.H=f;this.D=null}v(Ulh,qJ);Ulh.prototype.Ca=function(){var a=this.qa().Ca("DIV","waffle-dbsource-container");this.mb(a)};Ulh.prototype.Ja=function(){qJ.prototype.Ja.call(this);this.D=new hw(this.La(),this.qa());iw(this.D)};Ulh.prototype.yd=function(){Wf(this.D);qJ.prototype.yd.call(this)};
Ulh.prototype.focus=function(){var a=this.F;a.D.isVisible()&&a.D.isEnabled()&&(a.D.La().focus(),a.D.Pp(!0));this.H.Db(2)};function Vlh(a){var b=a.O.C.C;if(AC(b))return N().lWa()(b.gb());(b=Y2e(a))||(b=(b=eDc(a))?fDc(a,b):null);if(b||(b=(b=Z2e(a))?N().yZ()(b):null))return b;b=pG(a.Sa());return fDc(a,b)}function Wlh(a,b){[a.O,a.Ia].forEach(function(c){return c.setPosition(b)});a.D.some(function(c){c.C.setPosition(b)})}
function Xlh(){var a=sH.getInstance(),b=Ylh();return new Sm(function(c){tH(a,"/dbx/getBigsheetsPromoRelevance",[],b.pb(),function(d){d=eh(qlh,JSON.stringify(d.we()));c(d)},function(){var d=void 0===d?gh(qlh):d;d=new plh(d);d=Bh(d,1,0).build();c(d)})})}function Zlh(a){a=a||{};return T6e(a.color,a.tjc)}function $lh(a){C.call(this,a)}v($lh,C);function amh(a,b){return yh(a,1,b)}$lh.prototype.Hd=function(){return this.message.Hd()};function bmh(a,b){return yh(a,2,b)}
function cmh(a){this.hb=ah(a,-1,0)}v(cmh,dh);cmh.prototype.toBuilder=function(){return new $lh(this)};cmh.prototype.Hd=function(){return nh(this,2)};function dmh(){var a=void 0===a?gh(cmh):a;return new $lh(a)}function emh(a){C.call(this,a)}v(emh,C);function fmh(a,b){return Eh(a,2,b)}function gmh(a){this.hb=ah(a,-1,0)}v(gmh,dh);gmh.prototype.toBuilder=function(){return new emh(this)};function hmh(){var a=void 0===a?gh(gmh):a;return new emh(a)}function imh(a){C.call(this,a)}v(imh,C);
function jmh(a){this.hb=ah(a,500,0)}v(jmh,dh);jmh.prototype.toBuilder=function(){return new imh(this)};function Ylh(){return gh(jmh)}function kmh(a){C.call(this,a)}v(kmh,C);function lmh(a,b){return wh(a,1,b)}function mmh(a){this.hb=ah(a,-1,0)}v(mmh,dh);mmh.prototype.toBuilder=function(){return new kmh(this)};function nmh(){var a=void 0===a?gh(mmh):a;return new kmh(a)}function omh(){var a=void 0===a?gh(slh):a;return new rlh(a)}function pmh(a){C.call(this,a)}v(pmh,C);
function qmh(a){this.hb=ah(a,-1,0)}v(qmh,dh);qmh.prototype.toBuilder=function(){return new pmh(this)};function rmh(a){C.call(this,a)}v(rmh,C);function smh(a){this.hb=ah(a,-1,0)}v(smh,dh);smh.prototype.toBuilder=function(){return new rmh(this)};function tmh(a){C.call(this,a)}v(tmh,C);function umh(a,b){return yh(a,1,b)}function vmh(a,b){return Eh(a,2,b)}function wmh(a){this.hb=ah(a,-1,0)}v(wmh,dh);wmh.prototype.toBuilder=function(){return new tmh(this)};
function xmh(){var a=void 0===a?gh(wmh):a;return new tmh(a)}function ymh(a,b){return{title:a,body:b}}function i3(a){return ymh("Query failed",a)}function zmh(a){return a?TWb[a]||"other":"other"}
function Amh(a,b){var c=b.getErrorCode(),d=b.Aj();if(0==a)return i3($7e(d));switch(c){case 36:case 20:case 45:case 46:case 49:case 50:case 51:case 53:return i3(a8e(3,d,b));case 37:return i3(O7e(d));case 6:return a=(new kv("{objectType, select, chart {The data source took too long to return this chart. Please try again.} pivot_table {The data source took too long to return this pivot table. Please try again.} formula {The data source took too long to return this formula result. Please try again.} record {The data source took too long to return this extract. Please try again.} datasource_preview {The data source took too long to return this preview. Please try again.} other {The data source took too long to return data. Please try again.}}")).format({objectType:zmh(a)}),ymh("Timed out",
Z7e(a,d));case 8:return b=UWb.format(y(A(),"febpr")?5E4:3E4),c=UWb.format(y(A(),"femdrr")?5E4:25E3),b=(new kv("{objectType, select, chart {Results exceed {maxRows} rows. Update this chart and try again.}pivot_table {Update the number of rows and/or columns to a maximum of {dbPivotTableMaxRows} by using filtering, grouping, or customizing number of rows and/or columns. Then, try again.}formula {Results exceed {maxRows} rows. Update this function and try again.} record {Results exceed {dbRecordMaxRows} rows. Update this extract and try again.} datasource_preview {Results exceed {maxRows} rows. Update this connected sheet and try again.} other {Results exceed {maxRows} rows. Update this query and try again.}}")).format({objectType:zmh(a),
maxRows:VWb,dbPivotTableMaxRows:b,dbRecordMaxRows:c}),ymh(1==a?"Rows and/or columns exceed limit":"Too many rows",Z7e(b,d));case 18:return ymh("Unsupported type",hV("The query returns a type which is currently not supported."));case 19:return i3(R7e());case 22:return i3(S7e());case 26:return i3(hV("The column type of connected data is not compatible with the operation."));case 30:return i3(hV("Sorting by an array column is not supported for connected sheets and extracts."));case 32:return ymh("Too many customized number of rows & columns",
hV("Your pivot table contains one or more array database columns. Only one can have customized number of rows or columns."));case 33:return i3(U7e());case 35:return d=(new kv("{objectType, select, chart {A column referenced by this chart is not available.} pivot_table {A column referenced by this pivot table is not available.} formula {A column referenced by this formula is not available.} record {A column referenced by this extract is not available.} datasource_preview {The column settings do not match the data source. Try removing sorts, filters and calculated columns and try again.} other {A column referenced by this object is not available.}}")).format({objectType:zmh(a)}),
d=hV(d),i3(d);case 34:return d=(new kv("{objectType, select, chart {A calculated column referenced by this chart no longer exists. Update and try again.} pivot_table {A calculated column referenced by this pivot table no longer exists. Update and try again.} formula {A calculated column referenced by this formula no longer exists. Update and try again.} record {A calculated column referenced by this extract no longer exists. Update and try again.} datasource_preview {A calculated column referenced by this preview no longer exists. Update and try again.} other {A calculated column referenced by this object no longer exists. Update and try again.}}")).format({objectType:zmh(a)}),
d=hV(d),i3(d);case 38:return i3($7e(null));case 39:return i3(T7e());case 40:return i3(hV("A calculated column has an invalid formula. Update and try again."));case 15:return i3(P7e(nh(b,6).toUpperCase()));case 14:return i3(Q7e(nh(b,6).toUpperCase()));case 42:return i3(V7e());case 43:return i3(W7e());case 44:return i3(X7e());case 47:return i3(hV("The delegated access settings are invalid. The delegated access has been disabled. Please refresh again."));case 48:return i3(hV("Refresh using delegation is unavailable now. Please disable delegated access in connection settings or try again later."));
case 52:return i3(hV("You can not refresh with delegated credentials because you are not in the same organization as the credential owner."))}return i3($7e(d))}
function Bmh(a,b){a=Amh(a,b);if(ih(b,11)&&ih(b.sb(11,zpa),5)){var c=b.sb(11,zpa),d=nh(c.Bf(),2);if(d&&0!=d.length){var e=nh(c.sb(8,xpa),2),f=!!e&&0<e.length,h=ih(b,8)&&0<ph(b,8),k=new Date(ph(b,8)),l=(new Ow(1)).format(k);k=(new Ow(5)).format(k);2==rh(c,1,0)?c=h?"A scheduled refresh created by "+(d+(" failed at "+(k+(" on "+(l+". \n\n"))))):"A scheduled refresh created by "+(d+" failed. \n\n"):(c=h?f?"A query created by "+(d+(" using "+(e+("'s credentials failed at "+(k+(" on "+(l+". \n\n"))))))):
"A query created by "+(d+(" failed at "+(k+(" on "+(l+". \n\n"))))):f?"A query created by "+(d+(" using "+(e+"'s credentials failed. \n\n"))):"A query created by "+(d+" failed. \n\n"),b=b.getErrorCode(),f&&(37==b||52==b)&&d!=e&&Ex.isEnabled()&&y(A(),"fedd")&&(c+="To attempt refreshing using your own credentials, disable delegated access in connection settings and try again. \n\n"));b=cf("span",{"class":"waffle-dataconnector-error-user"},bf(c))}else b=null}else b=null;if(!b)return a;b=df([b,a.body]);
return{title:a.title,body:b}}function Cmh(a,b,c,d){this.D=a;this.C=b;this.F=c;this.H=d}Cmh.prototype.Rl=g("D");Cmh.prototype.gb=g("H");function Dmh(){var a=new Tw,b="Configure a project in the Google Cloud Platform console to continue. "+(a.Kc("a",{"class":"goog-inline-block",href:"https://connectedsheets.page.link/addproject",target:"_blank"})+("Learn more"+a.Jc("a")));return a.format(b)}
function Emh(a){var b=cV(a);a=nh(b,5);b=b.sb(4,SU);var c=nh(b,3)||"";b=c+(c?".":"")+nh(b,2)+"."+b.getName();b=P5e("select * from `"+b+"`");a=yh(b,5,a).build();b=k7e();b=Bh(b,2,2);return i7e(b,a).build()}
function Fmh(){var a='<div class="'+U("waffle-bigquerydbsourcesettingsdialog-project-section")+'"><div class="'+U("waffle-bigquerydbsourcesettingsdialog-project-heading")+'"><h3 class="'+U("waffle-bigquerydbsourcesettingsdialog-project-title")+'">';a=a+'Choose a cloud project</h3></div><div class="'+(U("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper")+'"></div></div>');return T(a)}
function Gmh(){var a='<div class="'+U("waffle-bigquerydbsourcesettingsdialog-footer-wrapper")+'"><p class="'+U("waffle-bigquerydbsourcesettingsdialog-footer-message")+'">';return T(a+'Your use of BigQuery is governed by the <a href="https://cloud.google.com/terms/" target="_blank">Google Cloud Platform Terms of Service</a>.</p></div>')}
function Hmh(a,b,c,d){hW.call(this,"waffle-bigquerydbsourcesettingsdialog",d);d=c?"Edit data connection":"Add data connection";this.setTitle(this.qa().Ca("SPAN",void 0,d));this.L=a;this.J=b;this.O=c||null;this.C=new gff(void 0,this.qa());this.Ha(this.C);this.F=null;this.D=new Eff(this.qa());this.D.Ob("waffle-bigquerydbsourcesettingsdialog-info-icon");this.D.setVisible(!1);this.Ha(this.D)}v(Hmh,hW);
Hmh.prototype.Ca=function(){hW.prototype.Ca.call(this);vr(this.zb(),Fmh);aW(this).appendChild(xr(Gmh));var a=this.D.C;a.Ob("waffle-bigquerydbsourcesettingsdialog-info-bubble");a.setPosition(2,2,0,-8);var b="Displaying the top "+(Jmc.format(1E4)+" projects. To use an unlisted project, enter the full project ID in the search bar and press enter.");a.setContent(Ze(b));this.D.render(this.bb("waffle-bigquerydbsourcesettingsdialog-project-heading"));Yr(this.D.La(),b);this.C.render(this.bb("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"));
(this.C.gj||null).setAttribute("placeholder","Search projects");this.qa().Sh(this.C.La(),!1)};Hmh.prototype.Ja=function(){var a=this;hW.prototype.Ja.call(this);this.C.Jl(!0);Tef(this.L).then(function(b){a.yb()&&(b&&0!=b.length||a.J.C(36566),Imh(a,b),a.C.Jl(!1))},function(){a.yb()&&(a.J.C(36685),Lu.getInstance().postMessage(Nu("Could not connect to BigQuery","error",!0)),Imh(a,[],!0),a.C.Jl(!1))})};
function Imh(a,b,c){c=void 0===c?!1:c;a.D.setVisible(!0);if(0!=b.length||c)Jmh(a,b),a.getHandler().listen(a.C,"action",function(e){return Kmh(a,e,b)});else{c=a.qa();var d=Jm(c,Dmh());P(a.Da("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"),!1);c.appendChild(a.Da("waffle-bigquerydbsourcesettingsdialog-project-section"),c.Ca("DIV","waffle-bigquerydbsourcesettingsdialog-error-caption",d))}}function Jmh(a,b){b=Lmh(b);iff(a.C,b);mff(a.C);jff(a.C)}
function Lmh(a){return rd(a,function(b){return new Vef(b.getId(),b.getName())})}function Kmh(a,b,c){b=b.target.Sa();var d=b instanceof Vef?b.dR:b.getValue();bs(a.La(),"waffle-bigquerydbsourcesettingsdialog-transition-out");a.C.W6("translateX(-24px)").then(function(){return a.resolve(new Sef(c,d,d,"db-source-table",a.O))})}
function Mmh(a){a.F=new mw("Pick your GCP project","Get started by selecting the Google Cloud project containing the dataset you need. You may change the billing project in the next step.",a.Da("waffle-bigquerydbsourcesettingsdialog-project-section"),a.qa(),"waffle-bigquerydbsourcesettingsdialog-tooltip");a.F.setPosition(0,2);a.F.C.Fu=!1;a.F.render(a.zb());a.getHandler().Ye(a.F.aJ(),El,function(){a.F.setVisible(!1)})}
function Nmh(){var a='<div class="'+U("waffle-bigquerywrongskudialog-message")+'">';return T(a+"Thank you for your interest in connected sheets. Unfortunately, you don't have the required G Suite license to gain access.</div>")}function Omh(){return T('<div class="'+U("waffle-bigquerywrongskudialog-learn-more-wrapper")+'"></div>')}
function Pmh(a){$V.call(this,"waffle-bigquerywrongskudialog",a);this.setTitle(this.qa().Ca("SPAN",void 0,"Upgrade to get access"));this.C=new uw("Learn more",this.qa());this.Ha(this.C)}v(Pmh,$V);
Pmh.prototype.Ca=function(){$V.prototype.Ca.call(this);vr(this.zb(),Nmh);aW(this).appendChild(xr(Omh));this.C.render(this.Da("waffle-bigquerywrongskudialog-learn-more-wrapper"));this.getHandler().listen(this.C,"action",function(){qr("https://connectedsheets.page.link/support")});var a=this.Da("waffle-bigquerywrongskudialog-message");a.id=kr(this,"waffle-bigquerywrongskudialog-message");Vr(this.La(),"describedby",a.id)};
function Qmh(a,b,c,d,e,f,h,k,l){bV.call(this,d,h,k,l);this.F=a;this.ma=b;this.Aa=c;this.Ea=f;this.xa=e}v(Qmh,bV);Qmh.prototype.Ca=function(){bV.prototype.Ca.call(this);this.mb(xr(b8e,{tO:!1}))};Qmh.prototype.Ja=function(){bV.prototype.Ja.call(this);null!=this.ma&&(this.C.setValue(N().xMb()(this.ma.pb(),this.F)),this.canEdit&&this.XT())};Qmh.prototype.AZa=function(){return this.xa.getRitzFormulaValidationResultForCalculatedColumn(this.F,e7e(this),gWb(this.Aa))};
Qmh.prototype.jbb=function(a){var b=this;this.J=!0;this.Eqa();a=d8e(e8e(g8e(),this.F),a).build();Rlh(sH.getInstance(),a,this.Ea).then(function(c){c=c.mf();3==c.getState()?(c="BigQuery error: "+c.Aj(),c7e(b,!1,c)):c7e(b,!0,null);d7e(b)},function(){c7e(b,!1,null);d7e(b)})};function Rmh(a,b,c){jV.call(this,a,b,c)}v(Rmh,jV);Rmh.prototype.Ja=function(){jV.prototype.Ja.call(this)};Rmh.prototype.Caa=function(){this.C.Ob("waffle-calculated-columns-tooltip-help-bubble");jV.prototype.Caa.call(this)};
Rmh.prototype.J=function(){k8e(this,"https://connectedsheets.page.link/calccolhelp");var a="="+(N().yq()("RIGHT")+"(orderId, 4)");var b="="+(N().yq()("YEAR")+"(startDate)");var c="="+(N().yq()("IF")+"(units > 0, total/units, 0)");this.C.setContent(this.qa().Ca("DIV",void 0,kV("waffle-db-object-formula-tooltip-help-bubble-title","Try these formulas"),kV("waffle-db-object-formula-tooltip-help-bubble-subtitle","Do basic math"),kV("waffle-db-object-formula-tooltip-help-bubble-example","=price * quantity"),
kV("waffle-db-object-formula-tooltip-help-bubble-subtitle","Manipulate text"),kV("waffle-db-object-formula-tooltip-help-bubble-example",a),kV("waffle-db-object-formula-tooltip-help-bubble-subtitle","Use dates"),kV("waffle-db-object-formula-tooltip-help-bubble-example",b),kV("waffle-db-object-formula-tooltip-help-bubble-subtitle","Apply conditional logic"),kV("waffle-db-object-formula-tooltip-help-bubble-example",c),this.LO))};function Smh(a){C.call(this,a)}v(Smh,C);Smh.prototype.Hd=function(){return this.message.Hd()};
Smh.prototype.yn=function(){return this.message.yn()};function Tmh(a){this.hb=ah(a,-1,0)}v(Tmh,dh);Tmh.prototype.toBuilder=function(){return new Smh(this)};Tmh.prototype.Hd=function(){return nh(this,1)};Tmh.prototype.yn=function(){return nh(this,3)};function Umh(a,b,c,d,e){IG.call(this,153);this.D=a;this.J=b;this.C=c||"";this.O=d;this.L=e}v(Umh,IG);
Umh.prototype.Nd=function(){var a=void 0===a?gh(Tmh):a;a=new Smh(a);a=yh(a,1,this.D);a=yh(a,4,this.J);a=yh(a,3,this.C);a=yh(a,2,this.O);return xh(a,5,this.L).build()};function Vmh(a,b,c){wl.call(this,a);this.hn=b;this.C=c}v(Vmh,wl);
function Wmh(a,b,c,d,e,f,h,k,l,n,q){$U.call(this,a,null==b,e,f,n,q);this.nf=new Rmh(n,q,this.qa());this.Ha(this.nf);this.xa=b;null==b?b=null:(e=Tpa(),e.Pi(1,2),b=yh(e,2,b).build());this.R=b;this.Va=c;this.Ra=d;this.F=new Qmh(a,this.R,d,f,k,l,n,q,this.qa());this.Ha(this.F);this.Ta=h}v(Wmh,$U);p=Wmh.prototype;p.Na=function(){$U.prototype.Na.call(this)};
p.Ca=function(){$U.prototype.Ca.call(this);var a=null==this.xa?"Add calculated column":this.canEdit?"Edit calculated column":"View calculated column";this.setTitle(a);var b=OXa(this);b&&Yr(b,a);a=xr(i8e,{canEdit:this.canEdit,WTa:"Calculated column name",description:"Calculated columns let you create new columns for better analysis by using Sheets functions and the current data in your connected sheet."});b=this.zb();this.qa().appendChild(b,a);this.nf.render(this.Da(ZU.TOOLTIP));this.F.render(this.Da(ZU.kJa))};
p.Ja=function(){$U.prototype.Ja.call(this);null!=this.R&&(this.C.setValue(UF(this.R,this.hn)),this.pAa());this.yba();this.getHandler().listen(this.F,"validation-update",this.yba)};p.yd=function(){$U.prototype.yd.call(this)};p.v9a=function(){for(var a=[],b=ha(this.Va),c=b.next();!c.done;c=b.next())c=c.value,ih(dH(c),2)||a.push(c);G6e(this,a)};p.BGa=function(){var a=xVb(this.ea,!1,!1,!0,!1);E6e(this.L,a)};
p.n1a=function(){var a=this,b=e7e(this.F);if(!Zd(b)){var c=null==this.xa;b=new Umh(this.hn,O0e(this.C.getValue()),this.xa,b,flh(this.Ra));var d=c?36645:36647,e=c?36644:36646;TG(b,function(f){a.ma.C(f?e:d,a.Sk);f&&a.dispatchEvent(new Vmh("update",a.hn,c))});this.Ta.C(b)}};p.u_a=function(a){a=a.target.getValue();a=eVb(a,this.hn);f7e(this.F,a)};p.b0a=function(a){a=a.target.getValue().getName();g7e(this.F,a)};
p.Dqa=function(){if(qf(this.C.getValue()))var a=null;else a:{var b=this.Ra,c=this.C.getValue();a=this.R;c=O0e(c);if(Zd(c))a="Calculated column name cannot be empty";else{for(var d=ha(b.C.keys()),e=d.next();!e.done;e=d.next())if(e=e.value,Xd(e,c))if(d=null!=a,b=b.C.get(e),d&&a.equals(b))break;else{a="A column named "+(c+" already exists");break a}a=null}}return a};p.p3a=function(){return this.F.L};
function Xmh(){var a='<div class="'+U("waffle-dbanswers-answers-bar")+'"><div class="'+U("waffle-dbanswers-answers-bar-controls")+'"><div class="'+U("waffle-dbanswers-answers-bar-input")+'"></div><div class="'+U("waffle-dbanswers-answers-bar-enable-button")+'">';a=a+'Enable</div></div><div class="'+(U("waffle-dbanswers-answers-bar-message")+'"></div></div>');return T(a)}
function Ymh(){var a='<div class="'+U("waffle-dbanswers-answers-bar-enable-answers-popup")+'">',b='To perform natural language queries on this data, ask the table owner or admin to follow the <div class="'+(U("waffle-dbanswers-answers-bar-enable-answers-popup-setup-link")+'">setup instructions.</div>');return T(a+b+"</div>")}
function Zmh(a,b){S.call(this,b);this.F=a;this.C=new st;fZa(this.C,0);gZa(this.C,5,5,5,5);Jne(this.C,!0);this.oa(this.C);this.D=new wt(null,new wO,this.qa());this.Ha(this.D)}v(Zmh,S);p=Zmh.prototype;p.Ca=function(){var a=xr(Ymh);this.mb(a);Vr(a,"hidden",!0);P(a,!1);this.C.Iw(a);this.D.Wa(this.bb("waffle-dbanswers-answers-bar-enable-answers-popup-setup-link"))};p.Ja=function(){S.prototype.Ja.call(this);this.getHandler().listen(this.D,"action",this.Xdc)};
p.Ci=function(a){this.C.setPosition(new Ht(a,0,!0))};p.setVisible=function(a){this.C.setVisible(a);a&&this.D.La().focus()};p.isVisible=function(){return this.C.isVisible()};p.cd=function(){this.C.cd()};p.Xdc=function(a){a.stopPropagation();a.preventDefault();a=nq(new mq,75).build();this.F.C(36761,a);y(A(),"docs-idu")?of("https://sites.google.com/corp/google.com/data-qna#h.p_Vf6xbc97l9jL"):of("https://docs.google.com/document/u/1/d/e/2PACX-1vRNytdUb20j3I6WPQXLmmIfOHkWR3a0iPg4ck1AdXzSznrW3USl3NtYGIk34sBQaxl_fSiUPclFqJK4/pub?urp=gmail_link#h.ng0zmdirli5c")};
function $mh(a,b,c,d,e,f){jW.call(this,a,b,c,NWb.getInstance(),"db",d,e,f);this.D="";this.O=0;this.ma=new dP(void 0,this.qa());this.Ha(this.ma);this.R=new Zmh(b,this.qa());this.Ha(this.R);this.ea=null}v($mh,jW);p=$mh.prototype;p.Gc=function(a){this.mb(a);var b=xr(Xmh);this.qa().appendChild(a,b);a=this.bb("waffle-dbanswers-answers-bar-input");this.F.render(a);this.ma.Wa(this.bb("waffle-dbanswers-answers-bar-enable-button"));this.R.render();this.R.Ci(this.ma.La())};
p.Ja=function(){jW.prototype.Ja.call(this);this.O_()};p.O_=function(){jW.prototype.O_.call(this);this.getHandler().listen(this.ma,"action",this.L2b)};p.lI=function(){return OF(this.H.C)&&y(A(),"feda")&&!Os().C?jW.prototype.lI.call(this):!1};p.Oa=function(a){this.yb()&&(0!=this.O&&y(A(),"fedaic")?(jW.prototype.Oa.call(this,!1),anh(this,!0)):(anh(this,!1),jW.prototype.Oa.call(this,a)))};p.hQ=function(){jW.prototype.hQ.call(this);this.R.isVisible()&&this.R.cd()};p.$1a=function(a){k6e(a,null,this.D,this.lh())};
p.qba=function(){this.D?bnh(this):this.TB();l6e(null,this.D,this.lh())};p.TB=function(){jW.prototype.TB.call(this);this.D="";l6e(null,null,this.lh())};p.aia=function(){return cnh(this.O)};p.TGa=m(!0);function dnh(a,b){a.D!=b&&(a.D=b,y(A(),"fedaic")?(a.ea&&a.ea.cancel(),a.ea=Alh(sH.getInstance(),a.D),Zm(a.ea.then(function(c){a.O=c.getError();c=0==a.O;a.Oa(c);c?a.lI()&&a.qba():a.TB()},function(c){c instanceof $m||(a.O=4,a.Oa(!1),a.TB())}),function(){a.ea=null})):a.lI()&&a.qba())}
function bnh(a){if(Fff(a)){var b=a.L;b.D=a.D;b.yL();Olh(b);b.RP([]);var c=a.H;pn(function(){a.D&&VH(c.ea,a.D,!0).then(function(d){return enh(a,d,a.D)})},3E3)}}function enh(a,b,c){b.forEach(function(d){var e=eVb(d,c);if(null!=e){var f=a.L;a:{if(d.hasType())switch(d.getType()){case 1:case 2:case 4:case 5:case 6:case 7:d="$dim";break a;case 3:d="$met";break a}d="$unu"}DWb(f,e,d)}})}
function anh(a,b){a.ma.setVisible(1==a.O);var c=a.bb("waffle-dbanswers-answers-bar-message");b=b?cnh(a.O):"";a.qa().Ce(c,b)}p.L2b=function(){this.J.C(36760,Gff(this));this.R.setVisible(!0)};
function cnh(a){switch(a){case 1:return"The admin for this table hasn't enabled Answers yet.";case 2:return"Answers is not yet supported for data sets created by custom query.";case 3:return"The admin for this table hasn't enabled Answers yet.";case 4:return"Answers is unavailable at the moment, please try again later.";case 5:return"This data table is being setup for Answers in the background. Please try again in some time.";default:return""}}
function fnh(){return T('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#5f6368" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-2-3.5l6-4.5-6-4.5z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>')}
function gnh(){return T('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#5f6368" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17l-.59.59-.58.58V4h16v12zm-9-4h2v2h-2zm0-6h2v4h-2z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>')}function hnh(){var a='<div class="'+U("waffle-dbsource-pill-menuitem")+'">'+DVb();return T(a+"Learn more about BigQuery</div>")}
function inh(){var a='<div class="'+U("waffle-dbsource-pill-menuitem")+'">'+gnh();return T(a+"Send feedback</div>")}function jnh(){var a='<div class="'+U("waffle-dbsource-pill-menuitem waffle-dbsource-configbar-watch-tutorial-menuitem")+'">'+fnh()+"<div>";a=a+'Watch tutorial<div class="'+(U("waffle-dbsource-configbar-watch-tutorial-menuitem-caption")+'">');return T(a+"Learn the ins and outs of Connected Sheets</div></div></div>")}
function knh(){return T('<div class="'+U("waffle-dbsource-configbar-actions")+'"><div class="'+U("waffle-dbsource-configbar-columns-menu-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-chart-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-pivot-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-function-button-wrapper")+
'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-table-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-calculated-column-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-column-insights-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-answers-wrapper")+'"></div></div>')}
function lnh(a){a=a.I2a;var b='<div class="'+U("waffle-dbsource-configbar-wrapper")+'"><div class="'+U("waffle-dbsource-configbar")+'"><div class="'+U("waffle-dbsource-configbar-header")+'"><div class="'+U("waffle-dbsource-configbar-header-icon")+'">'+R6e(24)+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';b+=Hr("Connected sheet name");b+='"></div><div class="'+U("waffle-dbsource-configbar-separator")+'"></div><div class="'+U("waffle-dbsource-configbar-header-subtitle")+
'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-refresh-options-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+U("waffle-dbsource-configbar-watch-tutorial-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-send-feedback-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-connection-settings-button-wrapper")+'"></div></div></div>'+knh()+"</div></div>"+(a?
'<div class="'+U("waffle-dbsource-configbar-preview-bar-wrapper")+'"></div>':"");return T(b)}
function mnh(a){a=a.I2a;var b='<div class="'+U("waffle-dbsource-configbar-wrapper")+'"><div class="'+U("waffle-dbsource-configbar")+'"><div class="'+U("waffle-dbsource-configbar-header")+'"><div class="'+U("waffle-dbsource-configbar-header-icon")+'">'+R6e(24)+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';b+=Hr("Connected sheet name");b+='"></div><div class="'+U("waffle-dbsource-configbar-separator")+'"></div><div class="'+U("waffle-dbsource-configbar-header-subtitle")+
'"></div><div class="'+U("waffle-dbsource-configbar-button-wrapper")+" "+U("waffle-dbsource-configbar-refresh-options-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-schedules-widget-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+U("waffle-dbsource-configbar-connection-settings-button-wrapper")+'"></div><div class="'+U("waffle-dbsource-configbar-auxiliary-menu-button-wrapper")+'"></div></div></div>'+knh()+"</div></div>"+(a?'<div class="'+
U("waffle-dbsource-configbar-preview-bar-wrapper")+'"></div>':"");return T(b)}
function nnh(){var a=T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="#188038" fill-rule="nonzero"><path d="M14.5263158 2C15.3368421 2 16 2.7 16 3.55555556V14.4444444C16 15.3 15.3368421 16 14.5263158 16H3.47368421C2.66315789 16 2 15.3 2 14.4444444V3.55555556C2 2.7 2.66315789 2 3.47368421 2H14.5263158zM3.5 3.5v11h11v-11h-11z"/><path d="M6.75 12.75h-1.5V7.5h1.5zM9.75 12.75h-1.5v-7.5h1.5zM12.75 12.75h-1.5v-3h1.5z"/></g></svg>');return T(a+"<span>Chart</span>")}
function onh(){var a=T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" fill-rule="evenodd" d="M10 13h1.185c.9975 0 1.815-.81 1.815-1.815V10h-2.25l3-3 3 3H14.5v1.185c0 1.83-1.485 3.315-3.315 3.315H10v2.25l-3-3 3-3V13zM8 6V2h6.5454545C15.3454545 2 16 2.72 16 3.6V6H8zM2 6V3.6C2 2.72 2.72 2 3.6 2H6v4H2zm1.6 10c-.88 0-1.6-.6545455-1.6-1.4545455V8h4v8H3.6z"/></svg>');return T(a+"<span>Pivot table</span>")}
function pnh(){var a=Hff()+"<span>";return T(a+"Extract</span>")}function qnh(){var a=T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" d="M15 2H3v1.75L8.143 9 3 14.25V16h12v-2.625H7.286L11.571 9 7.286 4.625H15z"/></svg>');return T(a+"<span>Function</span>")}function rnh(a){a=a.label;return T('<span class="'+U("waffle-dbsource-configbar-column-insights-icon")+'">'+$v("docs-icon-img docs-icon-insights")+"</span><span>"+Ar(a)+"</span>")}
function snh(){var a=T('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path fill="#188038" d="M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z"/></g></svg>');return T(a+"<span>Calculated column</span>")}function tnh(){var a='<span class="'+U("waffle-dbsource-configbar-secondary-button-content")+'">'+fnh()+"<span>";return T(a+"Watch tutorial</span></span>")}
function unh(){var a='<span class="'+U("waffle-dbsource-configbar-secondary-button-content")+'">'+gnh()+"<span>";return T(a+"Send feedback</span></span>")}function vnh(){var a='<span class="'+U("waffle-dbsource-configbar-secondary-button-content")+'">'+$v("docs-icon-img docs-icon-info-outline-grey","waffle-dbsource-configbar-secondary-button-icon")+"<span>";return T(a+"Learn more</span></span>")}
function wnh(){var a='<span class="'+U("waffle-dbsource-configbar-secondary-button-content")+'">'+$v("docs-icon-img docs-icon-settings","waffle-dbsource-configbar-secondary-button-icon")+"<span>";return T(a+"Connection settings</span></span>")}
function xnh(){return T('<div class="'+U("waffle-dbsource-configbar-schedules-widget")+'"><div class="'+U("waffle-dbsource-configbar-schedules-widget-content")+'"><div class="'+U("waffle-dbsource-configbar-schedules-widget-last-refresh")+'"><span class="'+U("waffle-dbsource-configbar-schedules-widget-last-refresh-content")+'"></span><span class="'+U("waffle-dbsource-configbar-schedules-widget-last-refresh-divider")+'"></span></div><div class="'+U("waffle-dbsource-configbar-schedules-widget-next-refresh")+
'"><span class="'+U("waffle-dbsource-configbar-schedules-widget-next-refresh-content")+'"></span><span class="'+U("waffle-dbsource-configbar-schedules-widget-edit-button-wrapper")+'"></span></div></div><div class="'+U("waffle-dbsource-configbar-schedules-widget-main-button-wrapper")+'"></div></div>')}
function ynh(a,b){aL.call(this,wr(vnh),new Ft(b),krd.getInstance(),b);this.C=a;this.D=new Map([["bigquery-helpdoc",Xfb],["send-feedback",this.C.Ga("docs-feedback")],["watch-tutorial",dhb]]);this.hd(new At(xr(inh),"send-feedback",this.qa()));this.hd(new Et(this.qa()));this.hd(new At(xr(jnh),"watch-tutorial",this.qa()));this.hd(new Et(this.qa()));this.hd(new At(xr(hnh),"bigquery-helpdoc",this.qa()))}v(ynh,aL);
ynh.prototype.Ja=function(){aL.prototype.Ja.call(this);bs(this.Bb().getElement(),"waffle-dbsource-pill-menu");bs(this.Bb().getElement(),"docs-gm");this.getHandler().listen(this.Bb(),"action",this.F)};ynh.prototype.F=function(a){a=a.target.Sa();a=this.D.get(a);if(a.isEnabled()){var b;a==this.C.Ga("docs-feedback")&&(b={source:"big-sheets-feedback"});a.kb(b)}};
function znh(a){var b=a.label;a=a.pj;return T((a?'<div class="'+U("goog-menuitem-icon")+" "+U("waffle-charteditor-column-filtered-menu-item-icon")+" "+U(a)+'"></div>':"")+'<span class="'+U("waffle-datasource-configbar-columns-menu-item-label")+'">'+Ar(b)+"</span>")}function Anh(){return T('<div class="'+U("waffle-datasource-configbar-columns-menu-spinner-container")+'"></div>')}
function Bnh(a){Ft.call(this,a);this.D=new sV(!1);this.oa(this.D);this.C=new At(xr(Anh),void 0,this.qa());this.C.qB(!1);this.Ha(this.C)}v(Bnh,Ft);Bnh.prototype.Ja=function(){Ft.prototype.Ja.call(this);bs(this.La(),"waffle-datasource-configbar-columns-menu")};Bnh.prototype.Ca=function(){Ft.prototype.Ca.call(this);this.C.render(this.La());this.D.render(this.C.Da("waffle-datasource-configbar-columns-menu-spinner-container"))};
Bnh.prototype.cI=function(a,b){a=ha(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=eVb(c,b);null!==d&&this.addColumn(d,VU(c.getType()))}};Bnh.prototype.addColumn=function(a,b){this.Ha(new At(xr(znh,{label:a,pj:b}),void 0,this.qa()),!0)};function Cnh(a,b){var c=a.C.getElement();c&&(fs(c,"waffle-datasource-configbar-columns-menu-loading",b),P(c,b),a.D.setActive(b))}function Dnh(){Ft.apply(this,arguments)}v(Dnh,Ft);Dnh.prototype.Ja=function(){Ft.prototype.Ja.call(this);bs(this.La(),"waffle-datasource-configbar-formula-menu")};
Dnh.prototype.eI=function(a){var b=this;this.Ha(a,!0);this.getHandler().listen(a,"action",function(){var c=new ND("insert-formula-function");c.uha=a.getValue();b.dispatchEvent(c)})};
function Enh(a,b,c,d){S.call(this,d);this.J=a;this.O=b;this.R=c;this.H=!1;this.F=null;this.D=new wt("Edit",bH.getInstance(),d);this.Ha(this.D);this.C=new ZK("Schedule refresh");this.C.Ob("waffle-dbsource-configbar-schedules-widget-main-button");this.C.Ob("waffle-dbsource-flat-default");this.Ha(this.C);this.L=new mu(this);this.oa(this.L);this.L.Ab(Fx,yp,this.refresh)}v(Enh,S);p=Enh.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(xr(xnh))};
p.Ja=function(){S.prototype.Ja.call(this);this.D.render(this.Da("waffle-dbsource-configbar-schedules-widget-edit-button-wrapper"));this.C.render(this.Da("waffle-dbsource-configbar-schedules-widget-main-button-wrapper"));P(this.La(),!1);this.getHandler().listen(this.C,"action",this.B7b).listen(this.D,"action",this.g$a).listen(EG,"load-schedules-on-config-bar",this.WCa);this.WCa()};
p.refresh=function(){if(!this.isDisposed())if(!this.H||this.R.rf())P(this.La(),!1);else{var a=this.qa(),b=Fx.isEnabled();if(null==this.F)this.C.setVisible(!0),P(this.Da("waffle-dbsource-configbar-schedules-widget-content"),!1),ds(this.La(),"waffle-dbsource-configbar-schedules-widget-highlight"),Qt(this.C.La(),"Schedule a refresh for all connected objects associated with this sheet",void 0);else{this.C.setVisible(!1);P(this.Da("waffle-dbsource-configbar-schedules-widget-content"),!0);bs(this.La(),
"waffle-dbsource-configbar-schedules-widget-highlight");Qt(this.D.La(),"Refresh time for all objects related to current datasource",void 0);var c=this.F.getStatus();if(ih(c,4)){P(this.Da("waffle-dbsource-configbar-schedules-widget-last-refresh"),!0);var d=new Date(1E3*ph(c,4)),e=!1,f=!0;e=void 0===e?!0:e;f=void 0===f?!1:f;var h=new Tw;var k=Iff(this.J);d=(e||d.getDate()!=(new Date).getDate()?ord.format(d,k)+(f?", ":" "):"")+lrd.format(d,k);h=h.format(d);d=this.Da("waffle-dbsource-configbar-schedules-widget-last-refresh-content");
a.qd(d);a.appendChild(d,Jm(a,df(cf("SPAN",{"class":"waffle-dbsource-configbar-schedules-widget-header-label"},"Updated: "),cf("span",void 0,h))))}else P(this.Da("waffle-dbsource-configbar-schedules-widget-last-refresh"),!1);lh(sU(this.F),1)?(h=new Date(1E3*ph(c,2)),d=new Date(1E3*ph(c,3)),h=Lff(h,d,this.J,!1,!1,!1,!0,!0)):h="Paused";d=this.Da("waffle-dbsource-configbar-schedules-widget-next-refresh-content");a.qd(d);a.appendChild(d,Jm(a,df(cf("SPAN",{"class":"waffle-dbsource-configbar-schedules-widget-header-label"},
ih(c,4)?"Next: ":"Next refresh: "),cf("span",void 0,h))));this.D.setVisible(b)}P(this.La(),!0)}};p.WCa=function(){var a=this;P1e().then(function(b){a.isDisposed()||(b=sh(b,1,m1e).Gb(),0==b.length?a.F=null:a.F=b[0],a.H=!0,a.refresh())},function(){Lu.getInstance().postMessage(Nu("Error loading schedule configuration.","error",!0));a.H=!1;a.refresh()})};p.B7b=function(){this.WCa();this.g$a()};p.g$a=function(){var a=nq(new mq,109).build();this.O.C(116123,a);HRb(!0)};
function Fnh(a,b,c,d,e,f,h,k,l){h=void 0===h?null:h;k=void 0===k?null:k;l=void 0===l?null:l;ww.call(this,a,b,c,d);e||(e=new t$a,this.oa(e));this.J=e;this.F=f;this.Ig=h;this.ea=k;this.R=l;this.C=0;this.O=new g8a(this.bj.Qha(),!0,!0);this.F&&this.F.Ah(this.O)}v(Fnh,ww);p=Fnh.prototype;p.C8=function(a){this.bj.isVisible()&&!this.isDismissed()&&this.F&&Rv(this.F,this.O);this.C=1;ww.prototype.C8.call(this,a);this.C=0};
p.L8=function(a){ww.prototype.L8.call(this,a);this.J.ul()?xw(this):Ll(this.H,this.J.h_(),w(this.sib,this))};p.sib=function(){this.J.ul()&&(xw(this),this.Jy())};p.lna=function(){this.bj.render(this.Ig)};p.show=function(){this.isDismissed()||this.bj.isVisible()||this.lna()};p.A8=function(a){this.C=2;ww.prototype.A8.call(this,a);this.C=0};p.Tja=function(a){this.C=3;ww.prototype.Tja.call(this,a);this.C=0};p.iy=function(){var a=this.isDismissed();ww.prototype.iy.call(this);!a&&this.ea&&this.ea(this.C)};
p.M8=function(a){ww.prototype.M8.call(this,a);this.R&&this.R()};p.cd=function(){!this.isDismissed()&&this.bj.isVisible()&&this.bj.Qha().cd()};function Gnh(){var a='<div class="'+U("waffle-dbsource-previewbar")+'"><div class="'+U("waffle-dbsource-previewbar-content")+'"><span class="'+U("waffle-dbsource-previewbar-text")+'">';a=a+'Preview</span><span class="'+(U("waffle-dbsource-previewbar-info-icon-wrapper")+'"></span></div></div>');return T(a)}
function Hnh(a){var b=a.Rmc;a='<div class="'+U("waffle-dbsource-previewbar-info-bubble-content")+'"><div class="'+U("waffle-dbsource-previewbar-info-bubble-title")+'">';b="This sheet shows a preview of up to "+(Ar(b)+" rows");a=a+b+('</div><div class="'+U("waffle-dbsource-previewbar-info-bubble-body")+'"><span>'+aqc()+' </span><span class="'+U("waffle-dbsource-previewbar-info-bubble-link-button")+" "+U("goog-link-button")+'">'+bqc()+'</span></div><div class="'+U("waffle-dbsource-previewbar-info-bubble-button-wrapper")+
'"></div></div>');return T(a)}function Inh(a,b){S.call(this,b);this.H=a;this.C=new Eff(this.qa(),2,xr(Zlh,{color:"#5f6368",tjc:10}));this.Ha(this.C);this.D=new ZK("Create extract",this.qa());this.D.Ob("waffle-dbsource-flat-default");this.Ha(this.D)}v(Inh,S);Inh.prototype.Ca=function(){this.mb(xr(Gnh));var a=this.C.C;a.Ob("waffle-dbsource-previewbar-info-bubble");a.Vo(!0);ut(a,!1);a.setPosition(1,2);a.setContent(xr(Hnh,{Rmc:500}))};
Inh.prototype.Ja=function(){var a=this;S.prototype.Ja.call(this);var b=this.Da("waffle-dbsource-previewbar-info-icon-wrapper");this.C.render(b);var c=this.C.C;this.D.render(c.Da("waffle-dbsource-previewbar-info-bubble-button-wrapper"));var d=c.Da("jfk-bubble-closebtn");d.appendChild(xr(pef));XZa(d,Xr(d));Qt(this.C.uF().La(),"Show information about this preview",void 0);var e=new hw(c.La(),this.qa());iw(e);this.oa(e);if(e=x6e())bs(b,e),bs(d,e);this.getHandler().listen(this.D,"action",function(){a.getHandler().Hc(c,
"hide",a.F);a.C.C.setVisible(!1);a.dispatchEvent("create-extract-button-action")}).listen(this.H,"N",function(){pn(function(){return a.C.C.cd()})}).listen(this.C.La(),"keydown",function(f){var h=a.C.C;h.isVisible()&&9===f.keyCode&&(f.preventDefault(),f.stopPropagation(),f=h.Da("waffle-dbsource-previewbar-info-bubble-link-button"),a.qa().Sv(f).focus())}).listen(c.La(),"keydown",function(f){27===f.keyCode&&c.setVisible(!1)}).listen(c,"beforeshow",function(){a.getHandler().Nc(c,"hide",a.F)})};
Inh.prototype.F=function(){var a=this.C.uF().getElement();a&&a.focus()};var Jnh={enabled:!0,selected:!0,visible:!0},Knh={enabled:!0};function Lnh(){wl.call(this,"configbar-dom-focus-out")}v(Lnh,wl);function Mnh(a,b){wl.call(this,"datasheet-rename");this.gh=a;this.name=b}v(Mnh,wl);
function Nnh(a,b,c,d,e,f,h,k,l,n,q){S.call(this,q);q=y(A(),"fdsrfu");var t=y(A(),"fedpi");this.Pa=a;this.D=b;this.ea=c;this.Pc=d;this.Ma=b.ea;this.Eb=k;this.Cb=l;this.Kb=n;this.Qc=f;this.Ia=new ou;this.oa(this.Ia);this.L=new aL("Columns",new Bnh(this.qa()),void 0,this.qa());this.L.Ob("waffle-dbsource-configbar-columns-menu-button");this.L.Oh(!0);this.Ha(this.L);this.rb=Onh(this,"waffle-dbsource-configbar-chart-button",xr(nnh));this.xb=Onh(this,"waffle-dbsource-configbar-pivot-button",xr(onh));this.Qa=
Onh(this,"waffle-dbsource-configbar-table-button",xr(pnh));a=xr(qnh);this.ma=new Mt(a,new Dnh(this.qa()),Rqd.getInstance(),this.qa());this.ma.Ob("waffle-dbsource-configbar-function-button");this.ma.Oh(!0);this.ma.Zl(!0);this.Ha(this.ma);this.Aa=Onh(this,"waffle-dbsource-configbar-calculated-column-button",xr(snh));this.Ea=this.F=this.Ra=null;y(A(),"fedciv")&&(this.F=Onh(this,"waffle-dbsource-configbar-column-insights-button",xr(rnh,{label:"Column stats"})),this.Ra=new pye,this.oa(this.Ra));this.R=
new ZK("Refresh options");this.R.Ob("waffle-dbsource-configbar-refresh-options-button");this.R.Ob("waffle-dbsource-flat-default");this.Ha(this.R);this.H=null;q?(this.H=Onh(this,"waffle-dbsource-configbar-secondary-button",xr(wnh)),this.Va=new ynh(this.Cb,this.qa()),this.Va.Ob("waffle-dbsource-configbar-secondary-button"),this.Va.Oh(!0),this.Ha(this.Va),this.$a=new Enh(h,this.ea,this.D,this.qa())):(this.jb=Onh(this,"waffle-dbsource-configbar-secondary-button",xr(tnh)),this.ib=Onh(this,"waffle-dbsource-configbar-secondary-button",
xr(unh)),this.H=new ZK(xr(Zv,{icon:"docs-icon-img docs-icon-settings"}),this.qa()),this.H.Ob("waffle-dbsource-configbar-connection-settings-button"),this.Ha(this.H));(this.C=t?new Inh(e,this.qa()):null)&&this.Ha(this.C);this.bd=new Map([[this.L,""],[this.rb,"chart"],[this.xb,"pivot table"],[this.Qa,"table"],[this.ma,"function"],[this.Aa,""],[this.R,""],[this.H,""]]);this.Lc=new Set;y(A(),"fedsccm")||this.Lc.add(this.L);this.zc=new Map([[this.R,Bx],[this.H,Hx],[this.Aa,Cx]]);this.J=null;y(A(),"feda")&&
!Os().C&&(this.J=new $mh(this.D,this.ea,this.Pc,e,75,this.qa()),this.Ha(this.J));this.Ya=this.O=null;this.ub=!1;this.xa=null;this.Ta=new Set}v(Nnh,S);p=Nnh.prototype;p.Ca=function(){var a=y(A(),"fdsrfu"),b=y(A(),"fedpi");this.mb(xr(a?mnh:lnh,{I2a:b}))};
p.Ja=function(){var a=this;S.prototype.Ja.call(this);var b=y(A(),"fdsrfu");this.L.render(this.Da("waffle-dbsource-configbar-columns-menu-button-wrapper"));this.rb.render(this.Da("waffle-dbsource-configbar-chart-button-wrapper"));this.xb.render(this.Da("waffle-dbsource-configbar-pivot-button-wrapper"));this.Qa.render(this.Da("waffle-dbsource-configbar-table-button-wrapper"));this.ma.render(this.Da("waffle-dbsource-configbar-function-button-wrapper"));this.Aa.render(this.Da("waffle-dbsource-configbar-calculated-column-button-wrapper"));
this.F&&(this.F.render(this.Da("waffle-dbsource-configbar-column-insights-button-wrapper")),this.Ra.Of(this.F.La()));this.R.render(this.Da("waffle-dbsource-configbar-refresh-options-button-wrapper"));this.H.render(this.Da("waffle-dbsource-configbar-connection-settings-button-wrapper"));b?(this.Va.render(this.Da("waffle-dbsource-configbar-auxiliary-menu-button-wrapper")),this.$a.render(this.Da("waffle-dbsource-configbar-schedules-widget-wrapper"))):(this.jb.render(this.Da("waffle-dbsource-configbar-watch-tutorial-button-wrapper")),
this.ib.render(this.Da("waffle-dbsource-configbar-send-feedback-button-wrapper")),qu(this.Ia,this.jb,dhb,Jnh),qu(this.Ia,this.ib,this.Cb.Ga("docs-feedback"),Jnh,function(){return{source:"big-sheets-feedback"}}));this.J&&this.J.Wa(this.Da("waffle-dbsource-configbar-answers-wrapper"));this.C&&(this.C.render(this.Da("waffle-dbsource-configbar-preview-bar-wrapper")),this.getHandler().listen(this.C,"create-extract-button-action",function(){return Pnh(a,111)}));qu(this.Ia,this.R,Bx);qu(this.Ia,this.Aa,
Cx);qu(this.Ia,this.H,Hx,Knh,function(){return new nff(Qnh(a),"show-current-source")});this.O=this.Da("waffle-dbsource-configbar-header-title");this.getHandler().listen(this.rb,"action",this.UYb).listen(this.xb,"action",this.Aac).listen(this.Qa,"action",function(){return Pnh(a,109)}).listen(this.ma,"show",this.J0b).listen(this.Aa,"action",this.zYb).listen(this.R,"action",this.Xbc).listen(this.L,"show",this.g_b).listen(this.Pa,"ua",this.yib).listen(this.O,["focus","mousedown"],this.o9b).listen(this.D,
"external_datasource_status",this.idc);this.F&&this.getHandler().listen(this.F.La(),["mouseenter","focus"],this.KAc).listen(this.F,"action",this.d_b);this.getHandler().listen(this.C?this.C.La():this.J?this.J.getElement():this.F?this.F.La():this.Aa.La(),"keydown",this.D6b);y(A(),"fedsccm")||this.L.setVisible(!1);Os().C&&(b?(this.R.setVisible(!1),this.H.setVisible(!1),this.Va.setVisible(!1)):(this.jb.setVisible(!1),this.ib.setVisible(!1),this.H.setVisible(!1)));this.refresh()};
p.D6b=function(a){9===a.keyCode&&(a.preventDefault(),this.dispatchEvent(new Lnh))};p.setVisible=function(a){P(this.La(),a);if(this.J&&a){var b="",c=OM(this.Pa);c&&c.Hd()&&(b=c.Hd());dnh(this.J,b)}this.C&&!a&&(b=this.C.C.C,b.setVisible(!1),b.cd());!this.xa||this.xa.isDismissed()||a||this.xa.iy();!this.Ea||this.Ea.isDismissed()||a||this.Ea.iy()};p.isVisible=function(){return $q(this.La())};
p.refresh=function(){Rnh(this,OM(this.Pa).Td());var a=this.Da("waffle-dbsource-configbar-header-subtitle"),b=Snh(this),c=this.qa();b?c.Ce(a,b+" Rows"):c.Ce(a,"");a=!(this.D.rf()||this.D.D.Pg());Tnh(this,a,J1e(this.Ma,Qnh(this)),this.D.Qd());this.$a&&this.$a.refresh();this.L.ld(!1);Unh(this);this.J&&dnh(this.J,Qnh(this));this.Ya&&(qn(this.Ya),this.Ya=null)};function Onh(a,b,c){c=new dP(c,a.qa());c.Ob(b);a.Ha(c);return c}p.UYb=function(){N2b(this.Ma);HG(null,void 0,Qnh(this));this.ea.C(36528,j3())};
p.Aac=function(){N2b(this.Ma);var a=void 0===a?gh(oMb):a;a=new pMb(a);var b=Qnh(this);a=yh(a,1,b).build();a=AMb(K5e().toBuilder(),a);a=vh(a,17,!1).build();a=L5e(a);a=new gaf(null,mOb(a),void 0);xRb(a);this.ea.C(36527,j3())};function Pnh(a,b){N2b(a.Ma);GRb(Qnh(a));a.ea.C(36529,j3(b))}p.J0b=function(){var a=this.ma.Bb();if(a&&0==a.kc()){a=this.ma.Bb();var b=vye(new uye(this.D.Qa,a,this.Qc,this.D.D.Ne()),void 0,!0);b=ha(b);for(var c=b.next();!c.done;c=b.next())a.eI(c.value)}N2b(this.Ma)};
p.zYb=function(){this.ea.C(36748,j3())};p.Xbc=function(){this.ea.C(36749,j3())};p.d_b=function(){Xhb.kb(this.F,Vnh(this))};p.o9b=function(a){if(!this.O.isContentEditable&&!jJ(this.D)){this.O.contentEditable=!0;if("focus"===a.type){a=window.getSelection();var b=document.createRange();b.selectNodeContents(this.O);a.removeAllRanges();a.addRange(b)}this.getHandler().listen(this.O,"keydown",this.xib).listen(this.O,"blur",this.Aec)}};
p.xib=function(a){switch(a.keyCode){case 13:this.O.blur();break;case 27:Wnh(this,!0)}};p.Aec=function(){var a=this;this.ub||(window.getSelection().removeAllRanges(),this.Ya=pn(function(){a.dispatchEvent(new Mnh(OM(a.Pa).gb(),Bm(a.O)));Wnh(a,!1)}))};function Wnh(a,b){a.O.contentEditable=!1;Hl(a.O,"keydown");Hl(a.O,"blur");b&&Rnh(a,OM(a.Pa).Td())}p.g_b=function(){var a=this,b=this.L.Bb();Cnh(b,!0);var c=Qnh(this);VH(this.Ma,c).then(function(d){Unh(a);0<d.length?b.cI(d,c):(a.L.ld(!1),a.refresh())})};
p.yib=function(a){Rnh(this,a.Bm)};p.idc=function(){null!=SNb(this.D.C)&&this.refresh()};function Rnh(a,b){var c=a.Da("waffle-dbsource-configbar-header-title");a.qa().Ce(c,b)}p.KAc=function(){rye(this.Ra);sgb.kb(this.Ra,Vnh(this))};
function Tnh(a,b,c,d){var e=b&&!d,f=null==Xnh(c);a.bd.forEach(function(h,k){var l=!a.Lc.has(k),n=!a.zc.has(k)||a.zc.get(k).isEnabled();k==a.R?k.Oa(b&&l&&n):k!=a.H&&(l=e&&f&&l&&n,k.Oa(l),k==a.Qa&&a.C&&a.C.D.Oa(l));l=Xnh(c);n=Snh(a);var q;k.isEnabled()&&k==a.Qa?q=y(A(),"femdrr")?"Insert an extract of up to 50k rows":"Insert an extract of up to 25k rows":k.isEnabled()&&k==a.Aa?q="Add a calculated column":k.isEnabled()&&k==a.R?q="Refresh options for all connections and associated objects":k.isEnabled()&&
k==a.H?q="Update connection settings":q=k.isEnabled()&&n&&h?"Insert "+(h+(" based on "+(n+" rows"))):k.isEnabled()&&h?"Insert "+h:k.isEnabled()||null!=l?k.isEnabled()||37!=l?k.isEnabled()||null==l?"":"There was an error fetching the database schema.":"You don't have access to refresh or edit analysis with this connected data.":"You don't have permission to edit this sheet.";Ynh(k.La(),q);k==a.Qa&&a.C&&Ynh(a.C.D.La(),q)});a.J&&a.J.Oa(b&&f);a.F&&a.F.Oa(b&&f)}
function Ynh(a,b){Qt(a,b,void 0);b&&lS(a,"waffle-dbsource-configbar-db-object-creation-button-tooltip")}function Qnh(a){return OM(a.Pa).Hd()}function Unh(a){a=a.L.Bb();for(Cnh(a,!1);1<a.kc();)a.Hn(1,!0)}
function Znh(a){if(y(A(),"fedciv")&&y(A(),"fedcivp")&&a.isVisible()&&a.F&&a.F.isEnabled()&&!$nh(a)){var b=Au(a.D.F.C,"ritz-ap");if(!Ts(b).C.dbColumnStatsPromo){var c=a.F.La(),d=new mw("Discover data insights","Now you can quickly learn about data distribution, frequency, and more for any column",c,a.qa());a.oa(d);a.Ea=new Fnh(d,c,!1,a.qa(),a.D.O,a.Kb,a.La(),function(){yw(b,"dbColumnStatsPromo",!0)});a.oa(a.Ea);a.Ta.add(a.Ea);a.Ea.show();a.ea.C(116197,j3())}}}
function $nh(a){for(var b=ha(a.Ta),c=b.next();!c.done;c=b.next())c=c.value,c.isDismissed()&&a.Ta.delete(c);return 0<a.Ta.size||a.C&&a.C.C.C.isVisible()?!0:!1}function Snh(a){return(a=N().Gha()(Qnh(a)))?Smc.format(parseInt(a,10)):null}function Xnh(a){return a&&ih(a,1)&&!a.Bg()?a.getErrorCode():null}function Vnh(a){var b=rq(j3());return Eye(Dye(new yye(a.Eb,b)),0<Iye($G(a.Eb)).length).build().build()}function j3(a){a=void 0===a?109:a;var b=mj(new kj,!0);return qq(nq(new mq,a),b).build()}
function aoh(a,b,c,d,e,f,h,k,l,n,q){Il.call(this);this.D=a;this.F=b;this.xa=l;this.R=c;this.Ea=d;this.O=e;this.H=f;this.L=h;this.Aa=k;this.J=new Ml(this);this.oa(this.J);this.ma=n;this.ea=q;this.C=null;this.J.listen(this.D,["na","Fa"],this.G1a).listen(this.D,["oa","Ea"],this.lec).listen(this.F,["acl_change","offline_status","readonly_status"],this.nWb);this.G1a()}v(aoh,Il);p=aoh.prototype;
p.G1a=function(){var a=OM(this.D);if(a&&AC(a)&&(this.C?(this.C.refresh(),this.C.ub=!1):(this.C=new Nnh(this.D,this.F,this.R,this.Ea,this.Aa,this.xa,this.ma,this.H,this.ea,this.O),a=this.C.qa(),this.C.render(a.getElement("waffle-dbsource-configbar-id")),this.C.Ud(this),this.J.listen(this.C,"insert-formula-function",this.cfc).listen(this.C,"datasheet-rename",this.y0b).listen(this.C,"configbar-dom-focus-out",this.z_b)),this.C.setVisible(!0),rxe(),a=this.C,!$nh(a))){if(a.H&&a.H.isEnabled()&&y(A(),"fedda")&&
Ex.isEnabled()&&!a.xa&&!Os().C){var b=a.D.F.D["ritz-SessionCountBigsheetsDelegateAccessPromo"];var c=b.getValue();b.setValue(Math.min(c+1,2147483647));3>c||6==c+1?(b=a.H.La(),c=new mw("Delegate access","Allow collaborators of this spreadsheet to refresh and analyze this connected data using your credentials. Go to the connection settings to enable.",b,a.qa()),a.oa(c),a.xa=new Fnh(c,b,!1,a.qa(),a.D.O,a.Kb,a.La()),a.oa(a.xa),a.Ta.add(a.xa),a.xa.show(),a.ea.C(116174,j3()),b=!0):b=!1}else b=!1;!b&&a.C&&
null!==Snh(a)&&(b=a.D.F,3<=Hac(b).getValue()||(b=b.D["ritz-ViewCountDatasourceSheetPreviewBar"],c=b.getValue(),1>c&&(b.setValue(c+1),a=a.C.C.C,a.setVisible(!0),a.cd())))}};p.y0b=function(a){var b=this;a=new WEc(a.gh,a.name);TG(a,function(c){c||Wnh(b.C,!0)});this.L.C(a)};p.z_b=function(){WL(YG(this.H))};
p.cfc=function(a){var b=this,c=OM(this.D),d=c.Hd();if(d){var e=c.Td(),f=a.uha;$2e(this.O,function(h,k){var l=N().Eha()(e,null);Vm([VH(b.F.ea,d),rn(1E3)]).then(function(){return boh(b,f,l,k)})},"Insert Formula");this.R.C(36535,j3())}};function boh(a,b,c,d){if(d)a.F.C.Rz(d.ai,function(){var f=QF(a.F.C),h=new Nl(d.C,d.Dj);tG(f,h);coh(a,b,c,h)});else{var e=new Ooe(JF(a.F.C)+1);TG(e,function(f){f&&coh(a,b,c,new Nl)});a.L.C(e)}}
function coh(a,b,c,d){FF($G(a.H).C,IC(d)).addCallback(function(){pre(YG(a.H),b,c)})}p.lec=function(){this.C&&(this.C.setVisible(!1),this.C.ub=!0)};p.nWb=function(){var a=OM(this.D);a&&AC(a)&&this.C&&this.C.refresh()};p.Na=function(){Il.prototype.Na.call(this);Wf(this.C)};
function doh(){var a='<div class="'+U("waffle-create-datasheet-welcome-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_welcome.png" class="'+U("waffle-create-datasheet-welcome-dialog-image")+'" alt=""><h3 class="'+U("waffle-create-datasheet-welcome-dialog-welcome-message")+'"><span>';a=a+'Connect and analyze big data in Sheets</span></h3><div class="'+(U("waffle-create-datasheet-welcome-dialog-welcome-description")+'">');a=a+"Connect to BigQuery, Google's cloud data warehouse, to analyze and share billions of rows of data with your colleagues - all within Sheets</div><div class=\""+
(U("waffle-create-datasheet-welcome-dialog-button-wrapper")+'"></div></div>');return T(a)}function eoh(a){hW.call(this,"waffle-create-datasheet-welcome-dialog",a);this.D=new dP("Learn the basics",this.qa());this.Ha(this.D);this.C=new uw("Get connected",this.qa());this.Ha(this.C)}v(eoh,hW);p=eoh.prototype;
p.Ca=function(){hW.prototype.Ca.call(this);vr(this.zb(),doh);this.D.render(this.Da("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.D,"action",this.zib);this.C.render(this.Da("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.C,"action",this.vLa);Ur(this.Da("waffle-dataconnector-modal-title"));var a=this.Da("waffle-create-datasheet-welcome-dialog-welcome-message");a.id=kr(this,"waffle-create-datasheet-welcome-dialog-welcome-message");
Tr(a,"heading");Vr(this.La(),"labelledby",a.id);a=this.Da("waffle-create-datasheet-welcome-dialog-welcome-description");a.id=kr(this,"waffle-create-datasheet-welcome-dialog-welcome-description");Vr(this.La(),"describedby",a.id)};p.zib=function(){qr("https://connectedsheets.page.link/support")};p.vLa=function(){this.resolve(!0)};p.HAa=function(a){13==a.keyCode&&this.vLa()};p.D8=function(){Yfb.kb();this.reject()};p.RB=function(){Yfb.kb();this.reject()};
function foh(a){a=a.aAa;a='<div class="'+U("waffle-create-datasource-sheet-loading-dialog-section")+'"><img class="'+U("waffle-create-datasource-sheet-loading-dialog-image")+'" src="'+U(Kr(a))+'" alt=""><div class="'+U("waffle-create-datasource-sheet-loading-dialog-tip")+'">';return T(a+"Connecting data\u2026</div></div>")}function goh(a,b,c){$V.call(this,"waffle-create-datasource-sheet-loading-dialog",c);this.D=a;this.C=b}v(goh,$V);
goh.prototype.Ca=function(){$V.prototype.Ca.call(this);vr(this.zb(),foh,{aAa:this.D});Ur(this.Da("waffle-dataconnector-modal-title"));var a=this.Da("waffle-create-datasource-sheet-loading-dialog-tip");a.id=kr(this,"waffle-create-datasource-sheet-loading-dialog-tip");Tr(a,"heading");Vr(this.La(),"labelledby",a.id)};goh.prototype.Ja=function(){$V.prototype.Ja.call(this);this.C.C(36758,hoh())};goh.prototype.Na=function(){$V.prototype.Na.call(this);this.C.C(36759,hoh())};
function hoh(){var a=mj(new kj,!0);return qq(nq(new mq,75),a).build()}
function ioh(){var a='<div class="'+U("waffle-create-datasource-sheet-success-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_success_2.gif" class="'+U("waffle-create-datasource-sheet-success-dialog-image")+'" alt=""><h5 class="'+U("waffle-create-datasource-sheet-success-dialog-success-message")+'">';a=a+'Success! Your data is connected</h5><div class="'+(U("waffle-create-datasource-sheet-success-dialog-metadata-wrapper")+" "+U("waffle-create-datasource-sheet-success-dialog-datasource-info")+
'"></div><div class="'+U("waffle-create-datasource-sheet-success-dialog-success-description")+'">');a=a+'Create connected charts, pivot tables, and functions that work on the entire dataset, or extract a subset of the raw data directly into Sheets.</div><div class="'+(U("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper")+'"></div><div class="'+U("waffle-create-datasource-sheet-success-dialog-watch-tutorial")+" "+U("goog-link-button")+'"><span>');return T(a+"Watch video tutorial</span></div></div>")}
function joh(a,b){a=(new kv("{NUM_COLUMNS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_COLUMNS:a});return b?b+" rows \u2022 "+a:a}function koh(a,b,c){$V.call(this,"waffle-create-datasource-sheet-success-dialog",c);this.F=a;this.H=b;this.C=new uw("Get started",this.qa());this.Ha(this.C);this.D=new wt(void 0,bH.getInstance(),this.qa());this.Ha(this.D)}v(koh,$V);
koh.prototype.Ca=function(){var a=this;$V.prototype.Ca.call(this);vr(this.zb(),ioh);var b=this.Da("waffle-create-datasource-sheet-success-dialog-metadata-wrapper");this.qa().Ce(b,joh(this.F,this.H));this.C.render(this.Da("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper"));this.D.Wa(this.Da("waffle-create-datasource-sheet-success-dialog-watch-tutorial"));Ur(this.Da("waffle-dataconnector-modal-title"));b=this.Da("waffle-create-datasource-sheet-success-dialog-success-message");
b.id=kr(this,"waffle-create-datasource-sheet-success-dialog-success-message");Tr(b,"heading");Vr(this.La(),"labelledby",b.id);b=this.Da("waffle-create-datasource-sheet-success-dialog-success-description");b.id=kr(this,"waffle-create-datasource-sheet-success-dialog-success-description");Vr(this.La(),"describedby",b.id);this.getHandler().listen(this.C,"action",function(){return a.RB()}).listen(this.D,"action",function(){return dhb.kb()})};
function loh(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E){rhf.call(this,new yhf(n.getType(),l,"filter_db_sheet",E),a,b,c,d,e,f,h,k,l,z,E);this.H=dH(n);this.Zd=n;this.Pc=q;this.Kd=t;this.$d=u;this.zd=!ih(this.H,2)&&y6e(n)}v(loh,rhf);p=loh.prototype;p.Ca=function(){rhf.prototype.Ca.call(this);var a=FK(this.C,this.jh());Wlh(this.F.C,500<a.left?0:3)};
p.J1a=function(){var a=this.Sa().Ib(),b=N().Fha()(a,this.H.pb()),c=null,d=null;0<b.length&&(c=eh(pD,b[0]),d=tW(a));$gf(this.F,c,d,this.Kd,this.$d,this.Pc,this.H);a=this.Ma;b=this.Ra;c=this.Sa().Ib();c=N().aya()(c,this.H.pb());fs(a.La(),"waffle-datasourcesheet-sort-selected",0==c);fs(b.La(),"waffle-datasourcesheet-sort-selected",1==c);a.Oa(null!=c||!this.zd);b.Oa(null!=c||!this.zd);a=this.D;b=a.Bb().La();bs(b,"waffle-datasourcesheet-filterbox-container");WT(a);Wq(b,"");a.Il()};
p.t_a=function(a){if("filtering_cancelled"==a.type)this.Qa();else if("filtering_open_filter_by_value_sidebar"==a.type){a=this.Sa().Ib();a=N().Fha()(a,this.H.pb());var b=null;0<a.length&&(b=eh(pD,a[0]));a=b?vD(goe(yDb(),this.H),b).build():null;a=new xW(this.Pc,4,this.H,this.Zd.getType(),a,null,null,null,null);Chb.kb(a);this.Ia.C(116098,this.Eb);this.Qa()}else if(a=this.jh(),a=this.F.Bo(this.Sa().Ib(),a.y,a.x,!1,!1),!sgf(this.F.C)){b=this.Sa().Ib();var c=N().Fha()(b,this.H.pb());b=null;0<c.length&&
(b=eh(pD,c[0]));c=b&&0<jh(b,9);if(null!=a||c){var d=new vW("filterUpdate");d.C=a;c&&(d.F=b.nx(),d.Ra=sh(b,9,Hh).Gb())}else d=new vW("filterClear");d.R=this.H;this.dispatchEvent(d);this.Qa()}};p.bBa=function(a){var b=new vW("filterSort");b.R=this.H;b.Aa=a?1:0;this.dispatchEvent(b)};p.dCa=m(!1);
p.Dua=function(a){var b=this.C,c=b.getDepthAt("r",a.y),d=b.C,e=2*d.C,f=this.Sa().Xf(a.y,a.x).rl();c=-c-e;a="rtl"==(f.D||null)||"auto-rtl"==(f.D||null)?e:b.getDepthAt("c",a.x)-16*d.C-e;d=d.C;this.yz(new Nl(a/d,c/d))};function moh(a){C.call(this,a)}v(moh,C);moh.prototype.gb=function(){return this.message.gb()};moh.prototype.C=function(a){return this.message.C(a)};function noh(a){this.hb=ah(a,-1,0)}v(noh,dh);noh.prototype.toBuilder=function(){return new moh(this)};
noh.prototype.gb=function(){return nh(this,1)};noh.prototype.C=function(a){return th(this,3,a,pD)};function ooh(a,b,c,d,e,f){d=void 0===d?null:d;e=void 0===e?!1:e;f=void 0===f?!1:f;IG.call(this,147);this.L=a.Ib();this.J=b;this.D=c||[];this.C=d;this.O=e;this.R=f}v(ooh,IG);ooh.prototype.Nd=function(){var a=void 0===a?gh(noh):a;a=new moh(a);a=yh(a,1,this.L);a=Eh(a,7,this.J);this.O?vh(a,5,!0):Dh(a,3,this.D);this.R?vh(a,6,!0):null!=this.C&&Bh(a,4,this.C);return a.build()};
ooh.prototype.equals=function(a){return this.L==a.L&&this.J.equals(a.J)&&this.O==a.O&&this.R==a.R&&this.C==a.C&&Od(this.D,a.D,function(b,c){return b.equals(c)})};function poh(a,b,c,d,e,f,h){B.call(this);this.J=a;this.O=h;this.ma=b;this.D=c;this.ea=d;this.R=e;this.L=f;this.F=new Ml(this);this.oa(this.F);this.C=null;this.H=new mu(this);this.oa(this.H);this.F.listen(this.D,"filter-triggered",this.xLa);this.H.subscribe($x,"action",this.xLa);this.H.subscribe(Bhb,"action",this.Cib)}v(poh,B);p=poh.prototype;
p.xLa=function(){var a=OM(this.ma);if(a&&AC(a)){var b=YG(this.D),c=qoh(this),d=qG(c),e=oG(qoh(this));d=new Nl(d.x,e.y);e=aS(c,d.x);this.C&&(this.C.dispose(),this.C=null);this.C=new loh(c,this.R,b.R,b.C,b.F,new wJ(d),!1,!1,this.ea,e,a.Hd(),this.J.H,this.J.Pa,this.O);this.oa(this.C);OK(lDc(b),this.C);this.F.listen(this.C,"filterClear",this.Bib).listen(this.C,"filterSort",this.Dib).listen(this.C,"filterUpdate",this.Rdc);this.C.Dua(d);this.C.Uc();this.C.D.ld(!0);b=dH(e);a=N().aya()(a.gb(),b.pb());b=em("waffle-autofilter-sort waffle-datasourcesheet-sort-selected");
null!=a&&b&&(Yr(b,b.innerText+" selected"),fs(b,"hc-enabled-focus","black"==Tt()))}};p.Bib=function(a){a=new ooh(qoh(this),a.R,null,null,!0);roh(this,a)};p.Rdc=function(a){var b=qD();a.C&&tD(b,a.C);a.Ra&&0<a.Ra.length&&sD(Dh(b,9,a.Ra),a.F);a=new ooh(qoh(this),a.R,[b.build()],null);roh(this,a)};
p.Cib=function(a){if(4==a.C){var b=qD(),c=a.hda;Dh(b,9,c);sD(b,a.nx());c=0<c.length;var d=!1;if(a.FH){var e=a.FH.C();e.ox()&&(d=!0,tD(b,e.Bo()))}b=c||d?[b.build()]:null;a=new ooh(qoh(this),a.D,b,null,!b);roh(this,a)}};p.Dib=function(a){var b=qoh(this).Ib(),c=a.R;b=N().aya()(b,c.pb());var d=!1;switch(a.Aa){case 1:d=0==b;break;case 0:d=1==b}a=d?new ooh(qoh(this),c,null,null,void 0,!0):new ooh(qoh(this),c,null,1==a.Aa?0:1);roh(this,a)};function roh(a,b){a.L.C(b);R2e(lDc(YG(a.D)));Wf(a.C);a.C=null}
function qoh(a){return QF(a.J.C)}function soh(a,b,c,d,e,f,h){B.call(this);var k=this;this.L=new Ml(this);this.oa(this.L);this.J=a.L;this.F=b;this.C=c;this.ma=e;this.O=f;this.ea=new mu(this);this.oa(this.ea);this.xa=h;this.H=this.D=null;toh(this);uoh(this,d);this.R=new Kl;this.oa(this.R);this.R.wb(this.J.H,function(l){var n=voh(k);n&&(l.D||l.C.has(n))&&woh(k,n)});this.r$()}v(soh,B);function toh(a){var b=new wq(["waffle-dbsheet-or-dbobject-pill-active"]);a.O.C(Ugb,b)}
function uoh(a,b){var c=JD(a.F.Qa);a.L.listen(b,"P",a.mgc).listen(c,"gc",a.Gib).listen(c,["Qb","cc"],a.r$).listen(a.F,"na",a.r$).listen(a.C,"activeCellChange valueChange blurEmbeddedObject embeddedObjectMouseEnter embeddedObjectMouseLeave focusEmbeddedObject".split(" "),a.r$).listen(a.C,"inputBoxActivate",a.ska).listen(a.C,"mouseover",a.Fib).listen(a.C,"refresh-db-object-request",a.a1a).listen(a.F,"oa",a.Gwa).listen(a.C,"db-connection-settings",a.z_a);a.ea.subscribe(Ugb,"action",a.Eib)}p=soh.prototype;
p.Na=function(){this.Gwa();B.prototype.Na.call(this)};p.Gib=function(){var a=YG(this.C);a&&ZG(this.C)&&GCc(a)};p.Gwa=function(){Xf(xoh(this),yoh(this),this.D);this.H=this.D=null};p.mgc=function(){this.D&&Tlh(this.D)};
p.r$=function(){var a=YG(this.C),b=OM(this.F);if(a&&b){b=!!a.Va;var c=!!gDc(a);b||!c||a.Va||(a.Va=new Ulh(a.Sa(),a.R,a.C,a.F,new wJ(bDc(a),new Nl(0,0)),a.Aa,a.Ya,a.Eb,a.ob),$L(a.ea,"dbCellPill",a.Va),a.oa(a.Va),a.Va.setVisible(!0));b=a.Sa();a=gDc(a)||qG(b);(a=cG(WF(b,a),a,b.Ib()))&&(a.C||a.D)?this.ska():(a=voh(this),(a!=this.H||zoh(this,a))&&woh(this,a))}else this.Gwa()};
function zoh(a,b){if(!b||2!=N().qF()(b))return!1;var c=YG(a.C);if(!c)return!1;b=Z2e(c);c=X2e(c);if(b==c)return!1;a=xoh(a);return b&&null==c&&a&&a.isVisible()&&null!=a.C.Bb()&&a.C.Bb().isVisible()?!1:!0}function woh(a,b){if(b){a.ska();var c=Aoh(a);if(c){var d=tU(a.J,b);var e=OM(a.F).gb();var f=N().qF()(b),h=N().JN()(b),k=null;h&&(k=(h=N().Gha()(h))?parseInt(h,10):null);e=new Cmh(b,f,k,e);Zmc(c,d,e);4==e.C&&Tlh(c);Boh(a,b,c,d);a.H=b}}else a.ska()}
p.ska=function(){var a=xoh(this);a&&a.setVisible(!1);(a=yoh(this))&&a.setVisible(!1);this.H=null};p.Eib=function(){var a=Aoh(this);a&&(a.La().focus(),this.ma.Db(2))};p.a1a=function(){var a=voh(this);if(a)switch(N().qF()(a)){case 1:$fb.kb(a);break;case 5:bgb.kb(a);break;case 3:ggb.kb(a);break;case 2:agb.kb(a);break;case 4:Xgb.kb(a)}};p.z_a=function(){var a=voh(this);if(a){var b=N().JN()(a);b&&(a=N().nT()(b))&&QM(this.F,a,function(){Hx.kb(new nff(b,"show-current-source"))})}};
p.Fib=function(a){var b=OM(this.F),c=YG(this.C);c&&b&&3!=b.getSheetType()&&(a=a.Kj)&&Cbc(a)&&(this.r$(),GCc(c))};
function Aoh(a){var b=voh(a);if(!b)return null;var c=N().qF()(b);if(4==c)if(3!=OM(a.F).getSheetType())a=null;else{if(!a.D){c=YG(a.C);b=c.Xe();a.D=new Umc(a.xa,b,a.O.ud());a.L.listen(a.D,"refresh-db-object-request",a.a1a).listen(a.D,"db-connection-settings",a.z_a);c=new Sr(c.Ia.J,b?5:1);a.D.render();var d=a.D;d.ma=c;d.ea=b}a=a.D}else if(2==c)if(a=YG(a.C))a:if(c=a.J.C,Y2e(a)==b)b=S2e(a.J).Pd().getId(),a=tDc(a,b);else{for(d=c.length-1;0<=d;d--){var e=c[d];if(e&&N().yZ()(e)==b){a=tDc(a,e);break a}}a=
null}else a=null;else a=yoh(a);return a}function xoh(a){return(a=YG(a.C))?sDc(a):null}function yoh(a){a=YG(a.C);return a?(a=a.Va)?a.F:null:null}function voh(a){return(a=YG(a.C))?Vlh(a):null}function Boh(a,b,c,d){(Fx.isEnabled()||$mc(c))&&Coh(d.getType())&&(c.OP(),O1e(a.J,b,function(e){return c.Fm(e)},function(e){return c.Gz(e)}))}function Coh(a){return"no-results"==a||"fetch-successful"==a||"fetch-failed"==a}function Doh(a){C.call(this,a)}v(Doh,C);Doh.prototype.Hd=function(){return this.message.Hd()};
function Eoh(a){this.hb=ah(a,-1,0)}v(Eoh,dh);Eoh.prototype.toBuilder=function(){return new Doh(this)};Eoh.prototype.Hd=function(){return nh(this,1)};function Foh(a,b){IG.call(this,154);this.C=a;this.D=b}v(Foh,IG);Foh.prototype.Nd=function(){var a=void 0===a?gh(Eoh):a;a=new Doh(a);a=yh(a,1,this.C);return xh(a,2,this.D).build()};function Goh(a,b){iP.call(this,"",a,b);this.Jb(!0)}v(Goh,iP);Goh.prototype.Rg=function(){return Hoh(this)};
Goh.prototype.getContent=function(){var a=this.qa().Ca("SPAN",{"class":"waffle-filter-by-value-additional-values-item"});ym(a,Hoh(this));return[a]};function Hoh(a){return Smc.format(a.Sa())+" additional values in the full data set"}function Ioh(a,b){this.C=a;this.D=b}Ioh.prototype.getFormattedValue=g("C");Ioh.prototype.Mi=g("D");function Joh(a,b){p6e.call(this,"",a,b);this.Tm(!0);this.Jb(!0)}v(Joh,p6e);Joh.prototype.Rg=function(){return Koh(this)};
Joh.prototype.getContent=function(){var a=this.Sa(),b=[],c=this.qa().Ca("DIV",{"class":"goog-menuitem-checkbox"});b.push(c);c=this.qa().Ca("SPAN",{"class":"waffle-filter-by-value-item-freq"});if(a=a.Mi())a=1E3>a?Smc.format(a):Tmc.format(a),ym(c,a);b.push(c);c=this.qa().Ca("SPAN",{"class":"waffle-filterable-by-text-contains-menu-item-label"});ym(c,Koh(this));b.push(c);return b};function Koh(a){return N().WC()(a.Sa().getFormattedValue().pb())}
function Loh(a){a=a||{};var b='<div class="'+U("waffle-filter-by-value-sidebar-header-wrapper")+'"><div class="'+U("waffle-filter-by-value-sidebar-column-info")+'" id="'+U("waffle-filter-by-value-sidebar-column-info")+'"></div><div class="'+U("waffle-filter-by-value-search-container")+'">'+$v("docs-icon-img docs-icon-search-this-document")+h8e(void 0,"waffle-filter-by-value-search-input",void 0,void 0,void 0,void 0,void 0,void 0,void 0,Gr('tabindex="0" role="textbox"'))+'</div><div class="'+U("waffle-filter-by-value-menu-title")+
'"><div class="'+U("waffle-filter-by-value-menu-title-primary")+'" id="'+U("waffle-filter-by-value-menu-title-primary")+'">';b=b+'Most frequent values</div><div class="'+(U("waffle-filter-by-value-menu-title-secondary")+'" id="'+U("waffle-filter-by-value-menu-title-secondary")+'"></div></div><div class="'+U("waffle-filter-by-value-menu-top-buttons")+'"><div class="'+U("waffle-filter-by-value-menu-sort-buttons")+'"><div class="'+U("waffle-filter-by-value-sort-by-frequency-desc-button")+" "+U("goog-inline-block")+
'"></div><div class="'+U("waffle-filter-by-value-sort-by-frequency-asc-button")+" "+U("goog-inline-block")+'"></div><div class="'+U("waffle-filter-by-value-sort-by-value-asc-button")+" "+U("goog-inline-block")+'"></div><div class="'+U("waffle-filter-by-value-sort-by-value-desc-button")+" "+U("goog-inline-block")+'"></div></div><div class="'+U("waffle-filter-by-value-menu-checked-buttons")+'"><div class="'+U("waffle-filter-by-value-select-all-button")+" "+U("goog-inline-block")+'"></div><div class="'+
U("waffle-filter-by-value-clear-button")+" "+U("goog-inline-block")+'"></div></div></div></div>');var c='<div class="'+U("waffle-filter-by-value-sidebar-content-container")+'"><div class="'+U("waffle-filter-by-value-sidebar-content-loading")+'"></div><div class="'+U("waffle-filter-by-value-sidebar-content-unavailable")+'">';var d='<div class="'+U("waffle-filter-by-value-content-unavailable-alert-icon")+'">'+Chf()+'</div><div class="'+U("waffle-filter-by-value-content-unavailable-alert-message")+'">';
d=d+'Values unavailable</div><div class="'+(U("waffle-filter-by-value-content-unavailable-refresh-message")+'">');d=d+'Values could not be retrieved at this time. Try again by refreshing.</div><div class="'+(U("waffle-filter-by-value-content-unavailable-refresh-button-wrapper")+'"></div>');d=T(d);c=c+d+'</div><div class="'+U("waffle-filter-by-value-sidebar-content-loaded")+'"><div class="'+U("waffle-filter-by-value-menu")+'" aria-labelledby="waffle-filter-by-value-sidebar-column-info waffle-filter-by-value-menu-title-primary waffle-filter-by-value-menu-title-secondary" tabindex="0" role="menu"></div><h2 class="'+
U("waffle-filter-by-value-additional-values-menu-title")+'"><span tabindex="0">';c=c+'Values beyond top 500</span></h2><div class="'+(U("waffle-filter-by-value-additional-values-menu")+'"></div></div></div>');a=""+YV(Br({Es:"waffle-filter-by-value-sidebar",title:"Filter by value",Ez:Fr(""+$v("docs-icon-img docs-icon-filter-control")),IJ:Fr(b),hq:Fr(c),pF:Fr('<div class="'+U("waffle-filter-by-value-sidebar-footer-wrapper")+'"><div class="'+U("waffle-filter-by-value-empty-values-wrapper")+'"><div class="'+
U("waffle-filter-by-value-empty-values-menu")+'"></div></div><div class="'+U("waffle-filter-by-value-last-updated-time")+'" tabindex="0"></div><div class="'+U("waffle-filter-by-value-sidebar-footer-button-bar")+'"><div class="'+U("waffle-filter-by-value-cancel-button-wrapper")+'"></div><div class="'+U("waffle-filter-by-value-ok-button-wrapper")+'"></div></div></div>')},a));return T(a)}
function Moh(){return T('<div class="'+U("waffle-filter-by-value-sidebar-header")+'"><div class="'+U("waffle-filter-by-value-sidebar-header-icon")+'"></div><div class="'+U("waffle-filter-by-value-sidebar-header-column-name")+'"></div></div>')}function Noh(a){S.call(this,a)}v(Noh,S);Noh.prototype.Ca=function(){this.mb(xr(Moh))};function Ooh(a,b){iP.call(this,"",a,b);this.Jb(!0)}v(Ooh,iP);Ooh.prototype.Rg=function(){return Poh(this)};
Ooh.prototype.getContent=function(){var a=this.qa().Ca("SPAN",{"class":"waffle-filter-by-value-empty-values-item"});ym(a,Poh(this));return[a]};function Poh(a){return Smc.format(a.Sa())+" empty values in the full data set"}
function Qoh(a,b){BV.call(this,b);this.C=a;this.Pa=new Noh;this.oa(this.Pa);this.rb=new wv("Search from list of most frequent values");this.jb=null;this.oa(this.jb);this.$c=new Ft;this.Ha(this.$c);this.D=new Ft;this.Ha(this.D);this.F=new Ft;this.Ha(this.F);this.L=new ZK(xr(Zv,{icon:"docs-icon-img docs-icon-trending-up-18"}),this.qa());this.Ha(this.L);this.O=new ZK(xr(Zv,{icon:"docs-icon-img docs-icon-trending-down-18"}),this.qa());this.Ha(this.O);this.R=new ZK(xr(Zv,{icon:"docs-icon-img docs-icon-sort_az"}),
this.qa());this.Ha(this.R);this.ea=new ZK(xr(Zv,{icon:"docs-icon-img docs-icon-sort_za"}),this.qa());this.Ha(this.ea);this.Ra=new wt("Select all",bH.getInstance(),this.qa());this.Ha(this.Ra);this.Ea=new wt("Clear all",bH.getInstance(),this.qa());this.Ha(this.Ea);this.ma=new uw("OK",this.qa());this.ma.Ob("waffle-filter-by-value-ok-button");this.Ha(this.ma);this.Aa=new dP("Cancel",this.qa());this.Aa.Ob("waffle-filter-by-value-cancel-button");this.Ha(this.Aa);this.Ta=this.$a=this.Ya=this.Ma=this.Ia=
this.J=this.ub=null;this.Cb=new Amc;this.ib=new Ahf;this.Ha(this.ib);this.xb=!1;this.xa=new uw("Refresh",this.qa());this.Ha(this.xa)}v(Qoh,BV);p=Qoh.prototype;p.Ca=function(){this.mb(xr(Loh,{id:this.getId()}))};
p.Ja=function(){BV.prototype.Ja.call(this);this.Pa.render(em("waffle-filter-by-value-sidebar-column-info"));var a=this.qa().Da("waffle-filter-by-value-search-input");this.rb.Wa(a);this.jb=new Tv(a);this.$c.render(this.bb("waffle-filter-by-value-menu"));bs(this.$c.La(),"docs-material");this.D.render(this.bb("waffle-filter-by-value-additional-values-menu"));bs(this.D.La(),"docs-material");this.F.render(this.bb("waffle-filter-by-value-empty-values-menu"));bs(this.F.La(),"docs-material");this.L.render(this.bb("waffle-filter-by-value-sort-by-frequency-desc-button"));
this.O.render(this.bb("waffle-filter-by-value-sort-by-frequency-asc-button"));this.R.render(this.bb("waffle-filter-by-value-sort-by-value-asc-button"));this.ea.render(this.bb("waffle-filter-by-value-sort-by-value-desc-button"));Qt(this.L.La(),"Sort by most frequent values",void 0);Qt(this.O.La(),"Sort by least frequent values",void 0);Qt(this.R.La(),"Sort by ascending values",void 0);Qt(this.ea.La(),"Sort by descending values",void 0);this.Ra.render(this.bb("waffle-filter-by-value-select-all-button"));
this.Ea.render(this.bb("waffle-filter-by-value-clear-button"));Qt(this.Ra.La(),"Select all items below",void 0);Qt(this.Ea.La(),"Unselect all items below",void 0);this.ma.render(this.Da("waffle-filter-by-value-ok-button-wrapper"));this.Aa.render(this.Da("waffle-filter-by-value-cancel-button-wrapper"));this.ib.render(this.Da("waffle-filter-by-value-sidebar-content-loading"));this.xa.render(this.bb("waffle-filter-by-value-content-unavailable-refresh-button-wrapper"));a=this.Da("waffle-sidebar-title-close");
Ut(a,"waffle-filter-by-value");this.getHandler().listen(this.ma,"action",this.Kib).listen(this.Aa,"action",this.Hib).listen(this.Ra,"action",this.Mib).listen(this.Ea,"action",this.Iib).listen(this.R,"action",this.Jfc).listen(this.ea,"action",this.Kfc).listen(this.L,"action",this.Ifc).listen(this.O,"action",this.Hfc).listen(this.xa,"action",this.Lib).listen(this.jb,"input",this.Jib)};p.Jib=function(){var a=this.rb.getValue();Roh(this,a);a&&!this.xb&&(this.C.C(116107),this.xb=!0)};
function Roh(a,b){a.$c.ue(function(c){c.C5(b)})}p.refresh=function(a){var b=a.D,c=a.Hd(),d=UF(b,c);this.ub=c;c=this.Pa;var e=c.Da("waffle-filter-by-value-sidebar-header-column-name");c.qa().Ce(e,d);Yr(e,d);this.Ia=c=a.getColumnType();d=this.Pa.Da("waffle-filter-by-value-sidebar-header-icon");$r(d,"waffle-filter-by-value-sidebar-header-icon");(c=VU(c))&&bs(d,c);this.Ma=a.C;this.Ya=b;this.J=a.FH;this.$a=a.F;this.Ta=a.wLa;this.focus()};
function Soh(a,b){Toh(a,"loading");b.addCallback(function(c){if(c){a.$c.qd(!0);a.D.qd(!0);a.F.qd(!0);var d=sh(c,18,QT).Gb(),e=qh(c,10),f=a.Da("waffle-filter-by-value-menu-title-secondary"),h=500<e?"showing up to 500":"showing "+(e+" total");ym(f,"("+h+")");Yr(f,h);c=qh(c,11);e=(f=500<e)?e-500:null;for(h=0;h<d.length;h++){var k=d[h],l=k.getFormattedValue(),n=l.getValue();0==n.rs()||2==n.rs()&&""==n.getStringValue()||(k=new Joh(new Ioh(l,k.Ld()),a.qa()),a.$c.Ha(k,!0),k.Ob("apps-menuitem"),zm(k.getElement(),
!0),Uoh(a,k),k=k.Da("waffle-filter-by-value-item-freq"),Qt(k,"Number of instances of this value in the column",void 0))}d=null;a.J&&ih(a.J,2)&&0<jh(a.J.C(),9)&&(d=a.J.C());null!=d?Voh(a,d,f,e,c):Woh(a,f,!0,e,!0,c);Xoh(a,a.Hxa,!0);Yoh(a.L);Toh(a,"loaded");a.focus()}})}
function Voh(a,b,c,d,e){var f=b.nx(),h=sh(b,9,Hh).Gb(),k=[];a.$c.ue(function(u){var z=u.Sa().getFormattedValue().getValue();k.push(z);z=Zoh(h,z);f&&(z=!z);u.Jb(z)});for(var l=b=!1,n=0;n<h.length;n++){var q=h[n],t=0==q.rs();t&&(b=!0);t||Zoh(k,q)||(c=!0,l=N().EMb()(a.Ia),l=eh(Ih,l),q=iYe(Rpa().setValue(q),l).build(),q=new Joh(new Ioh(q,null),a.qa()),q.Jb(!f),a.D.Ha(q,!0),q.Ob("apps-menuitem"),Uoh(a,q),zm(q.getElement(),!0),l=!0)}Woh(a,c,f,d,f&&!b||!f&&b,e);l&&a.C.C(116087)}
function Zoh(a,b){for(var c=0;c<a.length;c++)if(b.equals(a[c]))return!0;return!1}function Woh(a,b,c,d,e,f){d&&(d=new Goh(d,a.qa()),d.Jb(c),a.D.Ha(d,!0),d.Ob("apps-menuitem"),Uoh(a,d),zm(d.getElement(),!0));a.D.setVisible(b);b&&a.C.C(116088);(c=a.bb("waffle-filter-by-value-additional-values-menu-title"))&&P(c,b);if(b=0<f)f=new Ooh(f,a.qa()),f.Jb(e),a.F.Ha(f,!0),f.Ob("apps-menuitem"),Uoh(a,f),zm(f.getElement(),!0);a=a.Da("waffle-filter-by-value-empty-values-wrapper");P(a,b)}
function Toh(a,b){a.rb.reset();var c=a.Da("waffle-filter-by-value-sidebar-header-wrapper");P(c,"loaded"==b);c=a.Da("waffle-filter-by-value-sidebar-content-loaded");P(c,"loaded"==b);c=a.Da("waffle-filter-by-value-sidebar-footer-wrapper");P(c,"loaded"==b);c=a.Da("waffle-filter-by-value-sidebar-content-unavailable");P(c,"unavailable"==b);Bhf(a.ib,"loading"==b)}function $oh(a){Toh(a,"unavailable");Qt(a.xa.La(),"Estimating\u2026",void 0)}p.Fm=function(a){a=a?Uxe(a):"";Qt(this.xa.La(),a,void 0)};
p.Z8a=function(a){var b=this.Da("waffle-filter-by-value-last-updated-time");a="Updated: "+this.Cb.format(a);ym(b,a);Qt(b,"Last time the values were retrieved",void 0);Yr(b,a+" Last time the values were retrieved");jS(b,2,2);kS(b,18)};
p.Kib=function(){var a=aph(this),b=[];this.$c.ue(function(e){a^e.isChecked()&&b.push(e.Sa().getFormattedValue().getValue())});this.D.ue(function(e){a^e.isChecked()&&(e instanceof Goh||b.push(e.Sa().getFormattedValue().getValue()))});if(1==this.F.kc()){var c=this.F.Bc(0),d=Gpa(0).build();a^c.isChecked()&&(b.push(d),this.C.C(116094))}Bhb.kb(new xW(null,this.Ma,this.Ya,this.Ia,this.J,this.$a,this.Ta,a,b));bph(this)};
function aph(a){var b=!0,c=!0;if(a.D.isVisible()&&0<a.D.kc()){var d=a.D.Bc(a.D.kc()-1);d instanceof Goh&&(c=!1,b=d.isChecked(),a.C.C(b?116108:116109))}c&&cph(a.$c)<a.$c.kc()/2&&(b=!1);return b}function Uoh(a,b){a.getHandler().listen(b,"action",a.nDa).listen(b.La(),"keydown",function(c){32!=c.keyCode&&13!=c.keyCode||b.Jb(!b.isChecked())})}p.nDa=function(){var a=0<cph(this.$c)+cph(this.D)+cph(this.F);this.ma.Oa(a)};function cph(a){var b=0;a.ue(function(c){c.isChecked()&&b++});return b}
function bph(a){var b=null;switch(a.Ma){case 2:b=116090;break;case 1:b=116093;break;case 4:b=116091;break;case 5:b=116092}a.C.C(b)}p.Hib=function(){this.C.C(116089);this.dispatchEvent("close-sidebar")};p.Mib=function(){this.C.C(116102);dph(this,!0);this.nDa()};p.Iib=function(){this.C.C(116101);dph(this,!1);this.nDa()};p.Lib=function(){Chb.kb(new xW(this.ub,this.Ma,this.Ya,this.Ia,this.J,this.$a,this.Ta,null,null));this.C.C(116147)};
function dph(a,b){a.$c.ue(function(c){c.isVisible()&&c.Jb(b)});a.D.ue(function(c){c.isVisible()&&c.Jb(b)});a.F.ue(function(c){c.isVisible()&&c.Jb(b)})}p.Jfc=function(){this.C.C(116105);Xoh(this,this.kbb,!1);Yoh(this.R)};p.Kfc=function(){this.C.C(116106);Xoh(this,this.kbb,!0);Yoh(this.ea)};p.Ifc=function(){this.C.C(116104);Xoh(this,this.Hxa,!0);Yoh(this.L)};p.Hfc=function(){this.C.C(116103);Xoh(this,this.Hxa,!1);Yoh(this.O)};
p.kbb=function(a,b){var c=a.Sa().getFormattedValue().getValue(),d=b.Sa().getFormattedValue().getValue();c.rs();d.rs();return 3==c.rs()?c.Rv()-d.Rv():Wd(Koh(a),Koh(b))};p.Hxa=function(a,b){return a.Sa().Mi()-b.Sa().Mi()};
function Xoh(a,b,c){ds(a.L.La(),"waffle-filter-by-value-active-sort-button");ds(a.O.La(),"waffle-filter-by-value-active-sort-button");ds(a.R.La(),"waffle-filter-by-value-active-sort-button");ds(a.ea.La(),"waffle-filter-by-value-active-sort-button");var d=eph(a);a.$c.qd();Md(d,b);if(c)for(b=d.length-1;0<=b;b--)a.$c.Ha(d[b],!1);else for(b=0;b<d.length;b++)a.$c.Ha(d[b],!1)}function Yoh(a){bs(a.La(),"waffle-filter-by-value-active-sort-button")}
function eph(a){var b=[];a.$c.ue(function(c){b.push(c)});return b}function fph(a,b,c,d){yU.call(this,a,d);var e=this;this.C=b;this.F=c;Qp(this.J,Chb,function(f){return gph(e,f.data)});Qp(this.J,Bhb,function(){return e.ct()});this.D.listen(this.C.C,"na",this.Oib).listen(this.F,"selectionChange",this.Nib)}v(fph,yU);p=fph.prototype;p.Af=function(){return zhb};p.wm=function(){return Ahb};p.Oib=function(){this.ct()};p.Nib=function(){this.ct()};p.ct=function(){this.Pb.Oa(!1);yU.prototype.ct.call(this)};
function gph(a,b){a.Pb.refresh(b);a.sp(!0);var c=ek();Soh(a.Pb,c);var d=b.Hd(),e=b.D;M1e(a.C.Pa,d,e).then(function(f){c.callback(f.C);a.Pb.Z8a(f.D)},function(){c.callback(null);a.Pb&&($oh(a.Pb),$pe(a.C.Pa,d,e).then(function(f){a.Pb&&a.Pb.Fm(f)},function(){a.Pb&&a.Pb.Fm(null)}))})}function hph(a,b){this.D=a;this.C=b}function iph(a){this.D=a;this.C={}}
function jph(a,b){if(b){var c=y(A(),"feds")?N().bya()(b):[],d=new Set(c),e=(new Date).getTime();b.forEach(function(f){if(a.C[f]){var h=S2b(f),k=h?h.getState():null;if(h&&k&&(2==k||3==k)){h=e-a.C[f].D;if(k=d.has(f)?xrd[k]:vrd[k]){h=ij(new hj,1E3*h);var l=a.C[f].C;var n=new tWd;l=K(n,2,l);if(n=N().zMb()(f))K(l,5,n.columns),K(l,4,n.rows);l=mj(tYe(l),!0);h=qq(pq(nq(new mq,41),h),l);a.D.C(k,h.build())}delete a.C[f]}}})}}function kph(a){C.call(this,a)}v(kph,C);kph.prototype.Hd=function(){return this.message.Hd()};
function lph(a){this.hb=ah(a,-1,0)}v(lph,dh);lph.prototype.toBuilder=function(){return new kph(this)};lph.prototype.Hd=function(){return nh(this,1)};function mph(a){C.call(this,a)}v(mph,C);mph.prototype.Hd=function(){return this.message.Hd()};function nph(a){this.hb=ah(a,-1,0)}v(nph,dh);nph.prototype.toBuilder=function(){return new mph(this)};nph.prototype.Hd=function(){return nh(this,1)};function oph(a,b){IG.call(this,139);this.C=a||"";this.D=b}v(oph,IG);
oph.prototype.Nd=function(){var a=void 0===a?gh(lph):a;a=new kph(a);a=yh(a,1,this.C);return Eh(a,2,this.D).build()};oph.prototype.Ry=function(){return hh(gh(nph))};
function pph(){var a='<div class="'+U("waffle-targeted-cs-promo-content")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/connectedSheetsPromoOnboardingImage.jpg" class="'+U("waffle-targeted-cs-promo-image")+'"><div class="'+U("waffle-targeted-cs-promo-text")+'"><div class="'+U("waffle-targeted-cs-promo-title")+'" id="'+U("waffle-targeted-cs-promo-title")+'">';a=a+'Analyze billions of rows of BigQuery data in Sheets</div><div class="'+(U("waffle-targeted-cs-promo-body")+'"><span id="'+U("waffle-targeted-cs-promo-body-text")+
'">');a=a+'Create charts, pivot tables and functions over the entire dataset, or extract a subset of the dataset directly into Google Sheets.</span> <span class="'+(U("waffle-targeted-cs-promo-link-button")+" "+U("goog-link-button")+'"><a href="https://cloud.google.com/blog/products/g-suite/connected-sheets-is-generally-available" target="_blank">');return T(a+"Learn more</a></span></div></div></div>")}
function qph(){return T(t6a({Tf:"docs-material waffle-targeted-cs-promo-close",hidden:!1,enabled:!0}))}function rph(a,b){yW.call(this,a,{Awa:!1,Bwa:!1,tBa:!1,Vo:!1},b);this.F.setContent("Try it now");this.setPosition(2,1);this.Ob("waffle-targeted-cs-promo-base");ut(this,!1);this.J=new wt(void 0,Yv.getInstance(),b);this.Ha(this.J)}v(rph,yW);p=rph.prototype;
p.Ca=function(){yW.prototype.Ca.call(this);var a=this.La(),b=xr(qph),c=Xr(b);Qt(b,c,void 0);om(a,b);this.J.Wa(b);b=xr(pph);this.setContent(b);Tr(a,"alertdialog");Vr(a,"labelledby","waffle-targeted-cs-promo-title");Vr(a,"describedby","waffle-targeted-cs-promo-body-text")};p.Ja=function(){var a=this;yW.prototype.Ja.call(this);fs(this.Da("docs-icon-close-white"),"waffle-targeted-cs-promo-hc","white"==Tt());this.getHandler().listen(this.J,"action",function(){return a.ida()})};
p.render=function(){yW.prototype.render.call(this);var a=this.Da("jfk-bubble-arrow-id");P(a,!1)};p.nAa=function(){this.setVisible(!1);Bob.kb();qr("https://docs.google.com/spreadsheets/create?fbpf=true")};p.ida=function(){this.setVisible(!1);Cob.kb()};
function sph(a,b,c,d){B.call(this);var e=this;this.C=a.F;this.H=b;this.L=c;this.eb=d;this.J=!1;this.D=-1;this.F=new Ml(this);this.oa(this.F);this.F.listen(EG,"trigger-targeted-bigsheets-promo",function(f){if(tph(e)&&1==e.D){var h=Slh(e.C);h.setValue(h.getValue()+1);e.J=!0;h=e.eb.getElement("waffle-assistant-entry-button-icon");h=new rph(h,e.eb);var k=new g8a(h,!0,!0,!0);e.L.Ah(k);h.render();h=new ZWd;K(h,4,f.trigger);f=new kj;Mi(f,43,h);e.H.C(116141,nq(qq(new mq,f),19).build())}})}v(sph,B);
function uph(a){(y(A(),"fedt")||y(A(),"fdsvo"))&&tph(a)?Xlh().then(function(b){a.D=qh(b,1);if(ih(b,2)){var c=qh(b,2);b=new ZWd;K(b,1,c);c=y(A(),"docs-idu");K(b,2,c);c=Slh(a.C).getValue();K(b,3,c);c=new kj;Mi(c,43,b);a.H.C(116155,nq(qq(new mq,c),19).build())}}):a.D=0}function tph(a){var b=a.C.F["ritz-HasCreatedDatasheet"].getValue(),c=Slh(a.C).getValue();return!b&&3>=c&&!a.J}
function vph(a){B.call(this);this.C=a.sb(2,rU);this.F=nh(a,1)||null;this.D=new Bef(500,500,"dbxScheduleOnCompleteAuth");this.oa(this.D)}v(vph,B);function wph(a,b,c){c=void 0===c?!0:c;lh(a.C,1);var d=fmh(hmh(),a.C);b&&yh(d,3,b);Blh(sH.getInstance(),d.build()).then(function(e){xph(a,e.getStatus(),nh(e,2),!0,c)},function(){return yph()})}
function zph(a,b,c){c=void 0===c?!0:c;var d=vmh(umh(xmh(),a.F),a.C);b&&yh(d,3,b);Clh(sH.getInstance(),d.build()).then(function(e){xph(a,e.getStatus(),nh(e,2),!1,c)},function(){return yph()})}
function xph(a,b,c,d,e){switch(b){case 2:if(!e){yph();break}Cef(a.D,c,function(f){d?wph(a,f,!1):zph(a,f,!1)});break;case 3:Lu.getInstance().postMessage(Nu("You do not have permission to delegate access for this BigQuery project. The delegated access settings were not saved. Contact your admin or check BigQuery project settings.","error",!0))}}function yph(){Lu.getInstance().postMessage(Nu("There was a problem saving the delegated access settings. Please check connection settings.","error",!0))}
function Aph(a){switch(a){case 1:return 3;case 2:return 2;case 3:return 4;case 4:return 1;case 5:return 5;case 6:return 6;case 0:return 0}}var Bph={ok:"OK",cancel:"Learn more"};
function Cph(a,b,c,d,e,f,h,k,l,n,q,t,u){vff.call(this,a,b,d,f,h,k,l);var z=this;this.Ea=Xl("docs-chrome")?new aoh(b,this.D,l,q,f,c,n,d,u,t,k.ud()):null;this.oa(this.Ea);this.$a=f;this.xa=new Ml(this);this.oa(this.xa);this.rb=new soh(a,b,c,d,e,k,l);this.oa(this.rb);this.O=n;this.Aa=a.D.C;this.Ta=new iph(l);this.Ya=t;this.Va=c;y(A(),"febsfbv")&&(d=new Qoh(l),d.render(),d.setVisible(!1),this.ub=new fph(d,a,c,e),this.oa(this.ub));this.jb=new poh(a,b,c,l,e,n,u);this.oa(this.jb);this.R=new Set;this.ea=
new Set;if(b=y(A(),"fetbp"))this.Pa=new sph(a,l,this.Ia,Tl()),this.oa(this.Pa),uph(this.Pa);this.Ra=!1;(l=rw.getInstance().C.newDatasourceIdFromOnboarding)?Dph(this,l):dlh()?Eph(this,new dW(null,eh(j7e,dlh())),!1):rw.getInstance().C.showBigSheetsOnboardingDialogOnStart&&Gx.isEnabled()?y(A(),"fdcws")?Fph(this):this.V9a():elh()&&Gx.isEnabled()&&b&&(y(A(),"fdcws")?Fph(this):this.Haa());this.xa.listen(this.D,"db-execution-status-updated",this.Qib).listen(this.D,"datasources-changed",this.MZb).listen(this.F,
"na",this.y7b).listen(this.F,"na",this.eab).listen(this.F,"na",this.x_b);this.Ma=new Kl;this.oa(this.Ma);this.Ma.wb(a.L.H,function(E){z.eab();Gph(z,E)})}v(Cph,vff);p=Cph.prototype;
p.LRa=function(a){a.C(Tgb,cP).D(Tgb,cP).C(Wgb,cP).C(Hx,Hqd).D(Hx,Hqd).C(Ex,cP).D(Ex,cP).C(Xgb,cP).C(ugb,Hqd).C(wkb,Hqd).C(Zgb,cP).C($gb,cP).C(ahb,cP).C(bhb,cP).C(Fx,cP).C(Ygb,cP).C(Cx,cP).C(Dx,cP).C(Qgb,cP).C(chb,cP).C(dhb,Iqd).D(dhb,Iqd).C(Rgb,Gqd).C(Sgb,cP).D(Sgb,cP);var b=y(A(),"feds");a.C($fb,b?Jqd:cP);a.C(bgb,b?Jqd:cP);a.C(agb,b?Jqd:cP);a.C(ggb,cP);a.C(Ax,b?Jqd:cP)};
p.H$a=function(){var a=this;this.ma.subscribe(Wgb,"action",this.Qa).subscribe(Tgb,"action",this.V_b).subscribe(Ex,"action",this.Khc).subscribe(Hx,"action",this.xxc).subscribe(Xgb,"action",function(b){return Hph(a,4,b)}).subscribe(agb,"action",function(b){return Iph(a,b)}).subscribe(bgb,"action",function(b){return Hph(a,5,b)}).subscribe($fb,"action",function(b){return Hph(a,1,b)}).subscribe(ggb,"action",function(b){return Hph(a,3,b)}).subscribe(ugb,"action",this.Xec).subscribe(Zgb,"action",this.Haa).subscribe($gb,
"action",this.Sec).subscribe(wkb,"action",this.ffc).subscribe(ahb,"action",this.W9a).subscribe(bhb,"action",this.qxc).subscribe(Ax,"action",function(b){Jph(a,b.C)}).subscribe(chb,"action",this.Lhc).subscribe(dhb,"action",this.Dic).subscribe(Cx,"action",function(){return Kph(a,null,!0)}).subscribe(Dx,"action",this.LJb).subscribe(Qgb,"action",this.zIb).subscribe(Rgb,"action",this.zBc).subscribe(Sgb,"action",this.Y_b)};p.Qib=function(a){a=a.D;jph(this.Ta,a);Lph(this,a)};
function Lph(a,b){b&&b.forEach(function(c){var d=S2b(c);2===(d?d.getState():null)&&4===N().qF()(c)&&(c=N().JN()(c))&&(d=a.D.ea,d.C.delete(c),VH(d,c))})}p.Khc=function(a){Mph(this,a.Hd(),a.C,a.D)};
p.xxc=function(a){var b=this,c=a.Hd(),d=a.C;if("pick-new source"==d||"change-cloud-project"==d)this.Haa(a);else{var e=eh(j7e,N().kWa()(c)),f=new fW(sH.getInstance());this.L.addCallback(function(h){if(y(A(),"fdcws")&&ih(e,3)&&ih(cV(e),4)){var k=h.ALb(c,e);b.oa(k);ZV(b.C,k)}else if(!Ex.isEnabled()&&ih(e,3)&&ih(cV(e),4))k=h.zLb(c,e),b.oa(k),ZV(b.C,k);else{var l=yff("Connecting to BigQuery\u2026");k=Tef(f);var n=Nph(c);Wm([k,n]).then(function(q){Mu(Lu.getInstance(),l);q=h.Exa(c,e,q[0],void 0,q[1]||void 0);
b.oa(q);ZV(b.C,q)},function(){Mu(Lu.getInstance(),l);b.E8();var q=h.Exa(c,e,[],!0);b.oa(q);ZV(b.C,q)})}})}};p.W9a=function(a){var b=this;this.L.addCallback(function(c){var d=a.F,e=d?d.C:null,f=d?d.Hd():null;d=d?d.D:null;if(f&&e){var h=ih(cV(e),4)?Emh(e):e;Nph(f,d).then(function(k){k=c.Exa(f,h,a.C,void 0,k||void 0);b.oa(k);ZV(b.C,k)})}else f?Nph(f,d).then(function(k){k=c.wVa(a,k||void 0);b.oa(k);ZV(b.C,k)}):(e=c.wVa(a),b.oa(e),ZV(b.C,e))})};
p.qxc=function(a){var b=this;this.L.addCallback(function(c){var d=yff("Connecting to BigQuery\u2026");Tef(new fW(sH.getInstance())).then(function(e){Mu(Lu.getInstance(),d);e=c.xVa(a,e);b.oa(e);ZV(b.C,e)},function(){Mu(Lu.getInstance(),d);b.E8();var e=c.xVa(a,[]);b.oa(e);ZV(b.C,e)})})};function Nph(a,b){b=void 0===b?null:b;if(!y(A(),"fedd"))return Tm(null);if(b)return Tm(tlh(omh(),b).build());a=lmh(nmh(),a).build();return Mlh(a).then(aa(),m(null))}p.V_b=function(a){Mph(this,null,a.C,a.D)};
function Mph(a,b,c,d){var e=null==b,f=new oph(b,c);e&&(a.H.C(ih(c,3)&&ih(cV(c),4)?116023:116024),c=a.D.F.F["ritz-HasCreatedDatasheet"],c.getValue()||c.setValue(!0),elh()&&a.H.C(116186));TG(f,function(h,k){if(h){h=k.Hd();Oph(a,h,d,e);k=N().vMb()(h);var l=N().pMb()(k,h);Pph(a,l,4,[k]);e?Dph(a,h):VH(a.D.ea,b)}});a.O.C(f);e||eef(a.C)}p.Lhc=function(a){Oph(this,a.Hd(),a.D,!1,a.C);eef(this.C)};
function Oph(a,b,c,d,e){e=void 0===e?null:e;y(A(),"fedda")&&d&&(c&&lh(c.sb(2,rU),1)?a.H.C(116204):a.H.C(116205));y(A(),"fedd")&&c&&(a.H.C(116192),nh(c,1)||lh(c.sb(2,rU),1))&&(d=l7e().rc(b),e?Eh(d,2,e):(b=eh(j7e,N().kWa()(b)),Eh(d,2,b)),b=m7e().Oa(lh(c.sb(2,rU),1)),d=Eh(b,2,d),d=f1e(d),nh(c,1)&&(c=nh(c,1),yh(d,1,c)),c=new vph(d.build()),a.oa(c),c.F?zph(c,null):wph(c,null))}
p.V9a=function(){var a=this,b=this.D.F.D["ritz-DisplayCountBigsheetsWelcomeDialog"],c=b.getValue();if(1<=c)this.Haa();else{b.setValue(Math.min(c+1,2147483647));var d=new eoh;this.oa(d);ZV(this.C,d);d.getResult().then(function(e){e?a.Haa():Wf(d)},function(){Wf(d)})}};function Dph(a,b){var c=rw.getInstance().C.transientErrorFromOnboarding;c?(Qph(a),pn(function(){eef(a.C);ugb.kb(new TH("",eh(Fh,c)))},3E3)):(a.R.add(b),Qph(a))}
function Qph(a){var b=new goh("//ssl.gstatic.com/docs/spreadsheets/bigsheets_loading_3.gif",a.H);a.oa(b);ZV(a.C,b)}function Kph(a,b,c){var d=OM(a.F);if(d&&AC(d)){var e=d.Hd();VH(a.D.ea,e).then(function(f){var h=new eWb(f,e),k=nq(new mq,103).build();f=new Wmh(e,b,f,h,a.D.Qa,c,a.O,a.Ya,a.Aa,a.H,k);a.oa(f);a.xa.listen(f,"update",a.AYb);ZV(a.C,f)})}}function Fph(a){var b=new Pmh;a.oa(b);ZV(a.C,b)}p.LJb=function(){var a=OM(this.F);a&&AC(a)&&(a=Rph(a),Kph(this,a[0],!0))};
p.zBc=function(){var a=OM(this.F);a&&AC(a)&&(a=Rph(a),Kph(this,a[0],!1))};p.zIb=function(){var a=this,b=OM(this.F);if(b&&AC(b)){var c=Rph(b),d=c.length;d=(new kv("{NUM_COLUMNS, plural,=1 {Are you sure you want to delete this calculated column?}other {Are you sure you want to delete {NUM_COLUMNS} calculated columns?}}")).format({NUM_COLUMNS:d});NM(this.$a,d,function(){return Sph(a,b.Hd(),c)})}};function Sph(a,b,c){b=new Foh(b,c);TG(b,function(d){a.H.C(d?36648:36649)});a.O.C(b)}
p.AYb=function(a){var b=OM(this.F);b&&AC(b)&&b.Hd()==a.hn&&a.C&&(a=b.Ac(),b=a.Yf(),HF(a,qNb(a,xG(a,b-1,b))))};function Rph(a){a=a.Ac();var b=mG(a);return pmc(a,b).map(function(c){return nh(c,2)})}p.MZb=function(){var a=this.D.L;a.O&&a.D.clearCache()};p.y7b=function(){Jlh(this.D.L,OM(this.F))};p.x_b=function(){if(this.Ea&&!def(this.C)){var a=this.Ea;a.C&&Znh(a.C)}};
p.eab=function(){var a=OM(this.F);if(a&&AC(a)){var b=a.Hd();if(this.R.has(b)){var c=N().lWa()(a.gb());if(c)if(c=tU(this.D.L,c),"fetch-successful"==c.getType()){a=a.Ac().Yf();var d=N().Gha()(b);c=null;null!==d&&(d=parseInt(d,10),0<d&&(c=Smc.format(d)));a=new koh(a,c);this.oa(a);ZV(this.C,a,!0);this.R.delete(b)}else"fetch-failed"==c.getType()&&(def(this.C)instanceof goh&&fef(this.C),this.R.delete(b))}}};
p.Haa=function(a){var b=this,c=void 0;a&&(c=new dW(a.Hd(),null));var d=new Hmh(new fW(sH.getInstance()),this.H,c);this.oa(d);ZV(this.C,d);elh()&&!this.Ra&&(Mmh(d),this.Ra=!0,this.H.C(116185));Bff(d.La());d.getResult().then(function(e){if(a&&"change-cloud-project"==a.C){var f=a.D;e=new Sef(f.C,f.H,"db-source-table"===e.D?e.J:null,e.D,e.F)}b.W9a(e)},function(e){e&&b.E8();Wf(d)})};p.Sec=function(a){Eph(this,a,!0)};function Eph(a,b,c){a.L.addCallback(function(d){d=d.yLb(b,c);a.oa(d);ZV(a.C,d)})}
p.E8=function(){this.H.C(36685);Aff("Could not connect to BigQuery")};function Hph(a,b,c){var d=a.D.L,e=tU(d,c).C;a.H.C(36985);null!=e&&ih(e,2)&&37==e.getErrorCode()?Llh(d,c,function(){Tph(a,b,[c])},function(f){f=f.C;null!=f&&ih(f,2)&&37==f.getErrorCode()?(a.H.C(36986),f=Bmh(b,f),Uph(a,f.body,f.title)):Tph(a,b,[c])}):Tph(a,b,[c])}
function Jph(a,b){if(0!==b.length){a.H.C(36985);var c=Vph(a,b);0<c.length?Klh(a.D.L,c,function(){Tph(a,null,b)},function(d){d=Wph(a,d);0<d.length?(a.H.C(36986),d="You do not have access to the following BigQuery connection(s): \n\n"+(d.join(", ")+" \n\n Contact the owner(s) of the BigQuery connections(s) or your admin to request access. \n\n"),d=bf(d),Uph(a,d,"Refresh failed")):Tph(a,null,b)}):Tph(a,null,b)}}
function Vph(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=tU(a.D.L,e).C;null!=f&&ih(f,2)&&37==f.getErrorCode()&&c.push(e)}return c}function Wph(a,b){var c=[];b.forEach(function(d){var e=d.mf();ih(d,1)&&ih(e,2)&&37==e.getErrorCode()&&(d=N().JN()(d.Rl()),d=N().nT()(d),d=EF(a.D.C,d).Td(),c.push(d))});Jd(c);return c}
function Tph(a,b,c){y(A(),"fedd")&&Glh(a.D.L,c);var d=y(A(),"feds")?N().bya()(c):[],e=qd(c,function(f){return!xd(d,f)});yd(d)||Xph(a,N().qMb()(d),b,d);yd(e)||Pph(a,N().oMb()(e),b,c);Yph(a,c)}
function Xph(a,b,c,d){a.H.C(116188);b=eh(smh,b);var e=(new Date).getTime();Flh(a.D.L,d);Plh(sH.getInstance(),b,a.Aa).then(function(f){var h=sh(f,1,nlh);Zph(a,h.Gb(),d,e,c);for(var k={},l=ha(h),n=l.next();!n.done;n=l.next())n=n.value,ih(n.mf(),2)||(k[n.Rl()]=n.Pf());ne(k)||(k=N().sMb()(k),k=eh(iPc,k),a.O.C(new kPc(k)));$ph(a,h.Gb());return f},function(f){f=f.zT(0).mf();i3b(a.D.L,new Set(d),f)})}
function Pph(a,b,c,d){b=eh(qmh,b);var e=(new Date).getTime();Flh(a.D.L,d);Qlh(sH.getInstance(),b,a.Aa).then(function(f){var h=sh(f,2,nlh).Gb();Zph(a,h,d,e,c);$ph(a,h);return f},function(f){f=f.zT(0).mf();i3b(a.D.L,new Set(d),f)})}function Zph(a,b,c,d,e){c=1==c.length?c[0]:null;!ih(b[0].mf(),2)&&c&&e&&(a.Ta.C[c]=new hph(d,Aph(e)))}function $ph(a,b){b=ha(b);for(var c=b.next();!c.done;c=b.next()){var d=c.value;c=d.mf();3===c.getState()&&(d=d.Rl(),i3b(a.D.L,new Set([d]),c))}}
function Yph(a,b){if(0!=b.length){var c=new kv("{numObjects, plural, =1 {Refreshing object} other {Refreshing # objects}}");GG(c.format({numObjects:b.length}));b.forEach(function(d){return a.ea.add(d)})}}function Gph(a,b){0!=a.ea.size&&(b.C.forEach(function(c){var d=tU(a.D.L,c);"loading"!=d.getType()&&"fetching-results"!=d.getType()&&a.ea.delete(c)}),0==a.ea.size&&"dbobjectmodel-event-update"==b.getType()&&GG("Refresh complete"))}
p.Xec=function(a){if(a){var b=N().Iha()(a.Rl())?N().qF()(a.Rl()):0;a=Bmh(b,a.C);Uph(this,a.body,a.title)}};p.ffc=function(){Akb.setVisible(!0)};function Uph(a,b,c){sRb(b,ca(),c,Bph,a.Rib,void 0,void 0,!1,"big-sheets-feedback")}p.Dic=function(){qr("https://connectedsheets.page.link/tutorial",{target:"_blank"})};p.Rib=function(){qr("https://connectedsheets.page.link/support")};p.Y_b=function(){var a=OM(this.F);a&&AC(a)&&(N2b(this.D.ea),GRb(a.Hd()))};
function Iph(a,b){var c=YG(a.Va),d=a.D.C.C,e=N().JN()(b),f=null;c?f=X2e(c)||Z2e(c):d&&1==d.getSheetType()&&(f=d.F);y(A(),"fedcsdl")&&f&&"no-results"==tU(a.D.L,b).getType()&&(c=bmh(amh(dmh(),f),e).build(),Nlh(c).then(function(h){var k=a.H,l=k.C,n=f;var q=new kKd;var t=qh(h,1);q=K(q,1,t);t=qh(h,2);q=K(q,2,t);t=qh(h,3);q=K(q,3,t);t=qh(h,4);q=K(q,4,t);t=qh(h,5);q=K(q,5,t);t=h.getStatus();q=K(q,6,t);t=aqh(h.Ge());q=K(q,7,t);t=h.getNumberOfColumns();q=K(q,8,t);t=h.getNumberOfRows();q=K(q,9,t);n=K(q,10,
parseInt(n,10));q=rh(h,10,0);n=K(n,11,q);q=qh(h,11);n=K(n,12,q);y(A(),"fesfcsdl")?(q=qh(h,12),n=K(n,13,q),q=qh(h,13),n=K(n,14,q),q=qh(h,14),n=K(n,15,q),q=qh(h,15),n=K(n,16,q),q=qh(h,16),n=K(n,17,q),q=rh(h,17,0),n=K(n,18,q),q=rh(h,18,0),n=K(n,19,q),h=qh(h,19),h=K(n,20,h)):h=n;n=new Wi;h=Mi(n,132,h);h=oq(nq(new mq,75),h).build();l.call(k,116028,h)},ca()));Hph(a,2,b)}
function aqh(a){switch(a){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5;case 5:return 6;case 6:return 7;case 7:return 8;case 8:return 9;case 9:return 10;case 10:return 14;case 11:return 6;case 12:return 17;case 13:return 15;case 14:return 11;case 15:return 18;case 16:return 12;case 17:return 20;case 18:return 21;case 19:return 22;case 20:return 23;case 21:return 25;case 22:return 26;default:return 0}}function bqh(){B.call(this)}v(bqh,Vn);bqh.prototype.C=function(){return Cph};Eo("dbsource",bqh);
