function Lih(a){C.call(this,a)}v(Lih,C);Lih.prototype.getStatus=function(){return this.message.getStatus()};function Mih(a){this.hb=ah(a,-1,0)}v(Mih,dh);Mih.prototype.toBuilder=function(){return new Lih(this)};Mih.prototype.getStatus=function(){return rh(this,1,0)};function Nih(a){C.call(this,a)}v(Nih,C);Nih.prototype.getStatus=function(){return this.message.getStatus()};function Oih(a){this.hb=ah(a,-1,0)}v(Oih,dh);Oih.prototype.toBuilder=function(){return new Nih(this)};
Oih.prototype.getStatus=function(){return rh(this,1,0)};function Pih(a,b){return new Sm(function(c,d){tH(a,"/dbx/createSchedule",[],b.pb(),function(e){c(eh(Mih,JSON.stringify(e.we())))},d)})}function Qih(a,b){return new Sm(function(c,d){tH(a,"/dbx/updateSchedule",[],b.pb(),function(e){c(eh(Oih,JSON.stringify(e.we())))},d)})}function Rih(a){if(!N().Iha()(a)||N().KMb()(a))return!1;a=N().qF()(a);return n3b.has(a)}
function Sih(a){var b=[];a=ha(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,Rih(c)&&b.push(c);return b}function Tih(a){if(a.L.rf())return[];var b=[];a.C.forEach(function(c,d){a3b.has(c.D)&&Rih(d)&&b.push(d)});return b}function Uih(a){a.yb()&&Fgf(a.F)}function Vih(){var a=void 0===a?gh(V0e):a;return new U0e(a)}function Wih(){var a=void 0===a?gh(X0e):a;return new W0e(a)}function Xih(a){C.call(this,a)}v(Xih,C);function Yih(a,b){return Eh(a,1,b)}function Zih(a){this.hb=ah(a,-1,0)}
v(Zih,dh);Zih.prototype.toBuilder=function(){return new Xih(this)};function $ih(){var a=void 0===a?gh(Zih):a;return new Xih(a)}function ajh(a){C.call(this,a)}v(ajh,C);function bjh(a,b){return yh(a,1,b)}function cjh(a,b){return Eh(a,2,b)}function djh(a){this.hb=ah(a,-1,0)}v(djh,dh);djh.prototype.toBuilder=function(){return new ajh(this)};function ejh(){var a=void 0===a?gh(djh):a;return new ajh(a)}
function f3(a,b,c,d){S.call(this,d);this.Ya=c;this.Va=a;this.state=3;this.C=null;this.Ra=this.ma=!1;this.$a=new mu(this);this.oa(this.$a);this.Ta=new Bef(500,500,"dbxScheduleOnCompleteAuth");this.oa(this.Ta);fjh(this)}v(f3,S);function fjh(a){a.$a.Ab(Lgb,zp,function(b){b=b.data;gjh(a,36713,b);hjh(a,b,null)}).Ab(Mgb,zp,function(b){b=b.data;gjh(a,36714,b);ijh(a,b,null)}).Ab(Ngb,zp,a.rb).Ab(Ogb,zp,a.jb).Ab(Fx,yp,a.refresh)}
function hjh(a,b,c,d){d=void 0===d?!0:d;var e=Yih($ih(),b);c&&yh(e,2,c);Pih(sH.getInstance(),e.build()).then(function(f){return jjh(a,b,f.getStatus(),nh(f,2),!0,d)},function(){a.rma()})}function ijh(a,b,c,d){d=void 0===d?!0:d;var e=cjh(bjh(ejh(),a.C.getId()),b);c&&yh(e,3,c);Qih(sH.getInstance(),e.build()).then(function(f){return jjh(a,b,f.getStatus(),nh(f,2),!1,d)},function(){a.rma()})}
f3.prototype.rb=function(){if(Fx.isEnabled()){var a=sU(this.C);gjh(this,36715,a);a=a.toBuilder().Oa(!0).build();ijh(this,a,null)}};f3.prototype.jb=function(){if(Fx.isEnabled()){var a=sU(this.C);gjh(this,36716,a);a=a.toBuilder().Oa(!1).build();ijh(this,a,null)}};function gjh(a,b,c){var d=new tWd;c=kjh(c.Mi());d=K(d,10,c);d=tYe(d);d=qq(nq(new mq,75),d).build();a.Ya.C(b,d)}function kjh(a){switch(a.Mi()){case 4:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 0:return 0}}
function ljh(a){a.state=3;a.refresh();P1e().then(function(b){a.isDisposed()||(b=sh(b,1,m1e).Gb(),0==b.length?(a.state=1,a.C=null):(a.state=4,a.C=b[0]),a.Ra?(a.Ra=!1,a.show()):a.refresh())},function(){Lu.getInstance().postMessage(Nu("Error loading schedule configuration.","error",!0))})}function mjh(a){return a.C&&lh(sU(a.C),1)?(ph(a.C.getStatus(),1),!0):!1}
function jjh(a,b,c,d,e,f){a.tGa(!0);switch(c){case 1:a.focus();ljh(a);EG.dispatchEvent("load-schedules-on-config-bar");break;case 2:if(!f)break;Cef(a.Ta,d,function(h){a.isDisposed()||(a.tGa(!1),e?hjh(a,b,h,!1):ijh(a,b,h,!1))});break;default:a.rma()}}f3.prototype.show=function(){3==this.state?this.Ra=!0:(this.Ya.C(116122),this.state=1==this.state?2:5,this.refresh())};function njh(a,b){yuf.call(this,a,b)}v(njh,yuf);njh.prototype.O=function(){this.refresh()};njh.prototype.refresh=function(){if(this.yb()){var a=Fx.isEnabled();a=this.J&&this.L&&a&&0<Tih(this.H).length;this.C.Oa(a)}};njh.prototype.R=m("Refresh all");function ojh(a){a=a||{};var b=Dr(void 0,null)?18:void 0;b='<svg xmlns="http://www.w3.org/2000/svg" width="'+U(b)+'px" height="'+U(b)+'px" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="'+U(Dr(void 0,null)?"#188038":void 0)+'" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>';
b=T(b);a=""+YV(Br({title:"Refresh options",Es:"waffle-dataconnector-refresh-sidebar",Ez:Fr(""+b),hq:Fr('<div class="'+U("waffle-dataconnector-refresh-sidebar-container")+'"><div class="'+U("waffle-dataconnector-refresh-sidebar-refresh-widget")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-sidebar-backdrop")+'"></div>'),sN:!0,pF:Fr('<div class="'+U("waffle-dataconnector-refresh-sidebar-footer-wrapper")+'"></div>')},a));return T(a)};function pjh(){}v(pjh,Jt);pjh.prototype.jc=m("docs-calendar-select");pjh.prototype.Qn=function(a){a=a.Ca("DIV",["docs-calendar-select-dropdown","docs-gm-arrow","goog-inline-block"],a.Ca("DIV",["docs-icon","goog-inline-block"],a.Ca("DIV",["docs-icon-img-container","docs-icon-img","docs-icon-arrow-dropdown"])));bs(a,"docs-material");return a};Ca(pjh);function qjh(){return T('<div><div class="'+U("waffle-dataconnector-refresh-date-input-date-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-date-input-date-picker")+'"></div>')};function rjh(a,b,c){void 0===b&&eP.getInstance();S.call(this,c);this.D=new ZK("",c);this.Ha(this.D);this.C=null;this.setDate(new Date)}v(rjh,S);p=rjh.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(xr(qjh))};p.Ja=function(){S.prototype.Ja.call(this);this.D.render(this.Da("waffle-dataconnector-refresh-date-input-date-select"));this.setDate(this.F);this.getHandler().listen(this.D,"action",this.Vqb)};p.getDate=g("F");
p.Vqb=function(){var a=this;null==this.C?sjh(this,function(){return tjh(a)}):tjh(this)};function tjh(a){a.C.position(a.La());a.C.Da("goog-date-picker").focus();null!=a.D.getValue()&&a.C.ywc(a.getDate())}function sjh(a,b){Co("datepicker",function(){var c=Fo("datepicker");a.C=c.C(a.qa());a.Ha(a.C);a.C.render(a.Da("waffle-dataconnector-refresh-date-input-date-picker"));a.C.Qnb();a.getHandler().listen(a.C,"change",a.z0b);b()})}p.z0b=function(a){this.setDate(new Date(a.C.getTime()));this.C.hide();this.D.La().focus()};
p.setDate=function(a){this.F=new Date(a);this.F.setMinutes(0);this.F.setSeconds(0);this.F.setMilliseconds(0);var b=this.D,c=b.setValue;a=(new Ow(Qw.MONTH_DAY_YEAR_MEDIUM)).format(a);c.call(b,a);this.yb()&&(ym(this.D.La(),""+this.D.getValue()),Yr(this.D.La(),"Start date:"+this.D.getValue()))};var ujh=new kv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function vjh(a,b){a=void 0===a?lD.getInstance():a;for(var c=new Ft,d=1;28>=d;d++)c.Ha(new At(ujh.format({DAY:d}),d),!0);QU.call(this,c,a,b)}v(vjh,QU);function wjh(){var a='<div class="'+U("waffle-dataconnector-refresh-day-of-month-widget")+'"><div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-day-of-month-widget-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-day-of-month-widget-add-day-select")+'" aria-label="';a+=Hr("Add day to repeat on");a+='"></div></div><div class="'+U("waffle-dataconnector-refresh-day-of-month-widget-chip-container")+'"></div></div>';return T(a)};var xjh=new kv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function yjh(a){S.call(this,a);this.D=new S;this.Ha(this.D);this.C=new vjh(vt.getInstance(),a);Yt(this.C,"Add day");this.Ha(this.C);this.F=new zjh}v(yjh,S);p=yjh.prototype;p.Ca=function(){S.prototype.Ca.call(this);this.mb(xr(wjh));this.D.Wa(this.Da("waffle-dataconnector-refresh-day-of-month-widget-chip-container"));this.C.render(this.Da("waffle-dataconnector-refresh-day-of-month-widget-add-day-select"))};
p.Ja=function(){S.prototype.Ja.call(this);ym(this.Da("waffle-dataconnector-refresh-day-of-month-widget-label"),"Repeat on");this.getHandler().listen(this.C,"change",this.npc).listen(this,"Ee",this.xrc)};p.npc=function(){var a=this.C.getValue();l_a(this.C.ck,null);Ajh(this,a);this.dispatchEvent("change")};p.xrc=function(a){a=a.target;var b=pr(this.D,a);this.F.remove(b)&&(this.D.removeChild(a,this.yb()),this.dispatchEvent("change"))};
function Ajh(a,b){if(!a.F.has(b)){var c=new zef(xjh.format({DAY:b}),a.qa());b=a.F.add(b);a.D.zf(c,b,a.yb())}}p.Id=function(){return this.F.C};function Bjh(a,b){for(var c=0;c<b.length;c++)Ajh(a,b[c])}function zjh(){this.C=[]}zjh.prototype.add=function(a){var b=Kd(this.C,a);Bd(this.C,a,-b-1);return-b-1};zjh.prototype.has=function(a){return-1<ld(this.C,a)};zjh.prototype.remove=function(a){return Ed(this.C,a)};function Cjh(){}v(Cjh,grd);Cjh.prototype.Ca=function(a){return a.qa().Ca("INPUT",{type:"number",max:"100",min:"1"})};Ca(Cjh);function Djh(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-new-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-new-title")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-enable-switch")+'"></div></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-new-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-new-label-separator")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-new-edit-btn")+'"></span></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-new-fullview-text"></div><div><span class="'+U("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn")+'"></span> - ';a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-new-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-repeat-every-label")+
'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-interval-input")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget")+
'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-day-of-month-widget")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-weekday-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-repeat-at-label")+
'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+U("waffle-dataconnector-refresh-schedules-new-time-select-label")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-time-select")+" "+U("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-schedules-new-start-date-label")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-edit-section-row")+
" "+U("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-start-date-select")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-start-time-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-owner-info")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-new-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-new-cancel-btn")+'"></div><div class="'+
U("waffle-dataconnector-refresh-schedules-new-save-btn")+'"></div></div></div></div>');return T(a)};function Ejh(){for(var a='<div class="'+U("waffle-dataconnector-refresh-schedules-new-label")+" "+U("waffle-dataconnector-refresh-weekday-select-label")+'"></div><div style="display: flex">',b=0;7>b;b++)a+='<div data-index="'+U(b)+'" class="'+U("waffle-dataconnector-refresh-weekday-select")+'"></div>';return T(a+"</div>")};function Fjh(a){a=a.name;return T('<div class="'+U("waffle-dataconnector-refresh-weekday-toggle")+'">'+Ar(a)+"</div>")};function Gjh(a,b,c,d){wt.call(this,void 0,Hjh.getInstance(),d);this.F=a;this.D=c;this.C=b;this.Lf(16,!0)}v(Gjh,wt);Gjh.prototype.Fo=function(a){wt.prototype.Fo.call(this,a);this.isEnabled()&&this.dispatchEvent("change")};Gjh.prototype.getName=g("F");function Hjh(){}v(Hjh,vt);Hjh.prototype.Ca=function(a){var b=xr(Fjh,{name:a.getName()});cs(b,this.xo(a));return b};Hjh.prototype.jc=m("waffle-dataconnector-refresh-weekday-toggle");Ca(Hjh);function Ijh(a){S.call(this,a);this.C=Jjh(this,a)}v(Ijh,S);Ijh.prototype.Ca=function(){S.prototype.Ca.call(this);this.mb(xr(Ejh))};Ijh.prototype.Ja=function(){var a=this;S.prototype.Ja.call(this);ym(this.Da("waffle-dataconnector-refresh-weekday-select-label"),"Repeat on");this.C.forEach(function(b,c){b.render(a.Df("waffle-dataconnector-refresh-weekday-select")[c]);Yr(b.La(),b.D)})};Ijh.prototype.Id=function(){return this.C.filter(function(a){return a.isChecked()}).map(function(a){return a.C})};
function Jjh(a,b){var c=(Hw.FIRSTDAYOFWEEK+1)%7,d=Hw.NARROWWEEKDAYS.map(function(e,f){return new Gjh(e,(f+6)%7+1,Hw.WEEKDAYS[f],b)});d=d.slice(c).concat(d.slice(0,c));d.forEach(function(e){return a.Ha(e)});return d};var Kjh=new kv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function Ljh(a,b,c,d){f3.call(this,a,b,c,d);this.R=new off(0,Cjh.getInstance(),d);this.R.setValue("1");this.Ha(this.R);a=new Ft;a.Ha(new At("hours",4),!0);a.Ha(new At("days",1),!0);a.Ha(new At("weeks",2),!0);a.Ha(new At("months",3),!0);this.D=new QU(a,pjh.getInstance(),d);this.D.jf(0);this.D.rc("waffle-dataconnector-refresh-schedule-frequency");this.Ha(this.D);this.L=new yjh(d);this.Ha(this.L);this.Ea=new Ijh(d);this.Ha(this.Ea);this.F=new QU(Mjh(),pjh.getInstance(),d);this.F.jf((new Date).getHours());
this.F.rc("waffle-dataconnector-refresh-schedule-time");this.Ha(this.F);this.Aa=new rjh(0,grd.getInstance(),d);this.ea=new QU(Mjh(),pjh.getInstance(),d);this.ea.jf((new Date).getHours());this.Ha(this.Aa);this.J=new dP("Cancel");this.Ha(this.J);this.xa=new uw("Save",d);this.Ha(this.xa);this.Ia=new wt("",bH.getInstance(),d);this.Ha(this.Ia);this.Qa=new wt("Setup now",bH.getInstance(),d);this.Ha(this.Qa);this.Pa=new wt("",bH.getInstance(),d);this.Ha(this.Pa);this.H=new tS(d);this.H.Xd("Enable schedule");
this.Ha(this.H);this.Ma=b;this.O=new Eff(d);this.O.Ob("waffle-dataconnector-refresh-schedules-new-info-icon");this.O.setVisible(!1);this.ib=new sV(!0,"#0f9d58")}v(Ljh,f3);p=Ljh.prototype;
p.Ca=function(){f3.prototype.Ca.call(this);this.mb(xr(Djh));var a=this.Da("waffle-dataconnector-refresh-schedules-new-title");a.id=kr(this,"waffle-dataconnector-refresh-schedules-new-title");Vr(this.La(),"labelledby",a.id);Yr(a,"Scheduled refresh");ym(a,"Scheduled refresh");a=this.O.C;a.setContent(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Da("waffle-dataconnector-refresh-schedules-new-header-title"));
a=a.zb();Vr(tm(this.O.La())[0],"labelledby",a.id)};
p.Ja=function(){var a=this;f3.prototype.Ja.call(this);this.J.render(this.Da("waffle-dataconnector-refresh-schedules-new-cancel-btn"));this.Ia.render(this.Da("waffle-dataconnector-refresh-schedules-new-edit-btn"));this.H.render(this.Da("waffle-dataconnector-refresh-schedules-new-enable-switch"));this.R.render(this.Da("waffle-dataconnector-refresh-schedules-new-interval-input"));this.D.render(this.Da("waffle-dataconnector-refresh-schedules-new-frequency-select"));this.xa.render(this.Da("waffle-dataconnector-refresh-schedules-new-save-btn"));
this.Qa.render(this.Da("waffle-dataconnector-refresh-schedules-new-setup-btn"));this.Pa.render(this.Da("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn"));this.F.render(this.Da("waffle-dataconnector-refresh-schedules-new-time-select"));this.L.render(this.Da("waffle-dataconnector-refresh-schedules-new-day-of-month-widget"));this.Ea.render(this.Da("waffle-dataconnector-refresh-schedules-new-weekday-select"));this.ib.render(this.Da("waffle-dataconnector-refresh-schedules-new-spinner"));
this.Aa.render(this.Da("waffle-dataconnector-refresh-schedules-new-start-date-select"));this.ea.render(this.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"));g3(this,!1);h3(this,!1);Njh(this,!0);Nt(this.F,new Sr(null,13));Nt(this.ea,new Sr(null,13));ym(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),"Repeat at");ym(this.Da("waffle-dataconnector-refresh-schedules-new-repeat-every-label"),"Repeat every");ym(this.Da("waffle-dataconnector-refresh-schedules-new-start-date-label"),
"Start date");var b=this.Da("waffle-dataconnector-refresh-schedules-new-repeat-every-label");b.id=kr(this,"waffle-dataconnector-refresh-schedules-new-repeat-every-label");Vr(this.D.La(),"labelledby",b.id);Vr(this.R.La(),"labelledby",b.id);b=this.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label");b.id=kr(this,"waffle-dataconnector-refresh-schedules-new-repeat-at-label");Vr(this.F.La(),"labelledby",b.id);b=this.Da("waffle-dataconnector-refresh-schedules-new-start-date-label");b.id=kr(this,
"waffle-dataconnector-refresh-schedules-new-start-date-label");Vr(this.Aa.La(),"labelledby",b.id);this.getHandler().listen(this.Ia,"action",this.show).listen(this.J,"action",this.Xqb).listen(this.xa,"action",this.$qb).listen(this.Qa,"action",this.show).listen(this.H,"action",this.Yqb).listen(this.D,"change",this.Zqb).listen(this.L,"change",this.OH).listen(this.Ea,"change",this.OH).listen(this.L,"change",this.OH).listen(this.F,"change",this.OH).listen(this.ea,"change",this.OH).listen(this.R,"action",
this.OH).listen(this.Pa,"action",this.arb).listen(this.La(),"keydown",this.Wqb);[this.D,this.F,this.ea,this.J].forEach(function(c){a.getHandler().listen(c.La(),"focus",function(){var d=a.Aa;d.C&&d.C.isVisible()&&d.C.hide()})});0<Array.from(this.Va.C.keys()).length?(P(this.La(),!0),ljh(this)):P(this.La(),!1)};
p.refresh=function(){if(!this.isDisposed()){var a=this.Da("waffle-dataconnector-refresh-schedules-new-edit-section"),b=this.Da("waffle-dataconnector-refresh-schedules-new-overview-section"),c=this.Da("waffle-dataconnector-refresh-schedules-new-fullview-section"),d=this.Da("waffle-dataconnector-refresh-schedules-new-owner-info"),e=this.Da("waffle-dataconnector-refresh-schedules-new-setup-btn"),f=this.Da("waffle-dataconnector-refresh-schedules-new-enable-switch"),h=this.Da("waffle-dataconnector-refresh-schedules-new-spinner");
P(e,!1);P(f,!1);P(a,!1);P(b,!1);P(c,!1);P(d,!1);P(h,!1);fs(this.La(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!1);var k=!1;this.O.setVisible(!1);switch(this.state){case 1:P(e,!0);break;case 2:P(c,!0);P(a,!0);P(d,!0);fs(this.La(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;Ojh(this);Pjh(this);this.OH();this.J.Oa(!0);this.O.setVisible(!0);Bjh(this.L,[Math.min((new Date).getDate(),28)]);break;case 3:P(h,!0);break;case 5:P(c,!0);P(f,!0);P(a,!0);P(d,!0);fs(this.La(),
"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;Qjh(this);Ojh(this);Pjh(this);a=sU(this.C);this.H.Jb(!!lh(a,1));b=a.Mi().Mi();this.D.setValue(b);switch(b){case 4:h3(this,!1);g3(this,!1);break;case 1:h3(this,!1);g3(this,!1);this.F.setValue(qh(a.Mi(),2));break;case 2:h3(this,!0);g3(this,!1);c=this.Ea;d=KR(a.Mi(),4).Gb();e=ha(c.C);for(f=e.next();!f.done;f=e.next())f.value.Jb(!1);for(e=0;e<c.C.length;e++)f=c.C[e],0<=d.indexOf(f.C)&&f.Jb(!0);this.F.setValue(qh(a.Mi(),2));break;case 3:h3(this,
!1),g3(this,!0),Bjh(this.L,KR(a.Mi(),5).Gb()),this.F.setValue(qh(a.Mi(),2))}c=ih(a.Mi(),7)?new Date(ph(a.Mi(),7)):new Date;this.Aa.setDate(c);4===b?this.ea.setValue(c.getHours()):this.F.setValue(qh(a.Mi(),2));this.R.setValue(rh(a.Mi(),6,1).toString());this.OH();this.J.Oa(!0);this.O.setVisible(!0);break;case 4:P(f,!0),P(b,!0),Qjh(this),b=this.Da("waffle-dataconnector-refresh-schedules-new-overview-text"),mjh(this)?(a=this.C.getStatus(),ym(b,"Next: "),b=new Date(1E3*ph(a,2)),a=new Date(1E3*ph(a,3)),
this.Ia.setContent(Jm(this.qa(),Lff(b,a,this.Ma,!0,!0))),P(this.Da("waffle-dataconnector-refresh-schedules-new-label-separator"),!1)):(ym(b,"Paused"),this.Ia.setContent("Edit"),P(this.Da("waffle-dataconnector-refresh-schedules-new-label-separator"),!0))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Uk":"Tk"))}};function Qjh(a){var b=!!lh(sU(a.C),1),c=Fx.isEnabled();a.H.Jb(b);a.H.Oa(c)}
function Ojh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-new-owner-info"),c="Will run as you.";a.C&&(a=nh(a.C.sb(4,c1e),1))&&(c+=" Currently running as "+a);ym(b,c)}function Pjh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-new-fullview-text");if(mjh(a)){var c=a.C.getStatus(),d=new Date(1E3*ph(c,2));c=new Date(1E3*ph(c,3));var e=a.qa();e.qd(b);e.appendChild(b,Jm(e,df(Ze("Next: "),Lff(d,c,a.Ma,!1,!0))))}else ym(b,"");a.Pa.setContent(Kff(a.Ma))}p.Xqb=function(){Rjh(this)};
function Rjh(a){a.state=2==a.state?1:4;a.refresh();a.Da("waffle-dataconnector-refresh-schedules-new-title").focus()}p.Zqb=function(){switch(this.D.getValue()){case 4:h3(this,!1);g3(this,!1);Njh(this,!0);break;case 1:h3(this,!1);g3(this,!1);Njh(this,!1);break;case 2:g3(this,!1);h3(this,!0);Njh(this,!1);break;case 3:h3(this,!1),g3(this,!0),Njh(this,!1)}this.OH()};
function Njh(a,b){P(a.Da("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!b);P(a.Da("waffle-dataconnector-refresh-schedules-new-time-select"),!b);P(a.Da("waffle-dataconnector-refresh-schedules-new-start-time-select"),b)}
p.$qb=function(){this.xa.Oa(!1);this.J.Oa(!1);var a=this.D.getValue(),b=Vih().FP(a);if(2===a)for(var c=ha(this.Ea.Id()),d=c.next();!d.done;d=c.next())d=d.value,ch(b.hb,4,Goa).add(d);else if(3===a)for(c=ha(this.L.Id()),d=c.next();!d.done;d=c.next())d=d.value,ch(b.hb,5,Goa).add(d);c=this.Aa.getDate();4===a&&c.setHours(this.ea.getValue());c=c.getTime();zh(b,7,c);4!==a&&(a=this.F.getValue(),Bh(b,2,a));a=parseInt(this.R.getValue(),10);Bh(b,6,a);b=Bh(Wih().FP(b),3,1);2==this.state?(b.Oa(!0),Lgb.kb(b.build())):
(b.Oa(this.H.isChecked()),Mgb.kb(b.build()))};p.Yqb=function(){var a=this;if(4==this.state){var b=this.H.isChecked();this.H.Jb(!b);this.H.Oa(!1);if(b){var c=Sjh(this);c.render();c.setVisible(!0);c.getResult().then(function(){Wf(c);Ngb.kb()},function(){Wf(c);Qjh(a)})}else Ogb.kb()}};p.Wqb=function(a){27==a.keyCode&&this.ma&&(Rjh(this),a.stopPropagation())};p.arb=function(){mA.kb()};
p.OH=function(){var a=!!this.D.qf(),b=3!==this.D.getValue()||0<this.L.Id().length,c=2!==this.D.getValue()||0<this.Ea.Id().length,d=!!this.F.qf()||4===this.D.getValue(),e=!!this.ea.qf()||4!==this.D.getValue(),f=Fx.isEnabled(),h=parseFloat(this.R.getValue());h=Number.isInteger(h)&&0<h&&100>=h;this.xa.Oa(a&&b&&c&&d&&e&&f&&h)};p.focus=function(){this.Da("waffle-dataconnector-refresh-schedules-new-title").focus()};p.tGa=function(a){this.H.Oa(a)};
function g3(a,b){P(a.Da("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget"),b)}function h3(a,b){P(a.Da("waffle-dataconnector-refresh-schedules-new-weekday-select"),b)}
function Sjh(a){var b=new ryf;b.Ob("waffle-dataconnector-refresh-schedules-new-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=sU(a.C);switch(c.Mi().Mi()){case 1:var d="Daily ";break;case 2:d=Tjh();var e=KR(c.Mi(),4).Gb();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(KR(c.Mi(),5).Gb().map(function(l){return Kjh.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=Iff(a.Ma);var h=new Date(La()),k=new Date(1E3*ph(f,2));f=new Date(1E3*ph(f,3));d+=Jff(k,f,c)+" ("+T$a(V$a(c,h))+")";a="Will run as "+nh(a.C.sb(4,c1e),1);a=df(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),cf("H4",void 0,"Schedule"),Ze(d),cf("BR"),Ze(a));ts(b,a);return b}
p.rma=function(){Lu.getInstance().postMessage(Nu("Error saving schedule.","error",!0));this.xa.Oa(!0);this.J.Oa(!0);this.H.Oa(!0)};function Tjh(){var a=(Hw.FIRSTDAYOFWEEK+1)%7,b=Hw.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}
function Mjh(){for(var a=new Ft,b=new Date(La()),c=Array(24),d=0;24>d;d++){b.setHours(d,0,0,0);var e=new Date(b.getTime()),f=new Date(b.getTime());f.setHours(e.getHours()+1);f=Jff(e,f);c[e.getHours()]={value:d,label:f}}for(b=0;24>b;b++)d=new At(c[b].label,c[b].value),a.Ha(d,!0);return a};function Ujh(a,b,c){B.call(this);this.C=a;this.J=b;this.L=c;this.F=[];this.H=[];this.D=[]}v(Ujh,B);Ujh.prototype.Na=function(){Vjh(this);B.prototype.Na.call(this)};function Wjh(a,b,c){var d=YG(a.C);b.forEach(function(e){var f=e.rect;f&&WC(f)&&(d&&qU(a.C)==e.gid?(e=Wwc(d,f,Xjh(c)),a.oa(e),e.setVisible(!0),a.F.push(e)):Yjh(a,e.gid,c))})}
function Zjh(a,b,c){var d=YG(a.C);b.forEach(function(e){if(d){var f=nL(d.J,e);if(f&&f.yb()&&f instanceof Fxf){a.D.push(f);bs(TX(f.D),Xjh(c));return}}(e=a.L.J.Gk(e))&&Yjh(a,e.gb(),c)})}function Yjh(a,b,c){b=d3e(a.J,b);bs(b.La(),Xjh(c));a.H.push(b)}function Xjh(a){return a?"waffle-dataconnector-refreshall-highlight-valid":"waffle-dataconnector-refreshall-highlight-error"}
function Vjh(a){Xf(a.F);a.F=[];a.H.forEach(function(b){es(b.La(),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.H=[];a.D.forEach(function(b){es(TX(b.D),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.D=[]};function $jh(){return T('<div class="'+U("waffle-dataconnector-refresh-all-pane")+'"><div class="'+U("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function akh(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function bkh(a,b){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+akh(null,b))}function ckh(){return T('<div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function dkh(a){a=a.title;a='<div class="'+U("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+AVb()+'</div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+Ar(a)+'</div><div class="'+
U("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+U("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(U("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return T(a+"Running\u2026</div></div></div>")};function ekh(a,b,c,d,e,f,h){S.call(this,h);this.C=a;this.ma=b;this.ea=c;this.R=d.L;this.L=e;this.D=new Ujh(e,f,d);this.oa(this.D);this.O=new Amc;this.H=new sV(!1,"#0f9d58");this.F=this.J=!0}v(ekh,S);p=ekh.prototype;p.Ca=function(){this.mb(xr(dkh,{title:this.ma}));var a=this.Da("waffle-dataconnector-refresh-all-dbobject-item-title");a.id=kr(this,"waffle-dataconnector-refresh-all-dbobject-item-title");Tr(a,"heading");Vr(this.La(),"labelledby",a.id)};
p.Ja=function(){S.prototype.Ja.call(this);bs(this.La(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.H.render(this.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.La(),"click",this.rNa).listen(this.La(),"keydown",this.crb).listen(this.La(),["mouseenter","focus"],this.brb).listen(this.La(),["mouseleave","blur"],this.JZb);fkh(this)};
function fkh(a){var b=tU(a.R,a.C),c=b.getType(),d=a.La();switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":case "offline":hs(d,"valid-highlight","error-highlight");a.F=!1;break;case "loading":case "no-results":case "fetch-successful":hs(d,"error-highlight","valid-highlight");a.F=!0;break;case "fetching-results":case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":gkh(a,
"waffle-dataconnector-refresh-all-dbobject-item-error");hkh(a);break;case "offline":hkh(a);break;case "loading":gkh(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");ikh(a);break;case "fetching-results":gkh(a,"waffle-dataconnector-refresh-all-dbobject-item-running");ikh(a);break;case "no-results":jkh(a);hkh(a);break;case "fetch-successful":b=ph(b.C,8);b=a.O.format(b);ym(a.Da("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);Yr(a.Da("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),
b);gkh(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");hkh(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}p.Oa=function(a){this.J=a;var b=this.La();this.qa().Sh(b,a);a?hs(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):hs(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
p.brb=function(){var a=this;switch(this.ea){case 1:case 3:case 5:var b=N().pWa()(this.C,qU(this.L)).map(function(c){return DD(io(c))});Wjh(this.D,b,this.F);break;case 2:b=N().oWa()(this.C);Zjh(this.D,b,this.F);break;case 4:N().nWa()(this.C).forEach(function(c){Yjh(a.D,c,a.F)})}};p.JZb=function(){Vjh(this.D)};function gkh(a,b){jkh(a);P(a.Da(b),!0)}
function hkh(a){a.H.setActive(!1);P(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);P(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function ikh(a){a.H.setActive(!0);P(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);P(a.Da("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}p.crb=function(a){13===a.keyCode&&this.rNa()};p.rNa=function(){if(this.J){var a=new ND("refresh-db-object-request");a.PUa=this.C;this.dispatchEvent(a)}};
function jkh(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return P(a.Da(b),!1)})};function kkh(a,b,c,d,e,f,h,k){S.call(this,k);this.O=a;this.H=new Set(b);this.xa=c;this.R=c.L;this.F=[];this.ea=f;this.ma=h;this.J=d;this.D=this.C=null;e&&(this.C=new lkh(this.qa()),this.D=new cW(this.J,this.qa(),!0));this.L=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}v(kkh,S);p=kkh.prototype;p.Ca=function(){if(this.D){var a=im("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.mb(a);this.Ha(this.D,!0);this.D.setContent(xr(akh));bs(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.mb(xr(bkh))};
p.Ja=function(){S.prototype.Ja.call(this);this.D||ym(this.Da("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.J);mkh(this);nkh(this);var a=this.getHandler();this.C&&(this.C.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),a.listen(this.C,"action",this.Vbc))};function okh(a){var b=a.getHandler();a.F.forEach(function(c){b.Hc(c,"refresh-db-object-request",a.b1a)})}
function nkh(a){var b=a.getHandler();a.F.forEach(function(c){b.listen(c,"refresh-db-object-request",a.b1a)})}function mkh(a){var b=a.Da("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.H.forEach(function(c){var d=N().qF()(c);c=new ekh(c,pkh(a,d),d,a.xa,a.ea,a.ma,a.qa());a.F.push(c);c.render(b)})}
function pkh(a,b){switch(b){case 1:return"Pivot table "+qkh(a,1);case 2:return"Chart "+qkh(a,2);case 3:return"Function "+qkh(a,3);case 4:return"Preview";case 5:return"Extract "+qkh(a,5);default:throw Error("Unexpected DbObjectType");}}function qkh(a,b){var c=a.L.get(b);a.L.set(b,c+1);return 0==c?"":c.toString()}function rkh(a){a.L.forEach(function(b,c,d){return d.set(c,0)})}
p.Vbc=function(){var a=this,b=Array.from(this.H).filter(function(c){return a3b.has(tU(a.R,c).D)});Ax.kb(new Jye(b,"all-objects-for-single-datasource",this.O))};p.b1a=function(a){a=a.PUa;a3b.has(tU(this.R,a).D)&&Ax.kb(new Jye([a],"specific-ids"))};function skh(a){a.F.forEach(function(b){return fkh(b)})}function tkh(a,b){a.C&&(b=b.filter(function(c){return ih(c,3)&&a.H.has(c.Rl())}),ukh(a.C,b))}p.expand=function(){this.D.getHeader().Jb(!0)};p.Hd=g("O");
function vkh(a,b){a.J=b;a.D?a.D.getHeader().setContent(b):ym(a.Da("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}p.Oa=function(a){this.C&&this.C.Oa(a);this.F.forEach(function(b){return b.Oa(a)})};function lkh(a){S.call(this,a);this.D=new dP("Refresh",this.qa());this.Ha(this.D);this.C=new xuf;this.Ha(this.C)}v(lkh,S);lkh.prototype.Ca=function(){this.mb(xr(ckh))};
lkh.prototype.Ja=function(){S.prototype.Ja.call(this);this.D.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Da("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function ukh(a,b){var c=0;b.forEach(function(d){return c+=parseInt(d.xq(),10)});Igf(a.C,c);a.D.Oa(!0)}lkh.prototype.Oa=function(a){this.D.Oa(a)};function wkh(a,b,c,d){S.call(this,d);this.F=a;this.J=a.L;this.D=new S;this.Ha(this.D);this.C=[];this.H=b;this.L=c}v(wkh,S);wkh.prototype.Ca=function(){this.mb(xr($jh))};wkh.prototype.Ja=function(){var a=this;S.prototype.Ja.call(this);this.D.Wa(this.Da("waffle-dataconnector-refresh-all-datasources-container"));xkh(this);this.getHandler().listen(this.F.C,"ua",function(b){return ykh(a,b)})};
function xkh(a){var b=a.D.qd(!0);Xf(b);a.C=[];b=zkh(a);if(1==b.size)b=b.entries().next().value,Akh(a,b[0],b[1],!1),bs(a.D.La(),"waffle-dataconnector-refresh-all-single-datasource-container");else{for(var c=ha(b.keys()),d=c.next();!d.done;d=c.next()){d=d.value;var e=b.get(d);Akh(a,d,e,!0)}ds(a.D.La(),"waffle-dataconnector-refresh-all-single-datasource-container")}1<a.C.length&&a.C[0].expand()}
function Bkh(a){var b=zkh(a);1!=b.size&&1!=a.C.length||b.size==a.C.length?(a.C.forEach(function(c){var d=c.Hd();if(b.has(d)){var e=b.get(d);okh(c);Xf(c.F);c.F=[];rkh(c);c.H=new Set(e);mkh(c);nkh(c)}else Ckh(a,c);b.delete(d)}),b.forEach(function(c,d){return Akh(a,d,c,!0)})):xkh(a)}function Ckh(a,b){a.C=a.C.filter(function(c){return b!=c});Wf(b)}function Akh(a,b,c,d){var e=N().nT()(b);e=EF(a.F.C,e).Td();b=new kkh(b,c,a.F,e,d,a.H,a.L,a.qa());a.C.push(b);a.D.Ha(b,!0)}
function zkh(a){var b=new Map;Sih(a.J).forEach(function(c){var d=N().JN()(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function Dkh(a,b){a.C.forEach(function(c){return tkh(c,b)})}function Ekh(a){a.C.forEach(function(b){b.C&&Ggf(b.C.C)})}function Fkh(a){a.C.forEach(function(b){b.C&&(b=b.C,Fgf(b.C),b.D.Oa(!1))})}function Gkh(a){a.C.forEach(function(b){return skh(b)})}wkh.prototype.Oa=function(a){this.C.forEach(function(b){return b.Oa(a)})};
function ykh(a,b){3==EF(a.F.C,b.gh).getSheetType()&&(a=a.C.find(function(c){return c.J==b.C}))&&vkh(a,b.Bm)};function Hkh(a,b,c){b=void 0===b?kD.getInstance():b;ct.call(this,"",void 0,c);a&&Ikh(a);this.C=new Jkh(a,b,c);this.Ha(this.C)}v(Hkh,ct);p=Hkh.prototype;p.Ca=function(){this.C.Ca();this.mb(this.C.La())};p.hd=function(a){a.Tm(!0);this.C.hd(a)};p.Ts=function(a,b){a.Tm(!0);this.C.Ts(a,b)};p.Fg=function(a){return this.C.Fg(a)};p.oh=function(){return this.C.oh()};p.Id=function(){return this.C.C.map(function(a){return a.getValue()})};
function Kkh(a,b){a=a.C;for(var c=ha(a.C),d=c.next();!d.done;d=c.next())d.value.Jb(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.oh();e++){var f=a.Fg(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Jb(!0),c.push(f),0==--d))break}a.C=c}a.bH()}p.Bb=function(){return this.C.Bb()};p.pe=function(a){Ikh(a);this.C.pe(a)};p.rc=function(a){this.C.rc(a)};function Ikh(a){for(var b=0;b<a.kc();b++)a.Bc(b).Tm(!0)}function Jkh(a,b,c){b=void 0===b?kD.getInstance():b;RU.call(this,a,b,c);this.C=[]}
v(Jkh,RU);Jkh.prototype.pe=function(a){RU.prototype.pe.call(this,a);this.C=[];this.bH()};Jkh.prototype.zq=function(a){a.stopPropagation();a=a.target;if(a.isChecked()){var b=this.Bb();Yea(this.C,a,function(c,d){return Ld(pr(b,c),pr(b,d))})}else Dd(this.C,a);this.bH();this.dispatchEvent("change")};Jkh.prototype.J=function(){var a;0==this.C.length?a=this.H:a=this.C.map(function(b){return b.Rg()}).join(", ");return a||""};function Lkh(){var a='<div class="'+U("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+U("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(U("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+U("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+U("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+U("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
U("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(U("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-frequency-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+U("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-date-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-time-select")+" "+U("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+U("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
U("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+U("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+U("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return T(a)};var Mkh=new kv("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function Nkh(a,b,c,d){f3.call(this,a,b,c,d);this.Ma=y(A(),"fdsrfu")?1:4;a=new Ft;a.Ha(new At("Every day",1),!0);a.Ha(new At("Every week",2),!0);a.Ha(new At("Every month",3),!0);this.H=new RU(a,kD.getInstance(),d);Yt(this.H,"Add frequency");this.H.rc("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Ha(this.H);this.D=new Hkh(void 0,kD.getInstance(),d);Yt(this.D.C,"Add date");this.D.rc("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");
this.Ha(this.D);var e=this.Ma;a=new Ft;var f=new Date(La());c=Array(24);for(var h=0;24>h;h++){f.setHours(h,0,0,0);var k=new Date(f.getTime()),l=new Date(f.getTime());l.setHours(k.getHours()+e);l=Jff(k,l);c[k.getHours()]={value:h,label:l}}for(e=0;24>e;e++)f=new At(c[e].label,c[e].value),a.Ha(f,!0);this.J=new RU(a,kD.getInstance(),d);Yt(this.J,"Add time");this.J.rc("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Ha(this.J);this.O=new dP("Cancel");this.Ha(this.O);this.R=
new uw("Save",d);this.R.Oa(!1);this.Ha(this.R);this.ea=new wt("",bH.getInstance(),d);this.Ha(this.ea);this.Ea=new wt("Setup now",bH.getInstance(),d);this.Ha(this.Ea);this.Aa=new wt("",bH.getInstance(),d);this.Ha(this.Aa);this.F=new tS(d);this.F.Xd("Enable schedule");this.Ha(this.F);this.xa=b;this.L=new Eff(d);this.L.Ob("waffle-dataconnector-refresh-schedules-info-icon");this.L.setVisible(!1);this.Ia=new sV(!0,"#0f9d58")}v(Nkh,f3);p=Nkh.prototype;
p.Ca=function(){f3.prototype.Ca.call(this);this.mb(xr(Lkh));var a=this.Da("waffle-dataconnector-refresh-schedules-title");a.id=kr(this,"waffle-dataconnector-refresh-schedules-title");Tr(a,"heading");Vr(this.La(),"labelledby",a.id);a=this.L.C;a.setContent(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.L.render(this.Da("waffle-dataconnector-refresh-schedules-header-title"));a=a.zb();Vr(this.L.La(),"labelledby",
a.id)};
p.Ja=function(){f3.prototype.Ja.call(this);this.O.render(this.Da("waffle-dataconnector-refresh-schedules-cancel-btn"));this.ea.render(this.Da("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Da("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Da("waffle-dataconnector-refresh-schedules-frequency-select"));this.R.render(this.Da("waffle-dataconnector-refresh-schedules-save-btn"));this.Ea.render(this.Da("waffle-dataconnector-refresh-schedules-setup-btn"));this.Aa.render(this.Da("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));
this.J.render(this.Da("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Da("waffle-dataconnector-refresh-schedules-date-select"));this.Ia.render(this.Da("waffle-dataconnector-refresh-schedules-spinner"));Okh(this,!1);Nt(this.J,new Sr(null,13));this.getHandler().listen(this.ea,"action",this.show).listen(this.O,"action",this.erb).listen(this.R,"action",this.irb).listen(this.Ea,"action",this.show).listen(this.F,"action",this.frb).listen(this.H,"change",this.hrb).listen(this.D,
"change",this.m4).listen(this.J,"change",this.m4).listen(this.Aa,"action",this.krb).listen(this.La(),"keydown",this.drb);0<Array.from(this.Va.C.keys()).length?(P(this.La(),!0),ljh(this)):P(this.La(),!1)};
p.refresh=function(){if(!this.isDisposed()){var a=this.Da("waffle-dataconnector-refresh-schedules-edit-section"),b=this.Da("waffle-dataconnector-refresh-schedules-overview-section"),c=this.Da("waffle-dataconnector-refresh-schedules-fullview-section"),d=this.Da("waffle-dataconnector-refresh-schedules-owner-info"),e=this.Da("waffle-dataconnector-refresh-schedules-setup-btn"),f=this.Da("waffle-dataconnector-refresh-schedules-enable-switch"),h=this.Da("waffle-dataconnector-refresh-schedules-spinner");
P(e,!1);P(f,!1);P(a,!1);P(b,!1);P(c,!1);P(d,!1);P(h,!1);fs(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var k=!1;this.L.setVisible(!1);switch(this.state){case 1:P(e,!0);break;case 2:P(c,!0);P(a,!0);P(d,!0);fs(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);k=!0;Pkh(this);Qkh(this);this.m4();this.O.Oa(!0);this.L.setVisible(!0);break;case 3:P(h,!0);break;case 5:P(c,!0);P(f,!0);P(a,!0);P(d,!0);fs(this.La(),"waffle-dataconnector-refresh-schedules-widget-opened",
!0);k=!0;Rkh(this);Pkh(this);Qkh(this);a=sU(this.C);this.F.Jb(!!lh(a,1));b=a.Mi().Mi();this.H.setValue(b);switch(b){case 1:Okh(this,!1);break;case 2:Kkh(this.D,KR(a.Mi(),4).Gb());Okh(this,!0);break;case 3:Kkh(this.D,KR(a.Mi(),5).Gb()),Okh(this,!0)}this.J.setValue(qh(a.Mi(),2));this.m4();this.O.Oa(!0);this.L.setVisible(!0);break;case 4:P(f,!0),P(b,!0),Rkh(this),b=this.Da("waffle-dataconnector-refresh-schedules-overview-text"),mjh(this)?(a=this.C.getStatus(),ym(b,"Next: "),b=new Date(1E3*ph(a,2)),a=
new Date(1E3*ph(a,3)),this.ea.setContent(Jm(this.qa(),Lff(b,a,this.xa,!0,!0)))):(ym(b,"Paused"),this.ea.setContent("Edit"))}this.ma!=k&&(this.ma=k,this.dispatchEvent(k?"Uk":"Tk"))}};function Rkh(a){var b=!!lh(sU(a.C),1),c=Fx.isEnabled();a.F.Jb(b);a.F.Oa(c)}function Pkh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=nh(a.C.sb(4,c1e),1))&&(c+=" Currently running as "+a);ym(b,c)}
function Qkh(a){var b=a.Da("waffle-dataconnector-refresh-schedules-fullview-text");if(mjh(a)){var c=a.C.getStatus(),d=new Date(1E3*ph(c,2));c=new Date(1E3*ph(c,3));var e=a.qa();e.qd(b);e.appendChild(b,Jm(e,df(Ze("Next: "),Lff(d,c,a.xa,!1,!0))))}else ym(b,"");a.Aa.setContent(Kff(a.xa))}p.erb=function(){Skh(this)};function Skh(a){a.state=2==a.state?1:4;a.refresh();a.Da("waffle-dataconnector-refresh-schedules-title").focus()}
p.hrb=function(){var a=this.H.getValue();Kkh(this.D,[]);switch(a){case 1:Okh(this,!1);break;case 2:Okh(this,!0);a=this.D;var b=a.pe,c=new Ft,d=Tkh();d=ha(d);for(var e=d.next();!e.done;e=d.next())e=e.value,c.Ha(new At(e.label,e.value),!0);a=b.call(a,c);Wf(a);break;case 3:Okh(this,!0);a=this.D;b=a.pe;c=new Ft;for(d=1;28>=d;d++)c.Ha(new At(Mkh.format({DAY:d}),d),!0);a=b.call(a,c);Wf(a)}this.m4()};
p.irb=function(){this.R.Oa(!1);this.O.Oa(!1);var a=this.H.getValue(),b=Vih().FP(a);if(2===a){a=ha(this.D.Id());for(var c=a.next();!c.done;c=a.next())c=c.value,ch(b.hb,4,Goa).add(c)}else if(3===a)for(a=ha(this.D.Id()),c=a.next();!c.done;c=a.next())c=c.value,ch(b.hb,5,Goa).add(c);a=this.J.getValue();Bh(b,2,a);b=Bh(Wih().FP(b),3,1);2==this.state?(b.Oa(!0),Lgb.kb(b.build())):(b.Oa(this.F.isChecked()),Mgb.kb(b.build()))};
p.frb=function(){var a=this;if(4==this.state){var b=this.F.isChecked();this.F.Jb(!b);this.F.Oa(!1);if(b){var c=Ukh(this);c.render();c.setVisible(!0);c.getResult().then(function(){Wf(c);Ngb.kb()},function(){Wf(c);Rkh(a)})}else Ogb.kb()}};p.drb=function(a){27==a.keyCode&&this.ma&&(Skh(this),a.stopPropagation())};p.krb=function(){mA.kb()};p.m4=function(){var a=!!this.H.qf(),b=1===this.H.getValue()||0<this.D.Id().length,c=!!this.J.qf(),d=Fx.isEnabled();this.R.Oa(a&&b&&c&&d)};p.focus=function(){this.Da("waffle-dataconnector-refresh-schedules-title").focus()};
p.tGa=function(a){this.F.Oa(a)};function Okh(a,b){P(a.Da("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function Ukh(a){var b=new ryf;b.Ob("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=sU(a.C);switch(c.Mi().Mi()){case 1:var d="Daily ";break;case 2:d=Tkh();var e=KR(c.Mi(),4).Gb();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(KR(c.Mi(),5).Gb().map(function(l){return Mkh.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=Iff(a.xa);var h=new Date(La()),k=new Date(1E3*ph(f,2));f=new Date(1E3*ph(f,3));d+=Jff(k,f,c)+" ("+T$a(V$a(c,h))+")";a="Will run as "+nh(a.C.sb(4,c1e),1);a=df(Ze("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),cf("H4",void 0,"Schedule"),Ze(d),cf("BR"),Ze(a));ts(b,a);return b}
p.rma=function(){Lu.getInstance().postMessage(Nu("Error saving schedule.","error",!0));this.R.Oa(!0);this.O.Oa(!0);this.F.Oa(!0)};function Tkh(){var a=(Hw.FIRSTDAYOFWEEK+1)%7,b=Hw.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))};function Vkh(a,b,c,d,e,f){BV.call(this,f);this.F=b.L;this.L=a;this.R=d;this.qP=new wkh(b,c,this.R,this.qa());this.Ha(this.qP);this.D=new njh(this.F,f);this.oa(this.D);this.C=null;this.ea=y(A(),"fdsrfu");this.J=null;this.O=e}v(Vkh,BV);p=Vkh.prototype;p.Ca=function(){BV.prototype.Ca.call(this);this.mb(xr(ojh,{id:this.getId()}));this.D.render(this.Da("waffle-dataconnector-refresh-sidebar-footer-wrapper"))};
p.Ja=function(){var a=this;BV.prototype.Ja.call(this);Wkh(this);this.getHandler().listen(this,["Tk","Uk"],this.hdc);this.qP.render(this.Da("waffle-dataconnector-refresh-sidebar-refresh-widget"));Xkh(this,!0);this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=Tih(a.F);Ax.kb(new Jye(b,"all-objects-for-all-datasources"))});this.D.refresh();P(this.Da("waffle-dataconnector-refresh-sidebar-backdrop"),!1)};function Ykh(a){null!=a.C&&(Wf(a.C),Wf(a.J),Wkh(a))}
p.loa=function(){null!=this.C&&this.C.show()};function Zkh(a,b){Dkh(a.qP,b);var c=0;b.forEach(function(d){return c+=parseInt(d.xq(),10)});a.D.Fm(c)}function Xkh(a,b){a.qP.Oa(b);b?a.D.refresh():a.D.C.Oa(b)}
p.hdc=function(a){var b=this;a="Uk"===a.type;P(this.Da("waffle-dataconnector-refresh-sidebar-backdrop"),a);Xkh(this,!a);Jq(this.zb(),"overflow-y",a?"hidden":"auto");Wf(this.J);a?($kh(this),setTimeout(function(){if(b.C.yb()){var c=b.C.La();b.J=new hw(c,b.qa());b.oa(b.J);iw(b.J);c.focus()}},500)):this.resize()};function Wkh(a){a.C=a.ea?new Ljh(a.F,a.L,a.O,a.qa()):new Nkh(a.F,a.L,a.O,a.qa());a.Ha(a.C);a.C.render(a.La());P(a.Da("waffle-dataconnector-refresh-sidebar-backdrop"),!1)}
p.resize=function(){if(this.C)if(this.C.ma)$kh(this);else{var a=Xq(this.zb()).height-Xq(this.C.La()).height,b=this.Da("waffle-dataconnector-refresh-sidebar-refresh-widget");Wq(b,a)}};function $kh(a){var b=Xq(a.La()).height-Xq(a.Da("waffle-sidebar-title")).height-10;Jq(a.C.La(),"max-height",b+"px")};function alh(a,b,c){yU.call(this,a,b);var d=this;this.C=c;this.F=new Kl;this.oa(this.F);this.F.wb(this.C.H,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType())e=d.Pb,Bkh(e.qP),0<Tih(e.F).length||e.dispatchEvent("close-sidebar");blh(d);Gkh(d.Pb.qP)});this.D.listen(EG,"show-db-objects-refresh-sidebar",this.H)}v(alh,yU);alh.prototype.Af=function(){return vgb};alh.prototype.wm=function(){return wgb};
function blh(a){var b=Tih(a.C),c=a.Pb;0==b.length?Uih(c.D):(Ekh(c.qP),zuf(c.D),cqe(a.C,b,function(d){a.isDisposed()||c.isDisposed()||Zkh(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new TH(d[0].Rl(),d[0].mf()),Fkh(c.qP),c.D.Gz(d))}))}alh.prototype.H=function(a){var b=this;Ykh(this.Pb);blh(this);zU(this);a.loa&&this.Pb.loa();Mm(function(){b.Pb.La().focus()})};function clh(){Vn.apply(this,arguments)}v(clh,Vn);clh.prototype.C=function(){return alh};clh.prototype.D=function(){return Vkh};Eo("dbrefresh",clh);
