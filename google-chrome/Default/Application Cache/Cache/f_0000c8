qve.prototype.vR=X(1649,function(a){this.C.C.tP(a)});yve.prototype.vR=X(1648,function(a){this.D.vR(a)});N7d.prototype.j7=X(1315,function(){return ri(this,3)});Gbe.prototype.j7=X(1314,function(){return ri(this,3)});Usa.prototype.wr=X(1306,function(){return ri(this,2)});I0d.prototype.wr=X(1305,function(){return ri(this,1)});upa.prototype.ir=X(11,function(){return nh(this,12)});wpa.prototype.ir=X(10,function(){return this.message.ir()});xse.prototype.ir=X(9,function(){return J(this,2)});
Dse.prototype.ir=X(8,function(){return J(this,2)});function nTi(a){MM(a,function(b){b=new (b.H())(a.H,a.eb);KM(a,b);b.setVisible(!0)},"ritzmaestro")}function oTi(a,b){MM(a,function(c){c=c.C(b,this.H,this.jb,this.Ia);KM(this,c);c.setVisible(!0)},"ritzmaestro")}function pTi(a,b){MM(a,function(c){c=c.D(b,this.H,this.jb);KM(this,c);c.setVisible(!0)},"ritzmaestro")}function qTi(a,b){a.D=b}function rTi(a,b){var c=Ld;Md(a,function(d,e){return c(b(d),b(e))})}function sTi(a){C.call(this,a)}v(sTi,C);
sTi.prototype.Hd=function(){return this.message.Hd()};function tTi(a){var b=uTi();vTi(b);return yh(b,3,a)}function vTi(a){a.Pi(1,2,3,4,5,6)}function wTi(a){this.hb=ah(a,-1,0)}v(wTi,dh);wTi.prototype.toBuilder=function(){return new sTi(this)};wTi.prototype.Hd=function(){return nh(this,1)};function uTi(){var a=void 0===a?gh(wTi):a;return new sTi(a)}function xTi(a){C.call(this,a)}v(xTi,C);xTi.prototype.getFunctionName=function(){return this.message.getFunctionName()};
function yTi(a){this.hb=ah(a,-1,0)}v(yTi,dh);yTi.prototype.toBuilder=function(){return new xTi(this)};yTi.prototype.getFunctionName=function(){return nh(this,2)};function zTi(){var a=void 0===a?gh(yTi):a;return new xTi(a)}function ATi(a){C.call(this,a)}v(ATi,C);function BTi(a,b){return Dh(a,1,b)}function CTi(a){this.hb=ah(a,-1,0)}v(CTi,dh);CTi.prototype.toBuilder=function(){return new ATi(this)};function DTi(){var a=void 0===a?gh(CTi):a;return new ATi(a)}
function ETi(a,b){var c=this;this.J=a;this.F=new Uf;this.C=new Map;this.D=new Map;this.H=new Ml(this);this.H.listen(b,"external_data_change",function(){FTi(c);c.F.dispatchEvent(null)});FTi(this)}
function GTi(a,b,c){for(var d=ha(sh(b,1,yTi).Gb()),e=d.next();!e.done;e=d.next()){var f=e.value;ih(f,2);e=f.getFunctionName();var h=a.C.get(e);if(h)if(lh(f,5))a.C.delete(e),a.D.set(e,h);else{h=h.toBuilder();ih(f,3);var k=nh(f,3);yh(h,8,k);ih(f,4)?(f=nh(f,4),yh(h,9,f)):uh(h,9);a.C.set(e,h.build())}else h=a.D.get(e).toBuilder(),ih(f,3),f=nh(f,3),yh(h,8,f),a.C.set(e,h.build()),a.D.delete(e)}a.F.dispatchEvent(null);xk(dp(Vo(a.J.Oe("/editactions"),{data:JSON.parse(b.pb())}),"POST"),c).Re()}
function FTi(a){var b=N().FT()().map(vpa),c=new Map,d=new Map;b=ha(b);for(var e=b.next();!e.done;e=b.next())e=e.value,ih(e,8)?c.set(e.getFunctionName(),e):lh(e,11)||d.set(e.getFunctionName(),e);a.C=c;a.D=d}function HTi(){return T('<div class="waffle-edit-actions-dialog-scroll"><div class="waffle-edit-actions-dialog-actions-row-container"></div><div class="waffle-edit-actions-empty" role="alert">There are no macros</div></div>')}
function ITi(a){return T('<div class="waffle-edit-actions-row"><div class="waffle-edit-actions-row-name"><input class="waffle-edit-actions-name-input jfk-textinput" maxlength="50"/><div class="waffle-edit-actions-shortcut-conflict-message"></div></div><div class="waffle-edit-actions-options"><div class="waffle-edit-actions-row-shortcut-prefix">'+Ar(a.NGa)+'</div><div class="waffle-edit-actions-row-shortcut"><input class="waffle-edit-actions-row-shortcut-input jfk-textinput" maxlength="1"/></div><div class="waffle-edit-actions-row-menu"></div></div></div>')}
;function JTi(a,b,c,d,e){Qv.call(this,void 0,!1,e);var f=this;this.R=a;this.O=Array.from(this.R.C.values());rTi(this.O,function(h){return h.getFunctionName()});this.F=b;this.ea=c;this.C=new Map;this.L=null;this.ma=d;this.H=new gbc("Macro removed","UNDO",function(){return KTi(f)},void 0,this.qa(),"off");this.oa(this.H);ew(this.ea,this.H);Bs(this,(new ys).sf(Fs,!1,!0).set("save","Update",!0))}v(JTi,Qv);
JTi.prototype.Ca=function(){Qv.prototype.Ca.call(this);this.mq=!1;As(this,!1);LTi(this,!1);bs(ws(this),"waffle-edit-actions-dialog-gm");Ns(this,"save");this.setTitle("Manage macros");this.zb().appendChild(xr(HTi));for(var a=this.Da("waffle-edit-actions-dialog-actions-row-container"),b=ha(this.O),c=b.next();!c.done;c=b.next()){c=c.value;var d=new MTi(c,this.F,this.ma);this.Ha(d);this.C.set(c.getFunctionName(),d);d.render(a)}P(this.Da("waffle-edit-actions-empty"),!1);this.H.render();bs(this.H.La(),
"waffle-edit-actions-undo-remove-toast")};function LTi(a,b){Cs(a.D,"save").disabled=!b}JTi.prototype.Ja=function(){var a=this;Qv.prototype.Ja.call(this);NTi(this);this.getHandler().listen(this,"dialogselect",this.xa).listen(this.La(),"keydown",function(b){13==b.keyCode&&"INPUT"==b.target.tagName&&(b.target.setSelectionRange(0,0),b.target.blur(),b.preventDefault());90==b.keyCode&&b.ctrlKey&&KTi(a)});OTi(this)};
function NTi(a){for(var b={},c=ha(a.C.values()),d=c.next();!d.done;b={wQ:b.wQ},d=c.next())b.wQ=d.value,a.getHandler().listen(b.wQ.ea,"action",function(e){return function(){return PTi(a,e.wQ)}}(b)).listen(QTi(b.wQ),"input",function(e){return function(){var f=e.wQ;RTi(f)?mW(f.oM):lW(f.oM,"Must be a number from 0 to 9 or blank.",!0);f=!OTi(a)&&RTi(f);LTi(a,f)}}(b)).listen(STi(b.wQ),"input",function(){a.F.C(29573);LTi(a,!0)})}
function OTi(a){var b=new Map;a=ha(a.C.values());for(var c=a.next();!c.done;c=a.next())c=c.value,b.has(TTi(c))?b.get(TTi(c)).push(c):b.set(TTi(c),[c]);a=!1;c=null;b=ha(b);for(var d=b.next();!d.done;d=b.next()){var e=ha(d.value);d=e.next().value;e=e.next().value;1<e.length&&""!=d?(a=!0,c=d,e.forEach(function(h){h=h.Da("waffle-edit-actions-shortcut-conflict-message");ym(h,"Conflicts with another shortcut");P(h,!0)})):e.forEach(function(h){h=h.Da("waffle-edit-actions-shortcut-conflict-message");P(h,
!1)})}if(a){var f="Can't save conflicting shortcut "+c;setTimeout(function(){return GG(f)})}return a}function PTi(a,b){LTi(a,!0);a.L=b;a.C.delete(b.Aa);P(b.La(),!1);OTi(a);a.H.setVisible(!0);0==a.C.size&&P(a.Da("waffle-edit-actions-empty"),!0);a.La().focus();var c="Macro "+(b.C.getValue()+" was removed, Ctrl-Z to Undo");setTimeout(function(){return GG(c)});a.F.C(29572)}
function KTi(a){if(null!=a.L){var b=a.L;a.C.set(b.Aa,b);P(b.La(),!0);P(a.Da("waffle-edit-actions-empty"),!1);OTi(a);a.L=null;var c="Macro "+(b.C.getValue()+" is restored.");setTimeout(function(){return GG(c)});a.F.C(29577)}}
JTi.prototype.xa=function(a){var b=this;if("cancel"==a.key)this.F.C(29569);else if("save"==a.key){for(var c=ha(this.C.values()),d=c.next();!d.done;d=c.next())if(d=d.value,!RTi(d)||""!=UTi(d)){a.preventDefault();return}OTi(this)?a.preventDefault():(a=VTi(this),GTi(this.R,a,function(){var e=dw(b.ea,"Failed to update macros.",Tl(),!0,0,!0,void 0,!0,["waffle-edit-actions-update-failed"]);bw(e);e.render();e.setVisible(!0)}),this.F.C(29574),setTimeout(function(){return GG("Macros updated")}))}};
function VTi(a){for(var b=DTi(),c=ha(a.O),d=c.next();!d.done;d=c.next()){var e=d.value;d=zTi();var f=!1,h=a.C.get(e.getFunctionName()),k=nh(e,9),l=nh(e,8);h?(k!=TTi(h)&&(k=TTi(h),f=!0),l!=h.C.getValue()&&(l=h.C.getValue(),f=!0)):(vh(d,5,!0),f=!0);f&&(f=nh(e,1),yh(d,1,f),e=e.getFunctionName(),yh(d,2,e),yh(d,3,l),k&&yh(d,4,k),d=d.build(),Ch(b,1,d))}return b.build()}
function MTi(a,b,c,d){S.call(this,d);this.xa=a;this.Ma=nh(a,8);this.Aa=a.getFunctionName();this.J=(a=nh(a,9))?a.split("+"):[];this.D=new wv;this.Ha(this.D);this.L=this.O=null;this.C=new wv;this.Ha(this.C);this.ma=new Uv;this.oa(this.ma);this.Ea=b;this.Ia=c;b=at(vt,"waffle-overflow-menu-material");this.H=new Mt(void 0,void 0,b,this.qa());this.oa(this.H);this.R=new At("Edit script");this.oa(this.R);this.ea=new At("Remove");this.oa(this.ea);this.oM=new kW(this.qa());this.oa(this.oM);this.F=new kW(this.qa());
this.oa(this.F)}v(MTi,S);MTi.prototype.Ca=function(){var a=(yd(this.J)?WTi:this.J.slice(0,this.J.length-1)).join(" + ")+" + ";a=xr(ITi,{NGa:Rp?a.replace(/Ctrl/g,"\u2318").replace(/Alt/g,"Option"):a});this.mb(a)};
MTi.prototype.Ja=function(){var a=this;this.D.Wa(this.Da("waffle-edit-actions-row-shortcut-input"));this.D.setValue(kd(this.J)||"");var b=this.Da("waffle-edit-actions-name-input");this.C.Wa(b);this.C.setValue(this.Ma);this.ma.Wa(b);this.oM.setPosition(3,2);this.oM.render();b=this.D.La();this.oM.Ci(b);nW(this.oM,b);mW(this.oM);this.F.setPosition(0,2);this.F.render();b=this.C.La();this.F.Ci(b);nW(this.F,b);mW(this.F);b=new Sr(this.H.zb(),13);Nt(this.H,b);this.H.vz=!0;this.H.hd(this.R);this.H.hd(this.ea);
b=this.Da("waffle-edit-actions-row-menu");this.H.Wa(b);"black"==Tt()&&bs(b,"waffle-overflow-menu-material-white");this.getHandler().listen(this.R,"action",function(){a.Ia.Ga("macros-editor").kb({scriptId:nh(a.xa,1),filename:nh(a.xa,10)});a.Ea.C(29570)}).listen(this.C.La(),"blur",function(){""==UTi(a)?mW(a.F):lW(a.F,UTi(a),!0)}).listen(this.D.La(),"click",function(){return a.D.La().select()}).listen(QTi(this),"input",function(){return a.Ea.C(29571)});Yr(this.Da("waffle-edit-actions-name-input"),"Macro name");
Yr(this.D.La(),"Numeric shortcut key");Yr(b,"More options button")};function TTi(a){var b=a.D.getValue();return""==b?"":(yd(a.J)?WTi:a.J.slice(0,a.J.length-1)).join("+")+"+"+b}function QTi(a){null==a.O&&(a.O=new Tv(a.D.La()),a.oa(a.O));return a.O}function STi(a){null==a.L&&(a.L=new Tv(a.C.La()),a.oa(a.L));return a.L}function RTi(a){a=a.D.getValue();return""==a||/^\d$/.test(a)}
function UTi(a){a=a.C.getValue();return""==a?"Macro name must be not be empty.":/\r|\n/.test(a)?"Macro name must not contain line-break characters.":""}var WTi=["Ctrl","Alt","Shift"];function XTi(){return T('<div class="waffle-import-custom-function-actions-title-separator"></div><div class="waffle-import-custom-function-actions-dialog-scroll"><div class="waffle-import-custom-functions-row-container"></div></div>')}
function YTi(a){var b=a.Gtc,c=a.fileName;a='<div class="waffle-import-custom-function-row" tabindex="0"><div class="waffle-import-custom-function-name">'+Ar(a.functionName)+'</div><div class="waffle-import-custom-function-metadata"><div class="waffle-import-custom-function-project-name"><span class="waffle-import-custom-function-description-label">';a=a+'Project:</span><span class="function-description-seperator"></span>'+(Ar(b)+'</div><div class="waffle-import-custom-function-file-name"><span class="waffle-import-custom-function-description-label">');
a=a+'File:</span><span class="function-description-seperator"></span>'+(Ar(c)+'</div></div><div class="waffle-import-custom-function-view-script"></div><div class="waffle-import-custom-function-add-function"></div></div>');return T(a)};function ZTi(a,b,c,d){Qv.call(this,void 0,!1,d);this.O=a;this.ea=Array.from(this.O.D.values());rTi(this.ea,function(e){return e.getFunctionName()});this.L=b;this.R=c;this.H=[];this.F=[];this.C=dw(this.R,"Function added.",Tl(),!1,3E3,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);this.oa(this.C);this.Ia=new Wv(this.qa());this.oa(this.Ia);this.ma=new Nn(this.xa,3E3,this);this.oa(this.ma)}v(ZTi,Qv);
ZTi.prototype.Ca=function(){Qv.prototype.Ca.call(this);bs(ws(this),"waffle-import-custom-function-actions-dialog");this.setTitle("Import");var a=this.qa().Ca("DIV","waffle-import-custom-function-title-description",Uw()?"Added functions will appear in the menu under Extensions > Macros":"Added functions will appear in the menu under Tools > Macros");us(this).appendChild(a);this.zb().appendChild(xr(XTi));a=this.Da("waffle-import-custom-functions-row-container");for(var b=ha(this.ea),c=b.next();!c.done;c=
b.next())c=new $Ti(c.value,this.L),this.Ha(c),c.render(a),this.H.push(c);this.C.render();this.C.setVisible(!1);Bs(this,null)};ZTi.prototype.Ja=function(){var a=this;Qv.prototype.Ja.call(this);for(var b={},c=ha(this.H),d=c.next();!d.done;b={Zba:b.Zba},d=c.next())b.Zba=d.value,this.getHandler().listen(b.Zba.D,"action",function(e){return function(){return aUi(a,e.Zba)}}(b));this.getHandler().listen(this,"hide",function(){return a.xa()})};
function aUi(a,b){bUi(b);var c=cUi(b.C);dUi(a,c);b=b.Da("waffle-import-custom-function-add-function");b.setAttribute("tabindex","0");Yr(b,"This function has been added.");b.focus();a.L.C(29576);setTimeout(function(){return a.C.setVisible(!0)})}function cUi(a){var b=zTi();var c=nh(a,1);b=yh(b,1,c);c=a.getFunctionName();b=yh(b,2,c);a=a.getFunctionName();return yh(b,3,a).build()}function dUi(a,b){a.F.push(b);a.ma.start()}
ZTi.prototype.xa=function(){var a=this;if(0<this.F.length){var b=BTi(DTi(),this.F).build();GTi(this.O,b,function(){var c=dw(a.R,"Failed to add function.",Tl(),!1,1E4,!0,void 0,!0,["waffle-import-custom-function-actions-status-toast"]);bw(c);c.render();c.setVisible(!0)});this.F=[]}};function $Ti(a,b,c){S.call(this,c);this.C=a;this.H=b;a=Yv.getInstance();this.D=new wt("Add Function",a,c);this.Ha(this.D);this.F=new wt("Edit Script",a,c);this.Ha(this.F)}v($Ti,S);
$Ti.prototype.Ca=function(){S.prototype.Ca.call(this);var a=xr(YTi,{functionName:this.C.getFunctionName(),Gtc:nh(this.C,2),fileName:nh(this.C,10)});this.mb(a);this.D.render(this.Da("waffle-import-custom-function-add-function"));this.F.render(this.Da("waffle-import-custom-function-view-script"))};
$Ti.prototype.Ja=function(){var a=this;S.prototype.Ja.call(this);this.getHandler().listen(this.F,"action",function(){O("macros-editor").kb({scriptId:nh(a.C,1),filename:nh(a.C,10)});a.H.C(29575)});var b="Function: "+(this.C.getFunctionName()+(", from project: "+(nh(this.C,2)+(", defined in file: "+nh(this.C,10)))));Yr(this.La(),b)};function bUi(a){P(a.D.La(),!1);bs(a.Da("waffle-import-custom-function-add-function"),"waffle-import-custom-function-actions-checkmark")};function eUi(a,b,c,d,e,f){B.call(this);this.C=a;this.functionName=b;this.F=d||null;this.D=void 0!==f?f:null}v(eUi,B);function fUi(a){I(this,a,0,-1,gUi,null)}x(fUi,H);var gUi=[6];p=fUi.prototype;p.V=function(){var a=new D;hUi(this,a);return Y(a)};function hUi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,4);null!=c&&b.Ba(4,c);c=J(a,5);null!=c&&b.Ba(5,c);c=a.qh();0<c.length&&gi(b,6,c,hUi);c=J(a,7);null!=c&&F(b,7,c);c=J(a,9);null!=c&&b.Ba(9,c);c=J(a,10);null!=c&&b.Ba(10,c);c=J(a,11);null!=c&&G(b,11,c);c=J(a,12);null!=c&&G(b,12,c);c=J(a,13);null!=c&&b.Ba(13,c)}
p.Ie=function(){return J(this,1)};p.Rg=function(){return J(this,2)};p.rk=function(a){K(this,2,a)};p.getKey=function(){return J(this,5)};p.qh=function(){return Li(this,fUi,6)};p.hd=function(a,b){return Qi(this,6,a,fUi,b)};p.Oa=function(a){return K(this,7,a)};p.ir=function(){return J(this,13)};function iUi(a){I(this,a,"amep",-1,null,null)}x(iUi,H);iUi.prototype.V=function(){var a=new D;var b=this.Bb();null!=b&&a.va(1,b,hUi);return Y(a)};iUi.messageId="amep";iUi.prototype.Bb=function(){return M(this,fUi,1,1)};iUi.prototype.pe=function(a){return Mi(this,1,a)};iUi.prototype.W5=function(){dQ(this,1)};iUi.prototype.KA=function(){return oi(this,1)};function L7(a){wl.call(this,a)}v(L7,wl);function jUi(a){wl.call(this,"amep");this.D=new iUi(a)}v(jUi,L7);jUi.prototype.C=g("D");function kUi(a){I(this,a,0,-1,null,null)}x(kUi,H);kUi.prototype.V=function(){var a=new D;lUi(this,a);return Y(a)};
function lUi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,4);null!=c&&F(b,4,c);c=J(a,5);null!=c&&b.Ba(5,c);c=J(a,6);null!=c&&b.Ba(6,c);c=J(a,7);null!=c&&b.Ba(7,c);c=J(a,8);null!=c&&F(b,8,c);c=J(a,9);null!=c&&F(b,9,c);c=J(a,10);null!=c&&F(b,10,c);c=J(a,11);null!=c&&b.Ba(11,c);c=J(a,12);null!=c&&F(b,12,c);c=J(a,13);null!=c&&b.Ba(13,c);c=J(a,14);null!=c&&b.Ba(14,c);c=J(a,15);null!=c&&b.Ba(15,c);c=J(a,16);null!=c&&b.Ba(16,c);c=J(a,17);null!=c&&b.Ba(17,
c);c=J(a,18);null!=c&&$h(b,18,c);c=J(a,19);null!=c&&F(b,19,c)}function M7(a){return J(a,2)}kUi.prototype.getName=function(){return J(this,3)};kUi.prototype.Mj=function(){return J(this,13)};function mUi(a,b){this.D=void 0===a?null:a;this.C=(void 0===b?null:b)||null}mUi.prototype.F=g("C");function nUi(a,b){return y(A(),"docs-emgsmw")?null==a.F||null==J(b,18)?!1:a.C===J(b,18):a.D===J(b,1)}function N7(a){return new mUi(J(a,1),J(a,18))};function oUi(a){I(this,a,"der",-1,null,null)}x(oUi,H);oUi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};oUi.messageId="der";oUi.prototype.wr=function(){return ri(this,1)};function pUi(a){I(this,a,"eer",-1,null,null)}x(pUi,H);pUi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};pUi.messageId="eer";pUi.prototype.wr=function(){return ri(this,1)};function qUi(a,b,c){this.C=a;this.F=b;this.D=c}qUi.prototype.getVersionInfo=g("D");function rUi(a,b){this.C=a;this.D=b}rUi.prototype.getVersionInfo=g("D");function sUi(a,b){this.C=a;this.Sd=b}sUi.prototype.getExtension=g("C");sUi.prototype.isEnabled=g("Sd");function tUi(a){Qv.call(this);this.C=a;xs(this,!0);this.Jw(!1);Bs(this,null);As(this,!1)}v(tUi,Qv);tUi.prototype.Ca=function(){Qv.prototype.Ca.call(this);this.C.render(this.zb())};tUi.prototype.Ja=function(){Qv.prototype.Ja.call(this);var a=this.La();Wr(a,"labelledby");Yr(a,"Add-ons");bs(ws(this),"gsm-widget")};function uUi(a,b){var c=new Wi,d=new cNd;if(b){if(J(b,1)){var e=J(b,1);K(d,1,e)}e=ri(b,12);K(d,2,e);oi(b,18)&&(e=J(b,18),K(d,5,e));b=ri(b,19);K(d,6,b)}b=fd(A(),"docs-tcmt");e=!!b;K(d,3,e);e&&K(d,4,b);Mi(c,73,d);return nq(oq(new mq,c),a).build()}function vUi(a){var b=new Wi,c=new cNd;null!=a.D&&K(c,1,a.D);null!=a.C&&K(c,5,a.C);Mi(b,73,c);return nq(oq(new mq,b),90).build()};function wUi(a,b,c){MW.call(this,a);this.D=b;this.F=c;this.D.Oi=!0}v(wUi,MW);p=wUi.prototype;p.Ara=function(){O("macros-extension-store-render").kb()};p.yda=function(a,b,c){a=new mUi(null,a);O("macros-extension-store-install").kb(new qUi(a,String(b),c),vUi(a))};p.zra=function(a,b){a=new mUi(null,a);O("macros-extension-store-uninstall-item").kb(new rUi(a,b),vUi(a))};
p.xMa=function(a){var b=new Jjf,c=this.F(new mUi(null,a));if(!c)return b;a=c.getExtension();c=c.isEnabled();var d=new LW;d.rk("Use in this document");K(d,3,"useInDoc");d.Jb(!!ri(a,4)||!!ri(a,12));d.Oa(c);var e=new LW;e.rk("Help");K(e,3,"help");d=[d,e];ri(a,9)&&(e=new LW,K(e,1,!0),d.push(e),ri(a,8)&&(a=new LW,a.Oa(c),a.rk("Settings"),K(a,3,"settings"),d.push(a)),a=new LW,a.rk("Report an issue"),K(a,3,"reportIssue"),d.push(a));Pi(b,1,d);return b};
p.wMa=function(a,b){var c=new mUi(null,a);a=vUi(c);switch(b){case "help":b=this.F(c);if(!b)break;b=b.getExtension();O("macros-extension-help").kb(M7(b),a);break;case "reportIssue":O("macros-extension-store-report").kb(c,a);break;case "settings":O("macros-extension-store-settings").kb(c,a);Wf(this.D);break;case "useInDoc":O("macros-extension-store-use-in-doc").kb(c,a)}};p.gma=function(){this.D.setVisible(!1)};function xUi(a,b,c){B.call(this);this.D=yUi(a);this.F=b;this.C=c}v(xUi,B);function zUi(a,b,c,d,e){b=new mrf(b,null,e);nrf(b,hd(A(),"docs-gsmd"));a.C&&qrf(b,a.C);qTi(b,c.map(function(f){return f.C}));d&&d.C&&(b.F=d.C);a=hd(A(),"gaia_session_id");a=Zd(a)?NaN:Number(a);isNaN(a)||orf(b,a);return b.build()}function AUi(a,b){var c=new tUi(b);a=new wUi(b,c,a.F);c.oa(a);return c}
function yUi(a){if(a==(Ku(),Hu))return"docs_addon";if(a==(Ku(),Iu))return"sheets_addon";if(a==(Ku(),Ju))return"slides_addon";if(a==(Ku(),i1a))return"forms_addon";throw Error("Unsupported document type for GSM  ["+a+"]");};function BUi(a,b,c,d,e,f){B.call(this);this.D=b;this.F=new xUi(a,d,f);this.C=null}v(BUi,B);function CUi(a){I(this,a,"iar",-1,null,null)}x(CUi,H);CUi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&F(a,3,b);return Y(a)};CUi.messageId="iar";CUi.prototype.wr=function(){return ri(this,1)};function DUi(a,b,c,d){var e=J(a,4)+"-polymorphic-"+(a.Ie()||"");nTa.call(this,e);this.H=a;this.L=rd(b,function(f){return new DUi(f,[],!1)},this);this.Oa(this.isEnabled());this.xa=c;this.ma="boolean"===typeof d?d:!0}v(DUi,nTa);p=DUi.prototype;p.Za=g("H");p.isInstalled=g("ma");p.kb=function(){O("macros-polymorphic-item").kb(this)};p.isEnabled=function(){return this.L&&(0<this.L.length?!0:!!ri(this.H,7))};p.getLabel=function(){return this.H.Rg()||J(this.H,10)||""};function EUi(){wl.call(this,"Zl")}v(EUi,wl);function FUi(){Il.call(this);this.C={};this.C[1]={};this.C[0]={};this.D=new mu(this);this.oa(this.D);this.D.subscribe(O("macros-polymorphic-item"),"action",this.F)}v(FUi,Il);FUi.prototype.F=function(a){a.xa||0<a.L.length?this.dispatchEvent(new EUi(a)):(a=new eUi(J(a.Za(),4),J(a.Za(),3),void 0,J(a.Za(),9)||void 0,void 0,a.Za().ir()||void 0),O("macros-exec").kb(a))};function GUi(a){I(this,a,"ger",-1,HUi,null)}x(GUi,H);var HUi=[1];GUi.prototype.V=function(){var a=new D;var b=this.hia();0<b.length&&gi(a,1,b,lUi);return Y(a)};GUi.messageId="ger";GUi.prototype.hia=function(){return Li(this,kUi,1)};function IUi(a){I(this,a,0,-1,null,null)}x(IUi,H);IUi.prototype.V=function(){var a=new D;JUi(this,a);return Y(a)};function JUi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c)}IUi.prototype.getName=function(){return J(this,1)};function KUi(a){I(this,a,0,-1,LUi,null)}x(KUi,H);var LUi=[4];p=KUi.prototype;p.V=function(){var a=new D;MUi(this,a);return Y(a)};function MUi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=Li(a,IUi,4);0<c.length&&gi(b,4,c,JUi)}p.getId=function(){return J(this,1)};p.rc=function(a){return K(this,1,a)};p.getName=function(){return J(this,2)};p.Od=function(){return J(this,3)};p.Di=function(a){return K(this,3,a)};function NUi(a){I(this,a,"llr",-1,OUi,null)}x(NUi,H);var OUi=[2];NUi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=Li(this,KUi,2);0<b.length&&gi(a,2,b,MUi);return Y(a)};NUi.messageId="llr";NUi.prototype.wr=function(){return ri(this,1)};function PUi(a){I(this,a,"rar",-1,null,null)}x(PUi,H);PUi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);return Y(a)};PUi.messageId="rar";PUi.prototype.wr=function(){return ri(this,1)};function QUi(a){I(this,a,"uer",-1,null,null)}x(QUi,H);QUi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};QUi.messageId="uer";QUi.prototype.wr=function(){return ri(this,1)};function RUi(a,b,c,d){B.call(this);this.D=a;this.F=c;this.C=d||new SUi}v(RUi,B);p=RUi.prototype;p.Y2a=function(a,b,c,d,e,f,h){a=["ruid",Ha({}),this.C.C,this.D,this.C.F,a,this.C.ma,b,this.C.D,c,this.C.L,e,this.C.O,f,this.C.J,h];a=bp(wk(dp(O7(this,this.C.xa),"POST"),2),a).Ir();d&&(yk(a,w(this.Cvb,this,d)),xk(a,w(this.w6b,this,d)));a.Re()};p.cancel=function(a){a=["ruid",Ha({}),this.C.C,this.D,this.C.H,a];bp(wk(dp(O7(this,this.C.R),"POST"),2),a).Ir().Re()};
function TUi(a,b){var c=["ruid",Ha({}),a.C.C,a.D];c=bp(wk(O7(a,a.C.Aa),2),c);b&&(yk(c,w(a.f7b,a,b)),xk(c,w(a.e7b,a,b)));c.Re()}p.Cvb=function(a,b){b=b.we();b=new CUi(b[0]);a(b)};p.w6b=function(a){var b=new CUi;K(b,1,!1);a(b)};p.f7b=function(a,b){b=b.we();b=new NUi(b[0]);a(b)};p.e7b=function(a){var b=new NUi;K(b,1,!1);a(b)};p.Dvb=function(a,b){b=b.we();b=new PUi(b[0]);a(b)};p.Ncc=function(a){var b=new PUi;K(b,1,!1);a(b)};
function UUi(a,b){var c=["ruid",Ha({}),a.C.C,a.D];xk(yk(bp(wk(O7(a,"/scripts/getitems"),1),c),w(a.E4b,a,b)),za).Re()}p.E4b=function(a,b){b=b.we();b=new GUi(b[0]);a(b)};function VUi(a,b,c,d){function e(h,k){k=k.we();k=new QUi(k[0]);h(k)}var f=["ruid",Ha({}),a.C.C,a.D];null!=b.D&&f.push("storeitemid",b.D);null!=b.C&&f.push("appid",b.C);d&&f.push("versioninfo",d);b=bp(dp(O7(a,"/scripts/uninstallitem"),"POST"),f).Ir();c&&(yk(b,w(e,a,c)),a=new QUi,K(a,1,!1),xk(b,Ja(c,a)));b.Re()}
p.vUa=function(a,b,c,d,e,f){a=["ruid",Ha({}),this.C.C,this.D,this.C.D,e,"extensionid",a,"justInstalled",d];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);f&&a.push("versioninfo",f);b=bp(wk(dp(O7(this,"/scripts/enableitem"),"POST"),1),a).Ir();c&&(yk(b,w(this.N2b,this,c)),xk(b,w(this.M2b,this,c)));b.Re()};p.N2b=function(a,b){b=b.we();b=new pUi(b[0]);a(b)};p.M2b=function(a){var b=new pUi;K(b,1,!1);a(b)};
p.aJb=function(a,b,c,d){a=["ruid",Ha({}),this.C.C,this.D,this.C.D,d,"extensionid",a];null!=b.D&&a.push("cwsid",b.D);null!=b.C&&a.push("appid",b.C);b=bp(wk(dp(O7(this,"/scripts/disableitem"),"POST"),1),a).Ir();c&&(yk(b,w(this.o1b,this,c)),xk(b,w(this.n1b,this,c)));b.Re()};p.o1b=function(a,b){b=b.we();b=new oUi(b[0]);a(b)};p.n1b=function(a){var b=new oUi;K(b,1,!1);a(b)};function O7(a,b){return cp(a.F.Oe(b)).setTimeout(4E4)}
function SUi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,R,Q){B.call(this);this.C=a||"id";this.F=c||"lib";this.ma=d||"func";this.D=e||"ctx";this.H=f||"pid";this.L=L||"eei";this.O=R||"usit";this.J=void 0!==Q?Q:"did";this.ea=h||"ca";this.xa=k||"/scripts/invoke";this.R=l||"/scripts/cancel";this.Aa=n||"/scripts/libraries";this.Ea=q||"/scripts/resume";this.Ia=u||"/scripts/uiready"}v(SUi,B);function WUi(a,b,c,d,e,f,h,k,l,n,q,t){B.call(this);var u=this;this.Ia=n?nac(n):void 0;this.Ea=n?oac(n):void 0;this.ma=a;this.C=d;this.Ma=e;this.ea=b;this.L=f;this.F=h;this.J=k;this.D=[];this.H=l;this.O=new Vs("mae-show_addons_menu_promo");Ws(c,this.O,"mae-show_addons_menu_promo");this.Aa=q||null;this.xa=t||null;this.R=new BUi(this.ma,this.ea,this,function(z){if(z=u.getExtension(z)){var E=2==u.H?!1:1==u.H?!(!ri(z,10)||!ri(z,9)):!0;z=new sUi(z,E)}else z=void 0;return z},this.Ea,this.Ia);this.oa(this.R);
O("macros-extension-store-install").Ab(zp,this.g3b,this);O("macros-extension-store-install").Oa(!0);O("macros-extension-store-render").Ab(zp,this.h3b,this);O("macros-extension-store-render").Oa(!0);O("macros-extension-store-report").Ab(zp,this.i3b,this);O("macros-extension-store-report").Oa(!0);O("macros-extension-store-settings").Ab(zp,this.j3b,this);O("macros-extension-store-settings").Oa(!0);O("macros-extension-store-uninstall-item").Ab(zp,this.k3b,this);O("macros-extension-store-uninstall-item").Oa(!0);
O("macros-extension-store-use-in-doc").Ab(zp,this.l3b,this);O("macros-extension-store-use-in-doc").Oa(!0)}v(WUi,B);p=WUi.prototype;p.h3b=function(){XUi(this)};p.g3b=function(a){a=a.data;YUi(this,a.F,a.C,a.getVersionInfo())};p.i3b=function(a){a=this.getExtension(a.data);var b=N7(a);this.A7a(b,M7(a),a.getName(),J(a,6)||void 0,J(a,11)||void 0)};p.j3b=function(a){a=this.getExtension(a.data);ZUi(this,M7(a))};p.k3b=function(a){a=a.data;var b=this.getExtension(a.C),c=b&&M7(b);b=N7(b);$Ui(this,c,b,za,a.getVersionInfo())};
p.l3b=function(a){var b=this.getExtension(a.data);a=N7(b);ri(b,4)||ri(b,12)?aVi(this,M7(b),a,function(c){c&&(K(b,4,!1),K(b,12,!1))}):bVi(this,M7(b),a,function(c){c&&K(b,4,!0)})};p.DV=function(a){var b=cVi(this,!1),c=this.R;var d=c.F;a=zUi(d,d.D,b,a,!1);d=AUi(d,a);c.C=d;d=c.C;c.D.Ah(d);d.setVisible(!0);dVi(this)};function cVi(a,b){return(void 0===b?0:b)?a.D.map(function(c){return N7(c)}):a.D.filter(function(c){return ri(c,10)&&ri(c,9)}).map(function(c){return N7(c)})}
function ZUi(a,b){eVi(a.C);var c=w(function(d,e){this.C.vO();d&&d(e)},a,void 0);dqe(a.L.C,w(a.F.Y2a,a.F,b,"doSettings",a.J().getState()||void 0,c))}function bVi(a,b,c,d){eVi(a.C);dqe(a.L.C,w(a.F.vUa,a.F,b,c,w(function(e,f){if(f.wr()){var h=a.getExtension(c);h&&K(h,4,!0);XUi(a)}a.C.vO();e&&e(f.wr())},a,d),void 0,a.J().getState()||void 0))}
function aVi(a,b,c,d){eVi(a.C);dqe(a.L.C,w(a.F.aJb,a.F,b,c,w(function(e,f){if(f.wr()){O("macros-extension-disabled").kb(b);var h=a.getExtension(c);h&&(K(h,4,!1),K(h,12,!1));XUi(a)}a.C.vO();e&&e(f.wr())},a,d),a.J().getState()||void 0))}function $Ui(a,b,c,d,e){VUi(a.F,c,w(function(f,h){if(h.wr()&&b){O("macros-extension-disabled").kb(b);var k=a.D.findIndex(function(l){return nUi(c,l)});-1!=k&&Ed(a.D,k);(k=fVi(a.C))&&pe(k.J,b)}XUi(a,function(){return f(h.wr())})},a,d),e)}
p.A7a=function(a,b,c,d,e){e?qr(e):(gVi(this.C,w(function(f,h){var k=this.F,l=w(this.C.ayc,this.C,c,h,d),n=w(this.C.$xc,this.C);f=["ruid",Ha({}),k.C.C,k.D,k.C.F,b,"issuedesc",f,"includeUserInfo",h];null!=a.D&&f.push("storeitemid",a.D);null!=a.C&&f.push("appid",a.C);bp(xk(yk(wk(dp(O7(k,"/scripts/sendissuereport"),"POST"),1),Ce(l)),Ce(n)),f).Ir().Re()},this),c),dVi(this))};
function YUi(a,b,c,d){eVi(a.C);dqe(a.L.C,w(a.F.vUa,a.F,b,c,function(e){a.C.vO();e.wr()?XUi(a):(e=Nu("Unable to install add-on","warning",!0),a.C.C.C.postMessage(e),e.getId(),hVi(a))},!0,a.J().getState()||void 0,d))}function XUi(a,b){b=void 0===b?za:b;UUi(a.F,w(function(c,d){d=d.hia();zd(this.D);d=ha(d);for(var e=d.next();!e.done;e=d.next())this.D.push(e.value);iVi(this);hVi(this);c()},a,b))}
function iVi(a){var b=a.Ma,c=Gd(a.D);b.C[1]={};b.C[0]={};for(var d=0;d<c.length;++d){var e=c[d],f=M7(e),h=new fUi,k=String(Ha(h));K(h,1,k);h.rk(e.getName());k=M7(e);K(h,4,k);h.Oa(!0);k=e.getName();K(h,10,k);K(h,11,1);k=!(!ri(e,10)&&!ri(e,9));e=new DUi(h,[],!0,k,ri(e,19)||!1);e.setVisible(!0);b.C[ti(e.Za(),11,0)][f]=e}b.dispatchEvent("Xl");if(b=a.C.O)if(yd(a.D))!a.O.getValue()&&O("macros-extension-menu-promo").isEnabled()&&(a=a.ma,Ok(b.J.F,"mae-promo-id")||(a=new jVi(a),a.render(),c=new At(""),c.rc("mae-promo-id"),
c.Ob("script-promo-menu-item"),c.setContent(a.getElement()),qu(b.O,c,O("macros-extension-menu-promo"),void 0,void 0,uUi(3)),b.C.Rc(),b.J.Rc(),kVi(b.J,c)),lVi(b));else{c=Gd(a.D);if(b.F){Md(c,b.Ma);f=new Nk;vza(f,b.C.F);b.J.Rc();b.C.Rc();d=[];for(e=0;e<c.length;++e){k=c[e];var l=M7(k),n=!(!ri(k,10)&&!ri(k,9));d.push(l);h=f.get(l);var q=ri(k,19);if(h)l=h.Bb(),n&&!q&&(n=l.Bc(0),q="addon-menu-install-"+M7(k),n&&n.getId()==q&&(l.Hn(0).dispose(),2==l.kc()&&(l.Bc(0),l.Hn(0).dispose())));else{h=new Lt("");
h.rc(l);h.Oa(2==b.R?!1:1==b.R?!!(k&&ri(k,10)&&ri(k,9)):!0);var t=new Ft;n||q||mVi(b,t,k);nVi(b,t,l,[],k);h.pe(t)}k=k.getName();n=lm("span");n.appendChild(mm(k));h.setContent(n);oVi(h.Bb().La(),!0);kVi(b.C,h)}for(e=0;e<b.ea.length;++e)kVi(b.C,f.get(b.ea[e]));if(b.L)for(f=f.Ve(),e=0;e<f.length;++e)if(0>d.indexOf(f[e])&&0>b.ea.indexOf(f[e])&&(h=b.xa[f[e]])){for(k=0;k<h.length;++k)b.L.vR(h[k]);delete b.xa[f[e]]}O("macros-manage-extensions").Oa(!!c.length);lVi(b)}a.xa&&a.xa.C(!!a.D.length)}}
function hVi(a){var b=fVi(a.C);if(b){var c=Gd(a.D),d=a.H;b.C=[];for(var e=0;e<c.length;e++){var f=c[e];if(ri(f,12)||ri(f,4))Yea(b.C,f,b.CKb),b.H&&!ri(f,12)&&(b.H=!1)}O("macros-addon-sidebar-focus").Oa(0<b.C.length);b.R=0==d;b.ea=!0;b.L=1==b.C.length&&null!=pVi(b);b.yb()&&qVi(b);a.Aa&&a.Aa.C(0<b.C.length)}}p.getExtension=function(a){return this.D.find(function(b){return nUi(a,b)})};function rVi(a,b){return a.D.find(function(c){return M7(c)===b})}
function dVi(a){if(!a.O.getValue()&&(a.O.setValue(!0),yd(a.D))){var b=a.C.O;if(b){var c=em("docs-menu-superscript",b.D.getElement());c&&Zq(c,0);b.J.Rc();lVi(b);iVi(a)}}};function sVi(a,b,c,d,e,f,h,k,l,n,q,t,u){this.L=a;this.F=b;this.R=c;this.ea=d;this.H=e;this.Aa=h;this.D=k;this.C=l;this.O=n;this.ma=q;this.xa=t;this.J=u}function tVi(a,b){a=a.R;if(b){a=new gl(a);var c=a.F;c+=Td(c,"/")?"":"/";Td(c,"/start/")&&(c=c.replace("start/",""));c+=oha("d/%s/edit",b);kl(a,c);a=a.toString()}return a};function uVi(a){I(this,a,0,-1,null,null)}x(uVi,H);uVi.prototype.V=function(){var a=new D;vVi(this,a);return Y(a)};function vVi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&Zh(b,3,c);c=J(a,4);null!=c&&b.Ba(4,c)};function wVi(a){I(this,a,0,-1,null,null)}x(wVi,H);wVi.prototype.V=function(){var a=new D;xVi(this,a);return Y(a)};function xVi(a,b){var c=J(a,1);null!=c&&b.Ba(1,c);c=J(a,2);null!=c&&b.Ba(2,c);c=J(a,3);null!=c&&b.Ba(3,c);c=J(a,5);null!=c&&$h(b,5,c);c=J(a,6);null!=c&&G(b,6,c);c=M(a,uVi,7);null!=c&&b.va(7,c,vVi);c=J(a,8);null!=c&&G(b,8,c);c=J(a,9);null!=c&&$h(b,9,c);c=J(a,10);null!=c&&$h(b,10,c);c=J(a,11);null!=c&&$h(b,11,c)}wVi.prototype.Pf=function(){return J(this,3)};function yVi(a){I(this,a,"paep",-1,null,null)}x(yVi,H);yVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=M(this,wVi,3);null!=b&&a.va(3,b,xVi);b=J(this,4);null!=b&&F(a,4,b);return Y(a)};yVi.messageId="paep";yVi.prototype.getUrl=function(){return J(this,1)};yVi.prototype.Jf=function(){return J(this,2)};function zVi(a){wl.call(this,"paep");this.D=new yVi(a)}v(zVi,L7);zVi.prototype.C=g("D");function AVi(a){I(this,a,0,-1,null,null)}x(AVi,H);AVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&F(a,3,b);b=J(this,4);null!=b&&a.Ba(4,b);return Y(a)};AVi.prototype.nj=function(){return J(this,2)};function BVi(a){I(this,a,"rfep",-1,null,null)}x(BVi,H);BVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,4);null!=b&&a.Ba(4,b);b=J(this,5);null!=b&&a.Ba(5,b);return Y(a)};BVi.messageId="rfep";BVi.prototype.getFunctionName=function(){return J(this,2)};BVi.prototype.ir=function(){return J(this,5)};function CVi(a){wl.call(this,"rfep");this.D=new BVi(a)}v(CVi,L7);CVi.prototype.C=g("D");function DVi(a){I(this,a,"sfep",-1,null,null)}x(DVi,H);DVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&G(a,2,b);b=J(this,3);null!=b&&a.Ba(3,b);return Y(a)};DVi.messageId="sfep";DVi.prototype.rF=function(){return J(this,2)};DVi.prototype.Jf=function(){return J(this,3)};function EVi(a){wl.call(this,"sfep");this.D=new DVi(a)}v(EVi,L7);EVi.prototype.C=g("D");function FVi(a){I(this,a,"step",-1,null,null)}x(FVi,H);FVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&F(a,2,b);return Y(a)};FVi.messageId="step";FVi.prototype.j7=function(){return ri(this,2)};function GVi(a){wl.call(this,"step");this.D=new FVi(a)}v(GVi,L7);GVi.prototype.C=g("D");function HVi(a){I(this,a,"scpep",-1,null,null)}x(HVi,H);HVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&F(a,1,b);return Y(a)};HVi.messageId="scpep";function IVi(a){wl.call(this,"scpep");this.D=new HVi(a)}v(IVi,L7);IVi.prototype.C=g("D");function JVi(a){I(this,a,"saep",-1,null,null)}x(JVi,H);JVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ka(4,b);b=J(this,5);null!=b&&a.Ka(5,b);b=J(this,6);null!=b&&G(a,6,b);b=J(this,7);null!=b&&a.Ba(7,b);b=J(this,8);null!=b&&F(a,8,b);b=M(this,qS,9);null!=b&&a.va(9,b,Pve);return Y(a)};JVi.messageId="saep";p=JVi.prototype;p.getTitle=function(){return J(this,2)};
p.setTitle=function(a){return K(this,2,a)};p.getWidth=function(){return J(this,4)};p.setWidth=function(a){return K(this,4,a)};p.getHeight=function(){return J(this,5)};p.setHeight=function(a){return K(this,5,a)};p.Tk=function(){return ti(this,6,0)};p.Qp=function(a){return K(this,6,a)};p.Wv=function(){return oi(this,6)};function KVi(a){wl.call(this,"saep");this.D=new JVi(a)}v(KVi,L7);KVi.prototype.C=g("D");function LVi(a){I(this,a,"snep",-1,null,null)}x(LVi,H);LVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&G(a,1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ua(4,b);return Y(a)};LVi.messageId="snep";p=LVi.prototype;p.getType=function(){return ti(this,1,0)};p.setType=function(a){return K(this,1,a)};p.clearType=function(){return Ai(this,1)};p.hasType=function(){return oi(this,1)};p.getText=function(){return J(this,2)};
p.hasText=function(){return oi(this,2)};p.getTitle=function(){return J(this,3)};p.setTitle=function(a){return K(this,3,a)};function MVi(a){wl.call(this,"snep");this.D=new LVi(a)}v(MVi,L7);MVi.prototype.C=g("D");function NVi(a){I(this,a,"spep",-1,OVi,null)}x(NVi,H);var OVi=[4];NVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);0<b.length&&ei(a,4,b);b=J(this,5);null!=b&&F(a,5,b);b=J(this,6);null!=b&&F(a,6,b);b=J(this,7);null!=b&&a.Ba(7,b);return Y(a)};NVi.messageId="spep";NVi.prototype.getTitle=function(){return J(this,2)};NVi.prototype.setTitle=function(a){return K(this,2,a)};
NVi.prototype.sf=function(a,b){return Ji(this,4,a,b)};function PVi(a){wl.call(this,"spep");this.D=new NVi(a)}v(PVi,L7);PVi.prototype.C=g("D");function QVi(a){I(this,a,"stbep",-1,null,null)}x(QVi,H);QVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);b=J(this,3);null!=b&&a.Ba(3,b);b=J(this,4);null!=b&&a.Ba(4,b);b=J(this,5);null!=b&&a.Ba(5,b);b=J(this,6);null!=b&&a.Ba(6,b);return Y(a)};QVi.messageId="stbep";p=QVi.prototype;p.getFunctionName=function(){return J(this,2)};p.Rg=function(){return J(this,3)};p.rk=function(a){K(this,3,a)};p.getUrl=function(){return J(this,5)};
p.ir=function(){return J(this,6)};function RVi(a){wl.call(this,"stbep");this.D=new QVi(a)}v(RVi,L7);RVi.prototype.C=g("D");function SVi(a){I(this,a,"sttep",-1,null,null)}x(SVi,H);SVi.prototype.V=function(){var a=new D;var b=J(this,1);null!=b&&a.Ba(1,b);b=J(this,2);null!=b&&a.Ba(2,b);return Y(a)};SVi.messageId="sttep";SVi.prototype.getText=function(){return J(this,1)};SVi.prototype.hasText=function(){return oi(this,1)};SVi.prototype.lk=function(){return J(this,2)};SVi.prototype.Yd=function(a){K(this,2,a)};function TVi(a){wl.call(this,"sttep");this.D=new SVi(a)}v(TVi,L7);TVi.prototype.C=g("D");function UVi(){Il.call(this);var a=this;this.C=null;this.D=function(b){switch(b[0]){case "amep":b=new jUi(b);a.dispatchEvent(b);break;case "paep":b=new zVi(b);a.dispatchEvent(b);break;case "rfep":b=new CVi(b);a.dispatchEvent(b);break;case "sfep":b=new EVi(b);a.dispatchEvent(b);break;case "step":b=new GVi(b);a.dispatchEvent(b);break;case "saep":b=new KVi(b);a.dispatchEvent(b);break;case "snep":b=new MVi(b);a.dispatchEvent(b);break;case "spep":b=new PVi(b);a.dispatchEvent(b);break;case "stbep":b=new RVi(b);
a.dispatchEvent(b);break;case "sttep":b=new TVi(b);a.dispatchEvent(b);break;case "scpep":b=new IVi(b),a.dispatchEvent(b)}}}v(UVi,Il);UVi.prototype.bind=function(a){this.C=a;this.C.subscribe("13",this.D)};UVi.prototype.Na=function(){this.C&&this.C.unsubscribe("13",this.D);Il.prototype.Na.call(this)};function VVi(a,b){Il.call(this);this.D=new Ml(this);this.oa(this.D);this.C={};this.F=a;this.H=b}v(VVi,Il);p=VVi.prototype;p.start=function(){this.D.listen(this.H,"sfep",w(this.bOa,this));this.D.listen(this.H,"step",w(this.Gvb,this))};function WVi(a,b,c,d){var e=void 0;e=void 0===e?za:e;d=void 0===d?za:d;d=w(a.Fvb,a,b,e,d);a=a.F;b=["ruid",Ha({}),a.C.C,a.D,a.C.H,b,a.C.ea,c];b=bp(wk(dp(O7(a,a.C.Ea),"POST"),2),b).Ir();d&&(yk(b,w(a.Dvb,a,d)),xk(b,w(a.Ncc,a,d)));b.Re()}
p.Evb=function(a,b,c,d,e,f){f.wr()?(a=J(f,2),this.C[a]=new XVi(a,b,d,e),c(a,xi(f,3,!1))):(b=new DVi,K(b,2,6),e(b))};p.Fvb=function(a,b,c,d){d.wr()?b():(c(),b=new DVi,K(b,1,a),K(b,2,6),this.bOa(new EVi(b.Gb())))};p.Gvb=function(a){a=a.C();var b=J(a,1);if(le(this.C,b)){var c=rfa(this.C,b);(0,c.Hvb)(a);c.dispose();pe(this.C,b)}};p.bOa=function(a){a=a.C();var b=J(a,1);if(le(this.C,b)){var c=rfa(this.C,b);(0,c.QKb)(a);c.dispose();pe(this.C,b)}a="Google Apps Script: "+a.Jf();window.console.log(a)};
p.Na=function(){Xf(this.C);Il.prototype.Na.call(this)};function XVi(a,b,c,d){B.call(this);this.C=b;this.Hvb=c;this.QKb=d}v(XVi,B);XVi.prototype.getFunctionName=g("C");function YVi(a){var b=a.iL,c=a.id,d=a.ojc,e=a.bba,f=a.dHb,h=a.FY,k=a.ova;return T('<div class="'+U(a.Es)+'" aria-labelledby="title'+U(c)+'" tabindex="0"'+(b?' role="complementary"':' role="region"')+'><div class="'+U(d)+'"><div class="'+U(e)+'" id="title'+U(c)+'"></div><div class="'+U(f)+'" tabindex="0" title="'+U("Close sidebar")+'" aria-label="'+U("Close sidebar")+'" role="button">'+$v(k)+'</div></div><div class="'+U(h)+'"></div></div>')}
function ZVi(a){a=a.caption;return T('<div class="'+U("docs-script-button-bar-text")+" "+U("docs-titlebar-button")+" "+U("goog-inline-block")+'" tabindex="0">'+Ar(a)+"</div>")}function $Vi(a){a=a.text;return T('<div class="'+U("docs-script-button-bar-bubble-content")+'">'+Ar(a)+"</div>")}
function aWi(a){var b=a.iconName,c=a.title;a=a.description;return T('<div class="'+U("script-promo-menu-item-content")+'"><div class="'+U("script-promo-menu-item-icon")+'" aria-hidden="true"><img src="//ssl.gstatic.com/docs/common/'+U(b)+'.svg"/></div><div class="'+U("script-promo-menu-item-text")+'"><div class="'+U("script-promo-menu-item-title")+'">'+Ar(c)+'</div><div class="'+U("script-promo-menu-item-description")+'">'+Ar(a)+"</div></div></div>")}
function bWi(a){var b=a.functionName;a=a.RFa;return T('<div class="'+U("func-entry")+'" aria-checked="false" role="radio" tabindex="-1"><div class="'+U("goog-inline-block")+" "+U("func-entry-rb")+'">&nbsp;</div><div class="'+U("goog-inline-block")+" "+U("func-entry-func")+'">'+Ar(b)+'</div><div class="'+U("goog-inline-block")+" "+U("func-entry-lib")+'">'+Ar(a)+"</div></div>")}
function cWi(a){var b=a.ids,c=a.description;a=a.Wkc;var d='<div class="'+U("script-help-dialog-content")+'"><div class="'+U("script-help-dialog-content-left")+" "+U("goog-inline-block")+(a?" "+U("script-help-dialog-content-left-gsm-onhold")+" ":"")+'">';a?(d+='<div class="'+U("script-help-dialog-content-section")+" "+U("script-help-dialog-content-section-gsm-onhold")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">'+T('<div class="'+(U("script-help-dialog-content-title-caution-icon")+
'"><svg width="24px" height="24px" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path d="M11,15 L13,15 L13,17 L11,17 L11,15 Z M11,7 L13,7 L13,13 L11,13 L11,7 Z M11.99,2 C6.47,2 2,6.48 2,12 C2,17.52 6.47,22 11.99,22 C17.52,22 22,17.52 22,12 C22,6.48 17.52,2 11.99,2 Z M12,20 C7.58,20 4,16.42 4,12 C4,7.58 7.58,4 12,4 C16.42,4 20,7.58 20,12 C20,16.42 16.42,20 12,20 Z" id="path-1"></path></defs><g id="caution" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="alert/error_outline_24px"><mask id="mask-2" fill="white"><use xlink:href="#path-1"></use></mask><g id="ic_error_outline_24px" fill-rule="nonzero"></g><g id="_c/Red/600" mask="url(#mask-2)" fill="#D93025" fill-rule="evenodd"><rect id="swatch" x="0" y="0" width="24" height="24"></rect></g></g></g></svg></div>'))+
"<span>",d+="Add-on not available in \r\n G Suite Marketplace</span></div><div>The developer of this add-on has not accepted the terms and conditions of G Suite Marketplace.</div></div>"):(d+='<div class="'+U("script-help-dialog-content-section")+'" tabindex="0"><div class="'+U("script-help-dialog-content-title")+'">',d=d+"Getting started</div><div>"+(Ar(c)+"</div></div>"));d+='</div><div id="'+U(b.jca)+'" class="'+U("script-help-dialog-buttons")+" "+U("goog-inline-block")+'"></div></div>';return T(d)}
function dWi(a){var b=a.BKb;a='<p class="'+U("script-reportissue-dialog-description-label")+'" tabindex="0">';var c="Describe the issue for the creators of <strong>"+(Ar(b)+"</strong>:");a=a+c+('</p><textarea class="'+U("jfk-textinput")+" "+U("script-reportissue-dialog-description")+'"></textarea><p class="'+U("script-reportissue-dialog-disclaimer")+'" tabindex="0">');a=a+'Only this description will be sent, no information from your open document.</p><div class="'+(U("script-reportissue-dialog-nonanonymous")+
'" tabindex="0"><div class="'+U("script-reportissue-dialog-nonanonymous-control")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-checkbox")+" "+U("jfk-checkbox")+'"></div></div><div class="'+U("script-reportissue-dialog-nonanonymous-label")+" "+U("goog-inline-block")+'"><div class="'+U("script-reportissue-dialog-nonanonymous-optional-text")+" "+U("goog-inline-block")+'">');a+="(Optional)</div> ";b="Include your name and email address so the creators of <strong>"+
(Ar(b)+" </strong>can follow up.");a=a+b+"</div></div>";return T(a)}
function eWi(a,b){a=a||{};a=a.qc;var c='<div class="'+U("func-actions")+'">';c+=Cu({id:"func-action-new",content:Fr("New"),style:0},b);c+=Cu({id:"func-action-run",content:Fr("Run"),style:0,Jd:"jfk-button-collapse-right"},b);c+=Cu({id:"func-action-edit",content:Fr("Edit"),style:0,Jd:"jfk-button-collapse-left"},b);c+=Cu({id:"func-action-reload",content:Fr(""+$v(a?"docs-icon-img docs-icon-reload-rtl":"docs-icon-img docs-icon-reload")),style:0,width:1,title:"Reload"},b);c+='</div><div class="'+U("func-header")+
'"><div class="'+U("func-header-rb")+" "+U("goog-inline-block")+'"></div><div class="'+U("func-header-func")+" "+U("goog-inline-block")+'">';c=c+'Function</div><div class="'+(U("func-header-lib")+" "+U("goog-inline-block")+'">');c=c+'Script</div></div><div class="'+(U("func-entries")+'" role="radiogroup" tabindex="0"></div>');return T(c)}function fWi(){var a='<div class="'+U("func-loading")+'">';return T(a+"Fetching scripts\u2026</div>")}
function gWi(){var a='<div class="'+U("func-none")+'">';return T(a+"No scripts found</div>")};function hWi(){}v(hWi,$s);hWi.prototype.jc=m("func-entry");hWi.prototype.Ug=m(!1);hWi.prototype.Ca=function(a){return xr(bWi,{functionName:a.getFunctionName(),RFa:a.cmc},void 0,a.qa())};Ca(hWi);function iWi(a,b,c,d,e,f){ct.call(this,null,d||hWi.getInstance(),e);this.L3a=a;this.D=void 0!==f?f:null;this.cmc=b;this.C=c;this.Lf(16,!0);this.Lf(32,!0);nt(this,16,!0);ft(this,16,!1)}v(iWi,ct);iWi.prototype.Pp=function(a){ct.prototype.Pp.call(this,a);a&&this.getElement()&&this.getElement().focus()};iWi.prototype.ir=g("D");iWi.prototype.getFunctionName=g("C");iWi.prototype.wc=function(a){ct.prototype.wc.call(this,a);this.Jb(a);this.getElement()&&zm(this.getElement(),a)};function jWi(a,b){Qv.call(this,void 0,void 0,a);this.O=b||!1;this.Os=new i_a;this.oa(this.Os);this.Be=new Xs;this.oa(this.Be);this.H=new Du("");this.oa(this.H);this.C=new Du("");this.oa(this.C);this.F=new Du("");this.oa(this.F);this.L=new Du("");this.oa(this.L);a=new ys(a);a.set("close","Close",!1,!0);xs(this,!1);Bs(this,a);this.setTitle("Script manager")}v(jWi,Qv);p=jWi.prototype;
p.reset=function(a){this.Os.clear();this.qd(!0);0===a?(a=xr(fWi,{},void 0,this.qa()),a=new ct(a),a.Lf(32,!1),this.Ha(a,!0)):1===a&&(a=xr(gWi,{},void 0,this.qa()),a=new ct(a),a.Lf(32,!1),this.Ha(a,!0))};p.focus=function(){if(this.yb()&&0<this.Os.oh()){var a=this.Os.qf();a&&a.Pp(!0)}else Qv.prototype.focus.call(this)};p.qd=function(a){a=Qv.prototype.qd.call(this,a);this.Os.clear();kWi(this);return a};
p.zf=function(a,b,c){Qv.prototype.zf.call(this,a,b,c);a instanceof iWi&&(b=a.isChecked(),this.Os.hd(a),1==this.Os.oh()||b)&&(l_a(this.Os,a),a.Pp(!0));kWi(this)};p.Ca=function(){Qv.prototype.Ca.call(this);var a=this.zb();bs(a,"script-explorer-contents");vr(a,eWi,{qc:this.O});a=tm(um(a));this.H.Wa(a[0]);this.F.Wa(a[1]);this.C.Wa(a[2]);this.L.Wa(a[3]);Ns(this,"run")};
p.Ja=function(){Qv.prototype.Ja.call(this);this.Be.Of(this.zb());kWi(this);this.addEventListener("dialogselect",xe(!0));Al(this,"action",this.P_a,void 0,this);Al(this.Be,"key",this.r0a,void 0,this);var a=new zs("new",this.H.getContent());Al(this.H,"action",w(this.dispatchEvent,this,a));a=new zs("run",this.F.getContent());Al(this.F,"action",w(this.dispatchEvent,this,a));a=new zs("edit",this.C.getContent());Al(this.C,"action",w(this.dispatchEvent,this,a));a=new zs("reload",this.L.getContent());Al(this.L,
"action",w(this.dispatchEvent,this,a))};p.yd=function(){Qv.prototype.yd.call(this);this.Be.detach();Fl(this,"action",this.P_a,void 0,this);Fl(this.Be,"key",this.r0a,void 0,this);Hl(this.H);Hl(this.F);Hl(this.C);Hl(this.L)};p.zb=function(){var a=Qv.prototype.zb.call(this),b=tm(a);return 0<b.length?b[2]:a};p.P_a=function(a){kWi(this);a.target instanceof iWi&&(l_a(this.Os,a.target),a.target.Pp(!0))};
p.r0a=function(a){var b=this.Os.oh();if(0<b)switch(a.keyCode){case 38:this.Os.jf(Bk(this.Os.xi()-1,b));a.preventDefault();this.focus();break;case 40:this.Os.jf(Bk(this.Os.xi()+1,b)),a.preventDefault(),this.focus()}};function kWi(a){var b=!!a.Os.qf();a.F.setVisible(b);a.C.setVisible(b)};function lWi(a,b){this.D=a;this.C=b}function mWi(a){a.D.H&&XUi(a.C,function(){if(O("macros-extensions").isEnabled()){a.D.Aa&&!a.D.C&&a.C.DV();var b=a.D.ma;if(b&&(b=a.C.getExtension(new mUi(b))||rVi(a.C,b))){var c=a.C,d=c.C.O;d&&(eVi(c.C),c=w(c.C.vO,c.C),nWi(d,M7(b),c))}}})};function oWi(){B.call(this);this.F=new Nk}v(oWi,Xu);oWi.prototype.C=function(){return this.F.Id()};function kVi(a,b){a.F.set(b.getId(),b)}oWi.prototype.Rc=function(){this.F.clear()};function jVi(a,b){S.call(this,b);this.C=a}v(jVi,S);
jVi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=this.C==(Ku(),Hu)?"Do more with Docs":this.C==(Ku(),i1a)?"Do more with Forms":this.C==(Ku(),Iu)?"Do more with Sheets":this.C==(Ku(),Ju)?"Do more with Slides":"Do more with Docs",b=this.C==(Ku(),Hu)?"Looking for even more Docs features? Get a few add-ons.":this.C==(Ku(),i1a)?"Looking for even more Forms features? Get a few add-ons.":this.C==(Ku(),Iu)?"Looking for even more Sheets features? Get a few add-ons.":this.C==(Ku(),Ju)?"Looking for even more Slides features? Get a few add-ons.":
"Looking for even more Docs features? Get a few add-ons.",c=this.C==(Ku(),Hu)?"addon_docs_promo":this.C==(Ku(),i1a)?"addon_forms_promo":this.C==(Ku(),Iu)?"addon_sheets_promo":this.C==(Ku(),Ju)?"addon_slides_promo":"addon_docs_promo",d=this.qa();this.Gc(xr(aWi,{title:a,description:b,iconName:c},void 0,d))};function pWi(){}v(pWi,vt);pWi.prototype.Ca=function(a){a=vt.prototype.Ca.call(this,a);Tr(a,"menuitem");return a};pWi.prototype.jc=m("goog-control");pWi.prototype.xo=function(a){a=vt.prototype.xo.call(this,a);a.push("menu-button","goog-inline-block");return a};Ca(pWi);function qWi(a,b,c,d,e){B.call(this);this.O=b;this.R=c;this.D=a;this.H={};this.Aa={};this.xa={};this.ma=[];this.ea=[];this.F=d||null;this.L=e||null;this.C=new oWi;this.J=new oWi;this.Ea=new Ml;this.oa(this.Ea);this.Ia=[]}v(qWi,B);qWi.prototype.Na=function(){Xf(this.H);B.prototype.Na.call(this)};qWi.prototype.KA=function(a){return le(this.H,a)};
function rWi(a,b,c){c=c?[c]:je(a.H);for(var d=0;d<c.length;d++)for(var e=c[d].Bb(),f=0;f<e.kc();f++){var h=e.Bc(f);if(h instanceof At&&h.getId()==b||h instanceof Lt&&(h=rWi(a,b,h)))return h}return null}
function sWi(a,b,c,d,e){if(J(b,3)){var f=ri(b,7)||!1,h=b.Rg(),k=J(b,10),l=new At("");l.rc(b.Ie()||String(Ha(l)));var n=[mm(h)];d&&b.getKey()&&(d+=b.getKey().toUpperCase(),d=X_a(l,O("macros-exec"),[d]),a.ma.push(d),n.push(d));l.setContent(n);b=new eUi(J(b,4),J(b,3),void 0,J(b,9)||void 0,void 0,b.ir()||void 0);qu(a.O,l,O("macros-exec"),null,xe(b),uUi(3,e));l.Oa(f);a.L&&f&&k&&(e=h+(" ("+(k+")")),c.push(a.L.Qr(O("macros-exec"),[b],xe(e),xe(e))[0]));return l}if(!b.Rg())return new Et;if(0<b.qh().length){l=
new Ft;f=b.qh();for(h=0;h<f.length;h++)l.Ha(sWi(a,f[h],c,d,e),!0);a=new Lt(b.Rg());a.rc(b.Ie()||String(Ha(a)));a.pe(l);oVi(l.La(),!0);return a}throw Error("Unsupported menu item type.");}qWi.prototype.Ma=function(a,b){return Wd(a.getName(),b.getName())};function nVi(a,b,c,d,e){if(b.lka()){var f=new fUi,h=String(Ha(f));K(f,1,h);b.Ha(sWi(a,f,d),!0)}d=new At("Help");d.rc(String(Ha(d)));qu(a.O,d,O("macros-extension-help"),null,xe(c),uUi(3,e));d.Oa(!0);b.Ha(d,!0)}
function mVi(a,b,c){var d=new At("");d.rc("addon-menu-install-"+M7(c));qu(a.O,d,O("macros-extension-install-start"),tu,xe(M7(c)),uUi(3,c));d.Oa(!0);b.Ha(d,!0)}function lVi(a){cv(a.F,"docs-macros-extension-promo")||bv(a.F,"docs-macros-extension-promo",[a.J,null]);cv(a.F,"docs-macros-extensions")||bv(a.F,"docs-macros-extensions",[a.C]);a.F.Bb("docs-extensions-menu",!0);Uw()&&a.F.Bb("macros-extension-add-ons-menu",!0)}
function nWi(a,b,c){var d=c||za;(c=a.C.F.get(b))?-1===a.Ia.indexOf(b)?(b=pn(w(function(e){e.dispatchEvent("load")},a,c),1E4),b=w(function(e,f,h){this.D.P4("docs-extensions-menu");e.wg(!0);e.OG();qn(h);f()},a,c,d,b),a.Ea.Nc(c,"load",b)):(a.D.P4("docs-extensions-menu"),c.qI(),c.wg(!0),c.OG(),d()):d()}function oVi(a,b){Uw()&&(bs(a,"ia-menu"),b||bs(a,"ia-primary-menu"))};function tWi(a,b){var c=a.ova,d=a.iL;a='<div class="'+U(a.Es)+'" aria-labelledby="addon-sidebar-title" tabindex="0"'+(d?' role="complementary"':' role="region"')+'><div class="'+U("addon-sidebar-header")+'"><div class="'+U("addon-sidebar-title")+'" id="addon-sidebar-title">';a=a+"Document add-ons</div>"+(Cu({Jd:"addon-sidebar-close docs-material",content:Fr(""+$v(c)),style:4,title:"Close sidebar"},b)+'</div><div class="'+U("addon-sidebar-content")+'"><div class="'+U("addon-sidebar-banner")+'"></div><div class="'+
U("addon-sidebar-introduction")+'"></div></div><div class="'+U("addon-sidebar-empty-caption")+'"><div class="'+U("addon-sidebar-empty-title")+'">');a=a+'No document add-ons</div><div class="'+(U("addon-sidebar-empty-description")+'">');return T(a+"This document doesn't include any add-ons</div></div></div>")}
function uWi(a){var b=a.nFb;a=a.kFb;return T('<img class="'+U("addon-sidebar-banner-image")+'" src='+Ir(Kr(b))+" alt="+Ir(a)+' /><div class="'+U("addon-sidebar-banner-image-overlay")+'"></div>')};function vWi(a){var b=a.icon,c=a.title,d=a.category,e=a.summary,f=a.isInstalled;a=a.kBc;return T('<div class="'+U("addon-sidebar-card")+'" aria-label="'+U(c)+'" tabindex="0" role="region"><div class="'+U("addon-sidebar-card-header")+'"><div class="'+U("addon-sidebar-card-icon")+'">'+(b?'<img class="'+U("addon-sidebar-card-icon-image")+'" src='+Ir(Kr(b))+" alt="+Ir(c)+" />":"")+'</div><div class="'+U("addon-sidebar-card-header-content")+'"><div class="'+U("addon-sidebar-card-title")+'"><div class="'+
U("addon-sidebar-card-title-caption")+(a?" "+U("addon-sidebar-card-two-line-title-caption"):"")+'">'+Ar(c)+"</div>"+(f?T('<div class="'+(U("addon-sidebar-card-check")+'"><svg xmlns="http://www.w3.org/2000/svg" width="18px" height="18px" viewBox="0 0 48 48" fill="')+U("#455A64")+'"><path d="M0 0h48v48H0z" fill="none"/><path d="M24 4C12.95 4 4 12.95 4 24c0 11.04 8.95 20 20 20 11.04 0 20-8.96 20-20 0-11.05-8.96-20-20-20zm-4 30L10 24l2.83-2.83L20 28.34l15.17-15.17L38 16 20 34z"/></svg></div>'):"")+'</div><div class="'+
U("addon-sidebar-card-category")+'">'+Ar(d)+"</div></div></div>"+(e?'<div class="'+U("addon-sidebar-card-summary")+'">'+Ar(e)+"</div>":"")+"</div>")};function wWi(){}v(wWi,mD);wWi.prototype.jc=m("docs-material-menu-button-flat-primary");wWi.prototype.Qn=function(){return xr(Emc,{className:"docs-material-menu-button-flat-primary-dropdown"})};Ca(wWi);function xWi(a,b,c,d,e){c=void 0===c?wWi.getInstance():c;Mt.call(this,a,b,c,d,e)}v(xWi,Mt);function yWi(){}v(yWi,mD);yWi.prototype.jc=m("docs-material-menu-button-raised-primary");yWi.prototype.Qn=function(){return xr(Emc,{className:"docs-material-menu-button-raised-primary-dropdown"})};Ca(yWi);function zWi(a,b,c,d,e){c=void 0===c?yWi.getInstance():c;Mt.call(this,a,b,c,d,e)}v(zWi,Mt);function AWi(a,b,c,d,e){B.call(this);this.D=a;this.C=b;this.F=c;this.H=d;this.eb=e||Tl()}v(AWi,B);
function BWi(a,b){if(!b)return CWi(a);b=b.qh();if(1==b.length&&J(b[0],3)){var c=CWi(a);b=b[0];c.Oa(!!ri(b,7));b=new eUi(J(b,4),J(b,3),void 0,J(b,9)||void 0);qu(a.D,c,O("macros-exec"),{enabled:!0},xe(b),a.F);return c}c=new Ft(a.eb);for(var d=0;d<b.length;d++)c.Ha(DWi(a,b[d]),!0);b=[mm("Use")];a=a.C?new zWi(b,c,void 0,a.eb):new xWi(b,c,void 0,a.eb);a.Xd("Use");a.Ob("addon-sidebar-card-menu-button");a.Oa(!0);return a}
function DWi(a,b){if(J(b,3)){var c=b.Rg(),d=new At("");d.Ob(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");d.setContent([mm(c)]);c=new eUi(J(b,4),J(b,3),void 0,J(b,9)||void 0);qu(a.D,d,O("macros-exec"),{enabled:!0},xe(c),a.F);d.Oa(!!ri(b,7));return d}if(!b.Rg())return new Et;if(0<b.qh().length){d=new Ft(a.eb);c=b.qh();for(var e=0;e<c.length;e++)d.Ha(DWi(a,c[e]),!0);b=new Lt(b.Rg());b.Ob(a.C?"addon-sidebar-menu-item-with-raised":"addon-sidebar-menu-item-with-flat");
b.pe(d);return b}throw Error("Unsupported menu item type.");}function CWi(a){var b=[mm("Use")];a=a.C?new Atf(b,a.eb):new pP(b,a.eb);a.Xd("Use");a.Ob("addon-sidebar-card-button");a.Oa(!1);return a};function EWi(a,b,c,d,e){S.call(this,e);this.C=a;this.ma=b;this.R=ri(this.C,19)||!1;this.H=!(!ri(this.C,10)&&!ri(this.C,9));this.L=new ou(void 0,void 0,!0,nw.getInstance());this.oa(this.L);this.ea=uUi(10,this.C);this.J=new ct(void 0,void 0,e);this.oa(this.J);this.F=new AWi(this.L,c,this.ea,d,e);this.oa(this.F);if(this.H)a=BWi(this.F);else{a=this.F;b=this.C;a:switch(a.H){case Ku(),Hu:c="Add to Docs";break a;case Ku(),Ju:c="Add to Slides";break a;case Ku(),Iu:c="Add to Sheets";break a;default:throw Error("Unsupported document type");
}d=[mm(c)];d=a.C?new Atf(d,a.eb):new pP(d,a.eb);d.Xd(c);d.Ob("addon-sidebar-card-button");d.Oa(!1);qu(a.D,d,O("macros-extension-install-start"),{enabled:!0},xe(M7(b)),a.F);a=d}this.D=a;a=this.F;b=this.C;c=new pP([mm("Help")],a.eb);c.Xd("Help");c.Ob("addon-sidebar-card-button");c.Oa(!1);c.Yd("Help");qu(a.D,c,O("macros-extension-help"),{enabled:!0},xe(M7(b)),a.F);this.O=c}v(EWi,S);
EWi.prototype.Ca=function(){S.prototype.Ca.call(this);var a=J(this.C,15)||"";a&&(a=hl(new gl(a),"https").toString());var b=this.qa();a={icon:a,title:this.C.getName(),category:this.C.Mj(),isInstalled:this.H,summary:J(this.C,14),kBc:Mf};b=xr(vWi,a,void 0,b);this.mb(b);this.Gc(b)};EWi.prototype.Gc=function(a){S.prototype.Gc.call(this,a);a=this.Da("addon-sidebar-card-title-caption");Tr(a,"button");this.Ha(this.J);this.J.Wa(a)};
EWi.prototype.Ja=function(){S.prototype.Ja.call(this);qu(this.L,this.J,O("macros-manage-extensions"),{},xe(N7(this.C)),this.ea);FWi(this);!this.H&&this.R&&(this.Ha(this.O,!0),this.O.Oa(!0))};EWi.prototype.Na=function(){Wf(this.D);Wf(this.O);S.prototype.Na.call(this)};function GWi(a,b){a.H&&(a.D.getParent()==a&&a.removeChild(a.D,!0),Wf(a.D),a.D=BWi(a.F,b),a.yb()&&FWi(a))}
function FWi(a){a.Ha(a.D,!0);a.H||(a.D.Oa(a.ma&&!a.R),a.ma?a.R&&a.D.Yd("Add-on not available in G Suite Marketplace"):a.D.Yd("Disabled for your organization"))};function HWi(a,b,c){SR.call(this,c);this.D={};this.C=[];this.R=!1;this.H=a;this.ma=b;this.J={};this.F=new lK(this.qa(),"addon-sidebar-spinner");this.Ha(this.F);this.O=new Du(void 0,this.qa());this.L=this.ea=!1}v(HWi,SR);p=HWi.prototype;p.Ca=function(){SR.prototype.Ca.call(this);var a={Es:"addon-sidebar",ova:Up("close-white"),iL:y(A(),"docs-eal")};a=xr(tWi,a,void 0,this.qa());this.mb(a);this.Gc(a)};
p.Gc=function(a){SR.prototype.Gc.call(this,a);this.F.render(this.zb());a=this.F.La();Yr(a,"Loading");Tr(a,"status");Vr(a,"live","polite")};p.Ja=function(){SR.prototype.Ja.call(this);IWi(this,!1);JWi(this,!1);this.O.Wa(this.Da("addon-sidebar-close"));this.getHandler().Ye(this.O.La(),El,w(this.cOa,this)).listen(this.getElement(),"keyup",this.xfc);this.ea&&qVi(this)};p.zb=function(){return this.bb("addon-sidebar-content")};
function qVi(a){a.F.setVisible(!1);JWi(a,a.H);IWi(a,0==a.C.length);KWi(a,a.L);LWi(a);md(a.C,function(b){var c=M7(b);b=new EWi(b,this.R,this.L,this.ma,this.qa());GWi(b,this.J[c]);this.Ha(b,!0);this.D[c]=b},a)}function LWi(a){ee(a.D,function(b){this.removeChild(b,!0);Wf(b)},a);oe(a.D)}function IWi(a,b){if(a.yb()){var c=a.Da("addon-sidebar-empty-caption");P(c,b)}b&&JWi(a,!1)}
function JWi(a,b){if(a.yb()){var c=a.Da("addon-sidebar-introduction");b&&!Am(c)&&ym(c,1<a.C.length?"This template is optimized to work with these add-ons":"This template is optimized to work with this add-on");P(c,b)}}function pVi(a){return 0==a.C.length?null:(a=J(a.C[0],16)||J(a.C[0],17))?hl(new gl(a),"https").toString():null}
function KWi(a,b){if(a.yb()){fs(a.getElement(),"addon-sidebar-with-banner",b);var c=a.Da("addon-sidebar-banner");b?(b=pVi(a))&&vr(c,uWi,{nFb:b,kFb:a.C[0].getName()}):pm(c)}}p.CKb=function(a,b){return Wd(a.getName(),b.getName())};p.xfc=function(a){27==a.keyCode&&(this.getElement()==a.target&&this.cOa(),a.stopPropagation())};p.cOa=function(){this.setVisible(!1);JWi(this,!1);this.H=!1;O("docs-focus-editor").kb()};p.Ug=m(!1);function MWi(a,b){dS.call(this,a,b)}v(MWi,dS);MWi.prototype.wm=function(){return O("macros-addon-sidebar-focus")};MWi.prototype.Af=function(){return O("macros-addon-sidebar")};MWi.prototype.sp=function(a){var b=this.Pb;b.yb()||b.render();dS.prototype.sp.call(this,a)};MWi.prototype.q9a=function(a){a&&this.Af().isVisible()&&this.sp(!0)};function NWi(a,b,c){this.C=a;this.F=b;this.D=c;Object.defineProperties(this,{path:{get:w(this.Ivb,this),set:w(this.Mwc,this)},invoke:{get:w(this.aRb,this),set:w(this.Jwc,this)},arity:{get:w(this.WLb,this),set:w(this.rwc,this)}})}p=NWi.prototype;p.Ivb=g("C");p.Mwc=da("C");p.aRb=g("F");p.Jwc=da("F");p.WLb=g("D");p.rwc=da("D");function OWi(a,b,c,d,e){S.call(this,e);this.L=a;this.D=b;this.J=c;this.C=d}v(OWi,S);
OWi.prototype.Ca=function(){var a=hd(A(),"docs-tfh"),b=this.L;a&&(b=Ie(b,{allow_parent:a}));a=yXa(this.qa());lf(a,b);a.width="100%";a.height="100%";a.marginWidth="0";a.marginHeight="0";a.scrolling="no";a.allow="accelerometer ambient-light-sensor autoplay camera encrypted-media fullscreen geolocation gyroscope magnetometer microphone midi payment picture-in-picture speaker usb vr".split(" ").map(function(c){return c+" *;"}).join(" ");this.mb(a);ua("payload",this.D,a);ua("adapter.hostFunctions",this.J,
a);Oa("adapter.getSessionId",w(this.H,this),a);Oa("adapter.getState",w(this.F,this),a)};OWi.prototype.Ug=m(!1);OWi.prototype.H=function(){var a=this.C().C;return null!==a?String(a):null};OWi.prototype.F=function(){return this.C().getState()};function PWi(a,b,c,d,e,f,h,k,l){Qv.call(this,void 0,void 0,l);var n=w(this.setVisible,this,!1),q=w(this.H,this),t=w(this.F,this);e&&this.setTitle(e);this.Jg=f||500;this.We=h||300;this.C=new OWi(a,b,[new NWi("google.script.host.close",n,0),new NWi("google.script.host.closeDialog",n,0),new NWi("google.script.host.editor.focus",w(d.Db,d,3),0),new NWi("google.script.host.setWidth",q,1),new NWi("google.script.host.setHeight",t,1)],c,l);this.Ha(this.C);xs(this,!!k);Bs(this,null)}v(PWi,Qv);
PWi.prototype.H=function(a){!isFinite(a)||0>a||Vq(this.zb(),Math.min(a,Math.floor(.8*gm().width)))};PWi.prototype.F=function(a){!isFinite(a)||0>a||Wq(this.zb(),Math.min(a,Math.floor(.8*gm().height)))};PWi.prototype.Ca=function(){Qv.prototype.Ca.call(this);bs(this.getElement(),"script-app-dialog");var a=this.zb();bs(a,"script-app-contents");Vq(a,Math.min(this.Jg,Math.floor(.8*gm().width)));Wq(a,Math.min(this.We,Math.floor(.8*gm().height)));this.C.render(a)};PWi.prototype.Ug=m(!1);function QWi(a){SR.call(this,a);this.C=this.D=this.F=this.H=null}v(QWi,SR);p=QWi.prototype;p.nea=function(){this.C&&(this.removeChild(this.C,!0),this.C.dispose(),this.C=null);this.setVisible(!1)};p.focus=function(){this.C.getElement().focus()};p.zb=g("D");
p.Ca=function(){var a=this.qa(),b={id:this.getId(),Es:"script-application-sidebar",ojc:"script-application-sidebar-header",bba:"script-application-sidebar-title",dHb:"script-application-sidebar-close",FY:"script-application-sidebar-content",ova:Up("close-white"),iL:y(A(),"docs-eal")};b=xr(YVi,b,void 0,a);this.mb(b);this.H=a.bb("script-application-sidebar-title",b);this.F=a.bb("script-application-sidebar-close",b);this.D=a.bb("script-application-sidebar-content",b)};
p.Ja=function(){SR.prototype.Ja.call(this);this.getHandler().Ye(this.F,El,w(this.nea,this))};p.Ug=m(!1);p.Na=function(){delete this.H;delete this.F;delete this.D;delete this.C;SR.prototype.Na.call(this)};function RWi(a,b){dS.call(this,a,b)}v(RWi,dS);RWi.prototype.wm=function(){return O("macros-application-focus")};RWi.prototype.Af=function(){return O("macros-application-sidebar")};function SWi(a,b){var c=null;c=c||qr("",{target:"_blank",height:500,width:600,top:(screen.height-500)/2,left:(screen.width-600)/2,scrollbars:!0});nf(c.location,a);b!=za&&(a=new bgc(function(){return c?c.closed:!0}),a.Bx=b,a.start(100,-1))};function TWi(a,b,c,d,e){Qv.call(this,void 0,!0,c);this.H=a;this.F=d||za;ts(this,b);this.setVisible(!0);this.Oi=!0;As(this,!1);Bs(this,(new ys).sf(YXa,!0).sf(Fs,!1,!0));this.setTitle(e||"Authorization Required");Ns(this,YXa.key)}v(TWi,Qv);TWi.prototype.Ja=function(){Qv.prototype.Ja.call(this);this.addEventListener("dialogselect",this.C)};TWi.prototype.yd=function(){Qv.prototype.yd.call(this);this.removeEventListener("dialogselect",this.C)};
TWi.prototype.C=function(a){"cancel"!=a.key?SWi(this.H,this.F):this.F();this.setVisible(!1)};function UWi(a){Qv.call(this,void 0,void 0,void 0);this.F=a;this.C=null;this.Oi=!0;this.setTitle("Message details");Bs(this,ZXa())}v(UWi,Qv);UWi.prototype.Ca=function(){Qv.prototype.Ca.call(this);var a=this.zb();bs(a,"script-error-dialog-content");this.C=mm(this.F);a.appendChild(this.C)};UWi.prototype.Na=function(){Qv.prototype.Na.call(this);this.C&&rm(this.C)};function VWi(a){B.call(this);this.C=a}v(VWi,B);function WWi(a,b){var c=$d("Running script ");c=im("SPAN",null,c);b=b?Ou(c,"Cancel",b,"info",!0):Nu(c,"info",!0);a.C.postMessage(b);return b.getId()}function XWi(a,b,c){var d=(c=void 0===c?null:c)?c:"Script "+(uf(b)+" experienced an error");b=im("SPAN","script-error-message",d);b.style.maxWidth="600px";a.C.postMessage(Ou([b],"Details",function(){(new UWi(d)).setVisible(!0)},"warning",!0))}VWi.prototype.Na=function(){delete this.C};function YWi(){B.call(this);this.C=null;this.D=new Ml;this.oa(this.D)}v(YWi,B);YWi.prototype.Na=function(){ZWi();$Wi(this);B.prototype.Na.call(this)};function $Wi(a){a.D.Rc();a.C&&(a.C.dispose(),a.C=null);ZWi()}function ZWi(){var a=Xl("docs-script-button-bar");a&&pm(a)};var aXi=new SF(["http","https"]);function bXi(a){a=Af(a);if(Zd(a)||ae(a,'"'))return null;var b=Sk(1,a);return b?aXi.contains(b.toLowerCase())?a:null:null};function cXi(a,b,c,d,e,f,h){h=void 0===h?!1:h;Qv.call(this);this.Ui=Zd(Af(b))?"You can find "+(a+" in the Add-ons menu."):b;this.ma=c;this.xa=d;this.H=bXi(e);this.ea=bXi(f);this.L=h;this.R=nr(this,dXi);this.C=mS("Learn more");this.Ha(this.C);this.F=new Du("Report an issue");this.Ha(this.F);this.O=new Du("View in store");this.Ha(this.O);this.setTitle($d("Help for "+a));a=new ys;a.sf({key:Fs.key,caption:"Close"},!1,!0);Bs(this,a);Ns(this,"ok")}v(cXi,Qv);p=cXi.prototype;
p.Ca=function(){Qv.prototype.Ca.call(this);var a=this.zb();vr(a,cWi,{description:this.Ui,ids:this.R,Wkc:this.L});bs(a,"script-help-dialog")};
p.Ja=function(){Qv.prototype.Ja.call(this);var a=this.qa().getElement(this.R.jca);this.L?(this.F.render(a),this.getHandler().listen(this.F,"action",this.i1a),this.C.render(a),this.getHandler().listen(this.C,"action",this.dOa)):(this.H&&(this.C.render(a),this.getHandler().listen(this.C,"action",this.dOa)),this.F.render(a),this.getHandler().listen(this.F,"action",this.i1a),this.O.render(a),this.getHandler().listen(this.O,"action",this.dic))};
p.dOa=function(){this.L?qr("https://support.google.com/docs?p=GSM_migration"):this.H&&qr(this.H)};p.i1a=function(){this.ea?qr(this.ea):(this.ma(),this.dispose())};p.dic=function(){this.xa();this.dispose()};var dXi={jca:"script-help-dialog-buttonbar"};function eXi(a,b,c,d){wl.call(this,"Vl");this.title=d}v(eXi,wl);function fXi(a,b,c,d,e,f){Qv.call(this,void 0,void 0,f);this.H=b;this.F=d;this.L=e;this.C=null;this.setTitle(a);xs(this,!0);a=new ys(f);for(b=0;b<c.length;++b)d=c[b],a.set(d,gXi[d]);a.D="0";Bs(this,a)}v(fXi,Qv);p=fXi.prototype;p.Ca=function(){Qv.prototype.Ca.call(this);var a=this.qa(),b=this.zb();bs(b,"script-prompt-contents");for(var c=a.Ca("DIV"),d=this.H.split("\n"),e=0;e<d.length;++e)0<e&&c.appendChild(a.Ca("BR")),c.appendChild(Im(a,d[e]));b.appendChild(c);this.F&&(this.C=a.Ca("INPUT"),b.appendChild(this.C))};
p.Ug=m(!1);p.Ja=function(){Qv.prototype.Ja.call(this);this.getHandler().listen(this,"dialogselect",w(this.Jvb,this))};p.focus=function(){Qv.prototype.focus.call(this);this.C&&this.C.focus()};p.Jvb=function(a){this.L(Number(a.key),this.F?this.C.value:null)};var gXi={1:"Ok",4:"Cancel",2:"Yes",3:"No"};function hXi(a,b){Qv.call(this);this.H=a;this.F=b;Bs(this,(new ys).sf({key:"send",caption:"Send"},!0).sf({key:"cancel",caption:"Cancel"},!1,!0));this.setTitle("Report an issue");this.C=new zu;this.Ha(this.C)}v(hXi,Qv);p=hXi.prototype;p.Ca=function(){Qv.prototype.Ca.call(this);Ns(this,"send");var a=this.zb();bs(a,"script-reportissue-dialog-content");vr(a,dWi,{BKb:this.F})};
p.Ja=function(){Qv.prototype.Ja.call(this);this.C.Wa(this.Da("script-reportissue-dialog-nonanonymous-checkbox"));this.abb();var a=this.getHandler();a.listen(this.Da("script-reportissue-dialog-description"),"input",this.abb);a.listen(this,"dialogselect",this.Kvb)};p.Od=function(){return this.Da("script-reportissue-dialog-description").value};p.abb=function(){var a=!Zd(this.Od());Ds(this.D,"send",a)};p.Kvb=function(a){if("send"!=a.key)return!0;this.H(this.Od(),this.C.isChecked());return!0};function iXi(a,b){B.call(this);this.D={};this.F={};this.L=0;this.J=b;this.C=a;this.C.vK(w(this.Lvb,this))}v(iXi,B);p=iXi.prototype;p.connect=function(a){this.C.isConnected();this.C.connect(a)};p.isConnected=function(){return this.C.isConnected()};p.g8b=function(a,b){var c=jXi(this,b[0]),d=jXi(this,b[1]);b=Id(b,2);try{var e=a.apply(this,b);"function"===typeof e?e(c,d):c.call(this,e)}catch(f){d.call(this,null)}};
p.Lvb=function(a,b){if(Sd(a,"callback.")&&le(this.D,a)){var c=rfa(this.D,a);b=null!=b?JSON.parse(b):null;var d=this.F[a];d&&(pe(this.D,d),pe(this.F,a),pe(this.F,d));pe(this.D,a);c.call(this,b)}};function jXi(a,b){return w(function(c){c=null!=c?mn(c):null;this.C.send(b,c)},a)}p.Na=function(){B.prototype.Na.call(this);delete this.J;delete this.D;delete this.F;delete this.L;delete this.C};function kXi(a,b,c,d){c=new iC({role:0,ph:c,cn:"ide.api.ch",tp:1});c.pz=b;iXi.call(this,c,d||5E3);this.H=a;a=w(this.O,this);this.C.yf("method.getContainerInfo",w(this.g8b,this,a),!0)}v(kXi,iXi);kXi.prototype.O=function(){return bYe(this.H.call())};kXi.prototype.Na=function(){var a=this.C;iXi.prototype.Na.call(this);a.dispose();delete this.H};function lXi(a,b,c,d,e){B.call(this);this.H=a;this.L=b;this.R=c;this.F=d||null;this.J=e||null;this.C=this.D=null}v(lXi,B);lXi.prototype.open=function(){if(this.F){if(this.F.closed){this.F=null;return}this.D=this.F;this.F=null;nf(this.D.location,this.H)}else this.D=qr(this.H,{target:this.L});if(this.J)try{this.C=new kXi(this.J,this.D,this.R),this.C.connect(),pn(w(this.O,this,!0),1E5)}catch(a){this.C=null}};
lXi.prototype.O=function(a){try{!this.C||a&&this.C.isConnected()||(this.C.dispose(),this.C=null)}catch(b){this.C=null}};lXi.prototype.close=function(){this.O();this.D&&!this.D.closed&&(this.D.close(),this.D=null)};lXi.prototype.Na=function(){B.prototype.Na.call(this);this.C&&this.C.dispose();delete this.F;delete this.D;delete this.C;delete this.H;delete this.L};function mXi(a,b,c,d,e,f,h,k,l){Il.call(this);this.R=[];this.Ia=!!k;this.F=a;this.O=b;this.oa(this.O);this.Ea=new YWi;this.oa(this.Ea);this.C=new VWi(Lu.getInstance());this.oa(this.C);this.D=null;this.xa=new RWi(new QWi,l);this.ea=null;e&&(this.ea=new MWi(new HWi(f,h),l));this.H=new jWi(void 0,k);this.H.Ud(this);this.oa(this.H);this.F.Ah(this.H);this.ma=c;this.Aa=d;this.L=this.J=null}v(mXi,Il);function fVi(a){return a.ea?a.ea.Pb:null}p=mXi.prototype;p.qc=g("Ia");
function nXi(a,b){if(null==b)a.H.reset(0);else{var c=a.H;c.reset(2);for(var d=0;d<b.length;d++)for(var e=b[d],f=Li(e,IUi,4),h=0;h<f.length;h++){var k=f[h];k=new iWi(e.getId(),e.getName(),k.getName());c.Ha(k,!0)}0===c.kc()&&c.reset(1);a.H.isVisible()&&a.H.focus()}}function oXi(a,b){var c=Xl("docs-script-button-bar");c&&(pm(c),Zd(Af(a))||(a=new Du(a),a.Ob("docs-titlebar-button"),a.render(c),Al(a,"action",b)))}
function gVi(a,b,c){a.L&&!a.L.isDisposed()&&(Rv(a.F,a.L),a.L.dispose());a.L=new hXi(b,c);a.L.Oi=!0;a.F.Ah(a.L);a.L.setVisible(!0)}
p.ayc=function(a,b,c){var d=this.F,e=c||null;c="<p>";var f="Thanks! Your feedback was sent to the creators of <strong>"+(Ar(a)+"</strong>.");c=c+f+"</p>";e&&(c+="<p>",b?(a="You might not receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Jr(e))+'" target="_blank">'+(Ar(a)+" help</a>.")),c+=a):(a="You won't receive an individual reply, but if you'd like to learn more, check out <a href=\""+(U(Jr(e))+'" target="_blank">'+(Ar(a)+" help</a>.")),c+=a),c+="</p>");c=T(c);
DXe(d,"Report an issue",ur(c),void 0,void 0,"Close")};p.$xc=function(){DXe(this.F,"Report an issue","We're sorry, but we encountered an error sending your issue report. Please try again later.",void 0,void 0,"Close")};function eVi(a){a.dispatchEvent("Yl")&&(a=a.Aa,a.C.isVisible()&&a.C.hide(),a.D.yb()||a.D.render(a.F||void 0),a.D.show())}p.vO=function(){this.dispatchEvent("Ul")&&this.Aa.D.hide()};p.Qsc=function(a,b,c,d,e){a=new lXi(a,"MacroService"+Fha(c),b,e,d);this.R.push(a);a.open()};p.p6a=function(a){qr(a)};
p.Na=function(){Il.prototype.Na.call(this);Xf(this.R)};function pXi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,R,Q,ba){u=void 0===u?!1:u;z=void 0===z?null:z;R=void 0===R?!1:R;B.call(this);this.L=a;this.R=l;this.Ta=k;this.Aa=n;this.O=b;this.xa=c;this.J=d;this.D=L;this.H=new Ml(this);this.oa(this.H);this.Qa=q;this.Ra=z;this.ma=new VVi(this.xa,this.J);this.oa(this.ma);this.Pa=R;a=this.Aa;c=this.Pa;u=void 0===u?!1:u;this.C=new mXi(e,h,q,t,qXi(a),c,a,u,E);this.oa(this.C);this.Ia=new FUi;h=0;b.D?b.C&&(h=2):h=1;this.F=new WUi(this.Aa,e,f,this.C,this.Ia,this.L,this.xa,
this.R,h,this.D,Q,ba);this.oa(this.F);this.Ea={};this.ea=this.Ma=null}v(pXi,B);p=pXi.prototype;
p.start=function(){if(co(this.L.F,1,1)){this.H.listen(this.J,"amep",w(this.Mvb,this));this.H.listen(this.J,"stbep",w(this.Tvb,this));this.H.listen(this.J,"sttep",w(this.Uvb,this));this.H.listen(this.J,"spep",w(this.Svb,this));this.H.listen(this.J,"saep",w(this.Qvb,this));this.H.listen(this.J,"snep",w(this.Rvb,this));this.H.listen(this.J,"paep",w(this.Ovb,this));this.H.listen(this.J,"rfep",w(this.Pvb,this));this.H.listen(this.C,"dialogselect",w(this.e3b,this));this.H.listen(yH.getInstance(),"Vc",w(this.Nvb,
this));this.Ta(w(this.a3b,this));var a=this.L.C;O("macros-exec").Ab(zp,this.W2b,this);O("macros-resume").Ab(zp,this.Mcc,this);O("macros-manage").Ab(zp,w(a.Ws,a,w(this.I7b,this)));O("macros-editor").Ab(zp,this.tAa,this);O("macros-extensions").Ab(zp,w(this.U_a,this));O("macros-manage-extensions").Ab(zp,w(this.H7b,this));O("macros-extension-menu-promo").Ab(zp,w(this.U_a,this));O("macros-extension-disabled").Ab(zp,this.l1b,this);O("macros-extension-help").Ab(zp,this.m3b,this);O("macros-extension-install-start").Ab(zp,
this.r6b,this);O("macros-trigger-0").Ab(zp,w(this.OE,this,"0"));O("macros-trigger-1").Ab(zp,w(this.OE,this,"1"));O("macros-trigger-2").Ab(zp,w(this.OE,this,"2"));O("macros-trigger-3").Ab(zp,w(this.OE,this,"3"));O("macros-trigger-4").Ab(zp,w(this.OE,this,"4"));O("macros-trigger-5").Ab(zp,w(this.OE,this,"5"));O("macros-trigger-6").Ab(zp,w(this.OE,this,"6"));O("macros-trigger-7").Ab(zp,w(this.OE,this,"7"));O("macros-trigger-8").Ab(zp,w(this.OE,this,"8"));O("macros-trigger-9").Ab(zp,w(this.OE,this,"9"));
this.ma.start();rXi(this.Aa,this.Pa)&&(O("macros-addon-sidebar-focus").Oa(!0),O("macros-addon-sidebar-focus").kb(void 0,uUi(19)));mWi(new lWi(this.O,this.F));a=this.O.O;var b=!this.O.C,c=this.xa,d=this.R().getState()||void 0;d=["ruid",Ha({}),c.C.C,c.D,c.C.D,d];b||d.push("addon_safe_mode",!0);a&&d.push("addon_dry_run",a);bp(dp(O7(c,c.C.Ia),"POST").setContent(""),d).Ir().Re()}};
function sXi(a){nXi(a.C,null);var b=w(function(c){c.wr()?nXi(this.C,Li(c,KUi,2)):(this.C.C.C.postMessage(Nu("Could not load scripts.","warning",!0)),nXi(this.C,[]))},a);TUi(a.xa,b)}
function tXi(a,b,c,d,e,f){if(d){eVi(a.C);var h=w(function(){var t=rVi(this.F,b);t&&!ri(t,4)&&(K(t,4,!0),hVi(this.F))},a);var k=w(function(){this.C.vO();this.L.Rq.dispatchEvent(new zn(!0))},a);var l=w(function(t){this.C.vO();8!=t.rF()&&XWi(this.C.C,c,t.Jf())},a);dVi(a.F)}else{var n=WWi(a.C.C),q=w(function(t){this.ma.F.cancel(t);Mu(this.C.C.C,n)},a);h=w(function(t){Mu(this.C.C.C,n);n=WWi(this.C.C,Ja(q,t))},a);k=w(function(t){Mu(this.C.C.C,n);if(t.j7()){t=this.C.C;var u=$d("Canceled script ");t.C.postMessage(Nu(u,
"info",!1,2500))}else t=this.C.C,u=$d("Finished script "),t.C.postMessage(Nu(u,"info",!1,2500));this.L.Rq.dispatchEvent(new zn(!0))},a);l=w(function(t){Mu(this.C.C.C,n);8!=t.rF()&&XWi(this.C.C,c,t.Jf())},a)}a.Qa.Db(3);dqe(a.L.C,w(a.wvc,a,b,c,h,k,l,d,e,f))}p.wvc=function(a,b,c,d,e,f,h,k){var l=this.R().getState()||void 0,n=this.ma;c=void 0===c?za:c;d=void 0===d?za:d;e=void 0===e?za:e;e=w(n.Evb,n,a,b,c,d,e);n.F.Y2a(a,b,l,e,f,h,k)};
p.Nvb=function(a){var b=Gd(this.F.D),c={};b=ha(b);for(var d=b.next();!d.done;d=b.next())d=d.value,c["ADD-ON:"+M7(d)]={name:d.getName(),"cws-id":J(d,1),"gsm-application-id":J(d,18),"app-key":M7(d)};ue(a.oG,c)};p.l1b=function(a){a.data==this.Ma&&(a=this.C,a.dispatchEvent("Tl")&&a.xa.Pb.nea())};
p.Mvb=function(a){a=a.C().Bb();var b={},c=uXi(this,a);if(1==ti(a,11,0)){var d=J(a,4);d=rVi(this.F,d)}else d=void 0;var e=d,f=e&&(ri(e,10)||ri(e,9))||!1,h=e&&ri(e,19)||!1;d=this.Ia;var k=c,l=J(a,4),n=1==ti(a,11,0);f=new DUi(a,k,n,f,h);f.setVisible(!0);0==ti(a,11,0)&&(l=f.getLabel());d.C[ti(a,11,0)][l]=f;d.dispatchEvent("Xl");(d=fVi(this.C))&&J(a,9)&&(1==J(a,12)||5==J(a,12))&&(l=J(a,4),d.J[l]=a,l&&l in d.D&&GWi(d.D[l],a));c=c.reverse();if(d=this.C.O){for(l=0;l<c.length;l++)if(f=c[l],h=f.getKey())if(b[h])Ai(f,
5);else{if(this.Ea[h])for(k="Ctrl+Alt+Shift+"+h.toUpperCase(),k=lu(O("macros-exec"),[k]),n=0;n<d.ma.length;n++){var q=d.ma[n];Am(q)==k&&ym(q,"")}this.Ea[h]=f.Ie();b[h]=!0}if(1==ti(a,11,0)){b=null!=e?e:null;c=[];e=J(a,4);f=!!J(a,9)&&3!=J(a,12);l=d.C.F.get(e);l||(l=new Lt(""),l.rc(e),h=J(a,10),l.setContent(mm(h)),l.Oa(2==d.R?!1:f&&1==d.R?!1:!0),d.J.Rc(),kVi(d.C,l),lVi(d));f||d.ea.push(e);f=new Ft;!b||ri(b,10)||ri(b,9)||ri(b,19)||(mVi(d,f,b),h=new fUi,k=String(Ha(h)),K(h,1,k),f.Ha(sWi(d,h,c),!0));h=
b&&(ri(b,10)||ri(b,9))||!1;if(!b||h||!ri(b,19))for(a=a.qh(),h=0;h<a.length;++h)f.Ha(sWi(d,a[h],c,void 0,b?b:void 0),!0);b&&nVi(d,f,e,c,b);d.xa[e]=c;l.pe(f);oVi(f.La(),!0);l.dispatchEvent("load");d.Ia.push(e)}else{b=a.Rg();if(d.KA(b)){d.KA(b);c=d.H[b];delete d.H[b];d.D.removeChild(c,!0);if(d.L)for(e=d.Aa[b],l=0;l<e.length;++l)d.L.vR(e[l]);delete d.Aa[b];c.dispose()}10<=ie(d.H)||(b=[],a.qh(),c=a.Rg(),a=sWi(d,a,b,"Ctrl+Alt+Shift+").Bb(),oVi(a.La(),!1),a=new Vu(c,a,pWi.getInstance(),void 0,!0),e=d.D.kc()?
d.D.kc()-1:0,d.D.zf(a,e,!0),d.H[c]=a,d.Aa[c]=b)}}};p.Tvb=function(a){a=a.C();var b=a.Rg();b?oXi(b,w(function(c){var d=Af(c.getUrl());Zd(d)||this.C.p6a(d);d=Af(c.getFunctionName());Zd(d)||tXi(this,J(c,1),d,J(c,4)||void 0,void 0,c.ir()||void 0)},this,a)):ZWi()};
p.Uvb=function(a){var b=a.C();a=b.getText();b=b.lk();var c=this.C.Ea,d=Xl("docs-script-button-bar");d&&($Wi(c),Zd(Af(a))||(a=xr(ZVi,{caption:a}),om(d,a),Zd(Af(b))||(c.C=new tt,c.C.Ob("docs-script-button-bar-bubble"),c.C.setContent(xr($Vi,{text:b})),c.C.Ci(a),ut(c.C,!0),c.C.dC=!1,c.C.setPosition(1,1),c.C.Vo(!1),c.C.render(d),c.D.listen(a,"mouseover",w(c.C.setVisible,c.C,!0)).listen(a,"mouseout",w(c.C.setVisible,c.C,!1)))))};
p.Svb=function(a){this.C.vO();var b=a.C(),c=xi(b,6,!1);a=c?J(b,3).replace(/\n/g," ").replace(/\\n/g,"\n"):J(b,3);var d=J(b,7),e=this.C,f=b.getTitle(),h=J(b,4),k=xi(b,5,!1);b=w(this.kbc,this,J(b,1),c,d);e.D&&(e.D.setVisible(!1),Rv(e.F,e.D));e.D=new fXi(f,a,h,k,b);e.D.Oi=!0;e.F.Ah(e.D);e.D.setVisible(!0)};p.kbc=function(a,b,c,d,e){var f=new AVi;K(f,1,d);K(f,3,b);K(f,4,c);null!==e&&K(f,2,e);O("macros-resume").kb([a,mn(f.Gb())])};
p.Qvb=function(a){a=a.C();var b=Lye(M(a,qS,9));var c={};c.mid=this.O.L;b=Ie(b,c);switch(a.Tk()){case 1:var d=this.C;c=J(a,3);var e=this.R,f=a.getTitle()||void 0;if(d.dispatchEvent(new eXi(b,c,e,f))){var h=d.ma;d=d.xa.Pb;d.yb()||(d.render(),d.resize());d.nea();var k=d.qa();k.Ce(d.H,f||"Apps Script application");f=w(h.Db,h,3);d.C=new OWi(b,c,[new NWi("google.script.host.close",w(d.nea,d),0),new NWi("google.script.host.editor.focus",f,0)],e,k);Yf(d.C,f);d.Ha(d.C,!0);O("macros-application-focus").kb()}this.Ma=
J(a,7)||null;break;default:c=this.C,e=J(a,3),f=this.R,h=a.getTitle()||void 0,d=a.getWidth()||void 0,k=a.getHeight()||void 0,a=xi(a,8,!1),c.D&&(c.D.setVisible(!1),Rv(c.F,c.D)),c.D=new PWi(b,e,f,c.ma,h,d,k,a),c.D.Oi=!0,c.F.Ah(c.D),c.D.setVisible(!0)}};p.Rvb=function(a){a=a.C();var b=a.getType();this.Ra(b,a.getText(),a.getTitle()||void 0,J(a,4)||void 0)};
p.Ovb=function(a){if(Os().C){if(!this.ea||this.ea.isDisposed()){a=Tl();var b=Em(a,"docs-hub-open-external-appbarbutton");this.ea=new Aud(b,a,"A script attached to this file needs your permission to run. To give permission, open in a new tab and rerun the script.","Authorization required");this.oa(this.ea);jr(this.ea,b)}}else a=a.C(),(b=M(a,wVi,3))&&(oi(b,2)||oi(b,11))?(b=new mUi(J(b,2),J(b,11)),ri(a,4)?(b=this.F.getExtension(b),null!=b&&ri(b,10)?(b="The add-on "+(b.getName()+" needs your permission to run in this document."),
a=a.getUrl(),new TWi(a,(new Tw).format(""),void 0,void 0,b)):(a=a.getUrl(),new TWi(a,(new Tw).format("A script attached to this document needs your permission to run."),void 0,void 0,"Updated add-on"))):this.F.DV(b)):(a=a.getUrl(),new TWi(a,(new Tw).format("A script attached to this document needs your permission to run."),void 0,void 0,void 0))};p.Pvb=function(a){a=a.C();tXi(this,J(a,1),a.getFunctionName(),J(a,4)||void 0,void 0,a.ir()||void 0)};
p.W2b=function(a){a=a.data;var b=rVi(this.F,a.C);!b||ri(b,9)?tXi(this,a.C,a.functionName,a.F||void 0,1,a.D||void 0):this.F.DV(N7(b))};p.Mcc=function(a){eVi(this.C);var b=a.data;a=b[0];b=b[1];var c=w(function(){this.C.C.C.postMessage(Nu("Error resuming script execution","warning",!0))},this);WVi(this.ma,a,b,c)};p.I7b=function(){this.C.H.setVisible(!0);sXi(this)};
p.tAa=function(a){var b=a.data;a=b?b.scriptId:void 0;a=new gl(tVi(this.O,a?a:void 0));b&&(a=b.editorUri?new gl(b.editorUri):a,b.filename&&a.xc("f",b.filename),b.lineNumber&&(a.xc("l",b.lineNumber),a.xc("s",b.lineNumber)));b=this.L.D;var c=null;Go(this.L.C)||(c=Qie("Loading\u2026",{target:"MacroService"+Fha(b)}));this.L.C.Ws(w(this.C.Qsc,this.C,a.toString(),this.O.F,b,this.R,c))};p.U_a=function(){this.F.DV()};
p.H7b=function(a){if(a.data)this.F.DV(a.data);else{a=this.F;var b=cVi(a,!0),c=a.R;var d=c.F;b=zUi(d,d.D,b,void 0,!0);d=AUi(d,b);c.C=d;d=c.C;c.D.Ah(d);d.setVisible(!0);dVi(a)}};
p.m3b=function(a){var b=this.F,c=rVi(b,a.data);if(c){var d=N7(c);a=w(b.A7a,b,d,M7(c),c.getName(),J(c,6)||void 0,J(c,11)||void 0);d=w(b.DV,b,d);var e=ri(c,19)||void 0,f=b.C,h=c.getName(),k=Af(J(c,7)),l=J(c,6)||void 0;c=J(c,11)||void 0;e=void 0===e?!1:e;f.J&&!f.J.isDisposed()&&(Rv(f.F,f.J),f.J.dispose());f.J=new cXi(h,k,a,d,l,c,e);f.J.Oi=!0;f.F.Ah(f.J);f.J.setVisible(!0);dVi(b)}};
p.r6b=function(a){if(a.data){var b=rVi(this.F,a.data);if(null!=b)if(a=this.F,b=N7(b),a.H){a:{if(1==a.H)b="Add-ons aren't allowed in your domain. Talk to your domain administrator for more information.";else if(2==a.H)b="Add-ons aren't allowed while in safe mode.";else break a;DXe(a.ea,"Oops",b,void 0,void 0,"Close")}hVi(a)}else{var c=a.getExtension(b);c&&ri(c,9)?(b=a.getExtension(b).getName(),b=$d(b+" is already installed"),a.C.C.C.postMessage(Nu(b,"info",!1,2500)),hVi(a)):a.DV(b)}}};
p.e3b=function(a){"edit"==a.key?(a=a.target.Os.qf(),a=tVi(this.O,a?a.L3a:void 0),this.tAa(new Ap({editorUri:a}))):"new"==a.key?this.tAa(new Ap({editorUri:this.O.ea})):"reload"==a.key?sXi(this):"run"==a.key&&(a=a.target.Os.qf(),tXi(this,a.L3a,a.getFunctionName(),void 0,void 0,a.ir()))};p.OE=function(a){(a=this.Ea[a])&&(a=rWi(this.C.O,a))&&a.isEnabled()&&a.dispatchEvent("action")};p.a3b=function(){for(var a=this.C,b=0;b<a.R.length;b++){var c=a.R[b];c.close();c.dispose()}a.R=[]};
function uXi(a,b){var c=[];J(b,3)&&c.push(b);b=b.qh();for(var d=0;d<b.length;d++)c=c.concat(uXi(a,b[d]));return c}p.getView=g("C");function qXi(a){return a==(Ku(),Hu)||a==(Ku(),Ju)||a==(Ku(),Iu)}function rXi(a,b){return b&&(a==(Ku(),Hu)||a==(Ku(),Iu))};function vXi(a,b,c,d,e,f,h){B.call(this);var k=this;this.C=a;this.L=b;this.eb=e;this.F=d;this.ma=new Kl;this.D=f;this.xa=h;this.R=new mu(this);this.oa(this.R);this.R.Ab(jlb,sp,this.J);this.ea=new Ml(this);this.oa(this.ea);this.ma.wb(this.F.F,function(){return k.J()});this.H=new a3a(this.eb.Lb(),!0);this.oa(this.H);this.O={};this.J()}v(vXi,B);vXi.prototype.J=function(){var a=wXi(this),b=this.L.Bb(Tz.getId(),!0);b.qd(!0);dv(this.L,b,[new EPe(a,this.C)]);bs(b.getElement(),"waffle-action-menu")};
function wXi(a){var b=Array.from(a.F.C.values());rTi(b,function(t){return nh(t,8)});var c=Array.from(a.F.D.values());pv(a.xa,xgd(0<b.length,0<c.length));Sz.setProperty("visible",!0);Rz.setProperty("visible",!0);var d={};c={};b=ha(b);for(var e=b.next();!e.done;c={Apa:c.Apa},e=b.next()){e=e.value;var f=nh(e,1),h=e.getFunctionName(),k=nh(e,8),l=ih(e,9)?nh(e,9):null,n="recorded-action-"+f+":"+h,q=a.C.Me(n);q||(q=(new Wp(n)).enabled(!0),q.Fa(29583),q=q.build(),c.Apa=new eUi(f,h,void 0,void 0,void 0,ih(e,
12)?e.ir():void 0),q.Ab(zp,function(t){return function(){a.C.Ga("macros-exec").kb(t.Apa)}}(c)),C2a(a.H,[q]),a.C.Gn(q),a.D&&a.D.Qh(q));q.setProperty("label",k);xXi(a,l)&&q.setProperty("keys",[l]);null==l&&null!=q.getProperty("keys")&&q.setProperty("keys",null);d[n]=q}ee(a.O,function(t,u){d[u]||(t.setProperty("keys",null),a.C.tP(u),a.D&&a.D.vR(u),Wf(t))});a.O=d;return je(d)}function xXi(a,b){return!jlb.vd()&&null!=b&&/^Ctrl\+Alt\+Shift\+\d$/i.test(b)&&0==(a.H.C[jc(b)]||[]).length};function yXi(a,b){this.RFa=a;this.Wna=b};function zXi(){var a='<div class="waffle-recording-toast" role="complementary" tabIndex="0" aria-describedby="waffle-recording-toast-content"><div class="waffle-recording-toast-top"><div class="waffle-recording-toast-icon"><div class="waffle-recording-toast-outer-circle"><div class="waffle-recording-toast-inner-circle"></div></div></div><div class="waffle-recording-toast-content"><div class="waffle-recording-toast-new-content"></div><div class="waffle-recording-toast-default-content">Recording new macro\u2026</div></div><div class="waffle-recording-toast-right"><div class="waffle-recording-toast-cancel">Cancel</div><div class="waffle-recording-toast-stop">Save</div><div class="waffle-recording-toast-expand-section"><div class="waffle-recording-toast-expand"><div class="waffle-recording-toast-expand-icon"></div></div></div></div></div><div class="waffle-recording-toast-bottom" role="radiogroup"><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-absolute">'+
NO(void 0,void 0,void 0,void 0,void 0,Fr('Use absolute references<div class="waffle-recording-toast-label-description">When applying macro use exact location as recorded</div>'));a=a+'</div></div><div class="waffle-recording-toast-relativity-split"><div class="waffle-recording-toast-relative">'+NO(void 0,void 0,void 0,void 0,void 0,Fr('Use relative references<div class="waffle-recording-toast-label-description">When applying macro use active selection</div>'));return T(a+"</div></div></div></div>")}
;function AXi(a,b){S.call(this,b);this.R=a;this.J=new wt("",new Yv,this.qa());this.Ha(this.J);this.F=new wt("",new Yv,this.qa());this.Ha(this.F);this.D=new ou;this.oa(this.D);this.H=null;this.C=0}v(AXi,S);p=AXi.prototype;p.Ca=function(){this.mb(xr(zXi))};
p.Ja=function(){S.prototype.Ja.call(this);this.O=new FV(this.qa(),void 0,"relative");this.L=new FV(this.qa(),void 0,"absolute");this.O.Wa(this.Da("waffle-recording-toast-relative"));this.L.Wa(this.Da("waffle-recording-toast-absolute"));var a=se(ru);qe(a,"selected",!0);var b=nq(new mq,6).build();qu(this.D,this.O,Vz,a,void 0,b);qu(this.D,this.L,Wz,a,void 0,b);qu(this.D,this.J,this.R.Ga("recorded-action-stop"),void 0,void 0,b);qu(this.D,this.F,Qz,void 0,void 0,b);this.H=new BJ(this.Da("waffle-recording-toast-expand"),
this.Da("waffle-recording-toast-bottom"),llb.isVisible(),void 0,this.qa());this.oa(this.H);this.getHandler().listen(this.H,"toggle",this.Zbc);this.J.Wa(this.Da("waffle-recording-toast-stop"));this.F.Wa(this.Da("waffle-recording-toast-cancel"))};p.setVisible=function(a){var b=this.La();P(b,a);Vr(b,"hidden",!a);a&&(a=this.qa().Lb(),a=hm(a)||window,b=Xq(this.La()),this.La().style.left=Math.max(Math.floor(gm(a).width/2-b.width/2),0)+"px")};
function BXi(a,b){a.Da("waffle-recording-toast-default-content").style.opacity=0;var c=a.Da("waffle-recording-toast-new-content");a.qa().Ce(c,b);0!=a.C?CXi(a):(qn(a.C),a.C=pn(function(){return CXi(a)},400))}function CXi(a){var b=a.Da("waffle-recording-toast-new-content");ds(b,"waffle-recording-toast-slide-in");qn(a.C);a.C=pn(function(){bs(b,"waffle-recording-toast-slide-in");qn(a.C);a.C=pn(function(){return DXi(a)},2200)})}
function DXi(a){var b=a.Da("waffle-recording-toast-default-content"),c=a.Da("waffle-recording-toast-new-content");ds(c,"waffle-recording-toast-slide-in");b.style.opacity=1;qn(a.C);a.C=pn(function(){a.C=0},400)}p.Zbc=function(a){llb.setVisible(a.JI)};p.Na=function(){qn(this.C);S.prototype.Na.call(this)};function EXi(a,b,c,d,e){B.call(this);var f=this;this.L=a;this.J=c;this.D=d;this.C=N().kVb()(N().uu()(),N().KTb()(),P7(this),Vz.vd(),function(h){h="Action "+(N().jVb()(f.C)+(": "+h));FXi(f,h)},N().NYa()());N().dZa()(this.C);this.H=new AXi(e);this.oa(this.H);this.Ea=new mu(this);this.oa(this.Ea);this.Ea.Ab(Vz,zp,this.Zhc,this).Ab(Wz,zp,this.Yhc,this).Ab(O("docs-doc-copy-made"),zp,this.C1b,this).Ab(O("macros-exec"),zp,this.jdc,this).Ab(agb,zp,function(h){return GXi(f,h.data,2)},this).Ab(ggb,zp,function(h){return GXi(f,
h.data,3)},this).Ab($fb,zp,function(h){return GXi(f,h.data,1)},this).Ab(bgb,zp,function(h){return GXi(f,h.data,5)},this).Ab(Xgb,zp,function(h){return GXi(f,h.data,4)},this).Ab(Ax,zp,function(h){h=h.data;switch(h.F){case "all-objects-for-all-datasources":N().$Ub()(f.C,P7(f));break;case "all-objects-for-single-datasource":N().aVb()(f.C,P7(f),h.D);break;case "specific-ids":var k=h.C;if(!(0<(y(A(),"feds")?N().bya()(k):[]).length)){var l=h.C[0];h=N().qF()(l);k=null;switch(h){case 4:k=HXi(f,l,!1);break;
case 1:case 3:case 5:(l=N().pWa()(l,qU(f.J)))&&0<l.length&&(k=io(l[0]),k=ro(qo(po(lo(),k.gb()),k.fc()),k.Mb()).build(),l=uTi(),3==h?(vTi(l),Eh(l,6,k)):1==h?(vTi(l),Eh(l,5,k)):5==h&&(vTi(l),Eh(l,4,k)),k=l.build().pb());break;case 2:(l=N().oWa()(l))&&0<l.length&&(k=tTi(l[0]).build().pb())}k&&N().hZa()(f.C,P7(f),h,k)}}}).Ab(mgb,zp,function(){return N().bVb()(f.C,P7(f),!1)},this).Ab(Zfb,zp,this.X_b,this).Ab(cgb,zp,function(h){return N().WUb()(f.C,P7(f),h.data.pb())},this);this.F=new Kl;this.oa(this.F);
this.F.wb(a.$a,function(){N().pVb()(f.C,!0,P7(f))});this.F.wb(a.Pa,function(h){if(h.D){var k=h.C.D();"docs-edit"==k?"ritz-waffle"==h.C.C&&N().mVb()(f.C,P7(f)):"docs-undo"==k?(FXi(f,"Undo previous action"),N().qVb()(f.C)):"docs-redo"==k&&(FXi(f,"Redo previous action"),N().nVb()(f.C))}});this.F.wb(b.ma,function(h){h.C||N().gVb()(f.C,P7(f),h.D)});this.F.wb(this.D.xb,function(h){return IXi(f,h)});this.F.wb(this.D.Qc,function(){f.ma=P7(f)});this.F.wb(this.D.Lc,function(h){switch(h.D){case "find-next-occurrence":N().XUb()(f.C,
f.ma,P7(f),h.C.pb());break;case "replace-current-occurrence":N().cVb()(f.C,P7(f),h.C.pb())}f.ma=null});this.F.wb(this.D.$a.D,function(h){N().fVb()(f.C,P7(f),h.F,h.H,h.J,h.L,h.id,h.C,h.D)});this.F.wb(b.Rq,function(){N().UUb()(f.C,f.Aa,P7(f),f.xa);f.Aa=null;f.xa=null});this.F.wb(this.D.Pc,function(h){N().VUb()(f.C,f.O.D.C.pb(),h.getSelection().C.pb(),f.O.C.pb());f.O=null});this.ea=new Ml(this);this.oa(this.ea);this.O=this.ma=this.xa=this.Aa=this.R=null;this.ea.listen(this.D.C,"na",this.Wvb).listen(this.D.C,
"ta",this.Vvb);this.H.render();this.H.setVisible(!0);JXi(this);setTimeout(function(){return GG("All actions are now being recorded. Please use the Tools menu to cancel or save recording.")})}v(EXi,B);p=EXi.prototype;p.Vvb=function(){this.R=P7(this)};p.Wvb=function(a){!a.nG&&hJ(this.D)&&(void 0!==a.jY?(a=a.jY,N().hVb()(this.C,this.R,P7(this),a)):(a=this.D.C.C.Td(),BXi(this.H,"Activating sheet "+a),N().iVb()(this.C,this.R,P7(this),a)),this.R=null)};
function FXi(a,b){BXi(a.H,b);GG("Macro recorder "+b)}function KXi(a){return N().lVb()(a.C,P7(a))}p.jdc=function(a){this.xa=a.data.functionName;this.Aa=P7(this)};function IXi(a,b){var c=P7(a);a.ea.Nc(a.D,"dc",function(){var d=P7(a);switch(b.H){case "adjust-next-data-region-edge":N().TUb()(a.C,c,d,b.D,b.C);break;case "move-next-data-region-edge":N().ZUb()(a.C,c,d,b.D,b.C);break;case "select-all":N().dVb()(a.C,c,d);break;case "select-rows-columns":N().eVb()(a.C,c,d,"c"==b.F)}})}
p.C1b=function(a){a=a.data;N().YUb()(this.C,P7(this),a.C)};p.X_b=function(a){a=a.data;var b=this.L.C.getSelection();this.O=new LXi(a,b)};
function GXi(a,b,c){var d=N().hZa(),e=a.C,f=P7(a);a:switch(c){case 4:b=HXi(a,b,!0);break a;case 3:case 1:case 5:var h=YG(a.J);h?(a=vo(a.L.C.getSelection()),MXi(b,a,h)?b=null:(a=gDc(h),MXi(b,a,h)?(b=bG(h.Sa().Xf(a.y,a.x)),b=null!=b?b:ro(qo(po(lo(),h.O.C.C.gb()),a.y),a.x).build(),h=uTi(),3==c?(vTi(h),Eh(h,6,b)):1==c?(vTi(h),Eh(h,5,b)):5==c&&(vTi(h),Eh(h,4,b)),b=h.build().pb()):b=null)):b=null;break a;case 2:if(h=YG(a.J)){a=a.L.C.getSelection();var k=Z2e(h);b=k&&oh(a.C,6).Gb().includes(k)?null:(a=X2e(h))&&
b==Y2e(h)?tTi(a).build().pb():null}else b=null;break a;default:b=null}d(e,f,c,b)}function MXi(a,b,c){if(!b)return!1;b=c.Sa().Xf(b.y,b.x);c=fDc(c,b);return a==c}function HXi(a,b,c){if(c&&(a=a.D.C.C)&&AC(a))return null;b=N().JN()(b);if(!b)return null;(b=N().nT()(b))?(a=uTi(),vTi(a),b=yh(a,2,b).build().pb()):b=null;return b}p.Zhc=function(){var a=!N().iZa()(this.C);NXi(this,!0);a&&(BXi(this.H,"Using relative references"),GG("Recording with relative references"))};
p.Yhc=function(){var a=N().iZa()(this.C);NXi(this,!1);a&&(BXi(this.H,"Using absolute references"),GG("Recording with absolute references"))};function NXi(a,b){N().oVb()(a.C,b);Vz.wc(b);Wz.wc(!b)}function JXi(a){(a=YG(a.J))&&WL(a)}function P7(a){return a.L.C.getSelection().C.pb()}p.Na=function(){N().sYa()();B.prototype.Na.call(this)};function LXi(a,b){this.C=a;this.D=b};function OXi(a,b,c,d,e){aw.call(this,"Macro saved",Tl(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-saved"]);this.Ta=a;this.L=b;this.Ra=c;this.Ia=d;this.J=e}v(OXi,aw);OXi.prototype.Ca=function(){aw.prototype.Ca.call(this);var a=kr(this,"script-recorder-edit-link-id");this.Ss("EDIT SCRIPT",a)};OXi.prototype.Ja=function(){aw.prototype.Ja.call(this);this.getHandler().Ye(or(this,"script-recorder-edit-link-id"),El,w(this.Qa,this,this.Ta,this.L,this.Ra))};
OXi.prototype.Qa=function(a,b,c){this.Ia.C(29645);this.J.Ga("macros-editor").kb(b?{scriptId:a,filename:b,lineNumber:c}:void 0)};function PXi(a,b,c,d,e,f,h,k,l,n){lv.call(this);var q=this;this.Aa=a;this.ma=b;this.Qa=c;this.Ma=d;this.ea=e;this.H=f;this.Ia=h;this.xa=k;this.L=n;this.J=this.H.ud();this.Ea=new mu(this);this.oa(this.Ea);this.F=null;this.R=!1;this.C=null;this.Pa=l;this.Ea.subscribe(Uz,"action",this.Zwc).subscribe(this.J.Ga("recorded-action-stop"),"action",this.Vyc).subscribe(mlb,"action",this.zvc).subscribe(Qz,"action",this.tGb).subscribe(Rz,"action",this.Bxc).subscribe(Sz,"action",this.Hxc);ov(this,QXi(this));xq(this.H,
this);a=["not-revisions","sheet-access-edit",vv()];var t=new wq(a.concat(["docs-script-recording"]));md([Qz,this.J.Ga("recorded-action-stop"),mlb,klb,Wz,Vz],function(u){q.H.C(u,t);q.H.D(u,t)});a=new wq(a.concat(["not-docs-script-recording"]));this.H.C(Uz,a);Uw()||this.H.D(Uz,a)}v(PXi,lv);p=PXi.prototype;p.Zwc=function(){var a=this;this.F=new EXi(this.Qa,this.Ma,this.ea,this.Ia,this.J);pv(this,QXi(this));this.Ia.D.C.Ws(function(){cp(wk(dp(a.Aa.Oe("/startrecordingscript"),"POST"),1).setTimeout(18E4)).Re()})};
p.Vyc=function(){ZG(this.ea)&&XK(YG(this.ea),!0);this.F.H.setVisible(!1);N().sYa()();nTi(this.ma)};
p.zvc=function(a){var b=this,c=a.RFa;a=a.Wna;var d=KXi(this.F).sourceCode();RXi(this,dw(this.L,"Saving new macro",Tl(),!0,0,!1,void 0,!0,["waffle-recording-toast-saving"]),!0);this.R=!0;pv(this,QXi(this));cp(xk(yk(wk(dp(vk(vk(Uo(this.Aa.Oe("/saverecordedscript"),["script",d]),"name",c),"shortcut",""!=a?"Ctrl+Alt+Shift+"+a:""),"POST"),1),function(e){var f=e.OT("scriptId"),h=e.OT("filename");e=Number(WG(e,"lineNumber"));f=new OXi(f,h,e,b.Pa,b.J);ew(b.L,f);RXi(b,f);b.R=!1;SXi(b)}),function(){RXi(b,dw(b.L,
"Failed to save macro",Tl(),!1,1E4,!0,void 0,!0,["waffle-recording-toast-save-failed"]));b.R=!1;if(b.F){var e=b.F;N().dZa()(e.C);e.H.setVisible(!0)}pv(b,QXi(b))}).setTimeout(18E4)).Re()};function SXi(a){Wf(a.F);a.F=null;pv(a,QXi(a))}p.tGb=function(){SXi(this);setTimeout(function(){return GG("Script recording canceled")})};function QXi(a){var b={},c=!!a.F;a=a.R;b["docs-script-recording"]=c&&!a;b["not-docs-script-recording"]=!c&&!a;return b}p.Bxc=function(){oTi(this.ma,this.xa)};
p.Hxc=function(){pTi(this.ma,this.xa)};function RXi(a,b,c){a.C&&(fw(a.L,a.C),a.C.setVisible(!1),Wf(a.C));a.C=b;a.C.render();c&&(new sAf(!0,Tl())).render(em("docs-ui-toast-content",b.getElement()));a.C.setVisible(!0)}p.Na=function(){Wf(this.F);this.F=null;this.C&&(Wf(this.C),this.C=null);lv.prototype.Na.call(this)};function TXi(a,b,c,d){1==a&&tRb(uf(c||""),uf(b),void 0!==d?d:-1,!0)};function UXi(a,b,c,d,e,f,h,k,l,n,q,t,u,z,E,L,R,Q,ba){B.call(this);this.R=a;this.ma=b;this.Aa=c;this.Ea=d;this.O=e;this.Qa=f;this.Pa=h;this.C=k;this.F=l;this.Ma=n;this.Ia=q;this.ea=t;this.Ra=u;this.L=new Ml(this);this.oa(this.L);this.xa=new ETi(this.Aa,this.F);this.$a=new PXi(this.Aa,this.O,this.ma,this.R,this.C.D,E,this.F,this.xa,L,R);this.oa(this.$a);this.J=E.ud();this.Ya=new vXi(this.J,this.C.Aa.C,l,this.xa,z,this.C.Aa.Ma,Q);this.oa(this.Ya);this.D=null;this.H=ba}v(UXi,B);
UXi.prototype.init=function(){var a=this.C.Aa.Ma;a.Qh(Uz);a.Qh(Qz);a.Qh(this.J.Ga("recorded-action-stop"));a.Qh(Vz);a.Qh(Wz);a.Qh(Rz);a.Qh(Sz);a=this.F.ub.D;var b=this.F.ub.C;b&&(b+=a?"_"+a:"");a=A();var c=y(a,"docs-tintd")&&y(a,"docs-thtea");this.D=new $Fe(this.Ea,this.ma.C,this.C.D);this.oa(this.D);var d=this.R,e=LMa(this.Ia),f=MMa(this.Ia),h=this.O,k=this.Qa,l=this.Pa,n=w(this.ea.O,this.ea),q=w(this.D.C,this.D),t=(Ku(),Iu),u=this.Ma,z=this.Ra,E=this.Ea,L=Yw(rw.getInstance()),R=this.C.Aa.C;L=void 0===
L?!1:L;c=void 0===c?!1:c;var Q=A();Q=new sVi(hd(Q,"maestro_container_token"),hd(Q,"maestro_domain"),hd(Q,"maestro_script_editor_uri"),hd(Q,"maestro_new_project_uri"),y(Q,"docs-emae"),hd(Q,"mae-pai"),y(Q,"mae-cwssw"),y(Q,"mae-aoeba"),y(Q,"mae-esme"),hd(Q,"mae-dret"),hd(Q,"mae-ses"),y(Q,"docs-tdd"),y(Q,"mae-seitd"));e=new RUi(d.D,String(E),e,void 0);E=new UVi;E.bind(f);f=Q.C?2:Q.D?0:1;var ba=new ou(void 0,void 0,!0,nw.getInstance());l=l?new qWi(l,ba,f,R,void 0):null;d=new pXi(d,Q,e,E,h,k,l,n,q,t,u,
z,L,TXi,HSc,b,c);d.oa(e);d.oa(E);d.start();O("macros-addon-sidebar").Oa(qXi(t));O("macros-addon-sidebar-focus").Oa(rXi(t,c||!1));O("macros-application-focus").Oa(!0);O("macros-application-sidebar").Oa(!0);O("macros-editor").Oa(!Q.xa||Q.J);O("macros-exec").Oa(!0);O("macros-extension-disabled").Oa(!0);O("macros-extension-help").Oa(!0);O("macros-extension-install-start").Oa(!0);O("macros-extension-menu-promo").Oa(!0);O("macros-manage").Oa(!0);O("macros-resume").Oa(!0);O("macros-trigger-0").Oa(!0);O("macros-trigger-1").Oa(!0);
O("macros-trigger-2").Oa(!0);O("macros-trigger-3").Oa(!0);O("macros-trigger-4").Oa(!0);O("macros-trigger-5").Oa(!0);O("macros-trigger-6").Oa(!0);O("macros-trigger-7").Oa(!0);O("macros-trigger-8").Oa(!0);O("macros-trigger-9").Oa(!0);null!=this.H&&(a=y(a,"docs-isctp"),this.H.ea=a,this.L.listen(d.J,"scpep",w(this.Va,this)));this.L.listen(EG,"runMacro",w(this.Ta,this))};UXi.prototype.Va=function(a){null!=this.H&&(a=ri(a.C(),1),this.H.ea=a)};
UXi.prototype.Ta=function(a){var b=a.payload;a=rd(N().FT()(),vpa);a=vd(a,function(c){return c.getFunctionName()==b});null!=a&&ih(a,1)?this.J.Ga("macros-exec").kb(new eUi(nh(a,1),b,void 0,void 0,void 0,ih(a,12)?a.ir():void 0)):FG("Script function "+(b+" could not be found"))};function VXi(a){var b=a.NGa;a='<div class="waffle-record-script-dialog-name-section"><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-name-input" id="waffle-record-script-name-input-label">Name</label></div><div class="waffle-record-script-name"><input class="waffle-record-script-name-input jfk-textinput" id="waffle-record-script-name-input" maxlength="50" aria-labelledby="waffle-record-script-dialog-description-id waffle-record-script-name-input-label"/></div></div><div class="waffle-record-script-dialog-label"><label for="waffle-record-script-shortcut-input">Shortcut (optional)</label></div><div class="waffle-record-script-shortcut"><label for="waffle-record-script-shortcut-input" id="waffle-record-script-shortcut-input-label">'+
(Ar(b)+'</label><input class="waffle-record-script-shortcut-input jfk-textinput" id="waffle-record-script-shortcut-input" maxlength="1" aria-labelledby="waffle-record-script-shorcut-description-id"/><div id="waffle-record-script-shorcut-description-id" style="display:none;">');b="Optional numeric shortcut key, use with "+(Ar(b)+" to run macro.");return T(a+b+"</div></div>")};function WXi(a,b){Qv.call(this,void 0,void 0,b);this.mq=!1;As(this,!1);this.F=new wv;this.Ha(this.F);this.H=new kW(this.qa());this.Ha(this.H);this.L=new wv("Number");this.Ha(this.L);this.C=new kW(this.qa());this.Ha(this.C);Bs(this,(new ys).sf({key:"discard",caption:"Discard"},!1).sf(XXa,!0))}v(WXi,Qv);p=WXi.prototype;
p.Ca=function(){Qv.prototype.Ca.call(this);y(A(),"docs-egmd")?(bs(ws(this),"waffle-record-script-dialog-gm"),Ns(this,"save")):bs(ws(this),"waffle-record-script-dialog");this.setTitle("Save new macro");this.zb().appendChild(xr(VXi,{NGa:Rp?"\u2318 + Option + Shift +":"Ctrl + Alt + Shift +"}))};
p.Ja=function(){Qv.prototype.Ja.call(this);this.F.Wa(this.Da("waffle-record-script-name-input"));y(A(),"docs-egmd")||bs(this.Da("waffle-record-script-name"),luf.getInstance().jc());this.F.setValue("Untitled Macro");var a=this.F.La();this.H.setPosition(3,2);this.H.render();this.H.Ci(a);nW(this.H,a);mW(this.H);this.L.Wa(this.Da("waffle-record-script-shortcut-input"));y(A(),"docs-egmd")||bs(this.Da("waffle-record-script-shortcut"),luf.getInstance().jc());var b=this.L.La();this.C.setPosition(3,2);this.C.render();
this.C.Ci(b);nW(this.C,b);mW(this.C);this.getHandler().listen(this,"dialogselect",this.Xvb).listen(a,["focus","blur","change"],this.r9b).listen(b,["focus","blur","change"],this.Lec)};p.focus=function(){Qv.prototype.focus.call(this);zv(this.F)};p.r9b=function(){""!=this.F.getValue()&&mW(this.H)};p.Lec=function(){XXi(this)&&mW(this.C)};
p.Xvb=function(a){var b=this,c=nq(new mq,12).build();if("discard"==a.key)Qz.kb(void 0,c);else if("save"==a.key)if(""!=this.F.getValue()||lW(this.H,"Must not be empty.",!0),XXi(this)||setTimeout(function(){lW(b.C,"Must be a number from 0 to 9 or blank.",!0)}),YXi(this)&&setTimeout(function(){lW(b.C,"Conflicts with another shortcut.",!0)}),""!=this.F.getValue()&&XXi(this)&&!YXi(this)){a=this.F.getValue();var d=this.L.getValue();mlb.kb(new yXi(a,d),c)}else a.preventDefault()};
function XXi(a){a=a.L.getValue();return""==a||/^\d$/.test(a)}function YXi(a){var b="Ctrl+Alt+Shift+"+a.L.getValue();return N().FT()().map(vpa).some(function(c){return ih(c,9)&&nh(c,9)==b})};function ZXi(){Vn.apply(this,arguments)}v(ZXi,Vn);ZXi.prototype.F=function(){return UXi};ZXi.prototype.H=function(){return WXi};ZXi.prototype.C=function(a,b,c,d){return new JTi(a,b,c,d,void 0)};ZXi.prototype.D=function(a,b,c){return new ZTi(a,b,c,void 0)};Eo("ritzmaestro",ZXi);
