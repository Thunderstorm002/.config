dod.prototype.M$=y(459,function(){if(!this.isDisposed()){var a=this.Ka(eod.mta),b=nh("Estimating\u2026");th(a,b);this.Ec()&&(nq(a,!0),a=this.Ka(eod.Laa),nq(a,!1))}});god.prototype.M$=y(458,function(){this.C["refresh-query"].M$()});pod.prototype.M$=y(457,function(){this.C.M$()});function Dvp(){return Yt.rb().C.newDatasourceFromOnboarding}function Evp(){return!!Yt.rb().C.showBigQueryProjectSelectionOnStart}function Fvp(a){var b=[];a.C.forEach(function(c,d){cj(c,2)||b.push(d)});return b}
function Gvp(a){oj.call(this,a)}z(Gvp,oj);Gvp.prototype.getError=function(){return this.message.getError()};function Hvp(a){this.Jb=Zi(a,-1,0)}z(Hvp,$i);Hvp.prototype.zb=function(){return new Gvp(this)};Hvp.prototype.getError=function(){return lj(this,1,0)};function Ivp(a){oj.call(this,a)}z(Ivp,oj);Ivp.prototype.getStatus=function(){return this.message.getStatus()};Ivp.prototype.Mh=function(){return this.message.Mh()};Ivp.prototype.Kg=function(){return this.message.Kg()};Ivp.prototype.Nh=function(){return this.message.Nh()};
function Jvp(a){this.Jb=Zi(a,-1,0)}z(Jvp,$i);u=Jvp.prototype;u.zb=function(){return new Ivp(this)};u.getStatus=function(){return lj(this,6,0)};u.Mh=function(){return lj(this,7,0)};u.Kg=function(){return kj(this,8)};u.Nh=function(){return kj(this,9)};function Kvp(a){oj.call(this,a)}z(Kvp,oj);Kvp.prototype.getStatus=function(){return this.message.getStatus()};function Lvp(a){this.Jb=Zi(a,-1,0)}z(Lvp,$i);Lvp.prototype.zb=function(){return new Kvp(this)};
Lvp.prototype.getStatus=function(){return lj(this,1,0)};function Mvp(a){oj.call(this,a)}z(Mvp,oj);u=Mvp.prototype;u.cj=function(){return this.message.cj()};u.Cu=function(){return this.message.Cu()};u.Tj=function(){return this.message.Tj()};u.Tv=function(){return this.message.Tv()};u.qq=function(){return this.message.qq()};function Nvp(a){this.Jb=Zi(a,-1,0)}z(Nvp,$i);u=Nvp.prototype;u.zb=function(){return new Mvp(this)};u.cj=function(){return this.wc(1,Aj)};u.Cu=function(){return gj(this,2)};
u.Tj=function(){return ij(this,3)};u.Tv=function(){return cj(this,5)};u.qq=function(){return gj(this,5)};function Ovp(a){var b=void 0===b?bj(Nvp):b;b=new Mvp(b);return zj(b,1,a)}function Pvp(a){oj.call(this,a)}z(Pvp,oj);function Qvp(a){this.Jb=Zi(a,-1,0)}z(Qvp,$i);Qvp.prototype.zb=function(){return new Pvp(this)};function Rvp(a){oj.call(this,a)}z(Rvp,oj);function Svp(a){this.Jb=Zi(a,-1,0)}z(Svp,$i);Svp.prototype.zb=function(){return new Rvp(this)};function Tvp(a,b){return wj(a,1,b)}
function Uvp(a){oj.call(this,a)}z(Uvp,oj);Uvp.prototype.pea=function(a){return this.message.pea(a)};function Vvp(a){this.Jb=Zi(a,-1,0)}z(Vvp,$i);Vvp.prototype.zb=function(){return new Uvp(this)};Vvp.prototype.pea=function(a){return nj(this,2,a,Nvp)};function Wvp(a){oj.call(this,a)}z(Wvp,oj);Wvp.prototype.pea=function(a){return this.message.pea(a)};function Xvp(a){this.Jb=Zi(a,-1,0)}z(Xvp,$i);Xvp.prototype.zb=function(){return new Wvp(this)};Xvp.prototype.pea=function(a){return nj(this,1,a,Nvp)};
function Yvp(a){oj.call(this,a)}z(Yvp,oj);Yvp.prototype.getStatus=function(){return this.message.getStatus()};function Zvp(a){this.Jb=Zi(a,-1,0)}z(Zvp,$i);Zvp.prototype.zb=function(){return new Yvp(this)};Zvp.prototype.getStatus=function(){return lj(this,1,0)};function $vp(a,b){return new Cn(function(c,d){Oo(Vl(Wl(Ul(Po(Tl(a.C.gi("/answers/tablemetadata"),"did",b),"POST"),2),function(e){e=aj(Hvp,JSON.stringify(e.eh()));c(e)}),function(){d()})).Ci()})}
function awp(a,b){return new Cn(function(c,d){zx(a,"/dbx/createDelegation",[],b.Nb(),function(e){c(aj(Lvp,JSON.stringify(e.eh())))},d)})}function bwp(a,b){return new Cn(function(c,d){zx(a,"/dbx/updateDelegation",[],b.Nb(),function(e){c(aj(Zvp,JSON.stringify(e.eh())))},d)})}function cwp(a){Date.now()-a.D>a.F&&(a.D=Date.now(),a.C.clear())}function dwp(a,b){return a.C.has(b)?a.C.get(b):null}
function ewp(a,b){var c=new Set;b.forEach(function(d){a.ma.add(d);c.add(d)});d3c(a,c,"dbobjectmodel-event-update")}function fwp(a,b){a.D&&a.F&&b.forEach(function(c){a.D.C.has(c)?dwp(a.D,c)||a.F.C(116202):a.F.C(1162031)})}function gwp(a,b){a.F.C(36994);b||a.F.C(36995)}function hwp(a,b,c,d){RZj(a.J,b,function(e){var f=e.filter(function(h){return 2==h.cj().getState()});c(f);e=e.filter(function(h){return 2!=h.cj().getState()});d(e)},d,!0,2)}
function iwp(a,b){if(a.R&&b&&a.F){b=$k().JCc()(b.Eb());Nf(b)||cwp(a.D);for(var c=[],d=0;d<b.length;d++){var e=b[d];a.D.C.has(e)?(e=dwp(a.D,e),gwp(a,e)):c.push(e)}Nf(c)||hwp(a,c,function(f){f.forEach(function(h){h=h.Cu();a.D.C.set(h,!0);gwp(a,!0)})},function(f){f.forEach(function(h){var k=h.cj();k=cj(h,1)&&37==k.$h();h=h.Cu();a.D.C.set(h,!k);gwp(a,!k)})})}}function jwp(a,b,c,d){RZj(a.J,b,function(e){var f=e.filter(function(h){return 2!=h.cj().getState()});0==f.length?c(e):d(f)},d,!0)}
function kwp(a,b,c,d){hEk(a.J,b,c,d,!0)}function lwp(a){var b=yx.rb();return new Cn(function(c,d){WDk(b,"/dbx/delegations",function(e){c(aj(Svp,JSON.stringify(e.eh())))},d,["data",a.Nb()])})}function mwp(a){var b=yx.rb();return new Cn(function(c,d){zx(b,"/charts/score",[],a.Nb(),function(e){e=aj(Jvp,JSON.stringify(e.eh()));c(e)},d)})}function nwp(a){var b=yx.rb();b.F=a;b.C&&b.F.qW(b.C)}
function owp(a,b,c){return new Cn(function(d,e){bYb(c,function(){zx(a,"/dbx/refreshSlicerObject",a.D?["esid",a.D]:[],b.Nb(),function(f){f=aj(Xvp,JSON.stringify(f.eh()));d(f)},function(){var f=DWj(CWj().Nc(3),31).xa();f=Ovp(f).xa();var h=void 0===h?bj(Xvp):h;h=new Wvp(h);f=wj(h,1,f).xa();e(f)})})})}
function pwp(a,b,c){return new Cn(function(d,e){bYb(c,function(){zx(a,"/dbx/refreshObject",a.D?["esid",a.D]:[],b.Nb(),function(f){f=aj(Vvp,Ll(f.eh(),sra));d(f)},function(){var f=DWj(CWj().Nc(3),31).xa();f=Ovp(f).xa();var h=void 0===h?bj(Vvp):h;h=new Uvp(h);f=wj(h,2,f).xa();e(f)})})})}
function qwp(a,b,c){return new Cn(function(d,e){bYb(c,function(){zx(a,"/dbx/validateCalculatedColumn",[],b.Nb(),function(f){f=aj(RDk,JSON.stringify(f.eh()));d(f)},function(){var f=DWj(CWj().Nc(3),31).xa();f=SDk(f).xa();e(f)})})})}function rwp(a){return a.D["ritz-DisplayCountBigsheetsPromo"]}function swp(a){a.oa&&a.oa.Je(a.Va(),a.ma?5:1,new Hp(0,a.ma?50:0,12,a.ma?0:50))}function twp(a,b,c,d,e,f,h,k,l){oy.call(this,a,b,c,d,e,l);this.F=new pod(h,d.Cd(),k,l);this.Qa(this.F,!0);this.H=f;this.D=null}
z(twp,oy);twp.prototype.Ja=function(){var a=this.Ea().Ja("DIV","waffle-dbsource-container");this.Pb(a)};twp.prototype.Ra=function(){oy.prototype.Ra.call(this);this.D=new St(this.Va(),this.Ea());Tt(this.D)};twp.prototype.Xf=function(){ii(this.D);oy.prototype.Xf.call(this)};twp.prototype.focus=function(){var a=this.F;a.D.isVisible()&&a.D.isEnabled()&&(a.D.Va().focus(),a.D.Nz(!0));this.H.Nc(2)};
function uwp(a){var b=a.R.C.C;if(pv(b))return $k().PGb()(b.Eb());(b=tFk(a))||(b=(b=KFd(a))?LFd(a,b):null);if(b||(b=(b=uFk(a))?$k().wma()(b):null))return b;b=Vw(a.ob());return LFd(a,b)}function vwp(a,b){[a.R,a.Ha].forEach(function(c){return c.setPosition(b)});a.D.some(function(c){c.C.setPosition(b)})}
function wwp(){var a=yx.rb(),b=xwp();return new Cn(function(c){zx(a,"/dbx/getBigsheetsPromoRelevance",[],b.Nb(),function(d){d=aj(Qvp,JSON.stringify(d.eh()));c(d)},function(){var d=void 0===d?bj(Qvp):d;d=new Pvp(d);d=vj(d,1,0).xa();c(d)})})}function ywp(a){a=a||{};return FJk(a.color,a.L$c)}function zwp(a){oj.call(this,a)}z(zwp,oj);function Awp(a,b){return tj(a,1,b)}zwp.prototype.jg=function(){return this.message.jg()};function Bwp(a,b){return tj(a,2,b)}function Cwp(a){this.Jb=Zi(a,-1,0)}z(Cwp,$i);
Cwp.prototype.zb=function(){return new zwp(this)};Cwp.prototype.jg=function(){return gj(this,2)};function Dwp(){var a=void 0===a?bj(Cwp):a;return new zwp(a)}function Ewp(a){oj.call(this,a)}z(Ewp,oj);function Fwp(a,b){return zj(a,2,b)}function Gwp(a){this.Jb=Zi(a,-1,0)}z(Gwp,$i);Gwp.prototype.zb=function(){return new Ewp(this)};function Hwp(){var a=void 0===a?bj(Gwp):a;return new Ewp(a)}function Iwp(a){oj.call(this,a)}z(Iwp,oj);function Jwp(a){this.Jb=Zi(a,500,0)}z(Jwp,$i);Jwp.prototype.zb=function(){return new Iwp(this)};
function xwp(){return bj(Jwp)}function Kwp(a){oj.call(this,a)}z(Kwp,oj);function Lwp(a,b){return awa(a,1,b)}function Mwp(a){this.Jb=Zi(a,-1,0)}z(Mwp,$i);Mwp.prototype.zb=function(){return new Kwp(this)};function Nwp(){var a=void 0===a?bj(Mwp):a;return new Kwp(a)}function Owp(){var a=void 0===a?bj(Svp):a;return new Rvp(a)}function Pwp(a){oj.call(this,a)}z(Pwp,oj);function Qwp(a){this.Jb=Zi(a,-1,0)}z(Qwp,$i);Qwp.prototype.zb=function(){return new Pwp(this)};function Rwp(a){oj.call(this,a)}z(Rwp,oj);
function Swp(a){this.Jb=Zi(a,-1,0)}z(Swp,$i);Swp.prototype.zb=function(){return new Rwp(this)};function Twp(a){oj.call(this,a)}z(Twp,oj);function Uwp(a,b){return tj(a,1,b)}function Vwp(a,b){return zj(a,2,b)}function Wwp(a){this.Jb=Zi(a,-1,0)}z(Wwp,$i);Wwp.prototype.zb=function(){return new Twp(this)};function Xwp(){var a=void 0===a?bj(Wwp):a;return new Twp(a)}function Ywp(a,b){return{title:a,body:b}}function j7(a){return Ywp("Query failed",a)}function Zwp(a){return a?tVc[a]||"other":"other"}
function $wp(a,b){var c=b.$h(),d=b.aq();if(0==a)return j7(SKk(d));switch(c){case 36:case 20:case 45:case 46:case 49:case 50:case 51:case 53:return j7(TKk(3,d,b));case 37:return j7(GKk(d));case 6:return a=(new it("{objectType, select, chart {The data source took too long to return this chart. Please try again.} pivot_table {The data source took too long to return this pivot table. Please try again.} formula {The data source took too long to return this formula result. Please try again.} record {The data source took too long to return this extract. Please try again.} datasource_preview {The data source took too long to return this preview. Please try again.} other {The data source took too long to return data. Please try again.}}")).format({objectType:Zwp(a)}),
Ywp("Timed out",RKk(a,d));case 8:return b=uVc.format(pf(qf(),"febpr")?5E4:3E4),c=uVc.format(pf(qf(),"femdrr")?5E4:25E3),b=(new it("{objectType, select, chart {Results exceed {maxRows} rows. Update this chart and try again.}pivot_table {Update the number of rows and/or columns to a maximum of {dbPivotTableMaxRows} by using filtering, grouping, or customizing number of rows and/or columns. Then, try again.}formula {Results exceed {maxRows} rows. Update this function and try again.} record {Results exceed {dbRecordMaxRows} rows. Update this extract and try again.} datasource_preview {Results exceed {maxRows} rows. Update this connected sheet and try again.} other {Results exceed {maxRows} rows. Update this query and try again.}}")).format({objectType:Zwp(a),
maxRows:vVc,dbPivotTableMaxRows:b,dbRecordMaxRows:c}),Ywp(1==a?"Rows and/or columns exceed limit":"Too many rows",RKk(b,d));case 18:return Ywp("Unsupported type",IY("The query returns a type which is currently not supported."));case 19:return j7(JKk());case 22:return j7(KKk());case 26:return j7(IY("The column type of connected data is not compatible with the operation."));case 30:return j7(IY("Sorting by an array column is not supported for connected sheets and extracts."));case 32:return Ywp("Too many customized number of rows & columns",
IY("Your pivot table contains one or more array database columns. Only one can have customized number of rows or columns."));case 33:return j7(MKk());case 35:return d=(new it("{objectType, select, chart {A column referenced by this chart is not available.} pivot_table {A column referenced by this pivot table is not available.} formula {A column referenced by this formula is not available.} record {A column referenced by this extract is not available.} datasource_preview {The column settings do not match the data source. Try removing sorts, filters and calculated columns and try again.} other {A column referenced by this object is not available.}}")).format({objectType:Zwp(a)}),
d=IY(d),j7(d);case 34:return d=(new it("{objectType, select, chart {A calculated column referenced by this chart no longer exists. Update and try again.} pivot_table {A calculated column referenced by this pivot table no longer exists. Update and try again.} formula {A calculated column referenced by this formula no longer exists. Update and try again.} record {A calculated column referenced by this extract no longer exists. Update and try again.} datasource_preview {A calculated column referenced by this preview no longer exists. Update and try again.} other {A calculated column referenced by this object no longer exists. Update and try again.}}")).format({objectType:Zwp(a)}),
d=IY(d),j7(d);case 38:return j7(SKk(null));case 39:return j7(LKk());case 40:return j7(IY("A calculated column has an invalid formula. Update and try again."));case 15:return j7(HKk(gj(b,6).toUpperCase()));case 14:return j7(IKk(gj(b,6).toUpperCase()));case 42:return j7(NKk());case 43:return j7(OKk());case 44:return j7(PKk());case 47:return j7(IY("The delegated access settings are invalid. The delegated access has been disabled. Please refresh again."));case 48:return j7(IY("Refresh using delegation is unavailable now. Please disable delegated access in connection settings or try again later."));
case 52:return j7(IY("You can not refresh with delegated credentials because you are not in the same organization as the credential owner."))}return j7(SKk(d))}
function axp(a,b){a=$wp(a,b);if(cj(b,11)&&cj(b.wc(11,swa),5)){var c=b.wc(11,swa),d=gj(c.uj(),2);if(d&&0!=d.length){var e=gj(c.wc(8,qwa),2),f=!!e&&0<e.length,h=cj(b,8)&&0<ij(b,8),k=new Date(ij(b,8)),l=(new ju(1)).format(k);k=(new ju(5)).format(k);2==lj(c,1,0)?c=h?"A scheduled refresh created by "+(d+(" failed at "+(k+(" on "+(l+". \n\n"))))):"A scheduled refresh created by "+(d+" failed. \n\n"):(c=h?f?"A query created by "+(d+(" using "+(e+("'s credentials failed at "+(k+(" on "+(l+". \n\n"))))))):
"A query created by "+(d+(" failed at "+(k+(" on "+(l+". \n\n"))))):f?"A query created by "+(d+(" using "+(e+"'s credentials failed. \n\n"))):"A query created by "+(d+" failed. \n\n"),b=b.$h(),f&&(37==b||52==b)&&d!=e&&d8b.isEnabled()&&pf(qf(),"fedd")&&(c+="To attempt refreshing using your own credentials, disable delegated access in connection settings and try again. \n\n"));b=qh("span",{"class":"waffle-dataconnector-error-user"},ph(c))}else b=null}else b=null;if(!b)return a;b=rh([b,a.body]);return{title:a.title,
body:b}}function bxp(a,b,c,d){this.D=a;this.C=b;this.F=c;this.H=d}bxp.prototype.Cu=n("D");bxp.prototype.Eb=n("H");function cxp(){var a=new qu,b="Configure a project in the Google Cloud Platform console to continue. "+(a.Zd("a",{"class":"goog-inline-block",href:"https://connectedsheets.page.link/addproject",target:"_blank"})+("Learn more"+a.Yd("a")));return a.format(b)}
function dxp(a){var b=HY(a);a=gj(b,5);b=b.wc(4,wIk);var c=gj(b,3)||"";b=c+(c?".":"")+gj(b,2)+"."+b.getName();b=yIk("select * from `"+b+"`");a=tj(b,5,a).xa();b=YJk();b=vj(b,2,2);return WJk(b,a).xa()}
function exp(){var a='<div class="'+V("waffle-bigquerydbsourcesettingsdialog-project-section")+'"><div class="'+V("waffle-bigquerydbsourcesettingsdialog-project-heading")+'"><h3 class="'+V("waffle-bigquerydbsourcesettingsdialog-project-title")+'">';a=a+'Choose a cloud project</h3></div><div class="'+(V("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper")+'"></div></div>');return Jq(a)}
function fxp(){var a='<div class="'+V("waffle-bigquerydbsourcesettingsdialog-footer-wrapper")+'"><p class="'+V("waffle-bigquerydbsourcesettingsdialog-footer-message")+'">';return Jq(a+'Your use of BigQuery is governed by the <a href="https://cloud.google.com/terms/" target="_blank">Google Cloud Platform Terms of Service</a>.</p></div>')}
function gxp(a,b,c,d){YY.call(this,"waffle-bigquerydbsourcesettingsdialog",d);d=c?"Edit data connection":"Add data connection";this.setTitle(this.Ea().Ja("SPAN",void 0,d));this.O=a;this.J=b;this.R=c||null;this.C=new ITk(void 0,this.Ea());this.Qa(this.C);this.F=null;this.D=new gUk(this.Ea());this.D.ld("waffle-bigquerydbsourcesettingsdialog-info-icon");this.D.setVisible(!1);this.Qa(this.D)}z(gxp,YY);
gxp.prototype.Ja=function(){YY.prototype.Ja.call(this);Fq(this.Fc(),exp);OSk(this).appendChild(Hq(fxp));var a=this.D.C;a.ld("waffle-bigquerydbsourcesettingsdialog-info-bubble");a.setPosition(2,2,0,-8);var b="Displaying the top "+(cod.format(1E4)+" projects. To use an unlisted project, enter the full project ID in the search bar and press enter.");a.setContent(nh(b));this.D.render(this.Cb("waffle-bigquerydbsourcesettingsdialog-project-heading"));ar(this.D.Va(),b);this.C.render(this.Cb("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"));
(this.C.Pp||null).setAttribute("placeholder","Search projects");this.Ea().In(this.C.Va(),!1)};gxp.prototype.Ra=function(){var a=this;YY.prototype.Ra.call(this);this.C.Yt(!0);tTk(this.O).then(function(b){a.Ec()&&(b&&0!=b.length||a.J.C(36566),hxp(a,b),a.C.Yt(!1))},function(){a.Ec()&&(a.J.C(36685),Ns.rb().postMessage(Ps("Could not connect to BigQuery","error",!0)),hxp(a,[],!0),a.C.Yt(!1))})};
function hxp(a,b,c){c=void 0===c?!1:c;a.D.setVisible(!0);if(0!=b.length||c)ixp(a,b),a.getHandler().listen(a.C,"action",function(e){return jxp(a,e,b)});else{c=a.Ea();var d=xn(c,cxp());nq(a.Ka("waffle-bigquerydbsourcesettingsdialog-project-menu-wrapper"),!1);c.appendChild(a.Ka("waffle-bigquerydbsourcesettingsdialog-project-section"),c.Ja("DIV","waffle-bigquerydbsourcesettingsdialog-error-caption",d))}}function ixp(a,b){b=kxp(b);KTk(a.C,b);OTk(a.C);LTk(a.C)}
function kxp(a){return Bf(a,function(b){return new vTk(b.getId(),b.getName())})}function jxp(a,b,c){b=b.target.ob();var d=b instanceof vTk?b.dba:b.getValue();dr(a.Va(),"waffle-bigquerydbsourcesettingsdialog-transition-out");a.C.bya("translateX(-24px)").then(function(){return a.resolve(new rTk(c,d,d,"db-source-table",a.R))})}
function lxp(a){a.F=new BYb("Pick your GCP project","Get started by selecting the Google Cloud project containing the dataset you need. You may change the billing project in the next step.",a.Ka("waffle-bigquerydbsourcesettingsdialog-project-section"),a.Ea(),"waffle-bigquerydbsourcesettingsdialog-tooltip");a.F.setPosition(0,2);a.F.C.oG=!1;a.F.render(a.Fc());a.getHandler().Ki(a.F.e2(),Fm,function(){a.F.setVisible(!1)})}
function mxp(){var a='<div class="'+V("waffle-bigquerywrongskudialog-message")+'">';return Jq(a+"Thank you for your interest in connected sheets. Unfortunately, you don't have the required G Suite license to gain access.</div>")}function nxp(){return Jq('<div class="'+V("waffle-bigquerywrongskudialog-learn-more-wrapper")+'"></div>')}
function oxp(a){XY.call(this,"waffle-bigquerywrongskudialog",a);this.setTitle(this.Ea().Ja("SPAN",void 0,"Upgrade to get access"));this.C=new $t("Learn more",this.Ea());this.Qa(this.C)}z(oxp,XY);
oxp.prototype.Ja=function(){XY.prototype.Ja.call(this);Fq(this.Fc(),mxp);OSk(this).appendChild(Hq(nxp));this.C.render(this.Ka("waffle-bigquerywrongskudialog-learn-more-wrapper"));this.getHandler().listen(this.C,"action",function(){Cq("https://connectedsheets.page.link/support")});var a=this.Ka("waffle-bigquerywrongskudialog-message");a.id=zq(this,"waffle-bigquerywrongskudialog-message");Yq(this.Va(),"describedby",a.id)};
function pxp(a,b,c,d,e,f,h,k,l){PJk.call(this,d,h,k,l);this.F=a;this.oa=b;this.Ba=c;this.Ga=f;this.qa=e}z(pxp,PJk);pxp.prototype.Ja=function(){PJk.prototype.Ja.call(this);this.Pb(Hq(VKk,{a3:!1}))};pxp.prototype.Ra=function(){PJk.prototype.Ra.call(this);null!=this.oa&&(this.C.setValue($k().ECc()(this.oa.Nb(),this.F)),this.canEdit&&this.Iea())};pxp.prototype.fKb=function(){return this.qa.HIc(this.F,SJk(this),GUc(this.Ba))};
pxp.prototype.D1b=function(a){var b=this;this.J=!0;this.A1a();a=XKk(YKk($Kk(),this.F),a).xa();qwp(yx.rb(),a,this.Ga).then(function(c){c=c.cj();3==c.getState()?(c="BigQuery error: "+c.aq(),QJk(b,!1,c)):QJk(b,!0,null);RJk(b)},function(){QJk(b,!1,null);RJk(b)})};function qxp(a,b,c){dLk.call(this,a,b,c)}z(qxp,dLk);qxp.prototype.Ra=function(){dLk.prototype.Ra.call(this)};qxp.prototype.QFa=function(){this.C.ld("waffle-calculated-columns-tooltip-help-bubble");dLk.prototype.QFa.call(this)};
qxp.prototype.J=function(){eLk(this,"https://connectedsheets.page.link/calccolhelp");var a="="+($k().uA()("RIGHT")+"(orderId, 4)");var b="="+($k().uA()("YEAR")+"(startDate)");var c="="+($k().uA()("IF")+"(units > 0, total/units, 0)");this.C.setContent(this.Ea().Ja("DIV",void 0,JY("waffle-db-object-formula-tooltip-help-bubble-title","Try these formulas"),JY("waffle-db-object-formula-tooltip-help-bubble-subtitle","Do basic math"),JY("waffle-db-object-formula-tooltip-help-bubble-example","=price * quantity"),
JY("waffle-db-object-formula-tooltip-help-bubble-subtitle","Manipulate text"),JY("waffle-db-object-formula-tooltip-help-bubble-example",a),JY("waffle-db-object-formula-tooltip-help-bubble-subtitle","Use dates"),JY("waffle-db-object-formula-tooltip-help-bubble-example",b),JY("waffle-db-object-formula-tooltip-help-bubble-subtitle","Apply conditional logic"),JY("waffle-db-object-formula-tooltip-help-bubble-example",c),this.g9))};function rxp(a){oj.call(this,a)}z(rxp,oj);rxp.prototype.jg=function(){return this.message.jg()};
rxp.prototype.ev=function(){return this.message.ev()};function sxp(a){this.Jb=Zi(a,-1,0)}z(sxp,$i);sxp.prototype.zb=function(){return new rxp(this)};sxp.prototype.jg=function(){return gj(this,1)};sxp.prototype.ev=function(){return gj(this,3)};function txp(a,b,c,d,e){ix.call(this,153);this.D=a;this.J=b;this.C=c||"";this.R=d;this.O=e}z(txp,ix);txp.prototype.Ig=function(){var a=void 0===a?bj(sxp):a;a=new rxp(a);a=tj(a,1,this.D);a=tj(a,4,this.J);a=tj(a,3,this.C);a=tj(a,2,this.R);return bwa(a,5,this.O).xa()};
function uxp(a,b,c){Bm.call(this,a);this.ww=b;this.C=c}z(uxp,Bm);function vxp(a,b,c,d,e,f,h,k,l,m,p){qJk.call(this,a,null==b,e,f,m,p);this.$i=new qxp(m,p,this.Ea());this.Qa(this.$i);this.qa=b;null==b?b=null:(e=Owa(),e.$o(1,2),b=tj(e,2,b).xa());this.V=b;this.bb=c;this.Wa=d;this.F=new pxp(a,this.V,d,f,k,l,m,p,this.Ea());this.Qa(this.F);this.$a=h}z(vxp,qJk);u=vxp.prototype;u.Xa=function(){qJk.prototype.Xa.call(this)};
u.Ja=function(){qJk.prototype.Ja.call(this);var a=null==this.qa?"Add calculated column":this.canEdit?"Edit calculated column":"View calculated column";this.setTitle(a);var b=ZKb(this);b&&ar(b,a);a=Hq(bLk,{canEdit:this.canEdit,vEb:"Calculated column name",description:"Calculated columns let you create new columns for better analysis by using Sheets functions and the current data in your connected sheet."});b=this.Fc();this.Ea().appendChild(b,a);this.$i.render(this.Ka(GY.zAb));this.F.render(this.Ka(GY.wrb))};
u.Ra=function(){qJk.prototype.Ra.call(this);null!=this.V&&(this.C.setValue(Nw(this.V,this.ww)),this.Qbb());this.IGa();this.getHandler().listen(this.F,"validation-update",this.IGa)};u.Xf=function(){qJk.prototype.Xf.call(this)};u.RZb=function(){for(var a=[],b=ea(this.bb),c=b.next();!c.done;c=b.next())c=c.value,cj(ox(c),2)||a.push(c);rJk(this,a)};u.rob=function(){var a=STc(this.ma,!1,!1,!0,!1);mJk(this.O,a)};
u.SMb=function(){var a=this,b=SJk(this.F);if(!sg(b)){var c=null==this.qa;b=new txp(this.ww,fDk(this.C.getValue()),this.qa,b,Fvp(this.Wa));var d=c?36645:36647,e=c?36644:36646;jx(b,function(f){a.oa.C(f?e:d,a.Os);f&&a.dispatchEvent(new uxp("update",a.ww,c))});this.$a.C(b)}};u.ZKb=function(a){a=a.target.getValue();a=zTc(a,this.ww);TJk(this.F,a)};u.GLb=function(a){a=a.target.getValue().getName();UJk(this.F,a)};
u.z1a=function(){if(wh(this.C.getValue()))var a=null;else a:{var b=this.Wa,c=this.C.getValue();a=this.V;c=fDk(c);if(sg(c))a="Calculated column name cannot be empty";else{for(var d=ea(b.C.keys()),e=d.next();!e.done;e=d.next())if(e=e.value,qg(e,c))if(d=null!=a,b=b.C.get(e),d&&a.equals(b))break;else{a="A column named "+(c+" already exists");break a}a=null}}return a};u.aPb=function(){return this.F.O};
function wxp(){var a='<div class="'+V("waffle-dbanswers-answers-bar")+'"><div class="'+V("waffle-dbanswers-answers-bar-controls")+'"><div class="'+V("waffle-dbanswers-answers-bar-input")+'"></div><div class="'+V("waffle-dbanswers-answers-bar-enable-button")+'">';a=a+'Enable</div></div><div class="'+(V("waffle-dbanswers-answers-bar-message")+'"></div></div>');return Jq(a)}
function xxp(){var a='<div class="'+V("waffle-dbanswers-answers-bar-enable-answers-popup")+'">',b='To perform natural language queries on this data, ask the table owner or admin to follow the <div class="'+(V("waffle-dbanswers-answers-bar-enable-answers-popup-setup-link")+'">setup instructions.</div>');return Jq(a+b+"</div>")}
function yxp(a,b){tq.call(this,b);this.F=a;this.C=new as;IMb(this.C,0);JMb(this.C,5,5,5,5);uXj(this.C,!0);this.Da(this.C);this.D=new es(null,new toe,this.Ea());this.Qa(this.D)}z(yxp,tq);u=yxp.prototype;u.Ja=function(){var a=Hq(xxp);this.Pb(a);Yq(a,"hidden",!0);nq(a,!1);this.C.jJ(a);this.D.wb(this.Cb("waffle-dbanswers-answers-bar-enable-answers-popup-setup-link"))};u.Ra=function(){tq.prototype.Ra.call(this);this.getHandler().listen(this.D,"action",this.q5c)};
u.xo=function(a){this.C.setPosition(new ls(a,0,!0))};u.setVisible=function(a){this.C.setVisible(a);a&&this.D.Va().focus()};u.isVisible=function(){return this.C.isVisible()};u.Je=function(){this.C.Je()};u.q5c=function(a){a.stopPropagation();a.preventDefault();a=Jp(new Ip,75).xa();this.F.C(36761,a);pf(qf(),"docs-idu")?qla("https://sites.google.com/corp/google.com/data-qna#h.p_Vf6xbc97l9jL"):qla("https://docs.google.com/document/u/1/d/e/2PACX-1vRNytdUb20j3I6WPQXLmmIfOHkWR3a0iPg4ck1AdXzSznrW3USl3NtYGIk34sBQaxl_fSiUPclFqJK4/pub?urp=gmail_link#h.ng0zmdirli5c")};
function zxp(a,b,c,d,e,f){ZY.call(this,a,b,c,nVc.rb(),"db",d,e,f);this.D="";this.R=0;this.oa=new eA(void 0,this.Ea());this.Qa(this.oa);this.V=new yxp(b,this.Ea());this.Qa(this.V);this.ma=null}z(zxp,ZY);u=zxp.prototype;u.Td=function(a){this.Pb(a);var b=Hq(wxp);this.Ea().appendChild(a,b);a=this.Cb("waffle-dbanswers-answers-bar-input");this.F.render(a);this.oa.wb(this.Cb("waffle-dbanswers-answers-bar-enable-button"));this.V.render();this.V.xo(this.oa.Va())};
u.Ra=function(){ZY.prototype.Ra.call(this);this.foa()};u.foa=function(){ZY.prototype.foa.call(this);this.getHandler().listen(this.oa,"action",this.gUc)};u.t1=function(){return ALc(this.H.C)&&pf(qf(),"feda")&&!Gr().C?ZY.prototype.t1.call(this):!1};u.Za=function(a){this.Ec()&&(0!=this.R&&pf(qf(),"fedaic")?(ZY.prototype.Za.call(this,!1),Axp(this,!0)):(Axp(this,!1),ZY.prototype.Za.call(this,a)))};u.iaa=function(){ZY.prototype.iaa.call(this);this.V.isVisible()&&this.V.Je()};
u.ENb=function(a){SIk(a,null,this.D,this.wm())};u.BGa=function(){this.D?Bxp(this):this.pS();TIk(null,this.D,this.wm())};u.pS=function(){ZY.prototype.pS.call(this);this.D="";TIk(null,null,this.wm())};u.NOa=function(){return Cxp(this.R)};u.Nob=q(!0);
function Dxp(a,b){a.D!=b&&(a.D=b,pf(qf(),"fedaic")?(a.ma&&a.ma.cancel(),a.ma=$vp(yx.rb(),a.D),Jn(a.ma.then(function(c){a.R=c.getError();c=0==a.R;a.Za(c);c?a.t1()&&a.BGa():a.pS()},function(c){c instanceof Kn||(a.R=4,a.Za(!1),a.pS())}),function(){a.ma=null})):a.t1()&&a.BGa())}function Bxp(a){if(hUk(a)){var b=a.O;b.D=a.D;b.C5();nwp(b);b.S$([]);var c=a.H;Un(function(){a.D&&Kx(c.ma,a.D,!0).then(function(d){return Exp(a,d,a.D)})},3E3)}}
function Exp(a,b,c){b.forEach(function(d){var e=zTc(d,c);if(null!=e){var f=a.O;a:{if(d.wd())switch(d.getType()){case 1:case 2:case 4:case 5:case 6:case 7:d="$dim";break a;case 3:d="$met";break a}d="$unu"}dVc(f,e,d)}})}function Axp(a,b){a.oa.setVisible(1==a.R);var c=a.Cb("waffle-dbanswers-answers-bar-message");b=b?Cxp(a.R):"";a.Ea().Ih(c,b)}u.gUc=function(){this.J.C(36760,iUk(this));this.V.setVisible(!0)};
function Cxp(a){switch(a){case 1:return"The admin for this table hasn't enabled Answers yet.";case 2:return"Answers is not yet supported for data sets created by custom query.";case 3:return"The admin for this table hasn't enabled Answers yet.";case 4:return"Answers is unavailable at the moment, please try again later.";case 5:return"This data table is being setup for Answers in the background. Please try again in some time.";default:return""}}
function Fxp(){return Jq('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#5f6368" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-2-3.5l6-4.5-6-4.5z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>')}
function Gxp(){return Jq('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path fill="#5f6368" d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H5.17l-.59.59-.58.58V4h16v12zm-9-4h2v2h-2zm0-6h2v4h-2z"/><path fill="none" d="M0 0h24v24H0V0z"/></svg>')}function Hxp(){var a='<div class="'+V("waffle-dbsource-pill-menuitem")+'">'+ZTc();return Jq(a+"Learn more about BigQuery</div>")}
function Ixp(){var a='<div class="'+V("waffle-dbsource-pill-menuitem")+'">'+Gxp();return Jq(a+"Send feedback</div>")}function Jxp(){var a='<div class="'+V("waffle-dbsource-pill-menuitem waffle-dbsource-configbar-watch-tutorial-menuitem")+'">'+Fxp()+"<div>";a=a+'Watch tutorial<div class="'+(V("waffle-dbsource-configbar-watch-tutorial-menuitem-caption")+'">');return Jq(a+"Learn the ins and outs of Connected Sheets</div></div></div>")}
function Kxp(){return Jq('<div class="'+V("waffle-dbsource-configbar-actions")+'"><div class="'+V("waffle-dbsource-configbar-columns-menu-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-chart-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-pivot-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-function-button-wrapper")+
'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-table-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-calculated-column-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-column-insights-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-answers-wrapper")+'"></div></div>')}
function Lxp(a){a=a.sOb;var b='<div class="'+V("waffle-dbsource-configbar-wrapper")+'"><div class="'+V("waffle-dbsource-configbar")+'"><div class="'+V("waffle-dbsource-configbar-header")+'"><div class="'+V("waffle-dbsource-configbar-header-icon")+'">'+DJk(24)+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';b+=Pq("Connected sheet name");b+='"></div><div class="'+V("waffle-dbsource-configbar-separator")+'"></div><div class="'+V("waffle-dbsource-configbar-header-subtitle")+
'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-refresh-options-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+V("waffle-dbsource-configbar-watch-tutorial-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-send-feedback-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-connection-settings-button-wrapper")+'"></div></div></div>'+Kxp()+"</div></div>"+(a?
'<div class="'+V("waffle-dbsource-configbar-preview-bar-wrapper")+'"></div>':"");return Jq(b)}
function Mxp(a){a=a.sOb;var b='<div class="'+V("waffle-dbsource-configbar-wrapper")+'"><div class="'+V("waffle-dbsource-configbar")+'"><div class="'+V("waffle-dbsource-configbar-header")+'"><div class="'+V("waffle-dbsource-configbar-header-icon")+'">'+DJk(24)+'</div><div class="waffle-dbsource-configbar-header-title" role="textbox" tabindex="0" aria-label="';b+=Pq("Connected sheet name");b+='"></div><div class="'+V("waffle-dbsource-configbar-separator")+'"></div><div class="'+V("waffle-dbsource-configbar-header-subtitle")+
'"></div><div class="'+V("waffle-dbsource-configbar-button-wrapper")+" "+V("waffle-dbsource-configbar-refresh-options-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-schedules-widget-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-options-wrapper")+'"><div class="'+V("waffle-dbsource-configbar-connection-settings-button-wrapper")+'"></div><div class="'+V("waffle-dbsource-configbar-auxiliary-menu-button-wrapper")+'"></div></div></div>'+Kxp()+"</div></div>"+(a?'<div class="'+
V("waffle-dbsource-configbar-preview-bar-wrapper")+'"></div>':"");return Jq(b)}
function Nxp(){var a=Jq('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><g fill="#188038" fill-rule="nonzero"><path d="M14.5263158 2C15.3368421 2 16 2.7 16 3.55555556V14.4444444C16 15.3 15.3368421 16 14.5263158 16H3.47368421C2.66315789 16 2 15.3 2 14.4444444V3.55555556C2 2.7 2.66315789 2 3.47368421 2H14.5263158zM3.5 3.5v11h11v-11h-11z"/><path d="M6.75 12.75h-1.5V7.5h1.5zM9.75 12.75h-1.5v-7.5h1.5zM12.75 12.75h-1.5v-3h1.5z"/></g></svg>');return Jq(a+"<span>Chart</span>")}
function Oxp(){var a=Jq('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" fill-rule="evenodd" d="M10 13h1.185c.9975 0 1.815-.81 1.815-1.815V10h-2.25l3-3 3 3H14.5v1.185c0 1.83-1.485 3.315-3.315 3.315H10v2.25l-3-3 3-3V13zM8 6V2h6.5454545C15.3454545 2 16 2.72 16 3.6V6H8zM2 6V3.6C2 2.72 2.72 2 3.6 2H6v4H2zm1.6 10c-.88 0-1.6-.6545455-1.6-1.4545455V8h4v8H3.6z"/></svg>');return Jq(a+"<span>Pivot table</span>")}
function Pxp(){var a=jUk()+"<span>";return Jq(a+"Extract</span>")}function Qxp(){var a=Jq('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"><path fill="#188038" d="M15 2H3v1.75L8.143 9 3 14.25V16h12v-2.625H7.286L11.571 9 7.286 4.625H15z"/></svg>');return Jq(a+"<span>Function</span>")}function Rxp(a){a=a.label;return Jq('<span class="'+V("waffle-dbsource-configbar-column-insights-icon")+'">'+Ot("docs-icon-img docs-icon-insights")+"</span><span>"+Iq(a)+"</span>")}
function Sxp(){var a=Jq('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" fill-rule="evenodd"><path fill="#188038" d="M20 13h-7v7h-2v-7H4v-2h7V4h2v7h7v2z"/></g></svg>');return Jq(a+"<span>Calculated column</span>")}function Txp(){var a='<span class="'+V("waffle-dbsource-configbar-secondary-button-content")+'">'+Fxp()+"<span>";return Jq(a+"Watch tutorial</span></span>")}
function Uxp(){var a='<span class="'+V("waffle-dbsource-configbar-secondary-button-content")+'">'+Gxp()+"<span>";return Jq(a+"Send feedback</span></span>")}function Vxp(){var a='<span class="'+V("waffle-dbsource-configbar-secondary-button-content")+'">'+Ot("docs-icon-img docs-icon-info-outline-grey","waffle-dbsource-configbar-secondary-button-icon")+"<span>";return Jq(a+"Learn more</span></span>")}
function Wxp(){var a='<span class="'+V("waffle-dbsource-configbar-secondary-button-content")+'">'+Ot("docs-icon-img docs-icon-settings","waffle-dbsource-configbar-secondary-button-icon")+"<span>";return Jq(a+"Connection settings</span></span>")}
function Xxp(){return Jq('<div class="'+V("waffle-dbsource-configbar-schedules-widget")+'"><div class="'+V("waffle-dbsource-configbar-schedules-widget-content")+'"><div class="'+V("waffle-dbsource-configbar-schedules-widget-last-refresh")+'"><span class="'+V("waffle-dbsource-configbar-schedules-widget-last-refresh-content")+'"></span><span class="'+V("waffle-dbsource-configbar-schedules-widget-last-refresh-divider")+'"></span></div><div class="'+V("waffle-dbsource-configbar-schedules-widget-next-refresh")+
'"><span class="'+V("waffle-dbsource-configbar-schedules-widget-next-refresh-content")+'"></span><span class="'+V("waffle-dbsource-configbar-schedules-widget-edit-button-wrapper")+'"></span></div></div><div class="'+V("waffle-dbsource-configbar-schedules-widget-main-button-wrapper")+'"></div></div>')}
function Yxp(a,b){My.call(this,Gq(Vxp),new ks(b),Xwe.rb(),b);this.C=a;this.D=new Map([["bigquery-helpdoc",d7b],["send-feedback",this.C.Pa("docs-feedback")],["watch-tutorial",r8b]]);this.Le(new gs(Hq(Ixp),"send-feedback",this.Ea()));this.Le(new js(this.Ea()));this.Le(new gs(Hq(Jxp),"watch-tutorial",this.Ea()));this.Le(new js(this.Ea()));this.Le(new gs(Hq(Hxp),"bigquery-helpdoc",this.Ea()))}z(Yxp,My);
Yxp.prototype.Ra=function(){My.prototype.Ra.call(this);dr(this.Ic().getElement(),"waffle-dbsource-pill-menu");dr(this.Ic().getElement(),"docs-gm");this.getHandler().listen(this.Ic(),"action",this.F)};Yxp.prototype.F=function(a){a=a.target.ob();a=this.D.get(a);if(a.isEnabled()){var b;a==this.C.Pa("docs-feedback")&&(b={source:"big-sheets-feedback"});a.Ob(b)}};
function Zxp(a){var b=a.label;a=a.eq;return Jq((a?'<div class="'+V("goog-menuitem-icon")+" "+V("waffle-charteditor-column-filtered-menu-item-icon")+" "+V(a)+'"></div>':"")+'<span class="'+V("waffle-datasource-configbar-columns-menu-item-label")+'">'+Iq(b)+"</span>")}function $xp(){return Jq('<div class="'+V("waffle-datasource-configbar-columns-menu-spinner-container")+'"></div>')}
function ayp(a){ks.call(this,a);this.D=new MY(!1);this.Da(this.D);this.C=new gs(Hq($xp),void 0,this.Ea());this.C.DR(!1);this.Qa(this.C)}z(ayp,ks);ayp.prototype.Ra=function(){ks.prototype.Ra.call(this);dr(this.Va(),"waffle-datasource-configbar-columns-menu")};ayp.prototype.Ja=function(){ks.prototype.Ja.call(this);this.C.render(this.Va());this.D.render(this.C.Ka("waffle-datasource-configbar-columns-menu-spinner-container"))};
ayp.prototype.h1=function(a,b){a=ea(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=zTc(c,b);null!==d&&this.Im(d,eJk(c.getType()))}};ayp.prototype.Im=function(a,b){this.Qa(new gs(Hq(Zxp,{label:a,eq:b}),void 0,this.Ea()),!0)};function byp(a,b){var c=a.C.getElement();c&&(kr(c,"waffle-datasource-configbar-columns-menu-loading",b),nq(c,b),a.D.setActive(b))}function cyp(){ks.apply(this,arguments)}z(cyp,ks);cyp.prototype.Ra=function(){ks.prototype.Ra.call(this);dr(this.Va(),"waffle-datasource-configbar-formula-menu")};
cyp.prototype.j1=function(a){var b=this;this.Qa(a,!0);this.getHandler().listen(a,"action",function(){var c=new Wv("insert-formula-function");c.eOa=a.getValue();b.dispatchEvent(c)})};
function dyp(a,b,c,d){tq.call(this,d);this.J=a;this.R=b;this.V=c;this.H=!1;this.F=null;this.D=new es("Edit",nx.rb(),d);this.Qa(this.D);this.C=new Ly("Schedule refresh");this.C.ld("waffle-dbsource-configbar-schedules-widget-main-button");this.C.ld("waffle-dbsource-flat-default");this.Qa(this.C);this.O=new xs(this);this.Da(this.O);this.O.Gc(vu,ap,this.refresh)}z(dyp,tq);u=dyp.prototype;u.Ja=function(){tq.prototype.Ja.call(this);this.Pb(Hq(Xxp))};
u.Ra=function(){tq.prototype.Ra.call(this);this.D.render(this.Ka("waffle-dbsource-configbar-schedules-widget-edit-button-wrapper"));this.C.render(this.Ka("waffle-dbsource-configbar-schedules-widget-main-button-wrapper"));nq(this.Va(),!1);this.getHandler().listen(this.C,"action",this.YYc).listen(this.D,"action",this.D_b).listen(fx,"load-schedules-on-config-bar",this.Deb);this.Deb()};
u.refresh=function(){if(!this.isDisposed())if(!this.H||this.V.ej())nq(this.Va(),!1);else{var a=this.Ea(),b=vu.isEnabled();if(null==this.F)this.C.setVisible(!0),nq(this.Ka("waffle-dbsource-configbar-schedules-widget-content"),!1),fr(this.Va(),"waffle-dbsource-configbar-schedules-widget-highlight"),qs(this.C.Va(),"Schedule a refresh for all connected objects associated with this sheet",void 0);else{this.C.setVisible(!1);nq(this.Ka("waffle-dbsource-configbar-schedules-widget-content"),!0);dr(this.Va(),
"waffle-dbsource-configbar-schedules-widget-highlight");qs(this.D.Va(),"Refresh time for all objects related to current datasource",void 0);var c=this.F.getStatus();if(cj(c,4)){nq(this.Ka("waffle-dbsource-configbar-schedules-widget-last-refresh"),!0);var d=new Date(1E3*ij(c,4)),e=!1,f=!0;e=void 0===e?!0:e;f=void 0===f?!1:f;var h=new qu;var k=kUk(this.J);d=(e||d.getDate()!=(new Date).getDate()?bxe.format(d,k)+(f?", ":" "):"")+Ywe.format(d,k);h=h.format(d);d=this.Ka("waffle-dbsource-configbar-schedules-widget-last-refresh-content");
a.$e(d);a.appendChild(d,xn(a,rh(qh("SPAN",{"class":"waffle-dbsource-configbar-schedules-widget-header-label"},"Updated: "),qh("span",void 0,h))))}else nq(this.Ka("waffle-dbsource-configbar-schedules-widget-last-refresh"),!1);ej(GDk(this.F),1)?(h=new Date(1E3*ij(c,2)),d=new Date(1E3*ij(c,3)),h=nUk(h,d,this.J,!1,!1,!1,!0,!0)):h="Paused";d=this.Ka("waffle-dbsource-configbar-schedules-widget-next-refresh-content");a.$e(d);a.appendChild(d,xn(a,rh(qh("SPAN",{"class":"waffle-dbsource-configbar-schedules-widget-header-label"},
cj(c,4)?"Next: ":"Next refresh: "),qh("span",void 0,h))));this.D.setVisible(b)}nq(this.Va(),!0)}};u.Deb=function(){var a=this;jEk().then(function(b){a.isDisposed()||(b=mj(b,1,FDk).Mc(),0==b.length?a.F=null:a.F=b[0],a.H=!0,a.refresh())},function(){Ns.rb().postMessage(Ps("Error loading schedule configuration.","error",!0));a.H=!1;a.refresh()})};u.YYc=function(){this.Deb();this.D_b()};u.D_b=function(){var a=Jp(new Ip,109).xa();this.R.C(116123,a);TPc(!0)};
function eyp(a,b,c,d,e,f,h,k,l){h=void 0===h?null:h;k=void 0===k?null:k;l=void 0===l?null:l;au.call(this,a,b,c,d);e||(e=new P_b,this.Da(e));this.J=e;this.F=f;this.ul=h;this.ma=k;this.V=l;this.C=0;this.R=new wYb(this.Gp.BOa(),!0,!0);this.F&&this.F.Dm(this.R)}z(eyp,au);u=eyp.prototype;u.dAa=function(a){this.Gp.isVisible()&&!this.isDismissed()&&this.F&&dWb(this.F,this.R);this.C=1;au.prototype.dAa.call(this,a);this.C=0};
u.lAa=function(a){au.prototype.lAa.call(this,a);this.J.Et()?O_b(this):Lm(this.H,this.J.pna(),ua(this.W8b,this))};u.W8b=function(){this.J.Et()&&(O_b(this),this.$M())};u.fYa=function(){this.Gp.render(this.ul)};u.show=function(){this.isDismissed()||this.Gp.isVisible()||this.fYa()};u.bAa=function(a){this.C=2;au.prototype.bAa.call(this,a);this.C=0};u.bRa=function(a){this.C=3;au.prototype.bRa.call(this,a);this.C=0};u.qM=function(){var a=this.isDismissed();au.prototype.qM.call(this);!a&&this.ma&&this.ma(this.C)};
u.mAa=function(a){au.prototype.mAa.call(this,a);this.V&&this.V()};u.Je=function(){!this.isDismissed()&&this.Gp.isVisible()&&this.Gp.BOa().Je()};function fyp(){var a='<div class="'+V("waffle-dbsource-previewbar")+'"><div class="'+V("waffle-dbsource-previewbar-content")+'"><span class="'+V("waffle-dbsource-previewbar-text")+'">';a=a+'Preview</span><span class="'+(V("waffle-dbsource-previewbar-info-icon-wrapper")+'"></span></div></div>');return Jq(a)}
function gyp(a){var b=a.sdd;a='<div class="'+V("waffle-dbsource-previewbar-info-bubble-content")+'"><div class="'+V("waffle-dbsource-previewbar-info-bubble-title")+'">';b="This sheet shows a preview of up to "+(Iq(b)+" rows");a=a+b+('</div><div class="'+V("waffle-dbsource-previewbar-info-bubble-body")+'"><span>'+Drd()+' </span><span class="'+V("waffle-dbsource-previewbar-info-bubble-link-button")+" "+V("goog-link-button")+'">'+Erd()+'</span></div><div class="'+V("waffle-dbsource-previewbar-info-bubble-button-wrapper")+
'"></div></div>');return Jq(a)}function hyp(a,b){tq.call(this,b);this.H=a;this.C=new gUk(this.Ea(),2,Hq(ywp,{color:"#5f6368",L$c:10}));this.Qa(this.C);this.D=new Ly("Create extract",this.Ea());this.D.ld("waffle-dbsource-flat-default");this.Qa(this.D)}z(hyp,tq);hyp.prototype.Ja=function(){this.Pb(Hq(fyp));var a=this.C.C;a.ld("waffle-dbsource-previewbar-info-bubble");a.By(!0);cs(a,!1);a.setPosition(1,2);a.setContent(Hq(gyp,{sdd:500}))};
hyp.prototype.Ra=function(){var a=this;tq.prototype.Ra.call(this);var b=this.Ka("waffle-dbsource-previewbar-info-icon-wrapper");this.C.render(b);var c=this.C.C;this.D.render(c.Ka("waffle-dbsource-previewbar-info-bubble-button-wrapper"));var d=c.Ka("jfk-bubble-closebtn");d.appendChild(Hq(KSk));INb(d,$q(d));qs(this.C.aY().Va(),"Show information about this preview",void 0);var e=new St(c.Va(),this.Ea());Tt(e);this.Da(e);if(e=fJk())dr(b,e),dr(d,e);this.getHandler().listen(this.D,"action",function(){a.getHandler().Wd(c,
"hide",a.F);a.C.C.setVisible(!1);a.dispatchEvent("create-extract-button-action")}).listen(this.H,"N",function(){Un(function(){return a.C.C.Je()})}).listen(this.C.Va(),"keydown",function(f){var h=a.C.C;h.isVisible()&&9===f.keyCode&&(f.preventDefault(),f.stopPropagation(),f=h.Ka("waffle-dbsource-previewbar-info-bubble-link-button"),a.Ea().aI(f).focus())}).listen(c.Va(),"keydown",function(f){27===f.keyCode&&c.setVisible(!1)}).listen(c,"beforeshow",function(){a.getHandler().ge(c,"hide",a.F)})};
hyp.prototype.F=function(){var a=this.C.aY().getElement();a&&a.focus()};var iyp={enabled:!0,selected:!0,visible:!0},jyp={enabled:!0};function kyp(){Bm.call(this,"configbar-dom-focus-out")}z(kyp,Bm);function lyp(a,b){Bm.call(this,"datasheet-rename");this.jm=a;this.name=b}z(lyp,Bm);
function myp(a,b,c,d,e,f,h,k,l,m,p){tq.call(this,p);p=pf(qf(),"fdsrfu");var r=pf(qf(),"fedpi");this.Sa=a;this.D=b;this.ma=c;this.bd=d;this.La=b.ma;this.rc=k;this.Zb=l;this.Bc=m;this.Rc=f;this.Ha=new ys;this.Da(this.Ha);this.O=new My("Columns",new ayp(this.Ea()),void 0,this.Ea());this.O.ld("waffle-dbsource-configbar-columns-menu-button");this.O.wn(!0);this.Qa(this.O);this.Ab=nyp(this,"waffle-dbsource-configbar-chart-button",Hq(Nxp));this.Kb=nyp(this,"waffle-dbsource-configbar-pivot-button",Hq(Oxp));
this.Ua=nyp(this,"waffle-dbsource-configbar-table-button",Hq(Pxp));a=Hq(Qxp);this.oa=new ps(a,new cyp(this.Ea()),Cwe.rb(),this.Ea());this.oa.ld("waffle-dbsource-configbar-function-button");this.oa.wn(!0);this.oa.Qu(!0);this.Qa(this.oa);this.Ba=nyp(this,"waffle-dbsource-configbar-calculated-column-button",Hq(Sxp));this.Ga=this.F=this.Wa=null;pf(qf(),"fedciv")&&(this.F=nyp(this,"waffle-dbsource-configbar-column-insights-button",Hq(Rxp,{label:"Column stats"})),this.Wa=new D9j,this.Da(this.Wa));this.V=
new Ly("Refresh options");this.V.ld("waffle-dbsource-configbar-refresh-options-button");this.V.ld("waffle-dbsource-flat-default");this.Qa(this.V);this.H=null;p?(this.H=nyp(this,"waffle-dbsource-configbar-secondary-button",Hq(Wxp)),this.bb=new Yxp(this.Zb,this.Ea()),this.bb.ld("waffle-dbsource-configbar-secondary-button"),this.bb.wn(!0),this.Qa(this.bb),this.jb=new dyp(h,this.ma,this.D,this.Ea())):(this.tb=nyp(this,"waffle-dbsource-configbar-secondary-button",Hq(Txp)),this.sb=nyp(this,"waffle-dbsource-configbar-secondary-button",
Hq(Uxp)),this.H=new Ly(Hq(Nt,{icon:"docs-icon-img docs-icon-settings"}),this.Ea()),this.H.ld("waffle-dbsource-configbar-connection-settings-button"),this.Qa(this.H));(this.C=r?new hyp(e,this.Ea()):null)&&this.Qa(this.C);this.Ed=new Map([[this.O,""],[this.Ab,"chart"],[this.Kb,"pivot table"],[this.Ua,"table"],[this.oa,"function"],[this.Ba,""],[this.V,""],[this.H,""]]);this.Pc=new Set;pf(qf(),"fedsccm")||this.Pc.add(this.O);this.Lc=new Map([[this.V,D7b],[this.H,l8b],[this.Ba,Z7b]]);this.J=null;pf(qf(),
"feda")&&!Gr().C&&(this.J=new zxp(this.D,this.ma,this.bd,e,75,this.Ea()),this.Qa(this.J));this.ib=this.R=null;this.Gb=!1;this.qa=null;this.$a=new Set}z(myp,tq);u=myp.prototype;u.Ja=function(){var a=pf(qf(),"fdsrfu"),b=pf(qf(),"fedpi");this.Pb(Hq(a?Mxp:Lxp,{sOb:b}))};
u.Ra=function(){var a=this;tq.prototype.Ra.call(this);var b=pf(qf(),"fdsrfu");this.O.render(this.Ka("waffle-dbsource-configbar-columns-menu-button-wrapper"));this.Ab.render(this.Ka("waffle-dbsource-configbar-chart-button-wrapper"));this.Kb.render(this.Ka("waffle-dbsource-configbar-pivot-button-wrapper"));this.Ua.render(this.Ka("waffle-dbsource-configbar-table-button-wrapper"));this.oa.render(this.Ka("waffle-dbsource-configbar-function-button-wrapper"));this.Ba.render(this.Ka("waffle-dbsource-configbar-calculated-column-button-wrapper"));
this.F&&(this.F.render(this.Ka("waffle-dbsource-configbar-column-insights-button-wrapper")),this.Wa.Zj(this.F.Va()));this.V.render(this.Ka("waffle-dbsource-configbar-refresh-options-button-wrapper"));this.H.render(this.Ka("waffle-dbsource-configbar-connection-settings-button-wrapper"));b?(this.bb.render(this.Ka("waffle-dbsource-configbar-auxiliary-menu-button-wrapper")),this.jb.render(this.Ka("waffle-dbsource-configbar-schedules-widget-wrapper"))):(this.tb.render(this.Ka("waffle-dbsource-configbar-watch-tutorial-button-wrapper")),
this.sb.render(this.Ka("waffle-dbsource-configbar-send-feedback-button-wrapper")),zs(this.Ha,this.tb,r8b,iyp),zs(this.Ha,this.sb,this.Zb.Pa("docs-feedback"),iyp,function(){return{source:"big-sheets-feedback"}}));this.J&&this.J.wb(this.Ka("waffle-dbsource-configbar-answers-wrapper"));this.C&&(this.C.render(this.Ka("waffle-dbsource-configbar-preview-bar-wrapper")),this.getHandler().listen(this.C,"create-extract-button-action",function(){return oyp(a,111)}));zs(this.Ha,this.V,D7b);zs(this.Ha,this.Ba,
Z7b);zs(this.Ha,this.H,l8b,jyp,function(){return new PTk(pyp(a),"show-current-source")});this.R=this.Ka("waffle-dbsource-configbar-header-title");this.getHandler().listen(this.Ab,"action",this.oPc).listen(this.Kb,"action",this.V1c).listen(this.Ua,"action",function(){return oyp(a,109)}).listen(this.oa,"show",this.dSc).listen(this.Ba,"action",this.UOc).listen(this.V,"action",this.r3c).listen(this.O,"show",this.BQc).listen(this.Sa,"ua",this.b9b).listen(this.R,["focus","mousedown"],this.L_c).listen(this.D,
"external_datasource_status",this.C4c);this.F&&this.getHandler().listen(this.F.Va(),["mouseenter","focus"],this.Mrd).listen(this.F,"action",this.yQc);this.getHandler().listen(this.C?this.C.Va():this.J?this.J.getElement():this.F?this.F.Va():this.Ba.Va(),"keydown",this.$Xc);pf(qf(),"fedsccm")||this.O.setVisible(!1);Gr().C&&(b?(this.V.setVisible(!1),this.H.setVisible(!1),this.bb.setVisible(!1)):(this.tb.setVisible(!1),this.sb.setVisible(!1),this.H.setVisible(!1)));this.refresh()};
u.$Xc=function(a){9===a.keyCode&&(a.preventDefault(),this.dispatchEvent(new kyp))};u.setVisible=function(a){nq(this.Va(),a);if(this.J&&a){var b="",c=qz(this.Sa);c&&c.jg()&&(b=c.jg());Dxp(this.J,b)}this.C&&!a&&(b=this.C.C.C,b.setVisible(!1),b.Je());!this.qa||this.qa.isDismissed()||a||this.qa.qM();!this.Ga||this.Ga.isDismissed()||a||this.Ga.qM()};u.isVisible=function(){return oq(this.Va())};
u.refresh=function(){qyp(this,qz(this.Sa).Qg());var a=this.Ka("waffle-dbsource-configbar-header-subtitle"),b=ryp(this),c=this.Ea();b?c.Ih(a,b+" Rows"):c.Ih(a,"");a=!(this.D.ej()||this.D.D.Bl());syp(this,a,cEk(this.La,pyp(this)),this.D.xg());this.jb&&this.jb.refresh();this.O.Qe(!1);typ(this);this.J&&Dxp(this.J,pyp(this));this.ib&&(Vn(this.ib),this.ib=null)};function nyp(a,b,c){c=new eA(c,a.Ea());c.ld(b);a.Qa(c);return c}u.oPc=function(){J2c(this.La);OPc(null,void 0,pyp(this));this.ma.C(36528,uyp())};
u.V1c=function(){J2c(this.La);var a=void 0===a?bj(KJc):a;a=new LJc(a);var b=pyp(this);a=tj(a,1,b).xa();a=XJc(sIk().zb(),a);a=sj(a,17,!1).xa();a=tIk(a);a=new kOk(null,ZLc(a),void 0);IPc(a);this.ma.C(36527,uyp())};function oyp(a,b){J2c(a.La);SPc(pyp(a));a.ma.C(36529,uyp(b))}u.dSc=function(){var a=this.oa.Ic();if(a&&0==a.Bd()){a=this.oa.Ic();var b=J9j(new I9j(this.D.Ua,a,this.Rc,this.D.D.ai()),void 0,!0);b=ea(b);for(var c=b.next();!c.done;c=b.next())a.j1(c.value)}J2c(this.La)};
u.UOc=function(){this.ma.C(36748,uyp())};u.r3c=function(){this.ma.C(36749,uyp())};u.yQc=function(){M9b.Ob(this.F,vyp(this))};u.L_c=function(a){if(!this.R.isContentEditable&&!ly(this.D)){this.R.contentEditable=!0;if("focus"===a.type){a=window.getSelection();var b=document.createRange();b.selectNodeContents(this.R);a.removeAllRanges();a.addRange(b)}this.getHandler().listen(this.R,"keydown",this.a9b).listen(this.R,"blur",this.U5c)}};
u.a9b=function(a){switch(a.keyCode){case 13:this.R.blur();break;case 27:wyp(this,!0)}};u.U5c=function(){var a=this;this.Gb||(window.getSelection().removeAllRanges(),this.ib=Un(function(){a.dispatchEvent(new lyp(qz(a.Sa).Eb(),qn(a.R)));wyp(a,!1)}))};function wyp(a,b){a.R.contentEditable=!1;Im(a.R,"keydown");Im(a.R,"blur");b&&qyp(a,qz(a.Sa).Qg())}u.BQc=function(){var a=this,b=this.O.Ic();byp(b,!0);var c=pyp(this);Kx(this.La,c).then(function(d){typ(a);0<d.length?b.h1(d,c):(a.O.Qe(!1),a.refresh())})};
u.b9b=function(a){qyp(this,a.yv)};u.C4c=function(){null!=BLc(this.D.C)&&this.refresh()};function qyp(a,b){var c=a.Ka("waffle-dbsource-configbar-header-title");a.Ea().Ih(c,b)}u.Mrd=function(){F9j(this.Wa);z7b.Ob(this.Wa,vyp(this))};
function syp(a,b,c,d){var e=b&&!d,f=null==xyp(c);a.Ed.forEach(function(h,k){var l=!a.Pc.has(k),m=!a.Lc.has(k)||a.Lc.get(k).isEnabled();k==a.V?k.Za(b&&l&&m):k!=a.H&&(l=e&&f&&l&&m,k.Za(l),k==a.Ua&&a.C&&a.C.D.Za(l));l=xyp(c);m=ryp(a);var p;k.isEnabled()&&k==a.Ua?p=pf(qf(),"femdrr")?"Insert an extract of up to 50k rows":"Insert an extract of up to 25k rows":k.isEnabled()&&k==a.Ba?p="Add a calculated column":k.isEnabled()&&k==a.V?p="Refresh options for all connections and associated objects":k.isEnabled()&&
k==a.H?p="Update connection settings":p=k.isEnabled()&&m&&h?"Insert "+(h+(" based on "+(m+" rows"))):k.isEnabled()&&h?"Insert "+h:k.isEnabled()||null!=l?k.isEnabled()||37!=l?k.isEnabled()||null==l?"":"There was an error fetching the database schema.":"You don't have access to refresh or edit analysis with this connected data.":"You don't have permission to edit this sheet.";yyp(k.Va(),p);k==a.Ua&&a.C&&yyp(a.C.D.Va(),p)});a.J&&a.J.Za(b&&f);a.F&&a.F.Za(b&&f)}
function yyp(a,b){qs(a,b,void 0);b&&P5j(a,"waffle-dbsource-configbar-db-object-creation-button-tooltip")}function pyp(a){return qz(a.Sa).jg()}function typ(a){a=a.O.Ic();for(byp(a,!1);1<a.Bd();)a.Uw(1,!0)}
function zyp(a){if(pf(qf(),"fedciv")&&pf(qf(),"fedcivp")&&a.isVisible()&&a.F&&a.F.isEnabled()&&!Ayp(a)){var b=Is(a.D.F.C,"ritz-ap");if(!Ir(b).C.dbColumnStatsPromo){var c=a.F.Va(),d=new BYb("Discover data insights","Now you can quickly learn about data distribution, frequency, and more for any column",c,a.Ea());a.Da(d);a.Ga=new eyp(d,c,!1,a.Ea(),a.D.R,a.Bc,a.Va(),function(){R_b(b,"dbColumnStatsPromo",!0)});a.Da(a.Ga);a.$a.add(a.Ga);a.Ga.show();a.ma.C(116197,uyp())}}}
function Ayp(a){for(var b=ea(a.$a),c=b.next();!c.done;c=b.next())c=c.value,c.isDismissed()&&a.$a.delete(c);return 0<a.$a.size||a.C&&a.C.C.C.isVisible()?!0:!1}function ryp(a){return(a=$k().qOa()(pyp(a)))?nod.format(parseInt(a,10)):null}function xyp(a){return a&&cj(a,1)&&!a.Nk()?a.$h():null}function vyp(a){var b=lGb(uyp());return S9j(R9j(new M9j(a.rc,b)),0<W9j(mx(a.rc)).length).xa().xa()}function uyp(a){a=void 0===a?109:a;var b=Zk(new Yk,!0);return Lp(Jp(new Ip,a),b).xa()}
function Byp(a,b,c,d,e,f,h,k,l,m,p){Jm.call(this);this.D=a;this.F=b;this.qa=l;this.V=c;this.Ga=d;this.R=e;this.H=f;this.O=h;this.Ba=k;this.J=new Mm(this);this.Da(this.J);this.oa=m;this.ma=p;this.C=null;this.J.listen(this.D,["na","Fa"],this.kNb).listen(this.D,["oa","Ea"],this.F5c).listen(this.F,["acl_change","offline_status","readonly_status"],this.IMc);this.kNb()}z(Byp,Jm);u=Byp.prototype;
u.kNb=function(){var a=qz(this.D);if(a&&pv(a)&&(this.C?(this.C.refresh(),this.C.Gb=!1):(this.C=new myp(this.D,this.F,this.V,this.Ga,this.Ba,this.qa,this.oa,this.H,this.ma,this.R),a=this.C.Ea(),this.C.render(a.getElement("waffle-dbsource-configbar-id")),this.C.Tg(this),this.J.listen(this.C,"insert-formula-function",this.w6c).listen(this.C,"datasheet-rename",this.TRc).listen(this.C,"configbar-dom-focus-out",this.UQc)),this.C.setVisible(!0),E8j(),a=this.C,!Ayp(a))){if(a.H&&a.H.isEnabled()&&pf(qf(),"fedda")&&
d8b.isEnabled()&&!a.qa&&!Gr().C){var b=a.D.F.D["ritz-SessionCountBigsheetsDelegateAccessPromo"];var c=b.getValue();b.setValue(Math.min(c+1,2147483647));3>c||6==c+1?(b=a.H.Va(),c=new BYb("Delegate access","Allow collaborators of this spreadsheet to refresh and analyze this connected data using your credentials. Go to the connection settings to enable.",b,a.Ea()),a.Da(c),a.qa=new eyp(c,b,!1,a.Ea(),a.D.R,a.Bc,a.Va()),a.Da(a.qa),a.$a.add(a.qa),a.qa.show(),a.ma.C(116174,uyp()),b=!0):b=!1}else b=!1;!b&&
a.C&&null!==ryp(a)&&(b=a.D.F,3<=ybd(b).getValue()||(b=b.D["ritz-ViewCountDatasourceSheetPreviewBar"],c=b.getValue(),1>c&&(b.setValue(c+1),a=a.C.C.C,a.setVisible(!0),a.Je())))}};u.TRc=function(a){var b=this;a=new HHd(a.jm,a.name);jx(a,function(c){c||wyp(b.C,!0)});this.O.C(a)};u.UQc=function(){Txd(lx(this.H))};
u.w6c=function(a){var b=this,c=qz(this.D),d=c.jg();if(d){var e=c.Qg(),f=a.eOa;wFk(this.R,function(h,k){var l=$k().oOa()(e,null);Pmb([Kx(b.F.ma,d),Wn(1E3)]).then(function(){return Cyp(b,f,l,k)})},"Insert Formula");this.V.C(36535,uyp())}};function Cyp(a,b,c,d){if(d)a.F.C.pP(d.Sn,function(){var f=Lw(a.F.C),h=new Nm(d.C,d.wq);Yw(f,h);Dyp(a,b,c,h)});else{var e=new AYj(hLc(a.F.C)+1);jx(e,function(f){f&&Dyp(a,b,c,new Nm)});a.O.C(e)}}
function Dyp(a,b,c,d){cLc(mx(a.H).C,sv(d)).addCallback(function(){s2j(lx(a.H),b,c)})}u.F5c=function(){this.C&&(this.C.setVisible(!1),this.C.Gb=!0)};u.IMc=function(){var a=qz(this.D);a&&pv(a)&&this.C&&this.C.refresh()};u.Xa=function(){Jm.prototype.Xa.call(this);ii(this.C)};
function Eyp(){var a='<div class="'+V("waffle-create-datasheet-welcome-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_welcome.png" class="'+V("waffle-create-datasheet-welcome-dialog-image")+'" alt=""><h3 class="'+V("waffle-create-datasheet-welcome-dialog-welcome-message")+'"><span>';a=a+'Connect and analyze big data in Sheets</span></h3><div class="'+(V("waffle-create-datasheet-welcome-dialog-welcome-description")+'">');a=a+"Connect to BigQuery, Google's cloud data warehouse, to analyze and share billions of rows of data with your colleagues - all within Sheets</div><div class=\""+
(V("waffle-create-datasheet-welcome-dialog-button-wrapper")+'"></div></div>');return Jq(a)}function Fyp(a){YY.call(this,"waffle-create-datasheet-welcome-dialog",a);this.D=new eA("Learn the basics",this.Ea());this.Qa(this.D);this.C=new $t("Get connected",this.Ea());this.Qa(this.C)}z(Fyp,YY);u=Fyp.prototype;
u.Ja=function(){YY.prototype.Ja.call(this);Fq(this.Fc(),Eyp);this.D.render(this.Ka("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.D,"action",this.c9b);this.C.render(this.Ka("waffle-create-datasheet-welcome-dialog-button-wrapper"));this.getHandler().listen(this.C,"action",this.Ytb);aKb(this.Ka("waffle-dataconnector-modal-title"));var a=this.Ka("waffle-create-datasheet-welcome-dialog-welcome-message");a.id=zq(this,"waffle-create-datasheet-welcome-dialog-welcome-message");
Xq(a,"heading");Yq(this.Va(),"labelledby",a.id);a=this.Ka("waffle-create-datasheet-welcome-dialog-welcome-description");a.id=zq(this,"waffle-create-datasheet-welcome-dialog-welcome-description");Yq(this.Va(),"describedby",a.id)};u.c9b=function(){Cq("https://connectedsheets.page.link/support")};u.Ytb=function(){this.resolve(!0)};u.hcb=function(a){13==a.keyCode&&this.Ytb()};u.eAa=function(){e7b.Ob();this.reject()};u.oS=function(){e7b.Ob();this.reject()};
function Gyp(a){a=a.Bbb;a='<div class="'+V("waffle-create-datasource-sheet-loading-dialog-section")+'"><img class="'+V("waffle-create-datasource-sheet-loading-dialog-image")+'" src="'+V(Rq(a))+'" alt=""><div class="'+V("waffle-create-datasource-sheet-loading-dialog-tip")+'">';return Jq(a+"Connecting data\u2026</div></div>")}function Hyp(a,b,c){XY.call(this,"waffle-create-datasource-sheet-loading-dialog",c);this.D=a;this.C=b}z(Hyp,XY);
Hyp.prototype.Ja=function(){XY.prototype.Ja.call(this);Fq(this.Fc(),Gyp,{Bbb:this.D});aKb(this.Ka("waffle-dataconnector-modal-title"));var a=this.Ka("waffle-create-datasource-sheet-loading-dialog-tip");a.id=zq(this,"waffle-create-datasource-sheet-loading-dialog-tip");Xq(a,"heading");Yq(this.Va(),"labelledby",a.id)};Hyp.prototype.Ra=function(){XY.prototype.Ra.call(this);this.C.C(36758,Iyp())};Hyp.prototype.Xa=function(){XY.prototype.Xa.call(this);this.C.C(36759,Iyp())};
function Iyp(){var a=Zk(new Yk,!0);return Lp(Jp(new Ip,75),a).xa()}
function Jyp(){var a='<div class="'+V("waffle-create-datasource-sheet-success-dialog-section")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/bigSheets_success_2.gif" class="'+V("waffle-create-datasource-sheet-success-dialog-image")+'" alt=""><h5 class="'+V("waffle-create-datasource-sheet-success-dialog-success-message")+'">';a=a+'Success! Your data is connected</h5><div class="'+(V("waffle-create-datasource-sheet-success-dialog-metadata-wrapper")+" "+V("waffle-create-datasource-sheet-success-dialog-datasource-info")+
'"></div><div class="'+V("waffle-create-datasource-sheet-success-dialog-success-description")+'">');a=a+'Create connected charts, pivot tables, and functions that work on the entire dataset, or extract a subset of the raw data directly into Sheets.</div><div class="'+(V("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper")+'"></div><div class="'+V("waffle-create-datasource-sheet-success-dialog-watch-tutorial")+" "+V("goog-link-button")+'"><span>');return Jq(a+"Watch video tutorial</span></div></div>")}
function Kyp(a,b){a=(new it("{NUM_COLUMNS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_COLUMNS:a});return b?b+" rows \u2022 "+a:a}function Lyp(a,b,c){XY.call(this,"waffle-create-datasource-sheet-success-dialog",c);this.F=a;this.H=b;this.C=new $t("Get started",this.Ea());this.Qa(this.C);this.D=new es(void 0,nx.rb(),this.Ea());this.Qa(this.D)}z(Lyp,XY);
Lyp.prototype.Ja=function(){var a=this;XY.prototype.Ja.call(this);Fq(this.Fc(),Jyp);var b=this.Ka("waffle-create-datasource-sheet-success-dialog-metadata-wrapper");this.Ea().Ih(b,Kyp(this.F,this.H));this.C.render(this.Ka("waffle-create-datasource-sheet-success-dialog-start-analyze-button-wrapper"));this.D.wb(this.Ka("waffle-create-datasource-sheet-success-dialog-watch-tutorial"));aKb(this.Ka("waffle-dataconnector-modal-title"));b=this.Ka("waffle-create-datasource-sheet-success-dialog-success-message");
b.id=zq(this,"waffle-create-datasource-sheet-success-dialog-success-message");Xq(b,"heading");Yq(this.Va(),"labelledby",b.id);b=this.Ka("waffle-create-datasource-sheet-success-dialog-success-description");b.id=zq(this,"waffle-create-datasource-sheet-success-dialog-success-description");Yq(this.Va(),"describedby",b.id);this.getHandler().listen(this.C,"action",function(){return a.oS()}).listen(this.D,"action",function(){return r8b.Ob()})};
function Myp(a,b,c,d,e,f,h,k,l,m,p,r,t,v,x){cWk.call(this,new jWk(m.getType(),l,"filter_db_sheet",x),a,b,c,d,e,f,h,k,l,v,x);this.H=ox(m);this.Qf=m;this.bd=p;this.Ie=r;this.Se=t;this.Qd=!cj(this.H,2)&&gJk(m)}z(Myp,cWk);u=Myp.prototype;u.Ja=function(){cWk.prototype.Ja.call(this);var a=tkd(this.C,this.tm());vwp(this.F.C,500<a.left?0:3)};
u.nNb=function(){var a=this.ob().Vc(),b=$k().pOa()(a,this.H.Nb()),c=null,d=null;0<b.length&&(c=aj(Ov,b[0]),d=FVk(a));IVk(this.F,c,d,this.Ie,this.Se,this.bd,this.H);a=this.La;b=this.Wa;c=this.ob().Vc();c=$k().i$a()(c,this.H.Nb());kr(a.Va(),"waffle-datasourcesheet-sort-selected",0==c);kr(b.Va(),"waffle-datasourcesheet-sort-selected",1==c);a.Za(null!=c||!this.Qd);b.Za(null!=c||!this.Qd);a=this.D;b=a.Ic().Va();dr(b,"waffle-datasourcesheet-filterbox-container");Lzk(a);kq(b,"");a.Xt()};
u.YKb=function(a){if("filtering_cancelled"==a.type)this.Ua();else if("filtering_open_filter_by_value_sidebar"==a.type){a=this.ob().Vc();a=$k().pOa()(a,this.H.Nb());var b=null;0<a.length&&(b=aj(Ov,a[0]));a=b?Fzc(TXj(Czc(),this.H),b).xa():null;a=new kWk(this.bd,4,this.H,this.Qf.getType(),a,null,null,null,null);b9b.Ob(a);this.Ha.C(116098,this.rc);this.Ua()}else if(a=this.tm(),a=this.F.Wx(this.ob().Vc(),a.y,a.x,!1,!1),!YUk(this.F.C)){b=this.ob().Vc();var c=$k().pOa()(b,this.H.Nb());b=null;0<c.length&&
(b=aj(Ov,c[0]));c=b&&0<dj(b,9);if(null!=a||c){var d=new YVk("filterUpdate");d.C=a;c&&(d.H=b.gI(),d.Wa=mj(b,9,zwa).Mc())}else d=new YVk("filterClear");d.V=this.H;this.dispatchEvent(d);this.Ua()}};u.Ccb=function(a){var b=new YVk("filterSort");b.V=this.H;b.Ba=a?1:0;this.dispatchEvent(b)};u.Kdb=q(!1);u.E6a=function(a){var b=this.C,c=Hy(b,"r",a.y),d=b.C,e=2*d.C,f=this.ob().pk(a.y,a.x).Dt();c=-c-e;a="rtl"==(f.D||null)||"auto-rtl"==(f.D||null)?e:Hy(b,"c",a.x)-16*d.C-e;d=d.C;this.UO(new Nm(a/d,c/d))};
function Nyp(a){oj.call(this,a)}z(Nyp,oj);Nyp.prototype.Eb=function(){return this.message.Eb()};Nyp.prototype.D=function(a){return this.message.D(a)};function Oyp(a){this.Jb=Zi(a,-1,0)}z(Oyp,$i);Oyp.prototype.zb=function(){return new Nyp(this)};Oyp.prototype.Eb=function(){return gj(this,1)};Oyp.prototype.D=function(a){return nj(this,3,a,Ov)};
function Pyp(a,b,c,d,e,f){d=void 0===d?null:d;e=void 0===e?!1:e;f=void 0===f?!1:f;ix.call(this,147);this.O=a.Vc();this.J=b;this.D=c||[];this.C=d;this.R=e;this.V=f}z(Pyp,ix);Pyp.prototype.Ig=function(){var a=void 0===a?bj(Oyp):a;a=new Nyp(a);a=tj(a,1,this.O);a=zj(a,7,this.J);this.R?sj(a,5,!0):xj(a,3,this.D);this.V?sj(a,6,!0):null!=this.C&&vj(a,4,this.C);return a.xa()};
Pyp.prototype.equals=function(a){return this.O==a.O&&this.J.equals(a.J)&&this.R==a.R&&this.V==a.V&&this.C==a.C&&hg(this.D,a.D,function(b,c){return b.equals(c)})};function Qyp(a,b,c,d,e,f,h){li.call(this);this.J=a;this.R=h;this.oa=b;this.D=c;this.ma=d;this.V=e;this.O=f;this.F=new Mm(this);this.Da(this.F);this.C=null;this.H=new xs(this);this.Da(this.H);this.F.listen(this.D,"filter-triggered",this.$tb);this.H.subscribe(c9b,"action",this.$tb);this.H.subscribe(a9b,"action",this.f9b)}z(Qyp,li);u=Qyp.prototype;
u.$tb=function(){var a=qz(this.oa);if(a&&pv(a)){var b=lx(this.D),c=Ryp(this),d=Ww(c),e=Uw(Ryp(this));d=new Nm(d.x,e.y);e=o_j(c,d.x);this.C&&(this.C.dispose(),this.C=null);this.C=new Myp(c,this.V,b.V,b.C,b.F,new ry(d),!1,!1,this.ma,e,a.jg(),this.J.H,this.J.Sa,this.R);this.Da(this.C);fmd(RFd(b),this.C);this.F.listen(this.C,"filterClear",this.e9b).listen(this.C,"filterSort",this.g9b).listen(this.C,"filterUpdate",this.k5c);this.C.E6a(d);this.C.we();this.C.D.Qe(!0);b=ox(e);a=$k().i$a()(a.Eb(),b.Nb());
b=Ym("waffle-autofilter-sort waffle-datasourcesheet-sort-selected");null!=a&&b&&(ar(b,b.innerText+" selected"),kr(b,"hc-enabled-focus","black"==ss()))}};u.e9b=function(a){a=new Pyp(Ryp(this),a.V,null,null,!0);Syp(this,a)};u.k5c=function(a){var b=xzc();a.C&&Azc(b,a.C);a.Wa&&0<a.Wa.length&&zzc(xj(b,9,a.Wa),a.H);a=new Pyp(Ryp(this),a.V,[b.xa()],null);Syp(this,a)};
u.f9b=function(a){if(4==a.C){var b=xzc(),c=a.TIa;xj(b,9,c);zzc(b,a.gI());c=0<c.length;var d=!1;if(a.$_){var e=a.$_.D();e.hI()&&(d=!0,Azc(b,e.Wx()))}b=c||d?[b.xa()]:null;a=new Pyp(Ryp(this),a.D,b,null,!b);Syp(this,a)}};u.g9b=function(a){var b=Ryp(this).Vc(),c=a.V;b=$k().i$a()(b,c.Nb());var d=!1;switch(a.Ba){case 1:d=0==b;break;case 0:d=1==b}a=d?new Pyp(Ryp(this),c,null,null,void 0,!0):new Pyp(Ryp(this),c,null,1==a.Ba?0:1);Syp(this,a)};function Syp(a,b){a.O.C(b);mFk(RFd(lx(a.D)));ii(a.C);a.C=null}
function Ryp(a){return Lw(a.J.C)}function Typ(a,b,c,d,e,f,h){li.call(this);var k=this;this.O=new Mm(this);this.Da(this.O);this.J=a.O;this.F=b;this.C=c;this.oa=e;this.R=f;this.ma=new xs(this);this.Da(this.ma);this.qa=h;this.H=this.D=null;Uyp(this);Vyp(this,d);this.V=new Km;this.Da(this.V);this.V.Dc(this.J.H,function(l){var m=Wyp(k);m&&(l.D||l.C.has(m))&&Xyp(k,m)});this.yEa()}z(Typ,li);function Uyp(a){var b=new Np(["waffle-dbsheet-or-dbobject-pill-active"]);a.R.C(f8b,b)}
function Vyp(a,b){var c=Uv(a.F.Ua);a.O.listen(b,"P",a.G7c).listen(c,"gc",a.j9b).listen(c,["Qb","cc"],a.yEa).listen(a.F,"na",a.yEa).listen(a.C,"activeCellChange valueChange blurEmbeddedObject embeddedObjectMouseEnter embeddedObjectMouseLeave focusEmbeddedObject".split(" "),a.yEa).listen(a.C,"inputBoxActivate",a.HRa).listen(a.C,"mouseover",a.i9b).listen(a.C,"refresh-db-object-request",a.FMb).listen(a.F,"oa",a.K8a).listen(a.C,"db-connection-settings",a.dLb);a.ma.subscribe(f8b,"action",a.h9b)}u=Typ.prototype;
u.Xa=function(){this.K8a();li.prototype.Xa.call(this)};u.j9b=function(){var a=lx(this.C);a&&cTc(this.C)&&hFd(a)};u.K8a=function(){ji(Yyp(this),Zyp(this),this.D);this.H=this.D=null};u.G7c=function(){this.D&&swp(this.D)};
u.yEa=function(){var a=lx(this.C),b=qz(this.F);if(a&&b){b=!!a.bb;var c=!!MFd(a);b||!c||a.bb||(a.bb=new twp(a.ob(),a.V,a.C,a.F,new ry(HFd(a),new Nm(0,0)),a.Ba,a.ib,a.rc,a.fc),tyd(a.ma,"dbCellPill",a.bb),a.Da(a.bb),a.bb.setVisible(!0));b=a.ob();a=MFd(a)||Ww(b);(a=MMc(Ow(b,a),a,b.Vc()))&&(a.C||a.D)?this.HRa():(a=Wyp(this),(a!=this.H||$yp(this,a))&&Xyp(this,a))}else this.K8a()};
function $yp(a,b){if(!b||2!=$k().VX()(b))return!1;var c=lx(a.C);if(!c)return!1;b=uFk(c);c=sFk(c);if(b==c)return!1;a=Yyp(a);return b&&null==c&&a&&a.isVisible()&&null!=a.C.Ic()&&a.C.Ic().isVisible()?!1:!0}function Xyp(a,b){if(b){a.HRa();var c=azp(a);if(c){var d=dEk(a.J,b);var e=qz(a.F).Eb();var f=$k().VX()(b),h=$k().Y7()(b),k=null;h&&(k=(h=$k().qOa()(h))?parseInt(h,10):null);e=new bxp(b,f,k,e);uod(c,d,e);4==e.C&&swp(c);bzp(a,b,c,d);a.H=b}}else a.HRa()}
u.HRa=function(){var a=Yyp(this);a&&a.setVisible(!1);(a=Zyp(this))&&a.setVisible(!1);this.H=null};u.h9b=function(){var a=azp(this);a&&(a.Va().focus(),this.oa.Nc(2))};u.FMb=function(){var a=Wyp(this);if(a)switch($k().VX()(a)){case 1:g7b.Ob(a);break;case 5:i7b.Ob(a);break;case 3:n7b.Ob(a);break;case 2:h7b.Ob(a);break;case 4:j8b.Ob(a)}};u.dLb=function(){var a=Wyp(this);if(a){var b=$k().Y7()(a);b&&(a=$k().Tda()(b))&&TGd(this.F,a,function(){l8b.Ob(new PTk(b,"show-current-source"))})}};
u.i9b=function(a){var b=qz(this.F),c=lx(this.C);c&&b&&3!=b.jj()&&(a=a.Qo)&&Ccd(a)&&(this.yEa(),hFd(c))};
function azp(a){var b=Wyp(a);if(!b)return null;var c=$k().VX()(b);if(4==c)if(3!=qz(a.F).jj())a=null;else{if(!a.D){c=lx(a.C);b=c.Ji();a.D=new pod(a.qa,b,a.R.Rf());a.O.listen(a.D,"refresh-db-object-request",a.FMb).listen(a.D,"db-connection-settings",a.dLb);c=new Wq(c.Ha.J,b?5:1);a.D.render();var d=a.D;d.oa=c;d.ma=b}a=a.D}else if(2==c)if(a=lx(a.C))a:if(c=a.J.C,tFk(a)==b)b=nFk(a.J).Jg().getId(),a=$Fd(a,b);else{for(d=c.length-1;0<=d;d--){var e=c[d];if(e&&$k().wma()(e)==b){a=$Fd(a,e);break a}}a=null}else a=
null;else a=Zyp(a);return a}function Yyp(a){return(a=lx(a.C))?ZFd(a):null}function Zyp(a){a=lx(a.C);return a?(a=a.bb)?a.F:null:null}function Wyp(a){return(a=lx(a.C))?uwp(a):null}function bzp(a,b,c,d){(vu.isEnabled()||vod(c))&&czp(d.getType())&&(c.M$(),iEk(a.J,b,function(e){return c.Cv(e)},function(e){return c.cP(e)}))}function czp(a){return"no-results"==a||"fetch-successful"==a||"fetch-failed"==a}function dzp(a){oj.call(this,a)}z(dzp,oj);dzp.prototype.jg=function(){return this.message.jg()};
function ezp(a){this.Jb=Zi(a,-1,0)}z(ezp,$i);ezp.prototype.zb=function(){return new dzp(this)};ezp.prototype.jg=function(){return gj(this,1)};function fzp(a,b){ix.call(this,154);this.C=a;this.D=b}z(fzp,ix);fzp.prototype.Ig=function(){var a=void 0===a?bj(ezp):a;a=new dzp(a);a=tj(a,1,this.C);return bwa(a,2,this.D).xa()};function gzp(a,b){hA.call(this,"",a,b);this.Xc(!0)}z(gzp,hA);gzp.prototype.Gl=function(){return hzp(this)};
gzp.prototype.getContent=function(){var a=this.Ea().Ja("SPAN",{"class":"waffle-filter-by-value-additional-values-item"});nn(a,hzp(this));return[a]};function hzp(a){return nod.format(a.ob())+" additional values in the full data set"}function izp(a,b){this.C=a;this.D=b}izp.prototype.uh=n("C");izp.prototype.So=n("D");function jzp(a,b){XIk.call(this,"",a,b);this.Zv(!0);this.Xc(!0)}z(jzp,XIk);jzp.prototype.Gl=function(){return kzp(this)};
jzp.prototype.getContent=function(){var a=this.ob(),b=[],c=this.Ea().Ja("DIV",{"class":"goog-menuitem-checkbox"});b.push(c);c=this.Ea().Ja("SPAN",{"class":"waffle-filter-by-value-item-freq"});if(a=a.So())a=1E3>a?nod.format(a):ood.format(a),nn(c,a);b.push(c);c=this.Ea().Ja("SPAN",{"class":"waffle-filterable-by-text-contains-menu-item-label"});nn(c,kzp(this));b.push(c);return b};function kzp(a){return $k().eU()(a.ob().uh().Nb())}
function lzp(a){a=a||{};var b='<div class="'+V("waffle-filter-by-value-sidebar-header-wrapper")+'"><div class="'+V("waffle-filter-by-value-sidebar-column-info")+'" id="'+V("waffle-filter-by-value-sidebar-column-info")+'"></div><div class="'+V("waffle-filter-by-value-search-container")+'">'+Ot("docs-icon-img docs-icon-search-this-document")+aLk(void 0,"waffle-filter-by-value-search-input",void 0,void 0,void 0,void 0,void 0,void 0,void 0,Oq('tabindex="0" role="textbox"'))+'</div><div class="'+V("waffle-filter-by-value-menu-title")+
'"><div class="'+V("waffle-filter-by-value-menu-title-primary")+'" id="'+V("waffle-filter-by-value-menu-title-primary")+'">';b=b+'Most frequent values</div><div class="'+(V("waffle-filter-by-value-menu-title-secondary")+'" id="'+V("waffle-filter-by-value-menu-title-secondary")+'"></div></div><div class="'+V("waffle-filter-by-value-menu-top-buttons")+'"><div class="'+V("waffle-filter-by-value-menu-sort-buttons")+'"><div class="'+V("waffle-filter-by-value-sort-by-frequency-desc-button")+" "+V("goog-inline-block")+
'"></div><div class="'+V("waffle-filter-by-value-sort-by-frequency-asc-button")+" "+V("goog-inline-block")+'"></div><div class="'+V("waffle-filter-by-value-sort-by-value-asc-button")+" "+V("goog-inline-block")+'"></div><div class="'+V("waffle-filter-by-value-sort-by-value-desc-button")+" "+V("goog-inline-block")+'"></div></div><div class="'+V("waffle-filter-by-value-menu-checked-buttons")+'"><div class="'+V("waffle-filter-by-value-select-all-button")+" "+V("goog-inline-block")+'"></div><div class="'+
V("waffle-filter-by-value-clear-button")+" "+V("goog-inline-block")+'"></div></div></div></div>');var c='<div class="'+V("waffle-filter-by-value-sidebar-content-container")+'"><div class="'+V("waffle-filter-by-value-sidebar-content-loading")+'"></div><div class="'+V("waffle-filter-by-value-sidebar-content-unavailable")+'">';var d='<div class="'+V("waffle-filter-by-value-content-unavailable-alert-icon")+'">'+oWk()+'</div><div class="'+V("waffle-filter-by-value-content-unavailable-alert-message")+'">';
d=d+'Values unavailable</div><div class="'+(V("waffle-filter-by-value-content-unavailable-refresh-message")+'">');d=d+'Values could not be retrieved at this time. Try again by refreshing.</div><div class="'+(V("waffle-filter-by-value-content-unavailable-refresh-button-wrapper")+'"></div>');d=Jq(d);c=c+d+'</div><div class="'+V("waffle-filter-by-value-sidebar-content-loaded")+'"><div class="'+V("waffle-filter-by-value-menu")+'" aria-labelledby="waffle-filter-by-value-sidebar-column-info waffle-filter-by-value-menu-title-primary waffle-filter-by-value-menu-title-secondary" tabindex="0" role="menu"></div><h2 class="'+
V("waffle-filter-by-value-additional-values-menu-title")+'"><span tabindex="0">';c=c+'Values beyond top 500</span></h2><div class="'+(V("waffle-filter-by-value-additional-values-menu")+'"></div></div></div>');a=""+VY(Kq({oD:"waffle-filter-by-value-sidebar",title:"Filter by value",aP:Nq(""+Ot("docs-icon-img docs-icon-filter-control")),b3:Nq(b),fA:Nq(c),TX:Nq('<div class="'+V("waffle-filter-by-value-sidebar-footer-wrapper")+'"><div class="'+V("waffle-filter-by-value-empty-values-wrapper")+'"><div class="'+
V("waffle-filter-by-value-empty-values-menu")+'"></div></div><div class="'+V("waffle-filter-by-value-last-updated-time")+'" tabindex="0"></div><div class="'+V("waffle-filter-by-value-sidebar-footer-button-bar")+'"><div class="'+V("waffle-filter-by-value-cancel-button-wrapper")+'"></div><div class="'+V("waffle-filter-by-value-ok-button-wrapper")+'"></div></div></div>')},a));return Jq(a)}
function mzp(){return Jq('<div class="'+V("waffle-filter-by-value-sidebar-header")+'"><div class="'+V("waffle-filter-by-value-sidebar-header-icon")+'"></div><div class="'+V("waffle-filter-by-value-sidebar-header-column-name")+'"></div></div>')}function nzp(a){tq.call(this,a)}z(nzp,tq);nzp.prototype.Ja=function(){this.Pb(Hq(mzp))};function ozp(a,b){hA.call(this,"",a,b);this.Xc(!0)}z(ozp,hA);ozp.prototype.Gl=function(){return pzp(this)};
ozp.prototype.getContent=function(){var a=this.Ea().Ja("SPAN",{"class":"waffle-filter-by-value-empty-values-item"});nn(a,pzp(this));return[a]};function pzp(a){return nod.format(a.ob())+" empty values in the full data set"}
function qzp(a,b){PY.call(this,b);this.C=a;this.Sa=new nzp;this.Da(this.Sa);this.Ab=new pt("Search from list of most frequent values");this.tb=null;this.Da(this.tb);this.Ge=new ks;this.Qa(this.Ge);this.D=new ks;this.Qa(this.D);this.F=new ks;this.Qa(this.F);this.O=new Ly(Hq(Nt,{icon:"docs-icon-img docs-icon-trending-up-18"}),this.Ea());this.Qa(this.O);this.R=new Ly(Hq(Nt,{icon:"docs-icon-img docs-icon-trending-down-18"}),this.Ea());this.Qa(this.R);this.V=new Ly(Hq(Nt,{icon:"docs-icon-img docs-icon-sort_az"}),
this.Ea());this.Qa(this.V);this.ma=new Ly(Hq(Nt,{icon:"docs-icon-img docs-icon-sort_za"}),this.Ea());this.Qa(this.ma);this.Wa=new es("Select all",nx.rb(),this.Ea());this.Qa(this.Wa);this.Ga=new es("Clear all",nx.rb(),this.Ea());this.Qa(this.Ga);this.oa=new $t("OK",this.Ea());this.oa.ld("waffle-filter-by-value-ok-button");this.Qa(this.oa);this.Ba=new eA("Cancel",this.Ea());this.Ba.ld("waffle-filter-by-value-cancel-button");this.Qa(this.Ba);this.$a=this.jb=this.ib=this.La=this.Ha=this.J=this.Gb=null;
this.Zb=new Tnd;this.sb=new mWk;this.Qa(this.sb);this.Kb=!1;this.qa=new $t("Refresh",this.Ea());this.Qa(this.qa)}z(qzp,PY);u=qzp.prototype;u.Ja=function(){this.Pb(Hq(lzp,{id:this.getId()}))};
u.Ra=function(){PY.prototype.Ra.call(this);this.Sa.render(Ym("waffle-filter-by-value-sidebar-column-info"));var a=this.Ea().Ka("waffle-filter-by-value-search-input");this.Ab.wb(a);this.tb=new Ft(a);this.Ge.render(this.Cb("waffle-filter-by-value-menu"));dr(this.Ge.Va(),"docs-material");this.D.render(this.Cb("waffle-filter-by-value-additional-values-menu"));dr(this.D.Va(),"docs-material");this.F.render(this.Cb("waffle-filter-by-value-empty-values-menu"));dr(this.F.Va(),"docs-material");this.O.render(this.Cb("waffle-filter-by-value-sort-by-frequency-desc-button"));
this.R.render(this.Cb("waffle-filter-by-value-sort-by-frequency-asc-button"));this.V.render(this.Cb("waffle-filter-by-value-sort-by-value-asc-button"));this.ma.render(this.Cb("waffle-filter-by-value-sort-by-value-desc-button"));qs(this.O.Va(),"Sort by most frequent values",void 0);qs(this.R.Va(),"Sort by least frequent values",void 0);qs(this.V.Va(),"Sort by ascending values",void 0);qs(this.ma.Va(),"Sort by descending values",void 0);this.Wa.render(this.Cb("waffle-filter-by-value-select-all-button"));
this.Ga.render(this.Cb("waffle-filter-by-value-clear-button"));qs(this.Wa.Va(),"Select all items below",void 0);qs(this.Ga.Va(),"Unselect all items below",void 0);this.oa.render(this.Ka("waffle-filter-by-value-ok-button-wrapper"));this.Ba.render(this.Ka("waffle-filter-by-value-cancel-button-wrapper"));this.sb.render(this.Ka("waffle-filter-by-value-sidebar-content-loading"));this.qa.render(this.Cb("waffle-filter-by-value-content-unavailable-refresh-button-wrapper"));a=this.Ka("waffle-sidebar-title-close");
ts(a,"waffle-filter-by-value");this.getHandler().listen(this.oa,"action",this.n9b).listen(this.Ba,"action",this.k9b).listen(this.Wa,"action",this.p9b).listen(this.Ga,"action",this.l9b).listen(this.V,"action",this.c7c).listen(this.ma,"action",this.d7c).listen(this.O,"action",this.b7c).listen(this.R,"action",this.a7c).listen(this.qa,"action",this.o9b).listen(this.tb,"input",this.m9b)};u.m9b=function(){var a=this.Ab.getValue();rzp(this,a);a&&!this.Kb&&(this.C.C(116107),this.Kb=!0)};
function rzp(a,b){a.Ge.Bh(function(c){c.Iwa(b)})}u.refresh=function(a){var b=a.D,c=a.jg(),d=Nw(b,c);this.Gb=c;c=this.Sa;var e=c.Ka("waffle-filter-by-value-sidebar-header-column-name");c.Ea().Ih(e,d);ar(e,d);this.Ha=c=a.$g();d=this.Sa.Ka("waffle-filter-by-value-sidebar-header-icon");br(d,"waffle-filter-by-value-sidebar-header-icon");(c=eJk(c))&&dr(d,c);this.La=a.C;this.ib=b;this.J=a.$_;this.jb=a.F;this.$a=a.Ztb;this.focus()};
function szp(a,b){tzp(a,"loading");b.addCallback(function(c){if(c){a.Ge.$e(!0);a.D.$e(!0);a.F.$e(!0);var d=mj(c,18,jzk).Mc(),e=kj(c,10),f=a.Ka("waffle-filter-by-value-menu-title-secondary"),h=500<e?"showing up to 500":"showing "+(e+" total");nn(f,"("+h+")");ar(f,h);c=kj(c,11);e=(f=500<e)?e-500:null;for(h=0;h<d.length;h++){var k=d[h],l=k.uh(),m=l.getValue();0==m.MB()||2==m.MB()&&""==m.getStringValue()||(k=new jzp(new izp(l,k.Eg()),a.Ea()),a.Ge.Qa(k,!0),k.ld("apps-menuitem"),on(k.getElement(),!0),uzp(a,
k),k=k.Ka("waffle-filter-by-value-item-freq"),qs(k,"Number of instances of this value in the column",void 0))}d=null;a.J&&cj(a.J,2)&&0<dj(a.J.D(),9)&&(d=a.J.D());null!=d?vzp(a,d,f,e,c):wzp(a,f,!0,e,!0,c);xzp(a,a.P9a,!0);yzp(a.O);tzp(a,"loaded");a.focus()}})}
function vzp(a,b,c,d,e){var f=b.gI(),h=mj(b,9,zwa).Mc(),k=[];a.Ge.Bh(function(t){var v=t.ob().uh().getValue();k.push(v);v=zzp(h,v);f&&(v=!v);t.Xc(v)});for(var l=b=!1,m=0;m<h.length;m++){var p=h[m],r=0==p.MB();r&&(b=!0);r||zzp(k,p)||(c=!0,l=$k().LCc()(a.Ha),l=aj(gXj,l),p=hzk(Lwa().setValue(p),l).xa(),p=new jzp(new izp(p,null),a.Ea()),p.Xc(!f),a.D.Qa(p,!0),p.ld("apps-menuitem"),uzp(a,p),on(p.getElement(),!0),l=!0)}wzp(a,c,f,d,f&&!b||!f&&b,e);l&&a.C.C(116087)}
function zzp(a,b){for(var c=0;c<a.length;c++)if(b.equals(a[c]))return!0;return!1}function wzp(a,b,c,d,e,f){d&&(d=new gzp(d,a.Ea()),d.Xc(c),a.D.Qa(d,!0),d.ld("apps-menuitem"),uzp(a,d),on(d.getElement(),!0));a.D.setVisible(b);b&&a.C.C(116088);(c=a.Cb("waffle-filter-by-value-additional-values-menu-title"))&&nq(c,b);if(b=0<f)f=new ozp(f,a.Ea()),f.Xc(e),a.F.Qa(f,!0),f.ld("apps-menuitem"),uzp(a,f),on(f.getElement(),!0);a=a.Ka("waffle-filter-by-value-empty-values-wrapper");nq(a,b)}
function tzp(a,b){a.Ab.reset();var c=a.Ka("waffle-filter-by-value-sidebar-header-wrapper");nq(c,"loaded"==b);c=a.Ka("waffle-filter-by-value-sidebar-content-loaded");nq(c,"loaded"==b);c=a.Ka("waffle-filter-by-value-sidebar-footer-wrapper");nq(c,"loaded"==b);c=a.Ka("waffle-filter-by-value-sidebar-content-unavailable");nq(c,"unavailable"==b);nWk(a.sb,"loading"==b)}function Azp(a){tzp(a,"unavailable");qs(a.qa.Va(),"Estimating\u2026",void 0)}u.Cv=function(a){a=a?g9j(a):"";qs(this.qa.Va(),a,void 0)};
u.gZb=function(a){var b=this.Ka("waffle-filter-by-value-last-updated-time");a="Updated: "+this.Zb.format(a);nn(b,a);qs(b,"Last time the values were retrieved",void 0);ar(b,a+" Last time the values were retrieved");N5j(b,2,2);O5j(b,18)};
u.n9b=function(){var a=Bzp(this),b=[];this.Ge.Bh(function(e){a^e.Me()&&b.push(e.ob().uh().getValue())});this.D.Bh(function(e){a^e.Me()&&(e instanceof gzp||b.push(e.ob().uh().getValue()))});if(1==this.F.Bd()){var c=this.F.Nd(0),d=Bwa(0).xa();a^c.Me()&&(b.push(d),this.C.C(116094))}a9b.Ob(new kWk(null,this.La,this.ib,this.Ha,this.J,this.jb,this.$a,a,b));Czp(this)};
function Bzp(a){var b=!0,c=!0;if(a.D.isVisible()&&0<a.D.Bd()){var d=a.D.Nd(a.D.Bd()-1);d instanceof gzp&&(c=!1,b=d.Me(),a.C.C(b?116108:116109))}c&&Dzp(a.Ge)<a.Ge.Bd()/2&&(b=!1);return b}function uzp(a,b){a.getHandler().listen(b,"action",a.zkb).listen(b.Va(),"keydown",function(c){32!=c.keyCode&&13!=c.keyCode||b.Xc(!b.Me())})}u.zkb=function(){var a=0<Dzp(this.Ge)+Dzp(this.D)+Dzp(this.F);this.oa.Za(a)};function Dzp(a){var b=0;a.Bh(function(c){c.Me()&&b++});return b}
function Czp(a){var b=null;switch(a.La){case 2:b=116090;break;case 1:b=116093;break;case 4:b=116091;break;case 5:b=116092}a.C.C(b)}u.k9b=function(){this.C.C(116089);this.dispatchEvent("close-sidebar")};u.p9b=function(){this.C.C(116102);Ezp(this,!0);this.zkb()};u.l9b=function(){this.C.C(116101);Ezp(this,!1);this.zkb()};u.o9b=function(){b9b.Ob(new kWk(this.Gb,this.La,this.ib,this.Ha,this.J,this.jb,this.$a,null,null));this.C.C(116147)};
function Ezp(a,b){a.Ge.Bh(function(c){c.isVisible()&&c.Xc(b)});a.D.Bh(function(c){c.isVisible()&&c.Xc(b)});a.F.Bh(function(c){c.isVisible()&&c.Xc(b)})}u.c7c=function(){this.C.C(116105);xzp(this,this.E1b,!1);yzp(this.V)};u.d7c=function(){this.C.C(116106);xzp(this,this.E1b,!0);yzp(this.ma)};u.b7c=function(){this.C.C(116104);xzp(this,this.P9a,!0);yzp(this.O)};u.a7c=function(){this.C.C(116103);xzp(this,this.P9a,!1);yzp(this.R)};
u.E1b=function(a,b){var c=a.ob().uh().getValue(),d=b.ob().uh().getValue();c.MB();d.MB();return 3==c.MB()?c.eE()-d.eE():ng(kzp(a),kzp(b))};u.P9a=function(a,b){return a.ob().So()-b.ob().So()};
function xzp(a,b,c){fr(a.O.Va(),"waffle-filter-by-value-active-sort-button");fr(a.R.Va(),"waffle-filter-by-value-active-sort-button");fr(a.V.Va(),"waffle-filter-by-value-active-sort-button");fr(a.ma.Va(),"waffle-filter-by-value-active-sort-button");var d=Fzp(a);a.Ge.$e();fg(d,b);if(c)for(b=d.length-1;0<=b;b--)a.Ge.Qa(d[b],!1);else for(b=0;b<d.length;b++)a.Ge.Qa(d[b],!1)}function yzp(a){dr(a.Va(),"waffle-filter-by-value-active-sort-button")}
function Fzp(a){var b=[];a.Ge.Bh(function(c){b.push(c)});return b}function Gzp(a,b,c,d){vY.call(this,a,d);var e=this;this.C=b;this.F=c;lp(this.J,b9b,function(f){return Hzp(e,f.data)});lp(this.J,a9b,function(){return e.jE()});this.D.listen(this.C.C,"na",this.r9b).listen(this.F,"selectionChange",this.q9b)}z(Gzp,vY);u=Gzp.prototype;u.Dj=function(){return Z8b};u.ov=function(){return $8b};u.r9b=function(){this.jE()};u.q9b=function(){this.jE()};u.jE=function(){this.ud.Za(!1);vY.prototype.jE.call(this)};
function Hzp(a,b){a.ud.refresh(b);a.ez(!0);var c=Dl();szp(a.ud,c);var d=b.jg(),e=b.D;gEk(a.C.Sa,d,e).then(function(f){c.callback(f.C);a.ud.gZb(f.D)},function(){c.callback(null);a.ud&&(Azp(a.ud),PZj(a.C.Sa,d,e).then(function(f){a.ud&&a.ud.Cv(f)},function(){a.ud&&a.ud.Cv(null)}))})}function Izp(a,b){this.D=a;this.C=b}function Jzp(a){this.D=a;this.C={}}
function Kzp(a,b){if(b){var c=pf(qf(),"feds")?$k().j$a()(b):[],d=new Set(c),e=(new Date).getTime();b.forEach(function(f){if(a.C[f]){var h=O2c(f),k=h?h.getState():null;if(h&&k&&(2==k||3==k)){h=e-a.C[f].D;if(k=d.has(f)?mxe[k]:kxe[k]){h=Vk(new Uk,1E3*h);var l=a.C[f].C;var m=new GOa;l=T(m,2,l);if(m=$k().GCc()(f))T(l,5,m.columns),T(l,4,m.rows);l=Zk(tzk(l),!0);h=Lp(dGb(Jp(new Ip,41),h),l);a.D.C(k,h.xa())}delete a.C[f]}}})}}function Lzp(a){oj.call(this,a)}z(Lzp,oj);Lzp.prototype.jg=function(){return this.message.jg()};
function Mzp(a){this.Jb=Zi(a,-1,0)}z(Mzp,$i);Mzp.prototype.zb=function(){return new Lzp(this)};Mzp.prototype.jg=function(){return gj(this,1)};function Nzp(a){oj.call(this,a)}z(Nzp,oj);Nzp.prototype.jg=function(){return this.message.jg()};function Ozp(a){this.Jb=Zi(a,-1,0)}z(Ozp,$i);Ozp.prototype.zb=function(){return new Nzp(this)};Ozp.prototype.jg=function(){return gj(this,1)};function Pzp(a,b){ix.call(this,139);this.C=a||"";this.D=b}z(Pzp,ix);
Pzp.prototype.Ig=function(){var a=void 0===a?bj(Mzp):a;a=new Lzp(a);a=tj(a,1,this.C);return zj(a,2,this.D).xa()};Pzp.prototype.kN=function(){return Yva(bj(Ozp))};
function Qzp(){var a='<div class="'+V("waffle-targeted-cs-promo-content")+'"><img src="//ssl.gstatic.com/docs/spreadsheets/connectedSheetsPromoOnboardingImage.jpg" class="'+V("waffle-targeted-cs-promo-image")+'"><div class="'+V("waffle-targeted-cs-promo-text")+'"><div class="'+V("waffle-targeted-cs-promo-title")+'" id="'+V("waffle-targeted-cs-promo-title")+'">';a=a+'Analyze billions of rows of BigQuery data in Sheets</div><div class="'+(V("waffle-targeted-cs-promo-body")+'"><span id="'+V("waffle-targeted-cs-promo-body-text")+
'">');a=a+'Create charts, pivot tables and functions over the entire dataset, or extract a subset of the dataset directly into Google Sheets.</span> <span class="'+(V("waffle-targeted-cs-promo-link-button")+" "+V("goog-link-button")+'"><a href="https://cloud.google.com/blog/products/g-suite/connected-sheets-is-generally-available" target="_blank">');return Jq(a+"Learn more</a></span></div></div></div>")}
function Rzp(){return Jq(EWb({ek:"docs-material waffle-targeted-cs-promo-close",hidden:!1,enabled:!0}))}function Szp(a,b){qWk.call(this,a,{E8a:!1,F8a:!1,Zcb:!1,By:!1},b);this.F.setContent("Try it now");this.setPosition(2,1);this.ld("waffle-targeted-cs-promo-base");cs(this,!1);this.J=new es(void 0,Kt.rb(),b);this.Qa(this.J)}z(Szp,qWk);u=Szp.prototype;
u.Ja=function(){qWk.prototype.Ja.call(this);var a=this.Va(),b=Hq(Rzp),c=$q(b);qs(b,c,void 0);en(a,b);this.J.wb(b);b=Hq(Qzp);this.setContent(b);Xq(a,"alertdialog");Yq(a,"labelledby","waffle-targeted-cs-promo-title");Yq(a,"describedby","waffle-targeted-cs-promo-body-text")};u.Ra=function(){var a=this;qWk.prototype.Ra.call(this);kr(this.Ka("docs-icon-close-white"),"waffle-targeted-cs-promo-hc","white"==ss());this.getHandler().listen(this.J,"action",function(){return a.UIa()})};
u.render=function(){qWk.prototype.render.call(this);var a=this.Ka("jfk-bubble-arrow-id");nq(a,!1)};u.Obb=function(){this.setVisible(!1);ngc.Ob();Cq("https://docs.google.com/spreadsheets/create?fbpf=true")};u.UIa=function(){this.setVisible(!1);ogc.Ob()};
function Tzp(a,b,c,d){li.call(this);var e=this;this.C=a.F;this.H=b;this.O=c;this.Db=d;this.J=!1;this.D=-1;this.F=new Mm(this);this.Da(this.F);this.F.listen(fx,"trigger-targeted-bigsheets-promo",function(f){if(Uzp(e)&&1==e.D){var h=rwp(e.C);h.setValue(h.getValue()+1);e.J=!0;h=e.Db.getElement("waffle-assistant-entry-button-icon");h=new Szp(h,e.Db);var k=new wYb(h,!0,!0,!0);e.O.Dm(k);h.render();h=new bPa;T(h,4,f.trigger);f=new Yk;wk(f,43,h);e.H.C(116141,Jp(Lp(new Ip,f),19).xa())}})}z(Tzp,li);
function Vzp(a){(pf(qf(),"fedt")||pf(qf(),"fdsvo"))&&Uzp(a)?wwp().then(function(b){a.D=kj(b,1);if(cj(b,2)){var c=kj(b,2);b=new bPa;T(b,1,c);c=pf(qf(),"docs-idu");T(b,2,c);c=rwp(a.C).getValue();T(b,3,c);c=new Yk;wk(c,43,b);a.H.C(116155,Jp(Lp(new Ip,c),19).xa())}}):a.D=0}function Uzp(a){var b=a.C.F["ritz-HasCreatedDatasheet"].getValue(),c=rwp(a.C).getValue();return!b&&3>=c&&!a.J}
function Wzp(a){li.call(this);this.C=a.wc(2,lDk);this.F=gj(a,1)||null;this.D=new $Sk(500,500,"dbxScheduleOnCompleteAuth");this.Da(this.D)}z(Wzp,li);function Xzp(a,b,c){c=void 0===c?!0:c;ej(a.C,1);var d=Fwp(Hwp(),a.C);b&&tj(d,3,b);awp(yx.rb(),d.xa()).then(function(e){Yzp(a,e.getStatus(),gj(e,2),!0,c)},function(){return Zzp()})}
function $zp(a,b,c){c=void 0===c?!0:c;var d=Vwp(Uwp(Xwp(),a.F),a.C);b&&tj(d,3,b);bwp(yx.rb(),d.xa()).then(function(e){Yzp(a,e.getStatus(),gj(e,2),!1,c)},function(){return Zzp()})}
function Yzp(a,b,c,d,e){switch(b){case 2:if(!e){Zzp();break}aTk(a.D,c,function(f){d?Xzp(a,f,!1):$zp(a,f,!1)});break;case 3:Ns.rb().postMessage(Ps("You do not have permission to delegate access for this BigQuery project. The delegated access settings were not saved. Contact your admin or check BigQuery project settings.","error",!0))}}function Zzp(){Ns.rb().postMessage(Ps("There was a problem saving the delegated access settings. Please check connection settings.","error",!0))}
function aAp(a){switch(a){case 1:return 3;case 2:return 2;case 3:return 4;case 4:return 1;case 5:return 5;case 6:return 6;case 0:return 0}}var bAp={ok:"OK",cancel:"Learn more"};
function cAp(a,b,c,d,e,f,h,k,l,m,p,r,t){YTk.call(this,a,b,d,f,h,k,l);var v=this;this.Ga=Vm("docs-chrome")?new Byp(b,this.D,l,p,f,c,m,d,t,r,k.Rf()):null;this.Da(this.Ga);this.jb=f;this.qa=new Mm(this);this.Da(this.qa);this.Ab=new Typ(a,b,c,d,e,k,l);this.Da(this.Ab);this.R=m;this.Ba=a.D.C;this.$a=new Jzp(l);this.ib=r;this.bb=c;pf(qf(),"febsfbv")&&(d=new qzp(l),d.render(),d.setVisible(!1),this.Gb=new Gzp(d,a,c,e),this.Da(this.Gb));this.tb=new Qyp(a,b,c,l,e,m,t);this.Da(this.tb);this.V=new Set;this.ma=
new Set;if(b=pf(qf(),"fetbp"))this.Sa=new Tzp(a,l,this.Ha,Rm()),this.Da(this.Sa),Vzp(this.Sa);this.Wa=!1;(l=Yt.rb().C.newDatasourceIdFromOnboarding)?dAp(this,l):Dvp()?eAp(this,new WSk(null,aj(XJk,Dvp())),!1):Yt.rb().C.showBigSheetsOnboardingDialogOnStart&&g8b.isEnabled()?pf(qf(),"fdcws")?fAp(this):this.r_b():Evp()&&g8b.isEnabled()&&b&&(pf(qf(),"fdcws")?fAp(this):this.UFa());this.qa.listen(this.D,"db-execution-status-updated",this.t9b).listen(this.D,"datasources-changed",this.gQc).listen(this.F,"na",
this.VYc).listen(this.F,"na",this.C0b).listen(this.F,"na",this.SQc);this.La=new Km;this.Da(this.La);this.La.Dc(a.O.H,function(x){v.C0b();gAp(v,x)})}z(cAp,YTk);u=cAp.prototype;
u.gCb=function(a){a.C(e8b,dA).F(e8b,dA).C(i8b,dA).C(l8b,swe).F(l8b,swe).C(d8b,dA).F(d8b,dA).C(j8b,dA).C(B7b,swe).C(ucc,swe).C(m8b,dA).C(n8b,dA).C(o8b,dA).C(p8b,dA).C(vu,dA).C(k8b,dA).C(Z7b,dA).C(a8b,dA).C($7b,dA).C(q8b,dA).C(r8b,twe).F(r8b,twe).C(b8b,rwe).C(c8b,dA).F(c8b,dA);var b=pf(qf(),"feds");a.C(g7b,b?uwe:dA);a.C(i7b,b?uwe:dA);a.C(h7b,b?uwe:dA);a.C(n7b,dA);a.C(C7b,b?uwe:dA)};
u.d0b=function(){var a=this;this.oa.subscribe(i8b,"action",this.Ua).subscribe(e8b,"action",this.pRc).subscribe(d8b,"action",this.d9c).subscribe(l8b,"action",this.Aod).subscribe(j8b,"action",function(b){return hAp(a,4,b)}).subscribe(h7b,"action",function(b){return iAp(a,b)}).subscribe(i7b,"action",function(b){return hAp(a,5,b)}).subscribe(g7b,"action",function(b){return hAp(a,1,b)}).subscribe(n7b,"action",function(b){return hAp(a,3,b)}).subscribe(B7b,"action",this.q6c).subscribe(m8b,"action",this.UFa).subscribe(n8b,
"action",this.l6c).subscribe(ucc,"action",this.z6c).subscribe(o8b,"action",this.s_b).subscribe(p8b,"action",this.tod).subscribe(C7b,"action",function(b){jAp(a,b.C)}).subscribe(q8b,"action",this.e9c).subscribe(r8b,"action",this.V9c).subscribe(Z7b,"action",function(){return kAp(a,null,!0)}).subscribe(a8b,"action",this.Rzc).subscribe($7b,"action",this.Gyc).subscribe(b8b,"action",this.Esd).subscribe(c8b,"action",this.sRc)};u.t9b=function(a){a=a.D;Kzp(this.$a,a);lAp(this,a)};
function lAp(a,b){b&&b.forEach(function(c){var d=O2c(c);2===(d?d.getState():null)&&4===$k().VX()(c)&&(c=$k().Y7()(c))&&(d=a.D.ma,d.C.delete(c),Kx(d,c))})}u.d9c=function(a){mAp(this,a.jg(),a.C,a.D)};
u.Aod=function(a){var b=this,c=a.jg(),d=a.C;if("pick-new source"==d||"change-cloud-project"==d)this.UFa(a);else{var e=aj(XJk,$k().OGb()(c)),f=new sTk(yx.rb());this.O.addCallback(function(h){if(pf(qf(),"fdcws")&&cj(e,3)&&cj(HY(e),4)){var k=h.GBc(c,e);b.Da(k);WY(b.C,k)}else if(!d8b.isEnabled()&&cj(e,3)&&cj(HY(e),4))k=h.FBc(c,e),b.Da(k),WY(b.C,k);else{var l=aUk("Connecting to BigQuery\u2026");k=tTk(f);var m=nAp(c);Fn([k,m]).then(function(p){Os(Ns.rb(),l);p=h.M9a(c,e,p[0],void 0,p[1]||void 0);b.Da(p);
WY(b.C,p)},function(){Os(Ns.rb(),l);b.fAa();var p=h.M9a(c,e,[],!0);b.Da(p);WY(b.C,p)})}})}};u.s_b=function(a){var b=this;this.O.addCallback(function(c){var d=a.F,e=d?d.C:null,f=d?d.jg():null;d=d?d.D:null;if(f&&e){var h=cj(HY(e),4)?dxp(e):e;nAp(f,d).then(function(k){k=c.M9a(f,h,a.C,void 0,k||void 0);b.Da(k);WY(b.C,k)})}else f?nAp(f,d).then(function(k){k=c.YFb(a,k||void 0);b.Da(k);WY(b.C,k)}):(e=c.YFb(a),b.Da(e),WY(b.C,e))})};
u.tod=function(a){var b=this;this.O.addCallback(function(c){var d=aUk("Connecting to BigQuery\u2026");tTk(new sTk(yx.rb())).then(function(e){Os(Ns.rb(),d);e=c.ZFb(a,e);b.Da(e);WY(b.C,e)},function(){Os(Ns.rb(),d);b.fAa();var e=c.ZFb(a,[]);b.Da(e);WY(b.C,e)})})};function nAp(a,b){b=void 0===b?null:b;if(!pf(qf(),"fedd"))return Dn(null);if(b)return Dn(Tvp(Owp(),b).xa());a=Lwp(Nwp(),a).xa();return lwp(a).then(aa(),q(null))}u.pRc=function(a){mAp(this,null,a.C,a.D)};
function mAp(a,b,c,d){var e=null==b,f=new Pzp(b,c);e&&(a.H.C(cj(c,3)&&cj(HY(c),4)?116023:116024),c=a.D.F.F["ritz-HasCreatedDatasheet"],c.getValue()||c.setValue(!0),Evp()&&a.H.C(116186));jx(f,function(h,k){if(h){h=k.jg();oAp(a,h,d,e);k=$k().CCc()(h);var l=$k().wCc()(k,h);pAp(a,l,4,[k]);e?dAp(a,h):Kx(a.D.ma,b)}});a.R.C(f);e||zSk(a.C)}u.e9c=function(a){oAp(this,a.jg(),a.D,!1,a.C);zSk(this.C)};
function oAp(a,b,c,d,e){e=void 0===e?null:e;pf(qf(),"fedda")&&d&&(c&&ej(c.wc(2,lDk),1)?a.H.C(116204):a.H.C(116205));pf(qf(),"fedd")&&c&&(a.H.C(116192),gj(c,1)||ej(c.wc(2,lDk),1))&&(d=ZJk().Zc(b),e?zj(d,2,e):(b=aj(XJk,$k().OGb()(b)),zj(d,2,b)),b=$Jk().Za(ej(c.wc(2,lDk),1)),d=zj(b,2,d),d=yDk(d),gj(c,1)&&(c=gj(c,1),tj(d,1,c)),c=new Wzp(d.xa()),a.Da(c),c.F?$zp(c,null):Xzp(c,null))}
u.r_b=function(){var a=this,b=this.D.F.D["ritz-DisplayCountBigsheetsWelcomeDialog"],c=b.getValue();if(1<=c)this.UFa();else{b.setValue(Math.min(c+1,2147483647));var d=new Fyp;this.Da(d);WY(this.C,d);d.Hl().then(function(e){e?a.UFa():ii(d)},function(){ii(d)})}};function dAp(a,b){var c=Yt.rb().C.transientErrorFromOnboarding;c?(qAp(a),Un(function(){zSk(a.C);B7b.Ob(new E1c("",aj(Aj,c)))},3E3)):(a.V.add(b),qAp(a))}
function qAp(a){var b=new Hyp("//ssl.gstatic.com/docs/spreadsheets/bigsheets_loading_3.gif",a.H);a.Da(b);WY(a.C,b)}function kAp(a,b,c){var d=qz(a.F);if(d&&pv(d)){var e=d.jg();Kx(a.D.ma,e).then(function(f){var h=new EUc(f,e),k=Jp(new Ip,103).xa();f=new vxp(e,b,f,h,a.D.Ua,c,a.R,a.ib,a.Ba,a.H,k);a.Da(f);a.qa.listen(f,"update",a.VOc);WY(a.C,f)})}}function fAp(a){var b=new oxp;a.Da(b);WY(a.C,b)}u.Rzc=function(){var a=qz(this.F);a&&pv(a)&&(a=rAp(a),kAp(this,a[0],!0))};
u.Esd=function(){var a=qz(this.F);a&&pv(a)&&(a=rAp(a),kAp(this,a[0],!1))};u.Gyc=function(){var a=this,b=qz(this.F);if(b&&pv(b)){var c=rAp(b),d=c.length;d=(new it("{NUM_COLUMNS, plural,=1 {Are you sure you want to delete this calculated column?}other {Are you sure you want to delete {NUM_COLUMNS} calculated columns?}}")).format({NUM_COLUMNS:d});nGd(this.jb,d,function(){return sAp(a,b.jg(),c)})}};function sAp(a,b,c){b=new fzp(b,c);jx(b,function(d){a.H.C(d?36648:36649)});a.R.C(b)}
u.VOc=function(a){var b=qz(this.F);b&&pv(b)&&b.jg()==a.ww&&a.C&&(a=b.Kd(),b=a.qk(),Hw(a,RKc(a,gOc(a,b-1,b))))};function rAp(a){a=a.Kd();var b=Tw(a);return Ind(a,b).map(function(c){return gj(c,2)})}u.gQc=function(){var a=this.D.O;a.R&&(a=a.D,a.D=Date.now(),a.C.clear())};u.VYc=function(){iwp(this.D.O,qz(this.F))};u.SQc=function(){if(this.Ga&&!ySk(this.C)){var a=this.Ga;a.C&&zyp(a.C)}};
u.C0b=function(){var a=qz(this.F);if(a&&pv(a)){var b=a.jg();if(this.V.has(b)){var c=$k().PGb()(a.Eb());if(c)if(c=dEk(this.D.O,c),"fetch-successful"==c.getType()){a=a.Kd().qk();var d=$k().qOa()(b);c=null;null!==d&&(d=parseInt(d,10),0<d&&(c=nod.format(d)));a=new Lyp(a,c);this.Da(a);WY(this.C,a,!0);this.V.delete(b)}else"fetch-failed"==c.getType()&&(ySk(this.C)instanceof Hyp&&ASk(this.C),this.V.delete(b))}}};
u.UFa=function(a){var b=this,c=void 0;a&&(c=new WSk(a.jg(),null));var d=new gxp(new sTk(yx.rb()),this.H,c);this.Da(d);WY(this.C,d);Evp()&&!this.Wa&&(lxp(d),this.Wa=!0,this.H.C(116185));dUk(d.Va());d.Hl().then(function(e){if(a&&"change-cloud-project"==a.C){var f=a.D;e=new rTk(f.C,f.H,"db-source-table"===e.D?e.J:null,e.D,e.F)}b.s_b(e)},function(e){e&&b.fAa();ii(d)})};u.l6c=function(a){eAp(this,a,!0)};function eAp(a,b,c){a.O.addCallback(function(d){d=d.EBc(b,c);a.Da(d);WY(a.C,d)})}
u.fAa=function(){this.H.C(36685);cUk("Could not connect to BigQuery")};function hAp(a,b,c){var d=a.D.O,e=dEk(d,c).C;a.H.C(36985);null!=e&&cj(e,2)&&37==e.$h()?kwp(d,c,function(){tAp(a,b,[c])},function(f){f=f.C;null!=f&&cj(f,2)&&37==f.$h()?(a.H.C(36986),f=axp(b,f),uAp(a,f.body,f.title)):tAp(a,b,[c])}):tAp(a,b,[c])}
function jAp(a,b){if(0!==b.length){a.H.C(36985);var c=vAp(a,b);0<c.length?jwp(a.D.O,c,function(){tAp(a,null,b)},function(d){d=wAp(a,d);0<d.length?(a.H.C(36986),d="You do not have access to the following BigQuery connection(s): \n\n"+(d.join(", ")+" \n\n Contact the owner(s) of the BigQuery connections(s) or your admin to request access. \n\n"),d=ph(d),uAp(a,d,"Refresh failed")):tAp(a,null,b)}):tAp(a,null,b)}}
function vAp(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d],f=dEk(a.D.O,e).C;null!=f&&cj(f,2)&&37==f.$h()&&c.push(e)}return c}function wAp(a,b){var c=[];b.forEach(function(d){var e=d.cj();cj(d,1)&&cj(e,2)&&37==e.$h()&&(d=$k().Y7()(d.Cu()),d=$k().Tda()(d),d=Fw(a.D.C,d).Qg(),c.push(d))});bg(c);return c}
function tAp(a,b,c){pf(qf(),"fedd")&&fwp(a.D.O,c);var d=pf(qf(),"feds")?$k().j$a()(c):[],e=zf(c,function(f){return!Mf(d,f)});Nf(d)||xAp(a,$k().xCc()(d),b,d);Nf(e)||pAp(a,$k().vCc()(e),b,c);yAp(a,c)}
function xAp(a,b,c,d){a.H.C(116188);b=aj(Swp,b);var e=(new Date).getTime();ewp(a.D.O,d);owp(yx.rb(),b,a.Ba).then(function(f){var h=mj(f,1,Nvp);zAp(a,h.Mc(),d,e,c);for(var k={},l=ea(h),m=l.next();!m.done;m=l.next())m=m.value,cj(m.cj(),2)||(k[m.Cu()]=m.Tj());Og(k)||(k=$k().zCc()(k),k=aj(eSd,k),a.R.C(new gSd(k)));AAp(a,h.Mc());return f},function(f){f=f.pea(0).cj();f3c(a.D.O,new Set(d),f)})}
function pAp(a,b,c,d){b=aj(Qwp,b);var e=(new Date).getTime();ewp(a.D.O,d);pwp(yx.rb(),b,a.Ba).then(function(f){var h=mj(f,2,Nvp).Mc();zAp(a,h,d,e,c);AAp(a,h);return f},function(f){f=f.pea(0).cj();f3c(a.D.O,new Set(d),f)})}function zAp(a,b,c,d,e){c=1==c.length?c[0]:null;!cj(b[0].cj(),2)&&c&&e&&(a.$a.C[c]=new Izp(d,aAp(e)))}function AAp(a,b){b=ea(b);for(var c=b.next();!c.done;c=b.next()){var d=c.value;c=d.cj();3===c.getState()&&(d=d.Cu(),f3c(a.D.O,new Set([d]),c))}}
function yAp(a,b){if(0!=b.length){var c=new it("{numObjects, plural, =1 {Refreshing object} other {Refreshing # objects}}");hx(c.format({numObjects:b.length}));b.forEach(function(d){return a.ma.add(d)})}}function gAp(a,b){0!=a.ma.size&&(b.C.forEach(function(c){var d=dEk(a.D.O,c);"loading"!=d.getType()&&"fetching-results"!=d.getType()&&a.ma.delete(c)}),0==a.ma.size&&"dbobjectmodel-event-update"==b.getType()&&hx("Refresh complete"))}
u.q6c=function(a){if(a){var b=$k().sOa()(a.Cu())?$k().VX()(a.Cu()):0;a=axp(b,a.C);uAp(this,a.body,a.title)}};u.z6c=function(){ycc.setVisible(!0)};function uAp(a,b,c){DPc(b,g(),c,bAp,a.u9b,void 0,void 0,!1,"big-sheets-feedback")}u.V9c=function(){Cq("https://connectedsheets.page.link/tutorial",{target:"_blank"})};u.u9b=function(){Cq("https://connectedsheets.page.link/support")};u.sRc=function(){var a=qz(this.F);a&&pv(a)&&(J2c(this.D.ma),SPc(a.jg()))};
function iAp(a,b){var c=lx(a.bb),d=a.D.C.C,e=$k().Y7()(b),f=null;c?f=sFk(c)||uFk(c):d&&1==d.jj()&&(f=d.F);pf(qf(),"fedcsdl")&&f&&"no-results"==dEk(a.D.O,b).getType()&&(c=Bwp(Awp(Dwp(),f),e).xa(),mwp(c).then(function(h){var k=a.H,l=k.C,m=f;var p=new Fza;var r=kj(h,1);p=T(p,1,r);r=kj(h,2);p=T(p,2,r);r=kj(h,3);p=T(p,3,r);r=kj(h,4);p=T(p,4,r);r=kj(h,5);p=T(p,5,r);r=h.getStatus();p=T(p,6,r);r=BAp(h.Mh());p=T(p,7,r);r=h.Kg();p=T(p,8,r);r=h.Nh();p=T(p,9,r);m=T(p,10,parseInt(m,10));p=lj(h,10,0);m=T(m,11,
p);p=kj(h,11);m=T(m,12,p);pf(qf(),"fesfcsdl")?(p=kj(h,12),m=T(m,13,p),p=kj(h,13),m=T(m,14,p),p=kj(h,14),m=T(m,15,p),p=kj(h,15),m=T(m,16,p),p=kj(h,16),m=T(m,17,p),p=lj(h,17,0),m=T(m,18,p),p=lj(h,18,0),m=T(m,19,p),h=kj(h,19),h=T(m,20,h)):h=m;m=new Pk;h=wk(m,132,h);h=Kp(Jp(new Ip,75),h).xa();l.call(k,116028,h)},g()));hAp(a,2,b)}
function BAp(a){switch(a){case 0:return 0;case 1:return 2;case 2:return 3;case 3:return 4;case 4:return 5;case 5:return 6;case 6:return 7;case 7:return 8;case 8:return 9;case 9:return 10;case 10:return 14;case 11:return 6;case 12:return 17;case 13:return 15;case 14:return 11;case 15:return 18;case 16:return 12;case 17:return 20;case 18:return 21;case 19:return 22;case 20:return 23;case 21:return 25;case 22:return 26;default:return 0}}function CAp(){li.call(this)}z(CAp,ro);CAp.prototype.C=function(){return cAp};Co("dbsource",CAp);
