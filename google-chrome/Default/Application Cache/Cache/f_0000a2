function htp(a){oj.call(this,a)}z(htp,oj);htp.prototype.getStatus=function(){return this.message.getStatus()};function itp(a){this.Jb=Zi(a,-1,0)}z(itp,$i);itp.prototype.zb=function(){return new htp(this)};itp.prototype.getStatus=function(){return lj(this,1,0)};function jtp(a){oj.call(this,a)}z(jtp,oj);jtp.prototype.getStatus=function(){return this.message.getStatus()};function ktp(a){this.Jb=Zi(a,-1,0)}z(ktp,$i);ktp.prototype.zb=function(){return new jtp(this)};
ktp.prototype.getStatus=function(){return lj(this,1,0)};function ltp(a,b){return new Cn(function(c,d){zx(a,"/dbx/createSchedule",[],b.Nb(),function(e){c(aj(itp,JSON.stringify(e.eh())))},d)})}function mtp(a,b){return new Cn(function(c,d){zx(a,"/dbx/updateSchedule",[],b.Nb(),function(e){c(aj(ktp,JSON.stringify(e.eh())))},d)})}function ntp(a){if(!$k().sOa()(a)||$k().RCc()(a))return!1;a=$k().VX()(a);return k3c.has(a)}
function otp(a){var b=[];a=ea(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,ntp(c)&&b.push(c);return b}function ptp(a){if(a.O.ej())return[];var b=[];a.C.forEach(function(c,d){Y2c.has(c.D)&&ntp(d)&&b.push(d)});return b}function qtp(a){a.Ec()&&kVk(a.F)}function rtp(){var a=void 0===a?bj(nDk):a;return new mDk(a)}function stp(){var a=void 0===a?bj(pDk):a;return new oDk(a)}function ttp(a){oj.call(this,a)}z(ttp,oj);function utp(a,b){return zj(a,1,b)}function vtp(a){this.Jb=Zi(a,-1,0)}
z(vtp,$i);vtp.prototype.zb=function(){return new ttp(this)};function wtp(){var a=void 0===a?bj(vtp):a;return new ttp(a)}function xtp(a){oj.call(this,a)}z(xtp,oj);function ytp(a,b){return tj(a,1,b)}function ztp(a,b){return zj(a,2,b)}function Atp(a){this.Jb=Zi(a,-1,0)}z(Atp,$i);Atp.prototype.zb=function(){return new xtp(this)};function Btp(){var a=void 0===a?bj(Atp):a;return new xtp(a)}
function Ctp(a,b,c,d){tq.call(this,d);this.ib=c;this.bb=a;this.state=3;this.C=null;this.Wa=this.oa=!1;this.jb=new xs(this);this.Da(this.jb);this.$a=new $Sk(500,500,"dbxScheduleOnCompleteAuth");this.Da(this.$a);Dtp(this)}z(Ctp,tq);function Dtp(a){a.jb.Gc(U7b,fp,function(b){b=b.data;Etp(a,36713,b);Ftp(a,b,null)}).Gc(V7b,fp,function(b){b=b.data;Etp(a,36714,b);Gtp(a,b,null)}).Gc(W7b,fp,a.Ab).Gc(X7b,fp,a.tb).Gc(vu,ap,a.refresh)}
function Ftp(a,b,c,d){d=void 0===d?!0:d;var e=utp(wtp(),b);c&&tj(e,2,c);ltp(yx.rb(),e.xa()).then(function(f){return Htp(a,b,f.getStatus(),gj(f,2),!0,d)},function(){a.kXa()})}function Gtp(a,b,c,d){d=void 0===d?!0:d;var e=ztp(ytp(Btp(),a.C.getId()),b);c&&tj(e,3,c);mtp(yx.rb(),e.xa()).then(function(f){return Htp(a,b,f.getStatus(),gj(f,2),!1,d)},function(){a.kXa()})}Ctp.prototype.Ab=function(){if(vu.isEnabled()){var a=GDk(this.C);Etp(this,36715,a);a=a.zb().Za(!0).xa();Gtp(this,a,null)}};
Ctp.prototype.tb=function(){if(vu.isEnabled()){var a=GDk(this.C);Etp(this,36716,a);a=a.zb().Za(!1).xa();Gtp(this,a,null)}};function Etp(a,b,c){var d=new GOa;c=Itp(c.So());d=T(d,10,c);d=tzk(d);d=Lp(Jp(new Ip,75),d).xa();a.ib.C(b,d)}function Itp(a){switch(a.So()){case 4:return 1;case 1:return 2;case 2:return 3;case 3:return 4;case 0:return 0}}
function Jtp(a){a.state=3;a.refresh();jEk().then(function(b){a.isDisposed()||(b=mj(b,1,FDk).Mc(),0==b.length?(a.state=1,a.C=null):(a.state=4,a.C=b[0]),a.Wa?(a.Wa=!1,a.show()):a.refresh())},function(){Ns.rb().postMessage(Ps("Error loading schedule configuration.","error",!0))})}function Ktp(a){return a.C&&ej(GDk(a.C),1)?(ij(a.C.getStatus(),1),!0):!1}
function Htp(a,b,c,d,e,f){a.cob(!0);switch(c){case 1:a.focus();Jtp(a);fx.dispatchEvent("load-schedules-on-config-bar");break;case 2:if(!f)break;aTk(a.$a,d,function(h){a.isDisposed()||(a.cob(!1),e?Ftp(a,b,h,!1):Gtp(a,b,h,!1))});break;default:a.kXa()}}Ctp.prototype.show=function(){3==this.state?this.Wa=!0:(this.ib.C(116122),this.state=1==this.state?2:5,this.refresh())};function Ltp(a,b){f9k.call(this,a,b)}z(Ltp,f9k);Ltp.prototype.R=function(){this.refresh()};Ltp.prototype.refresh=function(){if(this.Ec()){var a=vu.isEnabled();a=this.J&&this.O&&a&&0<ptp(this.H).length;this.C.Za(a)}};Ltp.prototype.V=q("Refresh all");function Mtp(a){a=a||{};var b=Lq(void 0,null)?18:void 0;b='<svg xmlns="http://www.w3.org/2000/svg" width="'+V(b)+'px" height="'+V(b)+'px" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="'+V(Lq(void 0,null)?"#188038":void 0)+'" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>';
b=Jq(b);a=""+VY(Kq({title:"Refresh options",oD:"waffle-dataconnector-refresh-sidebar",aP:Nq(""+b),fA:Nq('<div class="'+V("waffle-dataconnector-refresh-sidebar-container")+'"><div class="'+V("waffle-dataconnector-refresh-sidebar-refresh-widget")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-sidebar-backdrop")+'"></div>'),M7:!0,TX:Nq('<div class="'+V("waffle-dataconnector-refresh-sidebar-footer-wrapper")+'"></div>')},a));return Jq(a)};function Ntp(){}z(Ntp,ms);Ntp.prototype.zd=q("docs-calendar-select");Ntp.prototype.px=function(a){a=a.Ja("DIV",["docs-calendar-select-dropdown","docs-gm-arrow","goog-inline-block"],a.Ja("DIV",["docs-icon","goog-inline-block"],a.Ja("DIV",["docs-icon-img-container","docs-icon-img","docs-icon-arrow-dropdown"])));dr(a,"docs-material");return a};qa(Ntp);function Otp(){return Jq('<div><div class="'+V("waffle-dataconnector-refresh-date-input-date-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-date-input-date-picker")+'"></div>')};function Ptp(a,b,c){void 0===b&&Uwe.rb();tq.call(this,c);this.D=new Ly("",c);this.Qa(this.D);this.C=null;this.setDate(new Date)}z(Ptp,tq);u=Ptp.prototype;u.Ja=function(){tq.prototype.Ja.call(this);this.Pb(Hq(Otp))};u.Ra=function(){tq.prototype.Ra.call(this);this.D.render(this.Ka("waffle-dataconnector-refresh-date-input-date-select"));this.setDate(this.F);this.getHandler().listen(this.D,"action",this.Tgc)};u.getDate=n("F");
u.Tgc=function(){var a=this;null==this.C?Qtp(this,function(){return Rtp(a)}):Rtp(this)};function Rtp(a){a.C.position(a.Va());a.C.Ka("goog-date-picker").focus();null!=a.D.getValue()&&a.C.dnd(a.getDate())}function Qtp(a,b){Bo("datepicker",function(){var c=Do("datepicker");a.C=c.C(a.Ea());a.Qa(a.C);a.C.render(a.Ka("waffle-dataconnector-refresh-date-input-date-picker"));a.C.Mdc();a.getHandler().listen(a.C,"change",a.URc);b()})}u.URc=function(a){this.setDate(new Date(a.C.getTime()));this.C.hide();this.D.Va().focus()};
u.setDate=function(a){this.F=new Date(a);this.F.setMinutes(0);this.F.setSeconds(0);this.F.setMilliseconds(0);var b=this.D,c=b.setValue;a=(new ju(ou.MONTH_DAY_YEAR_MEDIUM)).format(a);c.call(b,a);this.Ec()&&(nn(this.D.Va(),""+this.D.getValue()),ar(this.D.Va(),"Start date:"+this.D.getValue()))};var Stp=new it("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function Ttp(a,b){a=void 0===a?Lv.rb():a;for(var c=new ks,d=1;28>=d;d++)c.Qa(new gs(Stp.format({DAY:d}),d),!0);eIk.call(this,c,a,b)}z(Ttp,eIk);function Utp(){var a='<div class="'+V("waffle-dataconnector-refresh-day-of-month-widget")+'"><div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-day-of-month-widget-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-day-of-month-widget-add-day-select")+'" aria-label="';a+=Pq("Add day to repeat on");a+='"></div></div><div class="'+V("waffle-dataconnector-refresh-day-of-month-widget-chip-container")+'"></div></div>';return Jq(a)};var Vtp=new it("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");function Wtp(a){tq.call(this,a);this.D=new tq;this.Qa(this.D);this.C=new Ttp(ds.rb(),a);bOb(this.C,"Add day");this.Qa(this.C);this.F=new Xtp}z(Wtp,tq);u=Wtp.prototype;u.Ja=function(){tq.prototype.Ja.call(this);this.Pb(Hq(Utp));this.D.wb(this.Ka("waffle-dataconnector-refresh-day-of-month-widget-chip-container"));this.C.render(this.Ka("waffle-dataconnector-refresh-day-of-month-widget-add-day-select"))};
u.Ra=function(){tq.prototype.Ra.call(this);nn(this.Ka("waffle-dataconnector-refresh-day-of-month-widget-label"),"Repeat on");this.getHandler().listen(this.C,"change",this.Ofd).listen(this,"Ee",this.Qhd)};u.Ofd=function(){var a=this.C.getValue();$Nb(this.C.Ar,null);Ytp(this,a);this.dispatchEvent("change")};u.Qhd=function(a){a=a.target;var b=Bq(this.D,a);this.F.remove(b)&&(this.D.removeChild(a,this.Ec()),this.dispatchEvent("change"))};
function Ytp(a,b){if(!a.F.has(b)){var c=new YSk(Vtp.format({DAY:b}),a.Ea());b=a.F.add(b);a.D.Cj(c,b,a.Ec())}}u.Ag=function(){return this.F.C};function Ztp(a,b){for(var c=0;c<b.length;c++)Ytp(a,b[c])}function Xtp(){this.C=[]}Xtp.prototype.add=function(a){var b=cg(this.C,a);Rf(this.C,a,-b-1);return-b-1};Xtp.prototype.has=function(a){return-1<vf(this.C,a)};Xtp.prototype.remove=function(a){return Vf(this.C,a)};function $tp(){}z($tp,Swe);$tp.prototype.Ja=function(a){return a.Ea().Ja("INPUT",{type:"number",max:"100",min:"1"})};qa($tp);function aup(){var a='<div class="'+V("waffle-dataconnector-refresh-schedules-new-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-header")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-top-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-header-title")+'"><span tabindex="0" class="'+V("waffle-dataconnector-refresh-schedules-new-title")+'"></span></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-enable-switch")+'"></div></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-spinner")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-setup-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-overview-section")+'"><span class="'+V("waffle-dataconnector-refresh-schedules-new-overview-text")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-new-label-separator")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-new-edit-btn")+'"></span></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-new-fullview-text"></div><div><span class="'+V("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn")+'"></span> - ';a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(V("waffle-dataconnector-refresh-schedules-new-edit-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-repeat-every-label")+
'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-interval-input")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-frequency-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget")+
'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-day-of-month-widget")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-weekday-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-repeat-at-label")+
'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+" "+V("waffle-dataconnector-refresh-schedules-new-time-select-label")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-time-select")+" "+V("waffle-dataconnector-refresh-schedules-new-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-schedules-new-start-date-label")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-edit-section-row")+
" "+V("waffle-dataconnector-refresh-schedules-new-justify-content")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-start-date-select")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-start-time-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-owner-info")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-new-btns")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-new-cancel-btn")+'"></div><div class="'+
V("waffle-dataconnector-refresh-schedules-new-save-btn")+'"></div></div></div></div>');return Jq(a)};function bup(){for(var a='<div class="'+V("waffle-dataconnector-refresh-schedules-new-label")+" "+V("waffle-dataconnector-refresh-weekday-select-label")+'"></div><div style="display: flex">',b=0;7>b;b++)a+='<div data-index="'+V(b)+'" class="'+V("waffle-dataconnector-refresh-weekday-select")+'"></div>';return Jq(a+"</div>")};function cup(a){a=a.name;return Jq('<div class="'+V("waffle-dataconnector-refresh-weekday-toggle")+'">'+Iq(a)+"</div>")};function dup(a,b,c,d){es.call(this,void 0,eup.rb(),d);this.F=a;this.D=c;this.C=b;this.Wj(16,!0)}z(dup,es);dup.prototype.ey=function(a){es.prototype.ey.call(this,a);this.isEnabled()&&this.dispatchEvent("change")};dup.prototype.getName=n("F");function eup(){}z(eup,ds);eup.prototype.Ja=function(a){var b=Hq(cup,{name:a.getName()});er(b,this.Ix(a));return b};eup.prototype.zd=q("waffle-dataconnector-refresh-weekday-toggle");qa(eup);function fup(a){tq.call(this,a);this.C=gup(this,a)}z(fup,tq);fup.prototype.Ja=function(){tq.prototype.Ja.call(this);this.Pb(Hq(bup))};fup.prototype.Ra=function(){var a=this;tq.prototype.Ra.call(this);nn(this.Ka("waffle-dataconnector-refresh-weekday-select-label"),"Repeat on");this.C.forEach(function(b,c){b.render(a.Hj("waffle-dataconnector-refresh-weekday-select")[c]);ar(b.Va(),b.D)})};fup.prototype.Ag=function(){return this.C.filter(function(a){return a.Me()}).map(function(a){return a.C})};
function gup(a,b){var c=(fu.FIRSTDAYOFWEEK+1)%7,d=fu.NARROWWEEKDAYS.map(function(e,f){return new dup(e,(f+6)%7+1,fu.WEEKDAYS[f],b)});d=d.slice(c).concat(d.slice(0,c));d.forEach(function(e){return a.Qa(e)});return d};var hup=new it("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function iup(a,b,c,d){Ctp.call(this,a,b,c,d);this.V=new RTk(0,$tp.rb(),d);this.V.setValue("1");this.Qa(this.V);a=new ks;a.Qa(new gs("hours",4),!0);a.Qa(new gs("days",1),!0);a.Qa(new gs("weeks",2),!0);a.Qa(new gs("months",3),!0);this.D=new eIk(a,Ntp.rb(),d);this.D.Wi(0);this.D.Zc("waffle-dataconnector-refresh-schedule-frequency");this.Qa(this.D);this.O=new Wtp(d);this.Qa(this.O);this.Ga=new fup(d);this.Qa(this.Ga);this.F=new eIk(jup(),Ntp.rb(),d);this.F.Wi((new Date).getHours());this.F.Zc("waffle-dataconnector-refresh-schedule-time");
this.Qa(this.F);this.Ba=new Ptp(0,Swe.rb(),d);this.ma=new eIk(jup(),Ntp.rb(),d);this.ma.Wi((new Date).getHours());this.Qa(this.Ba);this.J=new eA("Cancel");this.Qa(this.J);this.qa=new $t("Save",d);this.Qa(this.qa);this.Ha=new es("",nx.rb(),d);this.Qa(this.Ha);this.Ua=new es("Setup now",nx.rb(),d);this.Qa(this.Ua);this.Sa=new es("",nx.rb(),d);this.Qa(this.Sa);this.H=new z9j(d);this.H.bh("Enable schedule");this.Qa(this.H);this.La=b;this.R=new gUk(d);this.R.ld("waffle-dataconnector-refresh-schedules-new-info-icon");
this.R.setVisible(!1);this.sb=new MY(!0,"#0f9d58")}z(iup,Ctp);u=iup.prototype;
u.Ja=function(){Ctp.prototype.Ja.call(this);this.Pb(Hq(aup));var a=this.Ka("waffle-dataconnector-refresh-schedules-new-title");a.id=zq(this,"waffle-dataconnector-refresh-schedules-new-title");Yq(this.Va(),"labelledby",a.id);ar(a,"Scheduled refresh");nn(a,"Scheduled refresh");a=this.R.C;a.setContent(nh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.R.render(this.Ka("waffle-dataconnector-refresh-schedules-new-header-title"));
a=a.Fc();Yq(hn(this.R.Va())[0],"labelledby",a.id)};
u.Ra=function(){var a=this;Ctp.prototype.Ra.call(this);this.J.render(this.Ka("waffle-dataconnector-refresh-schedules-new-cancel-btn"));this.Ha.render(this.Ka("waffle-dataconnector-refresh-schedules-new-edit-btn"));this.H.render(this.Ka("waffle-dataconnector-refresh-schedules-new-enable-switch"));this.V.render(this.Ka("waffle-dataconnector-refresh-schedules-new-interval-input"));this.D.render(this.Ka("waffle-dataconnector-refresh-schedules-new-frequency-select"));this.qa.render(this.Ka("waffle-dataconnector-refresh-schedules-new-save-btn"));
this.Ua.render(this.Ka("waffle-dataconnector-refresh-schedules-new-setup-btn"));this.Sa.render(this.Ka("waffle-dataconnector-refresh-schedules-new-timezone-setting-btn"));this.F.render(this.Ka("waffle-dataconnector-refresh-schedules-new-time-select"));this.O.render(this.Ka("waffle-dataconnector-refresh-schedules-new-day-of-month-widget"));this.Ga.render(this.Ka("waffle-dataconnector-refresh-schedules-new-weekday-select"));this.sb.render(this.Ka("waffle-dataconnector-refresh-schedules-new-spinner"));
this.Ba.render(this.Ka("waffle-dataconnector-refresh-schedules-new-start-date-select"));this.ma.render(this.Ka("waffle-dataconnector-refresh-schedules-new-start-time-select"));kup(this,!1);lup(this,!1);mup(this,!0);pNb(this.F,new Wq(null,13));pNb(this.ma,new Wq(null,13));nn(this.Ka("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),"Repeat at");nn(this.Ka("waffle-dataconnector-refresh-schedules-new-repeat-every-label"),"Repeat every");nn(this.Ka("waffle-dataconnector-refresh-schedules-new-start-date-label"),
"Start date");var b=this.Ka("waffle-dataconnector-refresh-schedules-new-repeat-every-label");b.id=zq(this,"waffle-dataconnector-refresh-schedules-new-repeat-every-label");Yq(this.D.Va(),"labelledby",b.id);Yq(this.V.Va(),"labelledby",b.id);b=this.Ka("waffle-dataconnector-refresh-schedules-new-repeat-at-label");b.id=zq(this,"waffle-dataconnector-refresh-schedules-new-repeat-at-label");Yq(this.F.Va(),"labelledby",b.id);b=this.Ka("waffle-dataconnector-refresh-schedules-new-start-date-label");b.id=zq(this,
"waffle-dataconnector-refresh-schedules-new-start-date-label");Yq(this.Ba.Va(),"labelledby",b.id);this.getHandler().listen(this.Ha,"action",this.show).listen(this.J,"action",this.Vgc).listen(this.qa,"action",this.Ygc).listen(this.Ua,"action",this.show).listen(this.H,"action",this.Wgc).listen(this.D,"change",this.Xgc).listen(this.O,"change",this.M0).listen(this.Ga,"change",this.M0).listen(this.O,"change",this.M0).listen(this.F,"change",this.M0).listen(this.ma,"change",this.M0).listen(this.V,"action",
this.M0).listen(this.Sa,"action",this.Zgc).listen(this.Va(),"keydown",this.Ugc);[this.D,this.F,this.ma,this.J].forEach(function(c){a.getHandler().listen(c.Va(),"focus",function(){var d=a.Ba;d.C&&d.C.isVisible()&&d.C.hide()})});0<Array.from(this.bb.C.keys()).length?(nq(this.Va(),!0),Jtp(this)):nq(this.Va(),!1)};
u.refresh=function(){if(!this.isDisposed()){var a=this.Ka("waffle-dataconnector-refresh-schedules-new-edit-section"),b=this.Ka("waffle-dataconnector-refresh-schedules-new-overview-section"),c=this.Ka("waffle-dataconnector-refresh-schedules-new-fullview-section"),d=this.Ka("waffle-dataconnector-refresh-schedules-new-owner-info"),e=this.Ka("waffle-dataconnector-refresh-schedules-new-setup-btn"),f=this.Ka("waffle-dataconnector-refresh-schedules-new-enable-switch"),h=this.Ka("waffle-dataconnector-refresh-schedules-new-spinner");
nq(e,!1);nq(f,!1);nq(a,!1);nq(b,!1);nq(c,!1);nq(d,!1);nq(h,!1);kr(this.Va(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!1);var k=!1;this.R.setVisible(!1);switch(this.state){case 1:nq(e,!0);break;case 2:nq(c,!0);nq(a,!0);nq(d,!0);kr(this.Va(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;nup(this);oup(this);this.M0();this.J.Za(!0);this.R.setVisible(!0);Ztp(this.O,[Math.min((new Date).getDate(),28)]);break;case 3:nq(h,!0);break;case 5:nq(c,!0);nq(f,!0);nq(a,!0);
nq(d,!0);kr(this.Va(),"waffle-dataconnector-refresh-schedules-new-widget-opened",!0);k=!0;pup(this);nup(this);oup(this);a=GDk(this.C);this.H.Xc(!!ej(a,1));b=a.So().So();this.D.setValue(b);switch(b){case 4:lup(this,!1);kup(this,!1);break;case 1:lup(this,!1);kup(this,!1);this.F.setValue(kj(a.So(),2));break;case 2:lup(this,!0);kup(this,!1);c=this.Ga;d=wX(a.So(),4).Mc();e=ea(c.C);for(f=e.next();!f.done;f=e.next())f.value.Xc(!1);for(e=0;e<c.C.length;e++)f=c.C[e],0<=d.indexOf(f.C)&&f.Xc(!0);this.F.setValue(kj(a.So(),
2));break;case 3:lup(this,!1),kup(this,!0),Ztp(this.O,wX(a.So(),5).Mc()),this.F.setValue(kj(a.So(),2))}c=cj(a.So(),7)?new Date(ij(a.So(),7)):new Date;this.Ba.setDate(c);4===b?this.ma.setValue(c.getHours()):this.F.setValue(kj(a.So(),2));this.V.setValue(lj(a.So(),6,1).toString());this.M0();this.J.Za(!0);this.R.setVisible(!0);break;case 4:nq(f,!0),nq(b,!0),pup(this),b=this.Ka("waffle-dataconnector-refresh-schedules-new-overview-text"),Ktp(this)?(a=this.C.getStatus(),nn(b,"Next: "),b=new Date(1E3*ij(a,
2)),a=new Date(1E3*ij(a,3)),this.Ha.setContent(xn(this.Ea(),nUk(b,a,this.La,!0,!0))),nq(this.Ka("waffle-dataconnector-refresh-schedules-new-label-separator"),!1)):(nn(b,"Paused"),this.Ha.setContent("Edit"),nq(this.Ka("waffle-dataconnector-refresh-schedules-new-label-separator"),!0))}this.oa!=k&&(this.oa=k,this.dispatchEvent(k?"Uk":"Tk"))}};function pup(a){var b=!!ej(GDk(a.C),1),c=vu.isEnabled();a.H.Xc(b);a.H.Za(c)}
function nup(a){var b=a.Ka("waffle-dataconnector-refresh-schedules-new-owner-info"),c="Will run as you.";a.C&&(a=gj(a.C.wc(4,vDk),1))&&(c+=" Currently running as "+a);nn(b,c)}function oup(a){var b=a.Ka("waffle-dataconnector-refresh-schedules-new-fullview-text");if(Ktp(a)){var c=a.C.getStatus(),d=new Date(1E3*ij(c,2));c=new Date(1E3*ij(c,3));var e=a.Ea();e.$e(b);e.appendChild(b,xn(e,rh(nh("Next: "),nUk(d,c,a.La,!1,!0))))}else nn(b,"");a.Sa.setContent(mUk(a.La))}u.Vgc=function(){qup(this)};
function qup(a){a.state=2==a.state?1:4;a.refresh();a.Ka("waffle-dataconnector-refresh-schedules-new-title").focus()}u.Xgc=function(){switch(this.D.getValue()){case 4:lup(this,!1);kup(this,!1);mup(this,!0);break;case 1:lup(this,!1);kup(this,!1);mup(this,!1);break;case 2:kup(this,!1);lup(this,!0);mup(this,!1);break;case 3:lup(this,!1),kup(this,!0),mup(this,!1)}this.M0()};
function mup(a,b){nq(a.Ka("waffle-dataconnector-refresh-schedules-new-repeat-at-label"),!b);nq(a.Ka("waffle-dataconnector-refresh-schedules-new-time-select"),!b);nq(a.Ka("waffle-dataconnector-refresh-schedules-new-start-time-select"),b)}
u.Ygc=function(){this.qa.Za(!1);this.J.Za(!1);var a=this.D.getValue(),b=rtp().I$(a);if(2===a)for(var c=ea(this.Ga.Ag()),d=c.next();!d.done;d=c.next())d=d.value,Rva(b.Jb,4,tva).add(d);else if(3===a)for(c=ea(this.O.Ag()),d=c.next();!d.done;d=c.next())d=d.value,Rva(b.Jb,5,tva).add(d);c=this.Ba.getDate();4===a&&c.setHours(this.ma.getValue());c=c.getTime();uj(b,7,c);4!==a&&(a=this.F.getValue(),vj(b,2,a));a=parseInt(this.V.getValue(),10);vj(b,6,a);b=vj(stp().I$(b),3,1);2==this.state?(b.Za(!0),U7b.Ob(b.xa())):
(b.Za(this.H.Me()),V7b.Ob(b.xa()))};u.Wgc=function(){var a=this;if(4==this.state){var b=this.H.Me();this.H.Xc(!b);this.H.Za(!1);if(b){var c=rup(this);c.render();c.setVisible(!0);c.Hl().then(function(){ii(c);W7b.Ob()},function(){ii(c);pup(a)})}else X7b.Ob()}};u.Ugc=function(a){27==a.keyCode&&this.oa&&(qup(this),a.stopPropagation())};u.Zgc=function(){eec.Ob()};
u.M0=function(){var a=!!this.D.dj(),b=3!==this.D.getValue()||0<this.O.Ag().length,c=2!==this.D.getValue()||0<this.Ga.Ag().length,d=!!this.F.dj()||4===this.D.getValue(),e=!!this.ma.dj()||4!==this.D.getValue(),f=vu.isEnabled(),h=parseFloat(this.V.getValue());h=Number.isInteger(h)&&0<h&&100>=h;this.qa.Za(a&&b&&c&&d&&e&&f&&h)};u.focus=function(){this.Ka("waffle-dataconnector-refresh-schedules-new-title").focus()};u.cob=function(a){this.H.Za(a)};
function kup(a,b){nq(a.Ka("waffle-dataconnector-refresh-schedules-new-edit-section-row-day-of-month-widget"),b)}function lup(a,b){nq(a.Ka("waffle-dataconnector-refresh-schedules-new-weekday-select"),b)}
function rup(a){var b=new Nal;b.ld("waffle-dataconnector-refresh-schedules-new-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=GDk(a.C);switch(c.So().So()){case 1:var d="Daily ";break;case 2:d=sup();var e=wX(c.So(),4).Mc();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(wX(c.So(),5).Mc().map(function(l){return hup.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=kUk(a.La);var h=new Date(ya()),k=new Date(1E3*ij(f,2));f=new Date(1E3*ij(f,3));d+=lUk(k,f,c)+" ("+u0b(w0b(c,h))+")";a="Will run as "+gj(a.C.wc(4,vDk),1);a=rh(nh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),qh("H4",void 0,"Schedule"),nh(d),qh("BR"),nh(a));rr(b,a);return b}u.kXa=function(){Ns.rb().postMessage(Ps("Error saving schedule.","error",!0));this.qa.Za(!0);this.J.Za(!0);this.H.Za(!0)};
function sup(){var a=(fu.FIRSTDAYOFWEEK+1)%7,b=fu.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}function jup(){for(var a=new ks,b=new Date(ya()),c=Array(24),d=0;24>d;d++){b.setHours(d,0,0,0);var e=new Date(b.getTime()),f=new Date(b.getTime());f.setHours(e.getHours()+1);f=lUk(e,f);c[e.getHours()]={value:d,label:f}}for(b=0;24>b;b++)d=new gs(c[b].label,c[b].value),a.Qa(d,!0);return a};function tup(a,b,c){li.call(this);this.C=a;this.J=b;this.O=c;this.F=[];this.H=[];this.D=[]}z(tup,li);tup.prototype.Xa=function(){uup(this);li.prototype.Xa.call(this)};function vup(a,b,c){var d=lx(a.C);b.forEach(function(e){var f=e.rect;f&&Bv(f)&&(d&&rY(a.C)==e.gid?(e=dzd(d,f,wup(c)),a.Da(e),e.setVisible(!0),a.F.push(e)):xup(a,e.gid,c))})}
function yup(a,b,c){var d=lx(a.C);b.forEach(function(e){if(d){var f=lrd(d.J,e);if(f&&f.Ec()&&f instanceof aal){a.D.push(f);dr(J$k(f.D),wup(c));return}}(e=a.O.J.Sr(e))&&xup(a,e.Eb(),c)})}function xup(a,b,c){b=AFk(a.J,b);dr(b.Va(),wup(c));a.H.push(b)}function wup(a){return a?"waffle-dataconnector-refreshall-highlight-valid":"waffle-dataconnector-refreshall-highlight-error"}
function uup(a){ji(a.F);a.F=[];a.H.forEach(function(b){gr(b.Va(),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.H=[];a.D.forEach(function(b){gr(J$k(b.D),["waffle-dataconnector-refreshall-highlight-error","waffle-dataconnector-refreshall-highlight-valid"])});a.D=[]};function zup(){return Jq('<div class="'+V("waffle-dataconnector-refresh-all-pane")+'"><div class="'+V("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function Aup(){return Jq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function Bup(a,b){return Jq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+Aup(null,b))}function Cup(){return Jq('<div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function Dup(a){a=a.title;a='<div class="'+V("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+WTc()+'</div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-title")+'" role="heading">'+Iq(a)+'</div><div class="'+
V("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+V("waffle-dataconnector-refresh-all-dbobject-item-error")+'">';a=a+'Error</div><div class="'+(V("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">');a=a+'Loading\u2026</div><div class="'+(V("waffle-dataconnector-refresh-all-dbobject-item-running")+'">');return Jq(a+"Running\u2026</div></div></div>")};function Eup(a,b,c,d,e,f,h){tq.call(this,h);this.C=a;this.oa=b;this.ma=c;this.V=d.O;this.O=e;this.D=new tup(e,f,d);this.Da(this.D);this.R=new Tnd;this.H=new MY(!1,"#0f9d58");this.F=this.J=!0}z(Eup,tq);u=Eup.prototype;u.Ja=function(){this.Pb(Hq(Dup,{title:this.oa}));var a=this.Ka("waffle-dataconnector-refresh-all-dbobject-item-title");a.id=zq(this,"waffle-dataconnector-refresh-all-dbobject-item-title");Xq(a,"heading");Yq(this.Va(),"labelledby",a.id)};
u.Ra=function(){tq.prototype.Ra.call(this);dr(this.Va(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.H.render(this.Ka("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.Va(),"click",this.ixb).listen(this.Va(),"keydown",this.ahc).listen(this.Va(),["mouseenter","focus"],this.$gc).listen(this.Va(),["mouseleave","blur"],this.dQc);Fup(this)};
function Fup(a){var b=dEk(a.V,a.C),c=b.getType(),d=a.Va();switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":case "offline":lr(d,"valid-highlight","error-highlight");a.F=!1;break;case "loading":case "no-results":case "fetch-successful":lr(d,"error-highlight","valid-highlight");a.F=!0;break;case "fetching-results":case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}switch(c){case "invalid-db-object":case "insufficient-access":case "fetch-failed":Gup(a,
"waffle-dataconnector-refresh-all-dbobject-item-error");Hup(a);break;case "offline":Hup(a);break;case "loading":Gup(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");Iup(a);break;case "fetching-results":Gup(a,"waffle-dataconnector-refresh-all-dbobject-item-running");Iup(a);break;case "no-results":Jup(a);Hup(a);break;case "fetch-successful":b=ij(b.C,8);b=a.R.format(b);nn(a.Ka("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);ar(a.Ka("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),
b);Gup(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");Hup(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}u.Za=function(a){this.J=a;var b=this.Va();this.Ea().In(b,a);a?lr(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):lr(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};
u.$gc=function(){var a=this;switch(this.ma){case 1:case 3:case 5:var b=$k().TGb()(this.C,rY(this.O)).map(function(c){return Rv(wo(c))});vup(this.D,b,this.F);break;case 2:b=$k().SGb()(this.C);yup(this.D,b,this.F);break;case 4:$k().RGb()(this.C).forEach(function(c){xup(a.D,c,a.F)})}};u.dQc=function(){uup(this.D)};function Gup(a,b){Jup(a);nq(a.Ka(b),!0)}
function Hup(a){a.H.setActive(!1);nq(a.Ka("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);nq(a.Ka("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function Iup(a){a.H.setActive(!0);nq(a.Ka("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);nq(a.Ka("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}u.ahc=function(a){13===a.keyCode&&this.ixb()};u.ixb=function(){if(this.J){var a=new Wv("refresh-db-object-request");a.oFb=this.C;this.dispatchEvent(a)}};
function Jup(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return nq(a.Ka(b),!1)})};function Kup(a,b,c,d,e,f,h,k){tq.call(this,k);this.R=a;this.H=new Set(b);this.qa=c;this.V=c.O;this.F=[];this.ma=f;this.oa=h;this.J=d;this.D=this.C=null;e&&(this.C=new Lup(this.Ea()),this.D=new SSk(this.J,this.Ea(),!0));this.O=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}z(Kup,tq);u=Kup.prototype;u.Ja=function(){if(this.D){var a=an("DIV","waffle-dataconnector-refresh-all-dbobject-list-parent");this.Pb(a);this.Qa(this.D,!0);this.D.setContent(Hq(Aup));dr(this.D.getElement(),"waffle-dataconnector-refresh-all-dbobject-list-collapsible")}else this.Pb(Hq(Bup))};
u.Ra=function(){tq.prototype.Ra.call(this);this.D||nn(this.Ka("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.J);Mup(this);Nup(this);var a=this.getHandler();this.C&&(this.C.render(this.Ka("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),a.listen(this.C,"action",this.p3c))};function Oup(a){var b=a.getHandler();a.F.forEach(function(c){b.Wd(c,"refresh-db-object-request",a.GMb)})}
function Nup(a){var b=a.getHandler();a.F.forEach(function(c){b.listen(c,"refresh-db-object-request",a.GMb)})}function Mup(a){var b=a.Ka("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.H.forEach(function(c){var d=$k().VX()(c);c=new Eup(c,Pup(a,d),d,a.qa,a.ma,a.oa,a.Ea());a.F.push(c);c.render(b)})}
function Pup(a,b){switch(b){case 1:return"Pivot table "+Qup(a,1);case 2:return"Chart "+Qup(a,2);case 3:return"Function "+Qup(a,3);case 4:return"Preview";case 5:return"Extract "+Qup(a,5);default:throw Error("Unexpected DbObjectType");}}function Qup(a,b){var c=a.O.get(b);a.O.set(b,c+1);return 0==c?"":c.toString()}function Rup(a){a.O.forEach(function(b,c,d){return d.set(c,0)})}
u.p3c=function(){var a=this,b=Array.from(this.H).filter(function(c){return Y2c.has(dEk(a.V,c).D)});C7b.Ob(new X9j(b,"all-objects-for-single-datasource",this.R))};u.GMb=function(a){a=a.oFb;Y2c.has(dEk(this.V,a).D)&&C7b.Ob(new X9j([a],"specific-ids"))};function Sup(a){a.F.forEach(function(b){return Fup(b)})}function Tup(a,b){a.C&&(b=b.filter(function(c){return cj(c,3)&&a.H.has(c.Cu())}),Uup(a.C,b))}u.expand=function(){this.D.Jm().Xc(!0)};u.jg=n("R");
function Vup(a,b){a.J=b;a.D?a.D.Jm().setContent(b):nn(a.Ka("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}u.Za=function(a){this.C&&this.C.Za(a);this.F.forEach(function(b){return b.Za(a)})};function Lup(a){tq.call(this,a);this.D=new eA("Refresh",this.Ea());this.Qa(this.D);this.C=new e9k;this.Qa(this.C)}z(Lup,tq);Lup.prototype.Ja=function(){this.Pb(Hq(Cup))};
Lup.prototype.Ra=function(){tq.prototype.Ra.call(this);this.D.render(this.Ka("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Ka("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};function Uup(a,b){var c=0;b.forEach(function(d){return c+=parseInt(d.tA(),10)});nVk(a.C,c);a.D.Za(!0)}Lup.prototype.Za=function(a){this.D.Za(a)};function Wup(a,b,c,d){tq.call(this,d);this.F=a;this.J=a.O;this.D=new tq;this.Qa(this.D);this.C=[];this.H=b;this.O=c}z(Wup,tq);Wup.prototype.Ja=function(){this.Pb(Hq(zup))};Wup.prototype.Ra=function(){var a=this;tq.prototype.Ra.call(this);this.D.wb(this.Ka("waffle-dataconnector-refresh-all-datasources-container"));Xup(this);this.getHandler().listen(this.F.C,"ua",function(b){return Yup(a,b)})};
function Xup(a){var b=a.D.$e(!0);ji(b);a.C=[];b=Zup(a);if(1==b.size)b=b.entries().next().value,$up(a,b[0],b[1],!1),dr(a.D.Va(),"waffle-dataconnector-refresh-all-single-datasource-container");else{for(var c=ea(b.keys()),d=c.next();!d.done;d=c.next()){d=d.value;var e=b.get(d);$up(a,d,e,!0)}fr(a.D.Va(),"waffle-dataconnector-refresh-all-single-datasource-container")}1<a.C.length&&a.C[0].expand()}
function avp(a){var b=Zup(a);1!=b.size&&1!=a.C.length||b.size==a.C.length?(a.C.forEach(function(c){var d=c.jg();if(b.has(d)){var e=b.get(d);Oup(c);ji(c.F);c.F=[];Rup(c);c.H=new Set(e);Mup(c);Nup(c)}else bvp(a,c);b.delete(d)}),b.forEach(function(c,d){return $up(a,d,c,!0)})):Xup(a)}function bvp(a,b){a.C=a.C.filter(function(c){return b!=c});ii(b)}function $up(a,b,c,d){var e=$k().Tda()(b);e=Fw(a.F.C,e).Qg();b=new Kup(b,c,a.F,e,d,a.H,a.O,a.Ea());a.C.push(b);a.D.Qa(b,!0)}
function Zup(a){var b=new Map;otp(a.J).forEach(function(c){var d=$k().Y7()(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function cvp(a,b){a.C.forEach(function(c){return Tup(c,b)})}function dvp(a){a.C.forEach(function(b){b.C&&lVk(b.C.C)})}function evp(a){a.C.forEach(function(b){b.C&&(b=b.C,kVk(b.C),b.D.Za(!1))})}function fvp(a){a.C.forEach(function(b){return Sup(b)})}Wup.prototype.Za=function(a){this.C.forEach(function(b){return b.Za(a)})};
function Yup(a,b){3==Fw(a.F.C,b.jm).jj()&&(a=a.C.find(function(c){return c.J==b.C}))&&Vup(a,b.yv)};function gvp(a,b,c){b=void 0===b?Kv.rb():b;Pr.call(this,"",void 0,c);a&&hvp(a);this.C=new ivp(a,b,c);this.Qa(this.C)}z(gvp,Pr);u=gvp.prototype;u.Ja=function(){this.C.Ja();this.Pb(this.C.Va())};u.Le=function(a){a.Zv(!0);this.C.Le(a)};u.ZD=function(a,b){a.Zv(!0);this.C.ZD(a,b)};u.ll=function(a){return this.C.ll(a)};u.xm=function(){return this.C.xm()};u.Ag=function(){return this.C.C.map(function(a){return a.getValue()})};
function jvp(a,b){a=a.C;for(var c=ea(a.C),d=c.next();!d.done;d=c.next())d.value.Xc(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.xm();e++){var f=a.ll(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Xc(!0),c.push(f),0==--d))break}a.C=c}a.l_()}u.Ic=function(){return this.C.Ic()};u.vh=function(a){hvp(a);this.C.vh(a)};u.Zc=function(a){this.C.Zc(a)};function hvp(a){for(var b=0;b<a.Bd();b++)a.Nd(b).Zv(!0)}function ivp(a,b,c){b=void 0===b?Kv.rb():b;CY.call(this,a,b,c);this.C=[]}z(ivp,CY);
ivp.prototype.vh=function(a){CY.prototype.vh.call(this,a);this.C=[];this.l_()};ivp.prototype.vA=function(a){a.stopPropagation();a=a.target;if(a.Me()){var b=this.Ic();Pia(this.C,a,function(c,d){return dg(Bq(b,c),Bq(b,d))})}else Tf(this.C,a);this.l_();this.dispatchEvent("change")};ivp.prototype.J=function(){var a;0==this.C.length?a=this.H:a=this.C.map(function(b){return b.Gl()}).join(", ");return a||""};function kvp(){var a='<div class="'+V("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+V("waffle-dataconnector-refresh-schedules-title")+'" role="heading">';a=a+'Scheduled refresh</span></div><div class="'+(V("waffle-dataconnector-refresh-schedules-enable-switch")+
'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+V("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+V("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+V("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
V("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(V("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-frequency-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+V("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-date-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-time-select")+" "+V("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+V("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
V("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+V("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+V("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return Jq(a)};var lvp=new it("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function mvp(a,b,c,d){Ctp.call(this,a,b,c,d);this.La=pf(qf(),"fdsrfu")?1:4;a=new ks;a.Qa(new gs("Every day",1),!0);a.Qa(new gs("Every week",2),!0);a.Qa(new gs("Every month",3),!0);this.H=new CY(a,Kv.rb(),d);bOb(this.H,"Add frequency");this.H.Zc("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Qa(this.H);this.D=new gvp(void 0,Kv.rb(),d);bOb(this.D.C,"Add date");this.D.Zc("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");this.Qa(this.D);
var e=this.La;a=new ks;var f=new Date(ya());c=Array(24);for(var h=0;24>h;h++){f.setHours(h,0,0,0);var k=new Date(f.getTime()),l=new Date(f.getTime());l.setHours(k.getHours()+e);l=lUk(k,l);c[k.getHours()]={value:h,label:l}}for(e=0;24>e;e++)f=new gs(c[e].label,c[e].value),a.Qa(f,!0);this.J=new CY(a,Kv.rb(),d);bOb(this.J,"Add time");this.J.Zc("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Qa(this.J);this.R=new eA("Cancel");this.Qa(this.R);this.V=new $t("Save",d);this.V.Za(!1);
this.Qa(this.V);this.ma=new es("",nx.rb(),d);this.Qa(this.ma);this.Ga=new es("Setup now",nx.rb(),d);this.Qa(this.Ga);this.Ba=new es("",nx.rb(),d);this.Qa(this.Ba);this.F=new z9j(d);this.F.bh("Enable schedule");this.Qa(this.F);this.qa=b;this.O=new gUk(d);this.O.ld("waffle-dataconnector-refresh-schedules-info-icon");this.O.setVisible(!1);this.Ha=new MY(!0,"#0f9d58")}z(mvp,Ctp);u=mvp.prototype;
u.Ja=function(){Ctp.prototype.Ja.call(this);this.Pb(Hq(kvp));var a=this.Ka("waffle-dataconnector-refresh-schedules-title");a.id=zq(this,"waffle-dataconnector-refresh-schedules-title");Xq(a,"heading");Yq(this.Va(),"labelledby",a.id);a=this.O.C;a.setContent(nh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.O.render(this.Ka("waffle-dataconnector-refresh-schedules-header-title"));a=a.Fc();Yq(this.O.Va(),"labelledby",
a.id)};
u.Ra=function(){Ctp.prototype.Ra.call(this);this.R.render(this.Ka("waffle-dataconnector-refresh-schedules-cancel-btn"));this.ma.render(this.Ka("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Ka("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Ka("waffle-dataconnector-refresh-schedules-frequency-select"));this.V.render(this.Ka("waffle-dataconnector-refresh-schedules-save-btn"));this.Ga.render(this.Ka("waffle-dataconnector-refresh-schedules-setup-btn"));this.Ba.render(this.Ka("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));
this.J.render(this.Ka("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Ka("waffle-dataconnector-refresh-schedules-date-select"));this.Ha.render(this.Ka("waffle-dataconnector-refresh-schedules-spinner"));nvp(this,!1);pNb(this.J,new Wq(null,13));this.getHandler().listen(this.ma,"action",this.show).listen(this.R,"action",this.chc).listen(this.V,"action",this.fhc).listen(this.Ga,"action",this.show).listen(this.F,"action",this.dhc).listen(this.H,"change",this.ehc).listen(this.D,
"change",this.eva).listen(this.J,"change",this.eva).listen(this.Ba,"action",this.ghc).listen(this.Va(),"keydown",this.bhc);0<Array.from(this.bb.C.keys()).length?(nq(this.Va(),!0),Jtp(this)):nq(this.Va(),!1)};
u.refresh=function(){if(!this.isDisposed()){var a=this.Ka("waffle-dataconnector-refresh-schedules-edit-section"),b=this.Ka("waffle-dataconnector-refresh-schedules-overview-section"),c=this.Ka("waffle-dataconnector-refresh-schedules-fullview-section"),d=this.Ka("waffle-dataconnector-refresh-schedules-owner-info"),e=this.Ka("waffle-dataconnector-refresh-schedules-setup-btn"),f=this.Ka("waffle-dataconnector-refresh-schedules-enable-switch"),h=this.Ka("waffle-dataconnector-refresh-schedules-spinner");
nq(e,!1);nq(f,!1);nq(a,!1);nq(b,!1);nq(c,!1);nq(d,!1);nq(h,!1);kr(this.Va(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var k=!1;this.O.setVisible(!1);switch(this.state){case 1:nq(e,!0);break;case 2:nq(c,!0);nq(a,!0);nq(d,!0);kr(this.Va(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);k=!0;ovp(this);pvp(this);this.eva();this.R.Za(!0);this.O.setVisible(!0);break;case 3:nq(h,!0);break;case 5:nq(c,!0);nq(f,!0);nq(a,!0);nq(d,!0);kr(this.Va(),"waffle-dataconnector-refresh-schedules-widget-opened",
!0);k=!0;qvp(this);ovp(this);pvp(this);a=GDk(this.C);this.F.Xc(!!ej(a,1));b=a.So().So();this.H.setValue(b);switch(b){case 1:nvp(this,!1);break;case 2:jvp(this.D,wX(a.So(),4).Mc());nvp(this,!0);break;case 3:jvp(this.D,wX(a.So(),5).Mc()),nvp(this,!0)}this.J.setValue(kj(a.So(),2));this.eva();this.R.Za(!0);this.O.setVisible(!0);break;case 4:nq(f,!0),nq(b,!0),qvp(this),b=this.Ka("waffle-dataconnector-refresh-schedules-overview-text"),Ktp(this)?(a=this.C.getStatus(),nn(b,"Next: "),b=new Date(1E3*ij(a,2)),
a=new Date(1E3*ij(a,3)),this.ma.setContent(xn(this.Ea(),nUk(b,a,this.qa,!0,!0)))):(nn(b,"Paused"),this.ma.setContent("Edit"))}this.oa!=k&&(this.oa=k,this.dispatchEvent(k?"Uk":"Tk"))}};function qvp(a){var b=!!ej(GDk(a.C),1),c=vu.isEnabled();a.F.Xc(b);a.F.Za(c)}function ovp(a){var b=a.Ka("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=gj(a.C.wc(4,vDk),1))&&(c+=" Currently running as "+a);nn(b,c)}
function pvp(a){var b=a.Ka("waffle-dataconnector-refresh-schedules-fullview-text");if(Ktp(a)){var c=a.C.getStatus(),d=new Date(1E3*ij(c,2));c=new Date(1E3*ij(c,3));var e=a.Ea();e.$e(b);e.appendChild(b,xn(e,rh(nh("Next: "),nUk(d,c,a.qa,!1,!0))))}else nn(b,"");a.Ba.setContent(mUk(a.qa))}u.chc=function(){rvp(this)};function rvp(a){a.state=2==a.state?1:4;a.refresh();a.Ka("waffle-dataconnector-refresh-schedules-title").focus()}
u.ehc=function(){var a=this.H.getValue();jvp(this.D,[]);switch(a){case 1:nvp(this,!1);break;case 2:nvp(this,!0);a=this.D;var b=a.vh,c=new ks,d=svp();d=ea(d);for(var e=d.next();!e.done;e=d.next())e=e.value,c.Qa(new gs(e.label,e.value),!0);a=b.call(a,c);ii(a);break;case 3:nvp(this,!0);a=this.D;b=a.vh;c=new ks;for(d=1;28>=d;d++)c.Qa(new gs(lvp.format({DAY:d}),d),!0);a=b.call(a,c);ii(a)}this.eva()};
u.fhc=function(){this.V.Za(!1);this.R.Za(!1);var a=this.H.getValue(),b=rtp().I$(a);if(2===a){a=ea(this.D.Ag());for(var c=a.next();!c.done;c=a.next())c=c.value,Rva(b.Jb,4,tva).add(c)}else if(3===a)for(a=ea(this.D.Ag()),c=a.next();!c.done;c=a.next())c=c.value,Rva(b.Jb,5,tva).add(c);a=this.J.getValue();vj(b,2,a);b=vj(stp().I$(b),3,1);2==this.state?(b.Za(!0),U7b.Ob(b.xa())):(b.Za(this.F.Me()),V7b.Ob(b.xa()))};
u.dhc=function(){var a=this;if(4==this.state){var b=this.F.Me();this.F.Xc(!b);this.F.Za(!1);if(b){var c=tvp(this);c.render();c.setVisible(!0);c.Hl().then(function(){ii(c);W7b.Ob()},function(){ii(c);qvp(a)})}else X7b.Ob()}};u.bhc=function(a){27==a.keyCode&&this.oa&&(rvp(this),a.stopPropagation())};u.ghc=function(){eec.Ob()};u.eva=function(){var a=!!this.H.dj(),b=1===this.H.getValue()||0<this.D.Ag().length,c=!!this.J.dj(),d=vu.isEnabled();this.V.Za(a&&b&&c&&d)};u.focus=function(){this.Ka("waffle-dataconnector-refresh-schedules-title").focus()};
u.cob=function(a){this.F.Za(a)};function nvp(a,b){nq(a.Ka("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function tvp(a){var b=new Nal;b.ld("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.F.setContent("Cancel");var c=GDk(a.C);switch(c.So().So()){case 1:var d="Daily ";break;case 2:d=svp();var e=wX(c.So(),4).Mc();d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(wX(c.So(),5).Mc().map(function(l){return lvp.format({DAY:l})}).join(", ")+
" ")}var f=a.C.getStatus();c=kUk(a.qa);var h=new Date(ya()),k=new Date(1E3*ij(f,2));f=new Date(1E3*ij(f,3));d+=lUk(k,f,c)+" ("+u0b(w0b(c,h))+")";a="Will run as "+gj(a.C.wc(4,vDk),1);a=rh(nh("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),qh("H4",void 0,"Schedule"),nh(d),qh("BR"),nh(a));rr(b,a);return b}u.kXa=function(){Ns.rb().postMessage(Ps("Error saving schedule.","error",!0));this.V.Za(!0);this.R.Za(!0);this.F.Za(!0)};
function svp(){var a=(fu.FIRSTDAYOFWEEK+1)%7,b=fu.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))};function uvp(a,b,c,d,e,f){PY.call(this,f);this.F=b.O;this.O=a;this.V=d;this.s$=new Wup(b,c,this.V,this.Ea());this.Qa(this.s$);this.D=new Ltp(this.F,f);this.Da(this.D);this.C=null;this.ma=pf(qf(),"fdsrfu");this.J=null;this.R=e}z(uvp,PY);u=uvp.prototype;u.Ja=function(){PY.prototype.Ja.call(this);this.Pb(Hq(Mtp,{id:this.getId()}));this.D.render(this.Ka("waffle-dataconnector-refresh-sidebar-footer-wrapper"))};
u.Ra=function(){var a=this;PY.prototype.Ra.call(this);vvp(this);this.getHandler().listen(this,["Tk","Uk"],this.B4c);this.s$.render(this.Ka("waffle-dataconnector-refresh-sidebar-refresh-widget"));wvp(this,!0);this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=ptp(a.F);C7b.Ob(new X9j(b,"all-objects-for-all-datasources"))});this.D.refresh();nq(this.Ka("waffle-dataconnector-refresh-sidebar-backdrop"),!1)};function xvp(a){null!=a.C&&(ii(a.C),ii(a.J),vvp(a))}
u.rZa=function(){null!=this.C&&this.C.show()};function yvp(a,b){cvp(a.s$,b);var c=0;b.forEach(function(d){return c+=parseInt(d.tA(),10)});a.D.Cv(c)}function wvp(a,b){a.s$.Za(b);b?a.D.refresh():a.D.C.Za(b)}
u.B4c=function(a){var b=this;a="Uk"===a.type;nq(this.Ka("waffle-dataconnector-refresh-sidebar-backdrop"),a);wvp(this,!a);Zp(this.Fc(),"overflow-y",a?"hidden":"auto");ii(this.J);a?(zvp(this),setTimeout(function(){if(b.C.Ec()){var c=b.C.Va();b.J=new St(c,b.Ea());b.Da(b.J);Tt(b.J);c.focus()}},500)):this.resize()};function vvp(a){a.C=a.ma?new iup(a.F,a.O,a.R,a.Ea()):new mvp(a.F,a.O,a.R,a.Ea());a.Qa(a.C);a.C.render(a.Va());nq(a.Ka("waffle-dataconnector-refresh-sidebar-backdrop"),!1)}
u.resize=function(){if(this.C)if(this.C.oa)zvp(this);else{var a=lq(this.Fc()).height-lq(this.C.Va()).height,b=this.Ka("waffle-dataconnector-refresh-sidebar-refresh-widget");kq(b,a)}};function zvp(a){var b=lq(a.Va()).height-lq(a.Ka("waffle-sidebar-title")).height-10;Zp(a.C.Va(),"max-height",b+"px")};function Avp(a,b,c){vY.call(this,a,b);var d=this;this.C=c;this.F=new Km;this.Da(this.F);this.F.Dc(this.C.H,function(e){if("dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType())e=d.ud,avp(e.s$),0<ptp(e.F).length||e.dispatchEvent("close-sidebar");Bvp(d);fvp(d.ud.s$)});this.D.listen(fx,"show-db-objects-refresh-sidebar",this.H)}z(Avp,vY);Avp.prototype.Dj=function(){return E7b};Avp.prototype.ov=function(){return F7b};
function Bvp(a){var b=ptp(a.C),c=a.ud;0==b.length?qtp(c.D):(dvp(c.s$),g9k(c.D),SZj(a.C,b,function(d){a.isDisposed()||c.isDisposed()||yvp(c,d)},function(d){a.isDisposed()||c.isDisposed()||(d=new E1c(d[0].Cu(),d[0].cj()),evp(c.s$),c.D.cP(d))}))}Avp.prototype.H=function(a){var b=this;xvp(this.ud);Bvp(this);wY(this);a.rZa&&this.ud.rZa();An(function(){b.ud.Va().focus()})};function Cvp(){ro.apply(this,arguments)}z(Cvp,ro);Cvp.prototype.C=function(){return Avp};Cvp.prototype.D=function(){return uvp};Co("dbrefresh",Cvp);
